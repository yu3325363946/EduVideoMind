import{aj as ks,ak as no,al as HO,V as Sc,k as zO,o as So,l as Ma,P as zs,p as rs,F as td,a9 as fy,m as jn,D as ed,r as fa,w as NO,q as WO,C as v0,W as UO,n as VO,U as jO,M as GO,N as $O,v as qO}from"./index-Q3dqO0M-.js";import{E as XO,b as YO,p as KO,c as ZO,d as QO}from"./video-B2wRqW2q.js";import{m as JO}from"./_plugin-vue_export-helper-DnkLqMvT.js";import"./index-CgUo9-lj.js";import"./request-B6ihF906.js";var b0,K1;function um(){if(K1)return b0;K1=1;var n;return typeof window<"u"?n=window:typeof ks<"u"?n=ks:typeof self<"u"?n=self:n={},b0=n,b0}var t3=um();const K=no(t3),e3={},i3=Object.freeze(Object.defineProperty({__proto__:null,default:e3},Symbol.toStringTag,{value:"Module"})),r3=HO(i3);var _0,Z1;function eB(){if(Z1)return _0;Z1=1;var n=typeof ks<"u"?ks:typeof window<"u"?window:{},t=r3,e;return typeof document<"u"?e=document:(e=n["__GLOBAL_DOCUMENT_CACHE@4"],e||(e=n["__GLOBAL_DOCUMENT_CACHE@4"]=t)),_0=e,_0}var n3=eB();const Rt=no(n3);function Jn(){return Jn=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Jn.apply(null,arguments)}var xc={exports:{}},Q1;function o3(){return Q1||(Q1=1,function(n,t){function e(l){if(l&&typeof l=="object"){var u=l.which||l.keyCode||l.charCode;u&&(l=u)}if(typeof l=="number")return s[l];var h=String(l),d=i[h.toLowerCase()];if(d)return d;var d=r[h.toLowerCase()];if(d)return d;if(h.length===1)return h.charCodeAt(0)}e.isEventKey=function(u,h){if(u&&typeof u=="object"){var d=u.which||u.keyCode||u.charCode;if(d==null)return!1;if(typeof h=="string"){var c=i[h.toLowerCase()];if(c)return c===d;var c=r[h.toLowerCase()];if(c)return c===d}else if(typeof h=="number")return h===d;return!1}},t=n.exports=e;var i=t.code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(o=97;o<123;o++)i[String.fromCharCode(o)]=o-32;for(var o=48;o<58;o++)i[o-48]=o;for(o=1;o<13;o++)i["f"+o]=o+111;for(o=0;o<10;o++)i["numpad "+o]=o+96;var s=t.names=t.title={};for(o in i)s[i[o]]=o;for(var a in r)i[a]=r[a]}(xc,xc.exports)),xc.exports}var s3=o3();const fe=no(s3);function he(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function su(n,t){return su=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},su(n,t)}function kt(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,su(n,t)}var C0,J1;function a3(){if(J1)return C0;J1=1,C0=n;function n(t,e){var i,r=null;try{i=JSON.parse(t,e)}catch(o){r=o}return[r,i]}return C0}var l3=a3();const u3=no(l3);var Tc={exports:{}},y0={exports:{}},tS;function h3(){return tS||(tS=1,function(n){function t(){return n.exports=t=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var o in r)({}).hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},n.exports.__esModule=!0,n.exports.default=n.exports,t.apply(null,arguments)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(y0)),y0.exports}var w0,eS;function d3(){if(eS)return w0;eS=1,w0=t;var n=Object.prototype.toString;function t(e){if(!e)return!1;var i=n.call(e);return i==="[object Function]"||typeof e=="function"&&i!=="[object RegExp]"||typeof window<"u"&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}return w0}var S0,iS;function c3(){if(iS)return S0;iS=1;var n=um(),t=function(r,o){return o===void 0&&(o=!1),function(s,a,l){if(s){r(s);return}if(a.statusCode>=400&&a.statusCode<=599){var u=l;if(o)if(n.TextDecoder){var h=e(a.headers&&a.headers["content-type"]);try{u=new TextDecoder(h).decode(l)}catch{}}else u=String.fromCharCode.apply(null,new Uint8Array(l));r({cause:u});return}r(null,l)}};function e(i){return i===void 0&&(i=""),i.toLowerCase().split(";").reduce(function(r,o){var s=o.split("="),a=s[0],l=s[1];return a.trim()==="charset"?l.trim():r},"utf-8")}return S0=t,S0}var rS;function f3(){if(rS)return Tc.exports;rS=1;var n=um(),t=h3(),e=d3();a.httpHandler=c3();/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Björklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var i=function(c){var f={};return c&&c.trim().split(`
`).forEach(function(g){var m=g.indexOf(":"),p=g.slice(0,m).trim().toLowerCase(),v=g.slice(m+1).trim();typeof f[p]>"u"?f[p]=v:Array.isArray(f[p])?f[p].push(v):f[p]=[f[p],v]}),f};Tc.exports=a,Tc.exports.default=a,a.XMLHttpRequest=n.XMLHttpRequest||h,a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:n.XDomainRequest,r(["get","put","post","patch","head","delete"],function(d){a[d==="delete"?"del":d]=function(c,f,g){return f=s(c,f,g),f.method=d.toUpperCase(),l(f)}});function r(d,c){for(var f=0;f<d.length;f++)c(d[f])}function o(d){for(var c in d)if(d.hasOwnProperty(c))return!1;return!0}function s(d,c,f){var g=d;return e(c)?(f=c,typeof d=="string"&&(g={uri:d})):g=t({},c,{uri:d}),g.callback=f,g}function a(d,c,f){return c=s(d,c,f),l(c)}function l(d){if(typeof d.callback>"u")throw new Error("callback argument missing");var c=!1,f=function(I,D,H){c||(c=!0,d.callback(I,D,H))};function g(){b.readyState===4&&setTimeout(v,0)}function m(){var L=void 0;if(b.response?L=b.response:L=b.responseText||u(b),x)try{L=JSON.parse(L)}catch{}return L}function p(L){return clearTimeout(E),L instanceof Error||(L=new Error(""+(L||"Unknown XMLHttpRequest Error"))),L.statusCode=0,f(L,M)}function v(){if(!y){var L;clearTimeout(E),d.useXDR&&b.status===void 0?L=200:L=b.status===1223?204:b.status;var I=M,D=null;return L!==0?(I={body:m(),statusCode:L,method:_,headers:{},url:w,rawRequest:b},b.getAllResponseHeaders&&(I.headers=i(b.getAllResponseHeaders()))):D=new Error("Internal XMLHttpRequest Error"),f(D,I,I.body)}}var b=d.xhr||null;b||(d.cors||d.useXDR?b=new a.XDomainRequest:b=new a.XMLHttpRequest);var C,y,w=b.url=d.uri||d.url,_=b.method=d.method||"GET",A=d.body||d.data,T=b.headers=d.headers||{},S=!!d.sync,x=!1,E,M={body:void 0,headers:{},statusCode:0,method:_,url:w,rawRequest:b};if("json"in d&&d.json!==!1&&(x=!0,T.accept||T.Accept||(T.Accept="application/json"),_!=="GET"&&_!=="HEAD"&&(T["content-type"]||T["Content-Type"]||(T["Content-Type"]="application/json"),A=JSON.stringify(d.json===!0?A:d.json))),b.onreadystatechange=g,b.onload=v,b.onerror=p,b.onprogress=function(){},b.onabort=function(){y=!0},b.ontimeout=p,b.open(_,w,!S,d.username,d.password),S||(b.withCredentials=!!d.withCredentials),!S&&d.timeout>0&&(E=setTimeout(function(){if(!y){y=!0,b.abort("timeout");var L=new Error("XMLHttpRequest timeout");L.code="ETIMEDOUT",p(L)}},d.timeout)),b.setRequestHeader)for(C in T)T.hasOwnProperty(C)&&b.setRequestHeader(C,T[C]);else if(d.headers&&!o(d.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in d&&(b.responseType=d.responseType),"beforeSend"in d&&typeof d.beforeSend=="function"&&d.beforeSend(b),b.send(A||null),b}function u(d){try{if(d.responseType==="document")return d.responseXML;var c=d.responseXML&&d.responseXML.documentElement.nodeName==="parsererror";if(d.responseType===""&&!c)return d.responseXML}catch{}return null}function h(){}return Tc.exports}var g3=f3();const iB=no(g3);var x0={exports:{}},T0,nS;function p3(){if(nS)return T0;nS=1;var n=eB(),t=Object.create||function(){function S(){}return function(x){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return S.prototype=x,new S}}();function e(S,x){this.name="ParsingError",this.code=S.code,this.message=x||S.message}e.prototype=t(Error.prototype),e.prototype.constructor=e,e.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function i(S){function x(M,L,I,D){return(M|0)*3600+(L|0)*60+(I|0)+(D|0)/1e3}var E=S.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return E?E[3]?x(E[1],E[2],E[3].replace(":",""),E[4]):E[1]>59?x(E[1],E[2],0,E[4]):x(0,E[1],E[2],E[4]):null}function r(){this.values=t(null)}r.prototype={set:function(S,x){!this.get(S)&&x!==""&&(this.values[S]=x)},get:function(S,x,E){return E?this.has(S)?this.values[S]:x[E]:this.has(S)?this.values[S]:x},has:function(S){return S in this.values},alt:function(S,x,E){for(var M=0;M<E.length;++M)if(x===E[M]){this.set(S,x);break}},integer:function(S,x){/^-?\d+$/.test(x)&&this.set(S,parseInt(x,10))},percent:function(S,x){return x.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(x=parseFloat(x),x>=0&&x<=100)?(this.set(S,x),!0):!1}};function o(S,x,E,M){var L=M?S.split(M):[S];for(var I in L)if(typeof L[I]=="string"){var D=L[I].split(E);if(D.length===2){var H=D[0].trim(),O=D[1].trim();x(H,O)}}}function s(S,x,E){var M=S;function L(){var H=i(S);if(H===null)throw new e(e.Errors.BadTimeStamp,"Malformed timestamp: "+M);return S=S.replace(/^[^\sa-zA-Z-]+/,""),H}function I(H,O){var N=new r;o(H,function(U,W){switch(U){case"region":for(var j=E.length-1;j>=0;j--)if(E[j].id===W){N.set(U,E[j].region);break}break;case"vertical":N.alt(U,W,["rl","lr"]);break;case"line":var Y=W.split(","),Z=Y[0];N.integer(U,Z),N.percent(U,Z)&&N.set("snapToLines",!1),N.alt(U,Z,["auto"]),Y.length===2&&N.alt("lineAlign",Y[1],["start","center","end"]);break;case"position":Y=W.split(","),N.percent(U,Y[0]),Y.length===2&&N.alt("positionAlign",Y[1],["start","center","end"]);break;case"size":N.percent(U,W);break;case"align":N.alt(U,W,["start","center","end","left","right"]);break}},/:/,/\s/),O.region=N.get("region",null),O.vertical=N.get("vertical","");try{O.line=N.get("line","auto")}catch{}O.lineAlign=N.get("lineAlign","start"),O.snapToLines=N.get("snapToLines",!0),O.size=N.get("size",100);try{O.align=N.get("align","center")}catch{O.align=N.get("align","middle")}try{O.position=N.get("position","auto")}catch{O.position=N.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},O.align)}O.positionAlign=N.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},O.align)}function D(){S=S.replace(/^\s+/,"")}if(D(),x.startTime=L(),D(),S.substr(0,3)!=="-->")throw new e(e.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+M);S=S.substr(3),D(),x.endTime=L(),D(),I(S,x)}var a=n.createElement&&n.createElement("textarea"),l={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},u={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},h={v:"title",lang:"lang"},d={rt:"ruby"};function c(S,x){function E(){if(!x)return null;function Z(J){return x=x.substr(J.length),J}var rt=x.match(/^([^<]*)(<[^>]*>?)?/);return Z(rt[1]?rt[1]:rt[2])}function M(Z){return a.innerHTML=Z,Z=a.textContent,a.textContent="",Z}function L(Z,rt){return!d[rt.localName]||d[rt.localName]===Z.localName}function I(Z,rt){var J=l[Z];if(!J)return null;var st=S.document.createElement(J),ht=h[Z];return ht&&rt&&(st[ht]=rt.trim()),st}for(var D=S.document.createElement("div"),H=D,O,N=[];(O=E())!==null;){if(O[0]==="<"){if(O[1]==="/"){N.length&&N[N.length-1]===O.substr(2).replace(">","")&&(N.pop(),H=H.parentNode);continue}var U=i(O.substr(1,O.length-2)),W;if(U){W=S.document.createProcessingInstruction("timestamp",U),H.appendChild(W);continue}var j=O.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!j||(W=I(j[1],j[3]),!W)||!L(H,W))continue;if(j[2]){var Y=j[2].split(".");Y.forEach(function(Z){var rt=/^bg_/.test(Z),J=rt?Z.slice(3):Z;if(u.hasOwnProperty(J)){var st=rt?"background-color":"color",ht=u[J];W.style[st]=ht}}),W.className=Y.join(" ")}N.push(j[1]),H.appendChild(W),H=W;continue}H.appendChild(S.document.createTextNode(M(O)))}return D}var f=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function g(S){for(var x=0;x<f.length;x++){var E=f[x];if(S>=E[0]&&S<=E[1])return!0}return!1}function m(S){var x=[],E="",M;if(!S||!S.childNodes)return"ltr";function L(H,O){for(var N=O.childNodes.length-1;N>=0;N--)H.push(O.childNodes[N])}function I(H){if(!H||!H.length)return null;var O=H.pop(),N=O.textContent||O.innerText;if(N){var U=N.match(/^.*(\n|\r)/);return U?(H.length=0,U[0]):N}if(O.tagName==="ruby")return I(H);if(O.childNodes)return L(H,O),I(H)}for(L(x,S);E=I(x);)for(var D=0;D<E.length;D++)if(M=E.charCodeAt(D),g(M))return"rtl";return"ltr"}function p(S){if(typeof S.line=="number"&&(S.snapToLines||S.line>=0&&S.line<=100))return S.line;if(!S.track||!S.track.textTrackList||!S.track.textTrackList.mediaElement)return-1;for(var x=S.track,E=x.textTrackList,M=0,L=0;L<E.length&&E[L]!==x;L++)E[L].mode==="showing"&&M++;return++M*-1}function v(){}v.prototype.applyStyles=function(S,x){x=x||this.div;for(var E in S)S.hasOwnProperty(E)&&(x.style[E]=S[E])},v.prototype.formatStyle=function(S,x){return S===0?0:S+x};function b(S,x,E){v.call(this),this.cue=x,this.cueDiv=c(S,x.text);var M={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:x.vertical===""?"horizontal-tb":x.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(M,this.cueDiv),this.div=S.document.createElement("div"),M={direction:m(this.cueDiv),writingMode:x.vertical===""?"horizontal-tb":x.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:x.align==="middle"?"center":x.align,font:E.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(M),this.div.appendChild(this.cueDiv);var L=0;switch(x.positionAlign){case"start":case"line-left":L=x.position;break;case"center":L=x.position-x.size/2;break;case"end":case"line-right":L=x.position-x.size;break}x.vertical===""?this.applyStyles({left:this.formatStyle(L,"%"),width:this.formatStyle(x.size,"%")}):this.applyStyles({top:this.formatStyle(L,"%"),height:this.formatStyle(x.size,"%")}),this.move=function(I){this.applyStyles({top:this.formatStyle(I.top,"px"),bottom:this.formatStyle(I.bottom,"px"),left:this.formatStyle(I.left,"px"),right:this.formatStyle(I.right,"px"),height:this.formatStyle(I.height,"px"),width:this.formatStyle(I.width,"px")})}}b.prototype=t(v.prototype),b.prototype.constructor=b;function C(S){var x,E,M,L;if(S.div){E=S.div.offsetHeight,M=S.div.offsetWidth,L=S.div.offsetTop;var I=(I=S.div.childNodes)&&(I=I[0])&&I.getClientRects&&I.getClientRects();S=S.div.getBoundingClientRect(),x=I?Math.max(I[0]&&I[0].height||0,S.height/I.length):0}this.left=S.left,this.right=S.right,this.top=S.top||L,this.height=S.height||E,this.bottom=S.bottom||L+(S.height||E),this.width=S.width||M,this.lineHeight=x!==void 0?x:S.lineHeight}C.prototype.move=function(S,x){switch(x=x!==void 0?x:this.lineHeight,S){case"+x":this.left+=x,this.right+=x;break;case"-x":this.left-=x,this.right-=x;break;case"+y":this.top+=x,this.bottom+=x;break;case"-y":this.top-=x,this.bottom-=x;break}},C.prototype.overlaps=function(S){return this.left<S.right&&this.right>S.left&&this.top<S.bottom&&this.bottom>S.top},C.prototype.overlapsAny=function(S){for(var x=0;x<S.length;x++)if(this.overlaps(S[x]))return!0;return!1},C.prototype.within=function(S){return this.top>=S.top&&this.bottom<=S.bottom&&this.left>=S.left&&this.right<=S.right},C.prototype.overlapsOppositeAxis=function(S,x){switch(x){case"+x":return this.left<S.left;case"-x":return this.right>S.right;case"+y":return this.top<S.top;case"-y":return this.bottom>S.bottom}},C.prototype.intersectPercentage=function(S){var x=Math.max(0,Math.min(this.right,S.right)-Math.max(this.left,S.left)),E=Math.max(0,Math.min(this.bottom,S.bottom)-Math.max(this.top,S.top)),M=x*E;return M/(this.height*this.width)},C.prototype.toCSSCompatValues=function(S){return{top:this.top-S.top,bottom:S.bottom-this.bottom,left:this.left-S.left,right:S.right-this.right,height:this.height,width:this.width}},C.getSimpleBoxPosition=function(S){var x=S.div?S.div.offsetHeight:S.tagName?S.offsetHeight:0,E=S.div?S.div.offsetWidth:S.tagName?S.offsetWidth:0,M=S.div?S.div.offsetTop:S.tagName?S.offsetTop:0;S=S.div?S.div.getBoundingClientRect():S.tagName?S.getBoundingClientRect():S;var L={left:S.left,right:S.right,top:S.top||M,height:S.height||x,bottom:S.bottom||M+(S.height||x),width:S.width||E};return L};function y(S,x,E,M){function L(J,st){for(var ht,at=new C(J),lt=1,_t=0;_t<st.length;_t++){for(;J.overlapsOppositeAxis(E,st[_t])||J.within(E)&&J.overlapsAny(M);)J.move(st[_t]);if(J.within(E))return J;var vt=J.intersectPercentage(E);lt>vt&&(ht=new C(J),lt=vt),J=new C(at)}return ht||at}var I=new C(x),D=x.cue,H=p(D),O=[];if(D.snapToLines){var N;switch(D.vertical){case"":O=["+y","-y"],N="height";break;case"rl":O=["+x","-x"],N="width";break;case"lr":O=["-x","+x"],N="width";break}var U=I.lineHeight,W=U*Math.round(H),j=E[N]+U,Y=O[0];Math.abs(W)>j&&(W=W<0?-1:1,W*=Math.ceil(j/U)*U),H<0&&(W+=D.vertical===""?E.height:E.width,O=O.reverse()),I.move(Y,W)}else{var Z=I.lineHeight/E.height*100;switch(D.lineAlign){case"center":H-=Z/2;break;case"end":H-=Z;break}switch(D.vertical){case"":x.applyStyles({top:x.formatStyle(H,"%")});break;case"rl":x.applyStyles({left:x.formatStyle(H,"%")});break;case"lr":x.applyStyles({right:x.formatStyle(H,"%")});break}O=["+y","-x","+x","-y"],I=new C(x)}var rt=L(I,O);x.move(rt.toCSSCompatValues(E))}function w(){}w.StringDecoder=function(){return{decode:function(S){if(!S)return"";if(typeof S!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(S))}}},w.convertCueToDOMTree=function(S,x){return!S||!x?null:c(S,x)};var _=.05,A="sans-serif",T="1.5%";return w.processCues=function(S,x,E){if(!S||!x||!E)return null;for(;E.firstChild;)E.removeChild(E.firstChild);var M=S.document.createElement("div");M.style.position="absolute",M.style.left="0",M.style.right="0",M.style.top="0",M.style.bottom="0",M.style.margin=T,E.appendChild(M);function L(U){for(var W=0;W<U.length;W++)if(U[W].hasBeenReset||!U[W].displayState)return!0;return!1}if(!L(x)){for(var I=0;I<x.length;I++)M.appendChild(x[I].displayState);return}var D=[],H=C.getSimpleBoxPosition(M),O=Math.round(H.height*_*100)/100,N={font:O+"px "+A};(function(){for(var U,W,j=0;j<x.length;j++)W=x[j],U=new b(S,W,N),M.appendChild(U.div),y(S,U,H,D),W.displayState=U.div,D.push(C.getSimpleBoxPosition(U))})()},w.Parser=function(S,x,E){E||(E=x,x={}),x||(x={}),this.window=S,this.vttjs=x,this.state="INITIAL",this.buffer="",this.decoder=E||new TextDecoder("utf8"),this.regionList=[]},w.Parser.prototype={reportOrThrowError:function(S){if(S instanceof e)this.onparsingerror&&this.onparsingerror(S);else throw S},parse:function(S){var x=this;S&&(x.buffer+=x.decoder.decode(S,{stream:!0}));function E(){for(var U=x.buffer,W=0;W<U.length&&U[W]!=="\r"&&U[W]!==`
`;)++W;var j=U.substr(0,W);return U[W]==="\r"&&++W,U[W]===`
`&&++W,x.buffer=U.substr(W),j}function M(U){var W=new r;if(o(U,function(Y,Z){switch(Y){case"id":W.set(Y,Z);break;case"width":W.percent(Y,Z);break;case"lines":W.integer(Y,Z);break;case"regionanchor":case"viewportanchor":var rt=Z.split(",");if(rt.length!==2)break;var J=new r;if(J.percent("x",rt[0]),J.percent("y",rt[1]),!J.has("x")||!J.has("y"))break;W.set(Y+"X",J.get("x")),W.set(Y+"Y",J.get("y"));break;case"scroll":W.alt(Y,Z,["up"]);break}},/=/,/\s/),W.has("id")){var j=new(x.vttjs.VTTRegion||x.window.VTTRegion);j.width=W.get("width",100),j.lines=W.get("lines",3),j.regionAnchorX=W.get("regionanchorX",0),j.regionAnchorY=W.get("regionanchorY",100),j.viewportAnchorX=W.get("viewportanchorX",0),j.viewportAnchorY=W.get("viewportanchorY",100),j.scroll=W.get("scroll",""),x.onregion&&x.onregion(j),x.regionList.push({id:W.get("id"),region:j})}}function L(U){var W=new r;o(U,function(j,Y){switch(j){case"MPEGT":W.integer(j+"S",Y);break;case"LOCA":W.set(j+"L",i(Y));break}},/[^\d]:/,/,/),x.ontimestampmap&&x.ontimestampmap({MPEGTS:W.get("MPEGTS"),LOCAL:W.get("LOCAL")})}function I(U){U.match(/X-TIMESTAMP-MAP/)?o(U,function(W,j){switch(W){case"X-TIMESTAMP-MAP":L(j);break}},/=/):o(U,function(W,j){switch(W){case"Region":M(j);break}},/:/)}try{var D;if(x.state==="INITIAL"){if(!/\r\n|\n/.test(x.buffer))return this;D=E();var H=D.match(/^WEBVTT([ \t].*)?$/);if(!H||!H[0])throw new e(e.Errors.BadSignature);x.state="HEADER"}for(var O=!1;x.buffer;){if(!/\r\n|\n/.test(x.buffer))return this;switch(O?O=!1:D=E(),x.state){case"HEADER":/:/.test(D)?I(D):D||(x.state="ID");continue;case"NOTE":D||(x.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(D)){x.state="NOTE";break}if(!D)continue;x.cue=new(x.vttjs.VTTCue||x.window.VTTCue)(0,0,"");try{x.cue.align="center"}catch{x.cue.align="middle"}if(x.state="CUE",D.indexOf("-->")===-1){x.cue.id=D;continue}case"CUE":try{s(D,x.cue,x.regionList)}catch(U){x.reportOrThrowError(U),x.cue=null,x.state="BADCUE";continue}x.state="CUETEXT";continue;case"CUETEXT":var N=D.indexOf("-->")!==-1;if(!D||N&&(O=!0)){x.oncue&&x.oncue(x.cue),x.cue=null,x.state="ID";continue}x.cue.text&&(x.cue.text+=`
`),x.cue.text+=D.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":D||(x.state="ID");continue}}}catch(U){x.reportOrThrowError(U),x.state==="CUETEXT"&&x.cue&&x.oncue&&x.oncue(x.cue),x.cue=null,x.state=x.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var S=this;try{if(S.buffer+=S.decoder.decode(),(S.cue||S.state==="HEADER")&&(S.buffer+=`

`,S.parse()),S.state==="INITIAL")throw new e(e.Errors.BadSignature)}catch(x){S.reportOrThrowError(x)}return S.onflush&&S.onflush(),this}},T0=w,T0}var A0,oS;function m3(){if(oS)return A0;oS=1;var n="auto",t={"":1,lr:1,rl:1},e={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function i(s){if(typeof s!="string")return!1;var a=t[s.toLowerCase()];return a?s.toLowerCase():!1}function r(s){if(typeof s!="string")return!1;var a=e[s.toLowerCase()];return a?s.toLowerCase():!1}function o(s,a,l){this.hasBeenReset=!1;var u="",h=!1,d=s,c=a,f=l,g=null,m="",p=!0,v="auto",b="start",C="auto",y="auto",w=100,_="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return u},set:function(A){u=""+A}},pauseOnExit:{enumerable:!0,get:function(){return h},set:function(A){h=!!A}},startTime:{enumerable:!0,get:function(){return d},set:function(A){if(typeof A!="number")throw new TypeError("Start time must be set to a number.");d=A,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return c},set:function(A){if(typeof A!="number")throw new TypeError("End time must be set to a number.");c=A,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return f},set:function(A){f=""+A,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return g},set:function(A){g=A,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return m},set:function(A){var T=i(A);if(T===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");m=T,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return p},set:function(A){p=!!A,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return v},set:function(A){if(typeof A!="number"&&A!==n)throw new SyntaxError("Line: an invalid number or illegal string was specified.");v=A,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return b},set:function(A){var T=r(A);T?(b=T,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return C},set:function(A){if(A<0||A>100)throw new Error("Position must be between 0 and 100.");C=A,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return y},set:function(A){var T=r(A);T?(y=T,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return w},set:function(A){if(A<0||A>100)throw new Error("Size must be between 0 and 100.");w=A,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return _},set:function(A){var T=r(A);if(!T)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");_=T,this.hasBeenReset=!0}}}),this.displayState=void 0}return o.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},A0=o,A0}var R0,sS;function v3(){if(sS)return R0;sS=1;var n={"":!0,up:!0};function t(r){if(typeof r!="string")return!1;var o=n[r.toLowerCase()];return o?r.toLowerCase():!1}function e(r){return typeof r=="number"&&r>=0&&r<=100}function i(){var r=100,o=3,s=0,a=100,l=0,u=100,h="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return r},set:function(d){if(!e(d))throw new Error("Width must be between 0 and 100.");r=d}},lines:{enumerable:!0,get:function(){return o},set:function(d){if(typeof d!="number")throw new TypeError("Lines must be set to a number.");o=d}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(d){if(!e(d))throw new Error("RegionAnchorX must be between 0 and 100.");a=d}},regionAnchorX:{enumerable:!0,get:function(){return s},set:function(d){if(!e(d))throw new Error("RegionAnchorY must be between 0 and 100.");s=d}},viewportAnchorY:{enumerable:!0,get:function(){return u},set:function(d){if(!e(d))throw new Error("ViewportAnchorY must be between 0 and 100.");u=d}},viewportAnchorX:{enumerable:!0,get:function(){return l},set:function(d){if(!e(d))throw new Error("ViewportAnchorX must be between 0 and 100.");l=d}},scroll:{enumerable:!0,get:function(){return h},set:function(d){var c=t(d);c===!1?console.warn("Scroll: an invalid or illegal string was specified."):h=c}}})}return R0=i,R0}var aS;function b3(){if(aS)return x0.exports;aS=1;var n=um(),t=x0.exports={WebVTT:p3(),VTTCue:m3(),VTTRegion:v3()};n.vttjs=t,n.WebVTT=t.WebVTT;var e=t.VTTCue,i=t.VTTRegion,r=n.VTTCue,o=n.VTTRegion;return t.shim=function(){n.VTTCue=e,n.VTTRegion=i},t.restore=function(){n.VTTCue=r,n.VTTRegion=o},n.VTTCue||t.shim(),x0.exports}var _3=b3();const lS=no(_3);function rB(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rB=function(){return!!n})()}function nB(n,t,e){if(rB())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var r=new(n.bind.apply(n,i));return e&&su(r,e.prototype),r}function C3(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&su(n,t)}var E0={exports:{}},uS;function y3(){return uS||(uS=1,function(n,t){(function(e){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,u,h){if(h=h||{},l=l.trim(),u=u.trim(),!u){if(!h.alwaysNormalize)return l;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=a.normalizePath(d.path),a.buildURLFromParts(d)}var c=a.parseURL(u);if(!c)throw new Error("Error trying to parse relative URL.");if(c.scheme)return h.alwaysNormalize?(c.path=a.normalizePath(c.path),a.buildURLFromParts(c)):u;var f=a.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");if(!f.netLoc&&f.path&&f.path[0]!=="/"){var g=r.exec(f.path);f.netLoc=g[1],f.path=g[2]}f.netLoc&&!f.path&&(f.path="/");var m={scheme:f.scheme,netLoc:c.netLoc,path:null,params:c.params,query:c.query,fragment:c.fragment};if(!c.netLoc&&(m.netLoc=f.netLoc,c.path[0]!=="/"))if(!c.path)m.path=f.path,c.params||(m.params=f.params,c.query||(m.query=f.query));else{var p=f.path,v=p.substring(0,p.lastIndexOf("/")+1)+c.path;m.path=a.normalizePath(v)}return m.path===null&&(m.path=h.alwaysNormalize?a.normalizePath(c.path):c.path),a.buildURLFromParts(m)},parseURL:function(l){var u=i.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(o,"");l.length!==(l=l.replace(s,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=a})()}(E0)),E0.exports}var w3=y3();const hS=no(w3);var dS="http://example.com",hm=function(t,e){if(/^[a-z]+:/i.test(e))return e;/^data:/.test(t)&&(t=K.location&&K.location.href||"");var i=typeof K.URL=="function",r=/^\/\//.test(t),o=!K.location&&!/\/\//i.test(t);if(i?t=new K.URL(t,K.location||dS):/\/\//i.test(t)||(t=hS.buildAbsoluteURL(K.location&&K.location.href||"",t)),i){var s=new URL(e,t);return o?s.href.slice(dS.length):r?s.href.slice(s.protocol.length):s.href}return hS.buildAbsoluteURL(t,e)},gy=function(){function n(){this.listeners={}}var t=n.prototype;return t.on=function(i,r){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(r)},t.off=function(i,r){if(!this.listeners[i])return!1;var o=this.listeners[i].indexOf(r);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(o,1),o>-1},t.trigger=function(i){var r=this.listeners[i];if(r)if(arguments.length===2)for(var o=r.length,s=0;s<o;++s)r[s].call(this,arguments[1]);else for(var a=Array.prototype.slice.call(arguments,1),l=r.length,u=0;u<l;++u)r[u].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(i){this.on("data",function(r){i.push(r)})},n}(),S3=function(t){return K.atob?K.atob(t):Buffer.from(t,"base64").toString("binary")};function oB(n){for(var t=S3(n),e=new Uint8Array(t.length),i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}/*! @name m3u8-parser @version 4.8.0 @license Apache-2.0 */var x3=function(n){kt(t,n);function t(){var i;return i=n.call(this)||this,i.buffer="",i}var e=t.prototype;return e.push=function(r){var o;for(this.buffer+=r,o=this.buffer.indexOf(`
`);o>-1;o=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,o)),this.buffer=this.buffer.substring(o+1)},t}(gy),T3="	",M0=function(t){var e=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},A3=function(){var t="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+t+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},Hn=function(t){for(var e=t.split(A3()),i={},r=e.length,o;r--;)e[r]!==""&&(o=/([^=]*)=(.*)/.exec(e[r]).slice(1),o[0]=o[0].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^['"](.*)['"]$/g,"$1"),i[o[0]]=o[1]);return i},R3=function(n){kt(t,n);function t(){var i;return i=n.call(this)||this,i.customParsers=[],i.tagMappers=[],i}var e=t.prototype;return e.push=function(r){var o=this,s,a;if(r=r.trim(),r.length!==0){if(r[0]!=="#"){this.trigger("data",{type:"uri",uri:r});return}var l=this.tagMappers.reduce(function(u,h){var d=h(r);return d===r?u:u.concat([d])},[r]);l.forEach(function(u){for(var h=0;h<o.customParsers.length;h++)if(o.customParsers[h].call(o,u))return;if(u.indexOf("#EXT")!==0){o.trigger("data",{type:"comment",text:u.slice(1)});return}if(u=u.replace("\r",""),s=/^#EXTM3U/.exec(u),s){o.trigger("data",{type:"tag",tagType:"m3u"});return}if(s=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(u),s){a={type:"tag",tagType:"inf"},s[1]&&(a.duration=parseFloat(s[1])),s[2]&&(a.title=s[2]),o.trigger("data",a);return}if(s=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(u),s){a={type:"tag",tagType:"targetduration"},s[1]&&(a.duration=parseInt(s[1],10)),o.trigger("data",a);return}if(s=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(u),s){a={type:"tag",tagType:"version"},s[1]&&(a.version=parseInt(s[1],10)),o.trigger("data",a);return}if(s=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(u),s){a={type:"tag",tagType:"media-sequence"},s[1]&&(a.number=parseInt(s[1],10)),o.trigger("data",a);return}if(s=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(u),s){a={type:"tag",tagType:"discontinuity-sequence"},s[1]&&(a.number=parseInt(s[1],10)),o.trigger("data",a);return}if(s=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(u),s){a={type:"tag",tagType:"playlist-type"},s[1]&&(a.playlistType=s[1]),o.trigger("data",a);return}if(s=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(u),s){a=Jn(M0(s[1]),{type:"tag",tagType:"byterange"}),o.trigger("data",a);return}if(s=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(u),s){a={type:"tag",tagType:"allow-cache"},s[1]&&(a.allowed=!/NO/.test(s[1])),o.trigger("data",a);return}if(s=/^#EXT-X-MAP:?(.*)$/.exec(u),s){if(a={type:"tag",tagType:"map"},s[1]){var d=Hn(s[1]);d.URI&&(a.uri=d.URI),d.BYTERANGE&&(a.byterange=M0(d.BYTERANGE))}o.trigger("data",a);return}if(s=/^#EXT-X-STREAM-INF:?(.*)$/.exec(u),s){if(a={type:"tag",tagType:"stream-inf"},s[1]){if(a.attributes=Hn(s[1]),a.attributes.RESOLUTION){var c=a.attributes.RESOLUTION.split("x"),f={};c[0]&&(f.width=parseInt(c[0],10)),c[1]&&(f.height=parseInt(c[1],10)),a.attributes.RESOLUTION=f}a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes["FRAME-RATE"]&&(a.attributes["FRAME-RATE"]=parseFloat(a.attributes["FRAME-RATE"])),a.attributes["PROGRAM-ID"]&&(a.attributes["PROGRAM-ID"]=parseInt(a.attributes["PROGRAM-ID"],10))}o.trigger("data",a);return}if(s=/^#EXT-X-MEDIA:?(.*)$/.exec(u),s){a={type:"tag",tagType:"media"},s[1]&&(a.attributes=Hn(s[1])),o.trigger("data",a);return}if(s=/^#EXT-X-ENDLIST/.exec(u),s){o.trigger("data",{type:"tag",tagType:"endlist"});return}if(s=/^#EXT-X-DISCONTINUITY/.exec(u),s){o.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(s=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(u),s){a={type:"tag",tagType:"program-date-time"},s[1]&&(a.dateTimeString=s[1],a.dateTimeObject=new Date(s[1])),o.trigger("data",a);return}if(s=/^#EXT-X-KEY:?(.*)$/.exec(u),s){a={type:"tag",tagType:"key"},s[1]&&(a.attributes=Hn(s[1]),a.attributes.IV&&(a.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(a.attributes.IV=a.attributes.IV.substring(2)),a.attributes.IV=a.attributes.IV.match(/.{8}/g),a.attributes.IV[0]=parseInt(a.attributes.IV[0],16),a.attributes.IV[1]=parseInt(a.attributes.IV[1],16),a.attributes.IV[2]=parseInt(a.attributes.IV[2],16),a.attributes.IV[3]=parseInt(a.attributes.IV[3],16),a.attributes.IV=new Uint32Array(a.attributes.IV))),o.trigger("data",a);return}if(s=/^#EXT-X-START:?(.*)$/.exec(u),s){a={type:"tag",tagType:"start"},s[1]&&(a.attributes=Hn(s[1]),a.attributes["TIME-OFFSET"]=parseFloat(a.attributes["TIME-OFFSET"]),a.attributes.PRECISE=/YES/.test(a.attributes.PRECISE)),o.trigger("data",a);return}if(s=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(u),s){a={type:"tag",tagType:"cue-out-cont"},s[1]?a.data=s[1]:a.data="",o.trigger("data",a);return}if(s=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(u),s){a={type:"tag",tagType:"cue-out"},s[1]?a.data=s[1]:a.data="",o.trigger("data",a);return}if(s=/^#EXT-X-CUE-IN:?(.*)?$/.exec(u),s){a={type:"tag",tagType:"cue-in"},s[1]?a.data=s[1]:a.data="",o.trigger("data",a);return}if(s=/^#EXT-X-SKIP:(.*)$/.exec(u),s&&s[1]){a={type:"tag",tagType:"skip"},a.attributes=Hn(s[1]),a.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(a.attributes["SKIPPED-SEGMENTS"]=parseInt(a.attributes["SKIPPED-SEGMENTS"],10)),a.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(a.attributes["RECENTLY-REMOVED-DATERANGES"]=a.attributes["RECENTLY-REMOVED-DATERANGES"].split(T3)),o.trigger("data",a);return}if(s=/^#EXT-X-PART:(.*)$/.exec(u),s&&s[1]){a={type:"tag",tagType:"part"},a.attributes=Hn(s[1]),["DURATION"].forEach(function(g){a.attributes.hasOwnProperty(g)&&(a.attributes[g]=parseFloat(a.attributes[g]))}),["INDEPENDENT","GAP"].forEach(function(g){a.attributes.hasOwnProperty(g)&&(a.attributes[g]=/YES/.test(a.attributes[g]))}),a.attributes.hasOwnProperty("BYTERANGE")&&(a.attributes.byterange=M0(a.attributes.BYTERANGE)),o.trigger("data",a);return}if(s=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(u),s&&s[1]){a={type:"tag",tagType:"server-control"},a.attributes=Hn(s[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(g){a.attributes.hasOwnProperty(g)&&(a.attributes[g]=parseFloat(a.attributes[g]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(g){a.attributes.hasOwnProperty(g)&&(a.attributes[g]=/YES/.test(a.attributes[g]))}),o.trigger("data",a);return}if(s=/^#EXT-X-PART-INF:(.*)$/.exec(u),s&&s[1]){a={type:"tag",tagType:"part-inf"},a.attributes=Hn(s[1]),["PART-TARGET"].forEach(function(g){a.attributes.hasOwnProperty(g)&&(a.attributes[g]=parseFloat(a.attributes[g]))}),o.trigger("data",a);return}if(s=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(u),s&&s[1]){a={type:"tag",tagType:"preload-hint"},a.attributes=Hn(s[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(g){if(a.attributes.hasOwnProperty(g)){a.attributes[g]=parseInt(a.attributes[g],10);var m=g==="BYTERANGE-LENGTH"?"length":"offset";a.attributes.byterange=a.attributes.byterange||{},a.attributes.byterange[m]=a.attributes[g],delete a.attributes[g]}}),o.trigger("data",a);return}if(s=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(u),s&&s[1]){a={type:"tag",tagType:"rendition-report"},a.attributes=Hn(s[1]),["LAST-MSN","LAST-PART"].forEach(function(g){a.attributes.hasOwnProperty(g)&&(a.attributes[g]=parseInt(a.attributes[g],10))}),o.trigger("data",a);return}o.trigger("data",{type:"tag",data:u.slice(4)})})}},e.addParser=function(r){var o=this,s=r.expression,a=r.customType,l=r.dataParser,u=r.segment;typeof l!="function"&&(l=function(d){return d}),this.customParsers.push(function(h){var d=s.exec(h);if(d)return o.trigger("data",{type:"custom",data:l(h),customType:a,segment:u}),!0})},e.addTagMapper=function(r){var o=r.expression,s=r.map,a=function(u){return o.test(u)?s(u):u};this.tagMappers.push(a)},t}(gy),E3=function(t){return t.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},hl=function(t){var e={};return Object.keys(t).forEach(function(i){e[E3(i)]=t[i]}),e},B0=function(t){var e=t.serverControl,i=t.targetDuration,r=t.partTargetDuration;if(e){var o="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",l=i&&i*3,u=r&&r*2;i&&!e.hasOwnProperty(s)&&(e[s]=l,this.trigger("info",{message:o+" defaulting HOLD-BACK to targetDuration * 3 ("+l+")."})),l&&e[s]<l&&(this.trigger("warn",{message:o+" clamping HOLD-BACK ("+e[s]+") to targetDuration * 3 ("+l+")"}),e[s]=l),r&&!e.hasOwnProperty(a)&&(e[a]=r*3,this.trigger("info",{message:o+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+e[a]+")."})),r&&e[a]<u&&(this.trigger("warn",{message:o+" clamping PART-HOLD-BACK ("+e[a]+") to partTargetDuration * 2 ("+u+")."}),e[a]=u)}},M3=function(n){kt(t,n);function t(){var i;i=n.call(this)||this,i.lineStream=new x3,i.parseStream=new R3,i.lineStream.pipe(i.parseStream);var r=he(i),o=[],s={},a,l,u=!1,h=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",f=0;i.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var g=0,m=0;return i.on("end",function(){s.uri||!s.parts&&!s.preloadHints||(!s.map&&a&&(s.map=a),!s.key&&l&&(s.key=l),!s.timeline&&typeof f=="number"&&(s.timeline=f),i.manifest.preloadSegment=s)}),i.parseStream.on("data",function(p){var v,b;({tag:function(){({version:function(){p.version&&(this.manifest.version=p.version)},"allow-cache":function(){this.manifest.allowCache=p.allowed,"allowed"in p||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var w={};"length"in p&&(s.byterange=w,w.length=p.length,"offset"in p||(p.offset=g)),"offset"in p&&(s.byterange=w,w.offset=p.offset),g=w.offset+w.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),p.duration>0&&(s.duration=p.duration),p.duration===0&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key:function(){if(!p.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(p.attributes.METHOD==="NONE"){l=null;return}if(!p.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(p.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:p.attributes};return}if(p.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:p.attributes.URI};return}if(p.attributes.KEYFORMAT===c){var w=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(w.indexOf(p.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(p.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),p.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(p.attributes.KEYID&&p.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:p.attributes.KEYFORMAT,keyId:p.attributes.KEYID.substring(2)},pssh:oB(p.attributes.URI.split(",")[1])};return}p.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),l={method:p.attributes.METHOD||"AES-128",uri:p.attributes.URI},typeof p.attributes.IV<"u"&&(l.iv=p.attributes.IV)},"media-sequence":function(){if(!isFinite(p.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+p.number});return}this.manifest.mediaSequence=p.number},"discontinuity-sequence":function(){if(!isFinite(p.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+p.number});return}this.manifest.discontinuitySequence=p.number,f=p.number},"playlist-type":function(){if(!/VOD|EVENT/.test(p.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+p.playlist});return}this.manifest.playlistType=p.playlistType},map:function(){a={},p.uri&&(a.uri=p.uri),p.byterange&&(a.byterange=p.byterange),l&&(a.key=l)},"stream-inf":function(){if(this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||d,!p.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}s.attributes||(s.attributes={}),Jn(s.attributes,p.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||d,!(p.attributes&&p.attributes.TYPE&&p.attributes["GROUP-ID"]&&p.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var w=this.manifest.mediaGroups[p.attributes.TYPE];w[p.attributes["GROUP-ID"]]=w[p.attributes["GROUP-ID"]]||{},v=w[p.attributes["GROUP-ID"]],b={default:/yes/i.test(p.attributes.DEFAULT)},b.default?b.autoselect=!0:b.autoselect=/yes/i.test(p.attributes.AUTOSELECT),p.attributes.LANGUAGE&&(b.language=p.attributes.LANGUAGE),p.attributes.URI&&(b.uri=p.attributes.URI),p.attributes["INSTREAM-ID"]&&(b.instreamId=p.attributes["INSTREAM-ID"]),p.attributes.CHARACTERISTICS&&(b.characteristics=p.attributes.CHARACTERISTICS),p.attributes.FORCED&&(b.forced=/yes/i.test(p.attributes.FORCED)),v[p.attributes.NAME]=b},discontinuity:function(){f+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=p.dateTimeString,this.manifest.dateTimeObject=p.dateTimeObject),s.dateTimeString=p.dateTimeString,s.dateTimeObject=p.dateTimeObject},targetduration:function(){if(!isFinite(p.duration)||p.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+p.duration});return}this.manifest.targetDuration=p.duration,B0.call(this,this.manifest)},start:function(){if(!p.attributes||isNaN(p.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:p.attributes["TIME-OFFSET"],precise:p.attributes.PRECISE}},"cue-out":function(){s.cueOut=p.data},"cue-out-cont":function(){s.cueOutCont=p.data},"cue-in":function(){s.cueIn=p.data},skip:function(){this.manifest.skip=hl(p.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",p.attributes,["SKIPPED-SEGMENTS"])},part:function(){var w=this;u=!0;var _=this.manifest.segments.length,A=hl(p.attributes);s.parts=s.parts||[],s.parts.push(A),A.byterange&&(A.byterange.hasOwnProperty("offset")||(A.byterange.offset=m),m=A.byterange.offset+A.byterange.length);var T=s.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+T+" for segment #"+_,p.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(S,x){S.hasOwnProperty("lastPart")||w.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+x+" lacks required attribute(s): LAST-PART"})})},"server-control":function(){var w=this.manifest.serverControl=hl(p.attributes);w.hasOwnProperty("canBlockReload")||(w.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),B0.call(this,this.manifest),w.canSkipDateranges&&!w.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var w=this.manifest.segments.length,_=hl(p.attributes),A=_.type&&_.type==="PART";s.preloadHints=s.preloadHints||[],s.preloadHints.push(_),_.byterange&&(_.byterange.hasOwnProperty("offset")||(_.byterange.offset=A?m:0,A&&(m=_.byterange.offset+_.byterange.length)));var T=s.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+T+" for segment #"+w,p.attributes,["TYPE","URI"]),!!_.type)for(var S=0;S<s.preloadHints.length-1;S++){var x=s.preloadHints[S];x.type&&x.type===_.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+T+" for segment #"+w+" has the same TYPE "+_.type+" as preload hint #"+S})}},"rendition-report":function(){var w=hl(p.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(w);var _=this.manifest.renditionReports.length-1,A=["LAST-MSN","URI"];u&&A.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+_,p.attributes,A)},"part-inf":function(){this.manifest.partInf=hl(p.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",p.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),B0.call(this,this.manifest)}}[p.tagType]||h).call(r)},uri:function(){s.uri=p.uri,o.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),l&&(s.key=l),s.timeline=f,a&&(s.map=a),m=0,s={}},comment:function(){},custom:function(){p.segment?(s.custom=s.custom||{},s.custom[p.customType]=p.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[p.customType]=p.data)}})[p.type].call(r)}),i}var e=t.prototype;return e.warnOnMissingAttributes_=function(r,o,s){var a=[];s.forEach(function(l){o.hasOwnProperty(l)||a.push(l)}),a.length&&this.trigger("warn",{message:r+" lacks required attribute(s): "+a.join(", ")})},e.push=function(r){this.lineStream.push(r)},e.end=function(){this.lineStream.push(`
`),this.trigger("end")},e.addParser=function(r){this.parseStream.addParser(r)},e.addTagMapper=function(r){this.parseStream.addTagMapper(r)},t}(gy),Ha={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},B3=["video","audio","text"],cS=["Video","Audio","Text"],sB=function(t){return t&&t.replace(/avc1\.(\d+)\.(\d+)/i,function(e,i,r){var o=("00"+Number(i).toString(16)).slice(-2),s=("00"+Number(r).toString(16)).slice(-2);return"avc1."+o+"00"+s})},vo=function(t){t===void 0&&(t="");var e=t.split(","),i=[];return e.forEach(function(r){r=r.trim();var o;B3.forEach(function(s){var a=Ha[s].exec(r.toLowerCase());if(!(!a||a.length<=1)){o=s;var l=r.substring(0,a[1].length),u=r.replace(l,"");i.push({type:l,details:u,mediaType:s})}}),o||i.push({type:r,details:"",mediaType:"unknown"})}),i},P3=function(t,e){if(!t.mediaGroups.AUDIO||!e)return null;var i=t.mediaGroups.AUDIO[e];if(!i)return null;for(var r in i){var o=i[r];if(o.default&&o.playlists)return vo(o.playlists[0].attributes.CODECS)}return null},aB=function(t){return t===void 0&&(t=""),Ha.audio.test(t.trim().toLowerCase())},k3=function(t){return t===void 0&&(t=""),Ha.text.test(t.trim().toLowerCase())},id=function(t){if(!(!t||typeof t!="string")){var e=t.toLowerCase().split(",").map(function(o){return sB(o.trim())}),i="video";e.length===1&&aB(e[0])?i="audio":e.length===1&&k3(e[0])&&(i="application");var r="mp4";return e.every(function(o){return Ha.mp4.test(o)})?r="mp4":e.every(function(o){return Ha.webm.test(o)})?r="webm":e.every(function(o){return Ha.ogg.test(o)})&&(r="ogg"),i+"/"+r+';codecs="'+t+'"'}},yf=function(t){return t===void 0&&(t=""),K.MediaSource&&K.MediaSource.isTypeSupported&&K.MediaSource.isTypeSupported(id(t))||!1},P0=function(t){return t===void 0&&(t=""),t.toLowerCase().split(",").every(function(e){e=e.trim();for(var i=0;i<cS.length;i++){var r=cS[i];if(Ha["muxer"+r].test(e))return!0}return!1})},fS="mp4a.40.2",L3="avc1.4d400d",D3=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,I3=/^application\/dash\+xml/i,lB=function(t){return D3.test(t)?"hls":I3.test(t)?"dash":t==="application/vnd.videojs.vhs+json"?"vhs-json":null},F3=function(t){return t.toString(2).length},O3=function(t){return Math.ceil(F3(t)/8)},uB=function(t){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer},H3=function(t){return uB(t)},ee=function(t){return t instanceof Uint8Array?t:(!Array.isArray(t)&&!H3(t)&&!(t instanceof ArrayBuffer)&&(typeof t!="number"||typeof t=="number"&&t!==t?t=0:t=[t]),new Uint8Array(t&&t.buffer||t,t&&t.byteOffset||0,t&&t.byteLength||0))},er=K.BigInt||Number,qb=[er("0x1"),er("0x100"),er("0x10000"),er("0x1000000"),er("0x100000000"),er("0x10000000000"),er("0x1000000000000"),er("0x100000000000000"),er("0x10000000000000000")];(function(){var n=new Uint16Array([65484]),t=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);return t[0]===255?"big":t[0]===204?"little":"unknown"})();var z3=function(t,e){var i=e===void 0?{}:e,r=i.signed,o=r===void 0?!1:r,s=i.le,a=s===void 0?!1:s;t=ee(t);var l=a?"reduce":"reduceRight",u=t[l]?t[l]:Array.prototype[l],h=u.call(t,function(c,f,g){var m=a?g:Math.abs(g+1-t.length);return c+er(f)*qb[m]},er(0));if(o){var d=qb[t.length]/er(2)-er(1);h=er(h),h>d&&(h-=d,h-=d,h-=er(2))}return Number(h)},N3=function(t,e){var i={},r=i.le,o=r===void 0?!1:r;(typeof t!="bigint"&&typeof t!="number"||typeof t=="number"&&t!==t)&&(t=0),t=er(t);for(var s=O3(t),a=new Uint8Array(new ArrayBuffer(s)),l=0;l<s;l++){var u=o?l:Math.abs(l+1-a.length);a[u]=Number(t/qb[l]&er(255)),t<0&&(a[u]=Math.abs(~a[u]),a[u]-=l===0?1:2)}return a},hB=function(t,e){if(typeof t!="string"&&t&&typeof t.toString=="function"&&(t=t.toString()),typeof t!="string")return new Uint8Array;e||(t=unescape(encodeURIComponent(t)));for(var i=new Uint8Array(t.length),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i},W3=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e=e.filter(function(a){return a&&(a.byteLength||a.length)&&typeof a!="string"}),e.length<=1)return ee(e[0]);var r=e.reduce(function(a,l,u){return a+(l.byteLength||l.length)},0),o=new Uint8Array(r),s=0;return e.forEach(function(a){a=ee(a),o.set(a,s),s+=a.byteLength}),o},si=function(t,e,i){var r=i===void 0?{}:i,o=r.offset,s=o===void 0?0:o,a=r.mask,l=a===void 0?[]:a;t=ee(t),e=ee(e);var u=e.every?e.every:Array.prototype.every;return e.length&&t.length-s>=e.length&&u.call(e,function(h,d){var c=l[d]?l[d]&t[s+d]:t[s+d];return h===c})},U3=function(t,e,i){e.forEach(function(r){for(var o in t.mediaGroups[r])for(var s in t.mediaGroups[r][o]){var a=t.mediaGroups[r][o][s];i(a,r,o,s)}})},th={},No={},aa={},gS;function dm(){if(gS)return aa;gS=1;function n(o,s,a){if(a===void 0&&(a=Array.prototype),o&&typeof a.find=="function")return a.find.call(o,s);for(var l=0;l<o.length;l++)if(Object.prototype.hasOwnProperty.call(o,l)){var u=o[l];if(s.call(void 0,u,l,o))return u}}function t(o,s){return s===void 0&&(s=Object),s&&typeof s.freeze=="function"?s.freeze(o):o}function e(o,s){if(o===null||typeof o!="object")throw new TypeError("target is not an object");for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=s[a]);return o}var i=t({HTML:"text/html",isHTML:function(o){return o===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=t({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(o){return o===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return aa.assign=e,aa.find=n,aa.freeze=t,aa.MIME_TYPE=i,aa.NAMESPACE=r,aa}var pS;function dB(){if(pS)return No;pS=1;var n=dm(),t=n.find,e=n.NAMESPACE;function i(G){return G!==""}function r(G){return G?G.split(/[\t\n\f\r ]+/).filter(i):[]}function o(G,$){return G.hasOwnProperty($)||(G[$]=!0),G}function s(G){if(!G)return[];var $=r(G);return Object.keys($.reduce(o,{}))}function a(G){return function($){return G&&G.indexOf($)!==-1}}function l(G,$){for(var tt in G)Object.prototype.hasOwnProperty.call(G,tt)&&($[tt]=G[tt])}function u(G,$){var tt=G.prototype;if(!(tt instanceof $)){let dt=function(){};dt.prototype=$.prototype,dt=new dt,l(tt,dt),G.prototype=tt=dt}tt.constructor!=G&&(typeof G!="function"&&console.error("unknown Class:"+G),tt.constructor=G)}var h={},d=h.ELEMENT_NODE=1,c=h.ATTRIBUTE_NODE=2,f=h.TEXT_NODE=3,g=h.CDATA_SECTION_NODE=4,m=h.ENTITY_REFERENCE_NODE=5,p=h.ENTITY_NODE=6,v=h.PROCESSING_INSTRUCTION_NODE=7,b=h.COMMENT_NODE=8,C=h.DOCUMENT_NODE=9,y=h.DOCUMENT_TYPE_NODE=10,w=h.DOCUMENT_FRAGMENT_NODE=11,_=h.NOTATION_NODE=12,A={},T={};A.INDEX_SIZE_ERR=(T[1]="Index size error",1),A.DOMSTRING_SIZE_ERR=(T[2]="DOMString size error",2);var S=A.HIERARCHY_REQUEST_ERR=(T[3]="Hierarchy request error",3);A.WRONG_DOCUMENT_ERR=(T[4]="Wrong document",4),A.INVALID_CHARACTER_ERR=(T[5]="Invalid character",5),A.NO_DATA_ALLOWED_ERR=(T[6]="No data allowed",6),A.NO_MODIFICATION_ALLOWED_ERR=(T[7]="No modification allowed",7);var x=A.NOT_FOUND_ERR=(T[8]="Not found",8);A.NOT_SUPPORTED_ERR=(T[9]="Not supported",9);var E=A.INUSE_ATTRIBUTE_ERR=(T[10]="Attribute in use",10);A.INVALID_STATE_ERR=(T[11]="Invalid state",11),A.SYNTAX_ERR=(T[12]="Syntax error",12),A.INVALID_MODIFICATION_ERR=(T[13]="Invalid modification",13),A.NAMESPACE_ERR=(T[14]="Invalid namespace",14),A.INVALID_ACCESS_ERR=(T[15]="Invalid access",15);function M(G,$){if($ instanceof Error)var tt=$;else tt=this,Error.call(this,T[G]),this.message=T[G],Error.captureStackTrace&&Error.captureStackTrace(this,M);return tt.code=G,$&&(this.message=this.message+": "+$),tt}M.prototype=Error.prototype,l(A,M);function L(){}L.prototype={length:0,item:function(G){return G>=0&&G<this.length?this[G]:null},toString:function(G,$){for(var tt=[],dt=0;dt<this.length;dt++)zi(this[dt],tt,G,$);return tt.join("")},filter:function(G){return Array.prototype.filter.call(this,G)},indexOf:function(G){return Array.prototype.indexOf.call(this,G)}};function I(G,$){this._node=G,this._refresh=$,D(this)}function D(G){var $=G._node._inc||G._node.ownerDocument._inc;if(G._inc!==$){var tt=G._refresh(G._node);if(oc(G,"length",tt.length),!G.$$length||tt.length<G.$$length)for(var dt=tt.length;dt in G;dt++)Object.prototype.hasOwnProperty.call(G,dt)&&delete G[dt];l(tt,G),G._inc=$}}I.prototype.item=function(G){return D(this),this[G]||null},u(I,L);function H(){}function O(G,$){for(var tt=G.length;tt--;)if(G[tt]===$)return tt}function N(G,$,tt,dt){if(dt?$[O($,dt)]=tt:$[$.length++]=tt,G){tt.ownerElement=G;var Dt=G.ownerDocument;Dt&&(dt&&st(Dt,G,dt),J(Dt,G,tt))}}function U(G,$,tt){var dt=O($,tt);if(dt>=0){for(var Dt=$.length-1;dt<Dt;)$[dt]=$[++dt];if($.length=Dt,G){var oe=G.ownerDocument;oe&&(st(oe,G,tt),tt.ownerElement=null)}}else throw new M(x,new Error(G.tagName+"@"+tt))}H.prototype={length:0,item:L.prototype.item,getNamedItem:function(G){for(var $=this.length;$--;){var tt=this[$];if(tt.nodeName==G)return tt}},setNamedItem:function(G){var $=G.ownerElement;if($&&$!=this._ownerElement)throw new M(E);var tt=this.getNamedItem(G.nodeName);return N(this._ownerElement,this,G,tt),tt},setNamedItemNS:function(G){var $=G.ownerElement,tt;if($&&$!=this._ownerElement)throw new M(E);return tt=this.getNamedItemNS(G.namespaceURI,G.localName),N(this._ownerElement,this,G,tt),tt},removeNamedItem:function(G){var $=this.getNamedItem(G);return U(this._ownerElement,this,$),$},removeNamedItemNS:function(G,$){var tt=this.getNamedItemNS(G,$);return U(this._ownerElement,this,tt),tt},getNamedItemNS:function(G,$){for(var tt=this.length;tt--;){var dt=this[tt];if(dt.localName==$&&dt.namespaceURI==G)return dt}return null}};function W(){}W.prototype={hasFeature:function(G,$){return!0},createDocument:function(G,$,tt){var dt=new rt;if(dt.implementation=this,dt.childNodes=new L,dt.doctype=tt||null,tt&&dt.appendChild(tt),$){var Dt=dt.createElementNS(G,$);dt.appendChild(Dt)}return dt},createDocumentType:function(G,$,tt){var dt=new Fe;return dt.name=G,dt.nodeName=G,dt.publicId=$||"",dt.systemId=tt||"",dt}};function j(){}j.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(G,$){return Pt(this,G,$)},replaceChild:function(G,$){Pt(this,G,$,At),$&&this.removeChild($)},removeChild:function(G){return at(this,G)},appendChild:function(G){return this.insertBefore(G,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(G){return ur(this.ownerDocument||this,this,G)},normalize:function(){for(var G=this.firstChild;G;){var $=G.nextSibling;$&&$.nodeType==f&&G.nodeType==f?(this.removeChild($),G.appendData($.data)):(G.normalize(),G=$)}},isSupported:function(G,$){return this.ownerDocument.implementation.hasFeature(G,$)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(G){for(var $=this;$;){var tt=$._nsMap;if(tt){for(var dt in tt)if(Object.prototype.hasOwnProperty.call(tt,dt)&&tt[dt]===G)return dt}$=$.nodeType==c?$.ownerDocument:$.parentNode}return null},lookupNamespaceURI:function(G){for(var $=this;$;){var tt=$._nsMap;if(tt&&Object.prototype.hasOwnProperty.call(tt,G))return tt[G];$=$.nodeType==c?$.ownerDocument:$.parentNode}return null},isDefaultNamespace:function(G){var $=this.lookupPrefix(G);return $==null}};function Y(G){return G=="<"&&"&lt;"||G==">"&&"&gt;"||G=="&"&&"&amp;"||G=='"'&&"&quot;"||"&#"+G.charCodeAt()+";"}l(h,j),l(h,j.prototype);function Z(G,$){if($(G))return!0;if(G=G.firstChild)do if(Z(G,$))return!0;while(G=G.nextSibling)}function rt(){this.ownerDocument=this}function J(G,$,tt){G&&G._inc++;var dt=tt.namespaceURI;dt===e.XMLNS&&($._nsMap[tt.prefix?tt.localName:""]=tt.value)}function st(G,$,tt,dt){G&&G._inc++;var Dt=tt.namespaceURI;Dt===e.XMLNS&&delete $._nsMap[tt.prefix?tt.localName:""]}function ht(G,$,tt){if(G&&G._inc){G._inc++;var dt=$.childNodes;if(tt)dt[dt.length++]=tt;else{for(var Dt=$.firstChild,oe=0;Dt;)dt[oe++]=Dt,Dt=Dt.nextSibling;dt.length=oe,delete dt[dt.length]}}}function at(G,$){var tt=$.previousSibling,dt=$.nextSibling;return tt?tt.nextSibling=dt:G.firstChild=dt,dt?dt.previousSibling=tt:G.lastChild=tt,$.parentNode=null,$.previousSibling=null,$.nextSibling=null,ht(G.ownerDocument,G),$}function lt(G){return G&&(G.nodeType===j.DOCUMENT_NODE||G.nodeType===j.DOCUMENT_FRAGMENT_NODE||G.nodeType===j.ELEMENT_NODE)}function _t(G){return G&&(yt(G)||mt(G)||vt(G)||G.nodeType===j.DOCUMENT_FRAGMENT_NODE||G.nodeType===j.COMMENT_NODE||G.nodeType===j.PROCESSING_INSTRUCTION_NODE)}function vt(G){return G&&G.nodeType===j.DOCUMENT_TYPE_NODE}function yt(G){return G&&G.nodeType===j.ELEMENT_NODE}function mt(G){return G&&G.nodeType===j.TEXT_NODE}function ft(G,$){var tt=G.childNodes||[];if(t(tt,yt)||vt($))return!1;var dt=t(tt,vt);return!($&&dt&&tt.indexOf(dt)>tt.indexOf($))}function Ft(G,$){var tt=G.childNodes||[];function dt(oe){return yt(oe)&&oe!==$}if(t(tt,dt))return!1;var Dt=t(tt,vt);return!($&&Dt&&tt.indexOf(Dt)>tt.indexOf($))}function St(G,$,tt){if(!lt(G))throw new M(S,"Unexpected parent node type "+G.nodeType);if(tt&&tt.parentNode!==G)throw new M(x,"child not in parent");if(!_t($)||vt($)&&G.nodeType!==j.DOCUMENT_NODE)throw new M(S,"Unexpected node type "+$.nodeType+" for parent node type "+G.nodeType)}function Kt(G,$,tt){var dt=G.childNodes||[],Dt=$.childNodes||[];if($.nodeType===j.DOCUMENT_FRAGMENT_NODE){var oe=Dt.filter(yt);if(oe.length>1||t(Dt,mt))throw new M(S,"More than one element or text in fragment");if(oe.length===1&&!ft(G,tt))throw new M(S,"Element in fragment can not be inserted before doctype")}if(yt($)&&!ft(G,tt))throw new M(S,"Only one element can be added and only after doctype");if(vt($)){if(t(dt,vt))throw new M(S,"Only one doctype is allowed");var $e=t(dt,yt);if(tt&&dt.indexOf($e)<dt.indexOf(tt))throw new M(S,"Doctype can only be inserted before an element");if(!tt&&$e)throw new M(S,"Doctype can not be appended since element is present")}}function At(G,$,tt){var dt=G.childNodes||[],Dt=$.childNodes||[];if($.nodeType===j.DOCUMENT_FRAGMENT_NODE){var oe=Dt.filter(yt);if(oe.length>1||t(Dt,mt))throw new M(S,"More than one element or text in fragment");if(oe.length===1&&!Ft(G,tt))throw new M(S,"Element in fragment can not be inserted before doctype")}if(yt($)&&!Ft(G,tt))throw new M(S,"Only one element can be added and only after doctype");if(vt($)){if(t(dt,function(_r){return vt(_r)&&_r!==tt}))throw new M(S,"Only one doctype is allowed");var $e=t(dt,yt);if(tt&&dt.indexOf($e)<dt.indexOf(tt))throw new M(S,"Doctype can only be inserted before an element")}}function Pt(G,$,tt,dt){St(G,$,tt),G.nodeType===j.DOCUMENT_NODE&&(dt||Kt)(G,$,tt);var Dt=$.parentNode;if(Dt&&Dt.removeChild($),$.nodeType===w){var oe=$.firstChild;if(oe==null)return $;var $e=$.lastChild}else oe=$e=$;var hr=tt?tt.previousSibling:G.lastChild;oe.previousSibling=hr,$e.nextSibling=tt,hr?hr.nextSibling=oe:G.firstChild=oe,tt==null?G.lastChild=$e:tt.previousSibling=$e;do oe.parentNode=G;while(oe!==$e&&(oe=oe.nextSibling));return ht(G.ownerDocument||G,G),$.nodeType==w&&($.firstChild=$.lastChild=null),$}function Bt(G,$){return $.parentNode&&$.parentNode.removeChild($),$.parentNode=G,$.previousSibling=G.lastChild,$.nextSibling=null,$.previousSibling?$.previousSibling.nextSibling=$:G.firstChild=$,G.lastChild=$,ht(G.ownerDocument,G,$),$}rt.prototype={nodeName:"#document",nodeType:C,doctype:null,documentElement:null,_inc:1,insertBefore:function(G,$){if(G.nodeType==w){for(var tt=G.firstChild;tt;){var dt=tt.nextSibling;this.insertBefore(tt,$),tt=dt}return G}return Pt(this,G,$),G.ownerDocument=this,this.documentElement===null&&G.nodeType===d&&(this.documentElement=G),G},removeChild:function(G){return this.documentElement==G&&(this.documentElement=null),at(this,G)},replaceChild:function(G,$){Pt(this,G,$,At),G.ownerDocument=this,$&&this.removeChild($),yt(G)&&(this.documentElement=G)},importNode:function(G,$){return br(this,G,$)},getElementById:function(G){var $=null;return Z(this.documentElement,function(tt){if(tt.nodeType==d&&tt.getAttribute("id")==G)return $=tt,!0}),$},getElementsByClassName:function(G){var $=s(G);return new I(this,function(tt){var dt=[];return $.length>0&&Z(tt.documentElement,function(Dt){if(Dt!==tt&&Dt.nodeType===d){var oe=Dt.getAttribute("class");if(oe){var $e=G===oe;if(!$e){var hr=s(oe);$e=$.every(a(hr))}$e&&dt.push(Dt)}}}),dt})},createElement:function(G){var $=new It;$.ownerDocument=this,$.nodeName=G,$.tagName=G,$.localName=G,$.childNodes=new L;var tt=$.attributes=new H;return tt._ownerElement=$,$},createDocumentFragment:function(){var G=new se;return G.ownerDocument=this,G.childNodes=new L,G},createTextNode:function(G){var $=new gt;return $.ownerDocument=this,$.appendData(G),$},createComment:function(G){var $=new Ht;return $.ownerDocument=this,$.appendData(G),$},createCDATASection:function(G){var $=new bt;return $.ownerDocument=this,$.appendData(G),$},createProcessingInstruction:function(G,$){var tt=new vr;return tt.ownerDocument=this,tt.tagName=tt.nodeName=tt.target=G,tt.nodeValue=tt.data=$,tt},createAttribute:function(G){var $=new Ot;return $.ownerDocument=this,$.name=G,$.nodeName=G,$.localName=G,$.specified=!0,$},createEntityReference:function(G){var $=new Ci;return $.ownerDocument=this,$.nodeName=G,$},createElementNS:function(G,$){var tt=new It,dt=$.split(":"),Dt=tt.attributes=new H;return tt.childNodes=new L,tt.ownerDocument=this,tt.nodeName=$,tt.tagName=$,tt.namespaceURI=G,dt.length==2?(tt.prefix=dt[0],tt.localName=dt[1]):tt.localName=$,Dt._ownerElement=tt,tt},createAttributeNS:function(G,$){var tt=new Ot,dt=$.split(":");return tt.ownerDocument=this,tt.nodeName=$,tt.name=$,tt.namespaceURI=G,tt.specified=!0,dt.length==2?(tt.prefix=dt[0],tt.localName=dt[1]):tt.localName=$,tt}},u(rt,j);function It(){this._nsMap={}}It.prototype={nodeType:d,hasAttribute:function(G){return this.getAttributeNode(G)!=null},getAttribute:function(G){var $=this.getAttributeNode(G);return $&&$.value||""},getAttributeNode:function(G){return this.attributes.getNamedItem(G)},setAttribute:function(G,$){var tt=this.ownerDocument.createAttribute(G);tt.value=tt.nodeValue=""+$,this.setAttributeNode(tt)},removeAttribute:function(G){var $=this.getAttributeNode(G);$&&this.removeAttributeNode($)},appendChild:function(G){return G.nodeType===w?this.insertBefore(G,null):Bt(this,G)},setAttributeNode:function(G){return this.attributes.setNamedItem(G)},setAttributeNodeNS:function(G){return this.attributes.setNamedItemNS(G)},removeAttributeNode:function(G){return this.attributes.removeNamedItem(G.nodeName)},removeAttributeNS:function(G,$){var tt=this.getAttributeNodeNS(G,$);tt&&this.removeAttributeNode(tt)},hasAttributeNS:function(G,$){return this.getAttributeNodeNS(G,$)!=null},getAttributeNS:function(G,$){var tt=this.getAttributeNodeNS(G,$);return tt&&tt.value||""},setAttributeNS:function(G,$,tt){var dt=this.ownerDocument.createAttributeNS(G,$);dt.value=dt.nodeValue=""+tt,this.setAttributeNode(dt)},getAttributeNodeNS:function(G,$){return this.attributes.getNamedItemNS(G,$)},getElementsByTagName:function(G){return new I(this,function($){var tt=[];return Z($,function(dt){dt!==$&&dt.nodeType==d&&(G==="*"||dt.tagName==G)&&tt.push(dt)}),tt})},getElementsByTagNameNS:function(G,$){return new I(this,function(tt){var dt=[];return Z(tt,function(Dt){Dt!==tt&&Dt.nodeType===d&&(G==="*"||Dt.namespaceURI===G)&&($==="*"||Dt.localName==$)&&dt.push(Dt)}),dt})}},rt.prototype.getElementsByTagName=It.prototype.getElementsByTagName,rt.prototype.getElementsByTagNameNS=It.prototype.getElementsByTagNameNS,u(It,j);function Ot(){}Ot.prototype.nodeType=c,u(Ot,j);function qt(){}qt.prototype={data:"",substringData:function(G,$){return this.data.substring(G,G+$)},appendData:function(G){G=this.data+G,this.nodeValue=this.data=G,this.length=G.length},insertData:function(G,$){this.replaceData(G,0,$)},appendChild:function(G){throw new Error(T[S])},deleteData:function(G,$){this.replaceData(G,$,"")},replaceData:function(G,$,tt){var dt=this.data.substring(0,G),Dt=this.data.substring(G+$);tt=dt+tt+Dt,this.nodeValue=this.data=tt,this.length=tt.length}},u(qt,j);function gt(){}gt.prototype={nodeName:"#text",nodeType:f,splitText:function(G){var $=this.data,tt=$.substring(G);$=$.substring(0,G),this.data=this.nodeValue=$,this.length=$.length;var dt=this.ownerDocument.createTextNode(tt);return this.parentNode&&this.parentNode.insertBefore(dt,this.nextSibling),dt}},u(gt,qt);function Ht(){}Ht.prototype={nodeName:"#comment",nodeType:b},u(Ht,qt);function bt(){}bt.prototype={nodeName:"#cdata-section",nodeType:g},u(bt,qt);function Fe(){}Fe.prototype.nodeType=y,u(Fe,j);function hi(){}hi.prototype.nodeType=_,u(hi,j);function le(){}le.prototype.nodeType=p,u(le,j);function Ci(){}Ci.prototype.nodeType=m,u(Ci,j);function se(){}se.prototype.nodeName="#document-fragment",se.prototype.nodeType=w,u(se,j);function vr(){}vr.prototype.nodeType=v,u(vr,j);function Re(){}Re.prototype.serializeToString=function(G,$,tt){return Ke.call(G,$,tt)},j.prototype.toString=Ke;function Ke(G,$){var tt=[],dt=this.nodeType==9&&this.documentElement||this,Dt=dt.prefix,oe=dt.namespaceURI;if(oe&&Dt==null){var Dt=dt.lookupPrefix(oe);if(Dt==null)var $e=[{namespace:oe,prefix:null}]}return zi(this,tt,G,$,$e),tt.join("")}function yi(G,$,tt){var dt=G.prefix||"",Dt=G.namespaceURI;if(!Dt||dt==="xml"&&Dt===e.XML||Dt===e.XMLNS)return!1;for(var oe=tt.length;oe--;){var $e=tt[oe];if($e.prefix===dt)return $e.namespace!==Dt}return!0}function wi(G,$,tt){G.push(" ",$,'="',tt.replace(/[<>&"\t\n\r]/g,Y),'"')}function zi(G,$,tt,dt,Dt){if(Dt||(Dt=[]),dt)if(G=dt(G),G){if(typeof G=="string"){$.push(G);return}}else return;switch(G.nodeType){case d:var oe=G.attributes,$e=oe.length,Si=G.firstChild,hr=G.tagName;tt=e.isHTML(G.namespaceURI)||tt;var _r=hr;if(!tt&&!G.prefix&&G.namespaceURI){for(var fi,On=0;On<oe.length;On++)if(oe.item(On).name==="xmlns"){fi=oe.item(On).value;break}if(!fi)for(var Ho=Dt.length-1;Ho>=0;Ho--){var mn=Dt[Ho];if(mn.prefix===""&&mn.namespace===G.namespaceURI){fi=mn.namespace;break}}if(fi!==G.namespaceURI)for(var Ho=Dt.length-1;Ho>=0;Ho--){var mn=Dt[Ho];if(mn.namespace===G.namespaceURI){mn.prefix&&(_r=mn.prefix+":"+hr);break}}}$.push("<",_r);for(var Zi=0;Zi<$e;Zi++){var Cr=oe.item(Zi);Cr.prefix=="xmlns"?Dt.push({prefix:Cr.localName,namespace:Cr.value}):Cr.nodeName=="xmlns"&&Dt.push({prefix:"",namespace:Cr.value})}for(var Zi=0;Zi<$e;Zi++){var Cr=oe.item(Zi);if(yi(Cr,tt,Dt)){var Ee=Cr.prefix||"",ta=Cr.namespaceURI;wi($,Ee?"xmlns:"+Ee:"xmlns",ta),Dt.push({prefix:Ee,namespace:ta})}zi(Cr,$,tt,dt,Dt)}if(hr===_r&&yi(G,tt,Dt)){var Ee=G.prefix||"",ta=G.namespaceURI;wi($,Ee?"xmlns:"+Ee:"xmlns",ta),Dt.push({prefix:Ee,namespace:ta})}if(Si||tt&&!/^(?:meta|link|img|br|hr|input)$/i.test(hr)){if($.push(">"),tt&&/^script$/i.test(hr))for(;Si;)Si.data?$.push(Si.data):zi(Si,$,tt,dt,Dt.slice()),Si=Si.nextSibling;else for(;Si;)zi(Si,$,tt,dt,Dt.slice()),Si=Si.nextSibling;$.push("</",_r,">")}else $.push("/>");return;case C:case w:for(var Si=G.firstChild;Si;)zi(Si,$,tt,dt,Dt.slice()),Si=Si.nextSibling;return;case c:return wi($,G.name,G.value);case f:return $.push(G.data.replace(/[<&>]/g,Y));case g:return $.push("<![CDATA[",G.data,"]]>");case b:return $.push("<!--",G.data,"-->");case y:var ea=G.publicId,Cs=G.systemId;if($.push("<!DOCTYPE ",G.name),ea)$.push(" PUBLIC ",ea),Cs&&Cs!="."&&$.push(" ",Cs),$.push(">");else if(Cs&&Cs!=".")$.push(" SYSTEM ",Cs,">");else{var uo=G.internalSubset;uo&&$.push(" [",uo,"]"),$.push(">")}return;case v:return $.push("<?",G.target," ",G.data,"?>");case m:return $.push("&",G.nodeName,";");default:$.push("??",G.nodeName)}}function br(G,$,tt){var dt;switch($.nodeType){case d:dt=$.cloneNode(!1),dt.ownerDocument=G;case w:break;case c:tt=!0;break}if(dt||(dt=$.cloneNode(!1)),dt.ownerDocument=G,dt.parentNode=null,tt)for(var Dt=$.firstChild;Dt;)dt.appendChild(br(G,Dt,tt)),Dt=Dt.nextSibling;return dt}function ur(G,$,tt){var dt=new $.constructor;for(var Dt in $)if(Object.prototype.hasOwnProperty.call($,Dt)){var oe=$[Dt];typeof oe!="object"&&oe!=dt[Dt]&&(dt[Dt]=oe)}switch($.childNodes&&(dt.childNodes=new L),dt.ownerDocument=G,dt.nodeType){case d:var $e=$.attributes,hr=dt.attributes=new H,_r=$e.length;hr._ownerElement=dt;for(var fi=0;fi<_r;fi++)dt.setAttributeNode(ur(G,$e.item(fi),!0));break;case c:tt=!0}if(tt)for(var On=$.firstChild;On;)dt.appendChild(ur(G,On,tt)),On=On.nextSibling;return dt}function oc(G,$,tt){G[$]=tt}try{if(Object.defineProperty){let G=function($){switch($.nodeType){case d:case w:var tt=[];for($=$.firstChild;$;)$.nodeType!==7&&$.nodeType!==8&&tt.push(G($)),$=$.nextSibling;return tt.join("");default:return $.nodeValue}};Object.defineProperty(I.prototype,"length",{get:function(){return D(this),this.$$length}}),Object.defineProperty(j.prototype,"textContent",{get:function(){return G(this)},set:function($){switch(this.nodeType){case d:case w:for(;this.firstChild;)this.removeChild(this.firstChild);($||String($))&&this.appendChild(this.ownerDocument.createTextNode($));break;default:this.data=$,this.value=$,this.nodeValue=$}}}),oc=function($,tt,dt){$["$$"+tt]=dt}}}catch{}return No.DocumentType=Fe,No.DOMException=M,No.DOMImplementation=W,No.Element=It,No.Node=j,No.NodeList=L,No.XMLSerializer=Re,No}var eh={},k0={},mS;function V3(){return mS||(mS=1,function(n){var t=dm().freeze;n.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=t({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),n.entityMap=n.HTML_ENTITIES}(k0)),k0}var Ac={},vS;function j3(){if(vS)return Ac;vS=1;var n=dm().NAMESPACE,t=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,e=new RegExp("[\\-\\.0-9"+t.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+t.source+e.source+"*(?::"+t.source+e.source+"*)?$"),r=0,o=1,s=2,a=3,l=4,u=5,h=6,d=7;function c(S,x){this.message=S,this.locator=x,Error.captureStackTrace&&Error.captureStackTrace(this,c)}c.prototype=new Error,c.prototype.name=c.name;function f(){}f.prototype={parse:function(S,x,E){var M=this.domBuilder;M.startDocument(),y(x,x={}),g(S,x,E,M,this.errorHandler),M.endDocument()}};function g(S,x,E,M,L){function I(It){if(It>65535){It-=65536;var Ot=55296+(It>>10),qt=56320+(It&1023);return String.fromCharCode(Ot,qt)}else return String.fromCharCode(It)}function D(It){var Ot=It.slice(1,-1);return Object.hasOwnProperty.call(E,Ot)?E[Ot]:Ot.charAt(0)==="#"?I(parseInt(Ot.substr(1).replace("x","0x"))):(L.error("entity not found:"+It),It)}function H(It){if(It>rt){var Ot=S.substring(rt,It).replace(/&#?\w+;/g,D);j&&O(rt),M.characters(Ot,0,It-rt),rt=It}}function O(It,Ot){for(;It>=U&&(Ot=W.exec(S));)N=Ot.index,U=N+Ot[0].length,j.lineNumber++;j.columnNumber=It-N+1}for(var N=0,U=0,W=/.*(?:\r\n?|\n)|.*$/g,j=M.locator,Y=[{currentNSMap:x}],Z={},rt=0;;){try{var J=S.indexOf("<",rt);if(J<0){if(!S.substr(rt).match(/^\s*$/)){var st=M.doc,ht=st.createTextNode(S.substr(rt));st.appendChild(ht),M.currentElement=ht}return}switch(J>rt&&H(J),S.charAt(J+1)){case"/":var St=S.indexOf(">",J+3),at=S.substring(J+2,St).replace(/[ \t\n\r]+$/g,""),lt=Y.pop();St<0?(at=S.substring(J+2).replace(/[\s<].*/,""),L.error("end tag name: "+at+" is not complete:"+lt.tagName),St=J+1+at.length):at.match(/\s</)&&(at=at.replace(/[\s<].*/,""),L.error("end tag name: "+at+" maybe not complete"),St=J+1+at.length);var _t=lt.localNSMap,vt=lt.tagName==at,yt=vt||lt.tagName&&lt.tagName.toLowerCase()==at.toLowerCase();if(yt){if(M.endElement(lt.uri,lt.localName,at),_t)for(var mt in _t)Object.prototype.hasOwnProperty.call(_t,mt)&&M.endPrefixMapping(mt);vt||L.fatalError("end tag name: "+at+" is not match the current start tagName:"+lt.tagName)}else Y.push(lt);St++;break;case"?":j&&O(J),St=_(S,J,M);break;case"!":j&&O(J),St=w(S,J,M,L);break;default:j&&O(J);var ft=new A,Ft=Y[Y.length-1].currentNSMap,St=p(S,J,ft,Ft,D,L),Kt=ft.length;if(!ft.closed&&C(S,St,ft.tagName,Z)&&(ft.closed=!0,E.nbsp||L.warning("unclosed xml attribute")),j&&Kt){for(var At=m(j,{}),Pt=0;Pt<Kt;Pt++){var Bt=ft[Pt];O(Bt.offset),Bt.locator=m(j,{})}M.locator=At,v(ft,M,Ft)&&Y.push(ft),M.locator=j}else v(ft,M,Ft)&&Y.push(ft);n.isHTML(ft.uri)&&!ft.closed?St=b(S,St,ft.tagName,D,M):St++}}catch(It){if(It instanceof c)throw It;L.error("element parse error: "+It),St=-1}St>rt?rt=St:H(Math.max(J,rt)+1)}}function m(S,x){return x.lineNumber=S.lineNumber,x.columnNumber=S.columnNumber,x}function p(S,x,E,M,L,I){function D(j,Y,Z){E.attributeNames.hasOwnProperty(j)&&I.fatalError("Attribute "+j+" redefined"),E.addValue(j,Y.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,L),Z)}for(var H,O,N=++x,U=r;;){var W=S.charAt(N);switch(W){case"=":if(U===o)H=S.slice(x,N),U=a;else if(U===s)U=a;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(U===a||U===o)if(U===o&&(I.warning('attribute value must after "="'),H=S.slice(x,N)),x=N+1,N=S.indexOf(W,x),N>0)O=S.slice(x,N),D(H,O,x-1),U=u;else throw new Error("attribute value no end '"+W+"' match");else if(U==l)O=S.slice(x,N),D(H,O,x),I.warning('attribute "'+H+'" missed start quot('+W+")!!"),x=N+1,U=u;else throw new Error('attribute value must after "="');break;case"/":switch(U){case r:E.setTagName(S.slice(x,N));case u:case h:case d:U=d,E.closed=!0;case l:case o:break;case s:E.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return I.error("unexpected end of input"),U==r&&E.setTagName(S.slice(x,N)),N;case">":switch(U){case r:E.setTagName(S.slice(x,N));case u:case h:case d:break;case l:case o:O=S.slice(x,N),O.slice(-1)==="/"&&(E.closed=!0,O=O.slice(0,-1));case s:U===s&&(O=H),U==l?(I.warning('attribute "'+O+'" missed quot(")!'),D(H,O,x)):((!n.isHTML(M[""])||!O.match(/^(?:disabled|checked|selected)$/i))&&I.warning('attribute "'+O+'" missed value!! "'+O+'" instead!!'),D(O,O,x));break;case a:throw new Error("attribute value missed!!")}return N;case"":W=" ";default:if(W<=" ")switch(U){case r:E.setTagName(S.slice(x,N)),U=h;break;case o:H=S.slice(x,N),U=s;break;case l:var O=S.slice(x,N);I.warning('attribute "'+O+'" missed quot(")!!'),D(H,O,x);case u:U=h;break}else switch(U){case s:E.tagName,(!n.isHTML(M[""])||!H.match(/^(?:disabled|checked|selected)$/i))&&I.warning('attribute "'+H+'" missed value!! "'+H+'" instead2!!'),D(H,H,x),x=N,U=o;break;case u:I.warning('attribute space is required"'+H+'"!!');case h:U=o,x=N;break;case a:U=l,x=N;break;case d:throw new Error("elements closed character '/' and '>' must be connected to")}}N++}}function v(S,x,E){for(var M=S.tagName,L=null,W=S.length;W--;){var I=S[W],D=I.qName,H=I.value,j=D.indexOf(":");if(j>0)var O=I.prefix=D.slice(0,j),N=D.slice(j+1),U=O==="xmlns"&&N;else N=D,O=null,U=D==="xmlns"&&"";I.localName=N,U!==!1&&(L==null&&(L={},y(E,E={})),E[U]=L[U]=H,I.uri=n.XMLNS,x.startPrefixMapping(U,H))}for(var W=S.length;W--;){I=S[W];var O=I.prefix;O&&(O==="xml"&&(I.uri=n.XML),O!=="xmlns"&&(I.uri=E[O||""]))}var j=M.indexOf(":");j>0?(O=S.prefix=M.slice(0,j),N=S.localName=M.slice(j+1)):(O=null,N=S.localName=M);var Y=S.uri=E[O||""];if(x.startElement(Y,N,M,S),S.closed){if(x.endElement(Y,N,M),L)for(O in L)Object.prototype.hasOwnProperty.call(L,O)&&x.endPrefixMapping(O)}else return S.currentNSMap=E,S.localNSMap=L,!0}function b(S,x,E,M,L){if(/^(?:script|textarea)$/i.test(E)){var I=S.indexOf("</"+E+">",x),D=S.substring(x+1,I);if(/[&<]/.test(D))return/^script$/i.test(E)?(L.characters(D,0,D.length),I):(D=D.replace(/&#?\w+;/g,M),L.characters(D,0,D.length),I)}return x+1}function C(S,x,E,M){var L=M[E];return L==null&&(L=S.lastIndexOf("</"+E+">"),L<x&&(L=S.lastIndexOf("</"+E)),M[E]=L),L<x}function y(S,x){for(var E in S)Object.prototype.hasOwnProperty.call(S,E)&&(x[E]=S[E])}function w(S,x,E,M){var L=S.charAt(x+2);switch(L){case"-":if(S.charAt(x+3)==="-"){var I=S.indexOf("-->",x+4);return I>x?(E.comment(S,x+4,I-x-4),I+3):(M.error("Unclosed comment"),-1)}else return-1;default:if(S.substr(x+3,6)=="CDATA["){var I=S.indexOf("]]>",x+9);return E.startCDATA(),E.characters(S,x+9,I-x-9),E.endCDATA(),I+3}var D=T(S,x),H=D.length;if(H>1&&/!doctype/i.test(D[0][0])){var O=D[1][0],N=!1,U=!1;H>3&&(/^public$/i.test(D[2][0])?(N=D[3][0],U=H>4&&D[4][0]):/^system$/i.test(D[2][0])&&(U=D[3][0]));var W=D[H-1];return E.startDTD(O,N,U),E.endDTD(),W.index+W[0].length}}return-1}function _(S,x,E){var M=S.indexOf("?>",x);if(M){var L=S.substring(x,M).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return L?(L[0].length,E.processingInstruction(L[1],L[2]),M+2):-1}return-1}function A(){this.attributeNames={}}A.prototype={setTagName:function(S){if(!i.test(S))throw new Error("invalid tagName:"+S);this.tagName=S},addValue:function(S,x,E){if(!i.test(S))throw new Error("invalid attribute:"+S);this.attributeNames[S]=this.length,this[this.length++]={qName:S,value:x,offset:E}},length:0,getLocalName:function(S){return this[S].localName},getLocator:function(S){return this[S].locator},getQName:function(S){return this[S].qName},getURI:function(S){return this[S].uri},getValue:function(S){return this[S].value}};function T(S,x){var E,M=[],L=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(L.lastIndex=x,L.exec(S);E=L.exec(S);)if(M.push(E),E[1])return M}return Ac.XMLReader=f,Ac.ParseError=c,Ac}var bS;function G3(){if(bS)return eh;bS=1;var n=dm(),t=dB(),e=V3(),i=j3(),r=t.DOMImplementation,o=n.NAMESPACE,s=i.ParseError,a=i.XMLReader;function l(p){return p.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function u(p){this.options=p||{locator:{}}}u.prototype.parseFromString=function(p,v){var b=this.options,C=new a,y=b.domBuilder||new d,w=b.errorHandler,_=b.locator,A=b.xmlns||{},T=/\/x?html?$/.test(v),S=T?e.HTML_ENTITIES:e.XML_ENTITIES;_&&y.setDocumentLocator(_),C.errorHandler=h(w,y,_),C.domBuilder=b.domBuilder||y,T&&(A[""]=o.HTML),A.xml=A.xml||o.XML;var x=b.normalizeLineEndings||l;return p&&typeof p=="string"?C.parse(x(p),A,S):C.errorHandler.error("invalid doc source"),y.doc};function h(p,v,b){if(!p){if(v instanceof d)return v;p=v}var C={},y=p instanceof Function;b=b||{};function w(_){var A=p[_];!A&&y&&(A=p.length==2?function(T){p(_,T)}:p),C[_]=A&&function(T){A("[xmldom "+_+"]	"+T+f(b))}||function(){}}return w("warning"),w("error"),w("fatalError"),C}function d(){this.cdata=!1}function c(p,v){v.lineNumber=p.lineNumber,v.columnNumber=p.columnNumber}d.prototype={startDocument:function(){this.doc=new r().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(p,v,b,C){var y=this.doc,w=y.createElementNS(p,b||v),_=C.length;m(this,w),this.currentElement=w,this.locator&&c(this.locator,w);for(var A=0;A<_;A++){var p=C.getURI(A),T=C.getValue(A),b=C.getQName(A),S=y.createAttributeNS(p,b);this.locator&&c(C.getLocator(A),S),S.value=S.nodeValue=T,w.setAttributeNode(S)}},endElement:function(p,v,b){var C=this.currentElement;C.tagName,this.currentElement=C.parentNode},startPrefixMapping:function(p,v){},endPrefixMapping:function(p){},processingInstruction:function(p,v){var b=this.doc.createProcessingInstruction(p,v);this.locator&&c(this.locator,b),m(this,b)},ignorableWhitespace:function(p,v,b){},characters:function(p,v,b){if(p=g.apply(this,arguments),p){if(this.cdata)var C=this.doc.createCDATASection(p);else var C=this.doc.createTextNode(p);this.currentElement?this.currentElement.appendChild(C):/^\s*$/.test(p)&&this.doc.appendChild(C),this.locator&&c(this.locator,C)}},skippedEntity:function(p){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(p){(this.locator=p)&&(p.lineNumber=0)},comment:function(p,v,b){p=g.apply(this,arguments);var C=this.doc.createComment(p);this.locator&&c(this.locator,C),m(this,C)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(p,v,b){var C=this.doc.implementation;if(C&&C.createDocumentType){var y=C.createDocumentType(p,v,b);this.locator&&c(this.locator,y),m(this,y),this.doc.doctype=y}},warning:function(p){console.warn("[xmldom warning]	"+p,f(this.locator))},error:function(p){console.error("[xmldom error]	"+p,f(this.locator))},fatalError:function(p){throw new s(p,this.locator)}};function f(p){if(p)return`
@`+(p.systemId||"")+"#[line:"+p.lineNumber+",col:"+p.columnNumber+"]"}function g(p,v,b){return typeof p=="string"?p.substr(v,b):p.length>=v+b||v?new java.lang.String(p,v,b)+"":p}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(p){d.prototype[p]=function(){return null}});function m(p,v){p.currentElement?p.currentElement.appendChild(v):p.doc.appendChild(v)}return eh.__DOMHandler=d,eh.normalizeLineEndings=l,eh.DOMParser=u,eh}var _S;function $3(){if(_S)return th;_S=1;var n=dB();return th.DOMImplementation=n.DOMImplementation,th.XMLSerializer=n.XMLSerializer,th.DOMParser=G3().DOMParser,th}var q3=$3();/*! @name mpd-parser @version 0.22.1 @license Apache-2.0 */var CS=function(t){return!!t&&typeof t=="object"},Pr=function n(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.reduce(function(r,o){return typeof o!="object"||Object.keys(o).forEach(function(s){Array.isArray(r[s])&&Array.isArray(o[s])?r[s]=r[s].concat(o[s]):CS(r[s])&&CS(o[s])?r[s]=n(r[s],o[s]):r[s]=o[s]}),r},{})},cB=function(t){return Object.keys(t).map(function(e){return t[e]})},X3=function(t,e){for(var i=[],r=t;r<e;r++)i.push(r);return i},cm=function(t){return t.reduce(function(e,i){return e.concat(i)},[])},fB=function(t){if(!t.length)return[];for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e},Y3=function(t,e){return t.reduce(function(i,r,o){return r[e]&&i.push(o),i},[])},Xb=function(t,e){for(var i=0;i<t.length;i++)if(e(t[i]))return i;return-1},K3=function(t,e){return cB(t.reduce(function(i,r){return r.forEach(function(o){i[e(o)]=o}),i},{}))},au={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},rd=function(t){var e=t.baseUrl,i=e===void 0?"":e,r=t.source,o=r===void 0?"":r,s=t.range,a=s===void 0?"":s,l=t.indexRange,u=l===void 0?"":l,h={uri:o,resolvedUri:hm(i||"",o)};if(a||u){var d=a||u,c=d.split("-"),f=K.BigInt?K.BigInt(c[0]):parseInt(c[0],10),g=K.BigInt?K.BigInt(c[1]):parseInt(c[1],10);f<Number.MAX_SAFE_INTEGER&&typeof f=="bigint"&&(f=Number(f)),g<Number.MAX_SAFE_INTEGER&&typeof g=="bigint"&&(g=Number(g));var m;typeof g=="bigint"||typeof f=="bigint"?m=K.BigInt(g)-K.BigInt(f)+K.BigInt(1):m=g-f+1,typeof m=="bigint"&&m<Number.MAX_SAFE_INTEGER&&(m=Number(m)),h.byterange={length:m,offset:f}}return h},Z3=function(t){var e;return typeof t.offset=="bigint"||typeof t.length=="bigint"?e=K.BigInt(t.offset)+K.BigInt(t.length)-K.BigInt(1):e=t.offset+t.length-1,t.offset+"-"+e},yS=function(t){return t&&typeof t!="number"&&(t=parseInt(t,10)),isNaN(t)?null:t},Q3={static:function(t){var e=t.duration,i=t.timescale,r=i===void 0?1:i,o=t.sourceDuration,s=t.periodDuration,a=yS(t.endNumber),l=e/r;return typeof a=="number"?{start:0,end:a}:typeof s=="number"?{start:0,end:s/l}:{start:0,end:o/l}},dynamic:function(t){var e=t.NOW,i=t.clientOffset,r=t.availabilityStartTime,o=t.timescale,s=o===void 0?1:o,a=t.duration,l=t.periodStart,u=l===void 0?0:l,h=t.minimumUpdatePeriod,d=h===void 0?0:h,c=t.timeShiftBufferDepth,f=c===void 0?1/0:c,g=yS(t.endNumber),m=(e+i)/1e3,p=r+u,v=m+d,b=v-p,C=Math.ceil(b*s/a),y=Math.floor((m-p-f)*s/a),w=Math.floor((m-p)*s/a);return{start:Math.max(0,y),end:typeof g=="number"?g:Math.min(C,w)}}},J3=function(t){return function(e){var i=t.duration,r=t.timescale,o=r===void 0?1:r,s=t.periodStart,a=t.startNumber,l=a===void 0?1:a;return{number:l+e,duration:i/o,timeline:s,time:e*i}}},py=function(t){var e=t.type,i=t.duration,r=t.timescale,o=r===void 0?1:r,s=t.periodDuration,a=t.sourceDuration,l=Q3[e](t),u=l.start,h=l.end,d=X3(u,h).map(J3(t));if(e==="static"){var c=d.length-1,f=typeof s=="number"?s:a;d[c].duration=f-i/o*c}return d},gB=function(t){var e=t.baseUrl,i=t.initialization,r=i===void 0?{}:i,o=t.sourceDuration,s=t.indexRange,a=s===void 0?"":s,l=t.periodStart,u=t.presentationTime,h=t.number,d=h===void 0?0:h,c=t.duration;if(!e)throw new Error(au.NO_BASE_URL);var f=rd({baseUrl:e,source:r.sourceURL,range:r.range}),g=rd({baseUrl:e,source:e,indexRange:a});if(g.map=f,c){var m=py(t);m.length&&(g.duration=m[0].duration,g.timeline=m[0].timeline)}else o&&(g.duration=o,g.timeline=l);return g.presentationTime=u||l,g.number=d,[g]},my=function(t,e,i){var r=t.sidx.map?t.sidx.map:null,o=t.sidx.duration,s=t.timeline||0,a=t.sidx.byterange,l=a.offset+a.length,u=e.timescale,h=e.references.filter(function(S){return S.referenceType!==1}),d=[],c=t.endList?"static":"dynamic",f=t.sidx.timeline,g=f,m=t.mediaSequence||0,p;typeof e.firstOffset=="bigint"?p=K.BigInt(l)+e.firstOffset:p=l+e.firstOffset;for(var v=0;v<h.length;v++){var b=e.references[v],C=b.referencedSize,y=b.subsegmentDuration,w=void 0;typeof p=="bigint"?w=p+K.BigInt(C)-K.BigInt(1):w=p+C-1;var _=p+"-"+w,A={baseUrl:i,timescale:u,timeline:s,periodStart:f,presentationTime:g,number:m,duration:y,sourceDuration:o,indexRange:_,type:c},T=gB(A)[0];r&&(T.map=r),d.push(T),typeof p=="bigint"?p+=K.BigInt(C):p+=C,g+=y/u,m++}return t.segments=d,t},tH=["AUDIO","SUBTITLES"],eH=1/60,pB=function(t){return K3(t,function(e){var i=e.timeline;return i}).sort(function(e,i){return e.timeline>i.timeline?1:-1})},iH=function(t,e){for(var i=0;i<t.length;i++)if(t[i].attributes.NAME===e)return t[i];return null},wS=function(t){var e=[];return U3(t,tH,function(i,r,o,s){e=e.concat(i.playlists||[])}),e},SS=function(t){var e=t.playlist,i=t.mediaSequence;e.mediaSequence=i,e.segments.forEach(function(r,o){r.number=e.mediaSequence+o})},rH=function(t){var e=t.oldPlaylists,i=t.newPlaylists,r=t.timelineStarts;i.forEach(function(o){o.discontinuitySequence=Xb(r,function(h){var d=h.timeline;return d===o.timeline});var s=iH(e,o.attributes.NAME);if(s&&!o.sidx){var a=o.segments[0],l=Xb(s.segments,function(h){return Math.abs(h.presentationTime-a.presentationTime)<eH});if(l===-1){SS({playlist:o,mediaSequence:s.mediaSequence+s.segments.length}),o.segments[0].discontinuity=!0,o.discontinuityStarts.unshift(0),(!s.segments.length&&o.timeline>s.timeline||s.segments.length&&o.timeline>s.segments[s.segments.length-1].timeline)&&o.discontinuitySequence--;return}var u=s.segments[l];u.discontinuity&&!a.discontinuity&&(a.discontinuity=!0,o.discontinuityStarts.unshift(0),o.discontinuitySequence--),SS({playlist:o,mediaSequence:s.segments[l].number})}})},nH=function(t){var e=t.oldManifest,i=t.newManifest,r=e.playlists.concat(wS(e)),o=i.playlists.concat(wS(i));return i.timelineStarts=pB([e.timelineStarts,i.timelineStarts]),rH({oldPlaylists:r,newPlaylists:o,timelineStarts:i.timelineStarts}),i},fm=function(t){return t&&t.uri+"-"+Z3(t.byterange)},L0=function(t){var e=cB(t.reduce(function(i,r){var o=r.attributes.id+(r.attributes.lang||"");if(!i[o])i[o]=r,i[o].attributes.timelineStarts=[];else{if(r.segments){var s;r.segments[0]&&(r.segments[0].discontinuity=!0),(s=i[o].segments).push.apply(s,r.segments)}r.attributes.contentProtection&&(i[o].attributes.contentProtection=r.attributes.contentProtection)}return i[o].attributes.timelineStarts.push({start:r.attributes.periodStart,timeline:r.attributes.periodStart}),i},{}));return e.map(function(i){return i.discontinuityStarts=Y3(i.segments||[],"discontinuity"),i})},vy=function(t,e){var i=fm(t.sidx),r=i&&e[i]&&e[i].sidx;return r&&my(t,r,t.sidx.resolvedUri),t},oH=function(t,e){if(e===void 0&&(e={}),!Object.keys(e).length)return t;for(var i in t)t[i]=vy(t[i],e);return t},sH=function(t,e){var i,r=t.attributes,o=t.segments,s=t.sidx,a=t.mediaSequence,l=t.discontinuitySequence,u=t.discontinuityStarts,h={attributes:(i={NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:"",targetDuration:r.duration,discontinuitySequence:l,discontinuityStarts:u,timelineStarts:r.timelineStarts,mediaSequence:a,segments:o};return r.contentProtection&&(h.contentProtection=r.contentProtection),s&&(h.sidx=s),e&&(h.attributes.AUDIO="audio",h.attributes.SUBTITLES="subs"),h},aH=function(t){var e,i=t.attributes,r=t.segments,o=t.mediaSequence,s=t.discontinuityStarts,a=t.discontinuitySequence;typeof r>"u"&&(r=[{uri:i.baseUrl,timeline:i.periodStart,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration);var l=(e={NAME:i.id,BANDWIDTH:i.bandwidth},e["PROGRAM-ID"]=1,e);return i.codecs&&(l.CODECS=i.codecs),{attributes:l,uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:i.baseUrl||"",targetDuration:i.duration,timelineStarts:i.timelineStarts,discontinuityStarts:s,discontinuitySequence:a,mediaSequence:o,segments:r}},lH=function(t,e,i){e===void 0&&(e={}),i===void 0&&(i=!1);var r,o=t.reduce(function(a,l){var u=l.attributes.role&&l.attributes.role.value||"",h=l.attributes.lang||"",d=l.attributes.label||"main";if(h&&!l.attributes.label){var c=u?" ("+u+")":"";d=""+l.attributes.lang+c}a[d]||(a[d]={language:h,autoselect:!0,default:u==="main",playlists:[],uri:""});var f=vy(sH(l,i),e);return a[d].playlists.push(f),typeof r>"u"&&u==="main"&&(r=l,r.default=!0),a},{});if(!r){var s=Object.keys(o)[0];o[s].default=!0}return o},uH=function(t,e){return e===void 0&&(e={}),t.reduce(function(i,r){var o=r.attributes.lang||"text";return i[o]||(i[o]={language:o,default:!1,autoselect:!1,playlists:[],uri:""}),i[o].playlists.push(vy(aH(r),e)),i},{})},hH=function(t){return t.reduce(function(e,i){return i&&i.forEach(function(r){var o=r.channel,s=r.language;e[s]={autoselect:!1,default:!1,instreamId:o,language:s},r.hasOwnProperty("aspectRatio")&&(e[s].aspectRatio=r.aspectRatio),r.hasOwnProperty("easyReader")&&(e[s].easyReader=r.easyReader),r.hasOwnProperty("3D")&&(e[s]["3D"]=r["3D"])}),e},{})},dH=function(t){var e,i=t.attributes,r=t.segments,o=t.sidx,s=t.discontinuityStarts,a={attributes:(e={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},e["PROGRAM-ID"]=1,e),uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:"",targetDuration:i.duration,discontinuityStarts:s,timelineStarts:i.timelineStarts,segments:r};return i.frameRate&&(a.attributes["FRAME-RATE"]=i.frameRate),i.contentProtection&&(a.contentProtection=i.contentProtection),o&&(a.sidx=o),a},cH=function(t){var e=t.attributes;return e.mimeType==="video/mp4"||e.mimeType==="video/webm"||e.contentType==="video"},fH=function(t){var e=t.attributes;return e.mimeType==="audio/mp4"||e.mimeType==="audio/webm"||e.contentType==="audio"},gH=function(t){var e=t.attributes;return e.mimeType==="text/vtt"||e.contentType==="text"},pH=function(t,e){t.forEach(function(i){i.mediaSequence=0,i.discontinuitySequence=Xb(e,function(r){var o=r.timeline;return o===i.timeline}),i.segments&&i.segments.forEach(function(r,o){r.number=o})})},xS=function(t){return t?Object.keys(t).reduce(function(e,i){var r=t[i];return e.concat(r.playlists)},[]):[]},mH=function(t){var e,i=t.dashPlaylists,r=t.locations,o=t.sidxMapping,s=o===void 0?{}:o,a=t.previousManifest;if(!i.length)return{};var l=i[0].attributes,u=l.sourceDuration,h=l.type,d=l.suggestedPresentationDelay,c=l.minimumUpdatePeriod,f=L0(i.filter(cH)).map(dH),g=L0(i.filter(fH)),m=L0(i.filter(gH)),p=i.map(function(A){return A.attributes.captionServices}).filter(Boolean),v={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(e={AUDIO:{},VIDEO:{}},e["CLOSED-CAPTIONS"]={},e.SUBTITLES={},e),uri:"",duration:u,playlists:oH(f,s)};c>=0&&(v.minimumUpdatePeriod=c*1e3),r&&(v.locations=r),h==="dynamic"&&(v.suggestedPresentationDelay=d);var b=v.playlists.length===0,C=g.length?lH(g,s,b):null,y=m.length?uH(m,s):null,w=f.concat(xS(C),xS(y)),_=w.map(function(A){var T=A.timelineStarts;return T});return v.timelineStarts=pB(_),pH(w,v.timelineStarts),C&&(v.mediaGroups.AUDIO.audio=C),y&&(v.mediaGroups.SUBTITLES.subs=y),p.length&&(v.mediaGroups["CLOSED-CAPTIONS"].cc=hH(p)),a?nH({oldManifest:a,newManifest:v}):v},vH=function(t,e,i){var r=t.NOW,o=t.clientOffset,s=t.availabilityStartTime,a=t.timescale,l=a===void 0?1:a,u=t.periodStart,h=u===void 0?0:u,d=t.minimumUpdatePeriod,c=d===void 0?0:d,f=(r+o)/1e3,g=s+h,m=f+c,p=m-g;return Math.ceil((p*l-e)/i)},mB=function(t,e){for(var i=t.type,r=t.minimumUpdatePeriod,o=r===void 0?0:r,s=t.media,a=s===void 0?"":s,l=t.sourceDuration,u=t.timescale,h=u===void 0?1:u,d=t.startNumber,c=d===void 0?1:d,f=t.periodStart,g=[],m=-1,p=0;p<e.length;p++){var v=e[p],b=v.d,C=v.r||0,y=v.t||0;m<0&&(m=y),y&&y>m&&(m=y);var w=void 0;if(C<0){var _=p+1;_===e.length?i==="dynamic"&&o>0&&a.indexOf("$Number$")>0?w=vH(t,m,b):w=(l*h-m)/b:w=(e[_].t-m)/b}else w=C+1;for(var A=c+g.length+w,T=c+g.length;T<A;)g.push({number:T,duration:b/h,time:m,timeline:f}),m+=b,T++}return g},bH=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,_H=function(t){return function(e,i,r,o){if(e==="$$")return"$";if(typeof t[i]>"u")return e;var s=""+t[i];return i==="RepresentationID"||(r?o=parseInt(o,10):o=1,s.length>=o)?s:""+new Array(o-s.length+1).join("0")+s}},TS=function(t,e){return t.replace(bH,_H(e))},CH=function(t,e){return!t.duration&&!e?[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodStart}]:t.duration?py(t):mB(t,e)},yH=function(t,e){var i={RepresentationID:t.id,Bandwidth:t.bandwidth||0},r=t.initialization,o=r===void 0?{sourceURL:"",range:""}:r,s=rd({baseUrl:t.baseUrl,source:TS(o.sourceURL,i),range:o.range}),a=CH(t,e);return a.map(function(l){i.Number=l.number,i.Time=l.time;var u=TS(t.media||"",i),h=t.timescale||1,d=t.presentationTimeOffset||0,c=t.periodStart+(l.time-d)/h,f={uri:u,timeline:l.timeline,duration:l.duration,resolvedUri:hm(t.baseUrl||"",u),map:s,number:l.number,presentationTime:c};return f})},wH=function(t,e){var i=t.baseUrl,r=t.initialization,o=r===void 0?{}:r,s=rd({baseUrl:i,source:o.sourceURL,range:o.range}),a=rd({baseUrl:i,source:e.media,range:e.mediaRange});return a.map=s,a},SH=function(t,e){var i=t.duration,r=t.segmentUrls,o=r===void 0?[]:r,s=t.periodStart;if(!i&&!e||i&&e)throw new Error(au.SEGMENT_TIME_UNSPECIFIED);var a=o.map(function(h){return wH(t,h)}),l;i&&(l=py(t)),e&&(l=mB(t,e));var u=l.map(function(h,d){if(a[d]){var c=a[d],f=t.timescale||1,g=t.presentationTimeOffset||0;return c.timeline=h.timeline,c.duration=h.duration,c.number=h.number,c.presentationTime=s+(h.time-g)/f,c}}).filter(function(h){return h});return u},xH=function(t){var e=t.attributes,i=t.segmentInfo,r,o;i.template?(o=yH,r=Pr(e,i.template)):i.base?(o=gB,r=Pr(e,i.base)):i.list&&(o=SH,r=Pr(e,i.list));var s={attributes:e};if(!o)return s;var a=o(r,i.segmentTimeline);if(r.duration){var l=r,u=l.duration,h=l.timescale,d=h===void 0?1:h;r.duration=u/d}else a.length?r.duration=a.reduce(function(c,f){return Math.max(c,Math.ceil(f.duration))},0):r.duration=0;return s.attributes=r,s.segments=a,i.base&&r.indexRange&&(s.sidx=a[0],s.segments=[]),s},TH=function(t){return t.map(xH)},Mi=function(t,e){return fB(t.childNodes).filter(function(i){var r=i.tagName;return r===e})},by=function(t){return t.textContent.trim()},AH=function(t){return parseFloat(t.split("/").reduce(function(e,i){return e/i}))},dl=function(t){var e=31536e3,i=30*24*60*60,r=24*60*60,o=60*60,s=60,a=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,l=a.exec(t);if(!l)return 0;var u=l.slice(1),h=u[0],d=u[1],c=u[2],f=u[3],g=u[4],m=u[5];return parseFloat(h||0)*e+parseFloat(d||0)*i+parseFloat(c||0)*r+parseFloat(f||0)*o+parseFloat(g||0)*s+parseFloat(m||0)},RH=function(t){var e=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;return e.test(t)&&(t+="Z"),Date.parse(t)},AS={mediaPresentationDuration:function(t){return dl(t)},availabilityStartTime:function(t){return RH(t)/1e3},minimumUpdatePeriod:function(t){return dl(t)},suggestedPresentationDelay:function(t){return dl(t)},type:function(t){return t},timeShiftBufferDepth:function(t){return dl(t)},start:function(t){return dl(t)},width:function(t){return parseInt(t,10)},height:function(t){return parseInt(t,10)},bandwidth:function(t){return parseInt(t,10)},frameRate:function(t){return AH(t)},startNumber:function(t){return parseInt(t,10)},timescale:function(t){return parseInt(t,10)},presentationTimeOffset:function(t){return parseInt(t,10)},duration:function(t){var e=parseInt(t,10);return isNaN(e)?dl(t):e},d:function(t){return parseInt(t,10)},t:function(t){return parseInt(t,10)},r:function(t){return parseInt(t,10)},DEFAULT:function(t){return t}},pr=function(t){return t&&t.attributes?fB(t.attributes).reduce(function(e,i){var r=AS[i.name]||AS.DEFAULT;return e[i.name]=r(i.value),e},{}):{}},EH={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},gm=function(t,e){return e.length?cm(t.map(function(i){return e.map(function(r){return hm(i,by(r))})})):t},_y=function(t){var e=Mi(t,"SegmentTemplate")[0],i=Mi(t,"SegmentList")[0],r=i&&Mi(i,"SegmentURL").map(function(c){return Pr({tag:"SegmentURL"},pr(c))}),o=Mi(t,"SegmentBase")[0],s=i||e,a=s&&Mi(s,"SegmentTimeline")[0],l=i||o||e,u=l&&Mi(l,"Initialization")[0],h=e&&pr(e);h&&u?h.initialization=u&&pr(u):h&&h.initialization&&(h.initialization={sourceURL:h.initialization});var d={template:h,segmentTimeline:a&&Mi(a,"S").map(function(c){return pr(c)}),list:i&&Pr(pr(i),{segmentUrls:r,initialization:pr(u)}),base:o&&Pr(pr(o),{initialization:pr(u)})};return Object.keys(d).forEach(function(c){d[c]||delete d[c]}),d},MH=function(t,e,i){return function(r){var o=Mi(r,"BaseURL"),s=gm(e,o),a=Pr(t,pr(r)),l=_y(r);return s.map(function(u){return{segmentInfo:Pr(i,l),attributes:Pr(a,{baseUrl:u})}})}},BH=function(t){return t.reduce(function(e,i){var r=pr(i);r.schemeIdUri&&(r.schemeIdUri=r.schemeIdUri.toLowerCase());var o=EH[r.schemeIdUri];if(o){e[o]={attributes:r};var s=Mi(i,"cenc:pssh")[0];if(s){var a=by(s);e[o].pssh=a&&oB(a)}}return e},{})},PH=function(t){if(t.schemeIdUri==="urn:scte:dash:cc:cea-608:2015"){var e=typeof t.value!="string"?[]:t.value.split(";");return e.map(function(r){var o,s;if(s=r,/^CC\d=/.test(r)){var a=r.split("=");o=a[0],s=a[1]}else/^CC\d$/.test(r)&&(o=r);return{channel:o,language:s}})}else if(t.schemeIdUri==="urn:scte:dash:cc:cea-708:2015"){var i=typeof t.value!="string"?[]:t.value.split(";");return i.map(function(r){var o={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(r)){var s=r.split("="),a=s[0],l=s[1],u=l===void 0?"":l;o.channel=a,o.language=r,u.split(",").forEach(function(h){var d=h.split(":"),c=d[0],f=d[1];c==="lang"?o.language=f:c==="er"?o.easyReader=Number(f):c==="war"?o.aspectRatio=Number(f):c==="3D"&&(o["3D"]=Number(f))})}else o.language=r;return o.channel&&(o.channel="SERVICE"+o.channel),o})}},kH=function(t,e,i){return function(r){var o=pr(r),s=gm(e,Mi(r,"BaseURL")),a=Mi(r,"Role")[0],l={role:pr(a)},u=Pr(t,o,l),h=Mi(r,"Accessibility")[0],d=PH(pr(h));d&&(u=Pr(u,{captionServices:d}));var c=Mi(r,"Label")[0];if(c&&c.childNodes.length){var f=c.childNodes[0].nodeValue.trim();u=Pr(u,{label:f})}var g=BH(Mi(r,"ContentProtection"));Object.keys(g).length&&(u=Pr(u,{contentProtection:g}));var m=_y(r),p=Mi(r,"Representation"),v=Pr(i,m);return cm(p.map(MH(u,s,v)))}},LH=function(t,e){return function(i,r){var o=gm(e,Mi(i.node,"BaseURL")),s=Pr(t,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(s.periodDuration=i.attributes.duration);var a=Mi(i.node,"AdaptationSet"),l=_y(i.node);return cm(a.map(kH(s,o,l)))}},DH=function(t){var e=t.attributes,i=t.priorPeriodAttributes,r=t.mpdType;return typeof e.start=="number"?e.start:i&&typeof i.start=="number"&&typeof i.duration=="number"?i.start+i.duration:!i&&r==="static"?0:null},IH=function(t,e){e===void 0&&(e={});var i=e,r=i.manifestUri,o=r===void 0?"":r,s=i.NOW,a=s===void 0?Date.now():s,l=i.clientOffset,u=l===void 0?0:l,h=Mi(t,"Period");if(!h.length)throw new Error(au.INVALID_NUMBER_OF_PERIOD);var d=Mi(t,"Location"),c=pr(t),f=gm([o],Mi(t,"BaseURL"));c.type=c.type||"static",c.sourceDuration=c.mediaPresentationDuration||0,c.NOW=a,c.clientOffset=u,d.length&&(c.locations=d.map(by));var g=[];return h.forEach(function(m,p){var v=pr(m),b=g[p-1];v.start=DH({attributes:v,priorPeriodAttributes:b?b.attributes:null,mpdType:c.type}),g.push({node:m,attributes:v})}),{locations:c.locations,representationInfo:cm(g.map(LH(c,f)))}},vB=function(t){if(t==="")throw new Error(au.DASH_EMPTY_MANIFEST);var e=new q3.DOMParser,i,r;try{i=e.parseFromString(t,"application/xml"),r=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch{}if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(au.DASH_INVALID_XML);return r},FH=function(t){var e=Mi(t,"UTCTiming")[0];if(!e)return null;var i=pr(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(au.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},OH=function(t,e){e===void 0&&(e={});var i=IH(vB(t),e),r=TH(i.representationInfo);return mH({dashPlaylists:r,locations:i.locations,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest})},HH=function(t){return FH(vB(t))},D0,RS;function zH(){if(RS)return D0;RS=1;var n=Math.pow(2,32),t=function(e){var i=new DataView(e.buffer,e.byteOffset,e.byteLength),r;return i.getBigUint64?(r=i.getBigUint64(0),r<Number.MAX_SAFE_INTEGER?Number(r):r):i.getUint32(0)*n+i.getUint32(4)};return D0={getUint64:t,MAX_UINT32:n},D0}var I0,ES;function NH(){if(ES)return I0;ES=1;var n=zH().getUint64,t=function(e){var i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8)},o=12;r.version===0?(r.earliestPresentationTime=i.getUint32(o),r.firstOffset=i.getUint32(o+4),o+=8):(r.earliestPresentationTime=n(e.subarray(o)),r.firstOffset=n(e.subarray(o+8)),o+=16),o+=2;var s=i.getUint16(o);for(o+=2;s>0;o+=12,s--)r.references.push({referenceType:(e[o]&128)>>>7,referencedSize:i.getUint32(o)&2147483647,subsegmentDuration:i.getUint32(o+4),startsWithSap:!!(e[o+8]&128),sapType:(e[o+8]&112)>>>4,sapDeltaTime:i.getUint32(o+8)&268435455});return r};return I0=t,I0}var WH=NH();const UH=no(WH);var VH=ee([73,68,51]),jH=function(t,e){e===void 0&&(e=0),t=ee(t);var i=t[e+5],r=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9],o=(i&16)>>4;return o?r+20:r+10},Sh=function n(t,e){return e===void 0&&(e=0),t=ee(t),t.length-e<10||!si(t,VH,{offset:e})?e:(e+=jH(t,e),n(t,e))},MS=function(t){return typeof t=="string"?hB(t):t},GH=function(t){return Array.isArray(t)?t.map(function(e){return MS(e)}):[MS(t)]},$H=function n(t,e,i){i===void 0&&(i=!1),e=GH(e),t=ee(t);var r=[];if(!e.length)return r;for(var o=0;o<t.length;){var s=(t[o]<<24|t[o+1]<<16|t[o+2]<<8|t[o+3])>>>0,a=t.subarray(o+4,o+8);if(s===0)break;var l=o+s;if(l>t.length){if(i)break;l=t.length}var u=t.subarray(o+8,l);si(a,e[0])&&(e.length===1?r.push(u):r.push.apply(r,n(u,e.slice(1),i))),o=l}return r},Rc={EBML:ee([26,69,223,163]),DocType:ee([66,130]),Segment:ee([24,83,128,103]),SegmentInfo:ee([21,73,169,102]),Tracks:ee([22,84,174,107]),Track:ee([174]),TrackNumber:ee([215]),DefaultDuration:ee([35,227,131]),TrackEntry:ee([174]),TrackType:ee([131]),FlagDefault:ee([136]),CodecID:ee([134]),CodecPrivate:ee([99,162]),VideoTrack:ee([224]),AudioTrack:ee([225]),Cluster:ee([31,67,182,117]),Timestamp:ee([231]),TimestampScale:ee([42,215,177]),BlockGroup:ee([160]),BlockDuration:ee([155]),Block:ee([161]),SimpleBlock:ee([163])},Yb=[128,64,32,16,8,4,2,1],qH=function(t){for(var e=1,i=0;i<Yb.length&&!(t&Yb[i]);i++)e++;return e},Wf=function(t,e,i,r){i===void 0&&(i=!0),r===void 0&&(r=!1);var o=qH(t[e]),s=t.subarray(e,e+o);return i&&(s=Array.prototype.slice.call(t,e,e+o),s[0]^=Yb[o-1]),{length:o,value:z3(s,{signed:r}),bytes:s}},BS=function n(t){return typeof t=="string"?t.match(/.{1,2}/g).map(function(e){return n(e)}):typeof t=="number"?N3(t):t},XH=function(t){return Array.isArray(t)?t.map(function(e){return BS(e)}):[BS(t)]},YH=function n(t,e,i){if(i>=e.length)return e.length;var r=Wf(e,i,!1);if(si(t.bytes,r.bytes))return i;var o=Wf(e,i+r.length);return n(t,e,i+o.length+o.value+r.length)},PS=function n(t,e){e=XH(e),t=ee(t);var i=[];if(!e.length)return i;for(var r=0;r<t.length;){var o=Wf(t,r,!1),s=Wf(t,r+o.length),a=r+o.length+s.length;s.value===127&&(s.value=YH(o,t,a),s.value!==t.length&&(s.value-=a));var l=a+s.value>t.length?t.length:a+s.value,u=t.subarray(a,l);si(e[0],o.bytes)&&(e.length===1?i.push(u):i=i.concat(n(u,e.slice(1))));var h=o.length+s.length+u.length;r+=h}return i},KH=ee([0,0,0,1]),ZH=ee([0,0,1]),QH=ee([0,0,3]),JH=function(t){for(var e=[],i=1;i<t.length-2;)si(t.subarray(i,i+3),QH)&&(e.push(i+2),i++),i++;if(e.length===0)return t;var r=t.length-e.length,o=new Uint8Array(r),s=0;for(i=0;i<r;s++,i++)s===e[0]&&(s++,e.shift()),o[i]=t[s];return o},bB=function(t,e,i,r){t=ee(t),i=[].concat(i);for(var o=0,s,a=0;o<t.length&&(a<r||s);){var l=void 0;if(si(t.subarray(o),KH)?l=4:si(t.subarray(o),ZH)&&(l=3),!l){o++;continue}if(a++,s)return JH(t.subarray(s,o));var u=void 0;e==="h264"?u=t[o+l]&31:e==="h265"&&(u=t[o+l]>>1&63),i.indexOf(u)!==-1&&(s=o+l),o+=l+(e==="h264"?1:2)}return t.subarray(0,0)},tz=function(t,e,i){return bB(t,"h264",e,i)},ez=function(t,e,i){return bB(t,"h265",e,i)},Sr={webm:ee([119,101,98,109]),matroska:ee([109,97,116,114,111,115,107,97]),flac:ee([102,76,97,67]),ogg:ee([79,103,103,83]),ac3:ee([11,119]),riff:ee([82,73,70,70]),avi:ee([65,86,73]),wav:ee([87,65,86,69]),"3gp":ee([102,116,121,112,51,103]),mp4:ee([102,116,121,112]),fmp4:ee([115,116,121,112]),mov:ee([102,116,121,112,113,116]),moov:ee([109,111,111,118]),moof:ee([109,111,111,102])},lu={aac:function(t){var e=Sh(t);return si(t,[255,16],{offset:e,mask:[255,22]})},mp3:function(t){var e=Sh(t);return si(t,[255,2],{offset:e,mask:[255,6]})},webm:function(t){var e=PS(t,[Rc.EBML,Rc.DocType])[0];return si(e,Sr.webm)},mkv:function(t){var e=PS(t,[Rc.EBML,Rc.DocType])[0];return si(e,Sr.matroska)},mp4:function(t){if(lu["3gp"](t)||lu.mov(t))return!1;if(si(t,Sr.mp4,{offset:4})||si(t,Sr.fmp4,{offset:4})||si(t,Sr.moof,{offset:4})||si(t,Sr.moov,{offset:4}))return!0},mov:function(t){return si(t,Sr.mov,{offset:4})},"3gp":function(t){return si(t,Sr["3gp"],{offset:4})},ac3:function(t){var e=Sh(t);return si(t,Sr.ac3,{offset:e})},ts:function(t){if(t.length<189&&t.length>=1)return t[0]===71;for(var e=0;e+188<t.length&&e<188;){if(t[e]===71&&t[e+188]===71)return!0;e+=1}return!1},flac:function(t){var e=Sh(t);return si(t,Sr.flac,{offset:e})},ogg:function(t){return si(t,Sr.ogg)},avi:function(t){return si(t,Sr.riff)&&si(t,Sr.avi,{offset:8})},wav:function(t){return si(t,Sr.riff)&&si(t,Sr.wav,{offset:8})},h264:function(t){return tz(t,7,3).length},h265:function(t){return ez(t,[32,33],3).length}},Kb=Object.keys(lu).filter(function(n){return n!=="ts"&&n!=="h264"&&n!=="h265"}).concat(["ts","h264","h265"]);Kb.forEach(function(n){var t=lu[n];lu[n]=function(e){return t(ee(e))}});var iz=lu,Cy=function(t){t=ee(t);for(var e=0;e<Kb.length;e++){var i=Kb[e];if(iz[i](t))return i}return""},rz=function(t){return $H(t,["moof"]).length>0},F0,kS;function nz(){if(kS)return F0;kS=1;var n=9e4,t,e,i,r,o,s,a;return t=function(l){return l*n},e=function(l,u){return l*u},i=function(l){return l/n},r=function(l,u){return l/u},o=function(l,u){return t(r(l,u))},s=function(l,u){return e(i(l),u)},a=function(l,u,h){return i(h?l:l-u)},F0={ONE_SECOND_IN_TS:n,secondsToVideoTs:t,secondsToAudioTs:e,videoTsToSeconds:i,audioTsToSeconds:r,audioTsToVideoTs:o,videoTsToAudioTs:s,metadataTsToSeconds:a},F0}var Uf=nz();function Zb(n){return Zb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zb(n)}function oz(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function Qb(n){var t=typeof Map=="function"?new Map:void 0;return Qb=function(i){if(i===null||!oz(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(i))return t.get(i);t.set(i,r)}function r(){return nB(i,arguments,Zb(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),su(r,i)},Qb(n)}/**
 * @license
 * Video.js 7.21.7 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var _B="7.21.7",es={},Us=function(t,e){return es[t]=es[t]||[],e&&(es[t]=es[t].concat(e)),es[t]},sz=function(t,e){Us(t,e)},CB=function(t,e){var i=Us(t).indexOf(e);return i<=-1?!1:(es[t]=es[t].slice(),es[t].splice(i,1),!0)},az=function(t,e){Us(t,[].concat(e).map(function(i){var r=function o(){return CB(t,o),i.apply(void 0,arguments)};return r}))},Vf={prefixed:!0},wf=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],LS=wf[0],xh;for(var Ec=0;Ec<wf.length;Ec++)if(wf[Ec][1]in Rt){xh=wf[Ec];break}if(xh){for(var Mc=0;Mc<xh.length;Mc++)Vf[LS[Mc]]=xh[Mc];Vf.prefixed=xh[0]!==LS[0]}var Ur=[],lz=function(t,e){return function(i,r,o){var s=e.levels[r],a=new RegExp("^("+s+")$");if(i!=="log"&&o.unshift(i.toUpperCase()+":"),o.unshift(t+":"),Ur){Ur.push([].concat(o));var l=Ur.length-1e3;Ur.splice(0,l>0?l:0)}if(K.console){var u=K.console[i];!u&&i==="debug"&&(u=K.console.info||K.console.log),!(!u||!s||!a.test(i))&&u[Array.isArray(o)?"apply":"call"](K.console,o)}}};function yB(n){var t="info",e,i=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];e("log",t,s)};return e=lz(n,i),i.createLogger=function(r){return yB(n+": "+r)},i.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:t},i.level=function(r){if(typeof r=="string"){if(!i.levels.hasOwnProperty(r))throw new Error('"'+r+'" in not a valid log level');t=r}return t},i.history=function(){return Ur?[].concat(Ur):[]},i.history.filter=function(r){return(Ur||[]).filter(function(o){return new RegExp(".*"+r+".*").test(o[0])})},i.history.clear=function(){Ur&&(Ur.length=0)},i.history.disable=function(){Ur!==null&&(Ur.length=0,Ur=null)},i.history.enable=function(){Ur===null&&(Ur=[])},i.error=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e("error",t,o)},i.warn=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e("warn",t,o)},i.debug=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e("debug",t,o)},i}var _e=yB("VIDEOJS"),wB=_e.createLogger,uz=Object.prototype.toString,SB=function(t){return hs(t)?Object.keys(t):[]};function Nl(n,t){SB(n).forEach(function(e){return t(n[e],e)})}function hz(n,t,e){return e===void 0&&(e=0),SB(n).reduce(function(i,r){return t(i,n[r],r)},e)}function pi(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return Object.assign?Jn.apply(void 0,[n].concat(e)):(e.forEach(function(r){r&&Nl(r,function(o,s){n[s]=o})}),n)}function hs(n){return!!n&&typeof n=="object"}function nd(n){return hs(n)&&uz.call(n)==="[object Object]"&&n.constructor===Object}function od(n,t){if(!n||!t)return"";if(typeof K.getComputedStyle=="function"){var e;try{e=K.getComputedStyle(n)}catch{return""}return e?e.getPropertyValue(t)||e[t]:""}return""}var Xi=K.navigator&&K.navigator.userAgent||"",DS=/AppleWebKit\/([\d.]+)/i.exec(Xi),dz=DS?parseFloat(DS.pop()):null,xB=/iPod/i.test(Xi),cz=function(){var n=Xi.match(/OS (\d+)_/i);return n&&n[1]?n[1]:null}(),ps=/Android/i.test(Xi),yy=function(){var n=Xi.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!n)return null;var t=n[1]&&parseFloat(n[1]),e=n[2]&&parseFloat(n[2]);return t&&e?parseFloat(n[1]+"."+n[2]):t||null}(),TB=ps&&yy<5&&dz<537,AB=/Firefox/i.test(Xi),Od=/Edg/i.test(Xi),ms=!Od&&(/Chrome/i.test(Xi)||/CriOS/i.test(Xi)),RB=function(){var n=Xi.match(/(Chrome|CriOS)\/(\d+)/);return n&&n[2]?parseFloat(n[2]):null}(),Hd=function(){var n=/MSIE\s(\d+)\.\d/.exec(Xi),t=n&&parseFloat(n[1]);return!t&&/Trident\/7.0/i.test(Xi)&&/rv:11.0/.test(Xi)&&(t=11),t}(),wy=/Safari/i.test(Xi)&&!ms&&!ps&&!Od,EB=/Windows/i.test(Xi),uu=!!(Eu()&&("ontouchstart"in K||K.navigator.maxTouchPoints||K.DocumentTouch&&K.document instanceof K.DocumentTouch)),Sy=/iPad/i.test(Xi)||wy&&uu&&!/iPhone/i.test(Xi),xy=/iPhone/i.test(Xi)&&!Sy,Hr=xy||Sy||xB,pm=(wy||Hr)&&!ms,fz=Object.freeze({__proto__:null,IS_IPOD:xB,IOS_VERSION:cz,IS_ANDROID:ps,ANDROID_VERSION:yy,IS_NATIVE_ANDROID:TB,IS_FIREFOX:AB,IS_EDGE:Od,IS_CHROME:ms,CHROME_VERSION:RB,IE_VERSION:Hd,IS_SAFARI:wy,IS_WINDOWS:EB,TOUCH_ENABLED:uu,IS_IPAD:Sy,IS_IPHONE:xy,IS_IOS:Hr,IS_ANY_SAFARI:pm});function IS(n){return typeof n=="string"&&!!n.trim()}function MB(n){if(n.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function gz(n){return new RegExp("(^|\\s)"+n+"($|\\s)")}function Eu(){return Rt===K.document}function Mu(n){return hs(n)&&n.nodeType===1}function BB(){try{return K.parent!==K.self}catch{return!0}}function PB(n){return function(t,e){if(!IS(t))return Rt[n](null);IS(e)&&(e=Rt.querySelector(e));var i=Mu(e)?e:Rt;return i[n]&&i[n](t)}}function Le(n,t,e,i){n===void 0&&(n="div"),t===void 0&&(t={}),e===void 0&&(e={});var r=Rt.createElement(n);return Object.getOwnPropertyNames(t).forEach(function(o){var s=t[o];o.indexOf("aria-")!==-1||o==="role"||o==="type"?(_e.warn(`Setting attributes in the second argument of createEl()
has been deprecated. Use the third argument instead.
`+("createEl(type, properties, attributes). Attempting to set "+o+" to "+s+".")),r.setAttribute(o,s)):o==="textContent"?nl(r,s):(r[o]!==s||o==="tabIndex")&&(r[o]=s)}),Object.getOwnPropertyNames(e).forEach(function(o){r.setAttribute(o,e[o])}),i&&Ay(r,i),r}function nl(n,t){return typeof n.textContent>"u"?n.innerText=t:n.textContent=t,n}function Jb(n,t){t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}function za(n,t){return MB(t),n.classList?n.classList.contains(t):gz(t).test(n.className)}function ns(n,t){return n.classList?n.classList.add(t):za(n,t)||(n.className=(n.className+" "+t).trim()),n}function zd(n,t){return n?(n.classList?n.classList.remove(t):(MB(t),n.className=n.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),n):(_e.warn("removeClass was called with an element that doesn't exist"),null)}function kB(n,t,e){var i=za(n,t);if(typeof e=="function"&&(e=e(n,t)),typeof e!="boolean"&&(e=!i),e!==i)return e?ns(n,t):zd(n,t),n}function LB(n,t){Object.getOwnPropertyNames(t).forEach(function(e){var i=t[e];i===null||typeof i>"u"||i===!1?n.removeAttribute(e):n.setAttribute(e,i===!0?"":i)})}function Qo(n){var t={},e=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(n&&n.attributes&&n.attributes.length>0)for(var i=n.attributes,r=i.length-1;r>=0;r--){var o=i[r].name,s=i[r].value;(typeof n[o]=="boolean"||e.indexOf(","+o+",")!==-1)&&(s=s!==null),t[o]=s}return t}function DB(n,t){return n.getAttribute(t)}function hu(n,t,e){n.setAttribute(t,e)}function mm(n,t){n.removeAttribute(t)}function IB(){Rt.body.focus(),Rt.onselectstart=function(){return!1}}function FB(){Rt.onselectstart=function(){return!0}}function du(n){if(n&&n.getBoundingClientRect&&n.parentNode){var t=n.getBoundingClientRect(),e={};return["bottom","height","left","right","top","width"].forEach(function(i){t[i]!==void 0&&(e[i]=t[i])}),e.height||(e.height=parseFloat(od(n,"height"))),e.width||(e.width=parseFloat(od(n,"width"))),e}}function sd(n){if(!n||n&&!n.offsetParent)return{left:0,top:0,width:0,height:0};for(var t=n.offsetWidth,e=n.offsetHeight,i=0,r=0;n.offsetParent&&n!==Rt[Vf.fullscreenElement];)i+=n.offsetLeft,r+=n.offsetTop,n=n.offsetParent;return{left:i,top:r,width:t,height:e}}function vm(n,t){var e={x:0,y:0};if(Hr)for(var i=n;i&&i.nodeName.toLowerCase()!=="html";){var r=od(i,"transform");if(/^matrix/.test(r)){var o=r.slice(7,-1).split(/,\s/).map(Number);e.x+=o[4],e.y+=o[5]}else if(/^matrix3d/.test(r)){var s=r.slice(9,-1).split(/,\s/).map(Number);e.x+=s[12],e.y+=s[13]}i=i.parentNode}var a={},l=sd(t.target),u=sd(n),h=u.width,d=u.height,c=t.offsetY-(u.top-l.top),f=t.offsetX-(u.left-l.left);return t.changedTouches&&(f=t.changedTouches[0].pageX-u.left,c=t.changedTouches[0].pageY+u.top,Hr&&(f-=e.x,c-=e.y)),a.y=1-Math.max(0,Math.min(1,c/d)),a.x=Math.max(0,Math.min(1,f/h)),a}function OB(n){return hs(n)&&n.nodeType===3}function Ty(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}function HB(n){return typeof n=="function"&&(n=n()),(Array.isArray(n)?n:[n]).map(function(t){if(typeof t=="function"&&(t=t()),Mu(t)||OB(t))return t;if(typeof t=="string"&&/\S/.test(t))return Rt.createTextNode(t)}).filter(function(t){return t})}function Ay(n,t){return HB(t).forEach(function(e){return n.appendChild(e)}),n}function zB(n,t){return Ay(Ty(n),t)}function ad(n){return n.button===void 0&&n.buttons===void 0||n.button===0&&n.buttons===void 0||n.type==="mouseup"&&n.button===0&&n.buttons===0?!0:!(n.button!==0||n.buttons!==1)}var Vs=PB("querySelector"),NB=PB("querySelectorAll"),WB=Object.freeze({__proto__:null,isReal:Eu,isEl:Mu,isInFrame:BB,createEl:Le,textContent:nl,prependTo:Jb,hasClass:za,addClass:ns,removeClass:zd,toggleClass:kB,setAttributes:LB,getAttributes:Qo,getAttribute:DB,setAttribute:hu,removeAttribute:mm,blockTextSelection:IB,unblockTextSelection:FB,getBoundingClientRect:du,findPosition:sd,getPointerPosition:vm,isTextNode:OB,emptyEl:Ty,normalizeContent:HB,appendContent:Ay,insertContent:zB,isSingleLeftClick:ad,$:Vs,$$:NB}),UB=!1,t_,pz=function(){if(t_.options.autoSetup!==!1){var t=Array.prototype.slice.call(Rt.getElementsByTagName("video")),e=Array.prototype.slice.call(Rt.getElementsByTagName("audio")),i=Array.prototype.slice.call(Rt.getElementsByTagName("video-js")),r=t.concat(e,i);if(r&&r.length>0)for(var o=0,s=r.length;o<s;o++){var a=r[o];if(a&&a.getAttribute){if(a.player===void 0){var l=a.getAttribute("data-setup");l!==null&&t_(a)}}else{e_(1);break}}else UB||e_(1)}};function e_(n,t){Eu()&&(t&&(t_=t),K.setTimeout(pz,n))}function i_(){UB=!0,K.removeEventListener("load",i_)}Eu()&&(Rt.readyState==="complete"?i_():K.addEventListener("load",i_));var VB=function(t){var e=Rt.createElement("style");return e.className=t,e},jB=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e},mz=3,vz=mz;function vs(){return vz++}var GB;K.WeakMap||(GB=function(){function n(){this.vdata="vdata"+Math.floor(K.performance&&K.performance.now()||Date.now()),this.data={}}var t=n.prototype;return t.set=function(i,r){var o=i[this.vdata]||vs();return i[this.vdata]||(i[this.vdata]=o),this.data[o]=r,this},t.get=function(i){var r=i[this.vdata];if(r)return this.data[r];_e("We have no data for this element",i)},t.has=function(i){var r=i[this.vdata];return r in this.data},t.delete=function(i){var r=i[this.vdata];r&&(delete this.data[r],delete i[this.vdata])},n}());var kr=K.WeakMap?new WeakMap:new GB;function FS(n,t){if(kr.has(n)){var e=kr.get(n);e.handlers[t].length===0&&(delete e.handlers[t],n.removeEventListener?n.removeEventListener(t,e.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+t,e.dispatcher)),Object.getOwnPropertyNames(e.handlers).length<=0&&(delete e.handlers,delete e.dispatcher,delete e.disabled),Object.getOwnPropertyNames(e).length===0&&kr.delete(n)}}function Ry(n,t,e,i){e.forEach(function(r){n(t,r,i)})}function bm(n){if(n.fixed_)return n;function t(){return!0}function e(){return!1}if(!n||!n.isPropagationStopped||!n.isImmediatePropagationStopped){var i=n||K.event;n={};for(var r in i)r!=="layerX"&&r!=="layerY"&&r!=="keyLocation"&&r!=="webkitMovementX"&&r!=="webkitMovementY"&&r!=="path"&&(r==="returnValue"&&i.preventDefault||(n[r]=i[r]));if(n.target||(n.target=n.srcElement||Rt),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){i.preventDefault&&i.preventDefault(),n.returnValue=!1,i.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),n.cancelBubble=!0,i.cancelBubble=!0,n.isPropagationStopped=t},n.isPropagationStopped=e,n.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),n.isImmediatePropagationStopped=t,n.stopPropagation()},n.isImmediatePropagationStopped=e,n.clientX!==null&&n.clientX!==void 0){var o=Rt.documentElement,s=Rt.body;n.pageX=n.clientX+(o&&o.scrollLeft||s&&s.scrollLeft||0)-(o&&o.clientLeft||s&&s.clientLeft||0),n.pageY=n.clientY+(o&&o.scrollTop||s&&s.scrollTop||0)-(o&&o.clientTop||s&&s.clientTop||0)}n.which=n.charCode||n.keyCode,n.button!==null&&n.button!==void 0&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n.fixed_=!0,n}var Bc,bz=function(){if(typeof Bc!="boolean"){Bc=!1;try{var t=Object.defineProperty({},"passive",{get:function(){Bc=!0}});K.addEventListener("test",null,t),K.removeEventListener("test",null,t)}catch{}}return Bc},_z=["touchstart","touchmove"];function fn(n,t,e){if(Array.isArray(t))return Ry(fn,n,t,e);kr.has(n)||kr.set(n,{});var i=kr.get(n);if(i.handlers||(i.handlers={}),i.handlers[t]||(i.handlers[t]=[]),e.guid||(e.guid=vs()),i.handlers[t].push(e),i.dispatcher||(i.disabled=!1,i.dispatcher=function(o,s){if(!i.disabled){o=bm(o);var a=i.handlers[o.type];if(a)for(var l=a.slice(0),u=0,h=l.length;u<h&&!o.isImmediatePropagationStopped();u++)try{l[u].call(n,o,s)}catch(d){_e.error(d)}}}),i.handlers[t].length===1)if(n.addEventListener){var r=!1;bz()&&_z.indexOf(t)>-1&&(r={passive:!0}),n.addEventListener(t,i.dispatcher,r)}else n.attachEvent&&n.attachEvent("on"+t,i.dispatcher)}function mr(n,t,e){if(kr.has(n)){var i=kr.get(n);if(i.handlers){if(Array.isArray(t))return Ry(mr,n,t,e);var r=function(u,h){i.handlers[h]=[],FS(u,h)};if(t===void 0){for(var o in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},o)&&r(n,o);return}var s=i.handlers[t];if(s){if(!e){r(n,t);return}if(e.guid)for(var a=0;a<s.length;a++)s[a].guid===e.guid&&s.splice(a--,1);FS(n,t)}}}}function Bu(n,t,e){var i=kr.has(n)?kr.get(n):{},r=n.parentNode||n.ownerDocument;if(typeof t=="string"?t={type:t,target:n}:t.target||(t.target=n),t=bm(t),i.dispatcher&&i.dispatcher.call(n,t,e),r&&!t.isPropagationStopped()&&t.bubbles===!0)Bu.call(null,r,t,e);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){kr.has(t.target)||kr.set(t.target,{});var o=kr.get(t.target);t.target[t.type]&&(o.disabled=!0,typeof t.target[t.type]=="function"&&t.target[t.type](),o.disabled=!1)}return!t.defaultPrevented}function _m(n,t,e){if(Array.isArray(t))return Ry(_m,n,t,e);var i=function r(){mr(n,t,r),e.apply(this,arguments)};i.guid=e.guid=e.guid||vs(),fn(n,t,i)}function $B(n,t,e){var i=function r(){mr(n,t,r),e.apply(this,arguments)};i.guid=e.guid=e.guid||vs(),fn(n,t,i)}var Cz=Object.freeze({__proto__:null,fixEvent:bm,on:fn,off:mr,trigger:Bu,one:_m,any:$B}),to=30,ni=function(t,e,i){e.guid||(e.guid=vs());var r=e.bind(t);return r.guid=i?i+"_"+e.guid:e.guid,r},ds=function(t,e){var i=K.performance.now(),r=function(){var s=K.performance.now();s-i>=e&&(t.apply(void 0,arguments),i=s)};return r},yz=function(t,e,i,r){r===void 0&&(r=K);var o,s=function(){r.clearTimeout(o),o=null},a=function(){var u=this,h=arguments,d=function(){o=null,d=null,t.apply(u,h)};r.clearTimeout(o),o=r.setTimeout(d,e)};return a.cancel=s,a},Yi=function(){};Yi.prototype.allowedEvents_={};Yi.prototype.on=function(n,t){var e=this.addEventListener;this.addEventListener=function(){},fn(this,n,t),this.addEventListener=e};Yi.prototype.addEventListener=Yi.prototype.on;Yi.prototype.off=function(n,t){mr(this,n,t)};Yi.prototype.removeEventListener=Yi.prototype.off;Yi.prototype.one=function(n,t){var e=this.addEventListener;this.addEventListener=function(){},_m(this,n,t),this.addEventListener=e};Yi.prototype.any=function(n,t){var e=this.addEventListener;this.addEventListener=function(){},$B(this,n,t),this.addEventListener=e};Yi.prototype.trigger=function(n){var t=n.type||n;typeof n=="string"&&(n={type:t}),n=bm(n),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](n),Bu(this,n)};Yi.prototype.dispatchEvent=Yi.prototype.trigger;var ih;Yi.prototype.queueTrigger=function(n){var t=this;ih||(ih=new Map);var e=n.type||n,i=ih.get(this);i||(i=new Map,ih.set(this,i));var r=i.get(e);i.delete(e),K.clearTimeout(r);var o=K.setTimeout(function(){i.delete(e),i.size===0&&(i=null,ih.delete(t)),t.trigger(n)},0);i.set(e,o)};var Cm=function(t){return typeof t.name=="function"?t.name():typeof t.name=="string"?t.name:t.name_?t.name_:t.constructor&&t.constructor.name?t.constructor.name:typeof t},os=function(t){return t instanceof Yi||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return typeof t[e]=="function"})},wz=function(t,e){os(t)?e():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(e))},r_=function(t){return typeof t=="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length},jf=function(t,e,i){if(!t||!t.nodeName&&!os(t))throw new Error("Invalid target for "+Cm(e)+"#"+i+"; must be a DOM node or evented object.")},qB=function(t,e,i){if(!r_(t))throw new Error("Invalid event type for "+Cm(e)+"#"+i+"; must be a non-empty string or array.")},XB=function(t,e,i){if(typeof t!="function")throw new Error("Invalid listener for "+Cm(e)+"#"+i+"; must be a function.")},O0=function(t,e,i){var r=e.length<3||e[0]===t||e[0]===t.eventBusEl_,o,s,a;return r?(o=t.eventBusEl_,e.length>=3&&e.shift(),s=e[0],a=e[1]):(o=e[0],s=e[1],a=e[2]),jf(o,t,i),qB(s,t,i),XB(a,t,i),a=ni(t,a),{isTargetingSelf:r,target:o,type:s,listener:a}},la=function(t,e,i,r){jf(t,t,e),t.nodeName?Cz[e](t,i,r):t[e](i,r)},Sz={on:function(){for(var t=this,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var o=O0(this,i,"on"),s=o.isTargetingSelf,a=o.target,l=o.type,u=o.listener;if(la(a,"on",l,u),!s){var h=function(){return t.off(a,l,u)};h.guid=u.guid;var d=function(){return t.off("dispose",h)};d.guid=u.guid,la(this,"on","dispose",h),la(a,"on","dispose",d)}},one:function(){for(var t=this,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var o=O0(this,i,"one"),s=o.isTargetingSelf,a=o.target,l=o.type,u=o.listener;if(s)la(a,"one",l,u);else{var h=function d(){t.off(a,l,d);for(var c=arguments.length,f=new Array(c),g=0;g<c;g++)f[g]=arguments[g];u.apply(null,f)};h.guid=u.guid,la(a,"one",l,h)}},any:function(){for(var t=this,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var o=O0(this,i,"any"),s=o.isTargetingSelf,a=o.target,l=o.type,u=o.listener;if(s)la(a,"any",l,u);else{var h=function d(){t.off(a,l,d);for(var c=arguments.length,f=new Array(c),g=0;g<c;g++)f[g]=arguments[g];u.apply(null,f)};h.guid=u.guid,la(a,"any",l,h)}},off:function(t,e,i){if(!t||r_(t))mr(this.eventBusEl_,t,e);else{var r=t,o=e;jf(r,this,"off"),qB(o,this,"off"),XB(i,this,"off"),i=ni(this,i),this.off("dispose",i),r.nodeName?(mr(r,o,i),mr(r,"dispose",i)):os(r)&&(r.off(o,i),r.off("dispose",i))}},trigger:function(t,e){jf(this.eventBusEl_,this,"trigger");var i=t&&typeof t!="string"?t.type:t;if(!r_(i)){var r="Invalid event type for "+Cm(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(t)(this.log||_e).error(r);else throw new Error(r)}return Bu(this.eventBusEl_,t,e)}};function Ey(n,t){t===void 0&&(t={});var e=t,i=e.eventBusKey;if(i){if(!n[i].nodeName)throw new Error('The eventBusKey "'+i+'" does not refer to an element.');n.eventBusEl_=n[i]}else n.eventBusEl_=Le("span",{className:"vjs-event-bus"});return pi(n,Sz),n.eventedCallbacks&&n.eventedCallbacks.forEach(function(r){r()}),n.on("dispose",function(){n.off(),[n,n.el_,n.eventBusEl_].forEach(function(r){r&&kr.has(r)&&kr.delete(r)}),K.setTimeout(function(){n.eventBusEl_=null},0)}),n}var xz={state:{},setState:function(t){var e=this;typeof t=="function"&&(t=t());var i;return Nl(t,function(r,o){e.state[o]!==r&&(i=i||{},i[o]={from:e.state[o],to:r}),e.state[o]=r}),i&&os(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function YB(n,t){return pi(n,xz),n.state=pi({},n.state,t),typeof n.handleStateChanged=="function"&&os(n)&&n.on("statechanged",n.handleStateChanged),n}var Sf=function(t){return typeof t!="string"?t:t.replace(/./,function(e){return e.toLowerCase()})},Bi=function(t){return typeof t!="string"?t:t.replace(/./,function(e){return e.toUpperCase()})},Tz=function(t,e){return Bi(t)===Bi(e)};function ii(){for(var n={},t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.forEach(function(r){r&&Nl(r,function(o,s){if(!nd(o)){n[s]=o;return}nd(n[s])||(n[s]={}),n[s]=ii(n[s],o)})}),n}var Az=function(){function n(){this.map_={}}var t=n.prototype;return t.has=function(i){return i in this.map_},t.delete=function(i){var r=this.has(i);return delete this.map_[i],r},t.set=function(i,r){return this.map_[i]=r,this},t.forEach=function(i,r){for(var o in this.map_)i.call(r,this.map_[o],o,this)},n}(),Rz=K.Map?K.Map:Az,Ez=function(){function n(){this.set_={}}var t=n.prototype;return t.has=function(i){return i in this.set_},t.delete=function(i){var r=this.has(i);return delete this.set_[i],r},t.add=function(i){return this.set_[i]=1,this},t.forEach=function(i,r){for(var o in this.set_)i.call(r,o,o,this)},n}(),H0=K.Set?K.Set:Ez,Ct=function(){function n(e,i,r){var o=this;if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=ii({},this.options_),i=this.options_=ii(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){var s=e&&e.id&&e.id()||"no_player";this.id_=s+"_component_"+vs()}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(function(a){return o.addClass(a)}),i.evented!==!1&&(Ey(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),YB(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new H0,this.setIntervalIds_=new H0,this.rafIds_=new H0,this.namedRafs_=new Rz,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(r),i.reportTouchActivity!==!1&&this.enableTouchActivity()}var t=n.prototype;return t.dispose=function(i){if(i===void 0&&(i={}),!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var r=this.children_.length-1;r>=0;r--)this.children_[r].dispose&&this.children_[r].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(i.restoreEl?this.el_.parentNode.replaceChild(i.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}},t.isDisposed=function(){return!!this.isDisposed_},t.player=function(){return this.player_},t.options=function(i){return i?(this.options_=ii(this.options_,i),this.options_):this.options_},t.el=function(){return this.el_},t.createEl=function(i,r,o){return Le(i,r,o)},t.localize=function(i,r,o){o===void 0&&(o=i);var s=this.player_.language&&this.player_.language(),a=this.player_.languages&&this.player_.languages(),l=a&&a[s],u=s&&s.split("-")[0],h=a&&a[u],d=o;return l&&l[i]?d=l[i]:h&&h[i]&&(d=h[i]),r&&(d=d.replace(/\{(\d+)\}/g,function(c,f){var g=r[f-1],m=g;return typeof g>"u"&&(m=c),m})),d},t.handleLanguagechange=function(){},t.contentEl=function(){return this.contentEl_||this.el_},t.id=function(){return this.id_},t.name=function(){return this.name_},t.children=function(){return this.children_},t.getChildById=function(i){return this.childIndex_[i]},t.getChild=function(i){if(i)return this.childNameIndex_[i]},t.getDescendant=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];r=r.reduce(function(l,u){return l.concat(u)},[]);for(var s=this,a=0;a<r.length;a++)if(s=s.getChild(r[a]),!s||!s.getChild)return;return s},t.addChild=function(i,r,o){r===void 0&&(r={}),o===void 0&&(o=this.children_.length);var s,a;if(typeof i=="string"){a=Bi(i);var l=r.componentClass||a;r.name=a;var u=n.getComponent(l);if(!u)throw new Error("Component "+l+" does not exist");if(typeof u!="function")return null;s=new u(this.player_||this,r)}else s=i;if(s.parentComponent_&&s.parentComponent_.removeChild(s),this.children_.splice(o,0,s),s.parentComponent_=this,typeof s.id=="function"&&(this.childIndex_[s.id()]=s),a=a||s.name&&Bi(s.name()),a&&(this.childNameIndex_[a]=s,this.childNameIndex_[Sf(a)]=s),typeof s.el=="function"&&s.el()){var h=null;this.children_[o+1]&&(this.children_[o+1].el_?h=this.children_[o+1].el_:Mu(this.children_[o+1])&&(h=this.children_[o+1])),this.contentEl().insertBefore(s.el(),h)}return s},t.removeChild=function(i){if(typeof i=="string"&&(i=this.getChild(i)),!(!i||!this.children_)){for(var r=!1,o=this.children_.length-1;o>=0;o--)if(this.children_[o]===i){r=!0,this.children_.splice(o,1);break}if(r){i.parentComponent_=null,this.childIndex_[i.id()]=null,this.childNameIndex_[Bi(i.name())]=null,this.childNameIndex_[Sf(i.name())]=null;var s=i.el();s&&s.parentNode===this.contentEl()&&this.contentEl().removeChild(i.el())}}},t.initChildren=function(){var i=this,r=this.options_.children;if(r){var o=this.options_,s=function(h){var d=h.name,c=h.opts;if(o[d]!==void 0&&(c=o[d]),c!==!1){c===!0&&(c={}),c.playerOptions=i.options_.playerOptions;var f=i.addChild(d,c);f&&(i[d]=f)}},a,l=n.getComponent("Tech");Array.isArray(r)?a=r:a=Object.keys(r),a.concat(Object.keys(this.options_).filter(function(u){return!a.some(function(h){return typeof h=="string"?u===h:u===h.name})})).map(function(u){var h,d;return typeof u=="string"?(h=u,d=r[h]||i.options_[h]||{}):(h=u.name,d=u),{name:h,opts:d}}).filter(function(u){var h=n.getComponent(u.opts.componentClass||Bi(u.name));return h&&!l.isTech(h)}).forEach(s)}},t.buildCSSClass=function(){return""},t.ready=function(i,r){if(r===void 0&&(r=!1),!!i){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(i);return}r?i.call(this):this.setTimeout(i,1)}},t.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var i=this.readyQueue_;this.readyQueue_=[],i&&i.length>0&&i.forEach(function(r){r.call(this)},this),this.trigger("ready")},1)},t.$=function(i,r){return Vs(i,r||this.contentEl())},t.$$=function(i,r){return NB(i,r||this.contentEl())},t.hasClass=function(i){return za(this.el_,i)},t.addClass=function(i){ns(this.el_,i)},t.removeClass=function(i){zd(this.el_,i)},t.toggleClass=function(i,r){kB(this.el_,i,r)},t.show=function(){this.removeClass("vjs-hidden")},t.hide=function(){this.addClass("vjs-hidden")},t.lockShowing=function(){this.addClass("vjs-lock-showing")},t.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.getAttribute=function(i){return DB(this.el_,i)},t.setAttribute=function(i,r){hu(this.el_,i,r)},t.removeAttribute=function(i){mm(this.el_,i)},t.width=function(i,r){return this.dimension("width",i,r)},t.height=function(i,r){return this.dimension("height",i,r)},t.dimensions=function(i,r){this.width(i,!0),this.height(r)},t.dimension=function(i,r,o){if(r!==void 0){(r===null||r!==r)&&(r=0),(""+r).indexOf("%")!==-1||(""+r).indexOf("px")!==-1?this.el_.style[i]=r:r==="auto"?this.el_.style[i]="":this.el_.style[i]=r+"px",o||this.trigger("componentresize");return}if(!this.el_)return 0;var s=this.el_.style[i],a=s.indexOf("px");return parseInt(a!==-1?s.slice(0,a):this.el_["offset"+Bi(i)],10)},t.currentDimension=function(i){var r=0;if(i!=="width"&&i!=="height")throw new Error("currentDimension only accepts width or height value");if(r=od(this.el_,i),r=parseFloat(r),r===0||isNaN(r)){var o="offset"+Bi(i);r=this.el_[o]}return r},t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.currentWidth=function(){return this.currentDimension("width")},t.currentHeight=function(){return this.currentDimension("height")},t.focus=function(){this.el_.focus()},t.blur=function(){this.el_.blur()},t.handleKeyDown=function(i){this.player_&&(fe.isEventKey(i,"Tab")||i.stopPropagation(),this.player_.handleKeyDown(i))},t.handleKeyPress=function(i){this.handleKeyDown(i)},t.emitTapEvents=function(){var i=0,r=null,o=10,s=200,a;this.on("touchstart",function(u){u.touches.length===1&&(r={pageX:u.touches[0].pageX,pageY:u.touches[0].pageY},i=K.performance.now(),a=!0)}),this.on("touchmove",function(u){if(u.touches.length>1)a=!1;else if(r){var h=u.touches[0].pageX-r.pageX,d=u.touches[0].pageY-r.pageY,c=Math.sqrt(h*h+d*d);c>o&&(a=!1)}});var l=function(){a=!1};this.on("touchleave",l),this.on("touchcancel",l),this.on("touchend",function(u){if(r=null,a===!0){var h=K.performance.now()-i;h<s&&(u.preventDefault(),this.trigger("tap"))}})},t.enableTouchActivity=function(){if(!(!this.player()||!this.player().reportUserActivity)){var i=ni(this.player(),this.player().reportUserActivity),r;this.on("touchstart",function(){i(),this.clearInterval(r),r=this.setInterval(i,250)});var o=function(a){i(),this.clearInterval(r)};this.on("touchmove",i),this.on("touchend",o),this.on("touchcancel",o)}},t.setTimeout=function(i,r){var o=this,s;return i=ni(this,i),this.clearTimersOnDispose_(),s=K.setTimeout(function(){o.setTimeoutIds_.has(s)&&o.setTimeoutIds_.delete(s),i()},r),this.setTimeoutIds_.add(s),s},t.clearTimeout=function(i){return this.setTimeoutIds_.has(i)&&(this.setTimeoutIds_.delete(i),K.clearTimeout(i)),i},t.setInterval=function(i,r){i=ni(this,i),this.clearTimersOnDispose_();var o=K.setInterval(i,r);return this.setIntervalIds_.add(o),o},t.clearInterval=function(i){return this.setIntervalIds_.has(i)&&(this.setIntervalIds_.delete(i),K.clearInterval(i)),i},t.requestAnimationFrame=function(i){var r=this;if(!this.supportsRaf_)return this.setTimeout(i,1e3/60);this.clearTimersOnDispose_();var o;return i=ni(this,i),o=K.requestAnimationFrame(function(){r.rafIds_.has(o)&&r.rafIds_.delete(o),i()}),this.rafIds_.add(o),o},t.requestNamedAnimationFrame=function(i,r){var o=this;if(!this.namedRafs_.has(i)){this.clearTimersOnDispose_(),r=ni(this,r);var s=this.requestAnimationFrame(function(){r(),o.namedRafs_.has(i)&&o.namedRafs_.delete(i)});return this.namedRafs_.set(i,s),i}},t.cancelNamedAnimationFrame=function(i){this.namedRafs_.has(i)&&(this.cancelAnimationFrame(this.namedRafs_.get(i)),this.namedRafs_.delete(i))},t.cancelAnimationFrame=function(i){return this.supportsRaf_?(this.rafIds_.has(i)&&(this.rafIds_.delete(i),K.cancelAnimationFrame(i)),i):this.clearTimeout(i)},t.clearTimersOnDispose_=function(){var i=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(r){var o=r[0],s=r[1];i[o].forEach(function(a,l){return i[s](l)})}),i.clearingTimersOnDispose_=!1}))},n.registerComponent=function(i,r){if(typeof i!="string"||!i)throw new Error('Illegal component name, "'+i+'"; must be a non-empty string.');var o=n.getComponent("Tech"),s=o&&o.isTech(r),a=n===r||n.prototype.isPrototypeOf(r.prototype);if(s||!a){var l;throw s?l="techs must be registered using Tech.registerTech()":l="must be a Component subclass",new Error('Illegal component, "'+i+'"; '+l+".")}i=Bi(i),n.components_||(n.components_={});var u=n.getComponent("Player");if(i==="Player"&&u&&u.players){var h=u.players,d=Object.keys(h);if(h&&d.length>0&&d.map(function(c){return h[c]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return n.components_[i]=r,n.components_[Sf(i)]=r,r},n.getComponent=function(i){if(!(!i||!n.components_))return n.components_[i]},n}();Ct.prototype.supportsRaf_=typeof K.requestAnimationFrame=="function"&&typeof K.cancelAnimationFrame=="function";Ct.registerComponent("Component",Ct);function Mz(n,t,e){if(typeof t!="number"||t<0||t>e)throw new Error("Failed to execute '"+n+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+e+").")}function OS(n,t,e,i){return Mz(n,i,e.length-1),e[i][t]}function z0(n){var t;return n===void 0||n.length===0?t={length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:t={length:n.length,start:OS.bind(null,"start",0,n),end:OS.bind(null,"end",1,n)},K.Symbol&&K.Symbol.iterator&&(t[K.Symbol.iterator]=function(){return(n||[]).values()}),t}function Na(n,t){return Array.isArray(n)?z0(n):n===void 0||t===void 0?z0():z0([[n,t]])}function KB(n,t){var e=0,i,r;if(!t)return 0;(!n||!n.length)&&(n=Na(0,0));for(var o=0;o<n.length;o++)i=n.start(o),r=n.end(o),r>t&&(r=t),e+=r-i;return e/t}function Lr(n){if(n instanceof Lr)return n;typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:hs(n)&&(typeof n.code=="number"&&(this.code=n.code),pi(this,n)),this.message||(this.message=Lr.defaultMessages[this.code]||"")}Lr.prototype.code=0;Lr.prototype.message="";Lr.prototype.status=null;Lr.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Lr.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var cl=0;cl<Lr.errorTypes.length;cl++)Lr[Lr.errorTypes[cl]]=cl,Lr.prototype[Lr.errorTypes[cl]]=cl;function Ih(n){return n!=null&&typeof n.then=="function"}function xo(n){Ih(n)&&n.then(null,function(t){})}var n_=function(t){var e=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(i,r,o){return t[r]&&(i[r]=t[r]),i},{cues:t.cues&&Array.prototype.map.call(t.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})});return e},Bz=function(t){var e=t.$$("track"),i=Array.prototype.map.call(e,function(o){return o.track}),r=Array.prototype.map.call(e,function(o){var s=n_(o.track);return o.src&&(s.src=o.src),s});return r.concat(Array.prototype.filter.call(t.textTracks(),function(o){return i.indexOf(o)===-1}).map(n_))},Pz=function(t,e){return t.forEach(function(i){var r=e.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(function(o){return r.addCue(o)})}),e.textTracks()},HS={textTracksToJson:Bz,jsonToTextTracks:Pz,trackToJson_:n_},N0="vjs-modal-dialog",Pu=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.handleKeyDown_=function(s){return o.handleKeyDown(s)},o.close_=function(s){return o.close(s)},o.opened_=o.hasBeenOpened_=o.hasBeenFilled_=!1,o.closeable(!o.options_.uncloseable),o.content(o.options_.content),o.contentEl_=Le("div",{className:N0+"-content"},{role:"document"}),o.descEl_=Le("p",{className:N0+"-description vjs-control-text",id:o.el().getAttribute("aria-describedby")}),nl(o.descEl_,o.description()),o.el_.appendChild(o.descEl_),o.el_.appendChild(o.contentEl_),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},e.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,n.prototype.dispose.call(this)},e.buildCSSClass=function(){return N0+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},e.label=function(){return this.localize(this.options_.label||"Modal Window")},e.description=function(){var r=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(r+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),r},e.open=function(){if(!this.opened_){var r=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!r.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&r.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=r.controls(),r.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},e.opened=function(r){return typeof r=="boolean"&&this[r?"open":"close"](),this.opened_},e.close=function(){if(this.opened_){var r=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&r.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&r.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},e.closeable=function(r){if(typeof r=="boolean"){var o=this.closeable_=!!r,s=this.getChild("closeButton");if(o&&!s){var a=this.contentEl_;this.contentEl_=this.el_,s=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=a,this.on(s,"close",this.close_)}!o&&s&&(this.off(s,"close",this.close_),this.removeChild(s),s.dispose())}return this.closeable_},e.fill=function(){this.fillWith(this.content())},e.fillWith=function(r){var o=this.contentEl(),s=o.parentNode,a=o.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,s.removeChild(o),this.empty(),zB(o,r),this.trigger("modalfill"),a?s.insertBefore(o,a):s.appendChild(o);var l=this.getChild("closeButton");l&&s.appendChild(l.el_)},e.empty=function(){this.trigger("beforemodalempty"),Ty(this.contentEl()),this.trigger("modalempty")},e.content=function(r){return typeof r<"u"&&(this.content_=r),this.content_},e.conditionalFocus_=function(){var r=Rt.activeElement,o=this.player_.el_;this.previouslyActiveEl_=null,(o.contains(r)||o===r)&&(this.previouslyActiveEl_=r,this.focus())},e.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},e.handleKeyDown=function(r){if(r.stopPropagation(),fe.isEventKey(r,"Escape")&&this.closeable()){r.preventDefault(),this.close();return}if(fe.isEventKey(r,"Tab")){for(var o=this.focusableEls_(),s=this.el_.querySelector(":focus"),a,l=0;l<o.length;l++)if(s===o[l]){a=l;break}Rt.activeElement===this.el_&&(a=0),r.shiftKey&&a===0?(o[o.length-1].focus(),r.preventDefault()):!r.shiftKey&&a===o.length-1&&(o[0].focus(),r.preventDefault())}},e.focusableEls_=function(){var r=this.el_.querySelectorAll("*");return Array.prototype.filter.call(r,function(o){return(o instanceof K.HTMLAnchorElement||o instanceof K.HTMLAreaElement)&&o.hasAttribute("href")||(o instanceof K.HTMLInputElement||o instanceof K.HTMLSelectElement||o instanceof K.HTMLTextAreaElement||o instanceof K.HTMLButtonElement)&&!o.hasAttribute("disabled")||o instanceof K.HTMLIFrameElement||o instanceof K.HTMLObjectElement||o instanceof K.HTMLEmbedElement||o.hasAttribute("tabindex")&&o.getAttribute("tabindex")!==-1||o.hasAttribute("contenteditable")})},t}(Ct);Pu.prototype.options_={pauseOnOpen:!0,temporary:!0};Ct.registerComponent("ModalDialog",Pu);var cu=function(n){kt(t,n);function t(i){var r;i===void 0&&(i=[]),r=n.call(this)||this,r.tracks_=[],Object.defineProperty(he(r),"length",{get:function(){return this.tracks_.length}});for(var o=0;o<i.length;o++)r.addTrack(i[o]);return r}var e=t.prototype;return e.addTrack=function(r){var o=this,s=this.tracks_.length;""+s in this||Object.defineProperty(this,s,{get:function(){return this.tracks_[s]}}),this.tracks_.indexOf(r)===-1&&(this.tracks_.push(r),this.trigger({track:r,type:"addtrack",target:this})),r.labelchange_=function(){o.trigger({track:r,type:"labelchange",target:o})},os(r)&&r.addEventListener("labelchange",r.labelchange_)},e.removeTrack=function(r){for(var o,s=0,a=this.length;s<a;s++)if(this[s]===r){o=this[s],o.off&&o.off(),this.tracks_.splice(s,1);break}o&&this.trigger({track:o,type:"removetrack",target:this})},e.getTrackById=function(r){for(var o=null,s=0,a=this.length;s<a;s++){var l=this[s];if(l.id===r){o=l;break}}return o},t}(Yi);cu.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(var kz in cu.prototype.allowedEvents_)cu.prototype["on"+kz]=null;var W0=function(t,e){for(var i=0;i<t.length;i++)!Object.keys(t[i]).length||e.id===t[i].id||(t[i].enabled=!1)},Lz=function(n){kt(t,n);function t(i){var r;i===void 0&&(i=[]);for(var o=i.length-1;o>=0;o--)if(i[o].enabled){W0(i,i[o]);break}return r=n.call(this,i)||this,r.changing_=!1,r}var e=t.prototype;return e.addTrack=function(r){var o=this;r.enabled&&W0(this,r),n.prototype.addTrack.call(this,r),r.addEventListener&&(r.enabledChange_=function(){o.changing_||(o.changing_=!0,W0(o,r),o.changing_=!1,o.trigger("change"))},r.addEventListener("enabledchange",r.enabledChange_))},e.removeTrack=function(r){n.prototype.removeTrack.call(this,r),r.removeEventListener&&r.enabledChange_&&(r.removeEventListener("enabledchange",r.enabledChange_),r.enabledChange_=null)},t}(cu),U0=function(t,e){for(var i=0;i<t.length;i++)!Object.keys(t[i]).length||e.id===t[i].id||(t[i].selected=!1)},Dz=function(n){kt(t,n);function t(i){var r;i===void 0&&(i=[]);for(var o=i.length-1;o>=0;o--)if(i[o].selected){U0(i,i[o]);break}return r=n.call(this,i)||this,r.changing_=!1,Object.defineProperty(he(r),"selectedIndex",{get:function(){for(var a=0;a<this.length;a++)if(this[a].selected)return a;return-1},set:function(){}}),r}var e=t.prototype;return e.addTrack=function(r){var o=this;r.selected&&U0(this,r),n.prototype.addTrack.call(this,r),r.addEventListener&&(r.selectedChange_=function(){o.changing_||(o.changing_=!0,U0(o,r),o.changing_=!1,o.trigger("change"))},r.addEventListener("selectedchange",r.selectedChange_))},e.removeTrack=function(r){n.prototype.removeTrack.call(this,r),r.removeEventListener&&r.selectedChange_&&(r.removeEventListener("selectedchange",r.selectedChange_),r.selectedChange_=null)},t}(cu),ZB=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.addTrack=function(r){var o=this;n.prototype.addTrack.call(this,r),this.queueChange_||(this.queueChange_=function(){return o.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return o.trigger("selectedlanguagechange")}),r.addEventListener("modechange",this.queueChange_);var s=["metadata","chapters"];s.indexOf(r.kind)===-1&&r.addEventListener("modechange",this.triggerSelectedlanguagechange_)},e.removeTrack=function(r){n.prototype.removeTrack.call(this,r),r.removeEventListener&&(this.queueChange_&&r.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&r.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(cu),Iz=function(){function n(e){e===void 0&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var i=0,r=e.length;i<r;i++)this.addTrackElement_(e[i])}var t=n.prototype;return t.addTrackElement_=function(i){var r=this.trackElements_.length;""+r in this||Object.defineProperty(this,r,{get:function(){return this.trackElements_[r]}}),this.trackElements_.indexOf(i)===-1&&this.trackElements_.push(i)},t.getTrackElementByTrack_=function(i){for(var r,o=0,s=this.trackElements_.length;o<s;o++)if(i===this.trackElements_[o].track){r=this.trackElements_[o];break}return r},t.removeTrackElement_=function(i){for(var r=0,o=this.trackElements_.length;r<o;r++)if(i===this.trackElements_[r]){this.trackElements_[r].track&&typeof this.trackElements_[r].track.off=="function"&&this.trackElements_[r].track.off(),typeof this.trackElements_[r].off=="function"&&this.trackElements_[r].off(),this.trackElements_.splice(r,1);break}},n}(),zS=function(){function n(e){n.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=n.prototype;return t.setCues_=function(i){var r=this.length||0,o=0,s=i.length;this.cues_=i,this.length_=i.length;var a=function(u){""+u in this||Object.defineProperty(this,""+u,{get:function(){return this.cues_[u]}})};if(r<s)for(o=r;o<s;o++)a.call(this,o)},t.getCueById=function(i){for(var r=null,o=0,s=this.length;o<s;o++){var a=this[o];if(a.id===i){r=a;break}}return r},n}(),Fz={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Oz={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Hz={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},NS={disabled:"disabled",hidden:"hidden",showing:"showing"},My=function(n){kt(t,n);function t(e){var i;e===void 0&&(e={}),i=n.call(this)||this;var r={id:e.id||"vjs_track_"+vs(),kind:e.kind||"",language:e.language||""},o=e.label||"",s=function(u){Object.defineProperty(he(i),u,{get:function(){return r[u]},set:function(){}})};for(var a in r)s(a);return Object.defineProperty(he(i),"label",{get:function(){return o},set:function(u){u!==o&&(o=u,this.trigger("labelchange"))}}),i}return t}(Yi),By=function(t){var e=["protocol","hostname","port","pathname","search","hash","host"],i=Rt.createElement("a");i.href=t;for(var r={},o=0;o<e.length;o++)r[e[o]]=i[e[o]];return r.protocol==="http:"&&(r.host=r.host.replace(/:80$/,"")),r.protocol==="https:"&&(r.host=r.host.replace(/:443$/,"")),r.protocol||(r.protocol=K.location.protocol),r.host||(r.host=K.location.host),r},QB=function(t){if(!t.match(/^https?:\/\//)){var e=Rt.createElement("a");e.href=t,t=e.href}return t},Py=function(t){if(typeof t=="string"){var e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/,i=e.exec(t);if(i)return i.pop().toLowerCase()}return""},ym=function(t,e){e===void 0&&(e=K.location);var i=By(t),r=i.protocol===":"?e.protocol:i.protocol,o=r+i.host!==e.protocol+e.host;return o},zz=Object.freeze({__proto__:null,parseUrl:By,getAbsoluteURL:QB,getFileExtension:Py,isCrossOrigin:ym}),WS=function(t,e){var i=new K.WebVTT.Parser(K,K.vttjs,K.WebVTT.StringDecoder()),r=[];i.oncue=function(o){e.addCue(o)},i.onparsingerror=function(o){r.push(o)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(t),r.length>0&&(K.console&&K.console.groupCollapsed&&K.console.groupCollapsed("Text Track parsing errors for "+e.src),r.forEach(function(o){return _e.error(o)}),K.console&&K.console.groupEnd&&K.console.groupEnd()),i.flush()},US=function(t,e){var i={uri:t},r=ym(t);r&&(i.cors=r);var o=e.tech_.crossOrigin()==="use-credentials";o&&(i.withCredentials=o),iB(i,ni(this,function(s,a,l){if(s)return _e.error(s,a);e.loaded_=!0,typeof K.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],function(u){if(u.type==="vttjserror"){_e.error("vttjs failed to load, stopping trying to process "+e.src);return}return WS(l,e)}):WS(l,e)}))},Nd=function(n){kt(t,n);function t(i){var r;if(i===void 0&&(i={}),!i.tech)throw new Error("A tech was not provided.");var o=ii(i,{kind:Hz[i.kind]||"subtitles",language:i.language||i.srclang||""}),s=NS[o.mode]||"disabled",a=o.default;(o.kind==="metadata"||o.kind==="chapters")&&(s="hidden"),r=n.call(this,o)||this,r.tech_=o.tech,r.cues_=[],r.activeCues_=[],r.preload_=r.tech_.preloadTextTracks!==!1;var l=new zS(r.cues_),u=new zS(r.activeCues_),h=!1;r.timeupdateHandler=ni(he(r),function(c){if(c===void 0&&(c={}),!this.tech_.isDisposed()){if(!this.tech_.isReady_){c.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,h&&(this.trigger("cuechange"),h=!1),c.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});var d=function(){r.stopTracking()};return r.tech_.one("dispose",d),s!=="disabled"&&r.startTracking(),Object.defineProperties(he(r),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return s},set:function(f){NS[f]&&s!==f&&(s=f,!this.preload_&&s!=="disabled"&&this.cues.length===0&&US(this.src,this),this.stopTracking(),s!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?l:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(this.cues.length===0)return u;for(var f=this.tech_.currentTime(),g=[],m=0,p=this.cues.length;m<p;m++){var v=this.cues[m];(v.startTime<=f&&v.endTime>=f||v.startTime===v.endTime&&v.startTime<=f&&v.startTime+.5>=f)&&g.push(v)}if(h=!1,g.length!==this.activeCues_.length)h=!0;else for(var b=0;b<g.length;b++)this.activeCues_.indexOf(g[b])===-1&&(h=!0);return this.activeCues_=g,u.setCues_(this.activeCues_),u},set:function(){}}}),o.src?(r.src=o.src,r.preload_||(r.loaded_=!0),(r.preload_||o.kind!=="subtitles"&&o.kind!=="captions")&&US(r.src,he(r))):r.loaded_=!0,r}var e=t.prototype;return e.startTracking=function(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)},e.stopTracking=function(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)},e.addCue=function(r){var o=r;if(!("getCueAsHTML"in o)){o=new K.vttjs.VTTCue(r.startTime,r.endTime,r.text);for(var s in r)s in o||(o[s]=r[s]);o.id=r.id,o.originalCue_=r}for(var a=this.tech_.textTracks(),l=0;l<a.length;l++)a[l]!==this&&a[l].removeCue(o);this.cues_.push(o),this.cues.setCues_(this.cues_)},e.removeCue=function(r){for(var o=this.cues_.length;o--;){var s=this.cues_[o];if(s===r||s.originalCue_&&s.originalCue_===r){this.cues_.splice(o,1),this.cues.setCues_(this.cues_);break}}},t}(My);Nd.prototype.allowedEvents_={cuechange:"cuechange"};var JB=function(n){kt(t,n);function t(e){var i;e===void 0&&(e={});var r=ii(e,{kind:Oz[e.kind]||""});i=n.call(this,r)||this;var o=!1;return Object.defineProperty(he(i),"enabled",{get:function(){return o},set:function(a){typeof a!="boolean"||a===o||(o=a,this.trigger("enabledchange"))}}),r.enabled&&(i.enabled=r.enabled),i.loaded_=!0,i}return t}(My),tP=function(n){kt(t,n);function t(e){var i;e===void 0&&(e={});var r=ii(e,{kind:Fz[e.kind]||""});i=n.call(this,r)||this;var o=!1;return Object.defineProperty(he(i),"selected",{get:function(){return o},set:function(a){typeof a!="boolean"||a===o||(o=a,this.trigger("selectedchange"))}}),r.selected&&(i.selected=r.selected),i}return t}(My),eP=0,Nz=1,iP=2,Wz=3,ku=function(n){kt(t,n);function t(e){var i;e===void 0&&(e={}),i=n.call(this)||this;var r,o=new Nd(e);return i.kind=o.kind,i.src=o.src,i.srclang=o.language,i.label=o.label,i.default=o.default,Object.defineProperties(he(i),{readyState:{get:function(){return r}},track:{get:function(){return o}}}),r=eP,o.addEventListener("loadeddata",function(){r=iP,i.trigger({type:"load",target:he(i)})}),i}return t}(Yi);ku.prototype.allowedEvents_={load:"load"};ku.NONE=eP;ku.LOADING=Nz;ku.LOADED=iP;ku.ERROR=Wz;var kn={audio:{ListClass:Lz,TrackClass:JB,capitalName:"Audio"},video:{ListClass:Dz,TrackClass:tP,capitalName:"Video"},text:{ListClass:ZB,TrackClass:Nd,capitalName:"Text"}};Object.keys(kn).forEach(function(n){kn[n].getterName=n+"Tracks",kn[n].privateName=n+"Tracks_"});var fu={remoteText:{ListClass:ZB,TrackClass:Nd,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Iz,TrackClass:ku,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Br=Jn({},kn,fu);fu.names=Object.keys(fu);kn.names=Object.keys(kn);Br.names=[].concat(fu.names).concat(kn.names);function Uz(n,t,e,i,r){r===void 0&&(r={});var o=n.textTracks();r.kind=t,e&&(r.label=e),i&&(r.language=i),r.tech=n;var s=new Br.text.TrackClass(r);return o.addTrack(s),s}var qe=function(n){kt(t,n);function t(i,r){var o;return i===void 0&&(i={}),r===void 0&&(r=function(){}),i.reportTouchActivity=!1,o=n.call(this,null,i,r)||this,o.onDurationChange_=function(s){return o.onDurationChange(s)},o.trackProgress_=function(s){return o.trackProgress(s)},o.trackCurrentTime_=function(s){return o.trackCurrentTime(s)},o.stopTrackingCurrentTime_=function(s){return o.stopTrackingCurrentTime(s)},o.disposeSourceHandler_=function(s){return o.disposeSourceHandler(s)},o.queuedHanders_=new Set,o.hasStarted_=!1,o.on("playing",function(){this.hasStarted_=!0}),o.on("loadstart",function(){this.hasStarted_=!1}),Br.names.forEach(function(s){var a=Br[s];i&&i[a.getterName]&&(o[a.privateName]=i[a.getterName])}),o.featuresProgressEvents||o.manualProgressOn(),o.featuresTimeupdateEvents||o.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(s){i["native"+s+"Tracks"]===!1&&(o["featuresNative"+s+"Tracks"]=!1)}),i.nativeCaptions===!1||i.nativeTextTracks===!1?o.featuresNativeTextTracks=!1:(i.nativeCaptions===!0||i.nativeTextTracks===!0)&&(o.featuresNativeTextTracks=!0),o.featuresNativeTextTracks||o.emulateTextTracks(),o.preloadTextTracks=i.preloadTextTracks!==!1,o.autoRemoteTextTracks_=new Br.text.ListClass,o.initTrackListeners(),i.nativeControlsForTouch||o.emitTapEvents(),o.constructor&&(o.name_=o.constructor.name||"Unknown Tech"),o}var e=t.prototype;return e.triggerSourceset=function(r){var o=this;this.isReady_||this.one("ready",function(){return o.setTimeout(function(){return o.triggerSourceset(r)},1)}),this.trigger({src:r,type:"sourceset"})},e.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},e.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},e.trackProgress=function(r){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ni(this,function(){var o=this.bufferedPercent();this.bufferedPercent_!==o&&this.trigger("progress"),this.bufferedPercent_=o,o===1&&this.stopTrackingProgress()}),500)},e.onDurationChange=function(r){this.duration_=this.duration()},e.buffered=function(){return Na(0,0)},e.bufferedPercent=function(){return KB(this.buffered(),this.duration_)},e.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},e.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},e.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.dispose=function(){this.clearTracks(kn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),n.prototype.dispose.call(this)},e.clearTracks=function(r){var o=this;r=[].concat(r),r.forEach(function(s){for(var a=o[s+"Tracks"]()||[],l=a.length;l--;){var u=a[l];s==="text"&&o.removeRemoteTextTrack(u),a.removeTrack(u)}})},e.cleanupAutoTextTracks=function(){for(var r=this.autoRemoteTextTracks_||[],o=r.length;o--;){var s=r[o];this.removeRemoteTextTrack(s)}},e.reset=function(){},e.crossOrigin=function(){},e.setCrossOrigin=function(){},e.error=function(r){return r!==void 0&&(this.error_=new Lr(r),this.trigger("error")),this.error_},e.played=function(){return this.hasStarted_?Na(0,0):Na()},e.play=function(){},e.setScrubbing=function(){},e.scrubbing=function(){},e.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.initTrackListeners=function(){var r=this;kn.names.forEach(function(o){var s=kn[o],a=function(){r.trigger(o+"trackchange")},l=r[s.getterName]();l.addEventListener("removetrack",a),l.addEventListener("addtrack",a),r.on("dispose",function(){l.removeEventListener("removetrack",a),l.removeEventListener("addtrack",a)})})},e.addWebVttScript_=function(){var r=this;if(!K.WebVTT)if(Rt.body.contains(this.el())){if(!this.options_["vtt.js"]&&nd(lS)&&Object.keys(lS).length>0){this.trigger("vttjsloaded");return}var o=Rt.createElement("script");o.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",o.onload=function(){r.trigger("vttjsloaded")},o.onerror=function(){r.trigger("vttjserror")},this.on("dispose",function(){o.onload=null,o.onerror=null}),K.WebVTT=!0,this.el().parentNode.appendChild(o)}else this.ready(this.addWebVttScript_)},e.emulateTextTracks=function(){var r=this,o=this.textTracks(),s=this.remoteTextTracks(),a=function(c){return o.addTrack(c.track)},l=function(c){return o.removeTrack(c.track)};s.on("addtrack",a),s.on("removetrack",l),this.addWebVttScript_();var u=function(){return r.trigger("texttrackchange")},h=function(){u();for(var c=0;c<o.length;c++){var f=o[c];f.removeEventListener("cuechange",u),f.mode==="showing"&&f.addEventListener("cuechange",u)}};h(),o.addEventListener("change",h),o.addEventListener("addtrack",h),o.addEventListener("removetrack",h),this.on("dispose",function(){s.off("addtrack",a),s.off("removetrack",l),o.removeEventListener("change",h),o.removeEventListener("addtrack",h),o.removeEventListener("removetrack",h);for(var d=0;d<o.length;d++){var c=o[d];c.removeEventListener("cuechange",u)}})},e.addTextTrack=function(r,o,s){if(!r)throw new Error("TextTrack kind is required but was not provided");return Uz(this,r,o,s)},e.createRemoteTextTrack=function(r){var o=ii(r,{tech:this});return new fu.remoteTextEl.TrackClass(o)},e.addRemoteTextTrack=function(r,o){var s=this;r===void 0&&(r={});var a=this.createRemoteTextTrack(r);return o!==!0&&o!==!1&&(_e.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),o=!0),this.remoteTextTrackEls().addTrackElement_(a),this.remoteTextTracks().addTrack(a.track),o!==!0&&this.ready(function(){return s.autoRemoteTextTracks_.addTrack(a.track)}),a},e.removeRemoteTextTrack=function(r){var o=this.remoteTextTrackEls().getTrackElementByTrack_(r);this.remoteTextTrackEls().removeTrackElement_(o),this.remoteTextTracks().removeTrack(r),this.autoRemoteTextTracks_.removeTrack(r)},e.getVideoPlaybackQuality=function(){return{}},e.requestPictureInPicture=function(){var r=this.options_.Promise||K.Promise;if(r)return r.reject()},e.disablePictureInPicture=function(){return!0},e.setDisablePictureInPicture=function(){},e.requestVideoFrameCallback=function(r){var o=this,s=vs();return!this.isReady_||this.paused()?(this.queuedHanders_.add(s),this.one("playing",function(){o.queuedHanders_.has(s)&&(o.queuedHanders_.delete(s),r())})):this.requestNamedAnimationFrame(s,r),s},e.cancelVideoFrameCallback=function(r){this.queuedHanders_.has(r)?this.queuedHanders_.delete(r):this.cancelNamedAnimationFrame(r)},e.setPoster=function(){},e.playsinline=function(){},e.setPlaysinline=function(){},e.overrideNativeAudioTracks=function(){},e.overrideNativeVideoTracks=function(){},e.canPlayType=function(){return""},t.canPlayType=function(){return""},t.canPlaySource=function(r,o){return t.canPlayType(r.type)},t.isTech=function(r){return r.prototype instanceof t||r instanceof t||r===t},t.registerTech=function(r,o){if(t.techs_||(t.techs_={}),!t.isTech(o))throw new Error("Tech "+r+" must be a Tech");if(!t.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!t.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return r=Bi(r),t.techs_[r]=o,t.techs_[Sf(r)]=o,r!=="Tech"&&t.defaultTechOrder_.push(r),o},t.getTech=function(r){if(r){if(t.techs_&&t.techs_[r])return t.techs_[r];if(r=Bi(r),K&&K.videojs&&K.videojs[r])return _e.warn("The "+r+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),K.videojs[r]}},t}(Ct);Br.names.forEach(function(n){var t=Br[n];qe.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}});qe.prototype.featuresVolumeControl=!0;qe.prototype.featuresMuteControl=!0;qe.prototype.featuresFullscreenResize=!1;qe.prototype.featuresPlaybackRate=!1;qe.prototype.featuresProgressEvents=!1;qe.prototype.featuresSourceset=!1;qe.prototype.featuresTimeupdateEvents=!1;qe.prototype.featuresNativeTextTracks=!1;qe.prototype.featuresVideoFrameCallback=!1;qe.withSourceHandlers=function(n){n.registerSourceHandler=function(e,i){var r=n.sourceHandlers;r||(r=n.sourceHandlers=[]),i===void 0&&(i=r.length),r.splice(i,0,e)},n.canPlayType=function(e){for(var i=n.sourceHandlers||[],r,o=0;o<i.length;o++)if(r=i[o].canPlayType(e),r)return r;return""},n.selectSourceHandler=function(e,i){for(var r=n.sourceHandlers||[],o,s=0;s<r.length;s++)if(o=r[s].canHandleSource(e,i),o)return r[s];return null},n.canPlaySource=function(e,i){var r=n.selectSourceHandler(e,i);return r?r.canHandleSource(e,i):""};var t=["seekable","seeking","duration"];t.forEach(function(e){var i=this[e];typeof i=="function"&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},n.prototype),n.prototype.setSource=function(e){var i=n.selectSourceHandler(e,this.options_);i||(n.nativeSourceHandler?i=n.nativeSourceHandler:_e.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==n.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=i.handleSource(e,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};Ct.registerComponent("Tech",qe);qe.registerTech("Tech",qe);qe.defaultTechOrder_=[];var Wa={},o_={},Gf={};function Vz(n,t){Wa[n]=Wa[n]||[],Wa[n].push(t)}function jz(n,t,e){n.setTimeout(function(){return ga(t,Wa[t.type],e,n)},1)}function Gz(n,t){n.forEach(function(e){return e.setTech&&e.setTech(t)})}function $z(n,t,e){return n.reduceRight(ky(e),t[e]())}function qz(n,t,e,i){return t[e](n.reduce(ky(e),i))}function VS(n,t,e,i){i===void 0&&(i=null);var r="call"+Bi(e),o=n.reduce(ky(r),i),s=o===Gf,a=s?null:t[e](o);return Kz(n,e,a,s),a}var Xz={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Yz={setCurrentTime:1,setMuted:1,setVolume:1},jS={play:1,pause:1};function ky(n){return function(t,e){return t===Gf?Gf:e[n]?e[n](t):t}}function Kz(n,t,e,i){for(var r=n.length-1;r>=0;r--){var o=n[r];o[t]&&o[t](i,e)}}function Zz(n){o_[n.id()]=null}function Qz(n,t){var e=o_[n.id()],i=null;if(e==null)return i=t(n),o_[n.id()]=[[t,i]],i;for(var r=0;r<e.length;r++){var o=e[r],s=o[0],a=o[1];s===t&&(i=a)}return i===null&&(i=t(n),e.push([t,i])),i}function ga(n,t,e,i,r,o){n===void 0&&(n={}),t===void 0&&(t=[]),r===void 0&&(r=[]),o===void 0&&(o=!1);var s=t,a=s[0],l=s.slice(1);if(typeof a=="string")ga(n,Wa[a],e,i,r,o);else if(a){var u=Qz(i,a);if(!u.setSource)return r.push(u),ga(n,l,e,i,r,o);u.setSource(pi({},n),function(h,d){if(h)return ga(n,l,e,i,r,o);r.push(u),ga(d,n.type===d.type?l:Wa[d.type],e,i,r,o)})}else l.length?ga(n,l,e,i,r,o):o?e(n,r):ga(n,Wa["*"],e,i,r,!0)}var Jz={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},$f=function(t){t===void 0&&(t="");var e=Py(t),i=Jz[e.toLowerCase()];return i||""},tN=function(t,e){if(!e)return"";if(t.cache_.source.src===e&&t.cache_.source.type)return t.cache_.source.type;var i=t.cache_.sources.filter(function(a){return a.src===e});if(i.length)return i[0].type;for(var r=t.$$("source"),o=0;o<r.length;o++){var s=r[o];if(s.type&&s.src&&s.src===e)return s.type}return $f(e)},eN=function n(t){if(Array.isArray(t)){var e=[];t.forEach(function(i){i=n(i),Array.isArray(i)?e=e.concat(i):hs(i)&&e.push(i)}),t=e}else typeof t=="string"&&t.trim()?t=[GS({src:t})]:hs(t)&&typeof t.src=="string"&&t.src&&t.src.trim()?t=[GS(t)]:t=[];return t};function GS(n){if(!n.type){var t=$f(n.src);t&&(n.type=t)}return n}var iN=function(n){kt(t,n);function t(e,i,r){var o,s=ii({createEl:!1},i);if(o=n.call(this,e,s,r)||this,!i.playerOptions.sources||i.playerOptions.sources.length===0)for(var a=0,l=i.playerOptions.techOrder;a<l.length;a++){var u=Bi(l[a]),h=qe.getTech(u);if(u||(h=Ct.getComponent(u)),h&&h.isSupported()){e.loadTech_(u);break}}else e.src(i.playerOptions.sources);return o}return t}(Ct);Ct.registerComponent("MediaLoader",iN);var wm=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.options_.controlText&&o.controlText(o.options_.controlText),o.handleMouseOver_=function(s){return o.handleMouseOver(s)},o.handleMouseOut_=function(s){return o.handleMouseOut(s)},o.handleClick_=function(s){return o.handleClick(s)},o.handleKeyDown_=function(s){return o.handleKeyDown(s)},o.emitTapEvents(),o.enable(),o}var e=t.prototype;return e.createEl=function(r,o,s){r===void 0&&(r="div"),o===void 0&&(o={}),s===void 0&&(s={}),o=pi({className:this.buildCSSClass(),tabIndex:0},o),r==="button"&&_e.error("Creating a ClickableComponent with an HTML element of "+r+" is not supported; use a Button instead."),s=pi({role:"button"},s),this.tabIndex_=o.tabIndex;var a=Le(r,o,s);return a.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(a),a},e.dispose=function(){this.controlTextEl_=null,n.prototype.dispose.call(this)},e.createControlTextEl=function(r){return this.controlTextEl_=Le("span",{className:"vjs-control-text"},{"aria-live":"polite"}),r&&r.appendChild(this.controlTextEl_),this.controlText(this.controlText_,r),this.controlTextEl_},e.controlText=function(r,o){if(o===void 0&&(o=this.el()),r===void 0)return this.controlText_||"Need Text";var s=this.localize(r);this.controlText_=r,nl(this.controlTextEl_,s),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&o.setAttribute("title",s)},e.buildCSSClass=function(){return"vjs-control vjs-button "+n.prototype.buildCSSClass.call(this)},e.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},e.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},e.handleLanguagechange=function(){this.controlText(this.controlText_)},e.handleClick=function(r){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},e.handleKeyDown=function(r){fe.isEventKey(r,"Space")||fe.isEventKey(r,"Enter")?(r.preventDefault(),r.stopPropagation(),this.trigger("click")):n.prototype.handleKeyDown.call(this,r)},t}(Ct);Ct.registerComponent("ClickableComponent",wm);var rN=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.update(),o.update_=function(s){return o.update(s)},i.on("posterchange",o.update_),o}var e=t.prototype;return e.dispose=function(){this.player().off("posterchange",this.update_),n.prototype.dispose.call(this)},e.createEl=function(){var r=Le("div",{className:"vjs-poster",tabIndex:-1});return r},e.update=function(r){var o=this.player().poster();this.setSrc(o),o?this.show():this.hide()},e.setSrc=function(r){var o="";r&&(o='url("'+r+'")'),this.el_.style.backgroundImage=o},e.handleClick=function(r){if(this.player_.controls()){var o=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;this.player_.tech(!0)&&!((Hd||Od)&&o)&&this.player_.tech(!0).focus(),this.player_.paused()?xo(this.player_.play()):this.player_.pause()}},t}(wm);Ct.registerComponent("PosterImage",rN);var vn="#222",$S="#ccc",nN={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function V0(n,t){var e;if(n.length===4)e=n[1]+n[1]+n[2]+n[2]+n[3]+n[3];else if(n.length===7)e=n.slice(1);else throw new Error("Invalid color code provided, "+n+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(e.slice(0,2),16)+","+parseInt(e.slice(2,4),16)+","+parseInt(e.slice(4,6),16)+","+t+")"}function j0(n,t,e){try{n.style[t]=e}catch{return}}var oN=function(n){kt(t,n);function t(i,r,o){var s;s=n.call(this,i,r,o)||this;var a=function(u){return s.updateDisplay(u)};return i.on("loadstart",function(l){return s.toggleDisplay(l)}),i.on("texttrackchange",a),i.on("loadedmetadata",function(l){return s.preselectTrack(l)}),i.ready(ni(he(s),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks){this.hide();return}i.on("fullscreenchange",a),i.on("playerresize",a),K.addEventListener("orientationchange",a),i.on("dispose",function(){return K.removeEventListener("orientationchange",a)});for(var l=this.options_.playerOptions.tracks||[],u=0;u<l.length;u++)this.player_.addRemoteTextTrack(l[u],!0);this.preselectTrack()})),s}var e=t.prototype;return e.preselectTrack=function(){for(var r={captions:1,subtitles:1},o=this.player_.textTracks(),s=this.player_.cache_.selectedLanguage,a,l,u,h=0;h<o.length;h++){var d=o[h];s&&s.enabled&&s.language&&s.language===d.language&&d.kind in r?d.kind===s.kind?u=d:u||(u=d):s&&!s.enabled?(u=null,a=null,l=null):d.default&&(d.kind==="descriptions"&&!a?a=d:d.kind in r&&!l&&(l=d))}u?u.mode="showing":l?l.mode="showing":a&&(a.mode="showing")},e.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})},e.clearDisplay=function(){typeof K.WebVTT=="function"&&K.WebVTT.processCues(K,[],this.el_)},e.updateDisplay=function(){var r=this.player_.textTracks(),o=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),o){for(var s=[],a=0;a<r.length;++a){var l=r[a];l.mode==="showing"&&s.push(l)}this.updateForTrack(s);return}for(var u=null,h=null,d=r.length;d--;){var c=r[d];c.mode==="showing"&&(c.kind==="descriptions"?u=c:h=c)}h?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(h)):u&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(u))},e.updateDisplayState=function(r){for(var o=this.player_.textTrackSettings.getValues(),s=r.activeCues,a=s.length;a--;){var l=s[a];if(l){var u=l.displayState;if(o.color&&(u.firstChild.style.color=o.color),o.textOpacity&&j0(u.firstChild,"color",V0(o.color||"#fff",o.textOpacity)),o.backgroundColor&&(u.firstChild.style.backgroundColor=o.backgroundColor),o.backgroundOpacity&&j0(u.firstChild,"backgroundColor",V0(o.backgroundColor||"#000",o.backgroundOpacity)),o.windowColor&&(o.windowOpacity?j0(u,"backgroundColor",V0(o.windowColor,o.windowOpacity)):u.style.backgroundColor=o.windowColor),o.edgeStyle&&(o.edgeStyle==="dropshadow"?u.firstChild.style.textShadow="2px 2px 3px "+vn+", 2px 2px 4px "+vn+", 2px 2px 5px "+vn:o.edgeStyle==="raised"?u.firstChild.style.textShadow="1px 1px "+vn+", 2px 2px "+vn+", 3px 3px "+vn:o.edgeStyle==="depressed"?u.firstChild.style.textShadow="1px 1px "+$S+", 0 1px "+$S+", -1px -1px "+vn+", 0 -1px "+vn:o.edgeStyle==="uniform"&&(u.firstChild.style.textShadow="0 0 4px "+vn+", 0 0 4px "+vn+", 0 0 4px "+vn+", 0 0 4px "+vn)),o.fontPercent&&o.fontPercent!==1){var h=K.parseFloat(u.style.fontSize);u.style.fontSize=h*o.fontPercent+"px",u.style.height="auto",u.style.top="auto"}o.fontFamily&&o.fontFamily!=="default"&&(o.fontFamily==="small-caps"?u.firstChild.style.fontVariant="small-caps":u.firstChild.style.fontFamily=nN[o.fontFamily])}}},e.updateForTrack=function(r){if(Array.isArray(r)||(r=[r]),!(typeof K.WebVTT!="function"||r.every(function(f){return!f.activeCues}))){for(var o=[],s=0;s<r.length;++s)for(var a=r[s],l=0;l<a.activeCues.length;++l)o.push(a.activeCues[l]);K.WebVTT.processCues(K,o,this.el_);for(var u=0;u<r.length;++u){for(var h=r[u],d=0;d<h.activeCues.length;++d){var c=h.activeCues[d].displayState;ns(c,"vjs-text-track-cue"),ns(c,"vjs-text-track-cue-"+(h.language?h.language:u)),h.language&&hu(c,"lang",h.language)}this.player_.textTrackSettings&&this.updateDisplayState(h)}}},t}(Ct);Ct.registerComponent("TextTrackDisplay",oN);var sN=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.createEl=function(){var r=this.player_.isAudio(),o=this.localize(r?"Audio Player":"Video Player"),s=Le("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[o])}),a=n.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return a.appendChild(s),a},t}(Ct);Ct.registerComponent("LoadingSpinner",sN);var Kn=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.createEl=function(r,o,s){o===void 0&&(o={}),s===void 0&&(s={}),r="button",o=pi({className:this.buildCSSClass()},o),s=pi({type:"button"},s);var a=Le(r,o,s);return a.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(a),a},e.addChild=function(r,o){o===void 0&&(o={});var s=this.constructor.name;return _e.warn("Adding an actionable (user controllable) child to a Button ("+s+") is not supported; use a ClickableComponent instead."),Ct.prototype.addChild.call(this,r,o)},e.enable=function(){n.prototype.enable.call(this),this.el_.removeAttribute("disabled")},e.disable=function(){n.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},e.handleKeyDown=function(r){if(fe.isEventKey(r,"Space")||fe.isEventKey(r,"Enter")){r.stopPropagation();return}n.prototype.handleKeyDown.call(this,r)},t}(wm);Ct.registerComponent("Button",Kn);var rP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.mouseused_=!1,o.on("mousedown",function(s){return o.handleMouseDown(s)}),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-big-play-button"},e.handleClick=function(r){var o=this.player_.play();if(this.mouseused_&&r.clientX&&r.clientY){var s=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;xo(o),this.player_.tech(!0)&&!((Hd||Od)&&s)&&this.player_.tech(!0).focus();return}var a=this.player_.getChild("controlBar"),l=a&&a.getChild("playToggle");if(!l){this.player_.tech(!0).focus();return}var u=function(){return l.focus()};Ih(o)?o.then(u,function(){}):this.setTimeout(u,1)},e.handleKeyDown=function(r){this.mouseused_=!1,n.prototype.handleKeyDown.call(this,r)},e.handleMouseDown=function(r){this.mouseused_=!0},t}(Kn);rP.prototype.controlText_="Play Video";Ct.registerComponent("BigPlayButton",rP);var aN=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.controlText(r&&r.controlText||o.localize("Close")),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-close-button "+n.prototype.buildCSSClass.call(this)},e.handleClick=function(r){this.trigger({type:"close",bubbles:!1})},e.handleKeyDown=function(r){fe.isEventKey(r,"Esc")?(r.preventDefault(),r.stopPropagation(),this.trigger("click")):n.prototype.handleKeyDown.call(this,r)},t}(Kn);Ct.registerComponent("CloseButton",aN);var nP=function(n){kt(t,n);function t(i,r){var o;return r===void 0&&(r={}),o=n.call(this,i,r)||this,r.replay=r.replay===void 0||r.replay,o.on(i,"play",function(s){return o.handlePlay(s)}),o.on(i,"pause",function(s){return o.handlePause(s)}),r.replay&&o.on(i,"ended",function(s){return o.handleEnded(s)}),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-play-control "+n.prototype.buildCSSClass.call(this)},e.handleClick=function(r){this.player_.paused()?xo(this.player_.play()):this.player_.pause()},e.handleSeeked=function(r){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(r):this.handlePlay(r)},e.handlePlay=function(r){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},e.handlePause=function(r){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},e.handleEnded=function(r){var o=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(s){return o.handleSeeked(s)})},t}(Kn);nP.prototype.controlText_="Play";Ct.registerComponent("PlayToggle",nP);var oP=function(t,e){t=t<0?0:t;var i=Math.floor(t%60),r=Math.floor(t/60%60),o=Math.floor(t/3600),s=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(o=r=i="-"),o=o>0||a>0?o+":":"",r=((o||s>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,o+r+i},Ly=oP;function lN(n){Ly=n}function uN(){Ly=oP}function gu(n,t){return t===void 0&&(t=n),Ly(n,t)}var Lu=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.on(i,["timeupdate","ended"],function(s){return o.updateContent(s)}),o.updateTextNode_(),o}var e=t.prototype;return e.createEl=function(){var r=this.buildCSSClass(),o=n.prototype.createEl.call(this,"div",{className:r+" vjs-time-control vjs-control"}),s=Le("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+" "},{role:"presentation"});return o.appendChild(s),this.contentEl_=Le("span",{className:r+"-display"},{"aria-live":"off",role:"presentation"}),o.appendChild(this.contentEl_),o},e.dispose=function(){this.contentEl_=null,this.textNode_=null,n.prototype.dispose.call(this)},e.updateTextNode_=function(r){var o=this;r===void 0&&(r=0),r=gu(r),this.formattedTime_!==r&&(this.formattedTime_=r,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(o.contentEl_){var s=o.textNode_;s&&o.contentEl_.firstChild!==s&&(s=null,_e.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),o.textNode_=Rt.createTextNode(o.formattedTime_),o.textNode_&&(s?o.contentEl_.replaceChild(o.textNode_,s):o.contentEl_.appendChild(o.textNode_))}}))},e.updateContent=function(r){},t}(Ct);Lu.prototype.labelText_="Time";Lu.prototype.controlText_="Time";Ct.registerComponent("TimeDisplay",Lu);var Dy=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-current-time"},e.updateContent=function(r){var o;this.player_.ended()?o=this.player_.duration():o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(o)},t}(Lu);Dy.prototype.labelText_="Current Time";Dy.prototype.controlText_="Current Time";Ct.registerComponent("CurrentTimeDisplay",Dy);var Iy=function(n){kt(t,n);function t(i,r){var o;o=n.call(this,i,r)||this;var s=function(l){return o.updateContent(l)};return o.on(i,"durationchange",s),o.on(i,"loadstart",s),o.on(i,"loadedmetadata",s),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-duration"},e.updateContent=function(r){var o=this.player_.duration();this.updateTextNode_(o)},t}(Lu);Iy.prototype.labelText_="Duration";Iy.prototype.controlText_="Duration";Ct.registerComponent("DurationDisplay",Iy);var hN=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.createEl=function(){var r=n.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),o=n.prototype.createEl.call(this,"div"),s=n.prototype.createEl.call(this,"span",{textContent:"/"});return o.appendChild(s),r.appendChild(o),r},t}(Ct);Ct.registerComponent("TimeDivider",hN);var Fy=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.on(i,"durationchange",function(s){return o.updateContent(s)}),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-remaining-time"},e.createEl=function(){var r=n.prototype.createEl.call(this);return this.options_.displayNegative!==!1&&r.insertBefore(Le("span",{},{"aria-hidden":!0},"-"),this.contentEl_),r},e.updateContent=function(r){if(typeof this.player_.duration()=="number"){var o;this.player_.ended()?o=0:this.player_.remainingTimeDisplay?o=this.player_.remainingTimeDisplay():o=this.player_.remainingTime(),this.updateTextNode_(o)}},t}(Lu);Fy.prototype.labelText_="Remaining Time";Fy.prototype.controlText_="Remaining Time";Ct.registerComponent("RemainingTimeDisplay",Fy);var dN=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.updateShowing(),o.on(o.player(),"durationchange",function(s){return o.updateShowing(s)}),o}var e=t.prototype;return e.createEl=function(){var r=n.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Le("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Le("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+" "})),this.contentEl_.appendChild(Rt.createTextNode(this.localize("LIVE"))),r.appendChild(this.contentEl_),r},e.dispose=function(){this.contentEl_=null,n.prototype.dispose.call(this)},e.updateShowing=function(r){this.player().duration()===1/0?this.show():this.hide()},t}(Ct);Ct.registerComponent("LiveDisplay",dN);var sP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.updateLiveEdgeStatus(),o.player_.liveTracker&&(o.updateLiveEdgeStatusHandler_=function(s){return o.updateLiveEdgeStatus(s)},o.on(o.player_.liveTracker,"liveedgechange",o.updateLiveEdgeStatusHandler_)),o}var e=t.prototype;return e.createEl=function(){var r=n.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=Le("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),r.appendChild(this.textEl_),r},e.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},e.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},e.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,n.prototype.dispose.call(this)},t}(Kn);sP.prototype.controlText_="Seek to live, currently playing live";Ct.registerComponent("SeekToLive",sP);var Sm=function(t,e,i){return t=Number(t),Math.min(i,Math.max(e,isNaN(t)?e:t))},Oy=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.handleMouseDown_=function(s){return o.handleMouseDown(s)},o.handleMouseUp_=function(s){return o.handleMouseUp(s)},o.handleKeyDown_=function(s){return o.handleKeyDown(s)},o.handleClick_=function(s){return o.handleClick(s)},o.handleMouseMove_=function(s){return o.handleMouseMove(s)},o.update_=function(s){return o.update(s)},o.bar=o.getChild(o.options_.barName),o.vertical(!!o.options_.vertical),o.enable(),o}var e=t.prototype;return e.enabled=function(){return this.enabled_},e.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},e.disable=function(){if(this.enabled()){var r=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(r,"mousemove",this.handleMouseMove_),this.off(r,"mouseup",this.handleMouseUp_),this.off(r,"touchmove",this.handleMouseMove_),this.off(r,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},e.createEl=function(r,o,s){return o===void 0&&(o={}),s===void 0&&(s={}),o.className=o.className+" vjs-slider",o=pi({tabIndex:0},o),s=pi({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},s),n.prototype.createEl.call(this,r,o,s)},e.handleMouseDown=function(r){var o=this.bar.el_.ownerDocument;r.type==="mousedown"&&r.preventDefault(),r.type==="touchstart"&&!ms&&r.preventDefault(),IB(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(o,"mousemove",this.handleMouseMove_),this.on(o,"mouseup",this.handleMouseUp_),this.on(o,"touchmove",this.handleMouseMove_),this.on(o,"touchend",this.handleMouseUp_),this.handleMouseMove(r,!0)},e.handleMouseMove=function(r){},e.handleMouseUp=function(){var r=this.bar.el_.ownerDocument;FB(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(r,"mousemove",this.handleMouseMove_),this.off(r,"mouseup",this.handleMouseUp_),this.off(r,"touchmove",this.handleMouseMove_),this.off(r,"touchend",this.handleMouseUp_),this.update()},e.update=function(){var r=this;if(!(!this.el_||!this.bar)){var o=this.getProgress();return o===this.progress_||(this.progress_=o,this.requestNamedAnimationFrame("Slider#update",function(){var s=r.vertical()?"height":"width";r.bar.el().style[s]=(o*100).toFixed(2)+"%"})),o}},e.getProgress=function(){return Number(Sm(this.getPercent(),0,1).toFixed(4))},e.calculateDistance=function(r){var o=vm(this.el_,r);return this.vertical()?o.y:o.x},e.handleKeyDown=function(r){fe.isEventKey(r,"Left")||fe.isEventKey(r,"Down")?(r.preventDefault(),r.stopPropagation(),this.stepBack()):fe.isEventKey(r,"Right")||fe.isEventKey(r,"Up")?(r.preventDefault(),r.stopPropagation(),this.stepForward()):n.prototype.handleKeyDown.call(this,r)},e.handleClick=function(r){r.stopPropagation(),r.preventDefault()},e.vertical=function(r){if(r===void 0)return this.vertical_||!1;this.vertical_=!!r,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(Ct);Ct.registerComponent("Slider",Oy);var G0=function(t,e){return Sm(t/e*100,0,100).toFixed(2)+"%"},cN=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.partEls_=[],o.on(i,"progress",function(s){return o.update(s)}),o}var e=t.prototype;return e.createEl=function(){var r=n.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),o=Le("span",{className:"vjs-control-text"}),s=Le("span",{textContent:this.localize("Loaded")}),a=Rt.createTextNode(": ");return this.percentageEl_=Le("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),r.appendChild(o),o.appendChild(s),o.appendChild(a),o.appendChild(this.percentageEl_),r},e.dispose=function(){this.partEls_=null,this.percentageEl_=null,n.prototype.dispose.call(this)},e.update=function(r){var o=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var s=o.player_.liveTracker,a=o.player_.buffered(),l=s&&s.isLive()?s.seekableEnd():o.player_.duration(),u=o.player_.bufferedEnd(),h=o.partEls_,d=G0(u,l);o.percent_!==d&&(o.el_.style.width=d,nl(o.percentageEl_,d),o.percent_=d);for(var c=0;c<a.length;c++){var f=a.start(c),g=a.end(c),m=h[c];m||(m=o.el_.appendChild(Le()),h[c]=m),!(m.dataset.start===f&&m.dataset.end===g)&&(m.dataset.start=f,m.dataset.end=g,m.style.left=G0(f,u),m.style.width=G0(g-f,u))}for(var p=h.length;p>a.length;p--)o.el_.removeChild(h[p-1]);h.length=a.length})},t}(Ct);Ct.registerComponent("LoadProgressBar",cN);var fN=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.update=ds(ni(he(o),o.update),to),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},e.update=function(r,o,s){var a=sd(this.el_),l=du(this.player_.el()),u=r.width*o;if(!(!l||!a)){var h=r.left-l.left+u,d=r.width-u+(l.right-r.right),c=a.width/2;h<c?c+=c-h:d<c&&(c=d),c<0?c=0:c>a.width&&(c=a.width),c=Math.round(c),this.el_.style.right="-"+c+"px",this.write(s)}},e.write=function(r){nl(this.el_,r)},e.updateTime=function(r,o,s,a){var l=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var u,h=l.player_.duration();if(l.player_.liveTracker&&l.player_.liveTracker.isLive()){var d=l.player_.liveTracker.liveWindow(),c=d-o*d;u=(c<1?"":"-")+gu(c,d)}else u=gu(s,h);l.update(r,o,u),a&&a()})},t}(Ct);Ct.registerComponent("TimeTooltip",fN);var Hy=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.update=ds(ni(he(o),o.update),to),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},e.update=function(r,o){var s=this.getChild("timeTooltip");if(s){var a=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();s.updateTime(r,o,a)}},t}(Ct);Hy.prototype.options_={children:[]};!Hr&&!ps&&Hy.prototype.options_.children.push("timeTooltip");Ct.registerComponent("PlayProgressBar",Hy);var aP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.update=ds(ni(he(o),o.update),to),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},e.update=function(r,o){var s=this,a=o*this.player_.duration();this.getChild("timeTooltip").updateTime(r,o,a,function(){s.el_.style.left=r.width*o+"px"})},t}(Ct);aP.prototype.options_={children:["timeTooltip"]};Ct.registerComponent("MouseTimeDisplay",aP);var Pc=5,qS=12,zy=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.setEventHandlers_(),o}var e=t.prototype;return e.setEventHandlers_=function(){var r=this;this.update_=ni(this,this.update),this.update=ds(this.update_,to),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(o){return r.enableInterval_(o)},this.disableIntervalHandler_=function(o){return r.disableInterval_(o)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Rt&&"visibilityState"in Rt&&this.on(Rt,"visibilitychange",this.toggleVisibility_)},e.toggleVisibility_=function(r){Rt.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(r)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())},e.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,to))},e.disableInterval_=function(r){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&r&&r.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},e.update=function(r){var o=this;if(Rt.visibilityState!=="hidden"){var s=n.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var a=o.player_.ended()?o.player_.duration():o.getCurrentTime_(),l=o.player_.liveTracker,u=o.player_.duration();l&&l.isLive()&&(u=o.player_.liveTracker.liveCurrentTime()),o.percent_!==s&&(o.el_.setAttribute("aria-valuenow",(s*100).toFixed(2)),o.percent_=s),(o.currentTime_!==a||o.duration_!==u)&&(o.el_.setAttribute("aria-valuetext",o.localize("progress bar timing: currentTime={1} duration={2}",[gu(a,u),gu(u,u)],"{1} of {2}")),o.currentTime_=a,o.duration_=u),o.bar&&o.bar.update(du(o.el()),o.getProgress())}),s}},e.userSeek_=function(r){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(r)},e.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},e.getPercent=function(){var r=this.getCurrentTime_(),o,s=this.player_.liveTracker;return s&&s.isLive()?(o=(r-s.seekableStart())/s.liveWindow(),s.atLiveEdge()&&(o=1)):o=r/this.player_.duration(),o},e.handleMouseDown=function(r){ad(r)&&(r.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),n.prototype.handleMouseDown.call(this,r))},e.handleMouseMove=function(r,o){if(o===void 0&&(o=!1),!!ad(r)){!o&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);var s,a=this.calculateDistance(r),l=this.player_.liveTracker;if(!l||!l.isLive())s=a*this.player_.duration(),s===this.player_.duration()&&(s=s-.1);else{if(a>=.99){l.seekToLiveEdge();return}var u=l.seekableStart(),h=l.liveCurrentTime();if(s=u+a*l.liveWindow(),s>=h&&(s=h),s<=u&&(s=u+.1),s===1/0)return}this.userSeek_(s)}},e.enable=function(){n.prototype.enable.call(this);var r=this.getChild("mouseTimeDisplay");r&&r.show()},e.disable=function(){n.prototype.disable.call(this);var r=this.getChild("mouseTimeDisplay");r&&r.hide()},e.handleMouseUp=function(r){n.prototype.handleMouseUp.call(this,r),r&&r.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?xo(this.player_.play()):this.update_()},e.stepForward=function(){this.userSeek_(this.player_.currentTime()+Pc)},e.stepBack=function(){this.userSeek_(this.player_.currentTime()-Pc)},e.handleAction=function(r){this.player_.paused()?this.player_.play():this.player_.pause()},e.handleKeyDown=function(r){var o=this.player_.liveTracker;if(fe.isEventKey(r,"Space")||fe.isEventKey(r,"Enter"))r.preventDefault(),r.stopPropagation(),this.handleAction(r);else if(fe.isEventKey(r,"Home"))r.preventDefault(),r.stopPropagation(),this.userSeek_(0);else if(fe.isEventKey(r,"End"))r.preventDefault(),r.stopPropagation(),o&&o.isLive()?this.userSeek_(o.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(fe(r))){r.preventDefault(),r.stopPropagation();var s=(fe.codes[fe(r)]-fe.codes[0])*10/100;o&&o.isLive()?this.userSeek_(o.seekableStart()+o.liveWindow()*s):this.userSeek_(this.player_.duration()*s)}else fe.isEventKey(r,"PgDn")?(r.preventDefault(),r.stopPropagation(),this.userSeek_(this.player_.currentTime()-Pc*qS)):fe.isEventKey(r,"PgUp")?(r.preventDefault(),r.stopPropagation(),this.userSeek_(this.player_.currentTime()+Pc*qS)):n.prototype.handleKeyDown.call(this,r)},e.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Rt&&"visibilityState"in Rt&&this.off(Rt,"visibilitychange",this.toggleVisibility_),n.prototype.dispose.call(this)},t}(Oy);zy.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};!Hr&&!ps&&zy.prototype.options_.children.splice(1,0,"mouseTimeDisplay");Ct.registerComponent("SeekBar",zy);var lP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.handleMouseMove=ds(ni(he(o),o.handleMouseMove),to),o.throttledHandleMouseSeek=ds(ni(he(o),o.handleMouseSeek),to),o.handleMouseUpHandler_=function(s){return o.handleMouseUp(s)},o.handleMouseDownHandler_=function(s){return o.handleMouseDown(s)},o.enable(),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},e.handleMouseMove=function(r){var o=this.getChild("seekBar");if(o){var s=o.getChild("playProgressBar"),a=o.getChild("mouseTimeDisplay");if(!(!s&&!a)){var l=o.el(),u=sd(l),h=vm(l,r).x;h=Sm(h,0,1),a&&a.update(u,h),s&&s.update(u,o.getProgress())}}},e.handleMouseSeek=function(r){var o=this.getChild("seekBar");o&&o.handleMouseMove(r)},e.enabled=function(){return this.enabled_},e.disable=function(){if(this.children().forEach(function(o){return o.disable&&o.disable()}),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var r=this.getChild("seekBar");this.player_.scrubbing(!1),r.videoWasPlaying&&xo(this.player_.play())}},e.enable=function(){this.children().forEach(function(r){return r.enable&&r.enable()}),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},e.removeListenersAddedOnMousedownAndTouchstart=function(){var r=this.el_.ownerDocument;this.off(r,"mousemove",this.throttledHandleMouseSeek),this.off(r,"touchmove",this.throttledHandleMouseSeek),this.off(r,"mouseup",this.handleMouseUpHandler_),this.off(r,"touchend",this.handleMouseUpHandler_)},e.handleMouseDown=function(r){var o=this.el_.ownerDocument,s=this.getChild("seekBar");s&&s.handleMouseDown(r),this.on(o,"mousemove",this.throttledHandleMouseSeek),this.on(o,"touchmove",this.throttledHandleMouseSeek),this.on(o,"mouseup",this.handleMouseUpHandler_),this.on(o,"touchend",this.handleMouseUpHandler_)},e.handleMouseUp=function(r){var o=this.getChild("seekBar");o&&o.handleMouseUp(r),this.removeListenersAddedOnMousedownAndTouchstart()},t}(Ct);lP.prototype.options_={children:["seekBar"]};Ct.registerComponent("ProgressControl",lP);var uP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.on(i,["enterpictureinpicture","leavepictureinpicture"],function(s){return o.handlePictureInPictureChange(s)}),o.on(i,["disablepictureinpicturechanged","loadedmetadata"],function(s){return o.handlePictureInPictureEnabledChange(s)}),o.on(i,["loadedmetadata","audioonlymodechange","audiopostermodechange"],function(){var s=i.currentType().substring(0,5)==="audio";s||i.audioPosterMode()||i.audioOnlyMode()?(i.isInPictureInPicture()&&i.exitPictureInPicture(),o.hide()):o.show()}),o.disable(),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-picture-in-picture-control "+n.prototype.buildCSSClass.call(this)},e.handlePictureInPictureEnabledChange=function(){Rt.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()},e.handlePictureInPictureChange=function(r){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},e.handleClick=function(r){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},t}(Kn);uP.prototype.controlText_="Picture-in-Picture";Ct.registerComponent("PictureInPictureToggle",uP);var hP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.on(i,"fullscreenchange",function(s){return o.handleFullscreenChange(s)}),Rt[i.fsApi_.fullscreenEnabled]===!1&&o.disable(),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-fullscreen-control "+n.prototype.buildCSSClass.call(this)},e.handleFullscreenChange=function(r){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},e.handleClick=function(r){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(Kn);hP.prototype.controlText_="Fullscreen";Ct.registerComponent("FullscreenToggle",hP);var gN=function(t,e){e.tech_&&!e.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},pN=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.createEl=function(){var r=n.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});return r.appendChild(n.prototype.createEl.call(this,"span",{className:"vjs-control-text"})),r},t}(Ct);Ct.registerComponent("VolumeLevel",pN);var mN=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.update=ds(ni(he(o),o.update),to),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},e.update=function(r,o,s,a){if(!s){var l=du(this.el_),u=du(this.player_.el()),h=r.width*o;if(!u||!l)return;var d=r.left-u.left+h,c=r.width-h+(u.right-r.right),f=l.width/2;d<f?f+=f-d:c<f&&(f=c),f<0?f=0:f>l.width&&(f=l.width),this.el_.style.right="-"+f+"px"}this.write(a+"%")},e.write=function(r){nl(this.el_,r)},e.updateVolume=function(r,o,s,a,l){var u=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){u.update(r,o,s,a.toFixed(0)),l&&l()})},t}(Ct);Ct.registerComponent("VolumeLevelTooltip",mN);var dP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.update=ds(ni(he(o),o.update),to),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},e.update=function(r,o,s){var a=this,l=100*o;this.getChild("volumeLevelTooltip").updateVolume(r,o,s,l,function(){s?a.el_.style.bottom=r.height*o+"px":a.el_.style.left=r.width*o+"px"})},t}(Ct);dP.prototype.options_={children:["volumeLevelTooltip"]};Ct.registerComponent("MouseVolumeLevelDisplay",dP);var xm=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.on("slideractive",function(s){return o.updateLastVolume_(s)}),o.on(i,"volumechange",function(s){return o.updateARIAAttributes(s)}),i.ready(function(){return o.updateARIAAttributes()}),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},e.handleMouseDown=function(r){ad(r)&&n.prototype.handleMouseDown.call(this,r)},e.handleMouseMove=function(r){var o=this.getChild("mouseVolumeLevelDisplay");if(o){var s=this.el(),a=du(s),l=this.vertical(),u=vm(s,r);u=l?u.y:u.x,u=Sm(u,0,1),o.update(a,u,l)}ad(r)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(r)))},e.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},e.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},e.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},e.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},e.updateARIAAttributes=function(r){var o=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",o),this.el_.setAttribute("aria-valuetext",o+"%")},e.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},e.updateLastVolume_=function(){var r=this,o=this.player_.volume();this.one("sliderinactive",function(){r.player_.volume()===0&&r.player_.lastVolume_(o)})},t}(Oy);xm.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!Hr&&!ps&&xm.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");xm.prototype.playerEvent="volumechange";Ct.registerComponent("VolumeBar",xm);var cP=function(n){kt(t,n);function t(i,r){var o;return r===void 0&&(r={}),r.vertical=r.vertical||!1,(typeof r.volumeBar>"u"||nd(r.volumeBar))&&(r.volumeBar=r.volumeBar||{},r.volumeBar.vertical=r.vertical),o=n.call(this,i,r)||this,gN(he(o),i),o.throttledHandleMouseMove=ds(ni(he(o),o.handleMouseMove),to),o.handleMouseUpHandler_=function(s){return o.handleMouseUp(s)},o.on("mousedown",function(s){return o.handleMouseDown(s)}),o.on("touchstart",function(s){return o.handleMouseDown(s)}),o.on("mousemove",function(s){return o.handleMouseMove(s)}),o.on(o.volumeBar,["focus","slideractive"],function(){o.volumeBar.addClass("vjs-slider-active"),o.addClass("vjs-slider-active"),o.trigger("slideractive")}),o.on(o.volumeBar,["blur","sliderinactive"],function(){o.volumeBar.removeClass("vjs-slider-active"),o.removeClass("vjs-slider-active"),o.trigger("sliderinactive")}),o}var e=t.prototype;return e.createEl=function(){var r="vjs-volume-horizontal";return this.options_.vertical&&(r="vjs-volume-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+r})},e.handleMouseDown=function(r){var o=this.el_.ownerDocument;this.on(o,"mousemove",this.throttledHandleMouseMove),this.on(o,"touchmove",this.throttledHandleMouseMove),this.on(o,"mouseup",this.handleMouseUpHandler_),this.on(o,"touchend",this.handleMouseUpHandler_)},e.handleMouseUp=function(r){var o=this.el_.ownerDocument;this.off(o,"mousemove",this.throttledHandleMouseMove),this.off(o,"touchmove",this.throttledHandleMouseMove),this.off(o,"mouseup",this.handleMouseUpHandler_),this.off(o,"touchend",this.handleMouseUpHandler_)},e.handleMouseMove=function(r){this.volumeBar.handleMouseMove(r)},t}(Ct);cP.prototype.options_={children:["volumeBar"]};Ct.registerComponent("VolumeControl",cP);var vN=function(t,e){e.tech_&&!e.tech_.featuresMuteControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresMuteControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},fP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,vN(he(o),i),o.on(i,["loadstart","volumechange"],function(s){return o.update(s)}),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-mute-control "+n.prototype.buildCSSClass.call(this)},e.handleClick=function(r){var o=this.player_.volume(),s=this.player_.lastVolume_();if(o===0){var a=s<.1?.1:s;this.player_.volume(a),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},e.update=function(r){this.updateIcon_(),this.updateControlText_()},e.updateIcon_=function(){var r=this.player_.volume(),o=3;Hr&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),r===0||this.player_.muted()?o=0:r<.33?o=1:r<.67&&(o=2);for(var s=0;s<4;s++)zd(this.el_,"vjs-vol-"+s);ns(this.el_,"vjs-vol-"+o)},e.updateControlText_=function(){var r=this.player_.muted()||this.player_.volume()===0,o=r?"Unmute":"Mute";this.controlText()!==o&&this.controlText(o)},t}(Kn);fP.prototype.controlText_="Mute";Ct.registerComponent("MuteToggle",fP);var gP=function(n){kt(t,n);function t(i,r){var o;return r===void 0&&(r={}),typeof r.inline<"u"?r.inline=r.inline:r.inline=!0,(typeof r.volumeControl>"u"||nd(r.volumeControl))&&(r.volumeControl=r.volumeControl||{},r.volumeControl.vertical=!r.inline),o=n.call(this,i,r)||this,o.handleKeyPressHandler_=function(s){return o.handleKeyPress(s)},o.on(i,["loadstart"],function(s){return o.volumePanelState_(s)}),o.on(o.muteToggle,"keyup",function(s){return o.handleKeyPress(s)}),o.on(o.volumeControl,"keyup",function(s){return o.handleVolumeControlKeyUp(s)}),o.on("keydown",function(s){return o.handleKeyPress(s)}),o.on("mouseover",function(s){return o.handleMouseOver(s)}),o.on("mouseout",function(s){return o.handleMouseOut(s)}),o.on(o.volumeControl,["slideractive"],o.sliderActive_),o.on(o.volumeControl,["sliderinactive"],o.sliderInactive_),o}var e=t.prototype;return e.sliderActive_=function(){this.addClass("vjs-slider-active")},e.sliderInactive_=function(){this.removeClass("vjs-slider-active")},e.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},e.createEl=function(){var r="vjs-volume-panel-horizontal";return this.options_.inline||(r="vjs-volume-panel-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+r})},e.dispose=function(){this.handleMouseOut(),n.prototype.dispose.call(this)},e.handleVolumeControlKeyUp=function(r){fe.isEventKey(r,"Esc")&&this.muteToggle.focus()},e.handleMouseOver=function(r){this.addClass("vjs-hover"),fn(Rt,"keyup",this.handleKeyPressHandler_)},e.handleMouseOut=function(r){this.removeClass("vjs-hover"),mr(Rt,"keyup",this.handleKeyPressHandler_)},e.handleKeyPress=function(r){fe.isEventKey(r,"Esc")&&this.handleMouseOut()},t}(Ct);gP.prototype.options_={children:["muteToggle","volumeControl"]};Ct.registerComponent("VolumePanel",gP);var pP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,r&&(o.menuButton_=r.menuButton),o.focusedChild_=-1,o.on("keydown",function(s){return o.handleKeyDown(s)}),o.boundHandleBlur_=function(s){return o.handleBlur(s)},o.boundHandleTapClick_=function(s){return o.handleTapClick(s)},o}var e=t.prototype;return e.addEventListenerForItem=function(r){r instanceof Ct&&(this.on(r,"blur",this.boundHandleBlur_),this.on(r,["tap","click"],this.boundHandleTapClick_))},e.removeEventListenerForItem=function(r){r instanceof Ct&&(this.off(r,"blur",this.boundHandleBlur_),this.off(r,["tap","click"],this.boundHandleTapClick_))},e.removeChild=function(r){typeof r=="string"&&(r=this.getChild(r)),this.removeEventListenerForItem(r),n.prototype.removeChild.call(this,r)},e.addItem=function(r){var o=this.addChild(r);o&&this.addEventListenerForItem(o)},e.createEl=function(){var r=this.options_.contentElType||"ul";this.contentEl_=Le(r,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var o=n.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return o.appendChild(this.contentEl_),fn(o,"click",function(s){s.preventDefault(),s.stopImmediatePropagation()}),o},e.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,n.prototype.dispose.call(this)},e.handleBlur=function(r){var o=r.relatedTarget||Rt.activeElement;if(!this.children().some(function(a){return a.el()===o})){var s=this.menuButton_;s&&s.buttonPressed_&&o!==s.el().firstChild&&s.unpressButton()}},e.handleTapClick=function(r){if(this.menuButton_){this.menuButton_.unpressButton();var o=this.children();if(!Array.isArray(o))return;var s=o.filter(function(a){return a.el()===r.target})[0];if(!s)return;s.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},e.handleKeyDown=function(r){fe.isEventKey(r,"Left")||fe.isEventKey(r,"Down")?(r.preventDefault(),r.stopPropagation(),this.stepForward()):(fe.isEventKey(r,"Right")||fe.isEventKey(r,"Up"))&&(r.preventDefault(),r.stopPropagation(),this.stepBack())},e.stepForward=function(){var r=0;this.focusedChild_!==void 0&&(r=this.focusedChild_+1),this.focus(r)},e.stepBack=function(){var r=0;this.focusedChild_!==void 0&&(r=this.focusedChild_-1),this.focus(r)},e.focus=function(r){r===void 0&&(r=0);var o=this.children().slice(),s=o.length&&o[0].hasClass("vjs-menu-title");s&&o.shift(),o.length>0&&(r<0?r=0:r>=o.length&&(r=o.length-1),this.focusedChild_=r,o[r].el_.focus())},t}(Ct);Ct.registerComponent("Menu",pP);var Ny=function(n){kt(t,n);function t(i,r){var o;r===void 0&&(r={}),o=n.call(this,i,r)||this,o.menuButton_=new Kn(i,r),o.menuButton_.controlText(o.controlText_),o.menuButton_.el_.setAttribute("aria-haspopup","true");var s=Kn.prototype.buildCSSClass();o.menuButton_.el_.className=o.buildCSSClass()+" "+s,o.menuButton_.removeClass("vjs-control"),o.addChild(o.menuButton_),o.update(),o.enabled_=!0;var a=function(u){return o.handleClick(u)};return o.handleMenuKeyUp_=function(l){return o.handleMenuKeyUp(l)},o.on(o.menuButton_,"tap",a),o.on(o.menuButton_,"click",a),o.on(o.menuButton_,"keydown",function(l){return o.handleKeyDown(l)}),o.on(o.menuButton_,"mouseenter",function(){o.addClass("vjs-hover"),o.menu.show(),fn(Rt,"keyup",o.handleMenuKeyUp_)}),o.on("mouseleave",function(l){return o.handleMouseLeave(l)}),o.on("keydown",function(l){return o.handleSubmenuKeyDown(l)}),o}var e=t.prototype;return e.update=function(){var r=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=r,this.addChild(r),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))},e.createMenu=function(){var r=new pP(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var o=Le("li",{className:"vjs-menu-title",textContent:Bi(this.options_.title),tabIndex:-1}),s=new Ct(this.player_,{el:o});r.addItem(s)}if(this.items=this.createItems(),this.items)for(var a=0;a<this.items.length;a++)r.addItem(this.items[a]);return r},e.createItems=function(){},e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},e.buildWrapperCSSClass=function(){var r="vjs-menu-button";this.options_.inline===!0?r+="-inline":r+="-popup";var o=Kn.prototype.buildCSSClass();return"vjs-menu-button "+r+" "+o+" "+n.prototype.buildCSSClass.call(this)},e.buildCSSClass=function(){var r="vjs-menu-button";return this.options_.inline===!0?r+="-inline":r+="-popup","vjs-menu-button "+r+" "+n.prototype.buildCSSClass.call(this)},e.controlText=function(r,o){return o===void 0&&(o=this.menuButton_.el()),this.menuButton_.controlText(r,o)},e.dispose=function(){this.handleMouseLeave(),n.prototype.dispose.call(this)},e.handleClick=function(r){this.buttonPressed_?this.unpressButton():this.pressButton()},e.handleMouseLeave=function(r){this.removeClass("vjs-hover"),mr(Rt,"keyup",this.handleMenuKeyUp_)},e.focus=function(){this.menuButton_.focus()},e.blur=function(){this.menuButton_.blur()},e.handleKeyDown=function(r){fe.isEventKey(r,"Esc")||fe.isEventKey(r,"Tab")?(this.buttonPressed_&&this.unpressButton(),fe.isEventKey(r,"Tab")||(r.preventDefault(),this.menuButton_.focus())):(fe.isEventKey(r,"Up")||fe.isEventKey(r,"Down"))&&(this.buttonPressed_||(r.preventDefault(),this.pressButton()))},e.handleMenuKeyUp=function(r){(fe.isEventKey(r,"Esc")||fe.isEventKey(r,"Tab"))&&this.removeClass("vjs-hover")},e.handleSubmenuKeyPress=function(r){this.handleSubmenuKeyDown(r)},e.handleSubmenuKeyDown=function(r){(fe.isEventKey(r,"Esc")||fe.isEventKey(r,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),fe.isEventKey(r,"Tab")||(r.preventDefault(),this.menuButton_.focus()))},e.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Hr&&BB())return;this.menu.focus()}},e.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},e.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},e.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(Ct);Ct.registerComponent("MenuButton",Ny);var Wy=function(n){kt(t,n);function t(e,i){var r,o=i.tracks;if(r=n.call(this,e,i)||this,r.items.length<=1&&r.hide(),!o)return he(r);var s=ni(he(r),r.update);return o.addEventListener("removetrack",s),o.addEventListener("addtrack",s),o.addEventListener("labelchange",s),r.player_.on("ready",s),r.player_.on("dispose",function(){o.removeEventListener("removetrack",s),o.removeEventListener("addtrack",s),o.removeEventListener("labelchange",s)}),r}return t}(Ny);Ct.registerComponent("TrackButton",Wy);var bN=["Tab","Esc","Up","Down","Right","Left"],Wd=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.selectable=r.selectable,o.isSelected_=r.selected||!1,o.multiSelectable=r.multiSelectable,o.selected(o.isSelected_),o.selectable?o.multiSelectable?o.el_.setAttribute("role","menuitemcheckbox"):o.el_.setAttribute("role","menuitemradio"):o.el_.setAttribute("role","menuitem"),o}var e=t.prototype;return e.createEl=function(r,o,s){this.nonIconControl=!0;var a=n.prototype.createEl.call(this,"li",pi({className:"vjs-menu-item",tabIndex:-1},o),s);return a.replaceChild(Le("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),a.querySelector(".vjs-icon-placeholder")),a},e.handleKeyDown=function(r){bN.some(function(o){return fe.isEventKey(r,o)})||n.prototype.handleKeyDown.call(this,r)},e.handleClick=function(r){this.selected(!0)},e.selected=function(r){this.selectable&&(r?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(wm);Ct.registerComponent("MenuItem",Wd);var Ud=function(n){kt(t,n);function t(i,r){var o,s=r.track,a=i.textTracks();r.label=s.label||s.language||"Unknown",r.selected=s.mode==="showing",o=n.call(this,i,r)||this,o.track=s,o.kinds=(r.kinds||[r.kind||o.track.kind]).filter(Boolean);var l=function(){for(var c=arguments.length,f=new Array(c),g=0;g<c;g++)f[g]=arguments[g];o.handleTracksChange.apply(he(o),f)},u=function(){for(var c=arguments.length,f=new Array(c),g=0;g<c;g++)f[g]=arguments[g];o.handleSelectedLanguageChange.apply(he(o),f)};if(i.on(["loadstart","texttrackchange"],l),a.addEventListener("change",l),a.addEventListener("selectedlanguagechange",u),o.on("dispose",function(){i.off(["loadstart","texttrackchange"],l),a.removeEventListener("change",l),a.removeEventListener("selectedlanguagechange",u)}),a.onchange===void 0){var h;o.on(["tap","click"],function(){if(typeof K.Event!="object")try{h=new K.Event("change")}catch{}h||(h=Rt.createEvent("Event"),h.initEvent("change",!0,!0)),a.dispatchEvent(h)})}return o.handleTracksChange(),o}var e=t.prototype;return e.handleClick=function(r){var o=this.track,s=this.player_.textTracks();if(n.prototype.handleClick.call(this,r),!!s)for(var a=0;a<s.length;a++){var l=s[a];this.kinds.indexOf(l.kind)!==-1&&(l===o?l.mode!=="showing"&&(l.mode="showing"):l.mode!=="disabled"&&(l.mode="disabled"))}},e.handleTracksChange=function(r){var o=this.track.mode==="showing";o!==this.isSelected_&&this.selected(o)},e.handleSelectedLanguageChange=function(r){if(this.track.mode==="showing"){var o=this.player_.cache_.selectedLanguage;if(o&&o.enabled&&o.language===this.track.language&&o.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},e.dispose=function(){this.track=null,n.prototype.dispose.call(this)},t}(Wd);Ct.registerComponent("TextTrackMenuItem",Ud);var mP=function(n){kt(t,n);function t(i,r){return r.track={player:i,kind:r.kind,kinds:r.kinds,default:!1,mode:"disabled"},r.kinds||(r.kinds=[r.kind]),r.label?r.track.label=r.label:r.track.label=r.kinds.join(" and ")+" off",r.selectable=!0,r.multiSelectable=!1,n.call(this,i,r)||this}var e=t.prototype;return e.handleTracksChange=function(r){for(var o=this.player().textTracks(),s=!0,a=0,l=o.length;a<l;a++){var u=o[a];if(this.options_.kinds.indexOf(u.kind)>-1&&u.mode==="showing"){s=!1;break}}s!==this.isSelected_&&this.selected(s)},e.handleSelectedLanguageChange=function(r){for(var o=this.player().textTracks(),s=!0,a=0,l=o.length;a<l;a++){var u=o[a];if(["captions","descriptions","subtitles"].indexOf(u.kind)>-1&&u.mode==="showing"){s=!1;break}}s&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Ud);Ct.registerComponent("OffTextTrackMenuItem",mP);var Du=function(n){kt(t,n);function t(i,r){return r===void 0&&(r={}),r.tracks=i.textTracks(),n.call(this,i,r)||this}var e=t.prototype;return e.createItems=function(r,o){r===void 0&&(r=[]),o===void 0&&(o=Ud);var s;this.label_&&(s=this.label_+" off"),r.push(new mP(this.player_,{kinds:this.kinds_,kind:this.kind_,label:s})),this.hideThreshold_+=1;var a=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var l=0;l<a.length;l++){var u=a[l];if(this.kinds_.indexOf(u.kind)>-1){var h=new o(this.player_,{track:u,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});h.addClass("vjs-"+u.kind+"-menu-item"),r.push(h)}}return r},t}(Wy);Ct.registerComponent("TextTrackButton",Du);var vP=function(n){kt(t,n);function t(i,r){var o,s=r.track,a=r.cue,l=i.currentTime();return r.selectable=!0,r.multiSelectable=!1,r.label=a.text,r.selected=a.startTime<=l&&l<a.endTime,o=n.call(this,i,r)||this,o.track=s,o.cue=a,o}var e=t.prototype;return e.handleClick=function(r){n.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime)},t}(Wd);Ct.registerComponent("ChaptersTrackMenuItem",vP);var Uy=function(n){kt(t,n);function t(i,r,o){var s;return s=n.call(this,i,r,o)||this,s.selectCurrentItem_=function(){s.items.forEach(function(a){a.selected(s.track_.activeCues[0]===a.cue)})},s}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildWrapperCSSClass.call(this)},e.update=function(r){if(!(r&&r.track&&r.track.kind!=="chapters")){var o=this.findChaptersTrack();o!==this.track_?(this.setTrack(o),n.prototype.update.call(this)):(!this.items||o&&o.cues&&o.cues.length!==this.items.length)&&n.prototype.update.call(this)}},e.setTrack=function(r){if(this.track_!==r){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var o=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);o&&o.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=r,this.track_){this.track_.mode="hidden";var s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}},e.findChaptersTrack=function(){for(var r=this.player_.textTracks()||[],o=r.length-1;o>=0;o--){var s=r[o];if(s.kind===this.kind_)return s}},e.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Bi(this.kind_))},e.createMenu=function(){return this.options_.title=this.getMenuCaption(),n.prototype.createMenu.call(this)},e.createItems=function(){var r=[];if(!this.track_)return r;var o=this.track_.cues;if(!o)return r;for(var s=0,a=o.length;s<a;s++){var l=o[s],u=new vP(this.player_,{track:this.track_,cue:l});r.push(u)}return r},t}(Du);Uy.prototype.kind_="chapters";Uy.prototype.controlText_="Chapters";Ct.registerComponent("ChaptersButton",Uy);var Vy=function(n){kt(t,n);function t(i,r,o){var s;s=n.call(this,i,r,o)||this;var a=i.textTracks(),l=ni(he(s),s.handleTracksChange);return a.addEventListener("change",l),s.on("dispose",function(){a.removeEventListener("change",l)}),s}var e=t.prototype;return e.handleTracksChange=function(r){for(var o=this.player().textTracks(),s=!1,a=0,l=o.length;a<l;a++){var u=o[a];if(u.kind!==this.kind_&&u.mode==="showing"){s=!0;break}}s?this.disable():this.enable()},e.buildCSSClass=function(){return"vjs-descriptions-button "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+n.prototype.buildWrapperCSSClass.call(this)},t}(Du);Vy.prototype.kind_="descriptions";Vy.prototype.controlText_="Descriptions";Ct.registerComponent("DescriptionsButton",Vy);var jy=function(n){kt(t,n);function t(i,r,o){return n.call(this,i,r,o)||this}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildWrapperCSSClass.call(this)},t}(Du);jy.prototype.kind_="subtitles";jy.prototype.controlText_="Subtitles";Ct.registerComponent("SubtitlesButton",jy);var Gy=function(n){kt(t,n);function t(i,r){var o;return r.track={player:i,kind:r.kind,label:r.kind+" settings",selectable:!1,default:!1,mode:"disabled"},r.selectable=!1,r.name="CaptionSettingsMenuItem",o=n.call(this,i,r)||this,o.addClass("vjs-texttrack-settings"),o.controlText(", opens "+r.kind+" settings dialog"),o}var e=t.prototype;return e.handleClick=function(r){this.player().getChild("textTrackSettings").open()},t}(Ud);Ct.registerComponent("CaptionSettingsMenuItem",Gy);var $y=function(n){kt(t,n);function t(i,r,o){return n.call(this,i,r,o)||this}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-captions-button "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-captions-button "+n.prototype.buildWrapperCSSClass.call(this)},e.createItems=function(){var r=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(r.push(new Gy(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,r)},t}(Du);$y.prototype.kind_="captions";$y.prototype.controlText_="Captions";Ct.registerComponent("CaptionsButton",$y);var bP=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.createEl=function(r,o,s){var a=n.prototype.createEl.call(this,r,o,s),l=a.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(l.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),l.appendChild(Le("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),a},t}(Ud);Ct.registerComponent("SubsCapsMenuItem",bP);var qy=function(n){kt(t,n);function t(i,r){var o;return r===void 0&&(r={}),o=n.call(this,i,r)||this,o.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(o.player_.language_)>-1&&(o.label_="captions"),o.menuButton_.controlText(Bi(o.label_)),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildWrapperCSSClass.call(this)},e.createItems=function(){var r=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(r.push(new Gy(this.player_,{kind:this.label_})),this.hideThreshold_+=1),r=n.prototype.createItems.call(this,r,bP),r},t}(Du);qy.prototype.kinds_=["captions","subtitles"];qy.prototype.controlText_="Subtitles";Ct.registerComponent("SubsCapsButton",qy);var _P=function(n){kt(t,n);function t(i,r){var o,s=r.track,a=i.audioTracks();r.label=s.label||s.language||"Unknown",r.selected=s.enabled,o=n.call(this,i,r)||this,o.track=s,o.addClass("vjs-"+s.kind+"-menu-item");var l=function(){for(var h=arguments.length,d=new Array(h),c=0;c<h;c++)d[c]=arguments[c];o.handleTracksChange.apply(he(o),d)};return a.addEventListener("change",l),o.on("dispose",function(){a.removeEventListener("change",l)}),o}var e=t.prototype;return e.createEl=function(r,o,s){var a=n.prototype.createEl.call(this,r,o,s),l=a.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(l.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),l.appendChild(Le("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),a},e.handleClick=function(r){if(n.prototype.handleClick.call(this,r),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks)for(var o=this.player_.audioTracks(),s=0;s<o.length;s++){var a=o[s];a!==this.track&&(a.enabled=a===this.track)}},e.handleTracksChange=function(r){this.selected(this.track.enabled)},t}(Wd);Ct.registerComponent("AudioTrackMenuItem",_P);var CP=function(n){kt(t,n);function t(i,r){return r===void 0&&(r={}),r.tracks=i.audioTracks(),n.call(this,i,r)||this}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-audio-button "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-audio-button "+n.prototype.buildWrapperCSSClass.call(this)},e.createItems=function(r){r===void 0&&(r=[]),this.hideThreshold_=1;for(var o=this.player_.audioTracks(),s=0;s<o.length;s++){var a=o[s];r.push(new _P(this.player_,{track:a,selectable:!0,multiSelectable:!1}))}return r},t}(Wy);CP.prototype.controlText_="Audio Track";Ct.registerComponent("AudioTrackButton",CP);var Xy=function(n){kt(t,n);function t(i,r){var o,s=r.rate,a=parseFloat(s,10);return r.label=s,r.selected=a===i.playbackRate(),r.selectable=!0,r.multiSelectable=!1,o=n.call(this,i,r)||this,o.label=s,o.rate=a,o.on(i,"ratechange",function(l){return o.update(l)}),o}var e=t.prototype;return e.handleClick=function(r){n.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},e.update=function(r){this.selected(this.player().playbackRate()===this.rate)},t}(Wd);Xy.prototype.contentElType="button";Ct.registerComponent("PlaybackRateMenuItem",Xy);var yP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.menuButton_.el_.setAttribute("aria-describedby",o.labelElId_),o.updateVisibility(),o.updateLabel(),o.on(i,"loadstart",function(s){return o.updateVisibility(s)}),o.on(i,"ratechange",function(s){return o.updateLabel(s)}),o.on(i,"playbackrateschange",function(s){return o.handlePlaybackRateschange(s)}),o}var e=t.prototype;return e.createEl=function(){var r=n.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Le("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),r.appendChild(this.labelEl_),r},e.dispose=function(){this.labelEl_=null,n.prototype.dispose.call(this)},e.buildCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildCSSClass.call(this)},e.buildWrapperCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildWrapperCSSClass.call(this)},e.createItems=function(){for(var r=this.playbackRates(),o=[],s=r.length-1;s>=0;s--)o.push(new Xy(this.player(),{rate:r[s]+"x"}));return o},e.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},e.handleClick=function(r){var o=this.player().playbackRate(),s=this.playbackRates(),a=s.indexOf(o),l=(a+1)%s.length;this.player().playbackRate(s[l])},e.handlePlaybackRateschange=function(r){this.update()},e.playbackRates=function(){var r=this.player();return r.playbackRates&&r.playbackRates()||[]},e.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},e.updateVisibility=function(r){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},e.updateLabel=function(r){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")},t}(Ny);yP.prototype.controlText_="Playback Rate";Ct.registerComponent("PlaybackRateMenuButton",yP);var wP=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-spacer "+n.prototype.buildCSSClass.call(this)},e.createEl=function(r,o,s){return r===void 0&&(r="div"),o===void 0&&(o={}),s===void 0&&(s={}),o.className||(o.className=this.buildCSSClass()),n.prototype.createEl.call(this,r,o,s)},t}(Ct);Ct.registerComponent("Spacer",wP);var _N=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-custom-control-spacer "+n.prototype.buildCSSClass.call(this)},e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:" "})},t}(wP);Ct.registerComponent("CustomControlSpacer",_N);var qf=function(n){kt(t,n);function t(){return n.apply(this,arguments)||this}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Ct);qf.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};"exitPictureInPicture"in Rt&&qf.prototype.options_.children.splice(qf.prototype.options_.children.length-1,0,"pictureInPictureToggle");Ct.registerComponent("ControlBar",qf);var SP=function(n){kt(t,n);function t(i,r){var o;return o=n.call(this,i,r)||this,o.on(i,"error",function(s){return o.open(s)}),o}var e=t.prototype;return e.buildCSSClass=function(){return"vjs-error-display "+n.prototype.buildCSSClass.call(this)},e.content=function(){var r=this.player().error();return r?this.localize(r.message):""},t}(Pu);SP.prototype.options_=Jn({},Pu.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});Ct.registerComponent("ErrorDisplay",SP);var $0="vjs-text-track-settings",XS=["#000","Black"],YS=["#00F","Blue"],KS=["#0FF","Cyan"],ZS=["#0F0","Green"],QS=["#F0F","Magenta"],JS=["#F00","Red"],tx=["#FFF","White"],ex=["#FF0","Yellow"],q0=["1","Opaque"],X0=["0.5","Semi-Transparent"],ix=["0","Transparent"],Ta={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[XS,tx,JS,ZS,YS,ex,QS,KS]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[q0,X0,ix]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[tx,XS,JS,ZS,YS,ex,QS,KS]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(t){return t==="1.00"?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[q0,X0]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[ix,X0,q0]}};Ta.windowColor.options=Ta.backgroundColor.options;function xP(n,t){if(t&&(n=t(n)),n&&n!=="none")return n}function CN(n,t){var e=n.options[n.options.selectedIndex].value;return xP(e,t)}function yN(n,t,e){if(t){for(var i=0;i<n.options.length;i++)if(xP(n.options[i].value,e)===t){n.selectedIndex=i;break}}}var wN=function(n){kt(t,n);function t(i,r){var o;return r.temporary=!1,o=n.call(this,i,r)||this,o.updateDisplay=o.updateDisplay.bind(he(o)),o.fill(),o.hasBeenOpened_=o.hasBeenFilled_=!0,o.endDialog=Le("p",{className:"vjs-control-text",textContent:o.localize("End of dialog window.")}),o.el().appendChild(o.endDialog),o.setDefaults(),r.persistTextTrackSettings===void 0&&(o.options_.persistTextTrackSettings=o.options_.playerOptions.persistTextTrackSettings),o.on(o.$(".vjs-done-button"),"click",function(){o.saveSettings(),o.close()}),o.on(o.$(".vjs-default-button"),"click",function(){o.setDefaults(),o.updateDisplay()}),Nl(Ta,function(s){o.on(o.$(s.selector),"change",o.updateDisplay)}),o.options_.persistTextTrackSettings&&o.restoreSettings(),o}var e=t.prototype;return e.dispose=function(){this.endDialog=null,n.prototype.dispose.call(this)},e.createElSelect_=function(r,o,s){var a=this;o===void 0&&(o=""),s===void 0&&(s="label");var l=Ta[r],u=l.id.replace("%s",this.id_),h=[o,u].join(" ").trim();return["<"+s+' id="'+u+'" class="'+(s==="label"?"vjs-label":"")+'">',this.localize(l.label),"</"+s+">",'<select aria-labelledby="'+h+'">'].concat(l.options.map(function(d){var c=u+"-"+d[1].replace(/\W+/g,"");return['<option id="'+c+'" value="'+d[0]+'" ','aria-labelledby="'+h+" "+c+'">',a.localize(d[1]),"</option>"].join("")})).concat("</select>").join("")},e.createElFgColor_=function(){var r="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+r+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",r),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",r),"</span>","</fieldset>"].join("")},e.createElBgColor_=function(){var r="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+r+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",r),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",r),"</span>","</fieldset>"].join("")},e.createElWinColor_=function(){var r="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+r+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",r),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",r),"</span>","</fieldset>"].join("")},e.createElColors_=function(){return Le("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},e.createElFont_=function(){return Le("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},e.createElControls_=function(){var r=this.localize("restore all settings to the default values");return Le("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+r+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+r+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},e.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},e.label=function(){return this.localize("Caption Settings Dialog")},e.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},e.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},e.getValues=function(){var r=this;return hz(Ta,function(o,s,a){var l=CN(r.$(s.selector),s.parser);return l!==void 0&&(o[a]=l),o},{})},e.setValues=function(r){var o=this;Nl(Ta,function(s,a){yN(o.$(s.selector),r[a],s.parser)})},e.setDefaults=function(){var r=this;Nl(Ta,function(o){var s=o.hasOwnProperty("default")?o.default:0;r.$(o.selector).selectedIndex=s})},e.restoreSettings=function(){var r;try{r=JSON.parse(K.localStorage.getItem($0))}catch(o){_e.warn(o)}r&&this.setValues(r)},e.saveSettings=function(){if(this.options_.persistTextTrackSettings){var r=this.getValues();try{Object.keys(r).length?K.localStorage.setItem($0,JSON.stringify(r)):K.localStorage.removeItem($0)}catch(o){_e.warn(o)}}},e.updateDisplay=function(){var r=this.player_.getChild("textTrackDisplay");r&&r.updateDisplay()},e.conditionalBlur_=function(){this.previouslyActiveEl_=null;var r=this.player_.controlBar,o=r&&r.subsCapsButton,s=r&&r.captionsButton;o?o.focus():s&&s.focus()},t}(Pu);Ct.registerComponent("TextTrackSettings",wN);var SN=function(n){kt(t,n);function t(i,r){var o,s=r.ResizeObserver||K.ResizeObserver;r.ResizeObserver===null&&(s=!1);var a=ii({createEl:!s,reportTouchActivity:!1},r);return o=n.call(this,i,a)||this,o.ResizeObserver=r.ResizeObserver||K.ResizeObserver,o.loadListener_=null,o.resizeObserver_=null,o.debouncedHandler_=yz(function(){o.resizeHandler()},100,!1,he(o)),s?(o.resizeObserver_=new o.ResizeObserver(o.debouncedHandler_),o.resizeObserver_.observe(i.el())):(o.loadListener_=function(){if(!(!o.el_||!o.el_.contentWindow)){var l=o.debouncedHandler_,u=o.unloadListener_=function(){mr(this,"resize",l),mr(this,"unload",u),u=null};fn(o.el_.contentWindow,"unload",u),fn(o.el_.contentWindow,"resize",l)}},o.one("load",o.loadListener_)),o}var e=t.prototype;return e.createEl=function(){return n.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})},e.resizeHandler=function(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")},e.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,n.prototype.dispose.call(this)},t}(Ct);Ct.registerComponent("ResizeManager",SN);var xN={trackingThreshold:20,liveTolerance:15},TN=function(n){kt(t,n);function t(i,r){var o,s=ii(xN,r,{createEl:!1});return o=n.call(this,i,s)||this,o.handleVisibilityChange_=function(a){return o.handleVisibilityChange(a)},o.trackLiveHandler_=function(){return o.trackLive_()},o.handlePlay_=function(a){return o.handlePlay(a)},o.handleFirstTimeupdate_=function(a){return o.handleFirstTimeupdate(a)},o.handleSeeked_=function(a){return o.handleSeeked(a)},o.seekToLiveEdge_=function(a){return o.seekToLiveEdge(a)},o.reset_(),o.on(o.player_,"durationchange",function(a){return o.handleDurationchange(a)}),o.on(o.player_,"canplay",function(){return o.toggleTracking()}),Hd&&"hidden"in Rt&&"visibilityState"in Rt&&o.on(Rt,"visibilitychange",o.handleVisibilityChange_),o}var e=t.prototype;return e.handleVisibilityChange=function(){this.player_.duration()===1/0&&(Rt.hidden?this.stopTracking():this.startTracking())},e.trackLive_=function(){var r=this.player_.seekable();if(!(!r||!r.length)){var o=Number(K.performance.now().toFixed(4)),s=this.lastTime_===-1?0:(o-this.lastTime_)/1e3;this.lastTime_=o,this.pastSeekEnd_=this.pastSeekEnd()+s;var a=this.liveCurrentTime(),l=this.player_.currentTime(),u=this.player_.paused()||this.seekedBehindLive_||Math.abs(a-l)>this.options_.liveTolerance;(!this.timeupdateSeen_||a===1/0)&&(u=!1),u!==this.behindLiveEdge_&&(this.behindLiveEdge_=u,this.trigger("liveedgechange"))}},e.handleDurationchange=function(){this.toggleTracking()},e.toggleTracking=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},e.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,to),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},e.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},e.handleSeeked=function(){var r=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&r>2,this.nextSeekedFromUser_=!1,this.trackLive_()},e.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},e.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},e.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},e.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},e.seekableEnd=function(){for(var r=this.player_.seekable(),o=[],s=r?r.length:0;s--;)o.push(r.end(s));return o.length?o.sort()[o.length-1]:1/0},e.seekableStart=function(){for(var r=this.player_.seekable(),o=[],s=r?r.length:0;s--;)o.push(r.start(s));return o.length?o.sort()[0]:0},e.liveWindow=function(){var r=this.liveCurrentTime();return r===1/0?0:r-this.seekableStart()},e.isLive=function(){return this.isTracking()},e.atLiveEdge=function(){return!this.behindLiveEdge()},e.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},e.pastSeekEnd=function(){var r=this.seekableEnd();return this.lastSeekEnd_!==-1&&r!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=r,this.pastSeekEnd_},e.behindLiveEdge=function(){return this.behindLiveEdge_},e.isTracking=function(){return typeof this.trackingInterval_=="number"},e.seekToLiveEdge=function(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},e.dispose=function(){this.off(Rt,"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),n.prototype.dispose.call(this)},t}(Ct);Ct.registerComponent("LiveTracker",TN);var s_=function(t){var e=t.el();if(e.hasAttribute("src"))return t.triggerSourceset(e.src),!0;var i=t.$$("source"),r=[],o="";if(!i.length)return!1;for(var s=0;s<i.length;s++){var a=i[s].src;a&&r.indexOf(a)===-1&&r.push(a)}return r.length?(r.length===1&&(o=r[0]),t.triggerSourceset(o),!0):!1},AN=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(t){var e=Rt.createElement(this.nodeName.toLowerCase());e.innerHTML=t;for(var i=Rt.createDocumentFragment();e.childNodes.length;)i.appendChild(e.childNodes[0]);return this.innerText="",K.Element.prototype.appendChild.call(this,i),this.innerHTML}}),TP=function(t,e){for(var i={},r=0;r<t.length&&(i=Object.getOwnPropertyDescriptor(t[r],e),!(i&&i.set&&i.get));r++);return i.enumerable=!0,i.configurable=!0,i},RN=function(t){return TP([t.el(),K.HTMLMediaElement.prototype,K.Element.prototype,AN],"innerHTML")},rx=function(t){var e=t.el();if(!e.resetSourceWatch_){var i={},r=RN(t),o=function(a){return function(){for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];var d=a.apply(e,u);return s_(t),d}};["append","appendChild","insertAdjacentHTML"].forEach(function(s){e[s]&&(i[s]=e[s],e[s]=o(i[s]))}),Object.defineProperty(e,"innerHTML",ii(r,{set:o(r.set)})),e.resetSourceWatch_=function(){e.resetSourceWatch_=null,Object.keys(i).forEach(function(s){e[s]=i[s]}),Object.defineProperty(e,"innerHTML",r)},t.one("sourceset",e.resetSourceWatch_)}},EN=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?QB(K.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return K.Element.prototype.setAttribute.call(this,"src",t),t}}),MN=function(t){return TP([t.el(),K.HTMLMediaElement.prototype,EN],"src")},BN=function(t){if(t.featuresSourceset){var e=t.el();if(!e.resetSourceset_){var i=MN(t),r=e.setAttribute,o=e.load;Object.defineProperty(e,"src",ii(i,{set:function(a){var l=i.set.call(e,a);return t.triggerSourceset(e.src),l}})),e.setAttribute=function(s,a){var l=r.call(e,s,a);return/src/i.test(s)&&t.triggerSourceset(e.src),l},e.load=function(){var s=o.call(e);return s_(t)||(t.triggerSourceset(""),rx(t)),s},e.currentSrc?t.triggerSourceset(e.currentSrc):s_(t)||rx(t),e.resetSourceset_=function(){e.resetSourceset_=null,e.load=o,e.setAttribute=r,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}}}},Yy=function(t,e,i,r){r===void 0&&(r=!0);var o=function(l){return Object.defineProperty(t,e,{value:l,enumerable:!0,writable:!0})},s={configurable:!0,enumerable:!0,get:function(){var l=i();return o(l),l}};return r&&(s.set=o),Object.defineProperty(t,e,s)},Nt=function(n){kt(t,n);function t(i,r){var o;o=n.call(this,i,r)||this;var s=i.source,a=!1;if(o.featuresVideoFrameCallback=o.featuresVideoFrameCallback&&o.el_.tagName==="VIDEO",s&&(o.el_.currentSrc!==s.src||i.tag&&i.tag.initNetworkState_===3)?o.setSource(s):o.handleLateInit_(o.el_),i.enableSourceset&&o.setupSourcesetHandling_(),o.isScrubbing_=!1,o.el_.hasChildNodes()){for(var l=o.el_.childNodes,u=l.length,h=[];u--;){var d=l[u],c=d.nodeName.toLowerCase();c==="track"&&(o.featuresNativeTextTracks?(o.remoteTextTrackEls().addTrackElement_(d),o.remoteTextTracks().addTrack(d.track),o.textTracks().addTrack(d.track),!a&&!o.el_.hasAttribute("crossorigin")&&ym(d.src)&&(a=!0)):h.push(d))}for(var f=0;f<h.length;f++)o.el_.removeChild(h[f])}return o.proxyNativeTracks_(),o.featuresNativeTextTracks&&a&&_e.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),o.restoreMetadataTracksInIOSNativePlayer_(),(uu||xy||TB)&&i.nativeControlsForTouch===!0&&o.setControls(!0),o.proxyWebkitFullscreen_(),o.triggerReady(),o}var e=t.prototype;return e.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),t.disposeMediaElement(this.el_),this.options_=null,n.prototype.dispose.call(this)},e.setupSourcesetHandling_=function(){BN(this)},e.restoreMetadataTracksInIOSNativePlayer_=function(){var r=this.textTracks(),o,s=function(){o=[];for(var u=0;u<r.length;u++){var h=r[u];h.kind==="metadata"&&o.push({track:h,storedMode:h.mode})}};s(),r.addEventListener("change",s),this.on("dispose",function(){return r.removeEventListener("change",s)});var a=function l(){for(var u=0;u<o.length;u++){var h=o[u];h.track.mode==="disabled"&&h.track.mode!==h.storedMode&&(h.track.mode=h.storedMode)}r.removeEventListener("change",l)};this.on("webkitbeginfullscreen",function(){r.removeEventListener("change",s),r.removeEventListener("change",a),r.addEventListener("change",a)}),this.on("webkitendfullscreen",function(){r.removeEventListener("change",s),r.addEventListener("change",s),r.removeEventListener("change",a)})},e.overrideNative_=function(r,o){var s=this;if(o===this["featuresNative"+r+"Tracks"]){var a=r.toLowerCase();this[a+"TracksListeners_"]&&Object.keys(this[a+"TracksListeners_"]).forEach(function(l){var u=s.el()[a+"Tracks"];u.removeEventListener(l,s[a+"TracksListeners_"][l])}),this["featuresNative"+r+"Tracks"]=!o,this[a+"TracksListeners_"]=null,this.proxyNativeTracksForType_(a)}},e.overrideNativeAudioTracks=function(r){this.overrideNative_("Audio",r)},e.overrideNativeVideoTracks=function(r){this.overrideNative_("Video",r)},e.proxyNativeTracksForType_=function(r){var o=this,s=kn[r],a=this.el()[s.getterName],l=this[s.getterName]();if(!(!this["featuresNative"+s.capitalName+"Tracks"]||!a||!a.addEventListener)){var u={change:function(c){var f={type:"change",target:l,currentTarget:l,srcElement:l};l.trigger(f),r==="text"&&o[fu.remoteText.getterName]().trigger(f)},addtrack:function(c){l.addTrack(c.track)},removetrack:function(c){l.removeTrack(c.track)}},h=function(){for(var c=[],f=0;f<l.length;f++){for(var g=!1,m=0;m<a.length;m++)if(a[m]===l[f]){g=!0;break}g||c.push(l[f])}for(;c.length;)l.removeTrack(c.shift())};this[s.getterName+"Listeners_"]=u,Object.keys(u).forEach(function(d){var c=u[d];a.addEventListener(d,c),o.on("dispose",function(f){return a.removeEventListener(d,c)})}),this.on("loadstart",h),this.on("dispose",function(d){return o.off("loadstart",h)})}},e.proxyNativeTracks_=function(){var r=this;kn.names.forEach(function(o){r.proxyNativeTracksForType_(o)})},e.createEl=function(){var r=this.options_.tag;if(!r||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(r){var o=r.cloneNode(!0);r.parentNode&&r.parentNode.insertBefore(o,r),t.disposeMediaElement(r),r=o}else{r=Rt.createElement("video");var s=this.options_.tag&&Qo(this.options_.tag),a=ii({},s);(!uu||this.options_.nativeControlsForTouch!==!0)&&delete a.controls,LB(r,pi(a,{id:this.options_.techId,class:"vjs-tech"}))}r.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&hu(r,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(r.disablePictureInPicture=this.options_.disablePictureInPicture);for(var l=["loop","muted","playsinline","autoplay"],u=0;u<l.length;u++){var h=l[u],d=this.options_[h];typeof d<"u"&&(d?hu(r,h,h):mm(r,h),r[h]=d)}return r},e.handleLateInit_=function(r){if(!(r.networkState===0||r.networkState===3)){if(r.readyState===0){var o=!1,s=function(){o=!0};this.on("loadstart",s);var a=function(){o||this.trigger("loadstart")};this.on("loadedmetadata",a),this.ready(function(){this.off("loadstart",s),this.off("loadedmetadata",a),o||this.trigger("loadstart")});return}var l=["loadstart"];l.push("loadedmetadata"),r.readyState>=2&&l.push("loadeddata"),r.readyState>=3&&l.push("canplay"),r.readyState>=4&&l.push("canplaythrough"),this.ready(function(){l.forEach(function(u){this.trigger(u)},this)})}},e.setScrubbing=function(r){this.isScrubbing_=r},e.scrubbing=function(){return this.isScrubbing_},e.setCurrentTime=function(r){try{this.isScrubbing_&&this.el_.fastSeek&&pm?this.el_.fastSeek(r):this.el_.currentTime=r}catch(o){_e(o,"Video is not ready. (Video.js)")}},e.duration=function(){var r=this;if(this.el_.duration===1/0&&ps&&ms&&this.el_.currentTime===0){var o=function s(){r.el_.currentTime>0&&(r.el_.duration===1/0&&r.trigger("durationchange"),r.off("timeupdate",s))};return this.on("timeupdate",o),NaN}return this.el_.duration||NaN},e.width=function(){return this.el_.offsetWidth},e.height=function(){return this.el_.offsetHeight},e.proxyWebkitFullscreen_=function(){var r=this;if("webkitDisplayingFullscreen"in this.el_){var o=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},s=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",o),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",s),this.on("dispose",function(){r.off("webkitbeginfullscreen",s),r.off("webkitendfullscreen",o)})}},e.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var r=K.navigator&&K.navigator.userAgent||"";if(/Android/.test(r)||!/Chrome|Mac OS X 10.5/.test(r))return!0}return!1},e.enterFullScreen=function(){var r=this.el_;if(r.paused&&r.networkState<=r.HAVE_METADATA)xo(this.el_.play()),this.setTimeout(function(){r.pause();try{r.webkitEnterFullScreen()}catch(o){this.trigger("fullscreenerror",o)}},0);else try{r.webkitEnterFullScreen()}catch(o){this.trigger("fullscreenerror",o)}},e.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()},e.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},e.requestVideoFrameCallback=function(r){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(r):n.prototype.requestVideoFrameCallback.call(this,r)},e.cancelVideoFrameCallback=function(r){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(r):n.prototype.cancelVideoFrameCallback.call(this,r)},e.src=function(r){if(r===void 0)return this.el_.src;this.setSrc(r)},e.reset=function(){t.resetMediaElement(this.el_)},e.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.setControls=function(r){this.el_.controls=!!r},e.addTextTrack=function(r,o,s){return this.featuresNativeTextTracks?this.el_.addTextTrack(r,o,s):n.prototype.addTextTrack.call(this,r,o,s)},e.createRemoteTextTrack=function(r){if(!this.featuresNativeTextTracks)return n.prototype.createRemoteTextTrack.call(this,r);var o=Rt.createElement("track");return r.kind&&(o.kind=r.kind),r.label&&(o.label=r.label),(r.language||r.srclang)&&(o.srclang=r.language||r.srclang),r.default&&(o.default=r.default),r.id&&(o.id=r.id),r.src&&(o.src=r.src),o},e.addRemoteTextTrack=function(r,o){var s=n.prototype.addRemoteTextTrack.call(this,r,o);return this.featuresNativeTextTracks&&this.el().appendChild(s),s},e.removeRemoteTextTrack=function(r){if(n.prototype.removeRemoteTextTrack.call(this,r),this.featuresNativeTextTracks)for(var o=this.$$("track"),s=o.length;s--;)(r===o[s]||r===o[s].track)&&this.el().removeChild(o[s])},e.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var r={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(r.droppedVideoFrames=this.el().webkitDroppedFrameCount,r.totalVideoFrames=this.el().webkitDecodedFrameCount),K.performance&&typeof K.performance.now=="function"?r.creationTime=K.performance.now():K.performance&&K.performance.timing&&typeof K.performance.timing.navigationStart=="number"&&(r.creationTime=K.Date.now()-K.performance.timing.navigationStart),r},t}(qe);Yy(Nt,"TEST_VID",function(){if(Eu()){var n=Rt.createElement("video"),t=Rt.createElement("track");return t.kind="captions",t.srclang="en",t.label="English",n.appendChild(t),n}});Nt.isSupported=function(){try{Nt.TEST_VID.volume=.5}catch{return!1}return!!(Nt.TEST_VID&&Nt.TEST_VID.canPlayType)};Nt.canPlayType=function(n){return Nt.TEST_VID.canPlayType(n)};Nt.canPlaySource=function(n,t){return Nt.canPlayType(n.type)};Nt.canControlVolume=function(){try{var n=Nt.TEST_VID.volume;Nt.TEST_VID.volume=n/2+.1;var t=n!==Nt.TEST_VID.volume;return t&&Hr?(K.setTimeout(function(){Nt&&Nt.prototype&&(Nt.prototype.featuresVolumeControl=n!==Nt.TEST_VID.volume)}),!1):t}catch{return!1}};Nt.canMuteVolume=function(){try{var n=Nt.TEST_VID.muted;return Nt.TEST_VID.muted=!n,Nt.TEST_VID.muted?hu(Nt.TEST_VID,"muted","muted"):mm(Nt.TEST_VID,"muted","muted"),n!==Nt.TEST_VID.muted}catch{return!1}};Nt.canControlPlaybackRate=function(){if(ps&&ms&&RB<58)return!1;try{var n=Nt.TEST_VID.playbackRate;return Nt.TEST_VID.playbackRate=n/2+.1,n!==Nt.TEST_VID.playbackRate}catch{return!1}};Nt.canOverrideAttributes=function(){try{var n=function(){};Object.defineProperty(Rt.createElement("video"),"src",{get:n,set:n}),Object.defineProperty(Rt.createElement("audio"),"src",{get:n,set:n}),Object.defineProperty(Rt.createElement("video"),"innerHTML",{get:n,set:n}),Object.defineProperty(Rt.createElement("audio"),"innerHTML",{get:n,set:n})}catch{return!1}return!0};Nt.supportsNativeTextTracks=function(){return pm||Hr&&ms};Nt.supportsNativeVideoTracks=function(){return!!(Nt.TEST_VID&&Nt.TEST_VID.videoTracks)};Nt.supportsNativeAudioTracks=function(){return!!(Nt.TEST_VID&&Nt.TEST_VID.audioTracks)};Nt.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(n){var t=n[0],e=n[1];Yy(Nt.prototype,t,function(){return Nt[e]()},!0)});Nt.prototype.featuresVolumeControl=Nt.canControlVolume();Nt.prototype.movingMediaElementInDOM=!Hr;Nt.prototype.featuresFullscreenResize=!0;Nt.prototype.featuresProgressEvents=!0;Nt.prototype.featuresTimeupdateEvents=!0;Nt.prototype.featuresVideoFrameCallback=!!(Nt.TEST_VID&&Nt.TEST_VID.requestVideoFrameCallback);var Xf;Nt.patchCanPlayType=function(){yy>=4&&!AB&&!ms&&(Xf=Nt.TEST_VID&&Nt.TEST_VID.constructor.prototype.canPlayType,Nt.TEST_VID.constructor.prototype.canPlayType=function(n){var t=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return n&&t.test(n)?"maybe":Xf.call(this,n)})};Nt.unpatchCanPlayType=function(){var n=Nt.TEST_VID.constructor.prototype.canPlayType;return Xf&&(Nt.TEST_VID.constructor.prototype.canPlayType=Xf),n};Nt.patchCanPlayType();Nt.disposeMediaElement=function(n){if(n){for(n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src"),typeof n.load=="function"&&function(){try{n.load()}catch{}}()}};Nt.resetMediaElement=function(n){if(n){for(var t=n.querySelectorAll("source"),e=t.length;e--;)n.removeChild(t[e]);n.removeAttribute("src"),typeof n.load=="function"&&function(){try{n.load()}catch{}}()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(n){Nt.prototype[n]=function(){return this.el_[n]||this.el_.hasAttribute(n)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(n){Nt.prototype["set"+Bi(n)]=function(t){this.el_[n]=t,t?this.el_.setAttribute(n,n):this.el_.removeAttribute(n)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(n){Nt.prototype[n]=function(){return this.el_[n]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(n){Nt.prototype["set"+Bi(n)]=function(t){this.el_[n]=t}});["pause","load","play"].forEach(function(n){Nt.prototype[n]=function(){return this.el_[n]()}});qe.withSourceHandlers(Nt);Nt.nativeSourceHandler={};Nt.nativeSourceHandler.canPlayType=function(n){try{return Nt.TEST_VID.canPlayType(n)}catch{return""}};Nt.nativeSourceHandler.canHandleSource=function(n,t){if(n.type)return Nt.nativeSourceHandler.canPlayType(n.type);if(n.src){var e=Py(n.src);return Nt.nativeSourceHandler.canPlayType("video/"+e)}return""};Nt.nativeSourceHandler.handleSource=function(n,t,e){t.setSrc(n.src)};Nt.nativeSourceHandler.dispose=function(){};Nt.registerSourceHandler(Nt.nativeSourceHandler);qe.registerTech("Html5",Nt);var AP=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Y0={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},a_=["tiny","xsmall","small","medium","large","xlarge","huge"],xf={};a_.forEach(function(n){var t=n.charAt(0)==="x"?"x-"+n.substring(1):n;xf[n]="vjs-layout-"+t});var PN={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Oi=function(n){kt(t,n);function t(i,r,o){var s;if(i.id=i.id||r.id||"vjs_video_"+vs(),r=pi(t.getTagSettings(i),r),r.initChildren=!1,r.createEl=!1,r.evented=!1,r.reportTouchActivity=!1,!r.language)if(typeof i.closest=="function"){var a=i.closest("[lang]");a&&a.getAttribute&&(r.language=a.getAttribute("lang"))}else for(var l=i;l&&l.nodeType===1;){if(Qo(l).hasOwnProperty("lang")){r.language=l.getAttribute("lang");break}l=l.parentNode}if(s=n.call(this,null,r,o)||this,s.boundDocumentFullscreenChange_=function(c){return s.documentFullscreenChange_(c)},s.boundFullWindowOnEscKey_=function(c){return s.fullWindowOnEscKey(c)},s.boundUpdateStyleEl_=function(c){return s.updateStyleEl_(c)},s.boundApplyInitTime_=function(c){return s.applyInitTime_(c)},s.boundUpdateCurrentBreakpoint_=function(c){return s.updateCurrentBreakpoint_(c)},s.boundHandleTechClick_=function(c){return s.handleTechClick_(c)},s.boundHandleTechDoubleClick_=function(c){return s.handleTechDoubleClick_(c)},s.boundHandleTechTouchStart_=function(c){return s.handleTechTouchStart_(c)},s.boundHandleTechTouchMove_=function(c){return s.handleTechTouchMove_(c)},s.boundHandleTechTouchEnd_=function(c){return s.handleTechTouchEnd_(c)},s.boundHandleTechTap_=function(c){return s.handleTechTap_(c)},s.isFullscreen_=!1,s.log=wB(s.id_),s.fsApi_=Vf,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,s.debugEnabled_=!1,s.audioOnlyMode_=!1,s.audioPosterMode_=!1,s.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=i,s.tagAttributes=i&&Qo(i),s.language(s.options_.language),r.languages){var u={};Object.getOwnPropertyNames(r.languages).forEach(function(c){u[c.toLowerCase()]=r.languages[c]}),s.languages_=u}else s.languages_=t.prototype.options_.languages;s.resetCache_(),s.poster_=r.poster||"",s.controls_=!!r.controls,i.controls=!1,i.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],i.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),r.plugins&&Object.keys(r.plugins).forEach(function(c){if(typeof s[c]!="function")throw new Error('plugin "'+c+'" does not exist')}),s.scrubbing_=!1,s.el_=s.createEl(),Ey(he(s),{eventBusKey:"el_"}),s.fsApi_.requestFullscreen&&(fn(Rt,s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_),s.on(s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_)),s.fluid_&&s.on(["playerreset","resize"],s.boundUpdateStyleEl_);var h=ii(s.options_);r.plugins&&Object.keys(r.plugins).forEach(function(c){s[c](r.plugins[c])}),r.debug&&s.debug(!0),s.options_.playerOptions=h,s.middleware_=[],s.playbackRates(r.playbackRates),s.initChildren(),s.isAudio(i.nodeName.toLowerCase()==="audio"),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),uu&&s.addClass("vjs-touch-enabled"),Hr||s.addClass("vjs-workinghover"),t.players[s.id_]=he(s);var d=_B.split(".")[0];return s.addClass("vjs-v"+d),s.userActive(!0),s.reportUserActivity(),s.one("play",function(c){return s.listenForUserActivity_(c)}),s.on("stageclick",function(c){return s.handleStageClick_(c)}),s.on("keydown",function(c){return s.handleKeyDown(c)}),s.on("languagechange",function(c){return s.handleLanguagechange(c)}),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s.on("ready",function(){s.audioPosterMode(s.options_.audioPosterMode),s.audioOnlyMode(s.options_.audioOnlyMode)}),s}var e=t.prototype;return e.dispose=function(){var r=this;this.trigger("dispose"),this.off("dispose"),mr(Rt,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),mr(Rt,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),t.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Zz(this),Br.names.forEach(function(o){var s=Br[o],a=r[s.getterName]();a&&a.off&&a.off()}),n.prototype.dispose.call(this,{restoreEl:this.options_.restoreEl})},e.createEl=function(){var r=this.tag,o,s=this.playerElIngest_=r.parentNode&&r.parentNode.hasAttribute&&r.parentNode.hasAttribute("data-vjs-player"),a=this.tag.tagName.toLowerCase()==="video-js";s?o=this.el_=r.parentNode:a||(o=this.el_=n.prototype.createEl.call(this,"div"));var l=Qo(r);if(a){for(o=this.el_=r,r=this.tag=Rt.createElement("video");o.children.length;)r.appendChild(o.firstChild);za(o,"video-js")||ns(o,"video-js"),o.appendChild(r),s=this.playerElIngest_=o,Object.keys(o).forEach(function(g){try{r[g]=o[g]}catch{}})}if(r.setAttribute("tabindex","-1"),l.tabindex="-1",(Hd||ms&&EB)&&(r.setAttribute("role","application"),l.role="application"),r.removeAttribute("width"),r.removeAttribute("height"),"width"in l&&delete l.width,"height"in l&&delete l.height,Object.getOwnPropertyNames(l).forEach(function(g){a&&g==="class"||o.setAttribute(g,l[g]),a&&r.setAttribute(g,l[g])}),r.playerId=r.id,r.id+="_html5_api",r.className="vjs-tech",r.player=o.player=this,this.addClass("vjs-paused"),K.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=VB("vjs-styles-dimensions");var u=Vs(".vjs-styles-defaults"),h=Vs("head");h.insertBefore(this.styleEl_,u?u.nextSibling:h.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var d=r.getElementsByTagName("a"),c=0;c<d.length;c++){var f=d.item(c);ns(f,"vjs-hidden"),f.setAttribute("hidden","hidden")}return r.initNetworkState_=r.networkState,r.parentNode&&!s&&r.parentNode.insertBefore(o,r),Jb(r,o),this.children_.unshift(r),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=o,o},e.crossOrigin=function(r){if(!r)return this.techGet_("crossOrigin");if(r!=="anonymous"&&r!=="use-credentials"){_e.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+r+'"');return}this.techCall_("setCrossOrigin",r)},e.width=function(r){return this.dimension("width",r)},e.height=function(r){return this.dimension("height",r)},e.dimension=function(r,o){var s=r+"_";if(o===void 0)return this[s]||0;if(o===""||o==="auto"){this[s]=void 0,this.updateStyleEl_();return}var a=parseFloat(o);if(isNaN(a)){_e.error('Improper value "'+o+'" supplied for for '+r);return}this[s]=a,this.updateStyleEl_()},e.fluid=function(r){var o=this;if(r===void 0)return!!this.fluid_;this.fluid_=!!r,os(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),r?(this.addClass("vjs-fluid"),this.fill(!1),wz(this,function(){o.on(["playerreset","resize"],o.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},e.fill=function(r){if(r===void 0)return!!this.fill_;this.fill_=!!r,r?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},e.aspectRatio=function(r){if(r===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(r))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=r,this.fluid(!0),this.updateStyleEl_()},e.updateStyleEl_=function(){if(K.VIDEOJS_NO_DYNAMIC_STYLE===!0){var r=typeof this.width_=="number"?this.width_:this.options_.width,o=typeof this.height_=="number"?this.height_:this.options_.height,s=this.tech_&&this.tech_.el();s&&(r>=0&&(s.width=r),o>=0&&(s.height=o));return}var a,l,u,h;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?u=this.aspectRatio_:this.videoWidth()>0?u=this.videoWidth()+":"+this.videoHeight():u="16:9";var d=u.split(":"),c=d[1]/d[0];this.width_!==void 0?a=this.width_:this.height_!==void 0?a=this.height_/c:a=this.videoWidth()||300,this.height_!==void 0?l=this.height_:l=a*c,/^[^a-zA-Z]/.test(this.id())?h="dimensions-"+this.id():h=this.id()+"-dimensions",this.addClass(h),jB(this.styleEl_,`
      .`+h+` {
        width: `+a+`px;
        height: `+l+`px;
      }

      .`+h+`.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: `+c*100+`%;
      }
    `)},e.loadTech_=function(r,o){var s=this;this.tech_&&this.unloadTech_();var a=Bi(r),l=r.charAt(0).toLowerCase()+r.slice(1);a!=="Html5"&&this.tag&&(qe.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=a,this.isReady_=!1;var u=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(u=!1);var h={source:o,autoplay:u,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+l+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Br.names.forEach(function(c){var f=Br[c];h[f.getterName]=s[f.privateName]}),pi(h,this.options_[a]),pi(h,this.options_[l]),pi(h,this.options_[r.toLowerCase()]),this.tag&&(h.tag=this.tag),o&&o.src===this.cache_.src&&this.cache_.currentTime>0&&(h.startTime=this.cache_.currentTime);var d=qe.getTech(r);if(!d)throw new Error("No Tech named '"+a+"' exists! '"+a+"' should be registered using videojs.registerTech()'");this.tech_=new d(h),this.tech_.ready(ni(this,this.handleTechReady_),!0),HS.jsonToTextTracks(this.textTracksJson_||[],this.tech_),AP.forEach(function(c){s.on(s.tech_,c,function(f){return s["handleTech"+Bi(c)+"_"](f)})}),Object.keys(Y0).forEach(function(c){s.on(s.tech_,c,function(f){if(s.tech_.playbackRate()===0&&s.tech_.seeking()){s.queuedCallbacks_.push({callback:s["handleTech"+Y0[c]+"_"].bind(s),event:f});return}s["handleTech"+Y0[c]+"_"](f)})}),this.on(this.tech_,"loadstart",function(c){return s.handleTechLoadStart_(c)}),this.on(this.tech_,"sourceset",function(c){return s.handleTechSourceset_(c)}),this.on(this.tech_,"waiting",function(c){return s.handleTechWaiting_(c)}),this.on(this.tech_,"ended",function(c){return s.handleTechEnded_(c)}),this.on(this.tech_,"seeking",function(c){return s.handleTechSeeking_(c)}),this.on(this.tech_,"play",function(c){return s.handleTechPlay_(c)}),this.on(this.tech_,"firstplay",function(c){return s.handleTechFirstPlay_(c)}),this.on(this.tech_,"pause",function(c){return s.handleTechPause_(c)}),this.on(this.tech_,"durationchange",function(c){return s.handleTechDurationChange_(c)}),this.on(this.tech_,"fullscreenchange",function(c,f){return s.handleTechFullscreenChange_(c,f)}),this.on(this.tech_,"fullscreenerror",function(c,f){return s.handleTechFullscreenError_(c,f)}),this.on(this.tech_,"enterpictureinpicture",function(c){return s.handleTechEnterPictureInPicture_(c)}),this.on(this.tech_,"leavepictureinpicture",function(c){return s.handleTechLeavePictureInPicture_(c)}),this.on(this.tech_,"error",function(c){return s.handleTechError_(c)}),this.on(this.tech_,"posterchange",function(c){return s.handleTechPosterChange_(c)}),this.on(this.tech_,"textdata",function(c){return s.handleTechTextData_(c)}),this.on(this.tech_,"ratechange",function(c){return s.handleTechRateChange_(c)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(a!=="Html5"||!this.tag)&&Jb(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.unloadTech_=function(){var r=this;Br.names.forEach(function(o){var s=Br[o];r[s.privateName]=r[s.getterName]()}),this.textTracksJson_=HS.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},e.tech=function(r){return r===void 0&&_e.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_},e.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},e.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},e.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},e.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())},e.manualAutoplay_=function(r){var o=this;if(!(!this.tech_||typeof r!="string")){var s=function(){var u=o.muted();o.muted(!0);var h=function(){o.muted(u)};o.playTerminatedQueue_.push(h);var d=o.play();if(Ih(d))return d.catch(function(c){throw h(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(c||""))})},a;if(r==="any"&&!this.muted()?(a=this.play(),Ih(a)&&(a=a.catch(s))):r==="muted"&&!this.muted()?a=s():a=this.play(),!!Ih(a))return a.then(function(){o.trigger({type:"autoplay-success",autoplay:r})}).catch(function(){o.trigger({type:"autoplay-failure",autoplay:r})})}},e.updateSourceCaches_=function(r){r===void 0&&(r="");var o=r,s="";typeof o!="string"&&(o=r.src,s=r.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],o&&!s&&(s=tN(this,o)),this.cache_.source=ii({},r,{src:o,type:s});for(var a=this.cache_.sources.filter(function(f){return f.src&&f.src===o}),l=[],u=this.$$("source"),h=[],d=0;d<u.length;d++){var c=Qo(u[d]);l.push(c),c.src&&c.src===o&&h.push(c.src)}h.length&&!a.length?this.cache_.sources=l:a.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=o},e.handleTechSourceset_=function(r){var o=this;if(!this.changingSrc_){var s=function(h){return o.updateSourceCaches_(h)},a=this.currentSource().src,l=r.src;a&&!/^blob:/.test(a)&&/^blob:/.test(l)&&(!this.lastSource_||this.lastSource_.tech!==l&&this.lastSource_.player!==a)&&(s=function(){}),s(l),r.src||this.tech_.any(["sourceset","loadstart"],function(u){if(u.type!=="sourceset"){var h=o.techGet("currentSrc");o.lastSource_.tech=h,o.updateSourceCaches_(h)}})}this.lastSource_={player:this.currentSource().src,tech:r.src},this.trigger({src:r.src,type:"sourceset"})},e.hasStarted=function(r){if(r===void 0)return this.hasStarted_;r!==this.hasStarted_&&(this.hasStarted_=r,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},e.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(r){return r.callback(r.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},e.handleTechWaiting_=function(){var r=this;this.addClass("vjs-waiting"),this.trigger("waiting");var o=this.currentTime(),s=function a(){o!==r.currentTime()&&(r.removeClass("vjs-waiting"),r.off("timeupdate",a))};this.on("timeupdate",s)},e.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},e.handleTechFirstPlay_=function(){this.options_.starttime&&(_e.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.handleTechEnded_=function(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.handleTechClick_=function(r){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,r):this.paused()?xo(this.play()):this.pause())},e.handleTechDoubleClick_=function(r){if(this.controls_){var o=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(s){return s.contains(r.target)});o||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,r):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},e.handleTechTap_=function(){this.userActive(!this.userActive())},e.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.handleTechTouchEnd_=function(r){r.cancelable&&r.preventDefault()},e.handleStageClick_=function(){this.reportUserActivity()},e.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.documentFullscreenChange_=function(r){var o=r.target.player;if(!(o&&o!==this)){var s=this.el(),a=Rt[this.fsApi_.fullscreenElement]===s;!a&&s.matches?a=s.matches(":"+this.fsApi_.fullscreen):!a&&s.msMatchesSelector&&(a=s.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(a)}},e.handleTechFullscreenChange_=function(r,o){var s=this;o&&(o.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",function(){s.removeClass("vjs-ios-native-fs")})),this.isFullscreen(o.isFullscreen))},e.handleTechFullscreenError_=function(r,o){this.trigger("fullscreenerror",o)},e.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},e.handleTechEnterPictureInPicture_=function(r){this.isInPictureInPicture(!0)},e.handleTechLeavePictureInPicture_=function(r){this.isInPictureInPicture(!1)},e.handleTechError_=function(){var r=this.tech_.error();this.error(r)},e.handleTechTextData_=function(){var r=null;arguments.length>1&&(r=arguments[1]),this.trigger("textdata",r)},e.getCache=function(){return this.cache_},e.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},e.techCall_=function(r,o){this.ready(function(){if(r in Yz)return qz(this.middleware_,this.tech_,r,o);if(r in jS)return VS(this.middleware_,this.tech_,r,o);try{this.tech_&&this.tech_[r](o)}catch(s){throw _e(s),s}},!0)},e.techGet_=function(r){if(!(!this.tech_||!this.tech_.isReady_)){if(r in Xz)return $z(this.middleware_,this.tech_,r);if(r in jS)return VS(this.middleware_,this.tech_,r);try{return this.tech_[r]()}catch(o){throw this.tech_[r]===void 0?(_e("Video.js: "+r+" method not defined for "+this.techName_+" playback technology.",o),o):o.name==="TypeError"?(_e("Video.js: "+r+" unavailable on "+this.techName_+" playback technology element.",o),this.tech_.isReady_=!1,o):(_e(o),o)}}},e.play=function(){var r=this,o=this.options_.Promise||K.Promise;return o?new o(function(s){r.play_(s)}):this.play_()},e.play_=function(r){var o=this;r===void 0&&(r=xo),this.playCallbacks_.push(r);var s=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),a=!!(pm||Hr);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!s){this.waitToPlay_=function(h){o.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!s&&a&&this.load();return}var l=this.techGet_("play"),u=a&&this.hasClass("vjs-ended");u&&this.resetProgressBar_(),l===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(l)},e.runPlayTerminatedQueue_=function(){var r=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],r.forEach(function(o){o()})},e.runPlayCallbacks_=function(r){var o=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],o.forEach(function(s){s(r)})},e.pause=function(){this.techCall_("pause")},e.paused=function(){return this.techGet_("paused")!==!1},e.played=function(){return this.techGet_("played")||Na(0,0)},e.scrubbing=function(r){if(typeof r>"u")return this.scrubbing_;this.scrubbing_=!!r,this.techCall_("setScrubbing",this.scrubbing_),r?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},e.currentTime=function(r){if(typeof r<"u"){if(r<0&&(r=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=r,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",r),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},e.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},e.duration=function(r){if(r===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;r=parseFloat(r),r<0&&(r=1/0),r!==this.cache_.duration&&(this.cache_.duration=r,r===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(r)||this.trigger("durationchange"))},e.remainingTime=function(){return this.duration()-this.currentTime()},e.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},e.buffered=function(){var r=this.techGet_("buffered");return(!r||!r.length)&&(r=Na(0,0)),r},e.bufferedPercent=function(){return KB(this.buffered(),this.duration())},e.bufferedEnd=function(){var r=this.buffered(),o=this.duration(),s=r.end(r.length-1);return s>o&&(s=o),s},e.volume=function(r){var o;if(r!==void 0){o=Math.max(0,Math.min(1,parseFloat(r))),this.cache_.volume=o,this.techCall_("setVolume",o),o>0&&this.lastVolume_(o);return}return o=parseFloat(this.techGet_("volume")),isNaN(o)?1:o},e.muted=function(r){if(r!==void 0){this.techCall_("setMuted",r);return}return this.techGet_("muted")||!1},e.defaultMuted=function(r){return r!==void 0?this.techCall_("setDefaultMuted",r):this.techGet_("defaultMuted")||!1},e.lastVolume_=function(r){if(r!==void 0&&r!==0){this.cache_.lastVolume=r;return}return this.cache_.lastVolume},e.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.isFullscreen=function(r){if(r!==void 0){var o=this.isFullscreen_;this.isFullscreen_=!!r,this.isFullscreen_!==o&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_},e.requestFullscreen=function(r){var o=this.options_.Promise||K.Promise;if(o){var s=this;return new o(function(a,l){function u(){s.off("fullscreenerror",d),s.off("fullscreenchange",h)}function h(){u(),a()}function d(f,g){u(),l(g)}s.one("fullscreenchange",h),s.one("fullscreenerror",d);var c=s.requestFullscreenHelper_(r);c&&(c.then(u,u),c.then(a,l))})}return this.requestFullscreenHelper_()},e.requestFullscreenHelper_=function(r){var o=this,s;if(this.fsApi_.prefixed||(s=this.options_.fullscreen&&this.options_.fullscreen.options||{},r!==void 0&&(s=r)),this.fsApi_.requestFullscreen){var a=this.el_[this.fsApi_.requestFullscreen](s);return a&&a.then(function(){return o.isFullscreen(!0)},function(){return o.isFullscreen(!1)}),a}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},e.exitFullscreen=function(){var r=this.options_.Promise||K.Promise;if(r){var o=this;return new r(function(s,a){function l(){o.off("fullscreenerror",h),o.off("fullscreenchange",u)}function u(){l(),s()}function h(c,f){l(),a(f)}o.one("fullscreenchange",u),o.one("fullscreenerror",h);var d=o.exitFullscreenHelper_();d&&(d.then(l,l),d.then(s,a))})}return this.exitFullscreenHelper_()},e.exitFullscreenHelper_=function(){var r=this;if(this.fsApi_.requestFullscreen){var o=Rt[this.fsApi_.exitFullscreen]();return o&&xo(o.then(function(){return r.isFullscreen(!1)})),o}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},e.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=Rt.documentElement.style.overflow,fn(Rt,"keydown",this.boundFullWindowOnEscKey_),Rt.documentElement.style.overflow="hidden",ns(Rt.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.fullWindowOnEscKey=function(r){fe.isEventKey(r,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},e.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,mr(Rt,"keydown",this.boundFullWindowOnEscKey_),Rt.documentElement.style.overflow=this.docOrigOverflow,zd(Rt.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.disablePictureInPicture=function(r){if(r===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",r),this.options_.disablePictureInPicture=r,this.trigger("disablepictureinpicturechanged")},e.isInPictureInPicture=function(r){if(r!==void 0){this.isInPictureInPicture_=!!r,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_},e.requestPictureInPicture=function(){if("pictureInPictureEnabled"in Rt&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")},e.exitPictureInPicture=function(){if("pictureInPictureEnabled"in Rt)return Rt.exitPictureInPicture()},e.handleKeyDown=function(r){var o=this.options_.userActions;if(!(!o||!o.hotkeys)){var s=function(l){var u=l.tagName.toLowerCase();if(l.isContentEditable)return!0;var h=["button","checkbox","hidden","radio","reset","submit"];if(u==="input")return h.indexOf(l.type)===-1;var d=["textarea"];return d.indexOf(u)!==-1};s(this.el_.ownerDocument.activeElement)||(typeof o.hotkeys=="function"?o.hotkeys.call(this,r):this.handleHotkeys(r))}},e.handleHotkeys=function(r){var o=this.options_.userActions?this.options_.userActions.hotkeys:{},s=o.fullscreenKey,a=s===void 0?function(m){return fe.isEventKey(m,"f")}:s,l=o.muteKey,u=l===void 0?function(m){return fe.isEventKey(m,"m")}:l,h=o.playPauseKey,d=h===void 0?function(m){return fe.isEventKey(m,"k")||fe.isEventKey(m,"Space")}:h;if(a.call(this,r)){r.preventDefault(),r.stopPropagation();var c=Ct.getComponent("FullscreenToggle");Rt[this.fsApi_.fullscreenEnabled]!==!1&&c.prototype.handleClick.call(this,r)}else if(u.call(this,r)){r.preventDefault(),r.stopPropagation();var f=Ct.getComponent("MuteToggle");f.prototype.handleClick.call(this,r)}else if(d.call(this,r)){r.preventDefault(),r.stopPropagation();var g=Ct.getComponent("PlayToggle");g.prototype.handleClick.call(this,r)}},e.canPlayType=function(r){for(var o,s=0,a=this.options_.techOrder;s<a.length;s++){var l=a[s],u=qe.getTech(l);if(u||(u=Ct.getComponent(l)),!u){_e.error('The "'+l+'" tech is undefined. Skipped browser support check for that tech.');continue}if(u.isSupported()&&(o=u.canPlayType(r),o))return o}return""},e.selectSource=function(r){var o=this,s=this.options_.techOrder.map(function(d){return[d,qe.getTech(d)]}).filter(function(d){var c=d[0],f=d[1];return f?f.isSupported():(_e.error('The "'+c+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),a=function(c,f,g){var m;return c.some(function(p){return f.some(function(v){if(m=g(p,v),m)return!0})}),m},l,u=function(c){return function(f,g){return c(g,f)}},h=function(c,f){var g=c[0],m=c[1];if(m.canPlaySource(f,o.options_[g.toLowerCase()]))return{source:f,tech:g}};return this.options_.sourceOrder?l=a(r,s,u(h)):l=a(s,r,h),l||!1},e.handleSrc_=function(r,o){var s=this;if(typeof r>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var a=eN(r);if(!a.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,o||(this.cache_.sources=a),this.updateSourceCaches_(a[0]),jz(this,a[0],function(h,d){s.middleware_=d,o||(s.cache_.sources=a),s.updateSourceCaches_(h);var c=s.src_(h);if(c){if(a.length>1)return s.handleSrc_(a.slice(1));s.changingSrc_=!1,s.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),s.triggerReady();return}Gz(d,s.tech_)}),this.options_.retryOnError&&a.length>1){var l=function(){s.error(null),s.handleSrc_(a.slice(1),!0)},u=function(){s.off("error",l)};this.one("error",l),this.one("playing",u),this.resetRetryOnError_=function(){s.off("error",l),s.off("playing",u)}}},e.src=function(r){return this.handleSrc_(r,!1)},e.src_=function(r){var o=this,s=this.selectSource([r]);return s?Tz(s.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",r):this.techCall_("src",r.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(s.tech,s.source),this.tech_.ready(function(){o.changingSrc_=!1}),!1):!0},e.load=function(){this.techCall_("load")},e.reset=function(){var r=this,o=this.options_.Promise||K.Promise;if(this.paused()||!o)this.doReset_();else{var s=this.play();xo(s.then(function(){return r.doReset_()}))}},e.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),os(this)&&this.trigger("playerreset")},e.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},e.resetProgressBar_=function(){this.currentTime(0);var r=this.controlBar||{},o=r.durationDisplay,s=r.remainingTimeDisplay;o&&o.updateContent(),s&&s.updateContent()},e.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},e.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},e.currentSources=function(){var r=this.currentSource(),o=[];return Object.keys(r).length!==0&&o.push(r),this.cache_.sources||o},e.currentSource=function(){return this.cache_.source||{}},e.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},e.currentType=function(){return this.currentSource()&&this.currentSource().type||""},e.preload=function(r){if(r!==void 0){this.techCall_("setPreload",r),this.options_.preload=r;return}return this.techGet_("preload")},e.autoplay=function(r){if(r===void 0)return this.options_.autoplay||!1;var o;typeof r=="string"&&/(any|play|muted)/.test(r)||r===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=r,this.manualAutoplay_(typeof r=="string"?r:"play"),o=!1):r?this.options_.autoplay=!0:this.options_.autoplay=!1,o=typeof o>"u"?this.options_.autoplay:o,this.tech_&&this.techCall_("setAutoplay",o)},e.playsinline=function(r){return r!==void 0?(this.techCall_("setPlaysinline",r),this.options_.playsinline=r,this):this.techGet_("playsinline")},e.loop=function(r){if(r!==void 0){this.techCall_("setLoop",r),this.options_.loop=r;return}return this.techGet_("loop")},e.poster=function(r){if(r===void 0)return this.poster_;r||(r=""),r!==this.poster_&&(this.poster_=r,this.techCall_("setPoster",r),this.isPosterFromTech_=!1,this.trigger("posterchange"))},e.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var r=this.tech_.poster()||"";r!==this.poster_&&(this.poster_=r,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},e.controls=function(r){if(r===void 0)return!!this.controls_;r=!!r,this.controls_!==r&&(this.controls_=r,this.usingNativeControls()&&this.techCall_("setControls",r),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},e.usingNativeControls=function(r){if(r===void 0)return!!this.usingNativeControls_;r=!!r,this.usingNativeControls_!==r&&(this.usingNativeControls_=r,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},e.error=function(r){var o=this;if(r===void 0)return this.error_||null;if(Us("beforeerror").forEach(function(a){var l=a(o,r);if(!(hs(l)&&!Array.isArray(l)||typeof l=="string"||typeof l=="number"||l===null)){o.log.error("please return a value that MediaError expects in beforeerror hooks");return}r=l}),this.options_.suppressNotSupportedError&&r&&r.code===4){var s=function(){this.error(r)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],s),this.one("loadstart",function(){this.off(["click","touchstart"],s)});return}if(r===null){this.error_=r,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Lr(r),this.addClass("vjs-error"),_e.error("(CODE:"+this.error_.code+" "+Lr.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),Us("error").forEach(function(a){return a(o,o.error_)})},e.reportUserActivity=function(r){this.userActivity_=!0},e.userActive=function(r){if(r===void 0)return this.userActive_;if(r=!!r,r!==this.userActive_){if(this.userActive_=r,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(o){o.stopPropagation(),o.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},e.listenForUserActivity_=function(){var r,o,s,a=ni(this,this.reportUserActivity),l=function(g){(g.screenX!==o||g.screenY!==s)&&(o=g.screenX,s=g.screenY,a())},u=function(){a(),this.clearInterval(r),r=this.setInterval(a,250)},h=function(g){a(),this.clearInterval(r)};this.on("mousedown",u),this.on("mousemove",l),this.on("mouseup",h),this.on("mouseleave",h);var d=this.getChild("controlBar");d&&!Hr&&!ps&&(d.on("mouseenter",function(f){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),d.on("mouseleave",function(f){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",a),this.on("keyup",a);var c;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(c);var f=this.options_.inactivityTimeout;f<=0||(c=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},f))}},250)},e.playbackRate=function(r){if(r!==void 0){this.techCall_("setPlaybackRate",r);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},e.defaultPlaybackRate=function(r){return r!==void 0?this.techCall_("setDefaultPlaybackRate",r):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},e.isAudio=function(r){if(r!==void 0){this.isAudio_=!!r;return}return!!this.isAudio_},e.enableAudioOnlyUI_=function(){var r=this;this.addClass("vjs-audio-only-mode");var o=this.children(),s=this.getChild("ControlBar"),a=s&&s.currentHeight();o.forEach(function(l){l!==s&&l.el_&&!l.hasClass("vjs-hidden")&&(l.hide(),r.audioOnlyCache_.hiddenChildren.push(l))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(a),this.trigger("audioonlymodechange")},e.disableAudioOnlyUI_=function(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(function(r){return r.show()}),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")},e.audioOnlyMode=function(r){var o=this;if(typeof r!="boolean"||r===this.audioOnlyMode_)return this.audioOnlyMode_;this.audioOnlyMode_=r;var s=this.options_.Promise||K.Promise;if(s){if(r){var a=[];return this.isInPictureInPicture()&&a.push(this.exitPictureInPicture()),this.isFullscreen()&&a.push(this.exitFullscreen()),this.audioPosterMode()&&a.push(this.audioPosterMode(!1)),s.all(a).then(function(){return o.enableAudioOnlyUI_()})}return s.resolve().then(function(){return o.disableAudioOnlyUI_()})}r?(this.isInPictureInPicture()&&this.exitPictureInPicture(),this.isFullscreen()&&this.exitFullscreen(),this.enableAudioOnlyUI_()):this.disableAudioOnlyUI_()},e.enablePosterModeUI_=function(){var r=this.tech_&&this.tech_;r.hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},e.disablePosterModeUI_=function(){var r=this.tech_&&this.tech_;r.show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},e.audioPosterMode=function(r){var o=this;if(typeof r!="boolean"||r===this.audioPosterMode_)return this.audioPosterMode_;this.audioPosterMode_=r;var s=this.options_.Promise||K.Promise;if(s){if(r){if(this.audioOnlyMode()){var a=this.audioOnlyMode(!1);return a.then(function(){o.enablePosterModeUI_()})}return s.resolve().then(function(){o.enablePosterModeUI_()})}return s.resolve().then(function(){o.disablePosterModeUI_()})}if(r){this.audioOnlyMode()&&this.audioOnlyMode(!1),this.enablePosterModeUI_();return}this.disablePosterModeUI_()},e.addTextTrack=function(r,o,s){if(this.tech_)return this.tech_.addTextTrack(r,o,s)},e.addRemoteTextTrack=function(r,o){if(this.tech_)return this.tech_.addRemoteTextTrack(r,o)},e.removeRemoteTextTrack=function(r){r===void 0&&(r={});var o=r,s=o.track;if(s||(s=r),this.tech_)return this.tech_.removeRemoteTextTrack(s)},e.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},e.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.language=function(r){if(r===void 0)return this.language_;this.language_!==String(r).toLowerCase()&&(this.language_=String(r).toLowerCase(),os(this)&&this.trigger("languagechange"))},e.languages=function(){return ii(t.prototype.options_.languages,this.languages_)},e.toJSON=function(){var r=ii(this.options_),o=r.tracks;r.tracks=[];for(var s=0;s<o.length;s++){var a=o[s];a=ii(a),a.player=void 0,r.tracks[s]=a}return r},e.createModal=function(r,o){var s=this;o=o||{},o.content=r||"";var a=new Pu(this,o);return this.addChild(a),a.on("dispose",function(){s.removeChild(a)}),a.open(),a},e.updateCurrentBreakpoint_=function(){if(this.responsive())for(var r=this.currentBreakpoint(),o=this.currentWidth(),s=0;s<a_.length;s++){var a=a_[s],l=this.breakpoints_[a];if(o<=l){if(r===a)return;r&&this.removeClass(xf[r]),this.addClass(xf[a]),this.breakpoint_=a;break}}},e.removeCurrentBreakpoint_=function(){var r=this.currentBreakpointClass();this.breakpoint_="",r&&this.removeClass(r)},e.breakpoints=function(r){return r===void 0?pi(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=pi({},PN,r),this.updateCurrentBreakpoint_(),pi(this.breakpoints_))},e.responsive=function(r){if(r===void 0)return this.responsive_;r=!!r;var o=this.responsive_;if(r!==o)return this.responsive_=r,r?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),r},e.currentBreakpoint=function(){return this.breakpoint_},e.currentBreakpointClass=function(){return xf[this.breakpoint_]||""},e.loadMedia=function(r,o){var s=this;if(!(!r||typeof r!="object")){this.reset(),this.cache_.media=ii(r);var a=this.cache_.media,l=a.artwork,u=a.poster,h=a.src,d=a.textTracks;!l&&u&&(this.cache_.media.artwork=[{src:u,type:$f(u)}]),h&&this.src(h),u&&this.poster(u),Array.isArray(d)&&d.forEach(function(c){return s.addRemoteTextTrack(c,!1)}),this.ready(o)}},e.getMedia=function(){if(!this.cache_.media){var r=this.poster(),o=this.currentSources(),s=Array.prototype.map.call(this.remoteTextTracks(),function(l){return{kind:l.kind,label:l.label,language:l.language,src:l.src}}),a={src:o,textTracks:s};return r&&(a.poster=r,a.artwork=[{src:a.poster,type:$f(a.poster)}]),a}return ii(this.cache_.media)},t.getTagSettings=function(r){var o={sources:[],tracks:[]},s=Qo(r),a=s["data-setup"];if(za(r,"vjs-fill")&&(s.fill=!0),za(r,"vjs-fluid")&&(s.fluid=!0),a!==null){var l=u3(a||"{}"),u=l[0],h=l[1];u&&_e.error(u),pi(s,h)}if(pi(o,s),r.hasChildNodes())for(var d=r.childNodes,c=0,f=d.length;c<f;c++){var g=d[c],m=g.nodeName.toLowerCase();m==="source"?o.sources.push(Qo(g)):m==="track"&&o.tracks.push(Qo(g))}return o},e.flexNotSupported_=function(){var r=Rt.createElement("i");return!("flexBasis"in r.style||"webkitFlexBasis"in r.style||"mozFlexBasis"in r.style||"msFlexBasis"in r.style||"msFlexOrder"in r.style)},e.debug=function(r){if(r===void 0)return this.debugEnabled_;r?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},e.playbackRates=function(r){if(r===void 0)return this.cache_.playbackRates;Array.isArray(r)&&r.every(function(o){return typeof o=="number"})&&(this.cache_.playbackRates=r,this.trigger("playbackrateschange"))},t}(Ct);Br.names.forEach(function(n){var t=Br[n];Oi.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}});Oi.prototype.crossorigin=Oi.prototype.crossOrigin;Oi.players={};var rh=K.navigator;Oi.prototype.options_={techOrder:qe.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:rh&&(rh.languages&&rh.languages[0]||rh.userLanguage||rh.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(n){Oi.prototype[n]=function(){return this.techGet_(n)}});AP.forEach(function(n){Oi.prototype["handleTech"+Bi(n)+"_"]=function(){return this.trigger(n)}});Ct.registerComponent("Player",Oi);var Yf="plugin",Wl="activePlugins_",Bl={},Kf=function(t){return Bl.hasOwnProperty(t)},Tf=function(t){return Kf(t)?Bl[t]:void 0},RP=function(t,e){t[Wl]=t[Wl]||{},t[Wl][e]=!0},Zf=function(t,e,i){var r=(i?"before":"")+"pluginsetup";t.trigger(r,e),t.trigger(r+":"+e.name,e)},kN=function(t,e){var i=function(){Zf(this,{name:t,plugin:e,instance:null},!0);var o=e.apply(this,arguments);return RP(this,t),Zf(this,{name:t,plugin:e,instance:o}),o};return Object.keys(e).forEach(function(r){i[r]=e[r]}),i},nx=function(t,e){return e.prototype.name=t,function(){Zf(this,{name:t,plugin:e,instance:null},!0);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];var s=nB(e,[this].concat(r));return this[t]=function(){return s},Zf(this,s.getEventHash()),s}},Mo=function(){function n(e){if(this.constructor===n)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Ey(this),delete this.trigger,YB(this,this.constructor.defaultState),RP(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}var t=n.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(i){return i===void 0&&(i={}),i.name=this.name,i.plugin=this.constructor,i.instance=this,i},t.trigger=function(i,r){return r===void 0&&(r={}),Bu(this.eventBusEl_,i,this.getEventHash(r))},t.handleStateChanged=function(i){},t.dispose=function(){var i=this.name,r=this.player;this.trigger("dispose"),this.off(),r.off("dispose",this.dispose),r[Wl][i]=!1,this.player=this.state=null,r[i]=nx(i,Bl[i])},n.isBasic=function(i){var r=typeof i=="string"?Tf(i):i;return typeof r=="function"&&!n.prototype.isPrototypeOf(r.prototype)},n.registerPlugin=function(i,r){if(typeof i!="string")throw new Error('Illegal plugin name, "'+i+'", must be a string, was '+typeof i+".");if(Kf(i))_e.warn('A plugin named "'+i+'" already exists. You may want to avoid re-registering plugins!');else if(Oi.prototype.hasOwnProperty(i))throw new Error('Illegal plugin name, "'+i+'", cannot share a name with an existing player method!');if(typeof r!="function")throw new Error('Illegal plugin for "'+i+'", must be a function, was '+typeof r+".");return Bl[i]=r,i!==Yf&&(n.isBasic(r)?Oi.prototype[i]=kN(i,r):Oi.prototype[i]=nx(i,r)),r},n.deregisterPlugin=function(i){if(i===Yf)throw new Error("Cannot de-register base plugin.");Kf(i)&&(delete Bl[i],delete Oi.prototype[i])},n.getPlugins=function(i){i===void 0&&(i=Object.keys(Bl));var r;return i.forEach(function(o){var s=Tf(o);s&&(r=r||{},r[o]=s)}),r},n.getPluginVersion=function(i){var r=Tf(i);return r&&r.VERSION||""},n}();Mo.getPlugin=Tf;Mo.BASE_PLUGIN_NAME=Yf;Mo.registerPlugin(Yf,Mo);Oi.prototype.usingPlugin=function(n){return!!this[Wl]&&this[Wl][n]===!0};Oi.prototype.hasPlugin=function(n){return!!Kf(n)};var ox=!1,LN=function(t,e){e===void 0&&(e={}),ox||(_e.warn("videojs.extend is deprecated as of Video.js 7.22.0 and will be removed in Video.js 8.0.0"),ox=!0);var i=function(){t.apply(this,arguments)},r={};typeof e=="object"?(e.constructor!==Object.prototype.constructor&&(i=e.constructor),r=e):typeof e=="function"&&(i=e),C3(i,t),t&&(i.super_=t);for(var o in r)r.hasOwnProperty(o)&&(i.prototype[o]=r[o]);return i},EP=function(t){return t.indexOf("#")===0?t.slice(1):t};function ot(n,t,e){var i=ot.getPlayer(n);if(i)return t&&_e.warn('Player "'+n+'" is already initialised. Options will not be applied.'),e&&i.ready(e),i;var r=typeof n=="string"?Vs("#"+EP(n)):n;if(!Mu(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!r.ownerDocument.defaultView||!r.ownerDocument.body.contains(r))&&_e.warn("The element supplied is not included in the DOM"),t=t||{},t.restoreEl===!0&&(t.restoreEl=(r.parentNode&&r.parentNode.hasAttribute("data-vjs-player")?r.parentNode:r).cloneNode(!0)),Us("beforesetup").forEach(function(s){var a=s(r,ii(t));if(!hs(a)||Array.isArray(a)){_e.error("please return an object in beforesetup hooks");return}t=ii(t,a)});var o=Ct.getComponent("Player");return i=new o(r,t,e),Us("setup").forEach(function(s){return s(i)}),i}ot.hooks_=es;ot.hooks=Us;ot.hook=sz;ot.hookOnce=az;ot.removeHook=CB;if(K.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Eu()){var kc=Vs(".vjs-styles-defaults");if(!kc){kc=VB("vjs-styles-defaults");var K0=Vs("head");K0&&K0.insertBefore(kc,K0.firstChild),jB(kc,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}e_(1,ot);ot.VERSION=_B;ot.options=Oi.prototype.options_;ot.getPlayers=function(){return Oi.players};ot.getPlayer=function(n){var t=Oi.players,e;if(typeof n=="string"){var i=EP(n),r=t[i];if(r)return r;e=Vs("#"+i)}else e=n;if(Mu(e)){var o=e,s=o.player,a=o.playerId;if(s||t[a])return s||t[a]}};ot.getAllPlayers=function(){return Object.keys(Oi.players).map(function(n){return Oi.players[n]}).filter(Boolean)};ot.players=Oi.players;ot.getComponent=Ct.getComponent;ot.registerComponent=function(n,t){qe.isTech(t)&&_e.warn("The "+n+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Ct.registerComponent.call(Ct,n,t)};ot.getTech=qe.getTech;ot.registerTech=qe.registerTech;ot.use=Vz;Object.defineProperty(ot,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(ot.middleware,"TERMINATOR",{value:Gf,writeable:!1,enumerable:!0});ot.browser=fz;ot.TOUCH_ENABLED=uu;ot.extend=LN;ot.mergeOptions=ii;ot.bind=ni;ot.registerPlugin=Mo.registerPlugin;ot.deregisterPlugin=Mo.deregisterPlugin;ot.plugin=function(n,t){return _e.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Mo.registerPlugin(n,t)};ot.getPlugins=Mo.getPlugins;ot.getPlugin=Mo.getPlugin;ot.getPluginVersion=Mo.getPluginVersion;ot.addLanguage=function(n,t){var e;return n=(""+n).toLowerCase(),ot.options.languages=ii(ot.options.languages,(e={},e[n]=t,e)),ot.options.languages[n]};ot.log=_e;ot.createLogger=wB;ot.createTimeRange=ot.createTimeRanges=Na;ot.formatTime=gu;ot.setFormatTime=lN;ot.resetFormatTime=uN;ot.parseUrl=By;ot.isCrossOrigin=ym;ot.EventTarget=Yi;ot.on=fn;ot.one=_m;ot.off=mr;ot.trigger=Bu;ot.xhr=iB;ot.TextTrack=Nd;ot.AudioTrack=JB;ot.VideoTrack=tP;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(n){ot[n]=function(){return _e.warn("videojs."+n+"() is deprecated; use videojs.dom."+n+"() instead"),WB[n].apply(null,arguments)}});ot.computedStyle=od;ot.dom=WB;ot.url=zz;ot.defineLazyProperty=Yy;ot.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});/*! @name @videojs/http-streaming @version 2.16.3 @license Apache-2.0 */var Gn=hm,Qf=function(t,e,i){return t&&i&&i.responseURL&&e!==i.responseURL?i.responseURL:e},oo=function(t){return ot.log.debug?ot.log.debug.bind(ot,"VHS:",t+" >"):function(){}},js=1/30,To=js*3,MP=function(t,e){var i=[],r;if(t&&t.length)for(r=0;r<t.length;r++)e(t.start(r),t.end(r))&&i.push([t.start(r),t.end(r)]);return ot.createTimeRanges(i)},Pl=function(t,e){return MP(t,function(i,r){return i-To<=e&&r+To>=e})},Lc=function(t,e){return MP(t,function(i){return i-js>=e})},DN=function(t){if(t.length<2)return ot.createTimeRanges();for(var e=[],i=1;i<t.length;i++){var r=t.end(i-1),o=t.start(i);e.push([r,o])}return ot.createTimeRanges(e)},IN=function(t,e){var i=null,r=null,o=0,s=[],a=[];if(!t||!t.length||!e||!e.length)return ot.createTimeRange();for(var l=t.length;l--;)s.push({time:t.start(l),type:"start"}),s.push({time:t.end(l),type:"end"});for(l=e.length;l--;)s.push({time:e.start(l),type:"start"}),s.push({time:e.end(l),type:"end"});for(s.sort(function(u,h){return u.time-h.time}),l=0;l<s.length;l++)s[l].type==="start"?(o++,o===2&&(i=s[l].time)):s[l].type==="end"&&(o--,o===1&&(r=s[l].time)),i!==null&&r!==null&&(a.push([i,r]),i=null,r=null);return ot.createTimeRanges(a)},BP=function(t){var e=[];if(!t||!t.length)return"";for(var i=0;i<t.length;i++)e.push(t.start(i)+" => "+t.end(i));return e.join(", ")},FN=function(t,e,i){i===void 0&&(i=1);var r=t.length?t.end(t.length-1):0;return(r-e)/i},Ba=function(t){for(var e=[],i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e},ON=function(t,e){if(t===e)return!1;if(!t&&e||!e&&t||t.length!==e.length)return!0;for(var i=0;i<t.length;i++)if(t.start(i)!==e.start(i)||t.end(i)!==e.end(i))return!0;return!1},sx=function(t){if(!(!t||!t.length||!t.end))return t.end(t.length-1)},Ky=function(t,e){var i=0;if(!t||!t.length)return i;for(var r=0;r<t.length;r++){var o=t.start(r),s=t.end(r);if(!(e>s)){if(e>o&&e<=s){i+=s-e;continue}i+=s-o}}return i},ax=ot.createTimeRange,Zy=function(t,e){if(!e.preload)return e.duration;var i=0;return(e.parts||[]).forEach(function(r){i+=r.duration}),(e.preloadHints||[]).forEach(function(r){r.type==="PART"&&(i+=t.partTargetDuration)}),i},l_=function(t){return(t.segments||[]).reduce(function(e,i,r){return i.parts?i.parts.forEach(function(o,s){e.push({duration:o.duration,segmentIndex:r,partIndex:s,part:o,segment:i})}):e.push({duration:i.duration,segmentIndex:r,partIndex:null,segment:i,part:null}),e},[])},PP=function(t){var e=t.segments&&t.segments.length&&t.segments[t.segments.length-1];return e&&e.parts||[]},kP=function(t){var e=t.preloadSegment;if(e){var i=e.parts,r=e.preloadHints,o=(r||[]).reduce(function(s,a){return s+(a.type==="PART"?1:0)},0);return o+=i&&i.length?i.length:0,o}},LP=function(t,e){if(e.endList)return 0;if(t&&t.suggestedPresentationDelay)return t.suggestedPresentationDelay;var i=PP(e).length>0;return i&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:i&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},HN=function(t,e){var i=0,r=e-t.mediaSequence,o=t.segments[r];if(o){if(typeof o.start<"u")return{result:o.start,precise:!0};if(typeof o.end<"u")return{result:o.end-o.duration,precise:!0}}for(;r--;){if(o=t.segments[r],typeof o.end<"u")return{result:i+o.end,precise:!0};if(i+=Zy(t,o),typeof o.start<"u")return{result:i+o.start,precise:!0}}return{result:i,precise:!1}},zN=function(t,e){for(var i=0,r,o=e-t.mediaSequence;o<t.segments.length;o++){if(r=t.segments[o],typeof r.start<"u")return{result:r.start-i,precise:!0};if(i+=Zy(t,r),typeof r.end<"u")return{result:r.end-i,precise:!0}}return{result:-1,precise:!1}},DP=function(t,e,i){if(typeof e>"u"&&(e=t.mediaSequence+t.segments.length),e<t.mediaSequence)return 0;var r=HN(t,e);if(r.precise)return r.result;var o=zN(t,e);return o.precise?o.result:r.result+i},IP=function(t,e,i){if(!t)return 0;if(typeof i!="number"&&(i=0),typeof e>"u"){if(t.totalDuration)return t.totalDuration;if(!t.endList)return K.Infinity}return DP(t,e,i)},Fh=function(t){var e=t.defaultDuration,i=t.durationList,r=t.startIndex,o=t.endIndex,s=0;if(r>o){var a=[o,r];r=a[0],o=a[1]}if(r<0){for(var l=r;l<Math.min(0,o);l++)s+=e;r=0}for(var u=r;u<o;u++)s+=i[u].duration;return s},FP=function(t,e,i,r){if(!t||!t.segments)return null;if(t.endList)return IP(t);if(e===null)return null;e=e||0;var o=DP(t,t.mediaSequence+t.segments.length,e);return i&&(r=typeof r=="number"?r:LP(null,t),o-=r),Math.max(0,o)},NN=function(t,e,i){var r=!0,o=e||0,s=FP(t,e,r,i);return s===null?ax():ax(o,s)},WN=function(t){for(var e=t.playlist,i=t.currentTime,r=t.startingSegmentIndex,o=t.startingPartIndex,s=t.startTime,a=t.experimentalExactManifestTimings,l=i-s,u=l_(e),h=0,d=0;d<u.length;d++){var c=u[d];if(r===c.segmentIndex&&!(typeof o=="number"&&typeof c.partIndex=="number"&&o!==c.partIndex)){h=d;break}}if(l<0){if(h>0)for(var f=h-1;f>=0;f--){var g=u[f];if(l+=g.duration,a){if(l<0)continue}else if(l+js<=0)continue;return{partIndex:g.partIndex,segmentIndex:g.segmentIndex,startTime:s-Fh({defaultDuration:e.targetDuration,durationList:u,startIndex:h,endIndex:f})}}return{partIndex:u[0]&&u[0].partIndex||null,segmentIndex:u[0]&&u[0].segmentIndex||0,startTime:i}}if(h<0){for(var m=h;m<0;m++)if(l-=e.targetDuration,l<0)return{partIndex:u[0]&&u[0].partIndex||null,segmentIndex:u[0]&&u[0].segmentIndex||0,startTime:i};h=0}for(var p=h;p<u.length;p++){var v=u[p];if(l-=v.duration,a){if(l>0)continue}else if(l-js>=0)continue;return{partIndex:v.partIndex,segmentIndex:v.segmentIndex,startTime:s+Fh({defaultDuration:e.targetDuration,durationList:u,startIndex:h,endIndex:p})}}return{segmentIndex:u[u.length-1].segmentIndex,partIndex:u[u.length-1].partIndex,startTime:i}},OP=function(t){return t.excludeUntil&&t.excludeUntil>Date.now()},Qy=function(t){return t.excludeUntil&&t.excludeUntil===1/0},Tm=function(t){var e=OP(t);return!t.disabled&&!e},UN=function(t){return t.disabled},VN=function(t){for(var e=0;e<t.segments.length;e++)if(t.segments[e].key)return!0;return!1},HP=function(t,e){return e.attributes&&e.attributes[t]},jN=function(t,e,i,r){if(r===void 0&&(r=0),!HP("BANDWIDTH",i))return NaN;var o=t*i.attributes.BANDWIDTH;return(o-r*8)/e},u_=function(t,e){if(t.playlists.length===1)return!0;var i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter(function(r){return Tm(r)?(r.attributes.BANDWIDTH||0)<i:!1}).length===0},Jy=function(t,e){return!t&&!e||!t&&e||t&&!e?!1:!!(t===e||t.id&&e.id&&t.id===e.id||t.resolvedUri&&e.resolvedUri&&t.resolvedUri===e.resolvedUri||t.uri&&e.uri&&t.uri===e.uri)},lx=function(t,e){var i=t&&t.mediaGroups&&t.mediaGroups.AUDIO||{},r=!1;for(var o in i){for(var s in i[o])if(r=e(i[o][s]),r)break;if(r)break}return!!r},Vd=function(t){if(!t||!t.playlists||!t.playlists.length){var e=lx(t,function(s){return s.playlists&&s.playlists.length||s.uri});return e}for(var i=function(a){var l=t.playlists[a],u=l.attributes&&l.attributes.CODECS;if(u&&u.split(",").every(function(d){return aB(d)}))return"continue";var h=lx(t,function(d){return Jy(l,d)});return h?"continue":{v:!1}},r=0;r<t.playlists.length;r++){var o=i(r);if(o!=="continue"&&typeof o=="object")return o.v}return!0},jr={liveEdgeDelay:LP,duration:IP,seekable:NN,getMediaInfoForTime:WN,isEnabled:Tm,isDisabled:UN,isBlacklisted:OP,isIncompatible:Qy,playlistEnd:FP,isAes:VN,hasAttribute:HP,estimateSegmentRequestTime:jN,isLowestEnabledRendition:u_,isAudioOnly:Vd,playlistMatch:Jy,segmentDurationWithParts:Zy},zP=ot.log,tw=function(t,e){return t+"-"+e},GN=function(t,e,i){return"placeholder-uri-"+t+"-"+e+"-"+i},$N=function(t){var e=t.onwarn,i=t.oninfo,r=t.manifestString,o=t.customTagParsers,s=o===void 0?[]:o,a=t.customTagMappers,l=a===void 0?[]:a,u=t.experimentalLLHLS,h=new M3;e&&h.on("warn",e),i&&h.on("info",i),s.forEach(function(m){return h.addParser(m)}),l.forEach(function(m){return h.addTagMapper(m)}),h.push(r),h.end();var d=h.manifest;if(u||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(m){d.hasOwnProperty(m)&&delete d[m]}),d.segments&&d.segments.forEach(function(m){["parts","preloadHints"].forEach(function(p){m.hasOwnProperty(p)&&delete m[p]})})),!d.targetDuration){var c=10;d.segments&&d.segments.length&&(c=d.segments.reduce(function(m,p){return Math.max(m,p.duration)},0)),e&&e("manifest has no targetDuration defaulting to "+c),d.targetDuration=c}var f=PP(d);if(f.length&&!d.partTargetDuration){var g=f.reduce(function(m,p){return Math.max(m,p.duration)},0);e&&(e("manifest has no partTargetDuration defaulting to "+g),zP.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),d.partTargetDuration=g}return d},Iu=function(t,e){t.mediaGroups&&["AUDIO","SUBTITLES"].forEach(function(i){if(t.mediaGroups[i])for(var r in t.mediaGroups[i])for(var o in t.mediaGroups[i][r]){var s=t.mediaGroups[i][r][o];e(s,i,r,o)}})},NP=function(t){var e=t.playlist,i=t.uri,r=t.id;e.id=r,e.playlistErrors_=0,i&&(e.uri=i),e.attributes=e.attributes||{}},qN=function(t){for(var e=t.playlists.length;e--;){var i=t.playlists[e];NP({playlist:i,id:tw(e,i.uri)}),i.resolvedUri=Gn(t.uri,i.uri),t.playlists[i.id]=i,t.playlists[i.uri]=i,i.attributes.BANDWIDTH||zP.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},XN=function(t){Iu(t,function(e){e.uri&&(e.resolvedUri=Gn(t.uri,e.uri))})},YN=function(t,e){var i=tw(0,e),r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:K.location.href,resolvedUri:K.location.href,playlists:[{uri:e,id:i,resolvedUri:e,attributes:{}}]};return r.playlists[i]=r.playlists[0],r.playlists[e]=r.playlists[0],r},WP=function(t,e,i){i===void 0&&(i=GN),t.uri=e;for(var r=0;r<t.playlists.length;r++)if(!t.playlists[r].uri){var o="placeholder-uri-"+r;t.playlists[r].uri=o}var s=Vd(t);Iu(t,function(a,l,u,h){if(!a.playlists||!a.playlists.length){if(s&&l==="AUDIO"&&!a.uri)for(var d=0;d<t.playlists.length;d++){var c=t.playlists[d];if(c.attributes&&c.attributes.AUDIO&&c.attributes.AUDIO===u)return}a.playlists=[Jn({},a)]}a.playlists.forEach(function(f,g){var m=i(l,u,h,f),p=tw(g,m);f.uri?f.resolvedUri=f.resolvedUri||Gn(t.uri,f.uri):(f.uri=g===0?m:p,f.resolvedUri=f.uri),f.id=f.id||p,f.attributes=f.attributes||{},t.playlists[f.id]=f,t.playlists[f.uri]=f})}),qN(t),XN(t)},Jf=ot.mergeOptions,KN=ot.EventTarget,ZN=function(t,e){if(e.endList||!e.serverControl)return t;var i={};if(e.serverControl.canBlockReload){var r=e.preloadSegment,o=e.mediaSequence+e.segments.length;if(r){var s=r.parts||[],a=kP(e)-1;a>-1&&a!==s.length-1&&(i._HLS_part=a),(a>-1||s.length)&&o--}i._HLS_msn=o}if(e.serverControl&&e.serverControl.canSkipUntil&&(i._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){var l=new K.URL(t);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(u){i.hasOwnProperty(u)&&l.searchParams.set(u,i[u])}),t=l.toString()}return t},QN=function(t,e){if(!t)return e;var i=Jf(t,e);if(t.preloadHints&&!e.preloadHints&&delete i.preloadHints,t.parts&&!e.parts)delete i.parts;else if(t.parts&&e.parts)for(var r=0;r<e.parts.length;r++)t.parts&&t.parts[r]&&(i.parts[r]=Jf(t.parts[r],e.parts[r]));return!t.skipped&&e.skipped&&(i.skipped=!1),t.preload&&!e.preload&&(i.preload=!1),i},JN=function(t,e,i){var r=t.slice(),o=e.slice();i=i||0;for(var s=[],a,l=0;l<o.length;l++){var u=r[l+i],h=o[l];u?(a=u.map||a,s.push(QN(u,h))):(a&&!h.map&&(h.map=a),s.push(h))}return s},UP=function(t,e){!t.resolvedUri&&t.uri&&(t.resolvedUri=Gn(e,t.uri)),t.key&&!t.key.resolvedUri&&(t.key.resolvedUri=Gn(e,t.key.uri)),t.map&&!t.map.resolvedUri&&(t.map.resolvedUri=Gn(e,t.map.uri)),t.map&&t.map.key&&!t.map.key.resolvedUri&&(t.map.key.resolvedUri=Gn(e,t.map.key.uri)),t.parts&&t.parts.length&&t.parts.forEach(function(i){i.resolvedUri||(i.resolvedUri=Gn(e,i.uri))}),t.preloadHints&&t.preloadHints.length&&t.preloadHints.forEach(function(i){i.resolvedUri||(i.resolvedUri=Gn(e,i.uri))})},VP=function(t){var e=t.segments||[],i=t.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(var r=0;r<i.preloadHints.length;r++)if(i.preloadHints[r].type==="MAP")return e}i.duration=t.targetDuration,i.preload=!0,e.push(i)}return e},jP=function(t,e){return t===e||t.segments&&e.segments&&t.segments.length===e.segments.length&&t.endList===e.endList&&t.mediaSequence===e.mediaSequence&&t.preloadSegment===e.preloadSegment},h_=function(t,e,i){i===void 0&&(i=jP);var r=Jf(t,{}),o=r.playlists[e.id];if(!o||i(o,e))return null;e.segments=VP(e);var s=Jf(o,e);if(s.preloadSegment&&!e.preloadSegment&&delete s.preloadSegment,o.segments){if(e.skip){e.segments=e.segments||[];for(var a=0;a<e.skip.skippedSegments;a++)e.segments.unshift({skipped:!0})}s.segments=JN(o.segments,e.segments,e.mediaSequence-o.mediaSequence)}s.segments.forEach(function(u){UP(u,s.resolvedUri)});for(var l=0;l<r.playlists.length;l++)r.playlists[l].id===e.id&&(r.playlists[l]=s);return r.playlists[e.id]=s,r.playlists[e.uri]=s,Iu(t,function(u,h,d,c){if(u.playlists)for(var f=0;f<u.playlists.length;f++)e.id===u.playlists[f].id&&(u.playlists[f]=s)}),r},d_=function(t,e){var i=t.segments||[],r=i[i.length-1],o=r&&r.parts&&r.parts[r.parts.length-1],s=o&&o.duration||r&&r.duration;return e&&s?s*1e3:(t.partTargetDuration||t.targetDuration||10)*500},kl=function(n){kt(t,n);function t(i,r,o){var s;if(o===void 0&&(o={}),s=n.call(this)||this,!i)throw new Error("A non-empty playlist URL or object is required");s.logger_=oo("PlaylistLoader");var a=o,l=a.withCredentials,u=l===void 0?!1:l,h=a.handleManifestRedirects,d=h===void 0?!1:h;s.src=i,s.vhs_=r,s.withCredentials=u,s.handleManifestRedirects=d;var c=r.options_;return s.customTagParsers=c&&c.customTagParsers||[],s.customTagMappers=c&&c.customTagMappers||[],s.experimentalLLHLS=c&&c.experimentalLLHLS||!1,ot.browser.IE_VERSION&&(s.experimentalLLHLS=!1),s.state="HAVE_NOTHING",s.handleMediaupdatetimeout_=s.handleMediaupdatetimeout_.bind(he(s)),s.on("mediaupdatetimeout",s.handleMediaupdatetimeout_),s}var e=t.prototype;return e.handleMediaupdatetimeout_=function(){var r=this;if(this.state==="HAVE_METADATA"){var o=this.media(),s=Gn(this.master.uri,o.uri);this.experimentalLLHLS&&(s=ZN(s,o)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:s,withCredentials:this.withCredentials},function(a,l){if(r.request){if(a)return r.playlistRequestError(r.request,r.media(),"HAVE_METADATA");r.haveMetadata({playlistString:r.request.responseText,url:r.media().uri,id:r.media().id})}})}},e.playlistRequestError=function(r,o,s){var a=o.uri,l=o.id;this.request=null,s&&(this.state=s),this.error={playlist:this.master.playlists[l],status:r.status,message:"HLS playlist request error at URL: "+a+".",responseText:r.responseText,code:r.status>=500?4:2},this.trigger("error")},e.parseManifest_=function(r){var o=this,s=r.url,a=r.manifestString;return $N({onwarn:function(u){var h=u.message;return o.logger_("m3u8-parser warn for "+s+": "+h)},oninfo:function(u){var h=u.message;return o.logger_("m3u8-parser info for "+s+": "+h)},manifestString:a,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})},e.haveMetadata=function(r){var o=r.playlistString,s=r.playlistObject,a=r.url,l=r.id;this.request=null,this.state="HAVE_METADATA";var u=s||this.parseManifest_({url:a,manifestString:o});u.lastRequest=Date.now(),NP({playlist:u,uri:a,id:l});var h=h_(this.master,u);this.targetDuration=u.partTargetDuration||u.targetDuration,this.pendingMedia_=null,h?(this.master=h,this.media_=this.master.playlists[l]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(d_(this.media(),!!h)),this.trigger("loadedplaylist")},e.dispose=function(){this.trigger("dispose"),this.stopRequest(),K.clearTimeout(this.mediaUpdateTimeout),K.clearTimeout(this.finalRenditionTimeout),this.off()},e.stopRequest=function(){if(this.request){var r=this.request;this.request=null,r.onreadystatechange=null,r.abort()}},e.media=function(r,o){var s=this;if(!r)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof r=="string"){if(!this.master.playlists[r])throw new Error("Unknown playlist URI: "+r);r=this.master.playlists[r]}if(K.clearTimeout(this.finalRenditionTimeout),o){var a=(r.partTargetDuration||r.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=K.setTimeout(this.media.bind(this,r,!1),a);return}var l=this.state,u=!this.media_||r.id!==this.media_.id,h=this.master.playlists[r.id];if(h&&h.endList||r.endList&&r.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=r,u&&(this.trigger("mediachanging"),l==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(d_(r,!0)),!!u){if(this.state="SWITCHING_MEDIA",this.request){if(r.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=r,this.request=this.vhs_.xhr({uri:r.resolvedUri,withCredentials:this.withCredentials},function(d,c){if(s.request){if(r.lastRequest=Date.now(),r.resolvedUri=Qf(s.handleManifestRedirects,r.resolvedUri,c),d)return s.playlistRequestError(s.request,r,l);s.haveMetadata({playlistString:c.responseText,url:r.uri,id:r.id}),l==="HAVE_MASTER"?s.trigger("loadedmetadata"):s.trigger("mediachange")}})}},e.pause=function(){this.mediaUpdateTimeout&&(K.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")},e.load=function(r){var o=this;this.mediaUpdateTimeout&&(K.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var s=this.media();if(r){var a=s?(s.partTargetDuration||s.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=K.setTimeout(function(){o.mediaUpdateTimeout=null,o.load()},a);return}if(!this.started){this.start();return}s&&!s.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")},e.updateMediaUpdateTimeout_=function(r){var o=this;this.mediaUpdateTimeout&&(K.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=K.setTimeout(function(){o.mediaUpdateTimeout=null,o.trigger("mediaupdatetimeout"),o.updateMediaUpdateTimeout_(r)},r))},e.start=function(){var r=this;if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=K.location.href),this.src.resolvedUri=this.src.uri,setTimeout(function(){r.setupInitialPlaylist(r.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(o,s){if(r.request){if(r.request=null,o)return r.error={status:s.status,message:"HLS playlist request error at URL: "+r.src+".",responseText:s.responseText,code:2},r.state==="HAVE_NOTHING"&&(r.started=!1),r.trigger("error");r.src=Qf(r.handleManifestRedirects,r.src,s);var a=r.parseManifest_({manifestString:s.responseText,url:r.src});r.setupInitialPlaylist(a)}})},e.srcUri=function(){return typeof this.src=="string"?this.src:this.src.uri},e.setupInitialPlaylist=function(r){if(this.state="HAVE_MASTER",r.playlists){this.master=r,WP(this.master,this.srcUri()),r.playlists.forEach(function(s){s.segments=VP(s),s.segments.forEach(function(a){UP(a,s.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.master.playlists[0]);return}var o=this.srcUri()||K.location.href;this.master=YN(r,o),this.haveMetadata({playlistObject:r,url:o,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},t}(KN),t5=ot.xhr,e5=ot.mergeOptions,c_=function(t,e,i,r){var o=t.responseType==="arraybuffer"?t.response:t.responseText;!e&&o&&(t.responseTime=Date.now(),t.roundTripTime=t.responseTime-t.requestTime,t.bytesReceived=o.byteLength||o.length,t.bandwidth||(t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3))),i.headers&&(t.responseHeaders=i.headers),e&&e.code==="ETIMEDOUT"&&(t.timedout=!0),!e&&!t.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(t&&(o||t.responseText)))),r(e,t)},GP=function(){var t=function e(i,r){i=e5({timeout:45e3},i);var o=e.beforeRequest||ot.Vhs.xhr.beforeRequest;if(o&&typeof o=="function"){var s=o(i);s&&(i=s)}var a=ot.Vhs.xhr.original===!0?t5:ot.Vhs.xhr,l=a(i,function(h,d){return c_(l,h,d,r)}),u=l.abort;return l.abort=function(){return l.aborted=!0,u.apply(l,arguments)},l.uri=i.uri,l.requestTime=Date.now(),l};return t.original=!0,t},i5=function(t){var e,i=t.offset;return typeof t.offset=="bigint"||typeof t.length=="bigint"?e=K.BigInt(t.offset)+K.BigInt(t.length)-K.BigInt(1):e=t.offset+t.length-1,"bytes="+i+"-"+e},f_=function(t){var e={};return t.byterange&&(e.Range=i5(t.byterange)),e},r5=function(t,e){return t.start(e)+"-"+t.end(e)},n5=function(t,e){var i=t.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},o5=function(t){return t>=32&&t<126?String.fromCharCode(t):"."},$P=function(t){var e={};return Object.keys(t).forEach(function(i){var r=t[i];uB(r)?e[i]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:e[i]=r}),e},tg=function(t){var e=t.byterange||{length:1/0,offset:0};return[e.length,e.offset,t.resolvedUri].join(",")},qP=function(t){return t.resolvedUri},XP=function(t){for(var e=Array.prototype.slice.call(t),i=16,r="",o,s,a=0;a<e.length/i;a++)o=e.slice(a*i,a*i+i).map(n5).join(""),s=e.slice(a*i,a*i+i).map(o5).join(""),r+=o+" "+s+`
`;return r},s5=function(t){var e=t.bytes;return XP(e)},a5=function(t){var e="",i;for(i=0;i<t.length;i++)e+=r5(t,i)+" ";return e},l5=Object.freeze({__proto__:null,createTransferableMessage:$P,initSegmentId:tg,segmentKeyId:qP,hexDump:XP,tagDump:s5,textRanges:a5}),YP=.25,u5=function(t,e){if(!e.dateTimeObject)return null;var i=e.videoTimingInfo.transmuxerPrependedSeconds,r=e.videoTimingInfo.transmuxedPresentationStart,o=r+i,s=t-o;return new Date(e.dateTimeObject.getTime()+s*1e3)},h5=function(t){return t.transmuxedPresentationEnd-t.transmuxedPresentationStart-t.transmuxerPrependedSeconds},d5=function(t,e){var i;try{i=new Date(t)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;var r=e.segments[0];if(i<r.dateTimeObject)return null;for(var o=0;o<e.segments.length-1;o++){r=e.segments[o];var s=e.segments[o+1].dateTimeObject;if(i<s)break}var a=e.segments[e.segments.length-1],l=a.dateTimeObject,u=a.videoTimingInfo?h5(a.videoTimingInfo):a.duration+a.duration*YP,h=new Date(l.getTime()+u*1e3);return i>h?null:(i>l&&(r=a),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:jr.duration(e,e.mediaSequence+e.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})},c5=function(t,e){if(!e||!e.segments||e.segments.length===0)return null;for(var i=0,r,o=0;o<e.segments.length&&(r=e.segments[o],i=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:i+r.duration,!(t<=i));o++);var s=e.segments[e.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<t)return null;if(t>i){if(t>i+s.duration*YP)return null;r=s}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:i-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}},f5=function(t,e){var i,r;try{i=new Date(t),r=new Date(e)}catch{}var o=i.getTime(),s=r.getTime();return(s-o)/1e3},g5=function(t){if(!t.segments||t.segments.length===0)return!1;for(var e=0;e<t.segments.length;e++){var i=t.segments[e];if(!i.dateTimeObject)return!1}return!0},p5=function(t){var e=t.playlist,i=t.time,r=i===void 0?void 0:i,o=t.callback;if(!o)throw new Error("getProgramTime: callback must be provided");if(!e||r===void 0)return o({message:"getProgramTime: playlist and time must be provided"});var s=c5(r,e);if(!s)return o({message:"valid programTime was not found"});if(s.type==="estimate")return o({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:s.estimatedStart});var a={mediaSeconds:r},l=u5(r,s.segment);return l&&(a.programDateTime=l.toISOString()),o(null,a)},m5=function n(t){var e=t.programTime,i=t.playlist,r=t.retryCount,o=r===void 0?2:r,s=t.seekTo,a=t.pauseAfterSeek,l=a===void 0?!0:a,u=t.tech,h=t.callback;if(!h)throw new Error("seekToProgramTime: callback must be provided");if(typeof e>"u"||!i||!s)return h({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!i.endList&&!u.hasStarted_)return h({message:"player must be playing a live stream to start buffering"});if(!g5(i))return h({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri});var d=d5(e,i);if(!d)return h({message:e+" was not found in the stream"});var c=d.segment,f=f5(c.dateTimeObject,e);if(d.type==="estimate"){if(o===0)return h({message:e+" is not buffered yet. Try again"});s(d.estimatedStart+f),u.one("seeked",function(){n({programTime:e,playlist:i,retryCount:o-1,seekTo:s,pauseAfterSeek:l,tech:u,callback:h})});return}var g=c.start+f,m=function(){return h(null,u.currentTime())};u.one("seeked",m),l&&u.pause(),s(g)},Z0=function(t,e){if(t.readyState===4)return e()},v5=function(t,e,i){var r=[],o,s=!1,a=function(c,f,g,m){return f.abort(),s=!0,i(c,f,g,m)},l=function(c,f){if(!s){if(c)return a(c,f,"",r);var g=f.responseText.substring(r&&r.byteLength||0,f.responseText.length);if(r=W3(r,hB(g,!0)),o=o||Sh(r),r.length<10||o&&r.length<o+2)return Z0(f,function(){return a(c,f,"",r)});var m=Cy(r);return m==="ts"&&r.length<188?Z0(f,function(){return a(c,f,"",r)}):!m&&r.length<376?Z0(f,function(){return a(c,f,"",r)}):a(null,f,m,r)}},u={uri:t,beforeSend:function(c){c.overrideMimeType("text/plain; charset=x-user-defined"),c.addEventListener("progress",function(f){return f.total,f.loaded,c_(c,null,{statusCode:c.status},l)})}},h=e(u,function(d,c){return c_(h,d,c,l)});return h},b5=ot.EventTarget,KP=ot.mergeOptions,ux=function(t,e){if(!jP(t,e)||t.sidx&&e.sidx&&(t.sidx.offset!==e.sidx.offset||t.sidx.length!==e.sidx.length))return!1;if(!t.sidx&&e.sidx||t.sidx&&!e.sidx||t.segments&&!e.segments||!t.segments&&e.segments)return!1;if(!t.segments&&!e.segments)return!0;for(var i=0;i<t.segments.length;i++){var r=t.segments[i],o=e.segments[i];if(r.uri!==o.uri)return!1;if(!(!r.byterange&&!o.byterange)){var s=r.byterange,a=o.byterange;if(s&&!a||!s&&a||s.offset!==a.offset||s.length!==a.length)return!1}}return!0},_5=function(t,e,i,r){var o=r.attributes.NAME||i;return"placeholder-uri-"+t+"-"+e+"-"+o},C5=function(t){var e=t.masterXml,i=t.srcUrl,r=t.clientOffset,o=t.sidxMapping,s=t.previousManifest,a=OH(e,{manifestUri:i,clientOffset:r,sidxMapping:o,previousManifest:s});return WP(a,i,_5),a},y5=function(t,e){Iu(t,function(i,r,o,s){s in e.mediaGroups[r][o]||delete t.mediaGroups[r][o][s]})},w5=function(t,e,i){for(var r=!0,o=KP(t,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts}),s=0;s<e.playlists.length;s++){var a=e.playlists[s];if(a.sidx){var l=fm(a.sidx);i&&i[l]&&i[l].sidx&&my(a,i[l].sidx,a.sidx.resolvedUri)}var u=h_(o,a,ux);u&&(o=u,r=!1)}return Iu(e,function(h,d,c,f){if(h.playlists&&h.playlists.length){var g=h.playlists[0].id,m=h_(o,h.playlists[0],ux);m&&(o=m,f in o.mediaGroups[d][c]||(o.mediaGroups[d][c][f]=h),o.mediaGroups[d][c][f].playlists[0]=o.playlists[g],r=!1)}}),y5(o,e),e.minimumUpdatePeriod!==t.minimumUpdatePeriod&&(r=!1),r?null:o},S5=function(t,e){var i=!t.map&&!e.map,r=i||!!(t.map&&e.map&&t.map.byterange.offset===e.map.byterange.offset&&t.map.byterange.length===e.map.byterange.length);return r&&t.uri===e.uri&&t.byterange.offset===e.byterange.offset&&t.byterange.length===e.byterange.length},hx=function(t,e){var i={};for(var r in t){var o=t[r],s=o.sidx;if(s){var a=fm(s);if(!e[a])break;var l=e[a].sidxInfo;S5(l,s)&&(i[a]=e[a])}}return i},x5=function(t,e){var i=hx(t.playlists,e),r=i;return Iu(t,function(o,s,a,l){if(o.playlists&&o.playlists.length){var u=o.playlists;r=KP(r,hx(u,e))}}),r},g_=function(n){kt(t,n);function t(i,r,o,s){var a;o===void 0&&(o={}),a=n.call(this)||this,a.masterPlaylistLoader_=s||he(a),s||(a.isMaster_=!0);var l=o,u=l.withCredentials,h=u===void 0?!1:u,d=l.handleManifestRedirects,c=d===void 0?!1:d;if(a.vhs_=r,a.withCredentials=h,a.handleManifestRedirects=c,!i)throw new Error("A non-empty playlist URL or object is required");return a.on("minimumUpdatePeriod",function(){a.refreshXml_()}),a.on("mediaupdatetimeout",function(){a.refreshMedia_(a.media().id)}),a.state="HAVE_NOTHING",a.loadedPlaylists_={},a.logger_=oo("DashPlaylistLoader"),a.isMaster_?(a.masterPlaylistLoader_.srcUrl=i,a.masterPlaylistLoader_.sidxMapping_={}):a.childPlaylist_=i,a}var e=t.prototype;return e.requestErrored_=function(r,o,s){if(!this.request)return!0;if(this.request=null,r)return this.error=typeof r=="object"&&!(r instanceof Error)?r:{status:o.status,message:"DASH request error at URL: "+o.uri,response:o.response,code:2},s&&(this.state=s),this.trigger("error"),!0},e.addSidxSegments_=function(r,o,s){var a=this,l=r.sidx&&fm(r.sidx);if(!r.sidx||!l||this.masterPlaylistLoader_.sidxMapping_[l]){this.mediaRequest_=K.setTimeout(function(){return s(!1)},0);return}var u=Qf(this.handleManifestRedirects,r.sidx.resolvedUri),h=function(c,f){if(!a.requestErrored_(c,f,o)){var g=a.masterPlaylistLoader_.sidxMapping_,m;try{m=UH(ee(f.response).subarray(8))}catch(p){a.requestErrored_(p,f,o);return}return g[l]={sidxInfo:r.sidx,sidx:m},my(r,m,r.sidx.resolvedUri),s(!0)}};this.request=v5(u,this.vhs_.xhr,function(d,c,f,g){if(d)return h(d,c);if(!f||f!=="mp4")return h({status:c.status,message:"Unsupported "+(f||"unknown")+" container type for sidx segment at URL: "+u,response:"",playlist:r,internal:!0,blacklistDuration:1/0,code:2},c);var m=r.sidx.byterange,p=m.offset,v=m.length;if(g.length>=v+p)return h(d,{response:g.subarray(p,p+v),status:c.status,uri:c.uri});a.request=a.vhs_.xhr({uri:u,responseType:"arraybuffer",headers:f_({byterange:r.sidx.byterange})},h)})},e.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},K.clearTimeout(this.minimumUpdatePeriodTimeout_),K.clearTimeout(this.mediaRequest_),K.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.off()},e.hasPendingRequest=function(){return this.request||this.mediaRequest_},e.stopRequest=function(){if(this.request){var r=this.request;this.request=null,r.onreadystatechange=null,r.abort()}},e.media=function(r){var o=this;if(!r)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);var s=this.state;if(typeof r=="string"){if(!this.masterPlaylistLoader_.master.playlists[r])throw new Error("Unknown playlist URI: "+r);r=this.masterPlaylistLoader_.master.playlists[r]}var a=!this.media_||r.id!==this.media_.id;if(a&&this.loadedPlaylists_[r.id]&&this.loadedPlaylists_[r.id].endList){this.state="HAVE_METADATA",this.media_=r,a&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}a&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(r,s,function(l){o.haveMetadata({startingState:s,playlist:r})}))},e.haveMetadata=function(r){var o=r.startingState,s=r.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[s.id]=s,this.mediaRequest_=null,this.refreshMedia_(s.id),o==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange")},e.pause=function(){this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),K.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMaster_&&(K.clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_),this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)},e.load=function(r){var o=this;K.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var s=this.media();if(r){var a=s?s.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=K.setTimeout(function(){return o.load()},a);return}if(!this.started){this.start();return}s&&!s.endList?(this.isMaster_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")},e.start=function(){var r=this;if(this.started=!0,!this.isMaster_){this.mediaRequest_=K.setTimeout(function(){return r.haveMaster_()},0);return}this.requestMaster_(function(o,s){r.haveMaster_(),!r.hasPendingRequest()&&!r.media_&&r.media(r.masterPlaylistLoader_.master.playlists[0])})},e.requestMaster_=function(r){var o=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(s,a){if(o.requestErrored_(s,a)){o.state==="HAVE_NOTHING"&&(o.started=!1);return}var l=a.responseText!==o.masterPlaylistLoader_.masterXml_;if(o.masterPlaylistLoader_.masterXml_=a.responseText,a.responseHeaders&&a.responseHeaders.date?o.masterLoaded_=Date.parse(a.responseHeaders.date):o.masterLoaded_=Date.now(),o.masterPlaylistLoader_.srcUrl=Qf(o.handleManifestRedirects,o.masterPlaylistLoader_.srcUrl,a),l){o.handleMaster_(),o.syncClientServerClock_(function(){return r(a,l)});return}return r(a,l)})},e.syncClientServerClock_=function(r){var o=this,s=HH(this.masterPlaylistLoader_.masterXml_);if(s===null)return this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),r();if(s.method==="DIRECT")return this.masterPlaylistLoader_.clientOffset_=s.value-Date.now(),r();this.request=this.vhs_.xhr({uri:Gn(this.masterPlaylistLoader_.srcUrl,s.value),method:s.method,withCredentials:this.withCredentials},function(a,l){if(o.request){if(a)return o.masterPlaylistLoader_.clientOffset_=o.masterLoaded_-Date.now(),r();var u;s.method==="HEAD"?!l.responseHeaders||!l.responseHeaders.date?u=o.masterLoaded_:u=Date.parse(l.responseHeaders.date):u=Date.parse(l.responseText),o.masterPlaylistLoader_.clientOffset_=u-Date.now(),r()}})},e.haveMaster_=function(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},e.handleMaster_=function(){this.mediaRequest_=null;var r=this.masterPlaylistLoader_.master,o=C5({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_,previousManifest:r});r&&(o=w5(r,o,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=o||r;var s=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return s&&s!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=s),(!r||o&&o.minimumUpdatePeriod!==r.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),!!o},e.updateMinimumUpdatePeriodTimeout_=function(){var r=this.masterPlaylistLoader_;r.createMupOnMedia_&&(r.off("loadedmetadata",r.createMupOnMedia_),r.createMupOnMedia_=null),r.minimumUpdatePeriodTimeout_&&(K.clearTimeout(r.minimumUpdatePeriodTimeout_),r.minimumUpdatePeriodTimeout_=null);var o=r.master&&r.master.minimumUpdatePeriod;if(o===0&&(r.media()?o=r.media().targetDuration*1e3:(r.createMupOnMedia_=r.updateMinimumUpdatePeriodTimeout_,r.one("loadedmetadata",r.createMupOnMedia_))),typeof o!="number"||o<=0){o<0&&this.logger_("found invalid minimumUpdatePeriod of "+o+", not setting a timeout");return}this.createMUPTimeout_(o)},e.createMUPTimeout_=function(r){var o=this.masterPlaylistLoader_;o.minimumUpdatePeriodTimeout_=K.setTimeout(function(){o.minimumUpdatePeriodTimeout_=null,o.trigger("minimumUpdatePeriod"),o.createMUPTimeout_(r)},r)},e.refreshXml_=function(){var r=this;this.requestMaster_(function(o,s){s&&(r.media_&&(r.media_=r.masterPlaylistLoader_.master.playlists[r.media_.id]),r.masterPlaylistLoader_.sidxMapping_=x5(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.sidxMapping_),r.addSidxSegments_(r.media(),r.state,function(a){r.refreshMedia_(r.media().id)}))})},e.refreshMedia_=function(r){var o=this;if(!r)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var s=this.masterPlaylistLoader_.master.playlists,a=!this.media_||this.media_!==s[r];if(a?this.media_=s[r]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){var l=function u(){o.media().endList||(o.mediaUpdateTimeout=K.setTimeout(function(){o.trigger("mediaupdatetimeout"),u()},d_(o.media(),!!a)))};l()}this.trigger("loadedplaylist")},t}(b5),Gi={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},T5=function(t){for(var e=new Uint8Array(new ArrayBuffer(t.length)),i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e.buffer},ZP=function(t){return t.on=t.addEventListener,t.off=t.removeEventListener,t},A5=function(t){try{return URL.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch{var e=new BlobBuilder;return e.append(t),URL.createObjectURL(e.getBlob())}},QP=function(t){return function(){var e=A5(t),i=ZP(new Worker(e));i.objURL=e;var r=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(e),r.call(this)},i}},JP=function(t){return"var browserWorkerPolyFill = "+ZP.toString()+`;
browserWorkerPolyFill(self);
`+t},tk=function(t){return t.toString().replace(/^function.+?{/,"").slice(0,-1)},R5=JP(tk(function(){var n=function(){this.init=function(){var R={};this.on=function(P,B){R[P]||(R[P]=[]),R[P]=R[P].concat(B)},this.off=function(P,B){var k;return R[P]?(k=R[P].indexOf(B),R[P]=R[P].slice(),R[P].splice(k,1),k>-1):!1},this.trigger=function(P){var B,k,F,z;if(B=R[P],!!B)if(arguments.length===2)for(F=B.length,k=0;k<F;++k)B[k].call(this,arguments[1]);else{for(z=[],k=arguments.length,k=1;k<arguments.length;++k)z.push(arguments[k]);for(F=B.length,k=0;k<F;++k)B[k].apply(this,z)}},this.dispose=function(){R={}}}};n.prototype.pipe=function(V){return this.on("data",function(R){V.push(R)}),this.on("done",function(R){V.flush(R)}),this.on("partialdone",function(R){V.partialFlush(R)}),this.on("endedtimeline",function(R){V.endTimeline(R)}),this.on("reset",function(R){V.reset(R)}),V},n.prototype.push=function(V){this.trigger("data",V)},n.prototype.flush=function(V){this.trigger("done",V)},n.prototype.partialFlush=function(V){this.trigger("partialdone",V)},n.prototype.endTimeline=function(V){this.trigger("endedtimeline",V)},n.prototype.reset=function(V){this.trigger("reset",V)};var t=n,e=Math.pow(2,32),i=function(R){var P=new DataView(R.buffer,R.byteOffset,R.byteLength),B;return P.getBigUint64?(B=P.getBigUint64(0),B<Number.MAX_SAFE_INTEGER?Number(B):B):P.getUint32(0)*e+P.getUint32(4)},r={getUint64:i,MAX_UINT32:e},o=r.MAX_UINT32,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J;(function(){var V;if(M={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(V in M)M.hasOwnProperty(V)&&(M[V]=[V.charCodeAt(0),V.charCodeAt(1),V.charCodeAt(2),V.charCodeAt(3)]);L=new Uint8Array([105,115,111,109]),D=new Uint8Array([97,118,99,49]),I=new Uint8Array([0,0,0,1]),H=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),O=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),N={video:H,audio:O},j=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),W=new Uint8Array([0,0,0,0,0,0,0,0]),Y=new Uint8Array([0,0,0,0,0,0,0,0]),Z=Y,rt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),J=Y,U=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),s=function(R){var P=[],B=0,k,F,z;for(k=1;k<arguments.length;k++)P.push(arguments[k]);for(k=P.length;k--;)B+=P[k].byteLength;for(F=new Uint8Array(B+8),z=new DataView(F.buffer,F.byteOffset,F.byteLength),z.setUint32(0,F.byteLength),F.set(R,4),k=0,B=8;k<P.length;k++)F.set(P[k],B),B+=P[k].byteLength;return F},a=function(){return s(M.dinf,s(M.dref,j))},l=function(R){return s(M.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,R.audioobjecttype<<3|R.samplingfrequencyindex>>>1,R.samplingfrequencyindex<<7|R.channelcount<<3,6,1,2]))},u=function(){return s(M.ftyp,L,I,L,D)},w=function(R){return s(M.hdlr,N[R])},h=function(R){return s(M.mdat,R)},y=function(R){var P=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,R.duration>>>24&255,R.duration>>>16&255,R.duration>>>8&255,R.duration&255,85,196,0,0]);return R.samplerate&&(P[12]=R.samplerate>>>24&255,P[13]=R.samplerate>>>16&255,P[14]=R.samplerate>>>8&255,P[15]=R.samplerate&255),s(M.mdhd,P)},C=function(R){return s(M.mdia,y(R),w(R.type),c(R))},d=function(R){return s(M.mfhd,new Uint8Array([0,0,0,0,(R&4278190080)>>24,(R&16711680)>>16,(R&65280)>>8,R&255]))},c=function(R){return s(M.minf,R.type==="video"?s(M.vmhd,U):s(M.smhd,W),a(),A(R))},f=function(R,P){for(var B=[],k=P.length;k--;)B[k]=S(P[k]);return s.apply(null,[M.moof,d(R)].concat(B))},g=function(R){for(var P=R.length,B=[];P--;)B[P]=v(R[P]);return s.apply(null,[M.moov,p(4294967295)].concat(B).concat(m(R)))},m=function(R){for(var P=R.length,B=[];P--;)B[P]=x(R[P]);return s.apply(null,[M.mvex].concat(B))},p=function(R){var P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(R&4278190080)>>24,(R&16711680)>>16,(R&65280)>>8,R&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s(M.mvhd,P)},_=function(R){var P=R.samples||[],B=new Uint8Array(4+P.length),k,F;for(F=0;F<P.length;F++)k=P[F].flags,B[F+4]=k.dependsOn<<4|k.isDependedOn<<2|k.hasRedundancy;return s(M.sdtp,B)},A=function(R){return s(M.stbl,T(R),s(M.stts,J),s(M.stsc,Z),s(M.stsz,rt),s(M.stco,Y))},function(){var V,R;T=function(B){return s(M.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),B.type==="video"?V(B):R(B))},V=function(B){var k=B.sps||[],F=B.pps||[],z=[],q=[],X,it;for(X=0;X<k.length;X++)z.push((k[X].byteLength&65280)>>>8),z.push(k[X].byteLength&255),z=z.concat(Array.prototype.slice.call(k[X]));for(X=0;X<F.length;X++)q.push((F[X].byteLength&65280)>>>8),q.push(F[X].byteLength&255),q=q.concat(Array.prototype.slice.call(F[X]));if(it=[M.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(B.width&65280)>>8,B.width&255,(B.height&65280)>>8,B.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s(M.avcC,new Uint8Array([1,B.profileIdc,B.profileCompatibility,B.levelIdc,255].concat([k.length],z,[F.length],q))),s(M.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],B.sarRatio){var Q=B.sarRatio[0],nt=B.sarRatio[1];it.push(s(M.pasp,new Uint8Array([(Q&4278190080)>>24,(Q&16711680)>>16,(Q&65280)>>8,Q&255,(nt&4278190080)>>24,(nt&16711680)>>16,(nt&65280)>>8,nt&255])))}return s.apply(null,it)},R=function(B){return s(M.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(B.channelcount&65280)>>8,B.channelcount&255,(B.samplesize&65280)>>8,B.samplesize&255,0,0,0,0,(B.samplerate&65280)>>8,B.samplerate&255,0,0]),l(B))}}(),b=function(R){var P=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(R.id&4278190080)>>24,(R.id&16711680)>>16,(R.id&65280)>>8,R.id&255,0,0,0,0,(R.duration&4278190080)>>24,(R.duration&16711680)>>16,(R.duration&65280)>>8,R.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(R.width&65280)>>8,R.width&255,0,0,(R.height&65280)>>8,R.height&255,0,0]);return s(M.tkhd,P)},S=function(R){var P,B,k,F,z,q,X;return P=s(M.tfhd,new Uint8Array([0,0,0,58,(R.id&4278190080)>>24,(R.id&16711680)>>16,(R.id&65280)>>8,R.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),q=Math.floor(R.baseMediaDecodeTime/o),X=Math.floor(R.baseMediaDecodeTime%o),B=s(M.tfdt,new Uint8Array([1,0,0,0,q>>>24&255,q>>>16&255,q>>>8&255,q&255,X>>>24&255,X>>>16&255,X>>>8&255,X&255])),z=92,R.type==="audio"?(k=E(R,z),s(M.traf,P,B,k)):(F=_(R),k=E(R,F.length+z),s(M.traf,P,B,k,F))},v=function(R){return R.duration=R.duration||4294967295,s(M.trak,b(R),C(R))},x=function(R){var P=new Uint8Array([0,0,0,0,(R.id&4278190080)>>24,(R.id&16711680)>>16,(R.id&65280)>>8,R.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return R.type!=="video"&&(P[P.length-1]=0),s(M.trex,P)},function(){var V,R,P;P=function(k,F){var z=0,q=0,X=0,it=0;return k.length&&(k[0].duration!==void 0&&(z=1),k[0].size!==void 0&&(q=2),k[0].flags!==void 0&&(X=4),k[0].compositionTimeOffset!==void 0&&(it=8)),[0,0,z|q|X|it,1,(k.length&4278190080)>>>24,(k.length&16711680)>>>16,(k.length&65280)>>>8,k.length&255,(F&4278190080)>>>24,(F&16711680)>>>16,(F&65280)>>>8,F&255]},R=function(k,F){var z,q,X,it,Q,nt;for(it=k.samples||[],F+=20+16*it.length,X=P(it,F),q=new Uint8Array(X.length+it.length*16),q.set(X),z=X.length,nt=0;nt<it.length;nt++)Q=it[nt],q[z++]=(Q.duration&4278190080)>>>24,q[z++]=(Q.duration&16711680)>>>16,q[z++]=(Q.duration&65280)>>>8,q[z++]=Q.duration&255,q[z++]=(Q.size&4278190080)>>>24,q[z++]=(Q.size&16711680)>>>16,q[z++]=(Q.size&65280)>>>8,q[z++]=Q.size&255,q[z++]=Q.flags.isLeading<<2|Q.flags.dependsOn,q[z++]=Q.flags.isDependedOn<<6|Q.flags.hasRedundancy<<4|Q.flags.paddingValue<<1|Q.flags.isNonSyncSample,q[z++]=Q.flags.degradationPriority&61440,q[z++]=Q.flags.degradationPriority&15,q[z++]=(Q.compositionTimeOffset&4278190080)>>>24,q[z++]=(Q.compositionTimeOffset&16711680)>>>16,q[z++]=(Q.compositionTimeOffset&65280)>>>8,q[z++]=Q.compositionTimeOffset&255;return s(M.trun,q)},V=function(k,F){var z,q,X,it,Q,nt;for(it=k.samples||[],F+=20+8*it.length,X=P(it,F),z=new Uint8Array(X.length+it.length*8),z.set(X),q=X.length,nt=0;nt<it.length;nt++)Q=it[nt],z[q++]=(Q.duration&4278190080)>>>24,z[q++]=(Q.duration&16711680)>>>16,z[q++]=(Q.duration&65280)>>>8,z[q++]=Q.duration&255,z[q++]=(Q.size&4278190080)>>>24,z[q++]=(Q.size&16711680)>>>16,z[q++]=(Q.size&65280)>>>8,z[q++]=Q.size&255;return s(M.trun,z)},E=function(k,F){return k.type==="audio"?V(k,F):R(k,F)}}();var st={ftyp:u,mdat:h,moof:f,moov:g,initSegment:function(R){var P=u(),B=g(R),k;return k=new Uint8Array(P.byteLength+B.byteLength),k.set(P),k.set(B,P.byteLength),k}},ht=function(R){var P,B,k=[],F=[];for(F.byteLength=0,F.nalCount=0,F.duration=0,k.byteLength=0,P=0;P<R.length;P++)B=R[P],B.nalUnitType==="access_unit_delimiter_rbsp"?(k.length&&(k.duration=B.dts-k.dts,F.byteLength+=k.byteLength,F.nalCount+=k.length,F.duration+=k.duration,F.push(k)),k=[B],k.byteLength=B.data.byteLength,k.pts=B.pts,k.dts=B.dts):(B.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(k.keyFrame=!0),k.duration=B.dts-k.dts,k.byteLength+=B.data.byteLength,k.push(B));return F.length&&(!k.duration||k.duration<=0)&&(k.duration=F[F.length-1].duration),F.byteLength+=k.byteLength,F.nalCount+=k.length,F.duration+=k.duration,F.push(k),F},at=function(R){var P,B,k=[],F=[];for(k.byteLength=0,k.nalCount=0,k.duration=0,k.pts=R[0].pts,k.dts=R[0].dts,F.byteLength=0,F.nalCount=0,F.duration=0,F.pts=R[0].pts,F.dts=R[0].dts,P=0;P<R.length;P++)B=R[P],B.keyFrame?(k.length&&(F.push(k),F.byteLength+=k.byteLength,F.nalCount+=k.nalCount,F.duration+=k.duration),k=[B],k.nalCount=B.length,k.byteLength=B.byteLength,k.pts=B.pts,k.dts=B.dts,k.duration=B.duration):(k.duration+=B.duration,k.nalCount+=B.length,k.byteLength+=B.byteLength,k.push(B));return F.length&&k.duration<=0&&(k.duration=F[F.length-1].duration),F.byteLength+=k.byteLength,F.nalCount+=k.nalCount,F.duration+=k.duration,F.push(k),F},lt=function(R){var P;return!R[0][0].keyFrame&&R.length>1&&(P=R.shift(),R.byteLength-=P.byteLength,R.nalCount-=P.nalCount,R[0][0].dts=P.dts,R[0][0].pts=P.pts,R[0][0].duration+=P.duration),R},_t=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},vt=function(R,P){var B=_t();return B.dataOffset=P,B.compositionTimeOffset=R.pts-R.dts,B.duration=R.duration,B.size=4*R.length,B.size+=R.byteLength,R.keyFrame&&(B.flags.dependsOn=2,B.flags.isNonSyncSample=0),B},yt=function(R,P){var B,k,F,z,q,X=P||0,it=[];for(B=0;B<R.length;B++)for(z=R[B],k=0;k<z.length;k++)q=z[k],F=vt(q,X),X+=F.size,it.push(F);return it},mt=function(R){var P,B,k,F,z,q,X=0,it=R.byteLength,Q=R.nalCount,nt=it+4*Q,ct=new Uint8Array(nt),Lt=new DataView(ct.buffer);for(P=0;P<R.length;P++)for(F=R[P],B=0;B<F.length;B++)for(z=F[B],k=0;k<z.length;k++)q=z[k],Lt.setUint32(X,q.data.byteLength),X+=4,ct.set(q.data,X),X+=q.data.byteLength;return ct},ft=function(R,P){var B,k=P||0,F=[];return B=vt(R,k),F.push(B),F},Ft=function(R){var P,B,k=0,F=R.byteLength,z=R.length,q=F+4*z,X=new Uint8Array(q),it=new DataView(X.buffer);for(P=0;P<R.length;P++)B=R[P],it.setUint32(k,B.data.byteLength),k+=4,X.set(B.data,k),k+=B.data.byteLength;return X},St={groupNalsIntoFrames:ht,groupFramesIntoGops:at,extendFirstKeyFrame:lt,generateSampleTable:yt,concatenateNalData:mt,generateSampleTableForFrame:ft,concatenateNalDataForFrame:Ft},Kt=[33,16,5,32,164,27],At=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Pt=function(R){for(var P=[];R--;)P.push(0);return P},Bt=function(R){return Object.keys(R).reduce(function(P,B){return P[B]=new Uint8Array(R[B].reduce(function(k,F){return k.concat(F)},[])),P},{})},It,Ot=function(){if(!It){var R={96e3:[Kt,[227,64],Pt(154),[56]],88200:[Kt,[231],Pt(170),[56]],64e3:[Kt,[248,192],Pt(240),[56]],48e3:[Kt,[255,192],Pt(268),[55,148,128],Pt(54),[112]],44100:[Kt,[255,192],Pt(268),[55,163,128],Pt(84),[112]],32e3:[Kt,[255,192],Pt(268),[55,234],Pt(226),[112]],24e3:[Kt,[255,192],Pt(268),[55,255,128],Pt(268),[111,112],Pt(126),[224]],16e3:[Kt,[255,192],Pt(268),[55,255,128],Pt(268),[111,255],Pt(269),[223,108],Pt(195),[1,192]],12e3:[At,Pt(268),[3,127,248],Pt(268),[6,255,240],Pt(268),[13,255,224],Pt(268),[27,253,128],Pt(259),[56]],11025:[At,Pt(268),[3,127,248],Pt(268),[6,255,240],Pt(268),[13,255,224],Pt(268),[27,255,192],Pt(268),[55,175,128],Pt(108),[112]],8e3:[At,Pt(268),[3,121,16],Pt(47),[7]]};It=Bt(R)}return It},qt=9e4,gt,Ht,bt,Fe,hi,le,Ci;gt=function(R){return R*qt},Ht=function(R,P){return R*P},bt=function(R){return R/qt},Fe=function(R,P){return R/P},hi=function(R,P){return gt(Fe(R,P))},le=function(R,P){return Ht(bt(R),P)},Ci=function(R,P,B){return bt(B?R:R-P)};var se={ONE_SECOND_IN_TS:qt,secondsToVideoTs:gt,secondsToAudioTs:Ht,videoTsToSeconds:bt,audioTsToSeconds:Fe,audioTsToVideoTs:hi,videoTsToAudioTs:le,metadataTsToSeconds:Ci},vr=function(R){var P,B,k=0;for(P=0;P<R.length;P++)B=R[P],k+=B.data.byteLength;return k},Re=function(R,P,B,k){var F,z=0,q=0,X=0,it=0,Q,nt,ct;if(P.length&&(F=se.audioTsToVideoTs(R.baseMediaDecodeTime,R.samplerate),z=Math.ceil(se.ONE_SECOND_IN_TS/(R.samplerate/1024)),B&&k&&(q=F-Math.max(B,k),X=Math.floor(q/z),it=X*z),!(X<1||it>se.ONE_SECOND_IN_TS/2))){for(Q=Ot()[R.samplerate],Q||(Q=P[0].data),nt=0;nt<X;nt++)ct=P[0],P.splice(0,0,{data:Q,dts:ct.dts-z,pts:ct.pts-z});return R.baseMediaDecodeTime-=Math.floor(se.videoTsToAudioTs(it,R.samplerate)),it}},Ke=function(R,P,B){return P.minSegmentDts>=B?R:(P.minSegmentDts=1/0,R.filter(function(k){return k.dts>=B?(P.minSegmentDts=Math.min(P.minSegmentDts,k.dts),P.minSegmentPts=P.minSegmentDts,!0):!1}))},yi=function(R){var P,B,k=[];for(P=0;P<R.length;P++)B=R[P],k.push({size:B.data.byteLength,duration:1024});return k},wi=function(R){var P,B,k=0,F=new Uint8Array(vr(R));for(P=0;P<R.length;P++)B=R[P],F.set(B.data,k),k+=B.data.byteLength;return F},zi={prefixWithSilence:Re,trimAdtsFramesByEarliestDts:Ke,generateSampleTable:yi,concatenateFrameData:wi},br=se.ONE_SECOND_IN_TS,ur=function(R,P){typeof P.pts=="number"&&(R.timelineStartInfo.pts===void 0&&(R.timelineStartInfo.pts=P.pts),R.minSegmentPts===void 0?R.minSegmentPts=P.pts:R.minSegmentPts=Math.min(R.minSegmentPts,P.pts),R.maxSegmentPts===void 0?R.maxSegmentPts=P.pts:R.maxSegmentPts=Math.max(R.maxSegmentPts,P.pts)),typeof P.dts=="number"&&(R.timelineStartInfo.dts===void 0&&(R.timelineStartInfo.dts=P.dts),R.minSegmentDts===void 0?R.minSegmentDts=P.dts:R.minSegmentDts=Math.min(R.minSegmentDts,P.dts),R.maxSegmentDts===void 0?R.maxSegmentDts=P.dts:R.maxSegmentDts=Math.max(R.maxSegmentDts,P.dts))},oc=function(R){delete R.minSegmentDts,delete R.maxSegmentDts,delete R.minSegmentPts,delete R.maxSegmentPts},G=function(R,P){var B,k,F=R.minSegmentDts;return P||(F-=R.timelineStartInfo.dts),B=R.timelineStartInfo.baseMediaDecodeTime,B+=F,B=Math.max(0,B),R.type==="audio"&&(k=R.samplerate/br,B*=k,B=Math.floor(B)),B},$={clearDtsInfo:oc,calculateTrackBaseMediaDecodeTime:G,collectDtsInfo:ur},tt=4,dt=128,Dt=function(R){for(var P=0,B={payloadType:-1,payloadSize:0},k=0,F=0;P<R.byteLength&&R[P]!==dt;){for(;R[P]===255;)k+=255,P++;for(k+=R[P++];R[P]===255;)F+=255,P++;if(F+=R[P++],!B.payload&&k===tt){var z=String.fromCharCode(R[P+3],R[P+4],R[P+5],R[P+6]);if(z==="GA94"){B.payloadType=k,B.payloadSize=F,B.payload=R.subarray(P,P+F);break}else B.payload=void 0}P+=F,k=0,F=0}return B},oe=function(R){return R.payload[0]!==181||(R.payload[1]<<8|R.payload[2])!==49||String.fromCharCode(R.payload[3],R.payload[4],R.payload[5],R.payload[6])!=="GA94"||R.payload[7]!==3?null:R.payload.subarray(8,R.payload.length-1)},$e=function(R,P){var B=[],k,F,z,q;if(!(P[0]&64))return B;for(F=P[0]&31,k=0;k<F;k++)z=k*3,q={type:P[z+2]&3,pts:R},P[z+2]&4&&(q.ccData=P[z+3]<<8|P[z+4],B.push(q));return B},hr=function(R){for(var P=R.byteLength,B=[],k=1,F,z;k<P-2;)R[k]===0&&R[k+1]===0&&R[k+2]===3?(B.push(k+2),k+=2):k++;if(B.length===0)return R;F=P-B.length,z=new Uint8Array(F);var q=0;for(k=0;k<F;q++,k++)q===B[0]&&(q++,B.shift()),z[k]=R[q];return z},_r={parseSei:Dt,parseUserData:oe,parseCaptionPackets:$e,discardEmulationPreventionBytes:hr,USER_DATA_REGISTERED_ITU_T_T35:tt},fi=function V(R){R=R||{},V.prototype.init.call(this),this.parse708captions_=typeof R.parse708captions=="boolean"?R.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new di(0,0),new di(0,1),new di(1,0),new di(1,1)],this.parse708captions_&&(this.cc708Stream_=new Ee({captionServices:R.captionServices})),this.reset(),this.ccStreams_.forEach(function(P){P.on("data",this.trigger.bind(this,"data")),P.on("partialdone",this.trigger.bind(this,"partialdone")),P.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};fi.prototype=new t,fi.prototype.push=function(V){var R,P,B;if(V.nalUnitType==="sei_rbsp"&&(R=_r.parseSei(V.escapedRBSP),!!R.payload&&R.payloadType===_r.USER_DATA_REGISTERED_ITU_T_T35&&(P=_r.parseUserData(R),!!P))){if(V.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(V.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}B=_r.parseCaptionPackets(V.pts,P),this.captionPackets_=this.captionPackets_.concat(B),this.latestDts_!==V.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=V.dts}},fi.prototype.flushCCStreams=function(V){this.ccStreams_.forEach(function(R){return V==="flush"?R.flush():R.partialFlush()},this)},fi.prototype.flushStream=function(V){if(!this.captionPackets_.length){this.flushCCStreams(V);return}this.captionPackets_.forEach(function(R,P){R.presortIndex=P}),this.captionPackets_.sort(function(R,P){return R.pts===P.pts?R.presortIndex-P.presortIndex:R.pts-P.pts}),this.captionPackets_.forEach(function(R){R.type<2?this.dispatchCea608Packet(R):this.dispatchCea708Packet(R)},this),this.captionPackets_.length=0,this.flushCCStreams(V)},fi.prototype.flush=function(){return this.flushStream("flush")},fi.prototype.partialFlush=function(){return this.flushStream("partialFlush")},fi.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(V){V.reset()})},fi.prototype.dispatchCea608Packet=function(V){this.setsTextOrXDSActive(V)?this.activeCea608Channel_[V.type]=null:this.setsChannel1Active(V)?this.activeCea608Channel_[V.type]=0:this.setsChannel2Active(V)&&(this.activeCea608Channel_[V.type]=1),this.activeCea608Channel_[V.type]!==null&&this.ccStreams_[(V.type<<1)+this.activeCea608Channel_[V.type]].push(V)},fi.prototype.setsChannel1Active=function(V){return(V.ccData&30720)===4096},fi.prototype.setsChannel2Active=function(V){return(V.ccData&30720)===6144},fi.prototype.setsTextOrXDSActive=function(V){return(V.ccData&28928)===256||(V.ccData&30974)===4138||(V.ccData&30974)===6186},fi.prototype.dispatchCea708Packet=function(V){this.parse708captions_&&this.cc708Stream_.push(V)};var On={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Ho=function(R){var P=On[R]||R;return R&4096&&R===P?"":String.fromCharCode(P)},mn=function(R){return 32<=R&&R<=127||160<=R&&R<=255},Zi=function(R){this.windowNum=R,this.reset()};Zi.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Zi.prototype.getText=function(){return this.rows.join(`
`)},Zi.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Zi.prototype.newLine=function(V){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(V),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Zi.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Zi.prototype.addText=function(V){this.rows[this.rowIdx]+=V},Zi.prototype.backspace=function(){if(!this.isEmpty()){var V=this.rows[this.rowIdx];this.rows[this.rowIdx]=V.substr(0,V.length-1)}};var Cr=function(R,P,B){this.serviceNum=R,this.text="",this.currentWindow=new Zi(-1),this.windows=[],this.stream=B,typeof P=="string"&&this.createTextDecoder(P)};Cr.prototype.init=function(V,R){this.startPts=V;for(var P=0;P<8;P++)this.windows[P]=new Zi(P),typeof R=="function"&&(this.windows[P].beforeRowOverflow=R)},Cr.prototype.setCurrentWindow=function(V){this.currentWindow=this.windows[V]},Cr.prototype.createTextDecoder=function(V){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(V)}catch(R){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+V+" encoding. "+R})}};var Ee=function V(R){R=R||{},V.prototype.init.call(this);var P=this,B=R.captionServices||{},k={},F;Object.keys(B).forEach(function(z){F=B[z],/^SERVICE/.test(z)&&(k[z]=F.encoding)}),this.serviceEncodings=k,this.current708Packet=null,this.services={},this.push=function(z){z.type===3?(P.new708Packet(),P.add708Bytes(z)):(P.current708Packet===null&&P.new708Packet(),P.add708Bytes(z))}};Ee.prototype=new t,Ee.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Ee.prototype.add708Bytes=function(V){var R=V.ccData,P=R>>>8,B=R&255;this.current708Packet.ptsVals.push(V.pts),this.current708Packet.data.push(P),this.current708Packet.data.push(B)},Ee.prototype.push708Packet=function(){var V=this.current708Packet,R=V.data,P=null,B=null,k=0,F=R[k++];for(V.seq=F>>6,V.sizeCode=F&63;k<R.length;k++)F=R[k++],P=F>>5,B=F&31,P===7&&B>0&&(F=R[k++],P=F),this.pushServiceBlock(P,k,B),B>0&&(k+=B-1)},Ee.prototype.pushServiceBlock=function(V,R,P){var B,k=R,F=this.current708Packet.data,z=this.services[V];for(z||(z=this.initService(V,k));k<R+P&&k<F.length;k++)B=F[k],mn(B)?k=this.handleText(k,z):B===24?k=this.multiByteCharacter(k,z):B===16?k=this.extendedCommands(k,z):128<=B&&B<=135?k=this.setCurrentWindow(k,z):152<=B&&B<=159?k=this.defineWindow(k,z):B===136?k=this.clearWindows(k,z):B===140?k=this.deleteWindows(k,z):B===137?k=this.displayWindows(k,z):B===138?k=this.hideWindows(k,z):B===139?k=this.toggleWindows(k,z):B===151?k=this.setWindowAttributes(k,z):B===144?k=this.setPenAttributes(k,z):B===145?k=this.setPenColor(k,z):B===146?k=this.setPenLocation(k,z):B===143?z=this.reset(k,z):B===8?z.currentWindow.backspace():B===12?z.currentWindow.clearText():B===13?z.currentWindow.pendingNewLine=!0:B===14?z.currentWindow.clearText():B===141&&k++},Ee.prototype.extendedCommands=function(V,R){var P=this.current708Packet.data,B=P[++V];return mn(B)&&(V=this.handleText(V,R,{isExtended:!0})),V},Ee.prototype.getPts=function(V){return this.current708Packet.ptsVals[Math.floor(V/2)]},Ee.prototype.initService=function(V,R){var B="SERVICE"+V,P=this,B,k;return B in this.serviceEncodings&&(k=this.serviceEncodings[B]),this.services[V]=new Cr(V,k,P),this.services[V].init(this.getPts(R),function(F){P.flushDisplayed(F,P.services[V])}),this.services[V]},Ee.prototype.handleText=function(V,R,P){var B=P&&P.isExtended,k=P&&P.isMultiByte,F=this.current708Packet.data,z=B?4096:0,q=F[V],X=F[V+1],it=R.currentWindow,Q,nt;return R.textDecoder_&&!B?(k?(nt=[q,X],V++):nt=[q],Q=R.textDecoder_.decode(new Uint8Array(nt))):Q=Ho(z|q),it.pendingNewLine&&!it.isEmpty()&&it.newLine(this.getPts(V)),it.pendingNewLine=!1,it.addText(Q),V},Ee.prototype.multiByteCharacter=function(V,R){var P=this.current708Packet.data,B=P[V+1],k=P[V+2];return mn(B)&&mn(k)&&(V=this.handleText(++V,R,{isMultiByte:!0})),V},Ee.prototype.setCurrentWindow=function(V,R){var P=this.current708Packet.data,B=P[V],k=B&7;return R.setCurrentWindow(k),V},Ee.prototype.defineWindow=function(V,R){var P=this.current708Packet.data,B=P[V],k=B&7;R.setCurrentWindow(k);var F=R.currentWindow;return B=P[++V],F.visible=(B&32)>>5,F.rowLock=(B&16)>>4,F.columnLock=(B&8)>>3,F.priority=B&7,B=P[++V],F.relativePositioning=(B&128)>>7,F.anchorVertical=B&127,B=P[++V],F.anchorHorizontal=B,B=P[++V],F.anchorPoint=(B&240)>>4,F.rowCount=B&15,B=P[++V],F.columnCount=B&63,B=P[++V],F.windowStyle=(B&56)>>3,F.penStyle=B&7,F.virtualRowCount=F.rowCount+1,V},Ee.prototype.setWindowAttributes=function(V,R){var P=this.current708Packet.data,B=P[V],k=R.currentWindow.winAttr;return B=P[++V],k.fillOpacity=(B&192)>>6,k.fillRed=(B&48)>>4,k.fillGreen=(B&12)>>2,k.fillBlue=B&3,B=P[++V],k.borderType=(B&192)>>6,k.borderRed=(B&48)>>4,k.borderGreen=(B&12)>>2,k.borderBlue=B&3,B=P[++V],k.borderType+=(B&128)>>5,k.wordWrap=(B&64)>>6,k.printDirection=(B&48)>>4,k.scrollDirection=(B&12)>>2,k.justify=B&3,B=P[++V],k.effectSpeed=(B&240)>>4,k.effectDirection=(B&12)>>2,k.displayEffect=B&3,V},Ee.prototype.flushDisplayed=function(V,R){for(var P=[],B=0;B<8;B++)R.windows[B].visible&&!R.windows[B].isEmpty()&&P.push(R.windows[B].getText());R.endPts=V,R.text=P.join(`

`),this.pushCaption(R),R.startPts=V},Ee.prototype.pushCaption=function(V){V.text!==""&&(this.trigger("data",{startPts:V.startPts,endPts:V.endPts,text:V.text,stream:"cc708_"+V.serviceNum}),V.text="",V.startPts=V.endPts)},Ee.prototype.displayWindows=function(V,R){var P=this.current708Packet.data,B=P[++V],k=this.getPts(V);this.flushDisplayed(k,R);for(var F=0;F<8;F++)B&1<<F&&(R.windows[F].visible=1);return V},Ee.prototype.hideWindows=function(V,R){var P=this.current708Packet.data,B=P[++V],k=this.getPts(V);this.flushDisplayed(k,R);for(var F=0;F<8;F++)B&1<<F&&(R.windows[F].visible=0);return V},Ee.prototype.toggleWindows=function(V,R){var P=this.current708Packet.data,B=P[++V],k=this.getPts(V);this.flushDisplayed(k,R);for(var F=0;F<8;F++)B&1<<F&&(R.windows[F].visible^=1);return V},Ee.prototype.clearWindows=function(V,R){var P=this.current708Packet.data,B=P[++V],k=this.getPts(V);this.flushDisplayed(k,R);for(var F=0;F<8;F++)B&1<<F&&R.windows[F].clearText();return V},Ee.prototype.deleteWindows=function(V,R){var P=this.current708Packet.data,B=P[++V],k=this.getPts(V);this.flushDisplayed(k,R);for(var F=0;F<8;F++)B&1<<F&&R.windows[F].reset();return V},Ee.prototype.setPenAttributes=function(V,R){var P=this.current708Packet.data,B=P[V],k=R.currentWindow.penAttr;return B=P[++V],k.textTag=(B&240)>>4,k.offset=(B&12)>>2,k.penSize=B&3,B=P[++V],k.italics=(B&128)>>7,k.underline=(B&64)>>6,k.edgeType=(B&56)>>3,k.fontStyle=B&7,V},Ee.prototype.setPenColor=function(V,R){var P=this.current708Packet.data,B=P[V],k=R.currentWindow.penColor;return B=P[++V],k.fgOpacity=(B&192)>>6,k.fgRed=(B&48)>>4,k.fgGreen=(B&12)>>2,k.fgBlue=B&3,B=P[++V],k.bgOpacity=(B&192)>>6,k.bgRed=(B&48)>>4,k.bgGreen=(B&12)>>2,k.bgBlue=B&3,B=P[++V],k.edgeRed=(B&48)>>4,k.edgeGreen=(B&12)>>2,k.edgeBlue=B&3,V},Ee.prototype.setPenLocation=function(V,R){var P=this.current708Packet.data,B=P[V],k=R.currentWindow.penLoc;return R.currentWindow.pendingNewLine=!0,B=P[++V],k.row=B&15,B=P[++V],k.column=B&63,V},Ee.prototype.reset=function(V,R){var P=this.getPts(V);return this.flushDisplayed(P,R),this.initService(R.serviceNum,V)};var ta={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Si=function(R){return R===null?"":(R=ta[R]||R,String.fromCharCode(R))},ea=14,Cs=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],uo=function(){for(var R=[],P=ea+1;P--;)R.push("");return R},di=function V(R,P){V.prototype.init.call(this),this.field_=R||0,this.dataChannel_=P||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(B){var k,F,z,q,X;if(k=B.ccData&32639,k===this.lastControlCode_){this.lastControlCode_=null;return}if((k&61440)===4096?this.lastControlCode_=k:k!==this.PADDING_&&(this.lastControlCode_=null),z=k>>>8,q=k&255,k!==this.PADDING_)if(k===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(k===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(B.pts),this.flushDisplayed(B.pts),F=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=F,this.startPts_=B.pts;else if(k===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(B.pts);else if(k===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(B.pts);else if(k===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(B.pts);else if(k===this.CARRIAGE_RETURN_)this.clearFormatting(B.pts),this.flushDisplayed(B.pts),this.shiftRowsUp_(),this.startPts_=B.pts;else if(k===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(k===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(B.pts),this.displayed_=uo();else if(k===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=uo();else if(k===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(B.pts),this.displayed_=uo()),this.mode_="paintOn",this.startPts_=B.pts;else if(this.isSpecialCharacter(z,q))z=(z&3)<<8,X=Si(z|q),this[this.mode_](B.pts,X),this.column_++;else if(this.isExtCharacter(z,q))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),z=(z&3)<<8,X=Si(z|q),this[this.mode_](B.pts,X),this.column_++;else if(this.isMidRowCode(z,q))this.clearFormatting(B.pts),this[this.mode_](B.pts," "),this.column_++,(q&14)===14&&this.addFormatting(B.pts,["i"]),(q&1)===1&&this.addFormatting(B.pts,["u"]);else if(this.isOffsetControlCode(z,q))this.column_+=q&3;else if(this.isPAC(z,q)){var it=Cs.indexOf(k&7968);this.mode_==="rollUp"&&(it-this.rollUpRows_+1<0&&(it=this.rollUpRows_-1),this.setRollUp(B.pts,it)),it!==this.row_&&(this.clearFormatting(B.pts),this.row_=it),q&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(B.pts,["u"]),(k&16)===16&&(this.column_=((k&14)>>1)*4),this.isColorPAC(q)&&(q&14)===14&&this.addFormatting(B.pts,["i"])}else this.isNormalChar(z)&&(q===0&&(q=null),X=Si(z),X+=Si(q),this[this.mode_](B.pts,X),this.column_+=X.length)}};di.prototype=new t,di.prototype.flushDisplayed=function(V){var R=this.displayed_.map(function(P,B){try{return P.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+B+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");R.length&&this.trigger("data",{startPts:this.startPts_,endPts:V,text:R,stream:this.name_})},di.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=uo(),this.nonDisplayed_=uo(),this.lastControlCode_=null,this.column_=0,this.row_=ea,this.rollUpRows_=2,this.formatting_=[]},di.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},di.prototype.isSpecialCharacter=function(V,R){return V===this.EXT_&&R>=48&&R<=63},di.prototype.isExtCharacter=function(V,R){return(V===this.EXT_+1||V===this.EXT_+2)&&R>=32&&R<=63},di.prototype.isMidRowCode=function(V,R){return V===this.EXT_&&R>=32&&R<=47},di.prototype.isOffsetControlCode=function(V,R){return V===this.OFFSET_&&R>=33&&R<=35},di.prototype.isPAC=function(V,R){return V>=this.BASE_&&V<this.BASE_+8&&R>=64&&R<=127},di.prototype.isColorPAC=function(V){return V>=64&&V<=79||V>=96&&V<=127},di.prototype.isNormalChar=function(V){return V>=32&&V<=127},di.prototype.setRollUp=function(V,R){if(this.mode_!=="rollUp"&&(this.row_=ea,this.mode_="rollUp",this.flushDisplayed(V),this.nonDisplayed_=uo(),this.displayed_=uo()),R!==void 0&&R!==this.row_)for(var P=0;P<this.rollUpRows_;P++)this.displayed_[R-P]=this.displayed_[this.row_-P],this.displayed_[this.row_-P]="";R===void 0&&(R=this.row_),this.topRow_=R-this.rollUpRows_+1},di.prototype.addFormatting=function(V,R){this.formatting_=this.formatting_.concat(R);var P=R.reduce(function(B,k){return B+"<"+k+">"},"");this[this.mode_](V,P)},di.prototype.clearFormatting=function(V){if(this.formatting_.length){var R=this.formatting_.reverse().reduce(function(P,B){return P+"</"+B+">"},"");this.formatting_=[],this[this.mode_](V,R)}},di.prototype.popOn=function(V,R){var P=this.nonDisplayed_[this.row_];P+=R,this.nonDisplayed_[this.row_]=P},di.prototype.rollUp=function(V,R){var P=this.displayed_[this.row_];P+=R,this.displayed_[this.row_]=P},di.prototype.shiftRowsUp_=function(){var V;for(V=0;V<this.topRow_;V++)this.displayed_[V]="";for(V=this.row_+1;V<ea+1;V++)this.displayed_[V]="";for(V=this.topRow_;V<this.row_;V++)this.displayed_[V]=this.displayed_[V+1];this.displayed_[this.row_]=""},di.prototype.paintOn=function(V,R){var P=this.displayed_[this.row_];P+=R,this.displayed_[this.row_]=P};var sc={CaptionStream:fi,Cea608Stream:di,Cea708Stream:Ee},Qi={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},PF=8589934592,kF=4294967296,g1="shared",h0=function(R,P){var B=1;for(R>P&&(B=-1);Math.abs(P-R)>kF;)R+=B*PF;return R},p1=function V(R){var P,B;V.prototype.init.call(this),this.type_=R||g1,this.push=function(k){this.type_!==g1&&k.type!==this.type_||(B===void 0&&(B=k.dts),k.dts=h0(k.dts,B),k.pts=h0(k.pts,B),P=k.dts,this.trigger("data",k))},this.flush=function(){B=P,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){B=void 0,P=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};p1.prototype=new t;var m1={TimestampRolloverStream:p1,handleRollover:h0},v1=function(R,P,B){var k,F="";for(k=P;k<B;k++)F+="%"+("00"+R[k].toString(16)).slice(-2);return F},ac=function(R,P,B){return decodeURIComponent(v1(R,P,B))},LF=function(R,P,B){return unescape(v1(R,P,B))},lc=function(R){return R[0]<<21|R[1]<<14|R[2]<<7|R[3]},b1={TXXX:function(R){var P;if(R.data[0]===3){for(P=1;P<R.data.length;P++)if(R.data[P]===0){R.description=ac(R.data,1,P),R.value=ac(R.data,P+1,R.data.length).replace(/\0*$/,"");break}R.data=R.value}},WXXX:function(R){var P;if(R.data[0]===3){for(P=1;P<R.data.length;P++)if(R.data[P]===0){R.description=ac(R.data,1,P),R.url=ac(R.data,P+1,R.data.length);break}}},PRIV:function(R){var P;for(P=0;P<R.data.length;P++)if(R.data[P]===0){R.owner=LF(R.data,0,P);break}R.privateData=R.data.subarray(P+1),R.data=R.privateData}},uc;uc=function(R){var P={descriptor:R&&R.descriptor},B=0,k=[],F=0,z;if(uc.prototype.init.call(this),this.dispatchType=Qi.METADATA_STREAM_TYPE.toString(16),P.descriptor)for(z=0;z<P.descriptor.length;z++)this.dispatchType+=("00"+P.descriptor[z].toString(16)).slice(-2);this.push=function(q){var X,it,Q,nt,ct,Lt;if(q.type==="timed-metadata"){if(q.dataAlignmentIndicator&&(F=0,k.length=0),k.length===0&&(q.data.length<10||q.data[0]!==73||q.data[1]!==68||q.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(k.push(q),F+=q.data.byteLength,k.length===1&&(B=lc(q.data.subarray(6,10)),B+=10),!(F<B)){for(X={data:new Uint8Array(B),frames:[],pts:k[0].pts,dts:k[0].dts},ct=0;ct<B;)X.data.set(k[0].data.subarray(0,B-ct),ct),ct+=k[0].data.byteLength,F-=k[0].data.byteLength,k.shift();it=10,X.data[5]&64&&(it+=4,it+=lc(X.data.subarray(10,14)),B-=lc(X.data.subarray(16,20)));do{if(Q=lc(X.data.subarray(it+4,it+8)),Q<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});return}if(Lt=String.fromCharCode(X.data[it],X.data[it+1],X.data[it+2],X.data[it+3]),nt={id:Lt,data:X.data.subarray(it+10,it+Q+10)},nt.key=nt.id,b1[nt.id]&&(b1[nt.id](nt),nt.owner==="com.apple.streaming.transportStreamTimestamp")){var Ut=nt.data,xt=(Ut[3]&1)<<30|Ut[4]<<22|Ut[5]<<14|Ut[6]<<6|Ut[7]>>>2;xt*=4,xt+=Ut[7]&3,nt.timeStamp=xt,X.pts===void 0&&X.dts===void 0&&(X.pts=nt.timeStamp,X.dts=nt.timeStamp),this.trigger("timestamp",nt)}X.frames.push(nt),it+=10,it+=Q}while(it<B);this.trigger("data",X)}}}},uc.prototype=new t;var DF=uc,IF=m1.TimestampRolloverStream,hc,Yu,dc,ll=188,d0=71;hc=function(){var R=new Uint8Array(ll),P=0;hc.prototype.init.call(this),this.push=function(B){var k=0,F=ll,z;for(P?(z=new Uint8Array(B.byteLength+P),z.set(R.subarray(0,P)),z.set(B,P),P=0):z=B;F<z.byteLength;){if(z[k]===d0&&z[F]===d0){this.trigger("data",z.subarray(k,F)),k+=ll,F+=ll;continue}k++,F++}k<z.byteLength&&(R.set(z.subarray(k),0),P=z.byteLength-k)},this.flush=function(){P===ll&&R[0]===d0&&(this.trigger("data",R),P=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){P=0,this.trigger("reset")}},hc.prototype=new t,Yu=function(){var R,P,B,k;Yu.prototype.init.call(this),k=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,R=function(z,q){var X=0;q.payloadUnitStartIndicator&&(X+=z[X]+1),q.type==="pat"?P(z.subarray(X),q):B(z.subarray(X),q)},P=function(z,q){q.section_number=z[7],q.last_section_number=z[8],k.pmtPid=(z[10]&31)<<8|z[11],q.pmtPid=k.pmtPid},B=function(z,q){var X,it,Q,nt;if(z[5]&1){for(k.programMapTable={video:null,audio:null,"timed-metadata":{}},X=(z[1]&15)<<8|z[2],it=3+X-4,Q=(z[10]&15)<<8|z[11],nt=12+Q;nt<it;){var ct=z[nt],Lt=(z[nt+1]&31)<<8|z[nt+2];ct===Qi.H264_STREAM_TYPE&&k.programMapTable.video===null?k.programMapTable.video=Lt:ct===Qi.ADTS_STREAM_TYPE&&k.programMapTable.audio===null?k.programMapTable.audio=Lt:ct===Qi.METADATA_STREAM_TYPE&&(k.programMapTable["timed-metadata"][Lt]=ct),nt+=((z[nt+3]&15)<<8|z[nt+4])+5}q.programMapTable=k.programMapTable}},this.push=function(F){var z={},q=4;if(z.payloadUnitStartIndicator=!!(F[1]&64),z.pid=F[1]&31,z.pid<<=8,z.pid|=F[2],(F[3]&48)>>>4>1&&(q+=F[q]+1),z.pid===0)z.type="pat",R(F.subarray(q),z),this.trigger("data",z);else if(z.pid===this.pmtPid)for(z.type="pmt",R(F.subarray(q),z),this.trigger("data",z);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([F,q,z]):this.processPes_(F,q,z)},this.processPes_=function(F,z,q){q.pid===this.programMapTable.video?q.streamType=Qi.H264_STREAM_TYPE:q.pid===this.programMapTable.audio?q.streamType=Qi.ADTS_STREAM_TYPE:q.streamType=this.programMapTable["timed-metadata"][q.pid],q.type="pes",q.data=F.subarray(z),this.trigger("data",q)}},Yu.prototype=new t,Yu.STREAM_TYPES={h264:27,adts:15},dc=function(){var R=this,P=!1,B={data:[],size:0},k={data:[],size:0},F={data:[],size:0},z,q=function(Q,nt){var ct,Lt=Q[0]<<16|Q[1]<<8|Q[2];nt.data=new Uint8Array,Lt===1&&(nt.packetLength=6+(Q[4]<<8|Q[5]),nt.dataAlignmentIndicator=(Q[6]&4)!==0,ct=Q[7],ct&192&&(nt.pts=(Q[9]&14)<<27|(Q[10]&255)<<20|(Q[11]&254)<<12|(Q[12]&255)<<5|(Q[13]&254)>>>3,nt.pts*=4,nt.pts+=(Q[13]&6)>>>1,nt.dts=nt.pts,ct&64&&(nt.dts=(Q[14]&14)<<27|(Q[15]&255)<<20|(Q[16]&254)<<12|(Q[17]&255)<<5|(Q[18]&254)>>>3,nt.dts*=4,nt.dts+=(Q[18]&6)>>>1)),nt.data=Q.subarray(9+Q[8]))},X=function(Q,nt,ct){var Lt=new Uint8Array(Q.size),Ut={type:nt},xt=0,ue=0,Ni=!1,wr;if(!(!Q.data.length||Q.size<9)){for(Ut.trackId=Q.data[0].pid,xt=0;xt<Q.data.length;xt++)wr=Q.data[xt],Lt.set(wr.data,ue),ue+=wr.data.byteLength;q(Lt,Ut),Ni=nt==="video"||Ut.packetLength<=Q.size,(ct||Ni)&&(Q.size=0,Q.data.length=0),Ni&&R.trigger("data",Ut)}};dc.prototype.init.call(this),this.push=function(it){({pat:function(){},pes:function(){var nt,ct;switch(it.streamType){case Qi.H264_STREAM_TYPE:nt=B,ct="video";break;case Qi.ADTS_STREAM_TYPE:nt=k,ct="audio";break;case Qi.METADATA_STREAM_TYPE:nt=F,ct="timed-metadata";break;default:return}it.payloadUnitStartIndicator&&X(nt,ct,!0),nt.data.push(it),nt.size+=it.data.byteLength},pmt:function(){var nt={type:"metadata",tracks:[]};z=it.programMapTable,z.video!==null&&nt.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+z.video,codec:"avc",type:"video"}),z.audio!==null&&nt.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+z.audio,codec:"adts",type:"audio"}),P=!0,R.trigger("data",nt)}})[it.type]()},this.reset=function(){B.size=0,B.data.length=0,k.size=0,k.data.length=0,this.trigger("reset")},this.flushStreams_=function(){X(B,"video"),X(k,"audio"),X(F,"timed-metadata")},this.flush=function(){if(!P&&z){var it={type:"metadata",tracks:[]};z.video!==null&&it.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+z.video,codec:"avc",type:"video"}),z.audio!==null&&it.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+z.audio,codec:"adts",type:"audio"}),R.trigger("data",it)}P=!1,this.flushStreams_(),this.trigger("done")}},dc.prototype=new t;var _1={PAT_PID:0,MP2T_PACKET_LENGTH:ll,TransportPacketStream:hc,TransportParseStream:Yu,ElementaryStream:dc,TimestampRolloverStream:IF,CaptionStream:sc.CaptionStream,Cea608Stream:sc.Cea608Stream,Cea708Stream:sc.Cea708Stream,MetadataStream:DF};for(var c0 in Qi)Qi.hasOwnProperty(c0)&&(_1[c0]=Qi[c0]);var zo=_1,FF=se.ONE_SECOND_IN_TS,cc,C1=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];cc=function(R){var P,B=0;cc.prototype.init.call(this),this.skipWarn_=function(k,F){this.trigger("log",{level:"warn",message:"adts skiping bytes "+k+" to "+F+" in frame "+B+" outside syncword"})},this.push=function(k){var F=0,z,q,X,it,Q;if(R||(B=0),k.type==="audio"){P&&P.length?(X=P,P=new Uint8Array(X.byteLength+k.data.byteLength),P.set(X),P.set(k.data,X.byteLength)):P=k.data;for(var nt;F+7<P.length;){if(P[F]!==255||(P[F+1]&246)!==240){typeof nt!="number"&&(nt=F),F++;continue}if(typeof nt=="number"&&(this.skipWarn_(nt,F),nt=null),q=(~P[F+1]&1)*2,z=(P[F+3]&3)<<11|P[F+4]<<3|(P[F+5]&224)>>5,it=((P[F+6]&3)+1)*1024,Q=it*FF/C1[(P[F+2]&60)>>>2],P.byteLength-F<z)break;this.trigger("data",{pts:k.pts+B*Q,dts:k.dts+B*Q,sampleCount:it,audioobjecttype:(P[F+2]>>>6&3)+1,channelcount:(P[F+2]&1)<<2|(P[F+3]&192)>>>6,samplerate:C1[(P[F+2]&60)>>>2],samplingfrequencyindex:(P[F+2]&60)>>>2,samplesize:16,data:P.subarray(F+7+q,F+z)}),B++,F+=z}typeof nt=="number"&&(this.skipWarn_(nt,F),nt=null),P=P.subarray(F)}},this.flush=function(){B=0,this.trigger("done")},this.reset=function(){P=void 0,this.trigger("reset")},this.endTimeline=function(){P=void 0,this.trigger("endedtimeline")}},cc.prototype=new t;var y1=cc,w1;w1=function(R){var P=R.byteLength,B=0,k=0;this.length=function(){return 8*P},this.bitsAvailable=function(){return 8*P+k},this.loadWord=function(){var F=R.byteLength-P,z=new Uint8Array(4),q=Math.min(4,P);if(q===0)throw new Error("no bytes available");z.set(R.subarray(F,F+q)),B=new DataView(z.buffer).getUint32(0),k=q*8,P-=q},this.skipBits=function(F){var z;k>F?(B<<=F,k-=F):(F-=k,z=Math.floor(F/8),F-=z*8,P-=z,this.loadWord(),B<<=F,k-=F)},this.readBits=function(F){var z=Math.min(k,F),q=B>>>32-z;return k-=z,k>0?B<<=z:P>0&&this.loadWord(),z=F-z,z>0?q<<z|this.readBits(z):q},this.skipLeadingZeros=function(){var F;for(F=0;F<k;++F)if((B&2147483648>>>F)!==0)return B<<=F,k-=F,F;return this.loadWord(),F+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var F=this.skipLeadingZeros();return this.readBits(F+1)-1},this.readExpGolomb=function(){var F=this.readUnsignedExpGolomb();return 1&F?1+F>>>1:-1*(F>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var OF=w1,fc,gc,S1;gc=function(){var R=0,P,B;gc.prototype.init.call(this),this.push=function(k){var F;B?(F=new Uint8Array(B.byteLength+k.data.byteLength),F.set(B),F.set(k.data,B.byteLength),B=F):B=k.data;for(var z=B.byteLength;R<z-3;R++)if(B[R+2]===1){P=R+5;break}for(;P<z;)switch(B[P]){case 0:if(B[P-1]!==0){P+=2;break}else if(B[P-2]!==0){P++;break}R+3!==P-2&&this.trigger("data",B.subarray(R+3,P-2));do P++;while(B[P]!==1&&P<z);R=P-2,P+=3;break;case 1:if(B[P-1]!==0||B[P-2]!==0){P+=3;break}this.trigger("data",B.subarray(R+3,P-2)),R=P-2,P+=3;break;default:P+=3;break}B=B.subarray(R),P-=R,R=0},this.reset=function(){B=null,R=0,this.trigger("reset")},this.flush=function(){B&&B.byteLength>3&&this.trigger("data",B.subarray(R+3)),B=null,R=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},gc.prototype=new t,S1={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},fc=function(){var R=new gc,P,B,k,F,z,q,X;fc.prototype.init.call(this),P=this,this.push=function(it){it.type==="video"&&(B=it.trackId,k=it.pts,F=it.dts,R.push(it))},R.on("data",function(it){var Q={trackId:B,pts:k,dts:F,data:it,nalUnitTypeCode:it[0]&31};switch(Q.nalUnitTypeCode){case 5:Q.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Q.nalUnitType="sei_rbsp",Q.escapedRBSP=z(it.subarray(1));break;case 7:Q.nalUnitType="seq_parameter_set_rbsp",Q.escapedRBSP=z(it.subarray(1)),Q.config=q(Q.escapedRBSP);break;case 8:Q.nalUnitType="pic_parameter_set_rbsp";break;case 9:Q.nalUnitType="access_unit_delimiter_rbsp";break}P.trigger("data",Q)}),R.on("done",function(){P.trigger("done")}),R.on("partialdone",function(){P.trigger("partialdone")}),R.on("reset",function(){P.trigger("reset")}),R.on("endedtimeline",function(){P.trigger("endedtimeline")}),this.flush=function(){R.flush()},this.partialFlush=function(){R.partialFlush()},this.reset=function(){R.reset()},this.endTimeline=function(){R.endTimeline()},X=function(Q,nt){var ct=8,Lt=8,Ut,xt;for(Ut=0;Ut<Q;Ut++)Lt!==0&&(xt=nt.readExpGolomb(),Lt=(ct+xt+256)%256),ct=Lt===0?ct:Lt},z=function(Q){for(var nt=Q.byteLength,ct=[],Lt=1,Ut,xt;Lt<nt-2;)Q[Lt]===0&&Q[Lt+1]===0&&Q[Lt+2]===3?(ct.push(Lt+2),Lt+=2):Lt++;if(ct.length===0)return Q;Ut=nt-ct.length,xt=new Uint8Array(Ut);var ue=0;for(Lt=0;Lt<Ut;ue++,Lt++)ue===ct[0]&&(ue++,ct.shift()),xt[Lt]=Q[ue];return xt},q=function(Q){var nt=0,ct=0,Lt=0,Ut=0,xt,ue,Ni,wr,oa,p0,G1,$1,q1,m0,X1,xi=[1,1],Y1,sa;if(xt=new OF(Q),ue=xt.readUnsignedByte(),wr=xt.readUnsignedByte(),Ni=xt.readUnsignedByte(),xt.skipUnsignedExpGolomb(),S1[ue]&&(oa=xt.readUnsignedExpGolomb(),oa===3&&xt.skipBits(1),xt.skipUnsignedExpGolomb(),xt.skipUnsignedExpGolomb(),xt.skipBits(1),xt.readBoolean()))for(X1=oa!==3?8:12,sa=0;sa<X1;sa++)xt.readBoolean()&&(sa<6?X(16,xt):X(64,xt));if(xt.skipUnsignedExpGolomb(),p0=xt.readUnsignedExpGolomb(),p0===0)xt.readUnsignedExpGolomb();else if(p0===1)for(xt.skipBits(1),xt.skipExpGolomb(),xt.skipExpGolomb(),G1=xt.readUnsignedExpGolomb(),sa=0;sa<G1;sa++)xt.skipExpGolomb();if(xt.skipUnsignedExpGolomb(),xt.skipBits(1),$1=xt.readUnsignedExpGolomb(),q1=xt.readUnsignedExpGolomb(),m0=xt.readBits(1),m0===0&&xt.skipBits(1),xt.skipBits(1),xt.readBoolean()&&(nt=xt.readUnsignedExpGolomb(),ct=xt.readUnsignedExpGolomb(),Lt=xt.readUnsignedExpGolomb(),Ut=xt.readUnsignedExpGolomb()),xt.readBoolean()&&xt.readBoolean()){switch(Y1=xt.readUnsignedByte(),Y1){case 1:xi=[1,1];break;case 2:xi=[12,11];break;case 3:xi=[10,11];break;case 4:xi=[16,11];break;case 5:xi=[40,33];break;case 6:xi=[24,11];break;case 7:xi=[20,11];break;case 8:xi=[32,11];break;case 9:xi=[80,33];break;case 10:xi=[18,11];break;case 11:xi=[15,11];break;case 12:xi=[64,33];break;case 13:xi=[160,99];break;case 14:xi=[4,3];break;case 15:xi=[3,2];break;case 16:xi=[2,1];break;case 255:{xi=[xt.readUnsignedByte()<<8|xt.readUnsignedByte(),xt.readUnsignedByte()<<8|xt.readUnsignedByte()];break}}xi&&xi[0]/xi[1]}return{profileIdc:ue,levelIdc:Ni,profileCompatibility:wr,width:($1+1)*16-nt*2-ct*2,height:(2-m0)*(q1+1)*16-Lt*2-Ut*2,sarRatio:xi}}},fc.prototype=new t;var HF={H264Stream:fc},zF=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],x1=function(R,P){var B=R[P+6]<<21|R[P+7]<<14|R[P+8]<<7|R[P+9],k=R[P+5],F=(k&16)>>4;return B=B>=0?B:0,F?B+20:B+10},NF=function V(R,P){return R.length-P<10||R[P]!==73||R[P+1]!==68||R[P+2]!==51?P:(P+=x1(R,P),V(R,P))},WF=function(R){var P=NF(R,0);return R.length>=P+2&&(R[P]&255)===255&&(R[P+1]&240)===240&&(R[P+1]&22)===16},T1=function(R){return R[0]<<21|R[1]<<14|R[2]<<7|R[3]},UF=function(R,P,B){var k,F="";for(k=P;k<B;k++)F+="%"+("00"+R[k].toString(16)).slice(-2);return F},VF=function(R,P,B){return unescape(UF(R,P,B))},jF=function(R,P){var B=(R[P+5]&224)>>5,k=R[P+4]<<3,F=R[P+3]&6144;return F|k|B},GF=function(R,P){return R[P]===73&&R[P+1]===68&&R[P+2]===51?"timed-metadata":R[P]&!0&&(R[P+1]&240)===240?"audio":null},$F=function(R){for(var P=0;P+5<R.length;){if(R[P]!==255||(R[P+1]&246)!==240){P++;continue}return zF[(R[P+2]&60)>>>2]}return null},qF=function(R){var P,B,k,F;P=10,R[5]&64&&(P+=4,P+=T1(R.subarray(10,14)));do{if(B=T1(R.subarray(P+4,P+8)),B<1)return null;if(F=String.fromCharCode(R[P],R[P+1],R[P+2],R[P+3]),F==="PRIV"){k=R.subarray(P+10,P+B+10);for(var z=0;z<k.byteLength;z++)if(k[z]===0){var q=VF(k,0,z);if(q==="com.apple.streaming.transportStreamTimestamp"){var X=k.subarray(z+1),it=(X[3]&1)<<30|X[4]<<22|X[5]<<14|X[6]<<6|X[7]>>>2;return it*=4,it+=X[7]&3,it}break}}P+=10,P+=B}while(P<R.byteLength);return null},pc={isLikelyAacData:WF,parseId3TagSize:x1,parseAdtsSize:jF,parseType:GF,parseSampleRate:$F,parseAacTimestamp:qF},mc;mc=function(){var R=new Uint8Array,P=0;mc.prototype.init.call(this),this.setTimestamp=function(B){P=B},this.push=function(B){var k=0,F=0,z,q,X,it;for(R.length?(it=R.length,R=new Uint8Array(B.byteLength+it),R.set(R.subarray(0,it)),R.set(B,it)):R=B;R.length-F>=3;){if(R[F]===73&&R[F+1]===68&&R[F+2]===51){if(R.length-F<10||(k=pc.parseId3TagSize(R,F),F+k>R.length))break;q={type:"timed-metadata",data:R.subarray(F,F+k)},this.trigger("data",q),F+=k;continue}else if((R[F]&255)===255&&(R[F+1]&240)===240){if(R.length-F<7||(k=pc.parseAdtsSize(R,F),F+k>R.length))break;X={type:"audio",data:R.subarray(F,F+k),pts:P,dts:P},this.trigger("data",X),F+=k;continue}F++}z=R.length-F,z>0?R=R.subarray(F):R=new Uint8Array},this.reset=function(){R=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){R=new Uint8Array,this.trigger("endedtimeline")}},mc.prototype=new t;var XF=mc,YF=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],A1=YF,KF=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],R1=KF,ZF=HF.H264Stream,QF=pc.isLikelyAacData,JF=se.ONE_SECOND_IN_TS,vc,Ku,bc,ia,tO=function(R,P){P.stream=R,this.trigger("log",P)},E1=function(R,P){for(var B=Object.keys(P),k=0;k<B.length;k++){var F=B[k];F==="headOfPipeline"||!P[F].on||P[F].on("log",tO.bind(R,F))}},M1=function(R,P){var B;if(R.length!==P.length)return!1;for(B=0;B<R.length;B++)if(R[B]!==P[B])return!1;return!0},B1=function(R,P,B,k,F,z){var q=B-P,X=k-P,it=F-B;return{start:{dts:R,pts:R+q},end:{dts:R+X,pts:R+it},prependedContentDuration:z,baseMediaDecodeTime:R}};Ku=function(R,P){var B=[],k,F=0,z=0,q=1/0;P=P||{},k=P.firstSequenceNumber||0,Ku.prototype.init.call(this),this.push=function(X){$.collectDtsInfo(R,X),R&&A1.forEach(function(it){R[it]=X[it]}),B.push(X)},this.setEarliestDts=function(X){F=X},this.setVideoBaseMediaDecodeTime=function(X){q=X},this.setAudioAppendStart=function(X){z=X},this.flush=function(){var X,it,Q,nt,ct,Lt,Ut;if(B.length===0){this.trigger("done","AudioSegmentStream");return}X=zi.trimAdtsFramesByEarliestDts(B,R,F),R.baseMediaDecodeTime=$.calculateTrackBaseMediaDecodeTime(R,P.keepOriginalTimestamps),Ut=zi.prefixWithSilence(R,X,z,q),R.samples=zi.generateSampleTable(X),Q=st.mdat(zi.concatenateFrameData(X)),B=[],it=st.moof(k,[R]),nt=new Uint8Array(it.byteLength+Q.byteLength),k++,nt.set(it),nt.set(Q,it.byteLength),$.clearDtsInfo(R),ct=Math.ceil(JF*1024/R.samplerate),X.length&&(Lt=X.length*ct,this.trigger("segmentTimingInfo",B1(se.audioTsToVideoTs(R.baseMediaDecodeTime,R.samplerate),X[0].dts,X[0].pts,X[0].dts+Lt,X[0].pts+Lt,Ut||0)),this.trigger("timingInfo",{start:X[0].pts,end:X[0].pts+Lt})),this.trigger("data",{track:R,boxes:nt}),this.trigger("done","AudioSegmentStream")},this.reset=function(){$.clearDtsInfo(R),B=[],this.trigger("reset")}},Ku.prototype=new t,vc=function(R,P){var B,k=[],F=[],z,q;P=P||{},B=P.firstSequenceNumber||0,vc.prototype.init.call(this),delete R.minPTS,this.gopCache_=[],this.push=function(X){$.collectDtsInfo(R,X),X.nalUnitType==="seq_parameter_set_rbsp"&&!z&&(z=X.config,R.sps=[X.data],R1.forEach(function(it){R[it]=z[it]},this)),X.nalUnitType==="pic_parameter_set_rbsp"&&!q&&(q=X.data,R.pps=[X.data]),k.push(X)},this.flush=function(){for(var X,it,Q,nt,ct,Lt,Ut=0,xt,ue;k.length&&k[0].nalUnitType!=="access_unit_delimiter_rbsp";)k.shift();if(k.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(X=St.groupNalsIntoFrames(k),Q=St.groupFramesIntoGops(X),Q[0][0].keyFrame||(it=this.getGopForFusion_(k[0],R),it?(Ut=it.duration,Q.unshift(it),Q.byteLength+=it.byteLength,Q.nalCount+=it.nalCount,Q.pts=it.pts,Q.dts=it.dts,Q.duration+=it.duration):Q=St.extendFirstKeyFrame(Q)),F.length){var Ni;if(P.alignGopsAtEnd?Ni=this.alignGopsAtEnd_(Q):Ni=this.alignGopsAtStart_(Q),!Ni){this.gopCache_.unshift({gop:Q.pop(),pps:R.pps,sps:R.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),k=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}$.clearDtsInfo(R),Q=Ni}$.collectDtsInfo(R,Q),R.samples=St.generateSampleTable(Q),ct=st.mdat(St.concatenateNalData(Q)),R.baseMediaDecodeTime=$.calculateTrackBaseMediaDecodeTime(R,P.keepOriginalTimestamps),this.trigger("processedGopsInfo",Q.map(function(wr){return{pts:wr.pts,dts:wr.dts,byteLength:wr.byteLength}})),xt=Q[0],ue=Q[Q.length-1],this.trigger("segmentTimingInfo",B1(R.baseMediaDecodeTime,xt.dts,xt.pts,ue.dts+ue.duration,ue.pts+ue.duration,Ut)),this.trigger("timingInfo",{start:Q[0].pts,end:Q[Q.length-1].pts+Q[Q.length-1].duration}),this.gopCache_.unshift({gop:Q.pop(),pps:R.pps,sps:R.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),k=[],this.trigger("baseMediaDecodeTime",R.baseMediaDecodeTime),this.trigger("timelineStartInfo",R.timelineStartInfo),nt=st.moof(B,[R]),Lt=new Uint8Array(nt.byteLength+ct.byteLength),B++,Lt.set(nt),Lt.set(ct,nt.byteLength),this.trigger("data",{track:R,boxes:Lt}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),k=[],this.gopCache_.length=0,F.length=0,this.trigger("reset")},this.resetStream_=function(){$.clearDtsInfo(R),z=void 0,q=void 0},this.getGopForFusion_=function(X){var it=45e3,Q=1/0,nt,ct,Lt,Ut,xt;for(xt=0;xt<this.gopCache_.length;xt++)Ut=this.gopCache_[xt],Lt=Ut.gop,!(!(R.pps&&M1(R.pps[0],Ut.pps[0]))||!(R.sps&&M1(R.sps[0],Ut.sps[0])))&&(Lt.dts<R.timelineStartInfo.dts||(nt=X.dts-Lt.dts-Lt.duration,nt>=-1e4&&nt<=it&&(!ct||Q>nt)&&(ct=Ut,Q=nt)));return ct?ct.gop:null},this.alignGopsAtStart_=function(X){var it,Q,nt,ct,Lt,Ut,xt,ue;for(Lt=X.byteLength,Ut=X.nalCount,xt=X.duration,it=Q=0;it<F.length&&Q<X.length&&(nt=F[it],ct=X[Q],nt.pts!==ct.pts);){if(ct.pts>nt.pts){it++;continue}Q++,Lt-=ct.byteLength,Ut-=ct.nalCount,xt-=ct.duration}return Q===0?X:Q===X.length?null:(ue=X.slice(Q),ue.byteLength=Lt,ue.duration=xt,ue.nalCount=Ut,ue.pts=ue[0].pts,ue.dts=ue[0].dts,ue)},this.alignGopsAtEnd_=function(X){var it,Q,nt,ct,Lt,Ut;for(it=F.length-1,Q=X.length-1,Lt=null,Ut=!1;it>=0&&Q>=0;){if(nt=F[it],ct=X[Q],nt.pts===ct.pts){Ut=!0;break}if(nt.pts>ct.pts){it--;continue}it===F.length-1&&(Lt=Q),Q--}if(!Ut&&Lt===null)return null;var xt;if(Ut?xt=Q:xt=Lt,xt===0)return X;var ue=X.slice(xt),Ni=ue.reduce(function(wr,oa){return wr.byteLength+=oa.byteLength,wr.duration+=oa.duration,wr.nalCount+=oa.nalCount,wr},{byteLength:0,duration:0,nalCount:0});return ue.byteLength=Ni.byteLength,ue.duration=Ni.duration,ue.nalCount=Ni.nalCount,ue.pts=ue[0].pts,ue.dts=ue[0].dts,ue},this.alignGopsWith=function(X){F=X}},vc.prototype=new t,ia=function(R,P){this.numberOfTracks=0,this.metadataStream=P,R=R||{},typeof R.remux<"u"?this.remuxTracks=!!R.remux:this.remuxTracks=!0,typeof R.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=R.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,ia.prototype.init.call(this),this.push=function(B){if(B.text)return this.pendingCaptions.push(B);if(B.frames)return this.pendingMetadata.push(B);this.pendingTracks.push(B.track),this.pendingBytes+=B.boxes.byteLength,B.track.type==="video"&&(this.videoTrack=B.track,this.pendingBoxes.push(B.boxes)),B.track.type==="audio"&&(this.audioTrack=B.track,this.pendingBoxes.unshift(B.boxes))}},ia.prototype=new t,ia.prototype.flush=function(V){var R=0,P={captions:[],captionStreams:{},metadata:[],info:{}},B,k,F,z=0,q;if(this.pendingTracks.length<this.numberOfTracks){if(V!=="VideoSegmentStream"&&V!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(z=this.videoTrack.timelineStartInfo.pts,R1.forEach(function(X){P.info[X]=this.videoTrack[X]},this)):this.audioTrack&&(z=this.audioTrack.timelineStartInfo.pts,A1.forEach(function(X){P.info[X]=this.audioTrack[X]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?P.type=this.pendingTracks[0].type:P.type="combined",this.emittedTracks+=this.pendingTracks.length,F=st.initSegment(this.pendingTracks),P.initSegment=new Uint8Array(F.byteLength),P.initSegment.set(F),P.data=new Uint8Array(this.pendingBytes),q=0;q<this.pendingBoxes.length;q++)P.data.set(this.pendingBoxes[q],R),R+=this.pendingBoxes[q].byteLength;for(q=0;q<this.pendingCaptions.length;q++)B=this.pendingCaptions[q],B.startTime=se.metadataTsToSeconds(B.startPts,z,this.keepOriginalTimestamps),B.endTime=se.metadataTsToSeconds(B.endPts,z,this.keepOriginalTimestamps),P.captionStreams[B.stream]=!0,P.captions.push(B);for(q=0;q<this.pendingMetadata.length;q++)k=this.pendingMetadata[q],k.cueTime=se.metadataTsToSeconds(k.pts,z,this.keepOriginalTimestamps),P.metadata.push(k);for(P.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",P),q=0;q<P.captions.length;q++)B=P.captions[q],this.trigger("caption",B);for(q=0;q<P.metadata.length;q++)k=P.metadata[q],this.trigger("id3Frame",k)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},ia.prototype.setRemux=function(V){this.remuxTracks=V},bc=function(R){var P=this,B=!0,k,F;bc.prototype.init.call(this),R=R||{},this.baseMediaDecodeTime=R.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var z={};this.transmuxPipeline_=z,z.type="aac",z.metadataStream=new zo.MetadataStream,z.aacStream=new XF,z.audioTimestampRolloverStream=new zo.TimestampRolloverStream("audio"),z.timedMetadataTimestampRolloverStream=new zo.TimestampRolloverStream("timed-metadata"),z.adtsStream=new y1,z.coalesceStream=new ia(R,z.metadataStream),z.headOfPipeline=z.aacStream,z.aacStream.pipe(z.audioTimestampRolloverStream).pipe(z.adtsStream),z.aacStream.pipe(z.timedMetadataTimestampRolloverStream).pipe(z.metadataStream).pipe(z.coalesceStream),z.metadataStream.on("timestamp",function(q){z.aacStream.setTimestamp(q.timeStamp)}),z.aacStream.on("data",function(q){q.type!=="timed-metadata"&&q.type!=="audio"||z.audioSegmentStream||(F=F||{timelineStartInfo:{baseMediaDecodeTime:P.baseMediaDecodeTime},codec:"adts",type:"audio"},z.coalesceStream.numberOfTracks++,z.audioSegmentStream=new Ku(F,R),z.audioSegmentStream.on("log",P.getLogTrigger_("audioSegmentStream")),z.audioSegmentStream.on("timingInfo",P.trigger.bind(P,"audioTimingInfo")),z.adtsStream.pipe(z.audioSegmentStream).pipe(z.coalesceStream),P.trigger("trackinfo",{hasAudio:!!F,hasVideo:!!k}))}),z.coalesceStream.on("data",this.trigger.bind(this,"data")),z.coalesceStream.on("done",this.trigger.bind(this,"done")),E1(this,z)},this.setupTsPipeline=function(){var z={};this.transmuxPipeline_=z,z.type="ts",z.metadataStream=new zo.MetadataStream,z.packetStream=new zo.TransportPacketStream,z.parseStream=new zo.TransportParseStream,z.elementaryStream=new zo.ElementaryStream,z.timestampRolloverStream=new zo.TimestampRolloverStream,z.adtsStream=new y1,z.h264Stream=new ZF,z.captionStream=new zo.CaptionStream(R),z.coalesceStream=new ia(R,z.metadataStream),z.headOfPipeline=z.packetStream,z.packetStream.pipe(z.parseStream).pipe(z.elementaryStream).pipe(z.timestampRolloverStream),z.timestampRolloverStream.pipe(z.h264Stream),z.timestampRolloverStream.pipe(z.adtsStream),z.timestampRolloverStream.pipe(z.metadataStream).pipe(z.coalesceStream),z.h264Stream.pipe(z.captionStream).pipe(z.coalesceStream),z.elementaryStream.on("data",function(q){var X;if(q.type==="metadata"){for(X=q.tracks.length;X--;)!k&&q.tracks[X].type==="video"?(k=q.tracks[X],k.timelineStartInfo.baseMediaDecodeTime=P.baseMediaDecodeTime):!F&&q.tracks[X].type==="audio"&&(F=q.tracks[X],F.timelineStartInfo.baseMediaDecodeTime=P.baseMediaDecodeTime);k&&!z.videoSegmentStream&&(z.coalesceStream.numberOfTracks++,z.videoSegmentStream=new vc(k,R),z.videoSegmentStream.on("log",P.getLogTrigger_("videoSegmentStream")),z.videoSegmentStream.on("timelineStartInfo",function(it){F&&!R.keepOriginalTimestamps&&(F.timelineStartInfo=it,z.audioSegmentStream.setEarliestDts(it.dts-P.baseMediaDecodeTime))}),z.videoSegmentStream.on("processedGopsInfo",P.trigger.bind(P,"gopInfo")),z.videoSegmentStream.on("segmentTimingInfo",P.trigger.bind(P,"videoSegmentTimingInfo")),z.videoSegmentStream.on("baseMediaDecodeTime",function(it){F&&z.audioSegmentStream.setVideoBaseMediaDecodeTime(it)}),z.videoSegmentStream.on("timingInfo",P.trigger.bind(P,"videoTimingInfo")),z.h264Stream.pipe(z.videoSegmentStream).pipe(z.coalesceStream)),F&&!z.audioSegmentStream&&(z.coalesceStream.numberOfTracks++,z.audioSegmentStream=new Ku(F,R),z.audioSegmentStream.on("log",P.getLogTrigger_("audioSegmentStream")),z.audioSegmentStream.on("timingInfo",P.trigger.bind(P,"audioTimingInfo")),z.audioSegmentStream.on("segmentTimingInfo",P.trigger.bind(P,"audioSegmentTimingInfo")),z.adtsStream.pipe(z.audioSegmentStream).pipe(z.coalesceStream)),P.trigger("trackinfo",{hasAudio:!!F,hasVideo:!!k})}}),z.coalesceStream.on("data",this.trigger.bind(this,"data")),z.coalesceStream.on("id3Frame",function(q){q.dispatchType=z.metadataStream.dispatchType,P.trigger("id3Frame",q)}),z.coalesceStream.on("caption",this.trigger.bind(this,"caption")),z.coalesceStream.on("done",this.trigger.bind(this,"done")),E1(this,z)},this.setBaseMediaDecodeTime=function(z){var q=this.transmuxPipeline_;R.keepOriginalTimestamps||(this.baseMediaDecodeTime=z),F&&(F.timelineStartInfo.dts=void 0,F.timelineStartInfo.pts=void 0,$.clearDtsInfo(F),q.audioTimestampRolloverStream&&q.audioTimestampRolloverStream.discontinuity()),k&&(q.videoSegmentStream&&(q.videoSegmentStream.gopCache_=[]),k.timelineStartInfo.dts=void 0,k.timelineStartInfo.pts=void 0,$.clearDtsInfo(k),q.captionStream.reset()),q.timestampRolloverStream&&q.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(z){F&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(z)},this.setRemux=function(z){var q=this.transmuxPipeline_;R.remux=z,q&&q.coalesceStream&&q.coalesceStream.setRemux(z)},this.alignGopsWith=function(z){k&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(z)},this.getLogTrigger_=function(z){var q=this;return function(X){X.stream=z,q.trigger("log",X)}},this.push=function(z){if(B){var q=QF(z);q&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!q&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),B=!1}this.transmuxPipeline_.headOfPipeline.push(z)},this.flush=function(){B=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},bc.prototype=new t;var eO={Transmuxer:bc},iO=function(R){return R>>>0},rO=function(R){return("00"+R.toString(16)).slice(-2)},_c={toUnsigned:iO,toHexString:rO},nO=function(R){var P="";return P+=String.fromCharCode(R[0]),P+=String.fromCharCode(R[1]),P+=String.fromCharCode(R[2]),P+=String.fromCharCode(R[3]),P},ra=nO,oO=_c.toUnsigned,sO=function V(R,P){var B=[],k,F,z,q,X;if(!P.length)return null;for(k=0;k<R.byteLength;)F=oO(R[k]<<24|R[k+1]<<16|R[k+2]<<8|R[k+3]),z=ra(R.subarray(k+4,k+8)),q=F>1?k+F:R.byteLength,z===P[0]&&(P.length===1?B.push(R.subarray(k+8,q)):(X=V(R.subarray(k+8,q),P.slice(1)),X.length&&(B=B.concat(X)))),k=q;return B},Ze=sO,aO=_c.toUnsigned,lO=r.getUint64,uO=function(R){var P={version:R[0],flags:new Uint8Array(R.subarray(1,4))};return P.version===1?P.baseMediaDecodeTime=lO(R.subarray(4)):P.baseMediaDecodeTime=aO(R[4]<<24|R[5]<<16|R[6]<<8|R[7]),P},P1=uO,hO=function(R){return{isLeading:(R[0]&12)>>>2,dependsOn:R[0]&3,isDependedOn:(R[1]&192)>>>6,hasRedundancy:(R[1]&48)>>>4,paddingValue:(R[1]&14)>>>1,isNonSyncSample:R[1]&1,degradationPriority:R[2]<<8|R[3]}},k1=hO,dO=function(R){var P={version:R[0],flags:new Uint8Array(R.subarray(1,4)),samples:[]},B=new DataView(R.buffer,R.byteOffset,R.byteLength),k=P.flags[2]&1,F=P.flags[2]&4,z=P.flags[1]&1,q=P.flags[1]&2,X=P.flags[1]&4,it=P.flags[1]&8,Q=B.getUint32(4),nt=8,ct;for(k&&(P.dataOffset=B.getInt32(nt),nt+=4),F&&Q&&(ct={flags:k1(R.subarray(nt,nt+4))},nt+=4,z&&(ct.duration=B.getUint32(nt),nt+=4),q&&(ct.size=B.getUint32(nt),nt+=4),it&&(P.version===1?ct.compositionTimeOffset=B.getInt32(nt):ct.compositionTimeOffset=B.getUint32(nt),nt+=4),P.samples.push(ct),Q--);Q--;)ct={},z&&(ct.duration=B.getUint32(nt),nt+=4),q&&(ct.size=B.getUint32(nt),nt+=4),X&&(ct.flags=k1(R.subarray(nt,nt+4)),nt+=4),it&&(P.version===1?ct.compositionTimeOffset=B.getInt32(nt):ct.compositionTimeOffset=B.getUint32(nt),nt+=4),P.samples.push(ct);return P},L1=dO,cO=function(R){var P=new DataView(R.buffer,R.byteOffset,R.byteLength),B={version:R[0],flags:new Uint8Array(R.subarray(1,4)),trackId:P.getUint32(4)},k=B.flags[2]&1,F=B.flags[2]&2,z=B.flags[2]&8,q=B.flags[2]&16,X=B.flags[2]&32,it=B.flags[0]&65536,Q=B.flags[0]&131072,nt;return nt=8,k&&(nt+=4,B.baseDataOffset=P.getUint32(12),nt+=4),F&&(B.sampleDescriptionIndex=P.getUint32(nt),nt+=4),z&&(B.defaultSampleDuration=P.getUint32(nt),nt+=4),q&&(B.defaultSampleSize=P.getUint32(nt),nt+=4),X&&(B.defaultSampleFlags=P.getUint32(nt)),it&&(B.durationIsEmpty=!0),!k&&Q&&(B.baseDataOffsetIsMoof=!0),B},D1=cO,I1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zu;typeof window<"u"?Zu=window:typeof I1<"u"?Zu=I1:typeof self<"u"?Zu=self:Zu={};var Qu=Zu,fO=_r.discardEmulationPreventionBytes,gO=sc.CaptionStream,pO=function(R,P){for(var B=R,k=0;k<P.length;k++){var F=P[k];if(B<F.size)return F;B-=F.size}return null},mO=function(R,P,B){var k=new DataView(R.buffer,R.byteOffset,R.byteLength),F={logs:[],seiNals:[]},z,q,X,it;for(q=0;q+4<R.length;q+=X)if(X=k.getUint32(q),q+=4,!(X<=0))switch(R[q]&31){case 6:var Q=R.subarray(q+1,q+1+X),nt=pO(q,P);if(z={nalUnitType:"sei_rbsp",size:X,data:Q,escapedRBSP:fO(Q),trackId:B},nt)z.pts=nt.pts,z.dts=nt.dts,it=nt;else if(it)z.pts=it.pts,z.dts=it.dts;else{F.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+q+" for trackId "+B+". See mux.js#223."});break}F.seiNals.push(z);break}return F},vO=function(R,P,B){var k=P,F=B.defaultSampleDuration||0,z=B.defaultSampleSize||0,q=B.trackId,X=[];return R.forEach(function(it){var Q=L1(it),nt=Q.samples;nt.forEach(function(ct){ct.duration===void 0&&(ct.duration=F),ct.size===void 0&&(ct.size=z),ct.trackId=q,ct.dts=k,ct.compositionTimeOffset===void 0&&(ct.compositionTimeOffset=0),typeof k=="bigint"?(ct.pts=k+Qu.BigInt(ct.compositionTimeOffset),k+=Qu.BigInt(ct.duration)):(ct.pts=k+ct.compositionTimeOffset,k+=ct.duration)}),X=X.concat(nt)}),X},bO=function(R,P){var B=Ze(R,["moof","traf"]),k=Ze(R,["mdat"]),F={},z=[];return k.forEach(function(q,X){var it=B[X];z.push({mdat:q,traf:it})}),z.forEach(function(q){var X=q.mdat,it=q.traf,Q=Ze(it,["tfhd"]),nt=D1(Q[0]),ct=nt.trackId,Lt=Ze(it,["tfdt"]),Ut=Lt.length>0?P1(Lt[0]).baseMediaDecodeTime:0,xt=Ze(it,["trun"]),ue,Ni;P===ct&&xt.length>0&&(ue=vO(xt,Ut,nt),Ni=mO(X,ue,ct),F[ct]||(F[ct]={seiNals:[],logs:[]}),F[ct].seiNals=F[ct].seiNals.concat(Ni.seiNals),F[ct].logs=F[ct].logs.concat(Ni.logs))}),F},_O=function(R,P,B){var k;if(P===null)return null;k=bO(R,P);var F=k[P]||{};return{seiNals:F.seiNals,logs:F.logs,timescale:B}},CO=function(){var R=!1,P,B,k,F,z,q;this.isInitialized=function(){return R},this.init=function(X){P=new gO,R=!0,q=X?X.isPartial:!1,P.on("data",function(it){it.startTime=it.startPts/F,it.endTime=it.endPts/F,z.captions.push(it),z.captionStreams[it.stream]=!0}),P.on("log",function(it){z.logs.push(it)})},this.isNewInit=function(X,it){return X&&X.length===0||it&&typeof it=="object"&&Object.keys(it).length===0?!1:k!==X[0]||F!==it[k]},this.parse=function(X,it,Q){var nt;if(this.isInitialized()){if(!it||!Q)return null;if(this.isNewInit(it,Q))k=it[0],F=Q[k];else if(k===null||!F)return B.push(X),null}else return null;for(;B.length>0;){var ct=B.shift();this.parse(ct,it,Q)}return nt=_O(X,k,F),nt&&nt.logs&&(z.logs=z.logs.concat(nt.logs)),nt===null||!nt.seiNals?z.logs.length?{logs:z.logs,captions:[],captionStreams:[]}:null:(this.pushNals(nt.seiNals),this.flushStream(),z)},this.pushNals=function(X){if(!this.isInitialized()||!X||X.length===0)return null;X.forEach(function(it){P.push(it)})},this.flushStream=function(){if(!this.isInitialized())return null;q?P.partialFlush():P.flush()},this.clearParsedCaptions=function(){z.captions=[],z.captionStreams={},z.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;P.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){B=[],k=null,F=null,z?this.clearParsedCaptions():z={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},yO=CO,Cc=_c.toUnsigned,Ju=_c.toHexString,wO=r.getUint64,F1,O1,H1,z1,N1,f0;F1=function(R){var P={},B=Ze(R,["moov","trak"]);return B.reduce(function(k,F){var z,q,X,it,Q;return z=Ze(F,["tkhd"])[0],!z||(q=z[0],X=q===0?12:20,it=Cc(z[X]<<24|z[X+1]<<16|z[X+2]<<8|z[X+3]),Q=Ze(F,["mdia","mdhd"])[0],!Q)?null:(q=Q[0],X=q===0?12:20,k[it]=Cc(Q[X]<<24|Q[X+1]<<16|Q[X+2]<<8|Q[X+3]),k)},P)},O1=function(R,P){var B;B=Ze(P,["moof","traf"]);var k=B.reduce(function(F,z){var q=Ze(z,["tfhd"])[0],X=Cc(q[4]<<24|q[5]<<16|q[6]<<8|q[7]),it=R[X]||9e4,Q=Ze(z,["tfdt"])[0],nt=new DataView(Q.buffer,Q.byteOffset,Q.byteLength),ct;Q[0]===1?ct=wO(Q.subarray(4,12)):ct=nt.getUint32(4);var Lt;return typeof ct=="bigint"?Lt=ct/Qu.BigInt(it):typeof ct=="number"&&!isNaN(ct)&&(Lt=ct/it),Lt<Number.MAX_SAFE_INTEGER&&(Lt=Number(Lt)),Lt<F&&(F=Lt),F},1/0);return typeof k=="bigint"||isFinite(k)?k:0},H1=function(R,P){var B=Ze(P,["moof","traf"]),k=0,F=0,z;if(B&&B.length){var q=Ze(B[0],["tfhd"])[0],X=Ze(B[0],["trun"])[0],it=Ze(B[0],["tfdt"])[0];if(q){var Q=D1(q);z=Q.trackId}if(it){var nt=P1(it);k=nt.baseMediaDecodeTime}if(X){var ct=L1(X);ct.samples&&ct.samples.length&&(F=ct.samples[0].compositionTimeOffset||0)}}var Lt=R[z]||9e4;typeof k=="bigint"&&(F=Qu.BigInt(F),Lt=Qu.BigInt(Lt));var Ut=(k+F)/Lt;return typeof Ut=="bigint"&&Ut<Number.MAX_SAFE_INTEGER&&(Ut=Number(Ut)),Ut},z1=function(R){var P=Ze(R,["moov","trak"]),B=[];return P.forEach(function(k){var F=Ze(k,["mdia","hdlr"]),z=Ze(k,["tkhd"]);F.forEach(function(q,X){var it=ra(q.subarray(8,12)),Q=z[X],nt,ct,Lt;it==="vide"&&(nt=new DataView(Q.buffer,Q.byteOffset,Q.byteLength),ct=nt.getUint8(0),Lt=ct===0?nt.getUint32(12):nt.getUint32(20),B.push(Lt))})}),B},f0=function(R){var P=R[0],B=P===0?12:20;return Cc(R[B]<<24|R[B+1]<<16|R[B+2]<<8|R[B+3])},N1=function(R){var P=Ze(R,["moov","trak"]),B=[];return P.forEach(function(k){var F={},z=Ze(k,["tkhd"])[0],q,X;z&&(q=new DataView(z.buffer,z.byteOffset,z.byteLength),X=q.getUint8(0),F.id=X===0?q.getUint32(12):q.getUint32(20));var it=Ze(k,["mdia","hdlr"])[0];if(it){var Q=ra(it.subarray(8,12));Q==="vide"?F.type="video":Q==="soun"?F.type="audio":F.type=Q}var nt=Ze(k,["mdia","minf","stbl","stsd"])[0];if(nt){var ct=nt.subarray(8);F.codec=ra(ct.subarray(4,8));var Lt=Ze(ct,[F.codec])[0],Ut,xt;Lt&&(/^[asm]vc[1-9]$/i.test(F.codec)?(Ut=Lt.subarray(78),xt=ra(Ut.subarray(4,8)),xt==="avcC"&&Ut.length>11?(F.codec+=".",F.codec+=Ju(Ut[9]),F.codec+=Ju(Ut[10]),F.codec+=Ju(Ut[11])):F.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(F.codec)?(Ut=Lt.subarray(28),xt=ra(Ut.subarray(4,8)),xt==="esds"&&Ut.length>20&&Ut[19]!==0?(F.codec+="."+Ju(Ut[19]),F.codec+="."+Ju(Ut[20]>>>2&63).replace(/^0/,"")):F.codec="mp4a.40.2"):F.codec=F.codec.toLowerCase())}var ue=Ze(k,["mdia","mdhd"])[0];ue&&(F.timescale=f0(ue)),B.push(F)}),B};var W1={findBox:Ze,parseType:ra,timescale:F1,startTime:O1,compositionStartTime:H1,videoTrackIds:z1,tracks:N1,getTimescaleFromMediaHeader:f0},U1=function(R){var P=R[1]&31;return P<<=8,P|=R[2],P},yc=function(R){return!!(R[1]&64)},wc=function(R){var P=0;return(R[3]&48)>>>4>1&&(P+=R[4]+1),P},SO=function(R,P){var B=U1(R);return B===0?"pat":B===P?"pmt":P?"pes":null},xO=function(R){var P=yc(R),B=4+wc(R);return P&&(B+=R[B]+1),(R[B+10]&31)<<8|R[B+11]},TO=function(R){var P={},B=yc(R),k=4+wc(R);if(B&&(k+=R[k]+1),!!(R[k+5]&1)){var F,z,q;F=(R[k+1]&15)<<8|R[k+2],z=3+F-4,q=(R[k+10]&15)<<8|R[k+11];for(var X=12+q;X<z;){var it=k+X;P[(R[it+1]&31)<<8|R[it+2]]=R[it],X+=((R[it+3]&15)<<8|R[it+4])+5}return P}},AO=function(R,P){var B=U1(R),k=P[B];switch(k){case Qi.H264_STREAM_TYPE:return"video";case Qi.ADTS_STREAM_TYPE:return"audio";case Qi.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},RO=function(R){var P=yc(R);if(!P)return null;var B=4+wc(R);if(B>=R.byteLength)return null;var k=null,F;return F=R[B+7],F&192&&(k={},k.pts=(R[B+9]&14)<<27|(R[B+10]&255)<<20|(R[B+11]&254)<<12|(R[B+12]&255)<<5|(R[B+13]&254)>>>3,k.pts*=4,k.pts+=(R[B+13]&6)>>>1,k.dts=k.pts,F&64&&(k.dts=(R[B+14]&14)<<27|(R[B+15]&255)<<20|(R[B+16]&254)<<12|(R[B+17]&255)<<5|(R[B+18]&254)>>>3,k.dts*=4,k.dts+=(R[B+18]&6)>>>1)),k},g0=function(R){switch(R){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},EO=function(R){for(var P=4+wc(R),B=R.subarray(P),k=0,F=0,z=!1,q;F<B.byteLength-3;F++)if(B[F+2]===1){k=F+5;break}for(;k<B.byteLength;)switch(B[k]){case 0:if(B[k-1]!==0){k+=2;break}else if(B[k-2]!==0){k++;break}F+3!==k-2&&(q=g0(B[F+3]&31),q==="slice_layer_without_partitioning_rbsp_idr"&&(z=!0));do k++;while(B[k]!==1&&k<B.length);F=k-2,k+=3;break;case 1:if(B[k-1]!==0||B[k-2]!==0){k+=3;break}q=g0(B[F+3]&31),q==="slice_layer_without_partitioning_rbsp_idr"&&(z=!0),F=k-2,k+=3;break;default:k+=3;break}return B=B.subarray(F),k-=F,F=0,B&&B.byteLength>3&&(q=g0(B[F+3]&31),q==="slice_layer_without_partitioning_rbsp_idr"&&(z=!0)),z},MO={parseType:SO,parsePat:xO,parsePmt:TO,parsePayloadUnitStartIndicator:yc,parsePesType:AO,parsePesTime:RO,videoPacketContainsKeyFrame:EO},ul=m1.handleRollover,Ue={};Ue.ts=MO,Ue.aac=pc;var na=se.ONE_SECOND_IN_TS,yr=188,ho=71,BO=function(R,P){for(var B=0,k=yr,F,z;k<R.byteLength;){if(R[B]===ho&&R[k]===ho){switch(F=R.subarray(B,k),z=Ue.ts.parseType(F,P.pid),z){case"pat":P.pid=Ue.ts.parsePat(F);break;case"pmt":var q=Ue.ts.parsePmt(F);P.table=P.table||{},Object.keys(q).forEach(function(X){P.table[X]=q[X]});break}B+=yr,k+=yr;continue}B++,k++}},V1=function(R,P,B){for(var k=0,F=yr,z,q,X,it,Q,nt=!1;F<=R.byteLength;){if(R[k]===ho&&(R[F]===ho||F===R.byteLength)){switch(z=R.subarray(k,F),q=Ue.ts.parseType(z,P.pid),q){case"pes":X=Ue.ts.parsePesType(z,P.table),it=Ue.ts.parsePayloadUnitStartIndicator(z),X==="audio"&&it&&(Q=Ue.ts.parsePesTime(z),Q&&(Q.type="audio",B.audio.push(Q),nt=!0));break}if(nt)break;k+=yr,F+=yr;continue}k++,F++}for(F=R.byteLength,k=F-yr,nt=!1;k>=0;){if(R[k]===ho&&(R[F]===ho||F===R.byteLength)){switch(z=R.subarray(k,F),q=Ue.ts.parseType(z,P.pid),q){case"pes":X=Ue.ts.parsePesType(z,P.table),it=Ue.ts.parsePayloadUnitStartIndicator(z),X==="audio"&&it&&(Q=Ue.ts.parsePesTime(z),Q&&(Q.type="audio",B.audio.push(Q),nt=!0));break}if(nt)break;k-=yr,F-=yr;continue}k--,F--}},PO=function(R,P,B){for(var k=0,F=yr,z,q,X,it,Q,nt,ct,Lt,Ut=!1,xt={data:[],size:0};F<R.byteLength;){if(R[k]===ho&&R[F]===ho){switch(z=R.subarray(k,F),q=Ue.ts.parseType(z,P.pid),q){case"pes":if(X=Ue.ts.parsePesType(z,P.table),it=Ue.ts.parsePayloadUnitStartIndicator(z),X==="video"&&(it&&!Ut&&(Q=Ue.ts.parsePesTime(z),Q&&(Q.type="video",B.video.push(Q),Ut=!0)),!B.firstKeyFrame)){if(it&&xt.size!==0){for(nt=new Uint8Array(xt.size),ct=0;xt.data.length;)Lt=xt.data.shift(),nt.set(Lt,ct),ct+=Lt.byteLength;if(Ue.ts.videoPacketContainsKeyFrame(nt)){var ue=Ue.ts.parsePesTime(nt);ue?(B.firstKeyFrame=ue,B.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}xt.size=0}xt.data.push(z),xt.size+=z.byteLength}break}if(Ut&&B.firstKeyFrame)break;k+=yr,F+=yr;continue}k++,F++}for(F=R.byteLength,k=F-yr,Ut=!1;k>=0;){if(R[k]===ho&&R[F]===ho){switch(z=R.subarray(k,F),q=Ue.ts.parseType(z,P.pid),q){case"pes":X=Ue.ts.parsePesType(z,P.table),it=Ue.ts.parsePayloadUnitStartIndicator(z),X==="video"&&it&&(Q=Ue.ts.parsePesTime(z),Q&&(Q.type="video",B.video.push(Q),Ut=!0));break}if(Ut)break;k-=yr,F-=yr;continue}k--,F--}},kO=function(R,P){if(R.audio&&R.audio.length){var B=P;(typeof B>"u"||isNaN(B))&&(B=R.audio[0].dts),R.audio.forEach(function(z){z.dts=ul(z.dts,B),z.pts=ul(z.pts,B),z.dtsTime=z.dts/na,z.ptsTime=z.pts/na})}if(R.video&&R.video.length){var k=P;if((typeof k>"u"||isNaN(k))&&(k=R.video[0].dts),R.video.forEach(function(z){z.dts=ul(z.dts,k),z.pts=ul(z.pts,k),z.dtsTime=z.dts/na,z.ptsTime=z.pts/na}),R.firstKeyFrame){var F=R.firstKeyFrame;F.dts=ul(F.dts,k),F.pts=ul(F.pts,k),F.dtsTime=F.dts/na,F.ptsTime=F.pts/na}}},LO=function(R){for(var P=!1,B=0,k=null,F=null,z=0,q=0,X;R.length-q>=3;){var it=Ue.aac.parseType(R,q);switch(it){case"timed-metadata":if(R.length-q<10){P=!0;break}if(z=Ue.aac.parseId3TagSize(R,q),z>R.length){P=!0;break}F===null&&(X=R.subarray(q,q+z),F=Ue.aac.parseAacTimestamp(X)),q+=z;break;case"audio":if(R.length-q<7){P=!0;break}if(z=Ue.aac.parseAdtsSize(R,q),z>R.length){P=!0;break}k===null&&(X=R.subarray(q,q+z),k=Ue.aac.parseSampleRate(X)),B++,q+=z;break;default:q++;break}if(P)return null}if(k===null||F===null)return null;var Q=na/k,nt={audio:[{type:"audio",dts:F,pts:F},{type:"audio",dts:F+B*1024*Q,pts:F+B*1024*Q}]};return nt},DO=function(R){var P={pid:null,table:null},B={};BO(R,P);for(var k in P.table)if(P.table.hasOwnProperty(k)){var F=P.table[k];switch(F){case Qi.H264_STREAM_TYPE:B.video=[],PO(R,P,B),B.video.length===0&&delete B.video;break;case Qi.ADTS_STREAM_TYPE:B.audio=[],V1(R,P,B),B.audio.length===0&&delete B.audio;break}}return B},IO=function(R,P){var B=Ue.aac.isLikelyAacData(R),k;return B?k=LO(R):k=DO(R),!k||!k.audio&&!k.video?null:(kO(k,P),k)},FO={inspect:IO,parseAudioPes_:V1},OO=function(R,P){P.on("data",function(B){var k=B.initSegment;B.initSegment={data:k.buffer,byteOffset:k.byteOffset,byteLength:k.byteLength};var F=B.data;B.data=F.buffer,R.postMessage({action:"data",segment:B,byteOffset:F.byteOffset,byteLength:F.byteLength},[B.data])}),P.on("done",function(B){R.postMessage({action:"done"})}),P.on("gopInfo",function(B){R.postMessage({action:"gopInfo",gopInfo:B})}),P.on("videoSegmentTimingInfo",function(B){var k={start:{decode:se.videoTsToSeconds(B.start.dts),presentation:se.videoTsToSeconds(B.start.pts)},end:{decode:se.videoTsToSeconds(B.end.dts),presentation:se.videoTsToSeconds(B.end.pts)},baseMediaDecodeTime:se.videoTsToSeconds(B.baseMediaDecodeTime)};B.prependedContentDuration&&(k.prependedContentDuration=se.videoTsToSeconds(B.prependedContentDuration)),R.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:k})}),P.on("audioSegmentTimingInfo",function(B){var k={start:{decode:se.videoTsToSeconds(B.start.dts),presentation:se.videoTsToSeconds(B.start.pts)},end:{decode:se.videoTsToSeconds(B.end.dts),presentation:se.videoTsToSeconds(B.end.pts)},baseMediaDecodeTime:se.videoTsToSeconds(B.baseMediaDecodeTime)};B.prependedContentDuration&&(k.prependedContentDuration=se.videoTsToSeconds(B.prependedContentDuration)),R.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:k})}),P.on("id3Frame",function(B){R.postMessage({action:"id3Frame",id3Frame:B})}),P.on("caption",function(B){R.postMessage({action:"caption",caption:B})}),P.on("trackinfo",function(B){R.postMessage({action:"trackinfo",trackInfo:B})}),P.on("audioTimingInfo",function(B){R.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:se.videoTsToSeconds(B.start),end:se.videoTsToSeconds(B.end)}})}),P.on("videoTimingInfo",function(B){R.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:se.videoTsToSeconds(B.start),end:se.videoTsToSeconds(B.end)}})}),P.on("log",function(B){R.postMessage({action:"log",log:B})})},j1=function(){function V(P,B){this.options=B||{},this.self=P,this.init()}var R=V.prototype;return R.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new eO.Transmuxer(this.options),OO(this.self,this.transmuxer)},R.pushMp4Captions=function(B){this.captionParser||(this.captionParser=new yO,this.captionParser.init());var k=new Uint8Array(B.data,B.byteOffset,B.byteLength),F=this.captionParser.parse(k,B.trackIds,B.timescales);this.self.postMessage({action:"mp4Captions",captions:F&&F.captions||[],logs:F&&F.logs||[],data:k.buffer},[k.buffer])},R.probeMp4StartTime=function(B){var k=B.timescales,F=B.data,z=W1.startTime(k,F);this.self.postMessage({action:"probeMp4StartTime",startTime:z,data:F},[F.buffer])},R.probeMp4Tracks=function(B){var k=B.data,F=W1.tracks(k);this.self.postMessage({action:"probeMp4Tracks",tracks:F,data:k},[k.buffer])},R.probeTs=function(B){var k=B.data,F=B.baseStartTime,z=typeof F=="number"&&!isNaN(F)?F*se.ONE_SECOND_IN_TS:void 0,q=FO.inspect(k,z),X=null;q&&(X={hasVideo:q.video&&q.video.length===2||!1,hasAudio:q.audio&&q.audio.length===2||!1},X.hasVideo&&(X.videoStart=q.video[0].ptsTime),X.hasAudio&&(X.audioStart=q.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:X,data:k},[k.buffer])},R.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},R.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},R.push=function(B){var k=new Uint8Array(B.data,B.byteOffset,B.byteLength);this.transmuxer.push(k)},R.reset=function(){this.transmuxer.reset()},R.setTimestampOffset=function(B){var k=B.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(se.secondsToVideoTs(k)))},R.setAudioAppendStart=function(B){this.transmuxer.setAudioAppendStart(Math.ceil(se.secondsToVideoTs(B.appendStart)))},R.setRemux=function(B){this.transmuxer.setRemux(B.remux)},R.flush=function(B){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})},R.endTimeline=function(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})},R.alignGopsWith=function(B){this.transmuxer.alignGopsWith(B.gopsToAlignWith.slice())},V}();self.onmessage=function(V){if(V.data.action==="init"&&V.data.options){this.messageHandlers=new j1(self,V.data.options);return}this.messageHandlers||(this.messageHandlers=new j1(self)),V.data&&V.data.action&&V.data.action!=="init"&&this.messageHandlers[V.data.action]&&this.messageHandlers[V.data.action](V.data)}})),E5=QP(R5),M5=function(t,e,i){var r=t.data.segment,o=r.type,s=r.initSegment,a=r.captions,l=r.captionStreams,u=r.metadata,h=r.videoFrameDtsTime,d=r.videoFramePtsTime;e.buffer.push({captions:a,captionStreams:l,metadata:u});var c=t.data.segment.boxes||{data:t.data.segment.data},f={type:o,data:new Uint8Array(c.data,c.data.byteOffset,c.data.byteLength),initSegment:new Uint8Array(s.data,s.byteOffset,s.byteLength)};typeof h<"u"&&(f.videoFrameDtsTime=h),typeof d<"u"&&(f.videoFramePtsTime=d),i(f)},B5=function(t){var e=t.transmuxedData,i=t.callback;e.buffer=[],i(e)},P5=function(t,e){e.gopInfo=t.data.gopInfo},ek=function(t){var e=t.transmuxer,i=t.bytes,r=t.audioAppendStart,o=t.gopsToAlignWith,s=t.remux,a=t.onData,l=t.onTrackInfo,u=t.onAudioTimingInfo,h=t.onVideoTimingInfo,d=t.onVideoSegmentTimingInfo,c=t.onAudioSegmentTimingInfo,f=t.onId3,g=t.onCaptions,m=t.onDone,p=t.onEndedTimeline,v=t.onTransmuxerLog,b=t.isEndOfTimeline,C={buffer:[]},y=b,w=function(S){e.currentTransmux===t&&(S.data.action==="data"&&M5(S,C,a),S.data.action==="trackinfo"&&l(S.data.trackInfo),S.data.action==="gopInfo"&&P5(S,C),S.data.action==="audioTimingInfo"&&u(S.data.audioTimingInfo),S.data.action==="videoTimingInfo"&&h(S.data.videoTimingInfo),S.data.action==="videoSegmentTimingInfo"&&d(S.data.videoSegmentTimingInfo),S.data.action==="audioSegmentTimingInfo"&&c(S.data.audioSegmentTimingInfo),S.data.action==="id3Frame"&&f([S.data.id3Frame],S.data.id3Frame.dispatchType),S.data.action==="caption"&&g(S.data.caption),S.data.action==="endedtimeline"&&(y=!1,p()),S.data.action==="log"&&v(S.data.log),S.data.type==="transmuxed"&&(y||(e.onmessage=null,B5({transmuxedData:C,callback:m}),ik(e))))};if(e.onmessage=w,r&&e.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(o)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:o}),typeof s<"u"&&e.postMessage({action:"setRemux",remux:s}),i.byteLength){var _=i instanceof ArrayBuffer?i:i.buffer,A=i instanceof ArrayBuffer?0:i.byteOffset;e.postMessage({action:"push",data:_,byteOffset:A,byteLength:i.byteLength},[_])}b&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},ik=function(t){t.currentTransmux=null,t.transmuxQueue.length&&(t.currentTransmux=t.transmuxQueue.shift(),typeof t.currentTransmux=="function"?t.currentTransmux():ek(t.currentTransmux))},dx=function(t,e){t.postMessage({action:e}),ik(t)},rk=function(t,e){if(!e.currentTransmux){e.currentTransmux=t,dx(e,t);return}e.transmuxQueue.push(dx.bind(null,e,t))},k5=function(t){rk("reset",t)},L5=function(t){rk("endTimeline",t)},nk=function(t){if(!t.transmuxer.currentTransmux){t.transmuxer.currentTransmux=t,ek(t);return}t.transmuxer.transmuxQueue.push(t)},D5=function(t){var e=new E5;e.currentTransmux=null,e.transmuxQueue=[];var i=e.terminate;return e.terminate=function(){return e.currentTransmux=null,e.transmuxQueue.length=0,i.call(e)},e.postMessage({action:"init",options:t}),e},Q0={reset:k5,endTimeline:L5,transmux:nk,createTransmuxer:D5},eg=function(t){var e=t.transmuxer,i=t.endAction||t.action,r=t.callback,o=Jn({},t,{endAction:null,transmuxer:null,callback:null}),s=function u(h){h.data.action===i&&(e.removeEventListener("message",u),h.data.data&&(h.data.data=new Uint8Array(h.data.data,t.byteOffset||0,t.byteLength||h.data.data.byteLength),t.data&&(t.data=h.data.data)),r(h.data))};if(e.addEventListener("message",s),t.data){var a=t.data instanceof ArrayBuffer;o.byteOffset=a?0:t.data.byteOffset,o.byteLength=t.data.byteLength;var l=[a?t.data:t.data.buffer];e.postMessage(o,l)}else e.postMessage(o)},Ao={FAILURE:2,TIMEOUT:-101,ABORTED:-102},p_=function(t){t.forEach(function(e){e.abort()})},I5=function(t){return{bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}},F5=function(t){var e=t.target,i=Date.now()-e.requestTime,r={bandwidth:1/0,bytesReceived:0,roundTripTime:i||0};return r.bytesReceived=t.loaded,r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3),r},ew=function(t,e){return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:Ao.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:Ao.ABORTED,xhr:e}:t?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:Ao.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:Ao.FAILURE,xhr:e}:null},cx=function(t,e,i){return function(r,o){var s=o.response,a=ew(r,o);if(a)return i(a,t);if(s.byteLength!==16)return i({status:o.status,message:"Invalid HLS key at URL: "+o.uri,code:Ao.FAILURE,xhr:o},t);for(var l=new DataView(s),u=new Uint32Array([l.getUint32(0),l.getUint32(4),l.getUint32(8),l.getUint32(12)]),h=0;h<e.length;h++)e[h].bytes=u;return i(null,t)}},ok=function(t,e){var i=Cy(t.map.bytes);if(i!=="mp4"){var r=t.map.resolvedUri||t.map.uri;return e({internal:!0,message:"Found unsupported "+(i||"unknown")+" container for initialization segment at URL: "+r,code:Ao.FAILURE})}eg({action:"probeMp4Tracks",data:t.map.bytes,transmuxer:t.transmuxer,callback:function(s){var a=s.tracks,l=s.data;return t.map.bytes=l,a.forEach(function(u){t.map.tracks=t.map.tracks||{},!t.map.tracks[u.type]&&(t.map.tracks[u.type]=u,typeof u.id=="number"&&u.timescale&&(t.map.timescales=t.map.timescales||{},t.map.timescales[u.id]=u.timescale))}),e(null)}})},O5=function(t){var e=t.segment,i=t.finishProcessingFn;return function(r,o){var s=ew(r,o);if(s)return i(s,e);var a=new Uint8Array(o.response);if(e.map.key)return e.map.encryptedBytes=a,i(null,e);e.map.bytes=a,ok(e,function(l){if(l)return l.xhr=o,l.status=o.status,i(l,e);i(null,e)})}},H5=function(t){var e=t.segment,i=t.finishProcessingFn,r=t.responseType;return function(o,s){var a=ew(o,s);if(a)return i(a,e);var l=r==="arraybuffer"||!s.responseText?s.response:T5(s.responseText.substring(e.lastReachedChar||0));return e.stats=I5(s),e.key?e.encryptedBytes=new Uint8Array(l):e.bytes=new Uint8Array(l),i(null,e)}},z5=function(t){var e=t.segment,i=t.bytes,r=t.trackInfoFn,o=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,a=t.audioSegmentTimingInfoFn,l=t.id3Fn,u=t.captionsFn,h=t.isEndOfTimeline,d=t.endedTimelineFn,c=t.dataFn,f=t.doneFn,g=t.onTransmuxerLog,m=e.map&&e.map.tracks||{},p=!!(m.audio&&m.video),v=o.bind(null,e,"audio","start"),b=o.bind(null,e,"audio","end"),C=o.bind(null,e,"video","start"),y=o.bind(null,e,"video","end"),w=function(){return nk({bytes:i,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,remux:p,onData:function(T){T.type=T.type==="combined"?"video":T.type,c(e,T)},onTrackInfo:function(T){r&&(p&&(T.isMuxed=!0),r(e,T))},onAudioTimingInfo:function(T){v&&typeof T.start<"u"&&(v(T.start),v=null),b&&typeof T.end<"u"&&b(T.end)},onVideoTimingInfo:function(T){C&&typeof T.start<"u"&&(C(T.start),C=null),y&&typeof T.end<"u"&&y(T.end)},onVideoSegmentTimingInfo:function(T){s(T)},onAudioSegmentTimingInfo:function(T){a(T)},onId3:function(T,S){l(e,T,S)},onCaptions:function(T){u(e,[T])},isEndOfTimeline:h,onEndedTimeline:function(){d()},onTransmuxerLog:g,onDone:function(T){f&&(T.type=T.type==="combined"?"video":T.type,f(null,e,T))}})};eg({action:"probeTs",transmuxer:e.transmuxer,data:i,baseStartTime:e.baseStartTime,callback:function(A){e.bytes=i=A.data;var T=A.result;T&&(r(e,{hasAudio:T.hasAudio,hasVideo:T.hasVideo,isMuxed:p}),r=null,T.hasAudio&&!p&&v(T.audioStart),T.hasVideo&&C(T.videoStart),v=null,C=null),w()}})},sk=function(t){var e=t.segment,i=t.bytes,r=t.trackInfoFn,o=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,a=t.audioSegmentTimingInfoFn,l=t.id3Fn,u=t.captionsFn,h=t.isEndOfTimeline,d=t.endedTimelineFn,c=t.dataFn,f=t.doneFn,g=t.onTransmuxerLog,m=new Uint8Array(i);if(rz(m)){e.isFmp4=!0;var p=e.map.tracks,v={isFmp4:!0,hasVideo:!!p.video,hasAudio:!!p.audio};p.audio&&p.audio.codec&&p.audio.codec!=="enca"&&(v.audioCodec=p.audio.codec),p.video&&p.video.codec&&p.video.codec!=="encv"&&(v.videoCodec=p.video.codec),p.video&&p.audio&&(v.isMuxed=!0),r(e,v);var b=function(y){c(e,{data:m,type:v.hasAudio&&!v.isMuxed?"audio":"video"}),y&&y.length&&u(e,y),f(null,e,{})};eg({action:"probeMp4StartTime",timescales:e.map.timescales,data:m,transmuxer:e.transmuxer,callback:function(y){var w=y.data,_=y.startTime;if(i=w.buffer,e.bytes=m=w,v.hasAudio&&!v.isMuxed&&o(e,"audio","start",_),v.hasVideo&&o(e,"video","start",_),!p.video||!w.byteLength||!e.transmuxer){b();return}eg({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:e.transmuxer,data:m,timescales:e.map.timescales,trackIds:[p.video.id],callback:function(T){i=T.data.buffer,e.bytes=m=T.data,T.logs.forEach(function(S){g(ot.mergeOptions(S,{stream:"mp4CaptionParser"}))}),b(T.captions)}})}});return}if(!e.transmuxer){f(null,e,{});return}if(typeof e.container>"u"&&(e.container=Cy(m)),e.container!=="ts"&&e.container!=="aac"){r(e,{hasAudio:!1,hasVideo:!1}),f(null,e,{});return}z5({segment:e,bytes:i,trackInfoFn:r,timingInfoFn:o,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:l,captionsFn:u,isEndOfTimeline:h,endedTimelineFn:d,dataFn:c,doneFn:f,onTransmuxerLog:g})},ak=function(t,e){var i=t.id,r=t.key,o=t.encryptedBytes,s=t.decryptionWorker,a=function u(h){if(h.data.source===i){s.removeEventListener("message",u);var d=h.data.decrypted;e(new Uint8Array(d.bytes,d.byteOffset,d.byteLength))}};s.addEventListener("message",a);var l;r.bytes.slice?l=r.bytes.slice():l=new Uint32Array(Array.prototype.slice.call(r.bytes)),s.postMessage($P({source:i,encrypted:o,key:l,iv:r.iv}),[o.buffer,l.buffer])},N5=function(t){var e=t.decryptionWorker,i=t.segment,r=t.trackInfoFn,o=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,a=t.audioSegmentTimingInfoFn,l=t.id3Fn,u=t.captionsFn,h=t.isEndOfTimeline,d=t.endedTimelineFn,c=t.dataFn,f=t.doneFn,g=t.onTransmuxerLog;ak({id:i.requestId,key:i.key,encryptedBytes:i.encryptedBytes,decryptionWorker:e},function(m){i.bytes=m,sk({segment:i,bytes:i.bytes,trackInfoFn:r,timingInfoFn:o,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:l,captionsFn:u,isEndOfTimeline:h,endedTimelineFn:d,dataFn:c,doneFn:f,onTransmuxerLog:g})})},W5=function(t){var e=t.activeXhrs,i=t.decryptionWorker,r=t.trackInfoFn,o=t.timingInfoFn,s=t.videoSegmentTimingInfoFn,a=t.audioSegmentTimingInfoFn,l=t.id3Fn,u=t.captionsFn,h=t.isEndOfTimeline,d=t.endedTimelineFn,c=t.dataFn,f=t.doneFn,g=t.onTransmuxerLog,m=0,p=!1;return function(v,b){if(!p){if(v)return p=!0,p_(e),f(v,b);if(m+=1,m===e.length){var C=function(){if(b.encryptedBytes)return N5({decryptionWorker:i,segment:b,trackInfoFn:r,timingInfoFn:o,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:l,captionsFn:u,isEndOfTimeline:h,endedTimelineFn:d,dataFn:c,doneFn:f,onTransmuxerLog:g});sk({segment:b,bytes:b.bytes,trackInfoFn:r,timingInfoFn:o,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:l,captionsFn:u,isEndOfTimeline:h,endedTimelineFn:d,dataFn:c,doneFn:f,onTransmuxerLog:g})};if(b.endOfAllRequests=Date.now(),b.map&&b.map.encryptedBytes&&!b.map.bytes)return ak({decryptionWorker:i,id:b.requestId+"-init",encryptedBytes:b.map.encryptedBytes,key:b.map.key},function(y){b.map.bytes=y,ok(b,function(w){if(w)return p_(e),f(w,b);C()})});C()}}}},U5=function(t){var e=t.loadendState,i=t.abortFn;return function(r){var o=r.target;o.aborted&&i&&!e.calledAbortFn&&(i(),e.calledAbortFn=!0)}},V5=function(t){var e=t.segment,i=t.progressFn;return function(r){var o=r.target;if(!o.aborted)return e.stats=ot.mergeOptions(e.stats,F5(r)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),i(r,e)}},j5=function(t){var e=t.xhr,i=t.xhrOptions,r=t.decryptionWorker,o=t.segment,s=t.abortFn,a=t.progressFn,l=t.trackInfoFn,u=t.timingInfoFn,h=t.videoSegmentTimingInfoFn,d=t.audioSegmentTimingInfoFn,c=t.id3Fn,f=t.captionsFn,g=t.isEndOfTimeline,m=t.endedTimelineFn,p=t.dataFn,v=t.doneFn,b=t.onTransmuxerLog,C=[],y=W5({activeXhrs:C,decryptionWorker:r,trackInfoFn:l,timingInfoFn:u,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:d,id3Fn:c,captionsFn:f,isEndOfTimeline:g,endedTimelineFn:m,dataFn:p,doneFn:v,onTransmuxerLog:b});if(o.key&&!o.key.bytes){var w=[o.key];o.map&&!o.map.bytes&&o.map.key&&o.map.key.resolvedUri===o.key.resolvedUri&&w.push(o.map.key);var _=ot.mergeOptions(i,{uri:o.key.resolvedUri,responseType:"arraybuffer"}),A=cx(o,w,y),T=e(_,A);C.push(T)}if(o.map&&!o.map.bytes){var S=o.map.key&&(!o.key||o.key.resolvedUri!==o.map.key.resolvedUri);if(S){var x=ot.mergeOptions(i,{uri:o.map.key.resolvedUri,responseType:"arraybuffer"}),E=cx(o,[o.map.key],y),M=e(x,E);C.push(M)}var L=ot.mergeOptions(i,{uri:o.map.resolvedUri,responseType:"arraybuffer",headers:f_(o.map)}),I=O5({segment:o,finishProcessingFn:y}),D=e(L,I);C.push(D)}var H=ot.mergeOptions(i,{uri:o.part&&o.part.resolvedUri||o.resolvedUri,responseType:"arraybuffer",headers:f_(o)}),O=H5({segment:o,finishProcessingFn:y,responseType:H.responseType}),N=e(H,O);N.addEventListener("progress",V5({segment:o,progressFn:a})),C.push(N);var U={};return C.forEach(function(W){W.addEventListener("loadend",U5({loadendState:U,abortFn:s}))}),function(){return p_(C)}},G5=oo("CodecUtils"),$5=function(t){var e=t.attributes||{};if(e.CODECS)return vo(e.CODECS)},lk=function(t,e){var i=e.attributes||{};return t&&t.mediaGroups&&t.mediaGroups.AUDIO&&i.AUDIO&&t.mediaGroups.AUDIO[i.AUDIO]},q5=function(t,e){if(!lk(t,e))return!0;var i=e.attributes||{},r=t.mediaGroups.AUDIO[i.AUDIO];for(var o in r)if(!r[o].uri&&!r[o].playlists)return!0;return!1},ig=function(t){var e={};return t.forEach(function(i){var r=i.mediaType,o=i.type,s=i.details;e[r]=e[r]||[],e[r].push(sB(""+o+s))}),Object.keys(e).forEach(function(i){if(e[i].length>1){G5("multiple "+i+" codecs found as attributes: "+e[i].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."),e[i]=null;return}e[i]=e[i][0]}),e},fx=function(t){var e=0;return t.audio&&e++,t.video&&e++,e},Oh=function(t,e){var i=e.attributes||{},r=ig($5(e)||[]);if(lk(t,e)&&!r.audio&&!q5(t,e)){var o=ig(P3(t,i.AUDIO)||[]);o.audio&&(r.audio=o.audio)}return r},Dc=oo("PlaylistSelector"),gx=function(t){if(!(!t||!t.playlist)){var e=t.playlist;return JSON.stringify({id:e.id,bandwidth:t.bandwidth,width:t.width,height:t.height,codecs:e.attributes&&e.attributes.CODECS||""})}},rg=function(t,e){if(!t)return"";var i=K.getComputedStyle(t);return i?i[e]:""},Ul=function(t,e){var i=t.slice();t.sort(function(r,o){var s=e(r,o);return s===0?i.indexOf(r)-i.indexOf(o):s})},iw=function(t,e){var i,r;return t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||K.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),r=r||K.Number.MAX_VALUE,i-r},X5=function(t,e){var i,r;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||K.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),r=r||K.Number.MAX_VALUE,i===r&&t.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?t.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-r},uk=function(t,e,i,r,o,s){if(t){var a={bandwidth:e,width:i,height:r,limitRenditionByPlayerDimensions:o},l=t.playlists;jr.isAudioOnly(t)&&(l=s.getAudioTrackPlaylists_(),a.audioOnly=!0);var u=l.map(function(x){var E,M=x.attributes&&x.attributes.RESOLUTION&&x.attributes.RESOLUTION.width,L=x.attributes&&x.attributes.RESOLUTION&&x.attributes.RESOLUTION.height;return E=x.attributes&&x.attributes.BANDWIDTH,E=E||K.Number.MAX_VALUE,{bandwidth:E,width:M,height:L,playlist:x}});Ul(u,function(x,E){return x.bandwidth-E.bandwidth}),u=u.filter(function(x){return!jr.isIncompatible(x.playlist)});var h=u.filter(function(x){return jr.isEnabled(x.playlist)});h.length||(h=u.filter(function(x){return!jr.isDisabled(x.playlist)}));var d=h.filter(function(x){return x.bandwidth*Gi.BANDWIDTH_VARIANCE<e}),c=d[d.length-1],f=d.filter(function(x){return x.bandwidth===c.bandwidth})[0];if(o===!1){var g=f||h[0]||u[0];if(g&&g.playlist){var m="sortedPlaylistReps";return f&&(m="bandwidthBestRep"),h[0]&&(m="enabledPlaylistReps"),Dc("choosing "+gx(g)+" using "+m+" with options",a),g.playlist}return Dc("could not choose a playlist with options",a),null}var p=d.filter(function(x){return x.width&&x.height});Ul(p,function(x,E){return x.width-E.width});var v=p.filter(function(x){return x.width===i&&x.height===r});c=v[v.length-1];var b=v.filter(function(x){return x.bandwidth===c.bandwidth})[0],C,y,w;b||(C=p.filter(function(x){return x.width>i||x.height>r}),y=C.filter(function(x){return x.width===C[0].width&&x.height===C[0].height}),c=y[y.length-1],w=y.filter(function(x){return x.bandwidth===c.bandwidth})[0]);var _;if(s.experimentalLeastPixelDiffSelector){var A=p.map(function(x){return x.pixelDiff=Math.abs(x.width-i)+Math.abs(x.height-r),x});Ul(A,function(x,E){return x.pixelDiff===E.pixelDiff?E.bandwidth-x.bandwidth:x.pixelDiff-E.pixelDiff}),_=A[0]}var T=_||w||b||f||h[0]||u[0];if(T&&T.playlist){var S="sortedPlaylistReps";return _?S="leastPixelDiffRep":w?S="resolutionPlusOneRep":b?S="resolutionBestRep":f?S="bandwidthBestRep":h[0]&&(S="enabledPlaylistReps"),Dc("choosing "+gx(T)+" using "+S+" with options",a),T.playlist}return Dc("could not choose a playlist with options",a),null}},px=function(){var t=this.useDevicePixelRatio&&K.devicePixelRatio||1;return uk(this.playlists.master,this.systemBandwidth,parseInt(rg(this.tech_.el(),"width"),10)*t,parseInt(rg(this.tech_.el(),"height"),10)*t,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)},Y5=function(t){var e=-1,i=-1;if(t<0||t>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var r=this.useDevicePixelRatio&&K.devicePixelRatio||1;return e<0&&(e=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(e=t*this.systemBandwidth+(1-t)*e,i=this.systemBandwidth),uk(this.playlists.master,e,parseInt(rg(this.tech_.el(),"width"),10)*r,parseInt(rg(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}},K5=function(t){var e=t.master,i=t.currentTime,r=t.bandwidth,o=t.duration,s=t.segmentDuration,a=t.timeUntilRebuffer,l=t.currentTimeline,u=t.syncController,h=e.playlists.filter(function(m){return!jr.isIncompatible(m)}),d=h.filter(jr.isEnabled);d.length||(d=h.filter(function(m){return!jr.isDisabled(m)}));var c=d.filter(jr.hasAttribute.bind(null,"BANDWIDTH")),f=c.map(function(m){var p=u.getSyncPoint(m,o,l,i),v=p?1:2,b=jr.estimateSegmentRequestTime(s,r,m),C=b*v-a;return{playlist:m,rebufferingImpact:C}}),g=f.filter(function(m){return m.rebufferingImpact<=0});return Ul(g,function(m,p){return iw(p.playlist,m.playlist)}),g.length?g[0]:(Ul(f,function(m,p){return m.rebufferingImpact-p.rebufferingImpact}),f[0]||null)},Z5=function(){var t=this,e=this.playlists.master.playlists.filter(jr.isEnabled);Ul(e,function(r,o){return iw(r,o)});var i=e.filter(function(r){return!!Oh(t.playlists.master,r).video});return i[0]||null},Q5=function(t){var e=0,i;return t.bytes&&(i=new Uint8Array(t.bytes),t.segments.forEach(function(r){i.set(r,e),e+=r.byteLength})),i},J5=function(t,e,i){if(!t[i]){e.trigger({type:"usage",name:"vhs-608"}),e.trigger({type:"usage",name:"hls-608"});var r=i;/^cc708_/.test(i)&&(r="SERVICE"+i.split("_")[1]);var o=e.textTracks().getTrackById(r);if(o)t[i]=o;else{var s=e.options_.vhs&&e.options_.vhs.captionServices||{},a=i,l=i,u=!1,h=s[r];h&&(a=h.label,l=h.language,u=h.default),t[i]=e.addRemoteTextTrack({kind:"captions",id:r,default:u,label:a,language:l},!1).track}}},tW=function(t){var e=t.inbandTextTracks,i=t.captionArray,r=t.timestampOffset;if(i){var o=K.WebKitDataCue||K.VTTCue;i.forEach(function(s){var a=s.stream;e[a].addCue(new o(s.startTime+r,s.endTime+r,s.text))})}},eW=function(t){Object.defineProperties(t.frame,{id:{get:function(){return ot.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return ot.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return ot.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},iW=function(t){var e=t.inbandTextTracks,i=t.metadataArray,r=t.timestampOffset,o=t.videoDuration;if(i){var s=K.WebKitDataCue||K.VTTCue,a=e.metadataTrack_;if(a&&(i.forEach(function(f){var g=f.cueTime+r;typeof g!="number"||K.isNaN(g)||g<0||!(g<1/0)||f.frames.forEach(function(m){var p=new s(g,g,m.value||m.url||m.data||"");p.frame=m,p.value=m,eW(p),a.addCue(p)})}),!(!a.cues||!a.cues.length))){for(var l=a.cues,u=[],h=0;h<l.length;h++)l[h]&&u.push(l[h]);var d=u.reduce(function(f,g){var m=f[g.startTime]||[];return m.push(g),f[g.startTime]=m,f},{}),c=Object.keys(d).sort(function(f,g){return Number(f)-Number(g)});c.forEach(function(f,g){var m=d[f],p=Number(c[g+1])||o;m.forEach(function(v){v.endTime=p})})}}},rW=function(t,e,i){t.metadataTrack_||(t.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,t.metadataTrack_.inBandMetadataTrackDispatchType=e)},Th=function(t,e,i){var r,o;if(i&&i.cues)for(r=i.cues.length;r--;)o=i.cues[r],o.startTime>=t&&o.endTime<=e&&i.removeCue(o)},nW=function(t){var e=t.cues;if(e)for(var i=0;i<e.length;i++){for(var r=[],o=0,s=0;s<e.length;s++)e[i].startTime===e[s].startTime&&e[i].endTime===e[s].endTime&&e[i].text===e[s].text&&(o++,o>1&&r.push(e[s]));r.length&&r.forEach(function(a){return t.removeCue(a)})}},oW=function(t,e,i){if(typeof e>"u"||e===null||!t.length)return[];var r=Math.ceil((e-i+3)*Uf.ONE_SECOND_IN_TS),o;for(o=0;o<t.length&&!(t[o].pts>r);o++);return t.slice(o)},sW=function(t,e,i){if(!e.length)return t;if(i)return e.slice();var r=e[0].pts,o=0;for(o;o<t.length&&!(t[o].pts>=r);o++);return t.slice(0,o).concat(e)},aW=function(t,e,i,r){for(var o=Math.ceil((e-r)*Uf.ONE_SECOND_IN_TS),s=Math.ceil((i-r)*Uf.ONE_SECOND_IN_TS),a=t.slice(),l=t.length;l--&&!(t[l].pts<=s););if(l===-1)return a;for(var u=l+1;u--&&!(t[u].pts<=o););return u=Math.max(u,0),a.splice(u,l-u+1),a},lW=function(t,e){if(!t&&!e||!t&&e||t&&!e)return!1;if(t===e)return!0;var i=Object.keys(t).sort(),r=Object.keys(e).sort();if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++){var s=i[o];if(s!==r[o]||t[s]!==e[s])return!1}return!0},hk=22,uW=function(t,e,i){e=e||[];for(var r=[],o=0,s=0;s<e.length;s++){var a=e[s];if(t===a.timeline&&(r.push(s),o+=a.duration,o>i))return s}return r.length===0?0:r[r.length-1]},nh=1,hW=500,mx=function(t){return typeof t=="number"&&isFinite(t)},Ic=1/60,dW=function(t,e,i){return t!=="main"||!e||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null},cW=function(t,e,i){var r=e-Gi.BACK_BUFFER_LENGTH;t.length&&(r=Math.max(r,t.start(0)));var o=e-i;return Math.min(o,r)},fl=function(t){var e=t.startOfSegment,i=t.duration,r=t.segment,o=t.part,s=t.playlist,a=s.mediaSequence,l=s.id,u=s.segments,h=u===void 0?[]:u,d=t.mediaIndex,c=t.partIndex,f=t.timeline,g=h.length-1,m="mediaIndex/partIndex increment";t.getMediaInfoForTime?m="getMediaInfoForTime ("+t.getMediaInfoForTime+")":t.isSyncRequest&&(m="getSyncSegmentCandidate (isSyncRequest)"),t.independent&&(m+=" with independent "+t.independent);var p=typeof c=="number",v=t.segment.uri?"segment":"pre-segment",b=p?kP({preloadSegment:r})-1:0;return v+" ["+(a+d)+"/"+(a+g)+"]"+(p?" part ["+c+"/"+b+"]":"")+(" segment start/end ["+r.start+" => "+r.end+"]")+(p?" part start/end ["+o.start+" => "+o.end+"]":"")+(" startOfSegment ["+e+"]")+(" duration ["+i+"]")+(" timeline ["+f+"]")+(" selected by ["+m+"]")+(" playlist ["+l+"]")},vx=function(t){return t+"TimingInfo"},fW=function(t){var e=t.segmentTimeline,i=t.currentTimeline,r=t.startOfSegment,o=t.buffered,s=t.overrideCheck;return!s&&e===i?null:e<i?r:o.length?o.end(o.length-1):r},bx=function(t){var e=t.timelineChangeController,i=t.currentTimeline,r=t.segmentTimeline,o=t.loaderType,s=t.audioDisabled;if(i===r)return!1;if(o==="audio"){var a=e.lastTimelineChange({type:"main"});return!a||a.to!==r}if(o==="main"&&s){var l=e.pendingTimelineChange({type:"audio"});return!(l&&l.to===r)}return!1},gW=function(t){var e=0;return["video","audio"].forEach(function(i){var r=t[i+"TimingInfo"];if(r){var o=r.start,s=r.end,a;typeof o=="bigint"||typeof s=="bigint"?a=K.BigInt(s)-K.BigInt(o):typeof o=="number"&&typeof s=="number"&&(a=s-o),typeof a<"u"&&a>e&&(e=a)}}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},_x=function(t){var e=t.segmentDuration,i=t.maxDuration;return e?Math.round(e)>i+js:!1},pW=function(t,e){if(e!=="hls")return null;var i=gW({audioTimingInfo:t.audioTimingInfo,videoTimingInfo:t.videoTimingInfo});if(!i)return null;var r=t.playlist.targetDuration,o=_x({segmentDuration:i,maxDuration:r*2}),s=_x({segmentDuration:i,maxDuration:r}),a="Segment with index "+t.mediaIndex+" "+("from playlist "+t.playlist.id+" ")+("has a duration of "+i+" ")+("when the reported duration is "+t.duration+" ")+("and the target duration is "+r+". ")+"For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return o||s?{severity:o?"warn":"info",message:a}:null},m_=function(n){kt(t,n);function t(i,r){var o;if(o=n.call(this)||this,!i)throw new TypeError("Initialization settings are required");if(typeof i.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!i.mediaSource)throw new TypeError("No MediaSource specified");return o.bandwidth=i.bandwidth,o.throughput={rate:0,count:0},o.roundTrip=NaN,o.resetStats_(),o.mediaIndex=null,o.partIndex=null,o.hasPlayed_=i.hasPlayed,o.currentTime_=i.currentTime,o.seekable_=i.seekable,o.seeking_=i.seeking,o.duration_=i.duration,o.mediaSource_=i.mediaSource,o.vhs_=i.vhs,o.loaderType_=i.loaderType,o.currentMediaInfo_=void 0,o.startingMediaInfo_=void 0,o.segmentMetadataTrack_=i.segmentMetadataTrack,o.goalBufferLength_=i.goalBufferLength,o.sourceType_=i.sourceType,o.sourceUpdater_=i.sourceUpdater,o.inbandTextTracks_=i.inbandTextTracks,o.state_="INIT",o.timelineChangeController_=i.timelineChangeController,o.shouldSaveSegmentTimingInfo_=!0,o.parse708captions_=i.parse708captions,o.useDtsForTimestampOffset_=i.useDtsForTimestampOffset,o.captionServices_=i.captionServices,o.experimentalExactManifestTimings=i.experimentalExactManifestTimings,o.checkBufferTimeout_=null,o.error_=void 0,o.currentTimeline_=-1,o.pendingSegment_=null,o.xhrOptions_=null,o.pendingSegments_=[],o.audioDisabled_=!1,o.isPendingTimestampOffset_=!1,o.gopBuffer_=[],o.timeMapping_=0,o.safeAppend_=ot.browser.IE_VERSION>=11,o.appendInitSegment_={audio:!0,video:!0},o.playlistOfLastInitSegment_={audio:null,video:null},o.callQueue_=[],o.loadQueue_=[],o.metadataQueue_={id3:[],caption:[]},o.waitingOnRemove_=!1,o.quotaExceededErrorRetryTimeout_=null,o.activeInitSegmentId_=null,o.initSegments_={},o.cacheEncryptionKeys_=i.cacheEncryptionKeys,o.keyCache_={},o.decrypter_=i.decrypter,o.syncController_=i.syncController,o.syncPoint_={segmentIndex:0,time:0},o.transmuxer_=o.createTransmuxer_(),o.triggerSyncInfoUpdate_=function(){return o.trigger("syncinfoupdate")},o.syncController_.on("syncinfoupdate",o.triggerSyncInfoUpdate_),o.mediaSource_.addEventListener("sourceopen",function(){o.isEndOfStream_()||(o.ended_=!1)}),o.fetchAtBuffer_=!1,o.logger_=oo("SegmentLoader["+o.loaderType_+"]"),Object.defineProperty(he(o),"state",{get:function(){return this.state_},set:function(a){a!==this.state_&&(this.logger_(this.state_+" -> "+a),this.state_=a,this.trigger("statechange"))}}),o.sourceUpdater_.on("ready",function(){o.hasEnoughInfoToAppend_()&&o.processCallQueue_()}),o.loaderType_==="main"&&o.timelineChangeController_.on("pendingtimelinechange",function(){o.hasEnoughInfoToAppend_()&&o.processCallQueue_()}),o.loaderType_==="audio"&&o.timelineChangeController_.on("timelinechange",function(){o.hasEnoughInfoToLoad_()&&o.processLoadQueue_(),o.hasEnoughInfoToAppend_()&&o.processCallQueue_()}),o}var e=t.prototype;return e.createTransmuxer_=function(){return Q0.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})},e.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0},e.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&K.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},e.setAudio=function(r){this.audioDisabled_=!r,r?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},e.abort=function(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()},e.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,K.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null},e.checkForAbort_=function(r){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==r},e.error=function(r){return typeof r<"u"&&(this.logger_("error occurred:",r),this.error_=r),this.pendingSegment_=null,this.error_},e.endOfStream=function(){this.ended_=!0,this.transmuxer_&&Q0.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},e.buffered_=function(){var r=this.getMediaInfo_();if(!this.sourceUpdater_||!r)return ot.createTimeRanges();if(this.loaderType_==="main"){var o=r.hasAudio,s=r.hasVideo,a=r.isMuxed;if(s&&o&&!this.audioDisabled_&&!a)return this.sourceUpdater_.buffered();if(s)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},e.initSegmentForMap=function(r,o){if(o===void 0&&(o=!1),!r)return null;var s=tg(r),a=this.initSegments_[s];return o&&!a&&r.bytes&&(this.initSegments_[s]=a={resolvedUri:r.resolvedUri,byterange:r.byterange,bytes:r.bytes,tracks:r.tracks,timescales:r.timescales}),a||r},e.segmentKey=function(r,o){if(o===void 0&&(o=!1),!r)return null;var s=qP(r),a=this.keyCache_[s];this.cacheEncryptionKeys_&&o&&!a&&r.bytes&&(this.keyCache_[s]=a={resolvedUri:r.resolvedUri,bytes:r.bytes});var l={resolvedUri:(a||r).resolvedUri};return a&&(l.bytes=a.bytes),l},e.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},e.load=function(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}},e.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},e.playlist=function(r,o){if(o===void 0&&(o={}),!!r){var s=this.playlist_,a=this.pendingSegment_;this.playlist_=r,this.xhrOptions_=o,this.state==="INIT"&&(r.syncInfo={mediaSequence:r.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(r));var l=null;if(s&&(s.id?l=s.id:s.uri&&(l=s.uri)),this.logger_("playlist update ["+l+" => "+(r.id||r.uri)+"]"),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!s||s.uri!==r.uri){this.mediaIndex!==null&&(r.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}var u=r.mediaSequence-s.mediaSequence;if(this.logger_("live window shift ["+u+"]"),this.mediaIndex!==null)if(this.mediaIndex-=u,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var h=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!h.parts||!h.parts.length||!h.parts[this.partIndex])){var d=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists."),this.resetLoader(),this.mediaIndex=d}}a&&(a.mediaIndex-=u,a.mediaIndex<0?(a.mediaIndex=null,a.partIndex=null):(a.mediaIndex>=0&&(a.segment=r.segments[a.mediaIndex]),a.partIndex>=0&&a.segment.parts&&(a.part=a.segment.parts[a.partIndex]))),this.syncController_.saveExpiredSegmentInfo(s,r)}},e.pause=function(){this.checkBufferTimeout_&&(K.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},e.paused=function(){return this.checkBufferTimeout_===null},e.resetEverything=function(r){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,r),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))},e.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},e.resyncLoader=function(){this.transmuxer_&&Q0.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},e.remove=function(r,o,s,a){if(s===void 0&&(s=function(){}),a===void 0&&(a=!1),o===1/0&&(o=this.duration_()),o<=r){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}var l=1,u=function(){l--,l===0&&s()};(a||!this.audioDisabled_)&&(l++,this.sourceUpdater_.removeAudio(r,o,u)),(a||this.loaderType_==="main")&&(this.gopBuffer_=aW(this.gopBuffer_,r,o,this.timeMapping_),l++,this.sourceUpdater_.removeVideo(r,o,u));for(var h in this.inbandTextTracks_)Th(r,o,this.inbandTextTracks_[h]);Th(r,o,this.segmentMetadataTrack_),u()},e.monitorBuffer_=function(){this.checkBufferTimeout_&&K.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=K.setTimeout(this.monitorBufferTick_.bind(this),1)},e.monitorBufferTick_=function(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&K.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=K.setTimeout(this.monitorBufferTick_.bind(this),hW)},e.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){var r=this.chooseNextRequest_();r&&(typeof r.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:r.timeline})),this.loadSegment_(r))}},e.isEndOfStream_=function(r,o,s){if(r===void 0&&(r=this.mediaIndex),o===void 0&&(o=this.playlist_),s===void 0&&(s=this.partIndex),!o||!this.mediaSource_)return!1;var a=typeof r=="number"&&o.segments[r],l=r+1===o.segments.length,u=!a||!a.parts||s+1===a.parts.length;return o.endList&&this.mediaSource_.readyState==="open"&&l&&u},e.chooseNextRequest_=function(){var r=this.buffered_(),o=sx(r)||0,s=Ky(r,this.currentTime_()),a=!this.hasPlayed_()&&s>=1,l=s>=this.goalBufferLength_(),u=this.playlist_.segments;if(!u.length||a||l)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var h={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(h.isSyncRequest)h.mediaIndex=uW(this.currentTimeline_,u,o);else if(this.mediaIndex!==null){var d=u[this.mediaIndex],c=typeof this.partIndex=="number"?this.partIndex:-1;h.startOfSegment=d.end?d.end:o,d.parts&&d.parts[c+1]?(h.mediaIndex=this.mediaIndex,h.partIndex=c+1):h.mediaIndex=this.mediaIndex+1}else{var f=jr.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?o:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),g=f.segmentIndex,m=f.startTime,p=f.partIndex;h.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+o:"currentTime "+this.currentTime_(),h.mediaIndex=g,h.startOfSegment=m,h.partIndex=p}var v=u[h.mediaIndex],b=v&&typeof h.partIndex=="number"&&v.parts&&v.parts[h.partIndex];if(!v||typeof h.partIndex=="number"&&!b)return null;if(typeof h.partIndex!="number"&&v.parts&&(h.partIndex=0,b=v.parts[0]),!s&&b&&!b.independent)if(h.partIndex===0){var C=u[h.mediaIndex-1],y=C.parts&&C.parts.length&&C.parts[C.parts.length-1];y&&y.independent&&(h.mediaIndex-=1,h.partIndex=C.parts.length-1,h.independent="previous segment")}else v.parts[h.partIndex-1].independent&&(h.partIndex-=1,h.independent="previous part");var w=this.mediaSource_&&this.mediaSource_.readyState==="ended";return h.mediaIndex>=u.length-1&&w&&!this.seeking_()?null:this.generateSegmentInfo_(h)},e.generateSegmentInfo_=function(r){var o=r.independent,s=r.playlist,a=r.mediaIndex,l=r.startOfSegment,u=r.isSyncRequest,h=r.partIndex,d=r.forceTimestampOffset,c=r.getMediaInfoForTime,f=s.segments[a],g=typeof h=="number"&&f.parts[h],m={requestId:"segment-loader-"+Math.random(),uri:g&&g.resolvedUri||f.resolvedUri,mediaIndex:a,partIndex:g?h:null,isSyncRequest:u,startOfSegment:l,playlist:s,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:f.timeline,duration:g&&g.duration||f.duration,segment:f,part:g,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:c,independent:o},p=typeof d<"u"?d:this.isPendingTimestampOffset_;m.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:f.timeline,currentTimeline:this.currentTimeline_,startOfSegment:l,buffered:this.buffered_(),overrideCheck:p});var v=sx(this.sourceUpdater_.audioBuffered());return typeof v=="number"&&(m.audioAppendStart=v-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(m.gopsToAlignWith=oW(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),m},e.timestampOffsetForSegment_=function(r){return fW(r)},e.earlyAbortWhenNeeded_=function(r){if(!(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)&&!(Date.now()-(r.firstBytesReceivedAt||Date.now())<1e3)){var o=this.currentTime_(),s=r.bandwidth,a=this.pendingSegment_.duration,l=jr.estimateSegmentRequestTime(a,s,this.playlist_,r.bytesReceived),u=FN(this.buffered_(),o,this.vhs_.tech_.playbackRate())-1;if(!(l<=u)){var h=K5({master:this.vhs_.playlists.master,currentTime:o,bandwidth:s,duration:this.duration_(),segmentDuration:a,timeUntilRebuffer:u,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(h){var d=l-u,c=d-h.rebufferingImpact,f=.5;u<=js&&(f=1),!(!h.playlist||h.playlist.uri===this.playlist_.uri||c<f)&&(this.bandwidth=h.playlist.attributes.BANDWIDTH*Gi.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},e.handleAbort_=function(r){this.logger_("Aborting "+fl(r)),this.mediaRequestsAborted+=1},e.handleProgress_=function(r,o){this.earlyAbortWhenNeeded_(o.stats),!this.checkForAbort_(o.requestId)&&this.trigger("progress")},e.handleTrackInfo_=function(r,o){this.earlyAbortWhenNeeded_(r.stats),!this.checkForAbort_(r.requestId)&&(this.checkForIllegalMediaSwitch(o)||(o=o||{},lW(this.currentMediaInfo_,o)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=o,this.currentMediaInfo_=o,this.logger_("trackinfo update",o),this.trigger("trackinfo")),!this.checkForAbort_(r.requestId)&&(this.pendingSegment_.trackInfo=o,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))},e.handleTimingInfo_=function(r,o,s,a){if(this.earlyAbortWhenNeeded_(r.stats),!this.checkForAbort_(r.requestId)){var l=this.pendingSegment_,u=vx(o);l[u]=l[u]||{},l[u][s]=a,this.logger_("timinginfo: "+o+" - "+s+" - "+a),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},e.handleCaptions_=function(r,o){var s=this;if(this.earlyAbortWhenNeeded_(r.stats),!this.checkForAbort_(r.requestId)){if(o.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}var a=this.pendingSegment_;if(!a.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,r,o));return}var l=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),u={};o.forEach(function(h){u[h.stream]=u[h.stream]||{startTime:1/0,captions:[],endTime:0};var d=u[h.stream];d.startTime=Math.min(d.startTime,h.startTime+l),d.endTime=Math.max(d.endTime,h.endTime+l),d.captions.push(h)}),Object.keys(u).forEach(function(h){var d=u[h],c=d.startTime,f=d.endTime,g=d.captions,m=s.inbandTextTracks_;s.logger_("adding cues from "+c+" -> "+f+" for "+h),J5(m,s.vhs_.tech_,h),Th(c,f,m[h]),tW({captionArray:g,inbandTextTracks:m,timestampOffset:l})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}},e.handleId3_=function(r,o,s){if(this.earlyAbortWhenNeeded_(r.stats),!this.checkForAbort_(r.requestId)){var a=this.pendingSegment_;if(!a.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,r,o,s));return}var l=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();rW(this.inbandTextTracks_,s,this.vhs_.tech_),iW({inbandTextTracks:this.inbandTextTracks_,metadataArray:o,timestampOffset:l,videoDuration:this.duration_()})}},e.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(r){return r()}),this.metadataQueue_.caption.forEach(function(r){return r()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},e.processCallQueue_=function(){var r=this.callQueue_;this.callQueue_=[],r.forEach(function(o){return o()})},e.processLoadQueue_=function(){var r=this.loadQueue_;this.loadQueue_=[],r.forEach(function(o){return o()})},e.hasEnoughInfoToLoad_=function(){if(this.loaderType_!=="audio")return!0;var r=this.pendingSegment_;return r?this.getCurrentMediaInfo_()?!bx({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:r.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1},e.getCurrentMediaInfo_=function(r){return r===void 0&&(r=this.pendingSegment_),r&&r.trackInfo||this.currentMediaInfo_},e.getMediaInfo_=function(r){return r===void 0&&(r=this.pendingSegment_),this.getCurrentMediaInfo_(r)||this.startingMediaInfo_},e.getPendingSegmentPlaylist=function(){return this.pendingSegment_?this.pendingSegment_.playlist:null},e.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var r=this.pendingSegment_,o=this.getCurrentMediaInfo_();if(!r||!o)return!1;var s=o.hasAudio,a=o.hasVideo,l=o.isMuxed;return!(a&&!r.videoTimingInfo||s&&!this.audioDisabled_&&!l&&!r.audioTimingInfo||bx({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:r.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},e.handleData_=function(r,o){if(this.earlyAbortWhenNeeded_(r.stats),!this.checkForAbort_(r.requestId)){if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,r,o));return}var s=this.pendingSegment_;if(this.setTimeMapping_(s.timeline),this.updateMediaSecondsLoaded_(s.part||s.segment),this.mediaSource_.readyState!=="closed"){if(r.map&&(r.map=this.initSegmentForMap(r.map,!0),s.segment.map=r.map),r.key&&this.segmentKey(r.key,!0),s.isFmp4=r.isFmp4,s.timingInfo=s.timingInfo||{},s.isFmp4)this.trigger("fmp4"),s.timingInfo.start=s[vx(o.type)].start;else{var a=this.getCurrentMediaInfo_(),l=this.loaderType_==="main"&&a&&a.hasVideo,u;l&&(u=s.videoTimingInfo.start),s.timingInfo.start=this.trueSegmentStart_({currentStart:s.timingInfo.start,playlist:s.playlist,mediaIndex:s.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:l,firstVideoFrameTimeForData:u,videoTimingInfo:s.videoTimingInfo,audioTimingInfo:s.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(s,o.type),this.updateSourceBufferTimestampOffset_(s),s.isSyncRequest){this.updateTimingInfoEnd_(s),this.syncController_.saveSegmentTimingInfo({segmentInfo:s,shouldSaveTimelineMapping:this.loaderType_==="main"});var h=this.chooseNextRequest_();if(h.mediaIndex!==s.mediaIndex||h.partIndex!==s.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}s.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(s,o)}}},e.updateAppendInitSegmentStatus=function(r,o){this.loaderType_==="main"&&typeof r.timestampOffset=="number"&&!r.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[o]!==r.playlist&&(this.appendInitSegment_[o]=!0)},e.getInitSegmentAndUpdateState_=function(r){var o=r.type,s=r.initSegment,a=r.map,l=r.playlist;if(a){var u=tg(a);if(this.activeInitSegmentId_===u)return null;s=this.initSegmentForMap(a,!0).bytes,this.activeInitSegmentId_=u}return s&&this.appendInitSegment_[o]?(this.playlistOfLastInitSegment_[o]=l,this.appendInitSegment_[o]=!1,this.activeInitSegmentId_=null,s):null},e.handleQuotaExceededError_=function(r,o){var s=this,a=r.segmentInfo,l=r.type,u=r.bytes,h=this.sourceUpdater_.audioBuffered(),d=this.sourceUpdater_.videoBuffered();h.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Ba(h).join(", ")),d.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Ba(d).join(", "));var c=h.length?h.start(0):0,f=h.length?h.end(h.length-1):0,g=d.length?d.start(0):0,m=d.length?d.end(d.length-1):0;if(f-c<=nh&&m-g<=nh){this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. "+("Appended byte length: "+u.byteLength+", ")+("audio buffer: "+Ba(h).join(", ")+", ")+("video buffer: "+Ba(d).join(", ")+", ")),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:a,type:l,bytes:u}));var p=this.currentTime_(),v=p-nh;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+v),this.remove(0,v,function(){s.logger_("On QUOTA_EXCEEDED_ERR, retrying append in "+nh+"s"),s.waitingOnRemove_=!1,s.quotaExceededErrorRetryTimeout_=K.setTimeout(function(){s.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),s.quotaExceededErrorRetryTimeout_=null,s.processCallQueue_()},nh*1e3)},!0)},e.handleAppendError_=function(r,o){var s=r.segmentInfo,a=r.type,l=r.bytes;if(o){if(o.code===hk){this.handleQuotaExceededError_({segmentInfo:s,type:a,bytes:l});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",o),this.error(a+" append of "+l.length+"b failed for segment "+("#"+s.mediaIndex+" in playlist "+s.playlist.id)),this.trigger("appenderror")}},e.appendToSourceBuffer_=function(r){var o=r.segmentInfo,s=r.type,a=r.initSegment,l=r.data,u=r.bytes;if(!u){var h=[l],d=l.byteLength;a&&(h.unshift(a),d+=a.byteLength),u=Q5({bytes:d,segments:h})}this.sourceUpdater_.appendBuffer({segmentInfo:o,type:s,bytes:u},this.handleAppendError_.bind(this,{segmentInfo:o,type:s,bytes:u}))},e.handleSegmentTimingInfo_=function(r,o,s){if(!(!this.pendingSegment_||o!==this.pendingSegment_.requestId)){var a=this.pendingSegment_.segment,l=r+"TimingInfo";a[l]||(a[l]={}),a[l].transmuxerPrependedSeconds=s.prependedContentDuration||0,a[l].transmuxedPresentationStart=s.start.presentation,a[l].transmuxedDecodeStart=s.start.decode,a[l].transmuxedPresentationEnd=s.end.presentation,a[l].transmuxedDecodeEnd=s.end.decode,a[l].baseMediaDecodeTime=s.baseMediaDecodeTime}},e.appendData_=function(r,o){var s=o.type,a=o.data;if(!(!a||!a.byteLength)&&!(s==="audio"&&this.audioDisabled_)){var l=this.getInitSegmentAndUpdateState_({type:s,initSegment:o.initSegment,playlist:r.playlist,map:r.isFmp4?r.segment.map:null});this.appendToSourceBuffer_({segmentInfo:r,type:s,initSegment:l,data:a})}},e.loadSegment_=function(r){var o=this;if(this.state="WAITING",this.pendingSegment_=r,this.trimBackBuffer_(r),typeof r.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(function(){var s=Jn({},r,{forceTimestampOffset:!0});Jn(r,o.generateSegmentInfo_(s)),o.isPendingTimestampOffset_=!1,o.updateTransmuxerAndRequestSegment_(r)});return}this.updateTransmuxerAndRequestSegment_(r)},e.updateTransmuxerAndRequestSegment_=function(r){var o=this;this.shouldUpdateTransmuxerTimestampOffset_(r.timestampOffset)&&(this.gopBuffer_.length=0,r.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:r.timestampOffset}));var s=this.createSimplifiedSegmentObj_(r),a=this.isEndOfStream_(r.mediaIndex,r.playlist,r.partIndex),l=this.mediaIndex!==null,u=r.timeline!==this.currentTimeline_&&r.timeline>0,h=a||l&&u;this.logger_("Requesting "+fl(r)),s.map&&!s.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),r.abortRequests=j5({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:s,abortFn:this.handleAbort_.bind(this,r),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",r.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",r.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:h,endedTimelineFn:function(){o.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function(c){var f=c.message,g=c.level,m=c.stream;o.logger_(fl(r)+" logged from transmuxer stream "+m+" as a "+g+": "+f)}})},e.trimBackBuffer_=function(r){var o=cW(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);o>0&&this.remove(0,o)},e.createSimplifiedSegmentObj_=function(r){var o=r.segment,s=r.part,a={resolvedUri:s?s.resolvedUri:o.resolvedUri,byterange:s?s.byterange:o.byterange,requestId:r.requestId,transmuxer:r.transmuxer,audioAppendStart:r.audioAppendStart,gopsToAlignWith:r.gopsToAlignWith,part:r.part},l=r.playlist.segments[r.mediaIndex-1];if(l&&l.timeline===o.timeline&&(l.videoTimingInfo?a.baseStartTime=l.videoTimingInfo.transmuxedDecodeEnd:l.audioTimingInfo&&(a.baseStartTime=l.audioTimingInfo.transmuxedDecodeEnd)),o.key){var u=o.key.iv||new Uint32Array([0,0,0,r.mediaIndex+r.playlist.mediaSequence]);a.key=this.segmentKey(o.key),a.key.iv=u}return o.map&&(a.map=this.initSegmentForMap(o.map)),a},e.saveTransferStats_=function(r){this.mediaRequests+=1,r&&(this.mediaBytesTransferred+=r.bytesReceived,this.mediaTransferDuration+=r.roundTripTime)},e.saveBandwidthRelatedStats_=function(r,o){if(this.pendingSegment_.byteLength=o.bytesReceived,r<Ic){this.logger_("Ignoring segment's bandwidth because its duration of "+r+(" is less than the min to record "+Ic));return}this.bandwidth=o.bandwidth,this.roundTrip=o.roundTripTime},e.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")},e.segmentRequestFinished_=function(r,o,s){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,r,o,s));return}if(this.saveTransferStats_(o.stats),!!this.pendingSegment_&&o.requestId===this.pendingSegment_.requestId){if(r){if(this.pendingSegment_=null,this.state="READY",r.code===Ao.ABORTED)return;if(this.pause(),r.code===Ao.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(r),this.trigger("error");return}var a=this.pendingSegment_;this.saveBandwidthRelatedStats_(a.duration,o.stats),a.endOfAllRequests=o.endOfAllRequests,s.gopInfo&&(this.gopBuffer_=sW(this.gopBuffer_,s.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(a)}},e.setTimeMapping_=function(r){var o=this.syncController_.mappingForTimeline(r);o!==null&&(this.timeMapping_=o)},e.updateMediaSecondsLoaded_=function(r){typeof r.start=="number"&&typeof r.end=="number"?this.mediaSecondsLoaded+=r.end-r.start:this.mediaSecondsLoaded+=r.duration},e.shouldUpdateTransmuxerTimestampOffset_=function(r){return r===null?!1:this.loaderType_==="main"&&r!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&r!==this.sourceUpdater_.audioTimestampOffset()},e.trueSegmentStart_=function(r){var o=r.currentStart,s=r.playlist,a=r.mediaIndex,l=r.firstVideoFrameTimeForData,u=r.currentVideoTimestampOffset,h=r.useVideoTimingInfo,d=r.videoTimingInfo,c=r.audioTimingInfo;if(typeof o<"u")return o;if(!h)return c.start;var f=s.segments[a-1];return a===0||!f||typeof f.start>"u"||f.end!==l+u?l:d.start},e.waitForAppendsToComplete_=function(r){var o=this.getCurrentMediaInfo_(r);if(!o){this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),this.trigger("error");return}var s=o.hasAudio,a=o.hasVideo,l=o.isMuxed,u=this.loaderType_==="main"&&a,h=!this.audioDisabled_&&s&&!l;if(r.waitingOnAppends=0,!r.hasAppendedData_){!r.timingInfo&&typeof r.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),r.timingInfo={start:0},r.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(r),this.processMetadataQueue_()),this.checkAppendsDone_(r);return}u&&r.waitingOnAppends++,h&&r.waitingOnAppends++,u&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,r)),h&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,r))},e.checkAppendsDone_=function(r){this.checkForAbort_(r.requestId)||(r.waitingOnAppends--,r.waitingOnAppends===0&&this.handleAppendsDone_())},e.checkForIllegalMediaSwitch=function(r){var o=dW(this.loaderType_,this.getCurrentMediaInfo_(),r);return o?(this.error({message:o,blacklistDuration:1/0}),this.trigger("error"),!0):!1},e.updateSourceBufferTimestampOffset_=function(r){if(!(r.timestampOffset===null||typeof r.timingInfo.start!="number"||r.changedTimestampOffset||this.loaderType_!=="main")){var o=!1;r.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:r.segment.videoTimingInfo,audioTimingInfo:r.segment.audioTimingInfo,timingInfo:r.timingInfo}),r.changedTimestampOffset=!0,r.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(r.timestampOffset),o=!0),r.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(r.timestampOffset),o=!0),o&&this.trigger("timestampoffset")}},e.getSegmentStartTimeForTimestampOffsetCalculation_=function(r){var o=r.videoTimingInfo,s=r.audioTimingInfo,a=r.timingInfo;return this.useDtsForTimestampOffset_?o&&typeof o.transmuxedDecodeStart=="number"?o.transmuxedDecodeStart:s&&typeof s.transmuxedDecodeStart=="number"?s.transmuxedDecodeStart:a.start:a.start},e.updateTimingInfoEnd_=function(r){r.timingInfo=r.timingInfo||{};var o=this.getMediaInfo_(),s=this.loaderType_==="main"&&o&&o.hasVideo,a=s&&r.videoTimingInfo?r.videoTimingInfo:r.audioTimingInfo;a&&(r.timingInfo.end=typeof a.end=="number"?a.end:a.start+r.duration)},e.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}var r=this.pendingSegment_;this.updateTimingInfoEnd_(r),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:r,shouldSaveTimelineMapping:this.loaderType_==="main"});var o=pW(r,this.sourceType_);if(o&&(o.severity==="warn"?ot.log.warn(o.message):this.logger_(o.message)),this.recordThroughput_(r),this.pendingSegment_=null,this.state="READY",r.isSyncRequest&&(this.trigger("syncinfoupdate"),!r.hasAppendedData_)){this.logger_("Throwing away un-appended sync request "+fl(r));return}this.logger_("Appended "+fl(r)),this.addSegmentMetadataCue_(r),this.fetchAtBuffer_=!0,this.currentTimeline_!==r.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:r.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:r.timeline})),this.currentTimeline_=r.timeline,this.trigger("syncinfoupdate");var s=r.segment,a=r.part,l=s.end&&this.currentTime_()-s.end>r.playlist.targetDuration*3,u=a&&a.end&&this.currentTime_()-a.end>r.playlist.partTargetDuration*3;if(l||u){this.logger_("bad "+(l?"segment":"part")+" "+fl(r)),this.resetEverything();return}var h=this.mediaIndex!==null;h&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=r.mediaIndex,this.partIndex=r.partIndex,this.isEndOfStream_(r.mediaIndex,r.playlist,r.partIndex)&&this.endOfStream(),this.trigger("appended"),r.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()},e.recordThroughput_=function(r){if(r.duration<Ic){this.logger_("Ignoring segment's throughput because its duration of "+r.duration+(" is less than the min to record "+Ic));return}var o=this.throughput.rate,s=Date.now()-r.endOfAllRequests+1,a=Math.floor(r.byteLength/s*8*1e3);this.throughput.rate+=(a-o)/++this.throughput.count},e.addSegmentMetadataCue_=function(r){if(this.segmentMetadataTrack_){var o=r.segment,s=o.start,a=o.end;if(!(!mx(s)||!mx(a))){Th(s,a,this.segmentMetadataTrack_);var l=K.WebKitDataCue||K.VTTCue,u={custom:o.custom,dateTimeObject:o.dateTimeObject,dateTimeString:o.dateTimeString,bandwidth:r.playlist.attributes.BANDWIDTH,resolution:r.playlist.attributes.RESOLUTION,codecs:r.playlist.attributes.CODECS,byteLength:r.byteLength,uri:r.uri,timeline:r.timeline,playlist:r.playlist.id,start:s,end:a},h=JSON.stringify(u),d=new l(s,a,h);d.value=u,this.segmentMetadataTrack_.addCue(d)}}},t}(ot.EventTarget);function is(){}var dk=function(t){return typeof t!="string"?t:t.replace(/./,function(e){return e.toUpperCase()})},mW=["video","audio"],v_=function(t,e){var i=e[t+"Buffer"];return i&&i.updating||e.queuePending[t]},vW=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];if(r.type==="mediaSource")return null;if(r.type===t)return i}return null},rw=function n(t,e){if(e.queue.length!==0){var i=0,r=e.queue[i];if(r.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),r.action(e),r.doneFn&&r.doneFn(),n("audio",e),n("video",e));return}if(t!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||v_(t,e))){if(r.type!==t){if(i=vW(t,e.queue),i===null)return;r=e.queue[i]}if(e.queue.splice(i,1),e.queuePending[t]=r,r.action(t,e),!r.doneFn){e.queuePending[t]=null,n(t,e);return}}}},ck=function(t,e){var i=e[t+"Buffer"],r=dk(t);i&&(i.removeEventListener("updateend",e["on"+r+"UpdateEnd_"]),i.removeEventListener("error",e["on"+r+"Error_"]),e.codecs[t]=null,e[t+"Buffer"]=null)},_o=function(t,e){return t&&e&&Array.prototype.indexOf.call(t.sourceBuffers,e)!==-1},Zr={appendBuffer:function(t,e,i){return function(r,o){var s=o[r+"Buffer"];if(_o(o.mediaSource,s)){o.logger_("Appending segment "+e.mediaIndex+"'s "+t.length+" bytes to "+r+"Buffer");try{s.appendBuffer(t)}catch(a){o.logger_("Error with code "+a.code+" "+(a.code===hk?"(QUOTA_EXCEEDED_ERR) ":"")+("when appending segment "+e.mediaIndex+" to "+r+"Buffer")),o.queuePending[r]=null,i(a)}}}},remove:function(t,e){return function(i,r){var o=r[i+"Buffer"];if(_o(r.mediaSource,o)){r.logger_("Removing "+t+" to "+e+" from "+i+"Buffer");try{o.remove(t,e)}catch{r.logger_("Remove "+t+" to "+e+" from "+i+"Buffer failed")}}}},timestampOffset:function(t){return function(e,i){var r=i[e+"Buffer"];_o(i.mediaSource,r)&&(i.logger_("Setting "+e+"timestampOffset to "+t),r.timestampOffset=t)}},callback:function(t){return function(e,i){t()}},endOfStream:function(t){return function(e){if(e.mediaSource.readyState==="open"){e.logger_("Calling mediaSource endOfStream("+(t||"")+")");try{e.mediaSource.endOfStream(t)}catch(i){ot.log.warn("Failed to call media source endOfStream",i)}}}},duration:function(t){return function(e){e.logger_("Setting mediaSource duration to "+t);try{e.mediaSource.duration=t}catch(i){ot.log.warn("Failed to set media source duration",i)}}},abort:function(){return function(t,e){if(e.mediaSource.readyState==="open"){var i=e[t+"Buffer"];if(_o(e.mediaSource,i)){e.logger_("calling abort on "+t+"Buffer");try{i.abort()}catch(r){ot.log.warn("Failed to abort on "+t+"Buffer",r)}}}}},addSourceBuffer:function(t,e){return function(i){var r=dk(t),o=id(e);i.logger_("Adding "+t+"Buffer with codec "+e+" to mediaSource");var s=i.mediaSource.addSourceBuffer(o);s.addEventListener("updateend",i["on"+r+"UpdateEnd_"]),s.addEventListener("error",i["on"+r+"Error_"]),i.codecs[t]=e,i[t+"Buffer"]=s}},removeSourceBuffer:function(t){return function(e){var i=e[t+"Buffer"];if(ck(t,e),!!_o(e.mediaSource,i)){e.logger_("Removing "+t+"Buffer with codec "+e.codecs[t]+" from mediaSource");try{e.mediaSource.removeSourceBuffer(i)}catch(r){ot.log.warn("Failed to removeSourceBuffer "+t+"Buffer",r)}}}},changeType:function(t){return function(e,i){var r=i[e+"Buffer"],o=id(t);if(_o(i.mediaSource,r)&&i.codecs[e]!==t){i.logger_("changing "+e+"Buffer codec from "+i.codecs[e]+" to "+t);try{r.changeType(o),i.codecs[e]=t}catch(s){ot.log.warn("Failed to changeType on "+e+"Buffer",s)}}}}},Qr=function(t){var e=t.type,i=t.sourceUpdater,r=t.action,o=t.doneFn,s=t.name;i.queue.push({type:e,action:r,doneFn:o,name:s}),rw(e,i)},Cx=function(t,e){return function(i){if(e.queuePending[t]){var r=e.queuePending[t].doneFn;e.queuePending[t]=null,r&&r(e[t+"Error_"])}rw(t,e)}},fk=function(n){kt(t,n);function t(i){var r;return r=n.call(this)||this,r.mediaSource=i,r.sourceopenListener_=function(){return rw("mediaSource",he(r))},r.mediaSource.addEventListener("sourceopen",r.sourceopenListener_),r.logger_=oo("SourceUpdater"),r.audioTimestampOffset_=0,r.videoTimestampOffset_=0,r.queue=[],r.queuePending={audio:null,video:null},r.delayedAudioAppendQueue_=[],r.videoAppendQueued_=!1,r.codecs={},r.onVideoUpdateEnd_=Cx("video",he(r)),r.onAudioUpdateEnd_=Cx("audio",he(r)),r.onVideoError_=function(o){r.videoError_=o},r.onAudioError_=function(o){r.audioError_=o},r.createdSourceBuffers_=!1,r.initializedEme_=!1,r.triggeredReady_=!1,r}var e=t.prototype;return e.initializedEme=function(){this.initializedEme_=!0,this.triggerReady()},e.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},e.hasInitializedAnyEme=function(){return this.initializedEme_},e.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},e.createSourceBuffers=function(r){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(r),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},e.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},e.addSourceBuffer=function(r,o){Qr({type:"mediaSource",sourceUpdater:this,action:Zr.addSourceBuffer(r,o),name:"addSourceBuffer"})},e.abort=function(r){Qr({type:r,sourceUpdater:this,action:Zr.abort(r),name:"abort"})},e.removeSourceBuffer=function(r){if(!this.canRemoveSourceBuffer()){ot.log.error("removeSourceBuffer is not supported!");return}Qr({type:"mediaSource",sourceUpdater:this,action:Zr.removeSourceBuffer(r),name:"removeSourceBuffer"})},e.canRemoveSourceBuffer=function(){return!ot.browser.IE_VERSION&&!ot.browser.IS_FIREFOX&&K.MediaSource&&K.MediaSource.prototype&&typeof K.MediaSource.prototype.removeSourceBuffer=="function"},t.canChangeType=function(){return K.SourceBuffer&&K.SourceBuffer.prototype&&typeof K.SourceBuffer.prototype.changeType=="function"},e.canChangeType=function(){return this.constructor.canChangeType()},e.changeType=function(r,o){if(!this.canChangeType()){ot.log.error("changeType is not supported!");return}Qr({type:r,sourceUpdater:this,action:Zr.changeType(o),name:"changeType"})},e.addOrChangeSourceBuffers=function(r){var o=this;if(!r||typeof r!="object"||Object.keys(r).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(r).forEach(function(s){var a=r[s];if(!o.hasCreatedSourceBuffers())return o.addSourceBuffer(s,a);o.canChangeType()&&o.changeType(s,a)})},e.appendBuffer=function(r,o){var s=this,a=r.segmentInfo,l=r.type,u=r.bytes;if(this.processedAppend_=!0,l==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([r,o]),this.logger_("delayed audio append of "+u.length+" until video append");return}var h=o;if(Qr({type:l,sourceUpdater:this,action:Zr.appendBuffer(u,a||{mediaIndex:-1},h),doneFn:o,name:"appendBuffer"}),l==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var d=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+d.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,d.forEach(function(c){s.appendBuffer.apply(s,c)})}},e.audioBuffered=function(){return _o(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:ot.createTimeRange()},e.videoBuffered=function(){return _o(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:ot.createTimeRange()},e.buffered=function(){var r=_o(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,o=_o(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return o&&!r?this.audioBuffered():r&&!o?this.videoBuffered():IN(this.audioBuffered(),this.videoBuffered())},e.setDuration=function(r,o){o===void 0&&(o=is),Qr({type:"mediaSource",sourceUpdater:this,action:Zr.duration(r),name:"duration",doneFn:o})},e.endOfStream=function(r,o){r===void 0&&(r=null),o===void 0&&(o=is),typeof r!="string"&&(r=void 0),Qr({type:"mediaSource",sourceUpdater:this,action:Zr.endOfStream(r),name:"endOfStream",doneFn:o})},e.removeAudio=function(r,o,s){if(s===void 0&&(s=is),!this.audioBuffered().length||this.audioBuffered().end(0)===0){s();return}Qr({type:"audio",sourceUpdater:this,action:Zr.remove(r,o),doneFn:s,name:"remove"})},e.removeVideo=function(r,o,s){if(s===void 0&&(s=is),!this.videoBuffered().length||this.videoBuffered().end(0)===0){s();return}Qr({type:"video",sourceUpdater:this,action:Zr.remove(r,o),doneFn:s,name:"remove"})},e.updating=function(){return!!(v_("audio",this)||v_("video",this))},e.audioTimestampOffset=function(r){return typeof r<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==r&&(Qr({type:"audio",sourceUpdater:this,action:Zr.timestampOffset(r),name:"timestampOffset"}),this.audioTimestampOffset_=r),this.audioTimestampOffset_},e.videoTimestampOffset=function(r){return typeof r<"u"&&this.videoBuffer&&this.videoTimestampOffset!==r&&(Qr({type:"video",sourceUpdater:this,action:Zr.timestampOffset(r),name:"timestampOffset"}),this.videoTimestampOffset_=r),this.videoTimestampOffset_},e.audioQueueCallback=function(r){this.audioBuffer&&Qr({type:"audio",sourceUpdater:this,action:Zr.callback(r),name:"callback"})},e.videoQueueCallback=function(r){this.videoBuffer&&Qr({type:"video",sourceUpdater:this,action:Zr.callback(r),name:"callback"})},e.dispose=function(){var r=this;this.trigger("dispose"),mW.forEach(function(o){r.abort(o),r.canRemoveSourceBuffer()?r.removeSourceBuffer(o):r[o+"QueueCallback"](function(){return ck(o,r)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},t}(ot.EventTarget),yx=function(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))},wx=new Uint8Array(`

`.split("").map(function(n){return n.charCodeAt(0)})),bW=function(n){kt(t,n);function t(){return n.call(this,"Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")||this}return t}(Qb(Error)),_W=function(n){kt(t,n);function t(i,r){var o;return r===void 0&&(r={}),o=n.call(this,i,r)||this,o.mediaSource_=null,o.subtitlesTrack_=null,o.loaderType_="subtitle",o.featuresNativeTextTracks_=i.featuresNativeTextTracks,o.loadVttJs=i.loadVttJs,o.shouldSaveSegmentTimingInfo_=!1,o}var e=t.prototype;return e.createTransmuxer_=function(){return null},e.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return ot.createTimeRanges();var r=this.subtitlesTrack_.cues,o=r[0].startTime,s=r[r.length-1].startTime;return ot.createTimeRanges([[o,s]])},e.initSegmentForMap=function(r,o){if(o===void 0&&(o=!1),!r)return null;var s=tg(r),a=this.initSegments_[s];if(o&&!a&&r.bytes){var l=wx.byteLength+r.bytes.byteLength,u=new Uint8Array(l);u.set(r.bytes),u.set(wx,r.bytes.byteLength),this.initSegments_[s]=a={resolvedUri:r.resolvedUri,byterange:r.byterange,bytes:u}}return a||r},e.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},e.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},e.track=function(r){return typeof r>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=r,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)},e.remove=function(r,o){Th(r,o,this.subtitlesTrack_)},e.fillBuffer_=function(){var r=this,o=this.chooseNextRequest_();if(o){if(this.syncController_.timestampOffsetForTimeline(o.timeline)===null){var s=function(){r.state="READY",r.paused()||r.monitorBuffer_()};this.syncController_.one("timestampoffset",s),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(o)}},e.timestampOffsetForSegment_=function(){return null},e.chooseNextRequest_=function(){return this.skipEmptySegments_(n.prototype.chooseNextRequest_.call(this))},e.skipEmptySegments_=function(r){for(;r&&r.segment.empty;){if(r.mediaIndex+1>=r.playlist.segments.length){r=null;break}r=this.generateSegmentInfo_({playlist:r.playlist,mediaIndex:r.mediaIndex+1,startOfSegment:r.startOfSegment+r.duration,isSyncRequest:r.isSyncRequest})}return r},e.stopForError=function(r){this.error(r),this.state="READY",this.pause(),this.trigger("error")},e.segmentRequestFinished_=function(r,o,s){var a=this;if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(o.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(r){r.code===Ao.TIMEOUT&&this.handleTimeout_(),r.code===Ao.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(r);return}var l=this.pendingSegment_;this.saveBandwidthRelatedStats_(l.duration,o.stats),o.key&&this.segmentKey(o.key,!0),this.state="APPENDING",this.trigger("appending");var u=l.segment;if(u.map&&(u.map.bytes=o.map.bytes),l.bytes=o.bytes,typeof K.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(function(){return a.segmentRequestFinished_(r,o,s)},function(){return a.stopForError({message:"Error loading vtt.js"})});return}u.requested=!0;try{this.parseVTTCues_(l)}catch(h){this.stopForError({message:h.message});return}if(this.updateTimeMapping_(l,this.syncController_.timelines[l.timeline],this.playlist_),l.cues.length?l.timingInfo={start:l.cues[0].startTime,end:l.cues[l.cues.length-1].endTime}:l.timingInfo={start:l.startOfSegment,end:l.startOfSegment+l.duration},l.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}l.byteLength=l.bytes.byteLength,this.mediaSecondsLoaded+=u.duration,l.cues.forEach(function(h){a.subtitlesTrack_.addCue(a.featuresNativeTextTracks_?new K.VTTCue(h.startTime,h.endTime,h.text):h)}),nW(this.subtitlesTrack_),this.handleAppendsDone_()},e.handleData_=function(){},e.updateTimingInfoEnd_=function(){},e.parseVTTCues_=function(r){var o,s=!1;if(typeof K.WebVTT!="function")throw new bW;typeof K.TextDecoder=="function"?o=new K.TextDecoder("utf8"):(o=K.WebVTT.StringDecoder(),s=!0);var a=new K.WebVTT.Parser(K,K.vttjs,o);if(r.cues=[],r.timestampmap={MPEGTS:0,LOCAL:0},a.oncue=r.cues.push.bind(r.cues),a.ontimestampmap=function(h){r.timestampmap=h},a.onparsingerror=function(h){ot.log.warn("Error encountered when parsing cues: "+h.message)},r.segment.map){var l=r.segment.map.bytes;s&&(l=yx(l)),a.parse(l)}var u=r.bytes;s&&(u=yx(u)),a.parse(u),a.flush()},e.updateTimeMapping_=function(r,o,s){var a=r.segment;if(o){if(!r.cues.length){a.empty=!0;return}var l=r.timestampmap,u=l.MPEGTS/Uf.ONE_SECOND_IN_TS-l.LOCAL+o.mapping;if(r.cues.forEach(function(c){c.startTime+=u,c.endTime+=u}),!s.syncInfo){var h=r.cues[0].startTime,d=r.cues[r.cues.length-1].startTime;s.syncInfo={mediaSequence:s.mediaSequence+r.mediaIndex,time:Math.min(h,d-a.duration)}}}},t}(m_),CW=function(t,e){for(var i=t.cues,r=0;r<i.length;r++){var o=i[r];if(e>=o.adStartTime&&e<=o.adEndTime)return o}return null},yW=function(t,e,i){if(i===void 0&&(i=0),!!t.segments)for(var r=i,o,s=0;s<t.segments.length;s++){var a=t.segments[s];if(o||(o=CW(e,r+a.duration/2)),o){if("cueIn"in a){o.endTime=r,o.adEndTime=r,r+=a.duration,o=null;continue}if(r<o.endTime){r+=a.duration;continue}o.endTime+=a.duration}else if("cueOut"in a&&(o=new K.VTTCue(r,r+a.duration,a.cueOut),o.adStartTime=r,o.adEndTime=r+parseFloat(a.cueOut),e.addCue(o)),"cueOutCont"in a){var l=a.cueOutCont.split("/").map(parseFloat),u=l[0],h=l[1];o=new K.VTTCue(r,r+a.duration,""),o.adStartTime=r-u,o.adEndTime=o.adStartTime+h,e.addCue(o)}r+=a.duration}},wW=86400,Sx=[{name:"VOD",run:function(t,e,i,r,o){if(i!==1/0){var s={time:0,segmentIndex:0,partIndex:null};return s}return null}},{name:"ProgramDateTime",run:function(t,e,i,r,o){if(!Object.keys(t.timelineToDatetimeMappings).length)return null;var s=null,a=null,l=l_(e);o=o||0;for(var u=0;u<l.length;u++){var h=e.endList||o===0?u:l.length-(u+1),d=l[h],c=d.segment,f=t.timelineToDatetimeMappings[c.timeline];if(!(!f||!c.dateTimeObject)){var g=c.dateTimeObject.getTime()/1e3,m=g+f;if(c.parts&&typeof d.partIndex=="number")for(var p=0;p<d.partIndex;p++)m+=c.parts[p].duration;var v=Math.abs(o-m);if(a!==null&&(v===0||a<v))break;a=v,s={time:m,segmentIndex:d.segmentIndex,partIndex:d.partIndex}}}return s}},{name:"Segment",run:function(t,e,i,r,o){var s=null,a=null;o=o||0;for(var l=l_(e),u=0;u<l.length;u++){var h=e.endList||o===0?u:l.length-(u+1),d=l[h],c=d.segment,f=d.part&&d.part.start||c&&c.start;if(c.timeline===r&&typeof f<"u"){var g=Math.abs(o-f);if(a!==null&&a<g)break;(!s||a===null||a>=g)&&(a=g,s={time:f,segmentIndex:d.segmentIndex,partIndex:d.partIndex})}}return s}},{name:"Discontinuity",run:function(t,e,i,r,o){var s=null;if(o=o||0,e.discontinuityStarts&&e.discontinuityStarts.length)for(var a=null,l=0;l<e.discontinuityStarts.length;l++){var u=e.discontinuityStarts[l],h=e.discontinuitySequence+l+1,d=t.discontinuities[h];if(d){var c=Math.abs(o-d.time);if(a!==null&&a<c)break;(!s||a===null||a>=c)&&(a=c,s={time:d.time,segmentIndex:u,partIndex:null})}}return s}},{name:"Playlist",run:function(t,e,i,r,o){if(e.syncInfo){var s={time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null};return s}return null}}],SW=function(n){kt(t,n);function t(i){var r;return r=n.call(this)||this,r.timelines=[],r.discontinuities=[],r.timelineToDatetimeMappings={},r.logger_=oo("SyncController"),r}var e=t.prototype;return e.getSyncPoint=function(r,o,s,a){var l=this.runStrategies_(r,o,s,a);return l.length?this.selectSyncPoint_(l,{key:"time",value:a}):null},e.getExpiredTime=function(r,o){if(!r||!r.segments)return null;var s=this.runStrategies_(r,o,r.discontinuitySequence,0);if(!s.length)return null;var a=this.selectSyncPoint_(s,{key:"segmentIndex",value:0});return a.segmentIndex>0&&(a.time*=-1),Math.abs(a.time+Fh({defaultDuration:r.targetDuration,durationList:r.segments,startIndex:a.segmentIndex,endIndex:0}))},e.runStrategies_=function(r,o,s,a){for(var l=[],u=0;u<Sx.length;u++){var h=Sx[u],d=h.run(this,r,o,s,a);d&&(d.strategy=h.name,l.push({strategy:h.name,syncPoint:d}))}return l},e.selectSyncPoint_=function(r,o){for(var s=r[0].syncPoint,a=Math.abs(r[0].syncPoint[o.key]-o.value),l=r[0].strategy,u=1;u<r.length;u++){var h=Math.abs(r[u].syncPoint[o.key]-o.value);h<a&&(a=h,s=r[u].syncPoint,l=r[u].strategy)}return this.logger_("syncPoint for ["+o.key+": "+o.value+"] chosen with strategy"+(" ["+l+"]: [time:"+s.time+",")+(" segmentIndex:"+s.segmentIndex)+(typeof s.partIndex=="number"?",partIndex:"+s.partIndex:"")+"]"),s},e.saveExpiredSegmentInfo=function(r,o){var s=o.mediaSequence-r.mediaSequence;if(s>wW){ot.log.warn("Not saving expired segment info. Media sequence gap "+s+" is too large.");return}for(var a=s-1;a>=0;a--){var l=r.segments[a];if(l&&typeof l.start<"u"){o.syncInfo={mediaSequence:r.mediaSequence+a,time:l.start},this.logger_("playlist refresh sync: [time:"+o.syncInfo.time+","+(" mediaSequence: "+o.syncInfo.mediaSequence+"]")),this.trigger("syncinfoupdate");break}}},e.setDateTimeMappingForStart=function(r){if(this.timelineToDatetimeMappings={},r.segments&&r.segments.length&&r.segments[0].dateTimeObject){var o=r.segments[0],s=o.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[o.timeline]=-s}},e.saveSegmentTimingInfo=function(r){var o=r.segmentInfo,s=r.shouldSaveTimelineMapping,a=this.calculateSegmentTimeMapping_(o,o.timingInfo,s),l=o.segment;a&&(this.saveDiscontinuitySyncInfo_(o),o.playlist.syncInfo||(o.playlist.syncInfo={mediaSequence:o.playlist.mediaSequence+o.mediaIndex,time:l.start}));var u=l.dateTimeObject;l.discontinuity&&s&&u&&(this.timelineToDatetimeMappings[l.timeline]=-(u.getTime()/1e3))},e.timestampOffsetForTimeline=function(r){return typeof this.timelines[r]>"u"?null:this.timelines[r].time},e.mappingForTimeline=function(r){return typeof this.timelines[r]>"u"?null:this.timelines[r].mapping},e.calculateSegmentTimeMapping_=function(r,o,s){var a=r.segment,l=r.part,u=this.timelines[r.timeline],h,d;if(typeof r.timestampOffset=="number")u={time:r.startOfSegment,mapping:r.startOfSegment-o.start},s&&(this.timelines[r.timeline]=u,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+r.timeline+": "+("[time: "+u.time+"] [mapping: "+u.mapping+"]"))),h=r.startOfSegment,d=o.end+u.mapping;else if(u)h=o.start+u.mapping,d=o.end+u.mapping;else return!1;return l&&(l.start=h,l.end=d),(!a.start||h<a.start)&&(a.start=h),a.end=d,!0},e.saveDiscontinuitySyncInfo_=function(r){var o=r.playlist,s=r.segment;if(s.discontinuity)this.discontinuities[s.timeline]={time:s.start,accuracy:0};else if(o.discontinuityStarts&&o.discontinuityStarts.length)for(var a=0;a<o.discontinuityStarts.length;a++){var l=o.discontinuityStarts[a],u=o.discontinuitySequence+a+1,h=l-r.mediaIndex,d=Math.abs(h);if(!this.discontinuities[u]||this.discontinuities[u].accuracy>d){var c=void 0;h<0?c=s.start-Fh({defaultDuration:o.targetDuration,durationList:o.segments,startIndex:r.mediaIndex,endIndex:l}):c=s.end+Fh({defaultDuration:o.targetDuration,durationList:o.segments,startIndex:r.mediaIndex+1,endIndex:l}),this.discontinuities[u]={time:c,accuracy:d}}}},e.dispose=function(){this.trigger("dispose"),this.off()},t}(ot.EventTarget),xW=function(n){kt(t,n);function t(){var i;return i=n.call(this)||this,i.pendingTimelineChanges_={},i.lastTimelineChanges_={},i}var e=t.prototype;return e.clearPendingTimelineChange=function(r){this.pendingTimelineChanges_[r]=null,this.trigger("pendingtimelinechange")},e.pendingTimelineChange=function(r){var o=r.type,s=r.from,a=r.to;return typeof s=="number"&&typeof a=="number"&&(this.pendingTimelineChanges_[o]={type:o,from:s,to:a},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[o]},e.lastTimelineChange=function(r){var o=r.type,s=r.from,a=r.to;return typeof s=="number"&&typeof a=="number"&&(this.lastTimelineChanges_[o]={type:o,from:s,to:a},delete this.pendingTimelineChanges_[o],this.trigger("timelinechange")),this.lastTimelineChanges_[o]},e.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},t}(ot.EventTarget),TW=JP(tk(function(){var n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function t(y,w,_){return _={path:w,exports:{},require:function(T,S){return e(T,S??_.path)}},y(_,_.exports),_.exports}function e(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var i=t(function(y){function w(A,T){for(var S=0;S<T.length;S++){var x=T[S];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(A,x.key,x)}}function _(A,T,S){return T&&w(A.prototype,T),S&&w(A,S),A}y.exports=_,y.exports.default=y.exports,y.exports.__esModule=!0}),r=t(function(y){function w(_,A){return y.exports=w=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},y.exports.default=y.exports,y.exports.__esModule=!0,w(_,A)}y.exports=w,y.exports.default=y.exports,y.exports.__esModule=!0}),o=t(function(y){function w(_,A){_.prototype=Object.create(A.prototype),_.prototype.constructor=_,r(_,A)}y.exports=w,y.exports.default=y.exports,y.exports.__esModule=!0}),s=function(){function y(){this.listeners={}}var w=y.prototype;return w.on=function(A,T){this.listeners[A]||(this.listeners[A]=[]),this.listeners[A].push(T)},w.off=function(A,T){if(!this.listeners[A])return!1;var S=this.listeners[A].indexOf(T);return this.listeners[A]=this.listeners[A].slice(0),this.listeners[A].splice(S,1),S>-1},w.trigger=function(A){var T=this.listeners[A];if(T)if(arguments.length===2)for(var S=T.length,x=0;x<S;++x)T[x].call(this,arguments[1]);else for(var E=Array.prototype.slice.call(arguments,1),M=T.length,L=0;L<M;++L)T[L].apply(this,E)},w.dispose=function(){this.listeners={}},w.pipe=function(A){this.on("data",function(T){A.push(T)})},y}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function a(y){return y.subarray(0,y.byteLength-y[y.byteLength-1])}/*! @name aes-decrypter @version 3.1.3 @license Apache-2.0 */var l=function(){var w=[[[],[],[],[],[]],[[],[],[],[],[]]],_=w[0],A=w[1],T=_[4],S=A[4],x,E,M,L=[],I=[],D,H,O,N,U,W;for(x=0;x<256;x++)I[(L[x]=x<<1^(x>>7)*283)^x]=x;for(E=M=0;!T[E];E^=D||1,M=I[M]||1)for(N=M^M<<1^M<<2^M<<3^M<<4,N=N>>8^N&255^99,T[E]=N,S[N]=E,O=L[H=L[D=L[E]]],W=O*16843009^H*65537^D*257^E*16843008,U=L[N]*257^N*16843008,x=0;x<4;x++)_[x][E]=U=U<<24^U>>>8,A[x][N]=W=W<<24^W>>>8;for(x=0;x<5;x++)_[x]=_[x].slice(0),A[x]=A[x].slice(0);return w},u=null,h=function(){function y(_){u||(u=l()),this._tables=[[u[0][0].slice(),u[0][1].slice(),u[0][2].slice(),u[0][3].slice(),u[0][4].slice()],[u[1][0].slice(),u[1][1].slice(),u[1][2].slice(),u[1][3].slice(),u[1][4].slice()]];var A,T,S,x=this._tables[0][4],E=this._tables[1],M=_.length,L=1;if(M!==4&&M!==6&&M!==8)throw new Error("Invalid aes key size");var I=_.slice(0),D=[];for(this._key=[I,D],A=M;A<4*M+28;A++)S=I[A-1],(A%M===0||M===8&&A%M===4)&&(S=x[S>>>24]<<24^x[S>>16&255]<<16^x[S>>8&255]<<8^x[S&255],A%M===0&&(S=S<<8^S>>>24^L<<24,L=L<<1^(L>>7)*283)),I[A]=I[A-M]^S;for(T=0;A;T++,A--)S=I[T&3?A:A-4],A<=4||T<4?D[T]=S:D[T]=E[0][x[S>>>24]]^E[1][x[S>>16&255]]^E[2][x[S>>8&255]]^E[3][x[S&255]]}var w=y.prototype;return w.decrypt=function(A,T,S,x,E,M){var L=this._key[1],I=A^L[0],D=x^L[1],H=S^L[2],O=T^L[3],N,U,W,j=L.length/4-2,Y,Z=4,rt=this._tables[1],J=rt[0],st=rt[1],ht=rt[2],at=rt[3],lt=rt[4];for(Y=0;Y<j;Y++)N=J[I>>>24]^st[D>>16&255]^ht[H>>8&255]^at[O&255]^L[Z],U=J[D>>>24]^st[H>>16&255]^ht[O>>8&255]^at[I&255]^L[Z+1],W=J[H>>>24]^st[O>>16&255]^ht[I>>8&255]^at[D&255]^L[Z+2],O=J[O>>>24]^st[I>>16&255]^ht[D>>8&255]^at[H&255]^L[Z+3],Z+=4,I=N,D=U,H=W;for(Y=0;Y<4;Y++)E[(3&-Y)+M]=lt[I>>>24]<<24^lt[D>>16&255]<<16^lt[H>>8&255]<<8^lt[O&255]^L[Z++],N=I,I=D,D=H,H=O,O=N},y}(),d=function(y){o(w,y);function w(){var A;return A=y.call(this,s)||this,A.jobs=[],A.delay=1,A.timeout_=null,A}var _=w.prototype;return _.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},_.push=function(T){this.jobs.push(T),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},w}(s),c=function(w){return w<<24|(w&65280)<<8|(w&16711680)>>8|w>>>24},f=function(w,_,A){var T=new Int32Array(w.buffer,w.byteOffset,w.byteLength>>2),S=new h(Array.prototype.slice.call(_)),x=new Uint8Array(w.byteLength),E=new Int32Array(x.buffer),M,L,I,D,H,O,N,U,W;for(M=A[0],L=A[1],I=A[2],D=A[3],W=0;W<T.length;W+=4)H=c(T[W]),O=c(T[W+1]),N=c(T[W+2]),U=c(T[W+3]),S.decrypt(H,O,N,U,E,W),E[W]=c(E[W]^M),E[W+1]=c(E[W+1]^L),E[W+2]=c(E[W+2]^I),E[W+3]=c(E[W+3]^D),M=H,L=O,I=N,D=U;return x},g=function(){function y(_,A,T,S){var x=y.STEP,E=new Int32Array(_.buffer),M=new Uint8Array(_.byteLength),L=0;for(this.asyncStream_=new d,this.asyncStream_.push(this.decryptChunk_(E.subarray(L,L+x),A,T,M)),L=x;L<E.length;L+=x)T=new Uint32Array([c(E[L-4]),c(E[L-3]),c(E[L-2]),c(E[L-1])]),this.asyncStream_.push(this.decryptChunk_(E.subarray(L,L+x),A,T,M));this.asyncStream_.push(function(){S(null,a(M))})}var w=y.prototype;return w.decryptChunk_=function(A,T,S,x){return function(){var E=f(A,T,S);x.set(E,A.byteOffset)}},i(y,null,[{key:"STEP",get:function(){return 32e3}}]),y}(),m;typeof window<"u"?m=window:typeof n<"u"?m=n:typeof self<"u"?m=self:m={};var p=m,v=function(w){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(w):w&&w.buffer instanceof ArrayBuffer},b=p.BigInt||Number;b("0x1"),b("0x100"),b("0x10000"),b("0x1000000"),b("0x100000000"),b("0x10000000000"),b("0x1000000000000"),b("0x100000000000000"),b("0x10000000000000000");var C=function(w){var _={};return Object.keys(w).forEach(function(A){var T=w[A];v(T)?_[A]={bytes:T.buffer,byteOffset:T.byteOffset,byteLength:T.byteLength}:_[A]=T}),_};self.onmessage=function(y){var w=y.data,_=new Uint8Array(w.encrypted.bytes,w.encrypted.byteOffset,w.encrypted.byteLength),A=new Uint32Array(w.key.bytes,w.key.byteOffset,w.key.byteLength/4),T=new Uint32Array(w.iv.bytes,w.iv.byteOffset,w.iv.byteLength/4);new g(_,A,T,function(S,x){self.postMessage(C({source:w.source,decrypted:x}),[x.buffer])})}})),AW=QP(TW),RW=function(t){var e=t.default?"main":"alternative";return t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},ng=function(t,e){t.abort(),t.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},b_=function(t,e){e.activePlaylistLoader=t,t.load()},EW=function(t,e){return function(){var i=e.segmentLoaders,r=i[t],o=i.main,s=e.mediaTypes[t],a=s.activeTrack(),l=s.getActiveGroup(),u=s.activePlaylistLoader,h=s.lastGroup_;if(!(l&&h&&l.id===h.id)&&(s.lastGroup_=l,s.lastTrack_=a,ng(r,s),!(!l||l.isMasterPlaylist))){if(!l.playlistLoader){u&&o.resetEverything();return}r.resyncLoader(),b_(l.playlistLoader,s)}}},MW=function(t,e){return function(){var i=e.segmentLoaders[t],r=e.mediaTypes[t];r.lastGroup_=null,i.abort(),i.pause()}},BW=function(t,e){return function(){var i=e.masterPlaylistLoader,r=e.segmentLoaders,o=r[t],s=r.main,a=e.mediaTypes[t],l=a.activeTrack(),u=a.getActiveGroup(),h=a.activePlaylistLoader,d=a.lastTrack_;if(!(d&&l&&d.id===l.id)&&(a.lastGroup_=u,a.lastTrack_=l,ng(o,a),!!u)){if(u.isMasterPlaylist){if(!l||!d||l.id===d.id)return;var c=e.vhs.masterPlaylistController_,f=c.selectPlaylist();if(c.media()===f)return;a.logger_("track change. Switching master audio from "+d.id+" to "+l.id),i.pause(),s.resetEverything(),c.fastQualityChange_(f);return}if(t==="AUDIO"){if(!u.playlistLoader){s.setAudio(!0),s.resetEverything();return}o.setAudio(!0),s.setAudio(!1)}if(h===u.playlistLoader){b_(u.playlistLoader,a);return}o.track&&o.track(l),o.resetEverything(),b_(u.playlistLoader,a)}}},og={AUDIO:function(t,e){return function(){var i=e.segmentLoaders[t],r=e.mediaTypes[t],o=e.blacklistCurrentPlaylist;ng(i,r);var s=r.activeTrack(),a=r.activeGroup(),l=(a.filter(function(d){return d.default})[0]||a[0]).id,u=r.tracks[l];if(s===u){o({message:"Problem encountered loading the default audio track."});return}ot.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(var h in r.tracks)r.tracks[h].enabled=r.tracks[h]===u;r.onTrackChanged()}},SUBTITLES:function(t,e){return function(){var i=e.segmentLoaders[t],r=e.mediaTypes[t];ot.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),ng(i,r);var o=r.activeTrack();o&&(o.mode="disabled"),r.onTrackChanged()}}},xx={AUDIO:function(t,e,i){if(e){var r=i.tech,o=i.requestOptions,s=i.segmentLoaders[t];e.on("loadedmetadata",function(){var a=e.media();s.playlist(a,o),(!r.paused()||a.endList&&r.preload()!=="none")&&s.load()}),e.on("loadedplaylist",function(){s.playlist(e.media(),o),r.paused()||s.load()}),e.on("error",og[t](t,i))}},SUBTITLES:function(t,e,i){var r=i.tech,o=i.requestOptions,s=i.segmentLoaders[t],a=i.mediaTypes[t];e.on("loadedmetadata",function(){var l=e.media();s.playlist(l,o),s.track(a.activeTrack()),(!r.paused()||l.endList&&r.preload()!=="none")&&s.load()}),e.on("loadedplaylist",function(){s.playlist(e.media(),o),r.paused()||s.load()}),e.on("error",og[t](t,i))}},PW={AUDIO:function(t,e){var i=e.vhs,r=e.sourceType,o=e.segmentLoaders[t],s=e.requestOptions,a=e.master.mediaGroups,l=e.mediaTypes[t],u=l.groups,h=l.tracks,d=l.logger_,c=e.masterPlaylistLoader,f=Vd(c.master);(!a[t]||Object.keys(a[t]).length===0)&&(a[t]={main:{default:{default:!0}}},f&&(a[t].main.default.playlists=c.master.playlists));for(var g in a[t]){u[g]||(u[g]=[]);for(var m in a[t][g]){var p=a[t][g][m],v=void 0;if(f?(d("AUDIO group '"+g+"' label '"+m+"' is a master playlist"),p.isMasterPlaylist=!0,v=null):r==="vhs-json"&&p.playlists?v=new kl(p.playlists[0],i,s):p.resolvedUri?v=new kl(p.resolvedUri,i,s):p.playlists&&r==="dash"?v=new g_(p.playlists[0],i,s,c):v=null,p=ot.mergeOptions({id:m,playlistLoader:v},p),xx[t](t,p.playlistLoader,e),u[g].push(p),typeof h[m]>"u"){var b=new ot.AudioTrack({id:m,kind:RW(p),enabled:!1,language:p.language,default:p.default,label:m});h[m]=b}}}o.on("error",og[t](t,e))},SUBTITLES:function(t,e){var i=e.tech,r=e.vhs,o=e.sourceType,s=e.segmentLoaders[t],a=e.requestOptions,l=e.master.mediaGroups,u=e.mediaTypes[t],h=u.groups,d=u.tracks,c=e.masterPlaylistLoader;for(var f in l[t]){h[f]||(h[f]=[]);for(var g in l[t][f])if(!l[t][f][g].forced){var m=l[t][f][g],p=void 0;if(o==="hls")p=new kl(m.resolvedUri,r,a);else if(o==="dash"){var v=m.playlists.filter(function(C){return C.excludeUntil!==1/0});if(!v.length)return;p=new g_(m.playlists[0],r,a,c)}else o==="vhs-json"&&(p=new kl(m.playlists?m.playlists[0]:m.resolvedUri,r,a));if(m=ot.mergeOptions({id:g,playlistLoader:p},m),xx[t](t,m.playlistLoader,e),h[f].push(m),typeof d[g]>"u"){var b=i.addRemoteTextTrack({id:g,kind:"subtitles",default:m.default&&m.autoselect,language:m.language,label:g},!1).track;d[g]=b}}}s.on("error",og[t](t,e))},"CLOSED-CAPTIONS":function(t,e){var i=e.tech,r=e.master.mediaGroups,o=e.mediaTypes[t],s=o.groups,a=o.tracks;for(var l in r[t]){s[l]||(s[l]=[]);for(var u in r[t][l]){var h=r[t][l][u];if(/^(?:CC|SERVICE)/.test(h.instreamId)){var d=i.options_.vhs&&i.options_.vhs.captionServices||{},c={label:u,language:h.language,instreamId:h.instreamId,default:h.default&&h.autoselect};if(d[c.instreamId]&&(c=ot.mergeOptions(c,d[c.instreamId])),c.default===void 0&&delete c.default,s[l].push(ot.mergeOptions({id:u},h)),typeof a[u]>"u"){var f=i.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c.default,language:c.language,label:c.label},!1).track;a[u]=f}}}}}},kW=function n(t,e){for(var i=0;i<t.length;i++)if(Jy(e,t[i])||t[i].playlists&&n(t[i].playlists,e))return!0;return!1},LW=function(t,e){return function(i){var r=e.masterPlaylistLoader,o=e.mediaTypes[t].groups,s=r.media();if(!s)return null;var a=null;s.attributes[t]&&(a=o[s.attributes[t]]);var l=Object.keys(o);if(!a)if(t==="AUDIO"&&l.length>1&&Vd(e.master))for(var u=0;u<l.length;u++){var h=o[l[u]];if(kW(h,s)){a=h;break}}else o.main?a=o.main:l.length===1&&(a=o[l[0]]);return typeof i>"u"?a:i===null||!a?null:a.filter(function(d){return d.id===i.id})[0]||null}},DW={AUDIO:function(t,e){return function(){var i=e.mediaTypes[t].tracks;for(var r in i)if(i[r].enabled)return i[r];return null}},SUBTITLES:function(t,e){return function(){var i=e.mediaTypes[t].tracks;for(var r in i)if(i[r].mode==="showing"||i[r].mode==="hidden")return i[r];return null}}},IW=function(t,e){var i=e.mediaTypes;return function(){var r=i[t].activeTrack();return r?i[t].activeGroup(r):null}},FW=function(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(g){PW[g](g,t)});var e=t.mediaTypes,i=t.masterPlaylistLoader,r=t.tech,o=t.vhs,s=t.segmentLoaders,a=s.AUDIO,l=s.main;["AUDIO","SUBTITLES"].forEach(function(g){e[g].activeGroup=LW(g,t),e[g].activeTrack=DW[g](g,t),e[g].onGroupChanged=EW(g,t),e[g].onGroupChanging=MW(g,t),e[g].onTrackChanged=BW(g,t),e[g].getActiveGroup=IW(g,t)});var u=e.AUDIO.activeGroup();if(u){var h=(u.filter(function(g){return g.default})[0]||u[0]).id;e.AUDIO.tracks[h].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged();var d=e.AUDIO.getActiveGroup();d.playlistLoader?(l.setAudio(!1),a.setAudio(!0)):l.setAudio(!0)}i.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(g){return e[g].onGroupChanged()})}),i.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(g){return e[g].onGroupChanging()})});var c=function(){e.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"}),r.trigger({type:"usage",name:"hls-audio-change"})};r.audioTracks().addEventListener("change",c),r.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),o.on("dispose",function(){r.audioTracks().removeEventListener("change",c),r.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),r.clearTracks("audio");for(var f in e.AUDIO.tracks)r.audioTracks().addTrack(e.AUDIO.tracks[f])},OW=function(){var t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:is,activeTrack:is,getActiveGroup:is,onGroupChanged:is,onTrackChanged:is,lastTrack_:null,logger_:oo("MediaGroups["+e+"]")}}),t},HW=60*2,Wo,zW=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],NW=function(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]},WW=function(t){var e=t.currentPlaylist,i=t.buffered,r=t.currentTime,o=t.nextPlaylist,s=t.bufferLowWaterLine,a=t.bufferHighWaterLine,l=t.duration,u=t.experimentalBufferBasedABR,h=t.log;if(!o)return ot.log.warn("We received no playlist to switch to. Please check your stream."),!1;var d="allowing switch "+(e&&e.id||"null")+" -> "+o.id;if(!e)return h(d+" as current playlist is not set"),!0;if(o.id===e.id)return!1;var c=!!Pl(i,r).length;if(!e.endList)return!c&&typeof e.partTargetDuration=="number"?(h("not "+d+" as current playlist is live llhls, but currentTime isn't in buffered."),!1):(h(d+" as current playlist is live"),!0);var f=Ky(i,r),g=u?Gi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Gi.MAX_BUFFER_LOW_WATER_LINE;if(l<g)return h(d+" as duration < max low water line ("+l+" < "+g+")"),!0;var m=o.attributes.BANDWIDTH,p=e.attributes.BANDWIDTH;if(m<p&&(!u||f<a)){var v=d+" as next bandwidth < current bandwidth ("+m+" < "+p+")";return u&&(v+=" and forwardBuffer < bufferHighWaterLine ("+f+" < "+a+")"),h(v),!0}if((!u||m>p)&&f>=s){var b=d+" as forwardBuffer >= bufferLowWaterLine ("+f+" >= "+s+")";return u&&(b+=" and next bandwidth > current bandwidth ("+m+" > "+p+")"),h(b),!0}return h("not "+d+" as no switching criteria met"),!1},UW=function(n){kt(t,n);function t(i){var r;r=n.call(this)||this;var o=i.src,s=i.handleManifestRedirects,a=i.withCredentials,l=i.tech,u=i.bandwidth,h=i.externVhs,d=i.useCueTags,c=i.blacklistDuration,f=i.enableLowInitialPlaylist,g=i.sourceType,m=i.cacheEncryptionKeys,p=i.experimentalBufferBasedABR,v=i.experimentalLeastPixelDiffSelector,b=i.captionServices;if(!o)throw new Error("A non-empty playlist URL or JSON manifest string is required");var C=i.maxPlaylistRetries;(C===null||typeof C>"u")&&(C=1/0),Wo=h,r.experimentalBufferBasedABR=!!p,r.experimentalLeastPixelDiffSelector=!!v,r.withCredentials=a,r.tech_=l,r.vhs_=l.vhs,r.sourceType_=g,r.useCueTags_=d,r.blacklistDuration=c,r.maxPlaylistRetries=C,r.enableLowInitialPlaylist=f,r.useCueTags_&&(r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues"),r.cueTagsTrack_.inBandMetadataTrackDispatchType=""),r.requestOptions_={withCredentials:a,handleManifestRedirects:s,maxPlaylistRetries:C,timeout:null},r.on("error",r.pauseLoading),r.mediaTypes_=OW(),r.mediaSource=new K.MediaSource,r.handleDurationChange_=r.handleDurationChange_.bind(he(r)),r.handleSourceOpen_=r.handleSourceOpen_.bind(he(r)),r.handleSourceEnded_=r.handleSourceEnded_.bind(he(r)),r.mediaSource.addEventListener("durationchange",r.handleDurationChange_),r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_),r.mediaSource.addEventListener("sourceended",r.handleSourceEnded_),r.seekable_=ot.createTimeRanges(),r.hasPlayed_=!1,r.syncController_=new SW(i),r.segmentMetadataTrack_=l.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,r.decrypter_=new AW,r.sourceUpdater_=new fk(r.mediaSource),r.inbandTextTracks_={},r.timelineChangeController_=new xW;var y={vhs:r.vhs_,parse708captions:i.parse708captions,useDtsForTimestampOffset:i.useDtsForTimestampOffset,captionServices:b,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function(){return r.seekable()},seeking:function(){return r.tech_.seeking()},duration:function(){return r.duration()},hasPlayed:function(){return r.hasPlayed_},goalBufferLength:function(){return r.goalBufferLength()},bandwidth:u,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_,inbandTextTracks:r.inbandTextTracks_,cacheEncryptionKeys:m,sourceUpdater:r.sourceUpdater_,timelineChangeController:r.timelineChangeController_,experimentalExactManifestTimings:i.experimentalExactManifestTimings};r.masterPlaylistLoader_=r.sourceType_==="dash"?new g_(o,r.vhs_,r.requestOptions_):new kl(o,r.vhs_,r.requestOptions_),r.setupMasterPlaylistLoaderListeners_(),r.mainSegmentLoader_=new m_(ot.mergeOptions(y,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),i),r.audioSegmentLoader_=new m_(ot.mergeOptions(y,{loaderType:"audio"}),i),r.subtitleSegmentLoader_=new _W(ot.mergeOptions(y,{loaderType:"vtt",featuresNativeTextTracks:r.tech_.featuresNativeTextTracks,loadVttJs:function(){return new Promise(function(A,T){function S(){l.off("vttjserror",x),A()}function x(){l.off("vttjsloaded",S),T()}l.one("vttjsloaded",S),l.one("vttjserror",x),l.addWebVttScript_()})}}),i),r.setupSegmentLoaderListeners_(),r.experimentalBufferBasedABR&&(r.masterPlaylistLoader_.one("loadedplaylist",function(){return r.startABRTimer_()}),r.tech_.on("pause",function(){return r.stopABRTimer_()}),r.tech_.on("play",function(){return r.startABRTimer_()})),zW.forEach(function(_){r[_+"_"]=NW.bind(he(r),_)}),r.logger_=oo("MPC"),r.triggeredFmp4Usage=!1,r.tech_.preload()==="none"?(r.loadOnPlay_=function(){r.loadOnPlay_=null,r.masterPlaylistLoader_.load()},r.tech_.one("play",r.loadOnPlay_)):r.masterPlaylistLoader_.load(),r.timeToLoadedData__=-1,r.mainAppendsToLoadedData__=-1,r.audioAppendsToLoadedData__=-1;var w=r.tech_.preload()==="none"?"play":"loadstart";return r.tech_.one(w,function(){var _=Date.now();r.tech_.one("loadeddata",function(){r.timeToLoadedData__=Date.now()-_,r.mainAppendsToLoadedData__=r.mainSegmentLoader_.mediaAppends,r.audioAppendsToLoadedData__=r.audioSegmentLoader_.mediaAppends})}),r}var e=t.prototype;return e.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__},e.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__},e.appendsToLoadedData_=function(){var r=this.mainAppendsToLoadedData_(),o=this.audioAppendsToLoadedData_();return r===-1||o===-1?-1:r+o},e.timeToLoadedData_=function(){return this.timeToLoadedData__},e.checkABR_=function(r){r===void 0&&(r="abr");var o=this.selectPlaylist();o&&this.shouldSwitchToMedia_(o)&&this.switchMedia_(o,r)},e.switchMedia_=function(r,o,s){var a=this.media(),l=a&&(a.id||a.uri),u=r.id||r.uri;l&&l!==u&&(this.logger_("switch media "+l+" -> "+u+" from "+o),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+o})),this.masterPlaylistLoader_.media(r,s)},e.startABRTimer_=function(){var r=this;this.stopABRTimer_(),this.abrTimer_=K.setInterval(function(){return r.checkABR_()},250)},e.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(K.clearInterval(this.abrTimer_),this.abrTimer_=null)},e.getAudioTrackPlaylists_=function(){var r=this.master(),o=r&&r.playlists||[];if(!r||!r.mediaGroups||!r.mediaGroups.AUDIO)return o;var s=r.mediaGroups.AUDIO,a=Object.keys(s),l;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)l=this.mediaTypes_.AUDIO.activeTrack();else{var u=s.main||a.length&&s[a[0]];for(var h in u)if(u[h].default){l={label:h};break}}if(!l)return o;var d=[];for(var c in s)if(s[c][l.label]){var f=s[c][l.label];if(f.playlists&&f.playlists.length)d.push.apply(d,f.playlists);else if(f.uri)d.push(f);else if(r.playlists.length)for(var g=0;g<r.playlists.length;g++){var m=r.playlists[g];m.attributes&&m.attributes.AUDIO&&m.attributes.AUDIO===c&&d.push(m)}}return d.length?d:o},e.setupMasterPlaylistLoaderListeners_=function(){var r=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var o=r.masterPlaylistLoader_.media(),s=o.targetDuration*1.5*1e3;u_(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.media())?r.requestOptions_.timeout=0:r.requestOptions_.timeout=s,o.endList&&r.tech_.preload()!=="none"&&(r.mainSegmentLoader_.playlist(o,r.requestOptions_),r.mainSegmentLoader_.load()),FW({sourceType:r.sourceType_,segmentLoaders:{AUDIO:r.audioSegmentLoader_,SUBTITLES:r.subtitleSegmentLoader_,main:r.mainSegmentLoader_},tech:r.tech_,requestOptions:r.requestOptions_,masterPlaylistLoader:r.masterPlaylistLoader_,vhs:r.vhs_,master:r.master(),mediaTypes:r.mediaTypes_,blacklistCurrentPlaylist:r.blacklistCurrentPlaylist.bind(r)}),r.triggerPresenceUsage_(r.master(),o),r.setupFirstPlay(),!r.mediaTypes_.AUDIO.activePlaylistLoader||r.mediaTypes_.AUDIO.activePlaylistLoader.media()?r.trigger("selectedinitialmedia"):r.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){r.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){r.loadOnPlay_&&r.tech_.off("play",r.loadOnPlay_);var o=r.masterPlaylistLoader_.media();if(!o){r.excludeUnsupportedVariants_();var s;if(r.enableLowInitialPlaylist&&(s=r.selectInitialPlaylist()),s||(s=r.selectPlaylist()),!s||!r.shouldSwitchToMedia_(s))return;r.initialMedia_=s,r.switchMedia_(r.initialMedia_,"initial");var a=r.sourceType_==="vhs-json"&&r.initialMedia_.segments;if(!a)return;o=r.initialMedia_}r.handleUpdatedMediaPlaylist(o)}),this.masterPlaylistLoader_.on("error",function(){r.blacklistCurrentPlaylist(r.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){r.mainSegmentLoader_.abort(),r.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var o=r.masterPlaylistLoader_.media(),s=o.targetDuration*1.5*1e3;u_(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.media())?r.requestOptions_.timeout=0:r.requestOptions_.timeout=s,r.masterPlaylistLoader_.load(),r.mainSegmentLoader_.playlist(o,r.requestOptions_),r.mainSegmentLoader_.load(),r.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var o=r.masterPlaylistLoader_.media();if(o.lastExcludeReason_!=="playlist-unchanged"){var s=r.stuckAtPlaylistEnd_(o);s&&(r.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"}),r.tech_.trigger("playliststuck"))}}),this.masterPlaylistLoader_.on("renditiondisabled",function(){r.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),r.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){r.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),r.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},e.handleUpdatedMediaPlaylist=function(r){this.useCueTags_&&this.updateAdCues_(r),this.mainSegmentLoader_.playlist(r,this.requestOptions_),this.updateDuration(!r.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},e.triggerPresenceUsage_=function(r,o){var s=r.mediaGroups||{},a=!0,l=Object.keys(s.AUDIO);for(var u in s.AUDIO)for(var h in s.AUDIO[u]){var d=s.AUDIO[u][h];d.uri||(a=!1)}a&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(s.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),Wo.Playlist.isAes(o)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),l.length&&Object.keys(s.AUDIO[l[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},e.shouldSwitchToMedia_=function(r){var o=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_,s=this.tech_.currentTime(),a=this.bufferLowWaterLine(),l=this.bufferHighWaterLine(),u=this.tech_.buffered();return WW({buffered:u,currentTime:s,currentPlaylist:o,nextPlaylist:r,bufferLowWaterLine:a,bufferHighWaterLine:l,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},e.setupSegmentLoaderListeners_=function(){var r=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){r.checkABR_("bandwidthupdate"),r.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",function(){r.experimentalBufferBasedABR&&r.mainSegmentLoader_.load()}),this.experimentalBufferBasedABR||this.mainSegmentLoader_.on("progress",function(){r.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){r.blacklistCurrentPlaylist(r.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){r.error=r.mainSegmentLoader_.error_,r.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){r.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){r.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),r.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){r.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){r.error=r.audioSegmentLoader_.error_,r.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){r.logger_("main segment loader ended"),r.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(s){r.experimentalBufferBasedABR||(r.delegateLoaders_("all",["abort"]),r.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},HW))});var o=function(){if(!r.sourceUpdater_.hasCreatedSourceBuffers())return r.tryToCreateSourceBuffers_();var a=r.getCodecsOrExclude_();a&&r.sourceUpdater_.addOrChangeSourceBuffers(a)};this.mainSegmentLoader_.on("trackinfo",o),this.audioSegmentLoader_.on("trackinfo",o),this.mainSegmentLoader_.on("fmp4",function(){r.triggeredFmp4Usage||(r.tech_.trigger({type:"usage",name:"vhs-fmp4"}),r.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){r.triggeredFmp4Usage||(r.tech_.trigger({type:"usage",name:"vhs-fmp4"}),r.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){r.logger_("audioSegmentLoader ended"),r.onEndOfStream()})},e.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},e.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},e.smoothQualityChange_=function(r){r===void 0&&(r=this.selectPlaylist()),this.fastQualityChange_(r)},e.fastQualityChange_=function(r){var o=this;if(r===void 0&&(r=this.selectPlaylist()),r===this.masterPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(r,"fast-quality"),this.mainSegmentLoader_.resetEverything(function(){ot.browser.IE_VERSION||ot.browser.IS_EDGE?o.tech_.setCurrentTime(o.tech_.currentTime()+.04):o.tech_.setCurrentTime(o.tech_.currentTime())})},e.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var r=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<r.start(0))return this.tech_.setCurrentTime(r.end(r.length-1))}},e.setupFirstPlay=function(){var r=this,o=this.masterPlaylistLoader_.media();if(!o||this.tech_.paused()||this.hasPlayed_)return!1;if(!o.endList){var s=this.seekable();if(!s.length)return!1;if(ot.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",function(){r.trigger("firstplay"),r.tech_.setCurrentTime(s.end(0)),r.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(s.end(0))}return this.hasPlayed_=!0,this.load(),!0},e.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var r=this.tech_.play();typeof r<"u"&&typeof r.then=="function"&&r.then(null,function(o){})}this.trigger("sourceopen")},e.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var r=this.inbandTextTracks_.metadataTrack_.cues;if(!(!r||!r.length)){var o=this.duration();r[r.length-1].endTime=isNaN(o)||Math.abs(o)===1/0?Number.MAX_VALUE:o}}},e.handleDurationChange_=function(){this.tech_.trigger("durationchange")},e.onEndOfStream=function(){var r=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var o=this.mainSegmentLoader_.getCurrentMediaInfo_();!o||o.hasVideo?r=r&&this.audioSegmentLoader_.ended_:r=this.audioSegmentLoader_.ended_}r&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},e.stuckAtPlaylistEnd_=function(r){var o=this.seekable();if(!o.length)return!1;var s=this.syncController_.getExpiredTime(r,this.duration());if(s===null)return!1;var a=Wo.Playlist.playlistEnd(r,s),l=this.tech_.currentTime(),u=this.tech_.buffered();if(!u.length)return a-l<=To;var h=u.end(u.length-1);return h-l<=To&&a-h<=To},e.blacklistCurrentPlaylist=function(r,o){r===void 0&&(r={});var s=r.playlist||this.masterPlaylistLoader_.media();if(o=o||r.blacklistDuration||this.blacklistDuration,!s){this.error=r,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}s.playlistErrors_++;var a=this.masterPlaylistLoader_.master.playlists,l=a.filter(Tm),u=l.length===1&&l[0]===s;if(a.length===1&&o!==1/0)return ot.log.warn("Problem encountered with playlist "+s.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(u);if(u){var h=!1;a.forEach(function(v){if(v!==s){var b=v.excludeUntil;typeof b<"u"&&b!==1/0&&(h=!0,delete v.excludeUntil)}}),h&&(ot.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}var d;s.playlistErrors_>this.maxPlaylistRetries?d=1/0:d=Date.now()+o*1e3,s.excludeUntil=d,r.reason&&(s.lastExcludeReason_=r.reason),this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var c=this.selectPlaylist();if(!c){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}var f=r.internal?this.logger_:ot.log.warn,g=r.message?" "+r.message:"";f((r.internal?"Internal problem":"Problem")+" encountered with playlist "+s.id+"."+(g+" Switching to playlist "+c.id+".")),c.attributes.AUDIO!==s.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),c.attributes.SUBTITLES!==s.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var m=c.targetDuration/2*1e3||5*1e3,p=typeof c.lastRequest=="number"&&Date.now()-c.lastRequest<=m;return this.switchMedia_(c,"exclude",u||p)},e.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},e.delegateLoaders_=function(r,o){var s=this,a=[],l=r==="all";(l||r==="main")&&a.push(this.masterPlaylistLoader_);var u=[];(l||r==="audio")&&u.push("AUDIO"),(l||r==="subtitle")&&(u.push("CLOSED-CAPTIONS"),u.push("SUBTITLES")),u.forEach(function(h){var d=s.mediaTypes_[h]&&s.mediaTypes_[h].activePlaylistLoader;d&&a.push(d)}),["main","audio","subtitle"].forEach(function(h){var d=s[h+"SegmentLoader_"];d&&(r===h||r==="all")&&a.push(d)}),a.forEach(function(h){return o.forEach(function(d){typeof h[d]=="function"&&h[d]()})})},e.setCurrentTime=function(r){var o=Pl(this.tech_.buffered(),r);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())||!this.masterPlaylistLoader_.media().segments)return 0;if(o&&o.length)return r;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()},e.duration=function(){if(!this.masterPlaylistLoader_)return 0;var r=this.masterPlaylistLoader_.media();return r?r.endList?this.mediaSource?this.mediaSource.duration:Wo.Playlist.duration(r):1/0:0},e.seekable=function(){return this.seekable_},e.onSyncInfoUpdate_=function(){var r;if(this.masterPlaylistLoader_){var o=this.masterPlaylistLoader_.media();if(o){var s=this.syncController_.getExpiredTime(o,this.duration());if(s!==null){var a=this.masterPlaylistLoader_.master,l=Wo.Playlist.seekable(o,s,Wo.Playlist.liveEdgeDelay(a,o));if(l.length!==0&&!(this.mediaTypes_.AUDIO.activePlaylistLoader&&(o=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),s=this.syncController_.getExpiredTime(o,this.duration()),s===null||(r=Wo.Playlist.seekable(o,s,Wo.Playlist.liveEdgeDelay(a,o)),r.length===0)))){var u,h;this.seekable_&&this.seekable_.length&&(u=this.seekable_.end(0),h=this.seekable_.start(0)),r?r.start(0)>l.end(0)||l.start(0)>r.end(0)?this.seekable_=l:this.seekable_=ot.createTimeRanges([[r.start(0)>l.start(0)?r.start(0):l.start(0),r.end(0)<l.end(0)?r.end(0):l.end(0)]]):this.seekable_=l,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===u&&this.seekable_.start(0)===h)&&(this.logger_("seekable updated ["+BP(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},e.updateDuration=function(r){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,r),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(r){var o=this.seekable();if(!o.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<o.end(o.length-1))&&this.sourceUpdater_.setDuration(o.end(o.length-1));return}var s=this.tech_.buffered(),a=Wo.Playlist.duration(this.masterPlaylistLoader_.media());s.length>0&&(a=Math.max(a,s.end(s.length-1))),this.mediaSource.duration!==a&&this.sourceUpdater_.setDuration(a)},e.dispose=function(){var r=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(function(o){var s=r.mediaTypes_[o].groups;for(var a in s)s[a].forEach(function(l){l.playlistLoader&&l.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},e.master=function(){return this.masterPlaylistLoader_.master},e.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},e.areMediaTypesKnown_=function(){var r=!!this.mediaTypes_.AUDIO.activePlaylistLoader,o=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),s=r?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!o||!s)},e.getCodecsOrExclude_=function(){var r=this,o={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},s=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();o.video=o.main;var a=Oh(this.master(),s),l={},u=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(o.main.hasVideo&&(l.video=a.video||o.main.videoCodec||L3),o.main.isMuxed&&(l.video+=","+(a.audio||o.main.audioCodec||fS)),(o.main.hasAudio&&!o.main.isMuxed||o.audio.hasAudio||u)&&(l.audio=a.audio||o.main.audioCodec||o.audio.audioCodec||fS,o.audio.isFmp4=o.main.hasAudio&&!o.main.isMuxed?o.main.isFmp4:o.audio.isFmp4),!l.audio&&!l.video){this.blacklistCurrentPlaylist({playlist:s,message:"Could not determine codecs for playlist.",blacklistDuration:1/0});return}var h=function(v,b){return v?yf(b):P0(b)},d={},c;if(["video","audio"].forEach(function(p){if(l.hasOwnProperty(p)&&!h(o[p].isFmp4,l[p])){var v=o[p].isFmp4?"browser":"muxer";d[v]=d[v]||[],d[v].push(l[p]),p==="audio"&&(c=v)}}),u&&c&&s.attributes.AUDIO){var f=s.attributes.AUDIO;this.master().playlists.forEach(function(p){var v=p.attributes&&p.attributes.AUDIO;v===f&&p!==s&&(p.excludeUntil=1/0)}),this.logger_("excluding audio group "+f+" as "+c+' does not support codec(s): "'+l.audio+'"')}if(Object.keys(d).length){var g=Object.keys(d).reduce(function(p,v){return p&&(p+=", "),p+=v+' does not support codec(s): "'+d[v].join(",")+'"',p},"")+".";this.blacklistCurrentPlaylist({playlist:s,internal:!0,message:g,blacklistDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var m=[];if(["video","audio"].forEach(function(p){var v=(vo(r.sourceUpdater_.codecs[p]||"")[0]||{}).type,b=(vo(l[p]||"")[0]||{}).type;v&&b&&v.toLowerCase()!==b.toLowerCase()&&m.push('"'+r.sourceUpdater_.codecs[p]+'" -> "'+l[p]+'"')}),m.length){this.blacklistCurrentPlaylist({playlist:s,message:"Codec switching not supported: "+m.join(", ")+".",blacklistDuration:1/0,internal:!0});return}}return l},e.tryToCreateSourceBuffers_=function(){if(!(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers())&&this.areMediaTypesKnown_()){var r=this.getCodecsOrExclude_();if(r){this.sourceUpdater_.createSourceBuffers(r);var o=[r.video,r.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(o)}}},e.excludeUnsupportedVariants_=function(){var r=this,o=this.master().playlists,s=[];Object.keys(o).forEach(function(a){var l=o[a];if(s.indexOf(l.id)===-1){s.push(l.id);var u=Oh(r.master,l),h=[];u.audio&&!P0(u.audio)&&!yf(u.audio)&&h.push("audio codec "+u.audio),u.video&&!P0(u.video)&&!yf(u.video)&&h.push("video codec "+u.video),u.text&&u.text==="stpp.ttml.im1t"&&h.push("text codec "+u.text),h.length&&(l.excludeUntil=1/0,r.logger_("excluding "+l.id+" for unsupported: "+h.join(", ")))}})},e.excludeIncompatibleVariants_=function(r){var o=this,s=[],a=this.master().playlists,l=ig(vo(r)),u=fx(l),h=l.video&&vo(l.video)[0]||null,d=l.audio&&vo(l.audio)[0]||null;Object.keys(a).forEach(function(c){var f=a[c];if(!(s.indexOf(f.id)!==-1||f.excludeUntil===1/0)){s.push(f.id);var g=[],m=Oh(o.masterPlaylistLoader_.master,f),p=fx(m);if(!(!m.audio&&!m.video)){if(p!==u&&g.push('codec count "'+p+'" !== "'+u+'"'),!o.sourceUpdater_.canChangeType()){var v=m.video&&vo(m.video)[0]||null,b=m.audio&&vo(m.audio)[0]||null;v&&h&&v.type.toLowerCase()!==h.type.toLowerCase()&&g.push('video codec "'+v.type+'" !== "'+h.type+'"'),b&&d&&b.type.toLowerCase()!==d.type.toLowerCase()&&g.push('audio codec "'+b.type+'" !== "'+d.type+'"')}g.length&&(f.excludeUntil=1/0,o.logger_("blacklisting "+f.id+": "+g.join(" && ")))}}})},e.updateAdCues_=function(r){var o=0,s=this.seekable();s.length&&(o=s.start(0)),yW(r,this.cueTagsTrack_,o)},e.goalBufferLength=function(){var r=this.tech_.currentTime(),o=Gi.GOAL_BUFFER_LENGTH,s=Gi.GOAL_BUFFER_LENGTH_RATE,a=Math.max(o,Gi.MAX_GOAL_BUFFER_LENGTH);return Math.min(o+r*s,a)},e.bufferLowWaterLine=function(){var r=this.tech_.currentTime(),o=Gi.BUFFER_LOW_WATER_LINE,s=Gi.BUFFER_LOW_WATER_LINE_RATE,a=Math.max(o,Gi.MAX_BUFFER_LOW_WATER_LINE),l=Math.max(o,Gi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(o+r*s,this.experimentalBufferBasedABR?l:a)},e.bufferHighWaterLine=function(){return Gi.BUFFER_HIGH_WATER_LINE},t}(ot.EventTarget),VW=function(t,e,i){return function(r){var o=t.master.playlists[e],s=Qy(o),a=Tm(o);return typeof r>"u"?a:(r?delete o.disabled:o.disabled=!0,r!==a&&!s&&(i(),r?t.trigger("renditionenabled"):t.trigger("renditiondisabled")),r)}},jW=function(t,e,i){var r=t.masterPlaylistController_,o=t.options_.smoothQualityChange,s=o?"smooth":"fast",a=r[s+"QualityChange_"].bind(r);if(e.attributes){var l=e.attributes.RESOLUTION;this.width=l&&l.width,this.height=l&&l.height,this.bandwidth=e.attributes.BANDWIDTH,this.frameRate=e.attributes["FRAME-RATE"]}this.codecs=Oh(r.master(),e),this.playlist=e,this.id=i,this.enabled=VW(t.playlists,e.id,a)},GW=function(t){t.representations=function(){var e=t.masterPlaylistController_.master(),i=Vd(e)?t.masterPlaylistController_.getAudioTrackPlaylists_():e.playlists;return i?i.filter(function(r){return!Qy(r)}).map(function(r,o){return new jW(t,r,r.id)}):[]}},Tx=["seeking","seeked","pause","playing","error"],$W=function(){function n(e){var i=this;this.masterPlaylistController_=e.masterPlaylistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=oo("PlaybackWatcher"),this.logger_("initialize");var r=function(){return i.monitorCurrentTime_()},o=function(){return i.monitorCurrentTime_()},s=function(){return i.techWaiting_()},a=function(){return i.cancelTimer_()},l=this.masterPlaylistController_,u=["main","subtitle","audio"],h={};u.forEach(function(c){h[c]={reset:function(){return i.resetSegmentDownloads_(c)},updateend:function(){return i.checkSegmentDownloads_(c)}},l[c+"SegmentLoader_"].on("appendsdone",h[c].updateend),l[c+"SegmentLoader_"].on("playlistupdate",h[c].reset),i.tech_.on(["seeked","seeking"],h[c].reset)});var d=function(f){["main","audio"].forEach(function(g){l[g+"SegmentLoader_"][f]("appended",i.seekingAppendCheck_)})};this.seekingAppendCheck_=function(){i.fixesBadSeeks_()&&(i.consecutiveUpdates=0,i.lastRecordedTime=i.tech_.currentTime(),d("off"))},this.clearSeekingAppendCheck_=function(){return d("off")},this.watchForBadSeeking_=function(){i.clearSeekingAppendCheck_(),d("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",s),this.tech_.on(Tx,a),this.tech_.on("canplay",o),this.tech_.one("play",r),this.dispose=function(){i.clearSeekingAppendCheck_(),i.logger_("dispose"),i.tech_.off("waiting",s),i.tech_.off(Tx,a),i.tech_.off("canplay",o),i.tech_.off("play",r),i.tech_.off("seeking",i.watchForBadSeeking_),i.tech_.off("seeked",i.clearSeekingAppendCheck_),u.forEach(function(c){l[c+"SegmentLoader_"].off("appendsdone",h[c].updateend),l[c+"SegmentLoader_"].off("playlistupdate",h[c].reset),i.tech_.off(["seeked","seeking"],h[c].reset)}),i.checkCurrentTimeTimeout_&&K.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}var t=n.prototype;return t.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&K.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=K.setTimeout(this.monitorCurrentTime_.bind(this),250)},t.resetSegmentDownloads_=function(i){var r=this.masterPlaylistController_[i+"SegmentLoader_"];this[i+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+i+" loader"),this[i+"StalledDownloads_"]=0,this[i+"Buffered_"]=r.buffered_()},t.checkSegmentDownloads_=function(i){var r=this.masterPlaylistController_,o=r[i+"SegmentLoader_"],s=o.buffered_(),a=ON(this[i+"Buffered_"],s);if(this[i+"Buffered_"]=s,a){this.resetSegmentDownloads_(i);return}this[i+"StalledDownloads_"]++,this.logger_("found #"+this[i+"StalledDownloads_"]+" "+i+" appends that did not increase buffer (possible stalled download)",{playlistId:o.playlist_&&o.playlist_.id,buffered:Ba(s)}),!(this[i+"StalledDownloads_"]<10)&&(this.logger_(i+" loader stalled download exclusion"),this.resetSegmentDownloads_(i),this.tech_.trigger({type:"usage",name:"vhs-"+i+"-download-exclusion"}),i!=="subtitle"&&r.blacklistCurrentPlaylist({message:"Excessive "+i+" segment downloading detected."},1/0))},t.checkCurrentTime_=function(){if(!(this.tech_.paused()||this.tech_.seeking())){var i=this.tech_.currentTime(),r=this.tech_.buffered();if(this.lastRecordedTime===i&&(!r.length||i+To>=r.end(r.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&i===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):i===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=i)}},t.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},t.fixesBadSeeks_=function(){var i=this.tech_.seeking();if(!i)return!1;var r=this.seekable(),o=this.tech_.currentTime(),s=this.afterSeekableWindow_(r,o,this.media(),this.allowSeeksWithinUnsafeLiveWindow),a;if(s){var l=r.end(r.length-1);a=l}if(this.beforeSeekableWindow_(r,o)){var u=r.start(0);a=u+(u===r.end(0)?0:To)}if(typeof a<"u")return this.logger_("Trying to seek outside of seekable at time "+o+" with "+("seekable range "+BP(r)+". Seeking to ")+(a+".")),this.tech_.setCurrentTime(a),!0;for(var h=this.masterPlaylistController_.sourceUpdater_,d=this.tech_.buffered(),c=h.audioBuffer?h.audioBuffered():null,f=h.videoBuffer?h.videoBuffered():null,g=this.media(),m=g.partTargetDuration?g.partTargetDuration:(g.targetDuration-js)*2,p=[c,f],v=0;v<p.length;v++)if(p[v]){var b=Ky(p[v],o);if(b<m)return!1}var C=Lc(d,o);return C.length===0?!1:(a=C.start(0)+To,this.logger_("Buffered region starts ("+C.start(0)+") "+(" just beyond seek point ("+o+"). Seeking to "+a+".")),this.tech_.setCurrentTime(a),!0)},t.waiting_=function(){if(!this.techWaiting_()){var i=this.tech_.currentTime(),r=this.tech_.buffered(),o=Pl(r,i);if(o.length&&i+3<=o.end(0)){this.cancelTimer_(),this.tech_.setCurrentTime(i),this.logger_("Stopped at "+i+" while inside a buffered region "+("["+o.start(0)+" -> "+o.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}},t.techWaiting_=function(){var i=this.seekable(),r=this.tech_.currentTime();if(this.tech_.seeking()||this.timer_!==null)return!0;if(this.beforeSeekableWindow_(i,r)){var o=i.end(i.length-1);return this.logger_("Fell out of live window at time "+r+". Seeking to "+("live point (seekable end) "+o)),this.cancelTimer_(),this.tech_.setCurrentTime(o),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var s=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,a=this.tech_.buffered(),l=this.videoUnderflow_({audioBuffered:s.audioBuffered(),videoBuffered:s.videoBuffered(),currentTime:r});if(l)return this.cancelTimer_(),this.tech_.setCurrentTime(r),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var u=Lc(a,r);if(u.length>0){var h=u.start(0)-r;return this.logger_("Stopped at "+r+", setting timer for "+h+", seeking "+("to "+u.start(0))),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),h*1e3,r),!0}return!1},t.afterSeekableWindow_=function(i,r,o,s){if(s===void 0&&(s=!1),!i.length)return!1;var a=i.end(i.length-1)+To,l=!o.endList;return l&&s&&(a=i.end(i.length-1)+o.targetDuration*3),r>a},t.beforeSeekableWindow_=function(i,r){return!!(i.length&&i.start(0)>0&&r<i.start(0)-this.liveRangeSafeTimeDelta)},t.videoUnderflow_=function(i){var r=i.videoBuffered,o=i.audioBuffered,s=i.currentTime;if(r){var a;if(r.length&&o.length){var l=Pl(r,s-3),u=Pl(r,s),h=Pl(o,s);h.length&&!u.length&&l.length&&(a={start:l.end(0),end:h.end(0)})}else{var d=Lc(r,s);d.length||(a=this.gapFromVideoUnderflow_(r,s))}return a?(this.logger_("Encountered a gap in video from "+a.start+" to "+a.end+". "+("Seeking to current time "+s)),!0):!1}},t.skipTheGap_=function(i){var r=this.tech_.buffered(),o=this.tech_.currentTime(),s=Lc(r,o);this.cancelTimer_(),!(s.length===0||o!==i)&&(this.logger_("skipTheGap_:","currentTime:",o,"scheduled currentTime:",i,"nextRange start:",s.start(0)),this.tech_.setCurrentTime(s.start(0)+js),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},t.gapFromVideoUnderflow_=function(i,r){for(var o=DN(i),s=0;s<o.length;s++){var a=o.start(s),l=o.end(s);if(r-a<4&&r-a>2)return{start:a,end:l}}return null},n}(),qW={errorInterval:30,getSource:function(t){var e=this.tech({IWillNotUseThisInPlugins:!0}),i=e.currentSource_||this.currentSource();return t(i)}},XW=function n(t,e){var i=0,r=0,o=ot.mergeOptions(qW,e);t.ready(function(){t.trigger({type:"usage",name:"vhs-error-reload-initialized"}),t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var s=function(){r&&t.currentTime(r)},a=function(c){c!=null&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",s),t.src(c),t.trigger({type:"usage",name:"vhs-error-reload"}),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},l=function(){if(Date.now()-i<o.errorInterval*1e3){t.trigger({type:"usage",name:"vhs-error-reload-canceled"}),t.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!o.getSource||typeof o.getSource!="function"){ot.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),o.getSource.call(t,a)},u=function d(){t.off("loadedmetadata",s),t.off("error",l),t.off("dispose",d)},h=function(c){u(),n(t,c)};t.on("error",l),t.on("dispose",u),t.reloadSourceOnError=h},YW=function(t){XW(this,t)},gk="2.16.3",KW="6.0.1",ZW="0.22.1",QW="4.8.0",JW="3.1.3",sr={PlaylistLoader:kl,Playlist:jr,utils:l5,STANDARD_PLAYLIST_SELECTOR:px,INITIAL_PLAYLIST_SELECTOR:Z5,lastBandwidthSelector:px,movingAverageBandwidthSelector:Y5,comparePlaylistBandwidth:iw,comparePlaylistResolution:X5,xhr:GP()};Object.keys(Gi).forEach(function(n){Object.defineProperty(sr,n,{get:function(){return ot.log.warn("using Vhs."+n+" is UNSAFE be sure you know what you are doing"),Gi[n]},set:function(e){if(ot.log.warn("using Vhs."+n+" is UNSAFE be sure you know what you are doing"),typeof e!="number"||e<0){ot.log.warn("value of Vhs."+n+" must be greater than or equal to 0");return}Gi[n]=e}})});var pk="videojs-vhs",mk=function(t,e){for(var i=e.media(),r=-1,o=0;o<t.length;o++)if(t[o].id===i.id){r=o;break}t.selectedIndex_=r,t.trigger({selectedIndex:r,type:"change"})},t4=function(t,e){e.representations().forEach(function(i){t.addQualityLevel(i)}),mk(t,e.playlists)};sr.canPlaySource=function(){return ot.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var e4=function(t,e,i){if(!t)return t;var r={};e&&e.attributes&&e.attributes.CODECS&&(r=ig(vo(e.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(r.audio=i.attributes.CODECS);var o=id(r.video),s=id(r.audio),a={};for(var l in t)a[l]={},s&&(a[l].audioContentType=s),o&&(a[l].videoContentType=o),e.contentProtection&&e.contentProtection[l]&&e.contentProtection[l].pssh&&(a[l].pssh=e.contentProtection[l].pssh),typeof t[l]=="string"&&(a[l].url=t[l]);return ot.mergeOptions(t,a)},i4=function(t,e){return t.reduce(function(i,r){if(!r.contentProtection)return i;var o=e.reduce(function(s,a){var l=r.contentProtection[a];return l&&l.pssh&&(s[a]={pssh:l.pssh}),s},{});return Object.keys(o).length&&i.push(o),i},[])},r4=function(t){var e=t.player,i=t.sourceKeySystems,r=t.audioMedia,o=t.mainPlaylists;if(!e.eme.initializeMediaKeys)return Promise.resolve();var s=r?o.concat([r]):o,a=i4(s,Object.keys(i)),l=[],u=[];return a.forEach(function(h){u.push(new Promise(function(d,c){e.tech_.one("keysessioncreated",d)})),l.push(new Promise(function(d,c){e.eme.initializeMediaKeys({keySystems:h},function(f){if(f){c(f);return}d()})}))}),Promise.race([Promise.all(l),Promise.race(u)])},n4=function(t){var e=t.player,i=t.sourceKeySystems,r=t.media,o=t.audioMedia,s=e4(i,r,o);return s?(e.currentSource().keySystems=s,s&&!e.eme?(ot.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},vk=function(){if(!K.localStorage)return null;var t=K.localStorage.getItem(pk);if(!t)return null;try{return JSON.parse(t)}catch{return null}},o4=function(t){if(!K.localStorage)return!1;var e=vk();e=e?ot.mergeOptions(e,t):t;try{K.localStorage.setItem(pk,JSON.stringify(e))}catch{return!1}return e},s4=function(t){return t.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(t.substring(t.indexOf(",")+1)):t};sr.supportsNativeHls=function(){if(!Rt||!Rt.createElement)return!1;var n=Rt.createElement("video");if(!ot.getTech("Html5").isSupported())return!1;var t=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return t.some(function(e){return/maybe|probably/i.test(n.canPlayType(e))})}();sr.supportsNativeDash=function(){return!Rt||!Rt.createElement||!ot.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(Rt.createElement("video").canPlayType("application/dash+xml"))}();sr.supportsTypeNatively=function(n){return n==="hls"?sr.supportsNativeHls:n==="dash"?sr.supportsNativeDash:!1};sr.isSupported=function(){return ot.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var a4=ot.getComponent("Component"),nw=function(n){kt(t,n);function t(i,r,o){var s;if(s=n.call(this,r,ot.mergeOptions(o.hls,o.vhs))||this,o.hls&&Object.keys(o.hls).length&&ot.log.warn("Using hls options is deprecated. Please rename `hls` to `vhs` in your options object."),typeof o.initialBandwidth=="number"&&(s.options_.bandwidth=o.initialBandwidth),s.logger_=oo("VhsHandler"),r.options_&&r.options_.playerId){var a=ot(r.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return ot.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),r.trigger({type:"usage",name:"hls-player-access"}),he(s)},configurable:!0}),a.hasOwnProperty("vhs")||Object.defineProperty(a,"vhs",{get:function(){return ot.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),r.trigger({type:"usage",name:"vhs-player-access"}),he(s)},configurable:!0}),a.hasOwnProperty("dash")||Object.defineProperty(a,"dash",{get:function(){return ot.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),he(s)},configurable:!0}),s.player_=a}if(s.tech_=r,s.source_=i,s.stats={},s.ignoreNextSeekingEvent_=!1,s.setOptions_(),s.options_.overrideNative&&r.overrideNativeAudioTracks&&r.overrideNativeVideoTracks)r.overrideNativeAudioTracks(!0),r.overrideNativeVideoTracks(!0);else if(s.options_.overrideNative&&(r.featuresNativeVideoTracks||r.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return s.on(Rt,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(l){var u=Rt.fullscreenElement||Rt.webkitFullscreenElement||Rt.mozFullScreenElement||Rt.msFullscreenElement;u&&u.contains(s.tech_.el())?s.masterPlaylistController_.fastQualityChange_():s.masterPlaylistController_.checkABR_()}),s.on(s.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),s.on(s.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),s.on(s.tech_,"play",s.play),s}var e=t.prototype;return e.setOptions_=function(){var r=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects!==!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,typeof this.options_.blacklistDuration!="number"&&(this.options_.blacklistDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){var o=vk();o&&o.bandwidth&&(this.options_.bandwidth=o.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),o&&o.throughput&&(this.options_.throughput=o.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Gi.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Gi.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","useDtsForTimestampOffset","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach(function(s){typeof r.source_[s]<"u"&&(r.options_[s]=r.source_[s])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},e.src=function(r,o){var s=this;if(r){this.setOptions_(),this.options_.src=s4(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=sr,this.options_.sourceType=lB(o),this.options_.seekTo=function(u){s.tech_.setCurrentTime(u)},this.options_.smoothQualityChange&&ot.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"),this.masterPlaylistController_=new UW(this.options_);var a=ot.mergeOptions({liveRangeSafeTimeDelta:To},this.options_,{seekable:function(){return s.seekable()},media:function(){return s.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new $W(a),this.masterPlaylistController_.on("error",function(){var u=ot.players[s.tech_.options_.playerId],h=s.masterPlaylistController_.error;typeof h=="object"&&!h.code?h.code=3:typeof h=="string"&&(h={message:h,code:3}),u.error(h)});var l=this.options_.experimentalBufferBasedABR?sr.movingAverageBandwidthSelector(.55):sr.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):l.bind(this),this.masterPlaylistController_.selectInitialPlaylist=sr.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(h){this.masterPlaylistController_.selectPlaylist=h.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(h){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=h,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){var h=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,d=K.navigator.connection||K.navigator.mozConnection||K.navigator.webkitConnection,c=1e7;if(this.options_.useNetworkInformationApi&&d){var f=d.downlink*1e3*1e3;f>=c&&h>=c?h=Math.max(h,f):h=f}return h},set:function(h){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=h,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var h=1/(this.bandwidth||1),d;this.throughput>0?d=1/this.throughput:d=0;var c=Math.floor(1/(h+d));return c},set:function(){ot.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return s.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return s.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return s.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return s.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return s.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return s.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return s.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return s.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function(){return s.masterPlaylistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function(){return s.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function(){return s.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function(){return s.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function(){return s.masterPlaylistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function(){return Ba(s.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return s.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return s.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return s.tech_.name_},enumerable:!0},duration:{get:function(){return s.tech_.duration()},enumerable:!0},master:{get:function(){return s.playlists.master},enumerable:!0},playerDimensions:{get:function(){return s.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Ba(s.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return s.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){s.options_.useBandwidthFromLocalStorage&&o4({bandwidth:s.bandwidth,throughput:Math.round(s.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){GW(s)}),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){s.setupEme_()}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=K.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},e.createKeySessions_=function(){var r=this,o=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),r4({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:o&&o.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){r.logger_("created EME key session"),r.masterPlaylistController_.sourceUpdater_.initializedEme()}).catch(function(s){r.logger_("error while creating EME key session",s),r.player_.error({message:"Failed to initialize media keys for EME",code:3})})},e.handleWaitingForKey_=function(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()},e.setupEme_=function(){var r=this,o=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,s=n4({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:o&&o.media()});if(this.player_.tech_.on("keystatuschange",function(a){if(a.status==="output-restricted"){var l=r.masterPlaylistController_.master();if(!(!l||!l.playlists)){var u=[];if(l.playlists.forEach(function(d){d&&d.attributes&&d.attributes.RESOLUTION&&d.attributes.RESOLUTION.height>=720&&(!d.excludeUntil||d.excludeUntil<1/0)&&(d.excludeUntil=1/0,u.push(d))}),u.length){var h;(h=ot.log).warn.apply(h,['DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.'].concat(u)),r.masterPlaylistController_.fastQualityChange_()}}}}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),ot.browser.IE_VERSION===11||!s){this.masterPlaylistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()},e.setupQualityLevels_=function(){var r=this,o=ot.players[this.tech_.options_.playerId];!o||!o.qualityLevels||this.qualityLevels_||(this.qualityLevels_=o.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){t4(r.qualityLevels_,r)}),this.playlists.on("mediachange",function(){mk(r.qualityLevels_,r.playlists)}))},t.version=function(){return{"@videojs/http-streaming":gk,"mux.js":KW,"mpd-parser":ZW,"m3u8-parser":QW,"aes-decrypter":JW}},e.version=function(){return this.constructor.version()},e.canChangeType=function(){return fk.canChangeType()},e.play=function(){this.masterPlaylistController_.play()},e.setCurrentTime=function(r){this.masterPlaylistController_.setCurrentTime(r)},e.duration=function(){return this.masterPlaylistController_.duration()},e.seekable=function(){return this.masterPlaylistController_.seekable()},e.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&K.URL.revokeObjectURL&&(K.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),n.prototype.dispose.call(this)},e.convertToProgramTime=function(r,o){return p5({playlist:this.masterPlaylistController_.media(),time:r,callback:o})},e.seekToProgramTime=function(r,o,s,a){return s===void 0&&(s=!0),a===void 0&&(a=2),m5({programTime:r,playlist:this.masterPlaylistController_.media(),retryCount:a,pauseAfterSeek:s,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:o})},t}(a4),ld={name:"videojs-http-streaming",VERSION:gk,canHandleSource:function(t,e){e===void 0&&(e={});var i=ot.mergeOptions(ot.options,e);return ld.canPlayType(t.type,i)},handleSource:function(t,e,i){i===void 0&&(i={});var r=ot.mergeOptions(ot.options,i);return e.vhs=new nw(t,e,r),ot.hasOwnProperty("hls")||Object.defineProperty(e,"hls",{get:function(){return ot.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),e.vhs},configurable:!0}),e.vhs.xhr=GP(),e.vhs.src(t.src,t.type),e.vhs},canPlayType:function(t,e){var i=lB(t);if(!i)return"";var r=ld.getOverrideNative(e),o=sr.supportsTypeNatively(i),s=!o||r;return s?"maybe":""},getOverrideNative:function(t){t===void 0&&(t={});var e=t,i=e.vhs,r=i===void 0?{}:i,o=e.hls,s=o===void 0?{}:o,a=!(ot.browser.IS_ANY_SAFARI||ot.browser.IS_IOS),l=r.overrideNative,u=l===void 0?a:l,h=s.overrideNative,d=h===void 0?!1:h;return d||u}},l4=function(){return yf("avc1.4d400d,mp4a.40.2")};l4()&&ot.getTech("Html5").registerSourceHandler(ld,0);ot.VhsHandler=nw;Object.defineProperty(ot,"HlsHandler",{get:function(){return ot.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),nw},configurable:!0});ot.VhsSourceHandler=ld;Object.defineProperty(ot,"HlsSourceHandler",{get:function(){return ot.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),ld},configurable:!0});ot.Vhs=sr;Object.defineProperty(ot,"Hls",{get:function(){return ot.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),sr},configurable:!0});ot.use||(ot.registerComponent("Hls",sr),ot.registerComponent("Vhs",sr));ot.options.vhs=ot.options.vhs||{};ot.options.hls=ot.options.hls||{};if(!ot.getPlugin||!ot.getPlugin("reloadSourceOnError")){var u4=ot.registerPlugin||ot.plugin;u4("reloadSourceOnError",YW)}const h4=["onClick"],d4={class:"chapter-title"},c4={class:"chapter-time"},f4={__name:"ChapterList",props:{chapters:{type:Array,default:()=>[]},loading:Boolean},emits:["jump","expand"],setup(n,{emit:t}){const e=t,i=o=>{e("jump",o)},r=o=>{o.includes("sub")&&e("expand")};return(o,s)=>{const a=Sc("n-scrollbar"),l=Sc("n-spin"),u=Sc("n-collapse-item"),h=Sc("n-collapse");return So(),zO(h,{"default-expanded-names":[],class:"subtitle-panel","onUpdate:expandedNames":r},{default:Ma(()=>[zs(u,{title:"章节目录",name:"sub"},{default:Ma(()=>[zs(l,{show:n.loading,style:{width:"100%","min-height":"600px"}},{default:Ma(()=>[zs(a,{style:{"max-height":"550px"}},{default:Ma(()=>[(So(!0),rs(td,null,fy(n.chapters,d=>(So(),rs("div",{key:d.startTime,class:"subtitle-item",onClick:c=>i(d.startTime)},[jn("div",d4,ed(d.titleSummary),1),jn("div",c4,ed(d.displayTime),1)],8,h4))),128))]),_:1})]),_:1},8,["show"])]),_:1})]),_:1})}}};class bi{static GenAutoIncrementId(){return bi.auto_increment_id++}}bi.auto_increment_id=0;class ie{constructor(t){this.id=bi.GenAutoIncrementId(),this.registry=t}}const Am="named",bk="inject",_k="multi_inject",Ck="inversify:tagged",yk="inversify:paramtypes";class ow{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===Am?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}const Vl=function(n){var t;return function(e){const i=typeof Symbol=="function",r=i&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",o=Object.getPrototypeOf(Function),s=Map,a=new WeakMap;function l(D,H,O,N){if(!_(O))throw new TypeError;return v(D,H,O,N)}function u(D,H,O){if(!_(H))throw new TypeError;return C(O)||(O=E(O)),f(D,H,O)}function h(D,H,O){if(!_(H))throw new TypeError;return C(O)||(O=E(O)),g(D,H,O)}function d(D,H,O){if(!_(H))throw new TypeError;return C(O)||(O=E(O)),m(D,H,O)}function c(D,H,O){let N=a.get(D);if(C(N)){if(!O)return;N=new s,a.set(D,N)}let U=N.get(H);if(C(U)){if(!O)return;U=new s,N.set(H,U)}return U}function f(D,H,O){if(g(D,H,O))return!0;const N=I(H);return!y(N)&&f(D,N,O)}function g(D,H,O){const N=c(H,O,!1);return!C(N)&&S(N.has(D))}function m(D,H,O){if(g(D,H,O))return p(D,H,O);const N=I(H);return y(N)?void 0:m(D,N,O)}function p(D,H,O){const N=c(H,O,!1);if(!C(N))return N.get(D)}function v(D,H,O,N){c(O,N,!0).set(D,H)}function b(D){if(D===null)return 1;switch(typeof D){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return D===null?1:6;default:return 6}}function C(D){return D===void 0}function y(D){return D===null}function w(D){return typeof D=="symbol"}function _(D){return typeof D=="object"?D!==null:typeof D=="function"}function A(D,H){switch(b(D)){case 0:case 1:case 2:case 3:case 4:case 5:return D}const O="string",N=L(D,r);if(N!==void 0){const U=N.call(D,O);if(_(U))throw new TypeError;return U}return T(D)}function T(D,H){{const O=D.toString;if(M(O)){const U=O.call(D);if(!_(U))return U}const N=D.valueOf;if(M(N)){const U=N.call(D);if(!_(U))return U}}throw new TypeError}function S(D){return!!D}function x(D){return""+D}function E(D){const H=A(D);return w(H)?H:x(H)}function M(D){return typeof D=="function"}function L(D,H){const O=D[H];if(O!=null){if(!M(O))throw new TypeError;return O}}function I(D){const H=Object.getPrototypeOf(D);if(typeof D!="function"||D===o||H!==o)return H;const O=D.prototype,N=O&&Object.getPrototypeOf(O);if(N==null||N===Object.prototype)return H;const U=N.constructor;return typeof U!="function"||U===D?H:U}e("defineMetadata",l),e("hasMetadata",u),e("hasOwnMetadata",h),e("getMetadata",d)}((t=n,function(e,i){typeof t[e]!="function"&&Object.defineProperty(t,e,{configurable:!0,writable:!0,value:i})})),n}({});function g4(n,t,e,i){const r=[i];let o={};Vl.hasOwnMetadata(n,t)&&(o=Vl.getMetadata(n,t));let s=o[e];s===void 0&&(s=[]),s.push(...r),o[e]=s,Vl.defineMetadata(n,o,t)}function p4(n,t,e,i){g4(Ck,n,e.toString(),i)}function wk(n){return(t,e,i)=>{p4(t,e,i,n)}}function Sk(n){return t=>(e,i,r)=>wk(new ow(n,t))(e,i,r)}const ge=Sk(bk),xk=Sk(_k);function Tt(){return function(n){return Vl.defineMetadata(yk,null,n),n}}function Di(n){return wk(new ow(Am,n))}const Xa={Singleton:"Singleton",Transient:"Transient"},Ls={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class sw{constructor(t,e){this.id=bi.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=Ls.Invalid,this.constraint=i=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){const t=new sw(this.serviceIdentifier,this.scope);return t.activated=t.scope===Xa.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}class m4{getConstructorMetadata(t){return{compilerGeneratedMetadata:Vl.getMetadata(yk,t),userGeneratedMetadata:Vl.getMetadata(Ck,t)||{}}}getPropertiesMetadata(t){throw new Error("暂未实现")}}const v4=n=>t=>{const e=i=>{if(i==null)return!1;if(i.key===n&&i.value===t)return!0;if(i.constructorArgsMetadata==null)return!1;const r=i.constructorArgsMetadata;for(let o=0;o<r.length;o++)if(r[o].key===n&&r[o].value===t)return!0;return!1};return e.metaData=new ow(n,t),e},b4=v4(Am);class Fc{constructor(t){this._binding=t}inRequestScope(){throw new Error("暂未实现")}inSingletonScope(){return this._binding.scope=Xa.Singleton,this}inTransientScope(){return this._binding.scope=Xa.Transient,this}whenTargetNamed(t){return this._binding.constraint=b4(t),this}}class _4{constructor(t){this._binding=t}to(t){return this._binding.type=Ls.Instance,this._binding.implementationType=t,new Fc(this._binding)}toSelf(){const t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=Ls.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Fc(this._binding)}toConstantValue(t){return this._binding.type=Ls.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Xa.Singleton,new Fc(this._binding)}toFactory(t){return this._binding.type=Ls.Factory,this._binding.factory=t,this._binding.scope=Xa.Singleton,new Fc(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let C4=class{constructor(t){const e=t||{};e.defaultScope=e.defaultScope||Xa.Transient,this.options=e,this.id=bi.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new m4}load(t){const e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){const e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){const e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,i){const r=this._getNotAllArgs(t,!1,e,i);return this._get(r)}getNamed(t,e){return this.getTagged(t,Am,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){const e=this.options.defaultScope,i=new sw(t,e),r=this._bindingDictionary.get(t)||[];return r.push(i),this._bindingDictionary.set(t,r),new _4(i)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){const t=(s,a)=>{s._binding.moduleId=a},e=s=>a=>{const l=this.bind(a);return t(l,s),l},i=()=>s=>this.unbind(s),r=()=>s=>this.isBound(s),o=s=>a=>{const l=this.rebind(a);return t(l,s),l};return s=>({bindFunction:e(s),isboundFunction:r(),rebindFunction:o(s),unbindFunction:i(),unbindAsyncFunction:a=>null})}_getNotAllArgs(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){const e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(i=>i.constraint(t)).forEach(i=>{e.push(this._resolveFromBinding(i))}),t.isMultiInject||e.length!==1?e:e[0]}_getChildRequest(t){const e=t.implementationType,{userGeneratedMetadata:i}=this._metadataReader.getConstructorMetadata(e),r=Object.keys(i),o=[];for(let s=0;s<r.length;s++){const a=i[s],l={};a.forEach(f=>{l[f.key]=f.value});const u={inject:l[bk],multiInject:l[_k]},h=u.inject||u.multiInject,d={serviceIdentifier:h,constructorArgsMetadata:a},c=(this._bindingDictionary.get(h)||[]).filter(f=>f.constraint(d));if(c.length){const f={injectIdentifier:h,metadata:a,bindings:c};o.push(f)}}return o}_resolveFromBinding(t){const e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case Ls.ConstantValue:case Ls.Function:e=t.cache;break;case Ls.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;const i=this._getChildRequest(t);return this._createInstance(e,i)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(e=>e.bindings.length>1?e.bindings.map(i=>this._resolveFromBinding(i)):this._resolveFromBinding(e.bindings[0]))}_saveToScope(t,e){t.scope===Xa.Singleton&&(t.cache=e,t.activated=!0)}};const ci=Symbol("ContributionProvider");class Tk{constructor(t,e){this.serviceIdentifier=t,this.container=e,Ak.setStore(this.serviceIdentifier,this)}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}refresh(){this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier)))}}function ar(n,t){n(ci).toDynamicValue(({container:e})=>new Tk(t,e)).inSingletonScope().whenTargetNamed(t)}function y4(n,t){n(ci).toDynamicValue(({container:e})=>new Tk(t,e)).whenTargetNamed(t)}class Ak{static getStore(t){return this.store.get(t)}static setStore(t,e){this.store.set(t,e)}static refreshAllContributions(){this.store.forEach(t=>{t.refresh()})}}Ak.store=new Map;class w4{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){const i=typeof t=="string"?t.trim():t.name;i&&(this.taps=this.taps.filter(r=>!(r.name===i&&(!e||r.fn===e))))}_parseOptions(t,e,i){let r;if(typeof e=="string")r={name:e.trim()};else if(typeof e!="object"||e===null)throw new Error("Invalid tap options");if(typeof r.name!="string"||r.name==="")throw new Error("Missing name for tap");return r=Object.assign({type:t,fn:i},r),r}_tap(t,e,i){this._insert(this._parseOptions(t,e,i))}_insert(t){let e;typeof t.before=="string"?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let i=0;typeof t.stage=="number"&&(i=t.stage);let r=this.taps.length;for(;r>0;){r--;const o=this.taps[r];this.taps[r+1]=o;const s=o.stage||0;if(e){if(e.has(o.name)){e.delete(o.name);continue}if(e.size>0)continue}if(!(s>i)){r++;break}}this.taps[r]=t}}class Vr extends w4{call(...t){this.taps.map(e=>e.fn).forEach(e=>e(...t))}}const Rm=Symbol.for("EnvContribution"),aw=Symbol.for("VGlobal");class S4{}const Mt=new S4;let Ax=0;class Rk{constructor(){this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=t=>{this._rafHandle=null;const e=this.nextAnimationFrameCbs;this.nextAnimationFrameCbs=new Map,e.forEach(i=>i(t))},this.tryRunAnimationFrameNextFrame=()=>{this._rafHandle===null&&this.nextAnimationFrameCbs.size!==0&&(this._rafHandle=Mt.global.getRequestAnimationFrame()(this.runAnimationFrame))}}addAnimationFrameCb(t){return this.nextAnimationFrameCbs.set(++Ax,t),this.tryRunAnimationFrameNextFrame(),Ax}removeAnimationFrameCb(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}class Ek{constructor(){this._listenerMap=new Map,this._eventListenerTransformer=t=>t}setEventListenerTransformer(t){this._eventListenerTransformer=t||(e=>e)}addEventListener(t,e,i){if(!e)return;const r=o=>{const s=this._eventListenerTransformer(o);typeof e=="function"?e(s):e.handleEvent&&e.handleEvent(s)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}removeEventListener(t,e,i){var r;if(!e)return;const o=(r=this._listenerMap.get(t))===null||r===void 0?void 0:r.get(e);o&&(this._nativeRemoveEventListener(t,o,i),this._listenerMap.get(t).delete(e),this._listenerMap.get(t).size===0&&this._listenerMap.delete(t))}dispatchEvent(t){return this._nativeDispatchEvent(t)}clearAllEventListeners(){this._listenerMap.forEach((t,e)=>{t.forEach((i,r)=>{this._nativeRemoveEventListener(e,i,void 0)})}),this._listenerMap.clear()}_nativeAddEventListener(t,e,i){throw new Error("_nativeAddEventListener must be implemented by derived classes")}_nativeRemoveEventListener(t,e,i){throw new Error("_nativeRemoveEventListener must be implemented by derived classes")}_nativeDispatchEvent(t){throw new Error("_nativeDispatchEvent must be implemented by derived classes")}}var x4=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},T4=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Rx=function(n,t){return function(e,i){t(e,i,n)}},A4=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};let __=class extends Ek{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(n){this._isImageAnonymous=n}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(n){this._env||this.setEnv("browser"),this.envContribution.supportEvent=n}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(n){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=n}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(n){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=n}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(n){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=n}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(n){this._env||this.setEnv("browser"),this.envContribution.applyStyles=n}constructor(n){super(),this.contributions=n,this._isImageAnonymous=!0,this._performanceRAFList=[],this.eventListenerTransformer=t=>t,this.id=bi.GenAutoIncrementId(),this.hooks={onSetEnv:new Vr(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}_nativeAddEventListener(n,t,e){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(n,t,e)}_nativeRemoveEventListener(n,t,e){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(n,t,e)}_nativeDispatchEvent(n){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(n)}bindContribution(n){const t=[];if(this.contributions.getContributions().forEach(e=>{const i=e.configure(this,n);i&&i.then&&t.push(i)}),t.length)return Promise.all(t)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(n,t){if(t&&t.force===!0||this._env!==n)return this.deactiveCurrentEnv(),this.activeEnv(n,t)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(n,t){const e=this._env;this._env=n;const i=this.bindContribution(t);if(i&&i.then)return i.then(()=>{this.envParams=t,this.hooks.onSetEnv.call(e,n,this)});this.envParams=t,this.hooks.onSetEnv.call(e,n,this)}setActiveEnvContribution(n){this.envContribution=n}createCanvas(n){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(n)}createOffscreenCanvas(n){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(n)}releaseCanvas(n){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(n)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getSpecifiedRequestAnimationFrame(n){this._env||this.setEnv("browser"),this._performanceRAFList[n]||(this._performanceRAFList[n]=new Rk);const t=this._performanceRAFList[n];return e=>t.addAnimationFrameCb(e)}getSpecifiedCancelAnimationFrame(n){if(this._env||this.setEnv("browser"),!this._performanceRAFList[n])return()=>!1;const t=this._performanceRAFList[n];return e=>t.removeAnimationFrameCb(e)}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(n){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(n):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(n,t){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(n,t):null}loadImage(n){return this._env||this.setEnv("browser"),this.envContribution.loadImage(n)}loadSvg(n){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(n)}loadJson(n){return this._env||this.setEnv("browser"),this.envContribution.loadJson(n)}loadArrayBuffer(n){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(n)}loadBlob(n){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(n)}loadFont(n,t,e){return A4(this,void 0,void 0,function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(n,t,e)})}isChrome(){return this._isChrome!=null||(this._env||this.setEnv("browser"),this._isChrome=this._env==="browser"&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return this._isSafari!=null||(this._env||this.setEnv("browser"),this._isSafari=this._env==="browser"&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(n){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(n)}removeDom(n){return this._env||this.setEnv("browser"),this.envContribution.removeDom(n)}createDom(n){return this._env||this.setEnv("browser"),this.envContribution.createDom(n)}updateDom(n,t){return this._env||this.setEnv("browser"),this.envContribution.updateDom(n,t)}getElementTop(n,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(n,t)}getElementLeft(n,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(n,t)}getElementTopLeft(n,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(n,t)}isMacOS(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}copyToClipBoard(n){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(n)}};__=x4([Tt(),Rx(0,ge(ci)),Rx(0,Di(Rm)),T4("design:paramtypes",[Object])],__);var Ua;(function(n){n[n.estimate=0]="estimate",n[n.actualBounding=1]="actualBounding",n[n.fontBounding=2]="fontBounding"})(Ua||(Ua={}));var Wr;(function(n){n[n.INITIAL=0]="INITIAL",n[n.RUNNING=1]="RUNNING",n[n.PAUSE=2]="PAUSE"})(Wr||(Wr={}));var Hh;(function(n){n.wait="wait",n.from="from",n.to="to",n.customAnimate="customAnimate"})(Hh||(Hh={}));var fr;(function(n){n[n.INITIAL=0]="INITIAL",n[n.RUNNING=1]="RUNNING",n[n.PAUSED=2]="PAUSED",n[n.END=3]="END"})(fr||(fr={}));var J0={exports:{}},Ex;function R4(){return Ex||(Ex=1,function(n){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function o(l,u,h,d,c){if(typeof h!="function")throw new TypeError("The listener must be a function");var f=new r(h,d||l,c),g=e?e+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],f]:l._events[g].push(f):(l._events[g]=f,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)t.call(h,d)&&u.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},a.prototype.listeners=function(u){var h=e?e+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var c=0,f=d.length,g=new Array(f);c<f;c++)g[c]=d[c].fn;return g},a.prototype.listenerCount=function(u){var h=e?e+u:u,d=this._events[h];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,h,d,c,f,g){var m=e?e+u:u;if(!this._events[m])return!1;var p=this._events[m],v=arguments.length,b,C;if(p.fn){switch(p.once&&this.removeListener(u,p.fn,void 0,!0),v){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,h),!0;case 3:return p.fn.call(p.context,h,d),!0;case 4:return p.fn.call(p.context,h,d,c),!0;case 5:return p.fn.call(p.context,h,d,c,f),!0;case 6:return p.fn.call(p.context,h,d,c,f,g),!0}for(C=1,b=new Array(v-1);C<v;C++)b[C-1]=arguments[C];p.fn.apply(p.context,b)}else{var y=p.length,w;for(C=0;C<y;C++)switch(p[C].once&&this.removeListener(u,p[C].fn,void 0,!0),v){case 1:p[C].fn.call(p[C].context);break;case 2:p[C].fn.call(p[C].context,h);break;case 3:p[C].fn.call(p[C].context,h,d);break;case 4:p[C].fn.call(p[C].context,h,d,c);break;default:if(!b)for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];p[C].fn.apply(p[C].context,b)}}return!0},a.prototype.on=function(u,h,d){return o(this,u,h,d,!1)},a.prototype.once=function(u,h,d){return o(this,u,h,d,!0)},a.prototype.removeListener=function(u,h,d,c){var f=e?e+u:u;if(!this._events[f])return this;if(!h)return s(this,f),this;var g=this._events[f];if(g.fn)g.fn===h&&(!c||g.once)&&(!d||g.context===d)&&s(this,f);else{for(var m=0,p=[],v=g.length;m<v;m++)(g[m].fn!==h||c&&!g[m].once||d&&g[m].context!==d)&&p.push(g[m]);p.length?this._events[f]=p.length===1?p[0]:p:s(this,f)}return this},a.prototype.removeAllListeners=function(u){var h;return u?(h=e?e+u:u,this._events[h]&&s(this,h)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,n.exports=a}(J0)),J0.exports}var E4=R4();const ol=no(E4),Fu=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,cs=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||Fu(n,"Boolean"),Ce=n=>typeof n=="function",zt=n=>n==null,Et=n=>n!=null,$i=n=>{const t=typeof n;return n!==null&&t==="object"||t==="function"},M4=n=>typeof n=="object"&&n!==null,jl=function(n){if(!M4(n)||!Fu(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},oi=n=>n===void 0,lr=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||Fu(n,"String")},jt=n=>Array.isArray?Array.isArray(n):Fu(n,"Array"),lw=function(n){return n!==null&&typeof n!="function"&&Number.isFinite(n.length)},B4=n=>Fu(n,"Date"),ne=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||Fu(n,"Number")},Ne=n=>ne(n)&&Number.isFinite(n),P4=n=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(n),k4=n=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(n),L4=n=>({}).toString.call(n).replace(/^\[object /,"").replace(/]$/,""),D4=Object.prototype,I4=function(n){const t=n&&n.constructor;return n===(typeof t=="function"&&t.prototype||D4)},F4=Object.prototype.hasOwnProperty;function We(n){if(zt(n))return!0;if(lw(n))return!n.length;const t=L4(n);if(t==="Map"||t==="Set")return!n.size;if(I4(n))return!Object.keys(n).length;for(const e in n)if(F4.call(n,e))return!1;return!0}const Rr=(n,t,e)=>{const i=lr(t)?t.split("."):t;for(let r=0;r<i.length;r++)n=n?n[i[r]]:void 0;return n===void 0?e:n},O4=Object.prototype.hasOwnProperty,H4=(n,t)=>n!=null&&O4.call(n,t);function Mk(n,t,e){let i;if(!Et(n)||typeof n!="object"||t)return n;const r=jt(n),o=n.length;i=r?new Array(o):typeof n=="object"?{}:cs(n)||ne(n)||lr(n)?n:B4(n)?new Date(+n):void 0;const s=r?void 0:Object.keys(Object(n));let a=-1;if(i)for(;++a<(s||n).length;){const l=s?s[a]:a,u=n[l];i[l]=Mk(u,t)}return i}function Bk(n,t,e=!1,i=!1){if(t){if(n===t)return;if(Et(t)&&typeof t=="object"){const r=Object(t),o=[];for(const l in r)o.push(l);let{length:s}=o,a=-1;for(;s--;){const l=o[++a];!Et(r[l])||typeof r[l]!="object"||i&&jt(n[l])?Pk(n,l,r[l]):z4(n,t,l,e,i)}}}}function z4(n,t,e,i=!1,r=!1){const o=n[e],s=t[e];let a=t[e],l=!0;if(jt(s)){if(i)a=[];else if(jt(o))a=o;else if(lw(o)){a=new Array(o.length);let u=-1;const h=o.length;for(;++u<h;)a[u]=o[u]}}else jl(s)?(a=o??{},typeof o!="function"&&typeof o=="object"||(a={})):l=!1;l&&Bk(a,s,i,r),Pk(n,e,a)}function Pk(n,t,e){(e!==void 0&&!N4(n[t],e)||e===void 0&&!(t in n))&&(n[t]=e)}function N4(n,t){return n===t||Number.isNaN(n)&&Number.isNaN(t)}function Jt(n,...t){let e=-1;const i=t.length;for(;++e<i;)Bk(n,t[e],!0);return n}function Mx(n){return Object.prototype.toString.call(n)}function Bx(n){return Object.keys(n)}function C_(n,t,e){if(n===t)return!0;if(typeof n!=typeof t||n==null||t==null)return!1;if(Number.isNaN(n)&&Number.isNaN(t))return!0;if(Mx(n)!==Mx(t)||Ce(n)||typeof n!="object")return!1;if(jt(n)){if(n.length!==t.length)return!1;for(let o=n.length-1;o>=0;o--)if(!C_(n[o],t[o]))return!1;return!0}if(!jl(n))return!1;const i=Bx(n),r=Bx(t);if(i.length!==r.length)return!1;i.sort(),r.sort();for(let o=i.length-1;o>=0;o--)if(i[o]!=r[o])return!1;for(let o=i.length-1;o>=0;o--){const s=i[o];if(!C_(n[s],t[s]))return!1}return!0}function W4(n){if(!n)return[];if(Object.keys)return Object.keys(n);const t=[];for(const e in n)n.hasOwnProperty(e)&&t.push(e);return t}function U4(n,t,e){const i=W4(t);for(let r=0;r<i.length;r++){const o=i[r];(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}return n}function y_(n,t,e=!0){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){const i=Object.getOwnPropertyNames(t);for(let r=0;r<i.length;r++){const o=i[r];o!=="constructor"&&(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}}else U4(n,t,e)}function sg(n){return Et(n)?jt(n)?n:[n]:[]}function Ll(n){if(lw(n))return n[n.length-1]}const kk=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)>0&&(i=o)}return i},uw=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)<0&&(i=o)}return i};function Oc(n,t){if(!jt(n)||!jt(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function w_(n){if(!jt(n))return[n];const t=[];for(const e of n)t.push(...w_(e));return t}function V4(n,t,e){Et(t)||(t=n,n=0),Et(e)||(e=1);let i=-1;const r=0|Math.max(0,Math.ceil((t-n)/e)),o=new Array(r);for(;++i<r;)o[i]=n+i*e;return o}function j4(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function G4(n){return Number(n)}const $4=typeof console<"u";function Hc(n,t,e){const i=[t].concat([].slice.call(e));$4&&console[n].apply(console,i)}var Wn;(function(n){n[n.None=0]="None",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug"})(Wn||(Wn={}));let Er=class Jr{static getInstance(t,e){return Jr._instance&&ne(t)?Jr._instance.level(t):Jr._instance||(Jr._instance=new Jr(t,e)),Jr._instance}static setInstance(t){return Jr._instance=t}static setInstanceLevel(t){Jr._instance?Jr._instance.level(t):Jr._instance=new Jr(t)}static clearInstance(){Jr._instance=null}constructor(t=Wn.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){const e=this._onErrorHandler.findIndex(i=>i===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=Wn.Info}canLogDebug(){return this._level>=Wn.Debug}canLogError(){return this._level>=Wn.Error}canLogWarn(){return this._level>=Wn.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=Wn.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):Hc((e=this._method)!==null&&e!==void 0?e:"error","ERROR",t)),this}warn(...t){return this._level>=Wn.Warn&&Hc(this._method||"warn","WARN",t),this}info(...t){return this._level>=Wn.Info&&Hc(this._method||"log","INFO",t),this}debug(...t){return this._level>=Wn.Debug&&Hc(this._method||"log","DEBUG",t),this}};Er._instance=null;function q4(n,t,e=0,i){for(zt(i)&&(i=n.length);e<i;){const r=e+i>>>1;j4(n[r],t)>0?i=r:e=r+1}return e}const X4=(n,t,e)=>{let i=n,r=t;for(;i<r;){const o=Math.floor((i+r)/2);e(o)>=0?r=o:i=o+1}return i},Y4=1e-10,K4=1e-10;function Xn(n,t,e=K4,i=Y4){const r=i,o=e*Math.max(n,t);return Math.abs(n-t)<=Math.max(r,o)}const Lk=n=>{let t=null,e=null;return(...i)=>(t&&i.every((r,o)=>r===t[o])||(t=i,e=n(...i)),e)},nn=function(n,t,e){return n<t?t:n>e?e:n},pa=(n,t,e)=>{let[i,r]=n;r<i&&(i=n[1],r=n[0]);const o=r-i;return o>=e-t?[t,e]:(i=Math.min(Math.max(i,t),e-o),[i,i+o])};function Z4(n,t){let e;return n>t&&(e=n,n=t,t=e),i=>Math.max(n,Math.min(t,i))}let ag=!1;try{ag=typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"}catch{ag=!1}function Dk(n,t,e){let i,r,o,s,a,l,u=0,h=!1,d=!1,c=!0;const f=!t&&t!==0&&ag;if(typeof n!="function")throw new TypeError("Expected a function");function g(y){const w=i,_=r;return i=r=void 0,u=y,s=n.apply(_,w),s}function m(y,w){return f?(cancelAnimationFrame(a),requestAnimationFrame(y)):setTimeout(y,w)}function p(y){const w=y-l;return l===void 0||w>=t||w<0||d&&y-u>=o}function v(){const y=Date.now();if(p(y))return b(y);a=m(v,function(w){const _=w-u,A=t-(w-l);return d?Math.min(A,o-_):A}(y))}function b(y){return a=void 0,c&&i?g(y):(i=r=void 0,s)}function C(...y){const w=Date.now(),_=p(w);if(i=y,r=this,l=w,_){if(a===void 0)return function(A){return u=A,a=m(v,t),h?g(A):s}(l);if(d)return a=m(v,t),g(l)}return a===void 0&&(a=m(v,t)),s}return t=+t||0,$i(e)&&(h=!!e.leading,d="maxWait"in e,d&&(o=Math.max(Ne(e.maxWait)?e.maxWait:0,t)),c="trailing"in e?!!e.trailing:c),C.cancel=function(){a!==void 0&&function(y){if(f)return cancelAnimationFrame(y);clearTimeout(y)}(a),u=0,i=l=r=a=void 0},C.flush=function(){return a===void 0?s:b(Date.now())},C.pending=function(){return a!==void 0},C}ag=!1;function Ik(n,t,e){let i=!0,r=!0;if(typeof n!="function")throw new TypeError("Expected a function");return $i(e)&&(i="leading"in e?!!e.leading:i,r="trailing"in e?!!e.trailing:r),Dk(n,t,{leading:i,trailing:r,maxWait:t})}function Af(n,t){return e=>n*(1-e)+t*e}function Q4(n,t){return function(e){return Math.round(n*(1-e)+t*e)}}function J4(n,t){const e=n.valueOf(),i=t.valueOf(),r=new Date;return o=>(r.setTime(e*(1-o)+i*o),r)}const je=1e-12,Ae=Math.PI,En=Ae/2,nr=2*Ae,Zt=2*Math.PI,Se=Math.abs,Te=Math.atan2,Ei=Math.cos,un=Math.max,ki=Math.min,ti=Math.sin,Zn=Math.sqrt,gl=Math.pow;function t6(n){return n>1?0:n<-1?Ae:Math.acos(n)}function Px(n){return n>=1?En:n<=-1?-En:Math.asin(n)}function kx(n,t,e,i,r){let o=e,s=i;return typeof n=="number"&&typeof e=="number"&&(o=(1-r)*n+r*e),typeof t=="number"&&typeof i=="number"&&(s=(1-r)*t+r*i),{x:o,y:s}}function e6(n,t){return n[0]*t[1]-n[1]*t[0]}class ze{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new ze(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return ne(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return ne(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw new Error("暂不支持")}div(t){throw new Error("暂不支持")}}class Dr{static distancePP(t,e){return Zn(gl(t.x-e.x,2)+gl(t.y-e.y,2))}static distanceNN(t,e,i,r){return Zn(gl(t-i,2)+gl(e-r,2))}static distancePN(t,e,i){return Zn(gl(e-t.x,2)+gl(i-t.y,2))}static pointAtPP(t,e,i){return new ze((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}function Ds(n){return n*(Math.PI/180)}function i6(n){return 180*n/Math.PI}const r6=(n=0)=>{if(n<0)for(;n<-nr;)n+=nr;else if(n>0)for(;n>nr;)n-=nr;return n},n6=r6;function o6(n,t,e){return t?{x:n.x+t*Math.cos(e),y:n.y+t*Math.sin(e)}:{x:n.x,y:n.y}}function Lx(n){for(;n<0;)n+=2*Math.PI;for(;n>=2*Math.PI;)n-=2*Math.PI;return n}function Fk(n,t,e){if(n===null)return t;if(t===null)return n;const{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:u,y22:h}=Ok(n,t);return i>=l||r<=a||o>=h||s<=u?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(i,a),y1:Math.max(o,u),x2:Math.min(r,l),y2:Math.min(s,h)}}var Dl;(function(n){n[n.NONE=0]="NONE",n[n.BBOX1=1]="BBOX1",n[n.BBOX2=2]="BBOX2"})(Dl||(Dl={}));const Ok=(n,t,e)=>{let i=n.x1,r=n.x2,o=n.y1,s=n.y2,a=t.x1,l=t.x2,u=t.y1,h=t.y2;return{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:u,y22:h}};function s6(n,t,e){if(!n||!t)return Dl.NONE;const{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:u,y22:h}=Ok(n,t);return i>a&&r<l&&o>u&&s<h?Dl.BBOX1:a>i&&l<r&&u>o&&h<s?Dl.BBOX2:Dl.NONE}function S_(n,t,e){return n&&t?!(n.x1>t.x2||n.x2<t.x1||n.y1>t.y2||n.y2<t.y1):!0}function tv(n,t){return Math.abs(t[0]*n[0]+t[1]*n[1])}function Ro({x:n,y:t},e,i={x:0,y:0}){return{x:(n-i.x)*Math.cos(e)-(t-i.y)*Math.sin(e)+i.x,y:(n-i.x)*Math.sin(e)+(t-i.y)*Math.cos(e)+i.y}}function x_(n){return{x:(n.x1+n.x2)/2,y:(n.y1+n.y2)/2}}function Dx(n,t){const e=t?Ds(n.angle):n.angle,i=x_(n);return[Ro({x:n.x1,y:n.y1},e,i),Ro({x:n.x2,y:n.y1},e,i),Ro({x:n.x2,y:n.y2},e,i),Ro({x:n.x1,y:n.y2},e,i)]}function Hk(n,t,e=!1){const i=Dx(n,e),r=Dx(t,e),o=(p,v)=>[v.x-p.x,v.y-p.y],s=o(x_(n),x_(t)),a=o(i[0],i[1]),l=o(i[1],i[2]),u=o(r[0],r[1]),h=o(r[1],r[2]),d=e?Ds(n.angle):n.angle;let c=e?Ds(90-n.angle):n.angle+En;const f=e?Ds(t.angle):t.angle;let g=e?Ds(90-t.angle):t.angle+En;c>Zt&&(c-=Zt),g>Zt&&(g-=Zt);const m=(p,v,b,C)=>{const y=[Math.cos(v),Math.sin(v)];return p+(tv(y,b)+tv(y,C))/2>tv(y,s)};return m((n.x2-n.x1)/2,d,u,h)&&m((n.y2-n.y1)/2,c,u,h)&&m((t.x2-t.x1)/2,f,a,l)&&m((t.y2-t.y1)/2,g,a,l)}function ua(n,t,e,i,r,o){if(o>t&&o>i||o<t&&o<i||i===t)return 0;const s=(o-t)/(i-t);let a=i<t?1:-1;s!==1&&s!==0||(a=i<t?.5:-.5);const l=s*(e-n)+n;return l===r?1/0:l>r?a:0}const Ix=n=>{let t=n.charCodeAt(0),e=n.length===2?n.charCodeAt(1):0,i=t;return 55296<=t&&t<=56319&&56320<=e&&e<=57343&&(t&=1023,e&=1023,i=t<<10|e,i+=65536),i===12288||65281<=i&&i<=65376||65504<=i&&i<=65510?"F":i===8361||65377<=i&&i<=65470||65474<=i&&i<=65479||65482<=i&&i<=65487||65490<=i&&i<=65495||65498<=i&&i<=65500||65512<=i&&i<=65518?"H":4352<=i&&i<=4447||4515<=i&&i<=4519||4602<=i&&i<=4607||9001<=i&&i<=9002||11904<=i&&i<=11929||11931<=i&&i<=12019||12032<=i&&i<=12245||12272<=i&&i<=12283||12289<=i&&i<=12350||12353<=i&&i<=12438||12441<=i&&i<=12543||12549<=i&&i<=12589||12593<=i&&i<=12686||12688<=i&&i<=12730||12736<=i&&i<=12771||12784<=i&&i<=12830||12832<=i&&i<=12871||12880<=i&&i<=13054||13056<=i&&i<=19903||19968<=i&&i<=42124||42128<=i&&i<=42182||43360<=i&&i<=43388||44032<=i&&i<=55203||55216<=i&&i<=55238||55243<=i&&i<=55291||63744<=i&&i<=64255||65040<=i&&i<=65049||65072<=i&&i<=65106||65108<=i&&i<=65126||65128<=i&&i<=65131||110592<=i&&i<=110593||127488<=i&&i<=127490||127504<=i&&i<=127546||127552<=i&&i<=127560||127568<=i&&i<=127569||131072<=i&&i<=194367||177984<=i&&i<=196605||196608<=i&&i<=262141?"W":32<=i&&i<=126||162<=i&&i<=163||165<=i&&i<=166||i===172||i===175||10214<=i&&i<=10221||10629<=i&&i<=10630?"Na":i===161||i===164||167<=i&&i<=168||i===170||173<=i&&i<=174||176<=i&&i<=180||182<=i&&i<=186||188<=i&&i<=191||i===198||i===208||215<=i&&i<=216||222<=i&&i<=225||i===230||232<=i&&i<=234||236<=i&&i<=237||i===240||242<=i&&i<=243||247<=i&&i<=250||i===252||i===254||i===257||i===273||i===275||i===283||294<=i&&i<=295||i===299||305<=i&&i<=307||i===312||319<=i&&i<=322||i===324||328<=i&&i<=331||i===333||338<=i&&i<=339||358<=i&&i<=359||i===363||i===462||i===464||i===466||i===468||i===470||i===472||i===474||i===476||i===593||i===609||i===708||i===711||713<=i&&i<=715||i===717||i===720||728<=i&&i<=731||i===733||i===735||768<=i&&i<=879||913<=i&&i<=929||931<=i&&i<=937||945<=i&&i<=961||963<=i&&i<=969||i===1025||1040<=i&&i<=1103||i===1105||i===8208||8211<=i&&i<=8214||8216<=i&&i<=8217||8220<=i&&i<=8221||8224<=i&&i<=8226||8228<=i&&i<=8231||i===8240||8242<=i&&i<=8243||i===8245||i===8251||i===8254||i===8308||i===8319||8321<=i&&i<=8324||i===8364||i===8451||i===8453||i===8457||i===8467||i===8470||8481<=i&&i<=8482||i===8486||i===8491||8531<=i&&i<=8532||8539<=i&&i<=8542||8544<=i&&i<=8555||8560<=i&&i<=8569||i===8585||8592<=i&&i<=8601||8632<=i&&i<=8633||i===8658||i===8660||i===8679||i===8704||8706<=i&&i<=8707||8711<=i&&i<=8712||i===8715||i===8719||i===8721||i===8725||i===8730||8733<=i&&i<=8736||i===8739||i===8741||8743<=i&&i<=8748||i===8750||8756<=i&&i<=8759||8764<=i&&i<=8765||i===8776||i===8780||i===8786||8800<=i&&i<=8801||8804<=i&&i<=8807||8810<=i&&i<=8811||8814<=i&&i<=8815||8834<=i&&i<=8835||8838<=i&&i<=8839||i===8853||i===8857||i===8869||i===8895||i===8978||9312<=i&&i<=9449||9451<=i&&i<=9547||9552<=i&&i<=9587||9600<=i&&i<=9615||9618<=i&&i<=9621||9632<=i&&i<=9633||9635<=i&&i<=9641||9650<=i&&i<=9651||9654<=i&&i<=9655||9660<=i&&i<=9661||9664<=i&&i<=9665||9670<=i&&i<=9672||i===9675||9678<=i&&i<=9681||9698<=i&&i<=9701||i===9711||9733<=i&&i<=9734||i===9737||9742<=i&&i<=9743||9748<=i&&i<=9749||i===9756||i===9758||i===9792||i===9794||9824<=i&&i<=9825||9827<=i&&i<=9829||9831<=i&&i<=9834||9836<=i&&i<=9837||i===9839||9886<=i&&i<=9887||9918<=i&&i<=9919||9924<=i&&i<=9933||9935<=i&&i<=9953||i===9955||9960<=i&&i<=9983||i===10045||i===10071||10102<=i&&i<=10111||11093<=i&&i<=11097||12872<=i&&i<=12879||57344<=i&&i<=63743||65024<=i&&i<=65039||i===65533||127232<=i&&i<=127242||127248<=i&&i<=127277||127280<=i&&i<=127337||127344<=i&&i<=127386||917760<=i&&i<=917999||983040<=i&&i<=1048573||1048576<=i&&i<=1114109?"A":"N"};function lg(n,t={},e){e||(e=1);const{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=t.fontWeight,fontSize:s=t.fontSize,fontFamily:a=t.fontFamily}=n;return(i?i+" ":"")+(r?r+" ":"")+(o?o+" ":"")+s*e+"px "+(a||"sans-serif")}let ss=class ma{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'"~`,this._option=t,this._userSpec=e??{},this.textSpec=this._initSpec(),Et(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=Et(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(zt(this._canvas)&&(Et(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),zt(this._canvas)&&typeof window<"u"&&window.document!==void 0&&globalThis&&Et(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),zt(this._context)&&Et(this._canvas)){const t=this._canvas.getContext("2d");Et(t)&&(t.save(),t.font=lg(this.textSpec),this._contextSaved=!0,this._context=t)}return!zt(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;const{defaultFontParams:r={}}=this._option,{fontStyle:o=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:a=(t=r.fontWeight)!==null&&t!==void 0?t:"normal",fontSize:l=(e=r.fontSize)!==null&&e!==void 0?e:12,fontFamily:u=(i=r.fontFamily)!==null&&i!==void 0?i:"sans-serif",align:h,textAlign:d=h??"center",baseline:c,textBaseline:f=c??"middle",ellipsis:g,limit:m}=this._userSpec;let{lineHeight:p=l}=this._userSpec;if(lr(p)&&p[p.length-1]==="%"){const v=Number.parseFloat(p.substring(0,p.length-1))/100;p=l*v}return{fontStyle:o,fontVariant:s,fontFamily:u,fontSize:l,fontWeight:a,textAlign:d,textBaseline:f,ellipsis:g,limit:m,lineHeight:p}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){if(zt(t))return{width:0,height:0};if(zt(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);const{fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:a,limit:l,lineHeight:u}=this.textSpec;let h;try{const d=this._option.getTextBounds({text:t,fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:!!a,maxLineWidth:l||1/0,lineHeight:u});h={width:d.width(),height:d.height()}}catch{this._notSupportVRender=!0,h=this.measureWithNaiveCanvas(t)}return h}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);const i=this._context.measureText(t),{fontSize:r,lineHeight:o}=this.textSpec;return{width:i.width,height:(e=o)!==null&&e!==void 0?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){const e={width:0,height:0};for(let i=0;i<t.length;i++){const r=t[i];let o=this._measureSpecialChar(r);zt(o)&&ma.NUMBERS_CHAR_SET.includes(r)&&(o=this._measureNumberChar()),zt(o)&&["F","W"].includes(Ix(r))&&(o=this._measureFullSizeChar()),zt(o)&&(o=this._measureLetterChar()),e.width+=o.width,e.height=Math.max(e.height,o.height),!zt(o.fontBoundingBoxAscent)&&(e.fontBoundingBoxAscent=o.fontBoundingBoxAscent),!zt(o.fontBoundingBoxDescent)&&(e.fontBoundingBoxDescent=o.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){var e;const i={width:0,height:0},{fontSize:r,lineHeight:o}=this.textSpec;for(let s=0;s<t.length;s++){const a=t[s],l=["F","W"].includes(Ix(a))?1:.53;i.width+=l*r}return i.height=(e=o)!==null&&e!==void 0?e:r,i}_measureReduce(t,e){var i;const{fontSize:r,lineHeight:o}=this.textSpec,s={width:0,height:0};if(zt(t))return s;if(jt(t)){const a=t.filter(Et).map(l=>l.toString());return a.length===0?s:a.length===1?e(a[0]):{width:a.reduce((l,u)=>Math.max(l,e(u).width),0),height:a.length*(((i=o)!==null&&i!==void 0?i:r)+1)+1}}return e(t.toString())}_measureNumberChar(){if(zt(this._numberCharSize)){const t=this._standardMethod(ma.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/ma.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return zt(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(ma.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(zt(this._letterCharSize)){const t=this._standardMethod(ma.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/ma.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return Et(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){Et(this._canvas)&&(this._canvas=null),Et(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}};ss.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",ss.NUMBERS_CHAR_SET="0123456789",ss.FULL_SIZE_CHAR="字";const Fx=(n,t)=>Math.max(t.x1-n.x2,n.x1-t.x2,t.y1-n.y2,n.y1-t.y2),a6=(n,t)=>{const e=[{x:Math.cos(n.angle),y:Math.sin(n.angle)},{x:-Math.sin(n.angle),y:Math.cos(n.angle)},{x:Math.cos(t.angle),y:Math.sin(n.angle)},{x:-Math.sin(t.angle),y:Math.cos(n.angle)}];function i(o,s,a){const l=o.getRotatedCorners().map(u=>u.x*s+u.y*a);return{min:Math.min(...l),max:Math.max(...l)}}let r=0;for(const o of e){const s=i(n,o.x,o.y),a=i(t,o.x,o.y);let l;l=s.max<a.min?a.min-s.max:a.max<s.min?s.min-a.max:0,r=Math.max(r,l)}return r};function hw(n,t,e){const{x1:i,y1:r,x2:o,y2:s}=t;return e.onlyTranslate()?(n!==t&&n.setValue(t.x1,t.y1,t.x2,t.y2),n.translate(e.e,e.f),t):(n.clear(),n.add(e.a*i+e.c*r+e.e,e.b*i+e.d*r+e.f),n.add(e.a*o+e.c*r+e.e,e.b*o+e.d*r+e.f),n.add(e.a*o+e.c*s+e.e,e.b*o+e.d*s+e.f),n.add(e.a*i+e.c*s+e.e,e.b*i+e.d*s+e.f),t)}let pu=class zk{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new zk(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return jt(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){const r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){const o=this.scalePoints(t,e,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return hw(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){const{x1:r,y1:o,x2:s,y2:a}=this,l=Math.cos(t),u=Math.sin(t),h=e-e*l+i*u,d=i-e*u-i*l;return[l*r-u*o+h,u*r+l*o+d,l*r-u*a+h,u*r+l*a+d,l*s-u*o+h,u*s+l*o+d,l*s-u*a+h,u*s+l*a+d]}scalePoints(t,e,i,r){const{x1:o,y1:s,x2:a,y2:l}=this;return[t*o+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}},Ye=class extends pu{};class dw extends pu{constructor(t,e=0){var i;super(t),t&&(this.angle=(i=t.angle)!==null&&i!==void 0?i:e)}intersects(t){return Hk(this,t)}setValue(t=0,e=0,i=0,r=0,o=0){return super.setValue(t,e,i,r),this.angle=o,this}clone(){return new dw(this)}getRotatedCorners(){const t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[Ro({x:this.x1,y:this.y1},this.angle,t),Ro({x:this.x2,y:this.y1},this.angle,t),Ro({x:this.x1,y:this.y2},this.angle,t),Ro({x:this.x2,y:this.y2},this.angle,t)]}}class Xe{constructor(t=1,e=0,i=0,r=1,o=0,s=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=o,this.f=s}equalToMatrix(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}equalTo(t,e,i,r,o,s){return!(this.e!==o||this.f!==s||this.a!==t||this.d!==r||this.b!==e||this.c!==i)}setValue(t,e,i,r,o,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=o,this.f=s,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){const t=this.a,e=this.b,i=this.c,r=this.d,o=this.e,s=this.f,a=new Xe,l=t*r-e*i;return a.a=r/l,a.b=-e/l,a.c=-i/l,a.d=t/l,a.e=(i*s-r*o)/l,a.f=-(t*s-e*o)/l,a}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,o=this.b*e+this.d*i,s=this.a*-i+this.c*e,a=this.b*-i+this.d*e;return this.a=r,this.b=o,this.c=s,this.d=a,this}rotateByCenter(t,e,i){const r=Math.cos(t),o=Math.sin(t),s=(1-r)*e+o*i,a=(1-r)*i-o*e,l=r*this.a-o*this.b,u=o*this.a+r*this.b,h=r*this.c-o*this.d,d=o*this.c+r*this.d,c=r*this.e-o*this.f+s,f=o*this.e+r*this.f+a;return this.a=l,this.b=u,this.c=h,this.d=d,this.e=c,this.f=f,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,o,s){return this.multiply(t,e,i,r,o,s),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){const{a:t,b:e,c:i,d:r,e:o,f:s}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=s,this.f=o,this}multiply(t,e,i,r,o,s){const a=this.a,l=this.b,u=this.c,h=this.d,d=a*t+u*e,c=l*t+h*e,f=a*i+u*r,g=l*i+h*r,m=a*o+u*s+this.e,p=l*o+h*s+this.f;return this.a=d,this.b=c,this.c=f,this.d=g,this.e=m,this.f=p,this}interpolate(t,e){const i=new Xe;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){const{a:i,b:r,c:o,d:s,e:a,f:l}=this,u=i*s-r*o,h=s/u,d=-r/u,c=-o/u,f=i/u,g=(o*l-s*a)/u,m=-(i*l-r*a)/u,{x:p,y:v}=t;e.x=p*h+v*c+g,e.y=p*d+v*f+m}onlyTranslate(t=1){return this.a===t&&this.b===0&&this.c===0&&this.d===t}clone(){return new Xe(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){const t=this.a,e=this.b,i=this.c,r=this.d,o=t*r-e*i,s={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!==0||e!==0){const a=Math.sqrt(t*t+e*e);s.rotateDeg=e>0?Math.acos(t/a):-Math.acos(t/a),s.scaleX=a,s.scaleY=o/a,s.skewX=(t*i+e*r)/o,s.skewY=0}else if(i!==0||r!==0){const a=Math.sqrt(i*i+r*r);s.rotateDeg=Math.PI/2-(r>0?Math.acos(-i/a):-Math.acos(i/a)),s.scaleX=o/a,s.scaleY=a,s.skewX=0,s.skewY=(t*i+e*r)/o}return s.rotateDeg=i6(s.rotateDeg),s}}function l6(n,t,e,i,r,o,s,a){const l=t.a,u=t.b,h=t.c,d=t.d,c=t.e,f=t.f,g=Ei(s),m=ti(s);let p,v;a?(p=a[0],v=a[1]):(p=e,v=i);const b=p-e,C=v-i,y=l*g+h*m,w=u*g+d*m,_=h*g-l*m,A=d*g-u*m;n.a=r*y,n.b=r*w,n.c=o*_,n.d=o*A,n.e=c+l*p+h*v-y*b-_*C,n.f=f+u*p+d*v-w*b-A*C}class u6{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(t,e){const{CLEAN_THRESHOLD:i=this.CLEAN_THRESHOLD,L_TIME:r=this.L_TIME,R_COUNT:o=this.R_COUNT}=e;if(t.size<i)return 0;let s=0;const a=u=>{s++,t.delete(u)},l=Date.now();return t.forEach((u,h)=>{if(u.timestamp.length<o)return a(h);let d=0;for(;l-u.timestamp[u.timestamp.length-1-d]<r&&(d++,!(d>=o)););if(d<o)return a(h);for(;l-u.timestamp[0]>r;)u.timestamp.shift()}),s}addLimitedTimestamp(t,e,i){const{R_TIMESTAMP_MAX_SIZE:r=this.R_TIMESTAMP_MAX_SIZE}=i;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}clearTimeStamp(t,e){const{L_TIME:i=this.L_TIME}=e,r=Date.now();t.forEach(o=>{for(;r-o.timestamp[0]>i;)o.timestamp.shift()})}clearItemTimestamp(t,e){const{L_TIME:i=this.L_TIME}=e,r=Date.now();for(;r-t.timestamp[0]>i;)t.timestamp.shift()}}function T_(n,t,e){t/=100,e/=100;const i=(1-Math.abs(2*e-1))*t,r=i*(1-Math.abs(n/60%2-1)),o=e-i/2;let s=0,a=0,l=0;return 0<=n&&n<60?(s=i,a=r,l=0):60<=n&&n<120?(s=r,a=i,l=0):120<=n&&n<180?(s=0,a=i,l=r):180<=n&&n<240?(s=0,a=r,l=i):240<=n&&n<300?(s=r,a=0,l=i):300<=n&&n<360&&(s=i,a=0,l=r),s=Math.round(255*(s+o)),a=Math.round(255*(a+o)),l=Math.round(255*(l+o)),{r:s,g:a,b:l}}function cw(n,t,e){n/=255,t/=255,e/=255;const i=Math.min(n,t,e),r=Math.max(n,t,e),o=r-i;let s=0,a=0,l=0;return s=o===0?0:r===n?(t-e)/o%6:r===t?(e-n)/o+2:(n-t)/o+4,s=Math.round(60*s),s<0&&(s+=360),l=(r+i)/2,a=o===0?0:o/(1-Math.abs(2*l-1)),a=+(100*a).toFixed(1),l=+(100*l).toFixed(1),{h:s,s:a,l}}const h6=/^#([0-9a-f]{3,8})$/,Ox={transparent:4294967040},Rf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zc(n){return((n=Math.max(0,Math.min(255,Math.round(n)||0)))<16?"0":"")+n.toString(16)}function Nk(n){return ne(n)?new Fr(n>>16,n>>8&255,255&n,1):jt(n)?new Fr(n[0],n[1],n[2]):new Fr(255,255,255)}function d6(n){return ne(n)?new Fr(n>>>24,n>>>16&255,n>>>8&255,255&n):jt(n)?new Fr(n[0],n[1],n[2],n[3]):new Fr(255,255,255,1)}function ev(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function iv(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const Hx=(n,t)=>{const e=h6.exec(n);if(t||e){const i=parseInt(e[1],16),r=e[1].length;return r===3?new Fr((i>>8&15)+((i>>8&15)<<4),(i>>4&15)+((i>>4&15)<<4),(15&i)+((15&i)<<4),1):r===6?Nk(i):r===8?new Fr(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):null}};let Gl=class va{static Brighter(t,e=1){return e===1?t:new va(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return e===1?t:new va(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){const i=t instanceof va?t:new va(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if(Et(Ox[t]))return d6(Ox[t]);if(Et(Rf[t]))return Nk(Rf[t]);const e=`${t}`.trim().toLowerCase(),i=Hx(e);if(i!==void 0)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){const r=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Fr(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseFloat(r[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){const r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),o=T_(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new Fr(o.r,o.g,o.b,parseFloat(r[3]))}}constructor(t){const e=va.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new Fr(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){const{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){const r=this.color.opacity,o=cw(this.color.r,this.color.g,this.color.b),s=T_(zt(t)?o.h:nn(t,0,360),zt(e)?o.s:e>=0&&e<=1?100*e:e,zt(i)?o.l:i<=1&&i>=0?100*i:i);return this.color=new Fr(s.r,s.g,s.b,r),this}setRGB(t,e,i){return!zt(t)&&(this.color.r=t),!zt(e)&&(this.color.g=e),!zt(i)&&(this.color.b=i),this}setHex(t){const e=`${t}`.trim().toLowerCase(),i=Hx(e,!0);return i??this}setColorName(t){const e=Rf[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){const t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;let r,o,s;return r=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),o=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),s=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),.2126*r+.7152*o+.0722*s}clone(){return new va(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=ev(t.color.r),this.color.g=ev(t.color.g),this.color.b=ev(t.color.b),this}copyLinearToSRGB(t){return this.color.r=iv(t.color.r),this.color.g=iv(t.color.g),this.color.b=iv(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}},Fr=class{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),Et(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${zc(this.r)+zc(this.g)+zc(this.b)+(this.opacity===1?"":zc(255*this.opacity))}`}formatRgb(){const t=this.opacity;return`${t===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${t===1?")":`,${t})`}`}formatHsl(){const t=this.opacity,{h:e,s:i,l:r}=cw(this.r,this.g,this.b);return`${t===1?"hsl(":"hsla("}${e},${i}%,${r}%${t===1?")":`,${t})`}`}toString(){return this.formatHex()}};function c6(n){let t="",e="",i="";const r=n[0]==="#"?1:0;for(let o=r;o<n.length;o++)n[o]!=="#"&&(o<r+2?t+=n[o]:o<r+4?e+=n[o]:o<r+6&&(i+=n[o]));return[parseInt(t,16),parseInt(e,16),parseInt(i,16)]}function f6(n,t,e){return Number((1<<24)+(n<<16)+(t<<8)+e).toString(16).slice(1)}function g6(n,t){const e=n.r,i=t.r,r=n.g,o=t.g,s=n.b,a=t.b,l=n.opacity,u=t.opacity;return h=>{const d=Math.round(e*(1-h)+i*h),c=Math.round(r*(1-h)+o*h),f=Math.round(s*(1-h)+a*h);return new Fr(d,c,f,l*(1-h)+u*h)}}const p6=Object.freeze(Object.defineProperty({__proto__:null,Color:Gl,DEFAULT_COLORS:Rf,RGB:Fr,hexToRgb:c6,hslToRgb:T_,interpolateRgb:g6,rgbToHex:f6,rgbToHsl:cw},Symbol.toStringTag,{value:"Module"}));function Bo(n){if(Ne(n))return[n,n,n,n];if(jt(n)){const t=n.length;if(t===1){const e=n[0];return[e,e,e,e]}if(t===2){const[e,i]=n;return[e,i,e,i]}if(t===3){const[e,i,r]=n;return[e,i,r,i]}if(t===4)return n}if($i(n)){const{top:t=0,right:e=0,bottom:i=0,left:r=0}=n;return[t,e,i,r]}return[0,0,0,0]}const m6=nr-1e-8;class fw{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,i,r,o,s){if(Math.abs(o-r)>m6)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);let a,l,u,h,d=1/0,c=-1/0,f=1/0,g=-1/0;function m(p){u=i*Math.cos(p),h=i*Math.sin(p),u<d&&(d=u),u>c&&(c=u),h<f&&(f=h),h>g&&(g=h)}if(m(r),m(o),o!==r)if((r%=nr)<0&&(r+=nr),(o%=nr)<0&&(o+=nr),o<r&&(s=!s,a=r,r=o,o=a),s)for(o-=nr,a=r-r%En,l=0;l<4&&a>o;++l,a-=En)m(a);else for(a=r-r%En+En,l=0;l<4&&a<o;++l,a+=En)m(a);this.bounds.add(t+d,e+f),this.bounds.add(t+c,e+g)}arcTo(t,e,i,r,o){this.bounds.add(t,e)}bezierCurveTo(t,e,i,r,o,s){this.bounds.add(t,e),this.bounds.add(i,r),this.bounds.add(o,s)}closePath(){}ellipse(){throw new Error("不支持ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,i,r){this.bounds.add(t,e),this.bounds.add(i,r)}rect(t,e,i,r){this.bounds.add(t,e),this.bounds.add(t+i,e+r)}clear(){this.bounds.clear()}release(...t){}}class v6{constructor(){this._curves=[],this.bounds=new Ye}get curves(){return this._curves}getCurveLengths(){return this._curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}const b6=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,_6={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},pe={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};let rv,zx,Nc,Nx,nv,Wc;function C6(n){if(!n)return[];const t=n.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(t===null)return[];let e,i;const r=[];for(let o=0,s=t.length;o<s;o++)if(rv=t[o],zx=rv.slice(1),Nc=rv[0],e=[Nc],i=zx.match(b6),i!==null){for(let a=0,l=i.length;a<l;a++)Nx=i[a],nv=parseFloat(Nx),Number.isNaN(nv)||e.push(nv);if(Wc=_6[Nc],e.length-1>Wc){let a,l=Nc;for(let u=1,h=e.length;u<h;u+=Wc){a=[l];for(let d=u,c=u+Wc;d<c;d++)a.push(e[d]);r.push(a),l==="m"?l="l":l==="M"&&(l="L")}}else r.push(e)}else r.push(e);return r}var He;(function(n){n[n.NONE=0]="NONE",n[n.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",n[n.UPDATE_SHAPE=2]="UPDATE_SHAPE",n[n.CLEAR_SHAPE=253]="CLEAR_SHAPE",n[n.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",n[n.INIT=179]="INIT",n[n.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",n[n.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",n[n.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",n[n.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",n[n.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",n[n.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",n[n.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",n[n.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"})(He||(He={}));var ud;(function(n){n[n.GLOBAL=1]="GLOBAL",n[n.LOCAL=16]="LOCAL",n[n.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",n[n.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"})(ud||(ud={}));var Tr;(function(n){n[n.INIT=0]="INIT",n[n.DEFAULT=1]="DEFAULT",n[n.STATE=2]="STATE",n[n.ANIMATE_BIND=10]="ANIMATE_BIND",n[n.ANIMATE_PLAY=11]="ANIMATE_PLAY",n[n.ANIMATE_START=12]="ANIMATE_START",n[n.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",n[n.ANIMATE_END=14]="ANIMATE_END",n[n.TRANSLATE=20]="TRANSLATE",n[n.TRANSLATE_TO=21]="TRANSLATE_TO",n[n.SCALE=22]="SCALE",n[n.SCALE_TO=23]="SCALE_TO",n[n.ROTATE=24]="ROTATE",n[n.ROTATE_TO=25]="ROTATE_TO"})(Tr||(Tr={}));var ke;(function(n){n[n.ROW=1]="ROW",n[n.COLUMN=2]="COLUMN"})(ke||(ke={}));var hd;(function(n){n[n.CubicBezierCurve=0]="CubicBezierCurve",n[n.QuadraticBezierCurve=1]="QuadraticBezierCurve",n[n.ArcCurve=2]="ArcCurve",n[n.LineCurve=3]="LineCurve",n[n.EllipseCurve=4]="EllipseCurve",n[n.MoveCurve=5]="MoveCurve"})(hd||(hd={}));var we;(function(n){n[n.beforeFillStroke=0]="beforeFillStroke",n[n.afterFillStroke=1]="afterFillStroke"})(we||(we={}));function y6(n,t,e,i,r,o,s,a,l){const u=Ds(s),h=Math.sin(u),d=Math.cos(u),c=d*(a-n)*.5+h*(l-t)*.5,f=d*(l-t)*.5-h*(a-n)*.5;let g=c*c/((e=Math.abs(e))*e)+f*f/((i=Math.abs(i))*i);g>1&&(g=Math.sqrt(g),e*=g,i*=g);const m=d/e,p=h/e,v=-h/i,b=d/i,C=m*a+p*l,y=v*a+b*l,w=m*n+p*t,_=v*n+b*t;let A=1/((w-C)*(w-C)+(_-y)*(_-y))-.25;A<0&&(A=0);let T=Math.sqrt(A);o===r&&(T=-T);const S=.5*(C+w)-T*(_-y),x=.5*(y+_)+T*(w-C),E=Math.atan2(y-x,C-S);let M=Math.atan2(_-x,w-S)-E;M<0&&o===1?M+=nr:M>0&&o===0&&(M-=nr);const L=Math.ceil(Math.abs(M/(En+.001))),I=[];for(let D=0;D<L;++D){const H=E+D*M/L,O=E+(D+1)*M/L;I[D]=[S,x,H,O,e,i,h,d]}return I}function w6(n){const t=n[0],e=n[1],i=n[2],r=n[3],o=n[4],s=n[5],a=n[6],l=n[7],u=l*o,h=-a*s,d=a*o,c=l*s,f=Math.cos(i),g=Math.sin(i),m=Math.cos(r),p=Math.sin(r),v=.5*(r-i),b=Math.sin(.5*v),C=8/3*b*b/Math.sin(v),y=t+f-C*g,w=e+g+C*f,_=t+m,A=e+p,T=_+C*p,S=A-C*m;return[u*y+h*w,d*y+c*w,u*T+h*S,d*T+c*S,u*_+h*A,d*_+c*A]}function Wx(n,t,e,i){const r=y6(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,e);for(let o=0;o<r.length;++o){const s=w6(r[o]);n.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const S6=(n,t,e,i,r,o,s,a=!1)=>{const l=2*Math.PI,u=(t%l+l)%l;let h,d=(e%l+l)%l;a?(d>=u&&(d-=l),h=d-u):(d<=u&&(d+=l),h=d-u);const c=Math.ceil(Math.abs(h)/(.5*Math.PI)),f=h/c;for(let g=0;g<c;g++){const m=u+f*g,p=u+f*(g+1),v=4/3*Math.tan(Math.abs(f)/4),b=Math.cos(m),C=Math.sin(m),y=Math.cos(p),w=Math.sin(p),_=b*o+i,A=C*s+r,T=y*o+i,S=w*s+r,x=a?-1:1,E=o*v*x,M=s*v*x;n.push(_-E*C,A+M*b,T+E*w,S-M*y,T,S)}},x6=[(n,t,e,i,r,o,s)=>t.arc(n[1]*r+e,n[2]*o+i,n[3]*(r+o)/2,n[4],n[5],n[6],s),(n,t,e,i,r,o,s)=>t.arcTo(n[1]*r+e,n[2]*o+i,n[3]*r+e,n[4]*o+i,n[5]*(r+o)/2,s),(n,t,e,i,r,o,s)=>t.bezierCurveTo(n[1]*r+e,n[2]*o+i,n[3]*r+e,n[4]*o+i,n[5]*r+e,n[6]*o+i,s),(n,t,e,i)=>t.closePath(),(n,t,e,i,r,o)=>t.ellipse(n[1]*r+e,n[2]*o+i,n[3]*r,n[4]*o,n[5],n[6],n[7],n[8]),(n,t,e,i,r,o,s)=>t.lineTo(n[1]*r+e,n[2]*o+i,s),(n,t,e,i,r,o,s)=>t.moveTo(n[1]*r+e,n[2]*o+i,s),(n,t,e,i,r,o,s)=>t.quadraticCurveTo(n[1]*r+e,n[2]*o+i,n[3]*r+e,n[4]*o+i,s),(n,t,e,i,r,o,s)=>t.rect(n[1]*r+e,n[2]*o+i,n[3]*r,n[4]*o,s)];function fs(n,t,e=0,i=0,r=1,o=1,s){for(let a=0;a<n.length;a++){const l=n[a];x6[l[0]](l,t,e,i,r,o,s)}}class gw{getLength(t){return t!=null?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}function Wk(n,t){let e=0;const i=n.length;for(let r=0;r<i;r++){const o=n[r],s=t[r],a=n[(r+1)%i],l=t[(r+1)%i];e+=Dr.distanceNN(o,s,a,l)}return e/2}function T6(n,t,e,i,r){return Wk([n.x,t.x,e.x,i.x],[n.y,t.y,e.y,i.y])}function Ux(n,t,e,i,r){const o=1-r;return o*o*o*n+3*t*r*o*o+3*e*r*r*o+i*r*r*r}function Uk(n,t,e,i,r){const o=Ux(n.x,t.x,e.x,i.x,r),s=Ux(n.y,t.y,e.y,i.y,r);return new ze(o,s)}function Vx(n,t,e,i){const r=1-i;return r*r*n+2*r*i*t+i*i*e}function Vk(n,t,e,i){const r=Vx(n.x,t.x,e.x,i),o=Vx(n.y,t.y,e.y,i);return new ze(r,o)}function A6(n,t,e,i){return Wk([n.x,t.x,e.x],[n.y,t.y,e.y])}function mu(n,t){const{p0:e,p1:i,p2:r,p3:o}=n,s=Uk(e,i,r,o,t),a=Dr.pointAtPP(e,i,t),l=Dr.pointAtPP(i,r,t),u=Dr.pointAtPP(r,o,t),h=Dr.pointAtPP(a,l,t),d=Dr.pointAtPP(l,u,t);return[new ug(e,a,h,s),new ug(s,d,u,o)]}class ug extends gw{constructor(t,e,i,r){super(),this.type=hd.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(this.defined!==!1)return Uk(this.p0,this.p1,this.p2,this.p3,t);throw new Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?T6(this.p0,this.p1,this.p2,this.p3):60}calcProjLength(t){return t===ke.ROW?Se(this.p0.x-this.p3.x):t===ke.COLUMN?Se(this.p0.y-this.p3.y):0}getAngleAt(t){const e=un(t-.01,0),i=ki(t+.01,1),r=this.getPointAt(e),o=this.getPointAt(i);return Te(o.y-r.y,o.x-r.x)}draw(t,e,i,r,o,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*o+i),s>=1)t.bezierCurveTo(this.p1.x*r+e,this.p1.y*o+i,this.p2.x*r+e,this.p2.y*o+i,this.p3.x*r+e,this.p3.y*o+i);else if(s>0){const[a]=mu(this,s);t.bezierCurveTo(a.p1.x*r+e,a.p1.y*o+i,a.p2.x*r+e,a.p2.y*o+i,a.p3.x*r+e,a.p3.y*o+i)}}includeX(t){const e=ki(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=un(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}getYAt(t){const e=ki(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/(un(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}function jx(n,t){const{p0:e,p1:i}=n,r=Dr.pointAtPP(e,i,t);return[new hg(e,r),new hg(r,i)]}class hg extends gw{constructor(t,e){super(),this.type=hd.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(this.defined!==!1)return Dr.pointAtPP(this.p0,this.p1,t);throw new Error("defined为false的点不能getPointAt")}getAngleAt(t){return this.angle==null&&(this.angle=Te(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?Dr.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===ke.ROW?Se(this.p0.x-this.p1.x):t===ke.COLUMN?Se(this.p0.y-this.p1.y):0}draw(t,e,i,r,o,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*o+i),s>=1)t.lineTo(this.p1.x*r+e,this.p1.y*o+i);else if(s>0){const a=this.getPointAt(s);t.lineTo(a.x*r+e,a.y*o+i)}}includeX(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}getYAt(t){if(this.includeX(t)){let e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);const r=(t-e.x)/(i.x-e.x);return e.y+r*(i.y-e.y)}return 1/0}}class Em{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,i,r,o,s,a,l){const u=new ug(new ze(this._lastX,this._lastY),new ze(t,e),new ze(i,r),new ze(o,s));u.originP1=this._lastOriginP,u.originP2=l,u.defined=a,this.curves.push(u),this._lastX=o,this._lastY=s,this._lastOriginP=l}closePath(){if(this.curves.length<2)return;const t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw new Error("SegContext不支持调用ellipse")}lineTo(t,e,i,r){const o=this.addLinearCurve(t,e,i,this._lastOriginP,r);this.curves.push(o),this._lastX=t,this._lastY=e,this._lastOriginP=r}moveTo(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(t,e,i,r){throw new Error("SegContext不支持调用quadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,i,r,o){const s=new hg(new ze(this._lastX,this._lastY),new ze(t,e));return s.originP1=r,s.originP2=o,s.defined=i,s}getPointAt(t){throw new Error("暂未实现")}getCurveLengths(){return[]}getLength(t){var e,i;if(t===ke.COLUMN){if(!this.curves.length)return 0;const r=this.curves[0],o=this.curves[this.curves.length-1],s=(e=o.p3)!==null&&e!==void 0?e:o.p1;return Se(r.p0.y-s.y)}if(t===ke.ROW){if(!this.curves.length)return 0;const r=this.curves[0],o=this.curves[this.curves.length-1],s=(i=o.p3)!==null&&i!==void 0?i:o.p1;return Se(r.p0.x-s.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((r,o)=>r+o.getLength(),0)),this.length}}class R6 extends Em{bezierCurveTo(t,e,i,r,o,s,a,l){return super.bezierCurveTo(e,t,r,i,s,o,a,l)}lineTo(t,e,i,r){return super.lineTo(e,t,i,r)}moveTo(t,e,i){return super.moveTo(e,t,i)}clear(){return super.clear()}}function sl(n,t,e=1){let i=!1;for(let r=0,o=t.length;r<=o;r++)r>=o===i&&((i=!i)?n.lineStart():n.lineEnd()),i&&n.point(t[r])}function Ou(n,t,e){const i=t??(Se(e[e.length-1].x-e[0].x)>Se(e[e.length-1].y-e[0].y)?ke.ROW:ke.COLUMN);return n==="monotoneY"?new R6(n,i):new Em(n,i)}class jk{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function jd(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;const r=Ou("linear",e,n);return E6(new jk(r,i),n),r}function E6(n,t){return sl(n,t,1)}function Gx(n,t,e,i,r){n.context.bezierCurveTo((2*n._x0+n._x1)/3,(2*n._y0+n._y1)/3,(n._x0+2*n._x1)/3,(n._y0+2*n._y1)/3,(n._x0+4*n._x1+t)/6,(n._y0+4*n._y1+e)/6,i,n.lastPoint1)}class M6{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){this._point===2&&Gx(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:Gx(this,e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function B6(n,t){return sl(n,t,2)}function P6(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;if(n.length<3-+!!i)return jd(n,t);const r=Ou("basis",e,n);return B6(new M6(r,i),n),r}function $x(n){return n<0?-1:1}function qx(n,t,e){const i=n._x1-n._x0,r=t-n._x1,o=(n._y1-n._y0)/(i||Number(r<0&&-0)),s=(e-n._y1)/(r||Number(i<0&&-0)),a=(o*r+s*i)/(i+r);return($x(o)+$x(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function Xx(n,t){const e=n._x1-n._x0;return e?(3*(n._y1-n._y0)/e-t)/2:t}function ov(n,t,e,i,r){const o=n._x0,s=n._y0,a=n._x1,l=n._y1,u=(a-o)/3;n.context.bezierCurveTo(o+u,s+u*t,a-u,l-u*e,a,l,i,n.lastPoint1)}class Gk{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:ov(this,this._t0,Xx(this,this._t0),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1)}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN;const i=t.x,r=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,this._lastDefined1!==!1&&this._lastDefined2!==!1,t):this.context.moveTo(i,r,t);break;case 1:this._point=2;break;case 2:this._point=3,ov(this,Xx(this,e=qx(this,i,r)),e,this._lastDefined1!==!1&&this._lastDefined2!==!1);break;default:ov(this,this._t0,e=qx(this,i,r),this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined!==!1,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class k6 extends Gk{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}function L6(n,t){return sl(n,t,2)}function D6(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;if(n.length<3-+!!i)return jd(n,t);const r=Ou("monotoneX",e,n);return L6(new Gk(r,i),n),r}function I6(n,t){return sl(n,t,2)}function F6(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;if(n.length<3-+!!i)return jd(n,t);const r=Ou("monotoneY",e,n);return I6(new k6(r,i),n),r}let $k=class{constructor(t,e=.5,i){this.context=t,this._t=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&this._point===2&&this.context.lineTo(this._x,this._y,this._lastDefined!==!1,this.lastPoint),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){const e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,this._lastDefined!==!1&&t.defined!==!1,this.lastPoint),this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t);else{const r=this._x*(1-this._t)+e*this._t;this._t===.5?this.context.lineTo(r,this._y,this._lastDefined!==!1,this.lastPoint):this.context.lineTo(r,this._y,this._lastDefined!==!1&&t.defined!==!1,this.lastPoint),this.context.lineTo(r,i,this._lastDefined!==!1&&t.defined!==!1,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}};class O6 extends $k{lineEnd(){this.context.closePath()}}function sv(n,t,e={}){const{direction:i,startPoint:r}=e;if(n.length<2-+!!r)return null;const o=new Em("step",i??(Se(n[n.length-1].x-n[0].x)>Se(n[n.length-1].y-n[0].y)?ke.ROW:ke.COLUMN));return qk(new $k(o,t,r),n),o}function qk(n,t){return sl(n,t,1)}function H6(n,t,e={}){const{direction:i,startPoint:r}=e;if(n.length<2-+!!r)return null;const o=new Em("step",i??(Se(n[n.length-1].x-n[0].x)>Se(n[n.length-1].y-n[0].y)?ke.ROW:ke.COLUMN));return qk(new O6(o,t,r),n),o}class z6 extends jk{lineEnd(){this.context.closePath()}}function N6(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;const r=Ou("linear",e,n);return W6(new z6(r,i),n),r}function W6(n,t){return sl(n,t,1)}function Xk(n,t,e,i,r){let o=n._x1,s=n._y1,a=n._x2,l=n._y2;if(n._l01_a>je){const u=2*n._l01_2a+3*n._l01_a*n._l12_a+n._l12_2a,h=3*n._l01_a*(n._l01_a+n._l12_a);o=(o*u-n._x0*n._l12_2a+n._x2*n._l01_2a)/h,s=(s*u-n._y0*n._l12_2a+n._y2*n._l01_2a)/h}if(n._l23_a>je){const u=2*n._l23_2a+3*n._l23_a*n._l12_a+n._l12_2a,h=3*n._l23_a*(n._l23_a+n._l12_a);a=(a*u+n._x1*n._l23_2a-t*n._l12_2a)/h,l=(l*u+n._y1*n._l23_2a-e*n._l12_2a)/h}n.context.bezierCurveTo(o,s,a,l,n._x2,n._y2,i,n.lastPoint1)}class U6{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const{x:e,y:i}=t;if(this._point){const r=this._x2-e,o=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+o*o,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:Xk(this,e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function Yk(n,t){return function(e,i,r={}){const{direction:o,startPoint:s}=r;if(e.length<2-+!!s)return null;if(e.length<3-+!!s)return jd(e,r);const a=Ou(n,o,e),l=new t(a,i,s);return sl(l,e,2),a}}const V6=Yk("catmullRom",U6);class j6{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){const{x:e,y:i}=t;if(this._point){const r=this._x2-e,o=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+o*o,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:Xk(this,e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}const G6=Yk("catmullRomClosed",j6);function $6(n,t){const{p0:e,p1:i,p2:r}=n,o=Vk(e,i,r,t),s=Dr.pointAtPP(e,i,t),a=Dr.pointAtPP(i,r,t);return[new A_(e,s,o),new A_(o,a,r)]}class A_ extends gw{constructor(t,e,i){super(),this.type=hd.QuadraticBezierCurve,this.p0=t,this.p1=e,this.p2=i}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}getPointAt(t){if(this.defined!==!1)return Vk(this.p0,this.p1,this.p2,t);throw new Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?A6(this.p0,this.p1,this.p2):60}calcProjLength(t){return t===ke.ROW?Se(this.p0.x-this.p2.x):t===ke.COLUMN?Se(this.p0.y-this.p2.y):0}getAngleAt(t){const e=un(t-.01,0),i=ki(t+.01,1),r=this.getPointAt(e),o=this.getPointAt(i);return Te(o.y-r.y,o.x-r.x)}draw(t,e,i,r,o,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*o+i),s>=1)t.quadraticCurveTo(this.p1.x*r+e,this.p1.y*o+i,this.p2.x*r+e,this.p2.y*o+i);else if(s>0){const[a]=$6(this,s);t.quadraticCurveTo(a.p1.x*r+e,a.p1.y*o+i,a.p2.x*r+e,a.p2.y*o+i)}}getYAt(t){throw new Error("QuadraticBezierCurve暂不支持getYAt")}includeX(t){throw new Error("QuadraticBezierCurve暂不支持includeX")}}class q6{constructor(t){this.path=t,this._lastX=this._lastY=this._startX=this._startY=0}moveTo(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}lineTo(t,e){const i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}addLinearCurve(t,e){return new hg(new ze(this._lastX,this._lastY),new ze(t,e))}quadraticCurveTo(t,e,i,r){const o=new A_(new ze(this._lastX,this._lastY),new ze(t,e),new ze(i,r));this.path.addCurve(o),this._lastX=i,this._lastY=r}bezierCurveTo(t,e,i,r,o,s){const a=new ug(new ze(this._lastX,this._lastY),new ze(t,e),new ze(i,r),new ze(o,s));this.path.addCurve(a),this._lastX=o,this._lastY=s}arcTo(t,e,i,r,o){throw new Error("CurveContext不支持调用arcTo")}ellipse(t,e,i,r,o,s,a,l){throw new Error("CurveContext不支持调用ellipse")}rect(t,e,i,r){throw new Error("CurveContext不支持调用rect")}arc(t,e,i,r,o,s){throw new Error("CurveContext不支持调用arc")}closePath(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}function Pa(n,t,e){var i,r;switch(t){case"linear":default:return jd(n,e);case"basis":return P6(n,e);case"monotoneX":return D6(n,e);case"monotoneY":return F6(n,e);case"step":return sv(n,.5,e);case"stepClosed":return H6(n,.5,e);case"stepBefore":return sv(n,0,e);case"stepAfter":return sv(n,1,e);case"catmullRom":return V6(n,(i=e==null?void 0:e.curveTension)!==null&&i!==void 0?i:.5,e);case"catmullRomClosed":return G6(n,(r=e==null?void 0:e.curveTension)!==null&&r!==void 0?r:.5,e);case"linearClosed":return N6(n,e)}}class Fi extends v6{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new fw(this.bounds)}get curves(){return this.tryBuildCurves()}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([pe.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([pe.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){return this.commandList.push([pe.Q,t,e,i,r]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,o,s){return this.commandList.push([pe.C,t,e,i,r,o,s]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,o,s),this}arcTo(t,e,i,r,o){return this.commandList.push([pe.AT,t,e,i,r,o]),this._ctx&&this._ctx.arcTo(t,e,i,r,o),this}ellipse(t,e,i,r,o,s,a,l){return this.commandList.push([pe.E,t,e,i,r,o,s,a,l]),this._ctx&&this._ctx.ellipse(t,e,i,r,o,s,a,l),this}rect(t,e,i,r){return this.commandList.push([pe.R,t,e,i,r]),this._ctx&&this._ctx.rect(t,e,i,r),this}arc(t,e,i,r,o,s){return this.commandList.push([pe.A,t,e,i,r,o,s]),this._ctx&&this._ctx.arc(t,e,i,r,o,s),this}closePath(){return this.commandList.push([pe.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this._curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}beginPath(){this.clear()}tryBuildCurves(){if(!this._curves||!this._curves.length){const t=new q6(this);fs(this.commandList,t,0,0,1,1)}return this._curves}toString(){if(!this.toStringCbList){const i=[];i[pe.M]=r=>`M${r[1]} ${r[2]}`,i[pe.L]=r=>`L${r[1]} ${r[2]}`,i[pe.Q]=r=>`Q${r[1]} ${r[2]} ${r[3]} ${r[4]}`,i[pe.C]=r=>`C${r[1]} ${r[2]} ${r[3]} ${r[4]} ${r[5]} ${r[6]}`,i[pe.A]=r=>{const o=[],s=r[1],a=r[2],l=r[3],u=r[4],h=r[5],d=r[6];S6(o,u,h,s,a,l,l,d);let c="";for(let f=0;f<o.length;f+=6)c+=`C${o[f]} ${o[f+1]} ${o[f+2]} ${o[f+3]} ${o[f+4]} ${o[f+5]}`;return c},i[pe.R]=r=>`M${r[1]} ${r[2]} h${r[3]} v${r[4]} H${r[1]}Z`,i[pe.Z]=r=>"Z",this.toStringCbList=i}const t=this.toStringCbList;let e="";return this.commandList.forEach(i=>{e+=t[i[0]](i)}),e}fromString(t,e,i,r,o){this.clear();const s=C6(t);return this._runCommandStrList(s,e,i,r,o),this._updateBounds(),this}fromLine(t){const{points:e,curveType:i,clipRangeByDimension:r}=t.attribute;if(!e)return;const o=Pa(e,i);r==="x"?this.direction=ke.ROW:r==="y"?this.direction=ke.COLUMN:r==="auto"&&(this.direction=o.direction),this._curves=o.curves}fromCustomPath2D(t,e,i,r,o){return this.clear(),this._runCommandList(t.commandList,e,i,r,o),this._updateBounds(),this}transform(t,e,i,r){const o=this.commandList;if(!this.transformCbList){const s=[];s[pe.M]=this.moveToTransform,s[pe.L]=this.lineToTransform,s[pe.Q]=this.quadraticCurveToTransform,s[pe.C]=this.bezierCurveToTransform,s[pe.AT]=this.arcToTransform,s[pe.E]=this.ellipseTransform,s[pe.R]=this.rectTransform,s[pe.A]=this.arcTransform,s[pe.Z]=this.closePathTransform,this.transformCbList=s}o.forEach(s=>{this.transformCbList[s[0]](s,t,e,i,r)}),this._updateBounds()}moveToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i}lineToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i}quadraticCurveToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r+e,t[4]=t[4]*o+i}bezierCurveToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r+e,t[4]=t[4]*o+i,t[5]=t[5]*r+e,t[6]=t[6]*o+i}arcToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r+e,t[4]=t[4]*o+i,t[5]=t[5]*(r+o)/2}ellipseTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r,t[4]=t[4]*o}rectTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r,t[4]=t[4]*o}arcTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*(r+o)/2}closePathTransform(){}_runCommandStrList(t,e=0,i=0,r=1,o=1){let s,a,l,u,h,d=null,c=0,f=0,g=0,m=0;for(let p=0,v=t.length;p<v;++p){switch(s=t[p],r===1&&o===1||(s=X6(s,r,o)),s[0]){case"l":c+=s[1],f+=s[2],this.lineTo(c+e,f+i);break;case"L":c=s[1],f=s[2],this.lineTo(c+e,f+i);break;case"h":c+=s[1],this.lineTo(c+e,f+i);break;case"H":c=s[1],this.lineTo(c+e,f+i);break;case"v":f+=s[1],this.lineTo(c+e,f+i);break;case"V":f=s[1],this.lineTo(c+e,f+i);break;case"m":c+=s[1],f+=s[2],this.moveTo(c+e,f+i);break;case"M":c=s[1],f=s[2],this.moveTo(c+e,f+i);break;case"c":a=c+s[5],l=f+s[6],g=c+s[3],m=f+s[4],this.bezierCurveTo(c+s[1]+e,f+s[2]+i,g+e,m+i,a+e,l+i),c=a,f=l;break;case"C":c=s[5],f=s[6],g=s[3],m=s[4],this.bezierCurveTo(s[1]+e,s[2]+i,g+e,m+i,c+e,f+i);break;case"s":a=c+s[3],l=f+s[4],d[0].match(/[CcSs]/)===null?(g=c,m=f):(g=2*c-g,m=2*f-m),u=c+s[1],h=f+s[2],this.bezierCurveTo(g+e,m+i,u+e,h+i,a+e,l+i),g=u,m=h,c=a,f=l;break;case"S":a=s[3],l=s[4],d[0].match(/[CcSs]/)===null?(g=c,m=f):(g=2*c-g,m=2*f-m),u=s[1],h=s[2],this.bezierCurveTo(g+e,m+i,u+e,h+i,a+e,l+i),g=u,m=h,c=a,f=l;break;case"q":a=c+s[3],l=f+s[4],g=c+s[1],m=f+s[2],this.quadraticCurveTo(g+e,m+i,a+e,l+i),c=a,f=l;break;case"Q":a=s[3],l=s[4],this.quadraticCurveTo(s[1]+e,s[2]+i,a+e,l+i),c=a,f=l,g=s[1],m=s[2];break;case"t":a=c+s[1],l=f+s[2],d[0].match(/[QqTt]/)===null?(g=c,m=f):d[0]==="t"?(g=2*c-u,m=2*f-h):d[0]==="q"&&(g=2*c-g,m=2*f-m),u=g,h=m,this.quadraticCurveTo(g+e,m+i,a+e,l+i),c=a,f=l,g=c+s[1],m=f+s[2];break;case"T":a=s[1],l=s[2],g=2*c-g,m=2*f-m,this.quadraticCurveTo(g+e,m+i,a+e,l+i),c=a,f=l;break;case"a":Wx(this,c+e,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+c+e,s[7]+f+i]),c+=s[6],f+=s[7];break;case"A":Wx(this,c+e,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+e,s[7]+i]),c=s[6],f=s[7];break;case"z":case"Z":this.closePath()}d=s}}_runCommandList(t,e=0,i=0,r=1,o=1){if(e!==0||i!==0||r!==1||o!==1)for(let s=0,a=t.length;s<a;++s){const l=t[s].slice();switch(l[0]){case pe.L:this.lineToTransform(l,e,i,r,o);break;case pe.M:this.moveToTransform(l,e,i,r,o);break;case pe.C:this.bezierCurveToTransform(l,e,i,r,o);break;case pe.Q:this.quadraticCurveToTransform(l,e,i,r,o);break;case pe.A:this.arcToTransform(l,e,i,r,o);break;case pe.E:this.ellipseTransform(l,e,i,r,o);break;case pe.R:this.rectTransform(l,e,i,r,o);break;case pe.AT:this.arcToTransform(l,e,i,r,o);break;case pe.Z:this.closePath()}}else this.commandList=t.map(s=>s.slice())}_updateBounds(){this.bounds.clear(),fs(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===ke.COLUMN){if(!this._curves.length)return 0;const t=this._curves[0],e=this._curves[this._curves.length-1];return Se(t.p0.y-e.p1.y)}if(this.direction===ke.ROW){if(!this._curves.length)return 0;const t=this._curves[0],e=this._curves[this._curves.length-1];return Se(t.p0.x-e.p1.x)}return this._curves.reduce((t,e)=>t+e.getLength(),0)}getYAt(t){if(!this.curves)return 1/0;for(let e=0;e<this.curves.length;e++){const i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}getAttrAt(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};let e,i=0;for(let o=0;o<this._curves.length;o++){e=this._curves[o];const s=e.getLength(this.direction);if(i+s>=t)break;i+=s}const r=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(r),angle:e.getAngleAt(r)}}drawWithClipRange(t,e,i,r,o){this.tryBuildCurves();const s=this.getLength()*o;let a=0;for(let l=0;l<this._curves.length;l++){const u=this._curves[l],h=u.getLength(this.direction);if(!(a+h<=s)){const d=1-(a+h-s)/h;u.draw(t,i,r,e,e,d);break}u.draw(t,i,r,e,e,1),a+=h}}}const bn=["l",0,0,0,0,0,0,0];function X6(n,t,e){const i=bn[0]=n[0];if(i==="a"||i==="A")bn[1]=t*n[1],bn[2]=e*n[2],bn[3]=n[3],bn[4]=n[4],bn[5]=n[5],bn[6]=t*n[6],bn[7]=e*n[7];else if(i==="h"||i==="H")bn[1]=t*n[1];else if(i==="v"||i==="V")bn[1]=e*n[1];else for(let r=1,o=n.length;r<o;++r)bn[r]=(r%2==1?t:e)*n[r];return bn}const Y6={alignSelf:"auto"},Ui={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new Xe},Kk={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},av={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},Zk=Object.assign({outerBorder:Object.assign(Object.assign({},av),{distance:0}),innerBorder:Object.assign(Object.assign({},av),{distance:0})},av),Gr={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:`PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,
    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol`,fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:Ua.fontBounding,keepCenterInLine:!1},K6={pickStrokeBuffer:0},Z6=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},Kk),Zk),Y6),K6),Qk={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},Q6={_debug_bounds:!1},ui=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},Q6),Z6),Ui),J6=Object.assign(Object.assign({},ui),{startAngle:0,endAngle:Zt,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),t8=Object.assign(Object.assign(Object.assign({},ui),Qk),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),e8=Object.assign(Object.assign({},ui),{radius:1,startAngle:0,endAngle:Zt}),i8=Object.assign(Object.assign({},ui),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),r8=Object.assign(Object.assign({},ui),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),n8=Object.assign(Object.assign(Object.assign({},ui),Qk),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),o8=Object.assign(Object.assign({},ui),{path:new Fi,fillStrokeOrder:1,clipRange:1,customPath:()=>{Er.getInstance().warn("空函数")}}),s8=Object.assign(Object.assign({},ui),{points:[],cornerRadius:0,closePath:!0}),a8=Object.assign(Object.assign({},ui),{width:100,height:100,spikes:5,thickness:.5}),l8=Object.assign(Object.assign({},ui),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round"});Object.assign(Object.assign({},ui),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round"});const u8=Object.assign(Object.assign({},ui),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),Jk=Object.assign(Object.assign(Object.assign({},ui),Gr),{strokeBoundsBuffer:0,keepDirIn3d:!0}),Zo=Object.assign(Object.assign(Object.assign({},ui),Gr),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),dd=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},ui),{fill:!0,cornerRadius:0,cornerType:"round"}),h8=Object.assign(Object.assign({},dd),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),d8=function(){const n={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i};let t="";function e(y){const w=new Error(t+": "+y);throw w.source=t,w}function i(){const y=f(r);return t.length>0&&e("Invalid input not EOF"),y}function r(){return o("linear",n.linearGradient,s)||o("radial",n.radialGradient,l)||o("conic",n.conicGradient,a)}function o(y,w,_){return function(A,T){const S=b(A);if(S){b(n.startCall)||e("Missing (");const x=T(S);return b(n.endCall)||e("Missing )"),x}}(w,function(A){const T=_();return T&&(b(n.comma)||e("Missing comma before color stops")),{type:y,orientation:T,colorStops:f(g)}})}function s(){return v("directional",n.sideOrCorner,1)||v("angular",n.angleValue,1)}function a(){return v("angular",n.fromAngleValue,1)}function l(){let y,w,_=u();return _&&(y=[],y.push(_),w=t,b(n.comma)&&(_=u(),_?y.push(_):t=w)),y}function u(){let y=function(){const w=v("shape",/^(circle)/i,0);return w&&(w.style=p()||h()),w}()||function(){const w=v("shape",/^(ellipse)/i,0);return w&&(w.style=m()||h()),w}();if(y)y.at=d();else{const w=h();if(w){y=w;const _=d();_&&(y.at=_)}else{const _=c();_&&(y={type:"default-radial",at:_})}}return y}function h(){return v("extent-keyword",n.extentKeywords,1)}function d(){if(v("position",/^at/,0)){const y=c();return y||e("Missing positioning value"),y}}function c(){const y={x:m(),y:m()};if(y.x||y.y)return{type:"position",value:y}}function f(y){let w=y();const _=[];if(w)for(_.push(w);b(n.comma);)w=y(),w?_.push(w):e("One extra comma");return _}function g(){const y=v("hex",n.hexColor,1)||v("rgba",n.rgbaColor,1)||v("rgb",n.rgbColor,1)||v("literal",n.literalColor,0);return y||e("Expected color definition"),y.length=m(),y}function m(){return v("%",n.percentageValue,1)||v("position-keyword",n.positionKeywords,1)||p()}function p(){return v("px",n.pixelValue,1)||v("em",n.emValue,1)}function v(y,w,_){const A=b(w);if(A)return{type:y,value:A[_]}}function b(y){const w=/^[\n\r\t\s]+/.exec(t);w&&C(w[0].length);const _=y.exec(t);return _&&C(_[0].length),_}function C(y){t=t.substr(y)}return function(y){return t=y.toString(),i()}}();class Il{static IsGradient(t){return!(typeof t=="string"&&!t.includes("gradient"))}static IsGradientStr(t){return typeof t=="string"&&t.includes("gradient")}static Parse(t){if(Il.IsGradientStr(t))try{const e=d8(t)[0];if(e){if(e.type==="linear")return Il.ParseLinear(e);if(e.type==="radial")return Il.ParseRadial(e);if(e.type==="conic")return Il.ParseConic(e)}}catch{return t}return t}static ParseConic(t){const{orientation:e,colorStops:i=[]}=t,r=Ae/2,o=parseFloat(e.value)/180*Ae-r;return{gradient:"conical",x:.5,y:.5,startAngle:o,endAngle:o+Zt,stops:i.map(s=>({color:s.value,offset:parseFloat(s.length.value)/100}))}}static ParseRadial(t){const{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:e.map(i=>({color:i.value,offset:parseFloat(i.length.value)/100}))}}static ParseLinear(t){const{orientation:e,colorStops:i=[]}=t,r=Ae/2;let o=e.type==="angular"?parseFloat(e.value)/180*Ae:0;for(;o<0;)o+=Zt;for(;o>=Zt;)o-=Zt;let s=0,a=0,l=0,u=0;return o<r?(s=0,a=1,l=Math.sin(o),u=a-Math.cos(o)):o<Ae?(s=0,a=0,l=Math.cos(o-r),u=Math.sin(o-r)):o<Ae+r?(s=1,a=0,l=s-Math.sin(o-Ae),u=Math.cos(o-Ae)):(s=1,l=s-Math.cos(o-r-Ae),u-=Math.sin(o-r-Ae)),{gradient:"linear",x0:s,y0:a,x1:l,y1:u,stops:i.map(h=>({color:h.value,offset:parseFloat(h.length.value)/100}))}}}function Po(n,t,e){let i=t;const{a:r,b:o,c:s,d:a}=n.currentMatrix,l=Math.sign(r)*Math.sqrt(r*r+o*o),u=Math.sign(a)*Math.sqrt(s*s+a*a);return l+u===0?0:(i=i/Math.abs(l+u)*2*e,i)}function dg(n,t,e,i=0,r=0){var o,s,a,l;if(!t||t===!0)return"black";let u,h;if(jt(t))for(let d=0;d<t.length&&(h=t[d],!h);d++);else h=t;if(h=Il.Parse(h),typeof h=="string")return h;if(e.AABBBounds&&(!e.attribute||e.attribute.scaleX!==0||e.attribute.scaleY!==0)){const d=e.AABBBounds;let c=d.x2-d.x1,f=d.y2-d.y1,g=d.x1-i,m=d.y1-r;if(e.attribute){const{scaleX:p=1,scaleY:v=1,angle:b=0}=e.attribute;c/=p,f/=v,g/=p,m/=v,(b||p!==1||v!==1)&&(g=(o=e.x1WithoutTransform)!==null&&o!==void 0?o:0,m=(s=e.y1WithoutTransform)!==null&&s!==void 0?s:0,c=(a=e.widthWithoutTransform)!==null&&a!==void 0?a:c,f=(l=e.heightWithoutTransform)!==null&&l!==void 0?l:f)}h.gradient==="linear"?u=c8(n,h,g,m,c,f):h.gradient==="conical"?u=g8(n,h,g,m,c,f):h.gradient==="radial"&&(u=f8(n,h,g,m,c,f))}return u||"orange"}function c8(n,t,e,i,r,o){var s,a,l,u;const h=n.createLinearGradient(e+((s=t.x0)!==null&&s!==void 0?s:0)*r,i+((a=t.y0)!==null&&a!==void 0?a:0)*o,e+((l=t.x1)!==null&&l!==void 0?l:1)*r,i+((u=t.y1)!==null&&u!==void 0?u:0)*o);return t.stops.forEach(d=>{h.addColorStop(d.offset,d.color)}),h}function f8(n,t,e,i,r,o){var s,a,l,u,h,d;const c=n.createRadialGradient(e+((s=t.x0)!==null&&s!==void 0?s:.5)*r,i+((a=t.y0)!==null&&a!==void 0?a:.5)*o,Math.max(r,o)*((l=t.r0)!==null&&l!==void 0?l:0),e+((u=t.x1)!==null&&u!==void 0?u:.5)*r,i+((h=t.y1)!==null&&h!==void 0?h:.5)*o,Math.max(r,o)*((d=t.r1)!==null&&d!==void 0?d:.5));return t.stops.forEach(f=>{c.addColorStop(f.offset,f.color)}),c}function g8(n,t,e,i,r,o){var s,a;const l=n.createConicGradient(e+((s=t.x)!==null&&s!==void 0?s:0)*r,i+((a=t.y)!==null&&a!==void 0?a:0)*o,t.startAngle,t.endAngle);return t.stops.forEach(u=>{l.addColorStop(u.offset,u.color)}),l.GetPattern?l.GetPattern(r+e,o+i,void 0):l}const pw={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},tL={fill:!0,stroke:!1},cg=/\w|\(|\)|-/,eL=/[.?!,;:/，。？！、；：]/,p8=/\S/,iL=(n,t)=>{let e=t.fontSize||16;switch(t.script){case"super":case"sub":e*=.8}n.setTextStyle({textAlign:"left",textBaseline:t.textBaseline||"alphabetic",fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||"",fontSize:e,fontFamily:t.fontFamily})};function m8(n,t,e){const i=t&&t.fill||tL.fill,{fillOpacity:r=1,opacity:o=1}=t;n.globalAlpha=r*o,n.fillStyle=e?dg(n,i,{AABBBounds:e}):i,iL(n,t)}function v8(n,t){const e=t&&t.stroke||tL.stroke;if(!e)return void(n.globalAlpha=0);const{strokeOpacity:i=1,opacity:r=1}=t;n.globalAlpha=i*r,n.lineWidth=t&&typeof t.lineWidth=="number"?t.lineWidth:1,n.strokeStyle=e,iL(n,t)}function Ef(n,t,e,i,r){if(n.length<=1||!t||t<=0)return 0;const o=Mt.graphicUtil.textMeasure;let s=i,a=n.slice(0,s),l=Math.floor(o.measureText(a,e).width),u=n.slice(0,s+1),h=Math.floor(o.measureText(u,e).width);for(;l>t||h<=t;){if(l>t?s--:s++,s>n.length){s=n.length;break}if(s<0){s=0;break}a=n.slice(0,s),l=Math.floor(o.measureText(a,e).width),u=n.slice(0,s+1),h=Math.floor(o.measureText(u,e).width)}return r&&(s=Mf(n,s)),s}function Mf(n,t,e=!1){let i=t;for(;cg.test(n[i-1])&&cg.test(n[i])||eL.test(n[i]);)if(i--,i<=0)return e?b8(n,t):t;return i}function b8(n,t){let e=t;for(;cg.test(n[e+1])&&cg.test(n[e])||eL.test(n[e]);)if(e++,e>=n.length)return e;return e+1}function Aa(n,t,e="actual"){var i;if(n==="")return{ascent:0,height:0,descent:0,width:0};const r=Mt.graphicUtil.textMeasure.measureText(n,t),o={ascent:0,height:0,descent:0,width:0},s=e==="actual"?r.actualBoundingBoxAscent:r.fontBoundingBoxAscent,a=e==="actual"?r.actualBoundingBoxDescent:r.fontBoundingBoxDescent;typeof s!="number"||typeof a!="number"?(o.width=Math.floor(r.width),o.height=t.fontSize||0,o.ascent=o.height,o.descent=0):(o.width=Math.floor(r.width),o.height=Math.floor(s+a),o.ascent=Math.floor(s),o.descent=o.height-o.ascent);const l=(i=t.space)!==null&&i!==void 0?i:0;return o.width+=l,o}var _8=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let R_=class{configure(n,t){this.canvas=n.canvas,this.context=n.context,n.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(n,t,e){this.context.setTextStyleWithoutAlignBaseline(t);const i=this.context.measureText(n);return e?this.compatibleMetrics(i,t):i}_measureTextWithAlignBaseline(n,t,e){this.context.setTextStyle(t);const i=this.context.measureText(n);return e?this.compatibleMetrics(i,t):i}compatibleMetrics(n,t){if(n.actualBoundingBoxAscent==null||n.actualBoundingBoxDescent==null||n.fontBoundingBoxAscent==null||n.fontBoundingBoxDescent==null){n={width:n.width};const{ascent:e,descent:i}=this.measureTextBoundADscentEstimate(t);n.actualBoundingBoxAscent=e,n.actualBoundingBoxDescent=i,n.fontBoundingBoxAscent=e,n.fontBoundingBoxDescent=i}if(n.actualBoundingBoxLeft==null||n.actualBoundingBoxRight==null){n={width:n.width,actualBoundingBoxAscent:n.actualBoundingBoxAscent,actualBoundingBoxDescent:n.actualBoundingBoxDescent,fontBoundingBoxAscent:n.fontBoundingBoxAscent,fontBoundingBoxDescent:n.fontBoundingBoxDescent};const{left:e,right:i}=this.measureTextBoundLeftRightEstimate(t);n.actualBoundingBoxLeft=e,n.actualBoundingBoxRight=i}return n}estimate(n,{fontSize:t=Jk.fontSize}){let e=0,i=0;for(let r=0;r<n.length;r++)n.charCodeAt(r)<128?e++:i++;return{width:~~(.8*e*t+i*t),height:t}}measureTextWidth(n,t,e){return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t)).width:this.estimate(n,t).width}measureTextBoundsWidth(n,t,e){return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t)).width:this.estimate(n,t).width}measureTextBoundsLeftRight(n,t,e){return this.context?{left:(e=e??this._measureTextWithAlignBaseline(n,t,!0)).actualBoundingBoxLeft,right:e.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(t)}measureTextPixelHeight(n,t,e){var i;return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t,!0),Math.abs(e.actualBoundingBoxAscent-e.actualBoundingBoxDescent)):(i=t.fontSize)!==null&&i!==void 0?i:Gr.fontSize}measureTextPixelADscent(n,t,e){return this.context?{ascent:(e=e??this._measureTextWithAlignBaseline(n,t,!0)).actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundHieght(n,t,e){var i;return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t,!0),Math.abs(e.fontBoundingBoxAscent-e.fontBoundingBoxDescent)):(i=t.fontSize)!==null&&i!==void 0?i:Gr.fontSize}measureTextBoundADscent(n,t,e){return this.context?{ascent:(e=e??this._measureTextWithAlignBaseline(n,t,!0)).fontBoundingBoxAscent,descent:e.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundADscentEstimate(n){var t;const e=(t=n.fontSize)!==null&&t!==void 0?t:Gr.fontSize;return{ascent:.79*e,descent:.21*e}}measureTextBoundLeftRightEstimate(n){var t;const e=(t=n.fontSize)!==null&&t!==void 0?t:Gr.fontSize,{textAlign:i}=n;return i==="center"?{left:e/2,right:e/2}:i==="right"||i==="end"?{left:e,right:0}:{left:0,right:e}}measureTextPixelADscentAndWidth(n,t,e){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:this.estimate(n,t).width});const i=this._measureTextWithoutAlignBaseline(n,t,!0);if(e===Ua.actualBounding)return{ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,width:i.width};if(e===Ua.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:i.width});if(e===Ua.fontBounding){let r=i.fontBoundingBoxAscent,o=i.fontBoundingBoxDescent;if(i.actualBoundingBoxDescent&&o<i.actualBoundingBoxDescent){const s=i.actualBoundingBoxDescent-o;o+=s,r-=s}else if(i.actualBoundingBoxAscent&&r<i.actualBoundingBoxAscent){const s=i.actualBoundingBoxAscent-r;r+=s,o-=s}return{ascent:r,descent:o,width:i.width}}return{ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,width:i.width}}measureText(n,t){return this.context?(this.context.setTextStyleWithoutAlignBaseline(t),this.context.measureText(n)):this.estimate(n,t)}clipTextVertical(n,t,e,i){if(n.length===0)return{verticalList:n,width:0};const{fontSize:r=12}=t;n.forEach(l=>{l.width=l.direction===0?r:this.measureTextWidth(l.text,t)});const o=[];let s=0,a=0;for(;a<n.length&&s+n[a].width<e;a++)s+=n[a].width,o.push(n[a]);if(n[a]&&n[a].text.length>1){const l=this._clipText(n[a].text,t,e-s,0,n[a].text.length-1,"end",!1);if(i&&l.str!==n[a].text){let u="",h=0;for(let f=0;f<a;f++){const g=n[f];u+=g.text,h+=g.text.length}u+=n[a].text;const d=h+l.str.length;let c=Mf(u,d);c-=h,c!==l.str.length-1&&(l.str=l.str.substring(0,c),l.width=this.measureTextWidth(l.str,t))}o.push(Object.assign(Object.assign({},n[a]),{text:l.str,width:l.width})),s+=l.width}return{verticalList:o,width:s}}clipText(n,t,e,i,r){if(n.length===0)return{str:"",width:0};let o=this.measureTextWidth(n,t);if(o<=e)return{str:n,width:o};if(o=this.measureTextWidth(n[0],t),o>e)return{str:"",width:0};const s=this._clipText(n,t,e,0,n.length-1,"end",!1);if(i&&s.str!==n){let a=Mf(n,s.str.length,r);a!==s.str.length&&(a>s.str.length&&(s.wordBreaked=a,a=s.str.length),s.str=n.substring(0,a),s.width=this.measureTextWidth(s.str,t))}return s}_clipText(n,t,e,i,r,o,s){let a;if(o==="start")a=this._clipTextStart(n,t,e,i,r),s&&(a.result=s+a.str);else if(o==="middle"){const l=this._clipTextMiddle(n,t,e,"","",0,0,1);a={str:"none",width:l.width,result:l.left+s+l.right}}else a=this._clipTextEnd(n,t,e,i,r),s&&(a.result=a.str+s);return a}_clipTextEnd(n,t,e,i,r){if(i===r){Er.getInstance().warn(`【_clipTextEnd】不应该走到这里${n}, ${i}, ${r}`);const u=n.substring(0,r+1);return{str:u,width:this.measureTextWidth(u,t)}}const o=Math.floor((i+r)/2),s=n.substring(0,o+1),a=this.measureTextWidth(s,t);let l;if(a>e){if(s.length<=1)return{str:"",width:0};const u=n.substring(0,o);return l=this.measureTextWidth(u,t),l<=e?{str:u,width:l}:this._clipTextEnd(n,t,e,i,o)}if(a<e){if(o>=n.length-1)return{str:n,width:this.measureTextWidth(n,t)};const u=n.substring(0,o+2);return l=this.measureTextWidth(u,t),l>=e?{str:s,width:a}:this._clipTextEnd(n,t,e,o,r)}return{str:s,width:a}}_clipTextStart(n,t,e,i,r){const o=Math.ceil((i+r)/2),s=n.substring(o-1,n.length),a=this.measureTextWidth(s,t);let l;if(a>e){if(s.length<=1)return{str:"",width:0};const u=n.substring(o,n.length);return l=this.measureTextWidth(u,t),l<=e?{str:u,width:l}:this._clipTextStart(n,t,e,o,n.length)}if(a<e){if(o<=0)return{str:n,width:this.measureTextWidth(n,t)};const u=n.substring(o-2,n.length);return l=this.measureTextWidth(u,t),l>=e?{str:s,width:a}:this._clipTextStart(n,t,e,i,o)}return{str:s,width:a}}_clipTextMiddle(n,t,e,i,r,o,s,a){const l=n.substring(0,a),u=this.measureTextWidth(l,t);if(u+s>e)return{left:i,right:r,width:o+s};const h=n.substring(n.length-a,n.length),d=this.measureTextWidth(h,t);return u+d>e?{left:l,right:r,width:u+s}:this._clipTextMiddle(n,t,e,l,h,u,d,a+1)}clipTextWithSuffixVertical(n,t,e,i,r,o){if(i==="")return this.clipTextVertical(n,t,e,r);if(n.length===0)return{verticalList:n,width:0};const s=this.clipTextVertical(n,t,e,r);if(s.verticalList.length===n.length&&s.verticalList[s.verticalList.length-1].width===n[n.length-1].width)return s;const a=this.measureTextWidth(i,t);if(a>e)return s;let l;if(e-=a,o==="start"){const u=this.revertVerticalList(n);l=this.clipTextVertical(u,t,e,r);const h=this.revertVerticalList(l.verticalList);h.unshift({text:i,direction:1,width:a}),l.verticalList=h}else if(o==="middle"){const u=this.clipTextVertical(n,t,e/2,r),h=this.revertVerticalList(n),d=this.clipTextVertical(h,t,e/2,r);u.verticalList.push({text:i,direction:1,width:a}),this.revertVerticalList(d.verticalList).forEach(c=>u.verticalList.push(c)),l={verticalList:u.verticalList,width:u.width+d.width}}else l=this.clipTextVertical(n,t,e,r),l.verticalList.push({text:i,direction:1,width:a});return l.width+=a,l}revertVerticalList(n){return n.reverse().map(t=>{const e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(n,t,e,i,r,o,s=!1){if(i==="")return this.clipText(n,t,e,r);if(n.length===0)return{str:"",width:0};const a=this.measureTextWidth(n,t);if(!s&&a<=e)return{str:n,width:a};const l=this.measureTextWidth(i,t);if(l>e)return{str:"",width:0};if(s&&a+l<=e)return{str:n+i,width:a+l};e-=l;const u=this._clipText(n,t,e,0,n.length-1,o,i);if(r&&u.str!==n){const h=Mf(n,u.str.length);h!==u.str.length&&(u.result=n.substring(0,h),u.width=this.measureTextWidth(u.str,t))}else s&&u.str===n&&(u.result=n+i);return u.str=u.result,u.width+=l,u}};R_=_8([Tt()],R_);var C8=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};const as=Symbol.for("TextMeasureContribution");let vu=class extends R_{};vu=C8([Tt()],vu);const te=new C4,rL=Symbol.for("CanvasFactory"),y8=Symbol.for("Context2dFactory");function E_(n){return te.getNamed(rL,Mt.global.env)(n)}const nL=1e-4,Yx=Math.sqrt(3),Uc=1/3;function Is(n){return n>-cd&&n<cd}function oL(n){return n>cd||n<-cd}const Co=[0,0],Rn=[0,0],$l=[0,0];function ql(n,t){return(n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])}function Jo(n,t,e,i){const r=1-i;return r*(r*n+2*i*t)+i*i*e}function ts(n,t,e,i,r){const o=1-r;return o*o*(o*n+3*r*t)+r*r*(r*i+3*o*e)}function w8(n,t,e,i,r){const o=n-2*t+e,s=2*(t-n),a=n-i;let l=0;if(Is(o)){if(oL(s)){const u=-a/s;u>=0&&u<=1&&(r[l++]=u)}}else{const u=s*s-4*o*a;if(Is(u)){const h=-s/(2*o);h>=0&&h<=1&&(r[l++]=h)}else if(u>0){const h=Math.sqrt(u),d=(-s+h)/(2*o),c=(-s-h)/(2*o);d>=0&&d<=1&&(r[l++]=d),c>=0&&c<=1&&(r[l++]=c)}}return l}function S8(n,t,e){const i=n+e-2*t;return i===0?.5:(n-t)/i}function x8(n,t,e,i,r,o,s,a,l){let u=0,h=.005,d=1/0;Co[0]=s,Co[1]=a;for(let c=0;c<1;c+=.05){Rn[0]=Jo(n,e,r,c),Rn[1]=Jo(t,i,o,c);const f=ql(Co,Rn);f<d&&(u=c,d=f)}d=1/0;for(let c=0;c<32&&!(h<nL);c++){const f=u-h,g=u+h;Rn[0]=Jo(n,e,r,f),Rn[1]=Jo(t,i,o,f);const m=ql(Rn,Co);if(f>=0&&m<d)u=f,d=m;else{$l[0]=Jo(n,e,r,g),$l[1]=Jo(t,i,o,g);const p=ql($l,Co);g<=1&&p<d?(u=g,d=p):h*=.5}}return Math.sqrt(d)}function T8(n,t,e,i,r,o,s,a,l,u,h){let d,c,f,g,m=0,p=.005,v=1/0;Co[0]=l,Co[1]=u;for(let b=0;b<1;b+=.05)Rn[0]=ts(n,e,r,s,b),Rn[1]=ts(t,i,o,a,b),f=ql(Co,Rn),f<v&&(m=b,v=f);v=1/0;for(let b=0;b<32&&!(p<nL);b++)d=m-p,c=m+p,Rn[0]=ts(n,e,r,s,d),Rn[1]=ts(t,i,o,a,d),f=ql(Rn,Co),d>=0&&f<v?(m=d,v=f):($l[0]=ts(n,e,r,s,c),$l[1]=ts(t,i,o,a,c),g=ql($l,Co),c<=1&&g<v?(m=c,v=g):p*=.5);return Math.sqrt(v)}function Vc(n){return(n%=Zt)<0&&(n+=Zt),n}function A8(n,t,e,i,r,o,s,a,l){if(s===0)return!1;const u=s;return l>t+u&&l>i+u&&l>o+u||l<t-u&&l<i-u&&l<o-u||a>n+u&&a>e+u&&a>r+u||a<n-u&&a<e-u&&a<r-u?!1:x8(n,t,e,i,r,o,a,l)<=u/2}function R8(n,t,e,i,r,o,s,a,l,u,h){if(l===0)return!1;const d=l;return h>t+d&&h>i+d&&h>o+d&&h>a+d||h<t-d&&h<i-d&&h<o-d&&h<a-d||u>n+d&&u>e+d&&u>r+d&&u>s+d||u<n-d&&u<e-d&&u<r-d&&u<s-d?!1:T8(n,t,e,i,r,o,s,a,u,h)<=d/2}function E8(n,t,e,i,r,o,s,a,l){if(s===0)return!1;const u=s;a-=n,l-=t;const h=Math.sqrt(a*a+l*l);if(h-u>e||h+u<e)return!1;if(Math.abs(i-r)%Zt<1e-4)return!0;if(o){const c=i;i=Vc(r),r=Vc(c)}else i=Vc(i),r=Vc(r);i>r&&(r+=Zt);let d=Math.atan2(l,a);return d<0&&(d+=Zt),d>=i&&d<=r||d+Zt>=i&&d+Zt<=r}function pl(n,t,e,i,r,o,s){if(r===0)return!1;const a=r,l=r/2;let u=0,h=n;if(s>t+l&&s>i+l||s<t-l&&s<i-l||o>n+l&&o>e+l||o<n-l&&o<e-l)return!1;if(n===e)return Math.abs(o-n)<=a/2;u=(t-i)/(n-e),h=(n*i-e*t)/(n-e);const d=u*o-s+h;return d*d/(u*u+1)<=a/2*a/2}const cd=1e-4;function M8(n,t,e,i,r,o){const s=i+3*(t-e)-n,a=3*(e-2*t+n),l=3*(t-n),u=n-r,h=a*a-3*s*l,d=a*l-9*s*u,c=l*l-3*a*u;let f=0;if(Is(h)&&Is(d))if(Is(a))o[0]=0;else{const g=-l/a;g>=0&&g<=1&&(o[f++]=g)}else{const g=d*d-4*h*c;if(Is(g)){const m=d/h,p=-a/s+m,v=-m/2;p>=0&&p<=1&&(o[f++]=p),v>=0&&v<=1&&(o[f++]=v)}else if(g>0){const m=Math.sqrt(g);let p=h*a+1.5*s*(-d+m),v=h*a+1.5*s*(-d-m);p=p<0?-Math.pow(-p,Uc):Math.pow(p,Uc),v=v<0?-Math.pow(-v,Uc):Math.pow(v,Uc);const b=(-a-(p+v))/(3*s);b>=0&&b<=1&&(o[f++]=b)}else{const m=(2*h*a-3*s*d)/(2*Math.sqrt(h*h*h)),p=Math.acos(m)/3,v=Math.sqrt(h),b=Math.cos(p),C=(-a-2*v*b)/(3*s),y=(-a+v*(b+Yx*Math.sin(p)))/(3*s),w=(-a+v*(b-Yx*Math.sin(p)))/(3*s);C>=0&&C<=1&&(o[f++]=C),y>=0&&y<=1&&(o[f++]=y),w>=0&&w<=1&&(o[f++]=w)}}return f}function B8(n,t,e,i,r){const o=6*e-12*t+6*n,s=9*t+3*i-3*n-9*e,a=3*t-3*n;let l=0;if(Is(s)){if(oL(o)){const u=-a/o;u>=0&&u<=1&&(r[l++]=u)}}else{const u=o*o-4*s*a;if(Is(u))r[0]=-o/(2*s);else if(u>0){const h=Math.sqrt(u),d=(-o+h)/(2*s),c=(-o-h)/(2*s);d>=0&&d<=1&&(r[l++]=d),c>=0&&c<=1&&(r[l++]=c)}}return l}function P8(n,t){return Math.abs(n-t)<cd}const Mr=[-1,-1,-1],Sn=[-1,-1];function k8(){const n=Sn[0];Sn[0]=Sn[1],Sn[1]=n}function L8(n,t,e,i,r,o,s,a,l,u){if(u>t&&u>i&&u>o&&u>a||u<t&&u<i&&u<o&&u<a)return 0;const h=M8(t,i,o,a,u,Mr);if(h===0)return 0;let d=0,c=-1,f=0,g=0;for(let m=0;m<h;m++){const p=Mr[m],v=p===0||p===1?.5:1;ts(n,e,r,s,p)<l||(c<0&&(c=B8(t,i,o,a,Sn),Sn[1]<Sn[0]&&c>1&&k8(),f=ts(t,i,o,a,Sn[0]),c>1&&(g=ts(t,i,o,a,Sn[1]))),c===2?p<Sn[0]?d+=f<t?v:-v:p<Sn[1]?d+=g<f?v:-v:d+=a<g?v:-v:p<Sn[0]?d+=f<t?v:-v:d+=a<f?v:-v)}return d}function D8(n,t,e,i,r,o,s,a){if(a>t&&a>i&&a>o||a<t&&a<i&&a<o)return 0;const l=w8(t,i,o,a,Mr);if(l===0)return 0;const u=S8(t,i,o);if(u>=0&&u<=1){let d=0;const c=Jo(t,i,o,u);for(let f=0;f<l;f++){const g=Mr[f]===0||Mr[f]===1?.5:1;Jo(n,e,r,Mr[f])<s||(Mr[f]<u?d+=c<t?g:-g:d+=o<c?g:-g)}return d}const h=Mr[0]===0||Mr[0]===1?.5:1;return Jo(n,e,r,Mr[0])<s?0:o<t?h:-h}function I8(n,t,e,i,r,o,s,a){if((a-=t)>e||a<-e)return 0;const l=Math.sqrt(e*e-a*a);Mr[0]=-l,Mr[1]=l;const u=Math.abs(i-r);if(u<1e-4)return 0;if(u>=Zt-1e-4){i=0,r=Zt;const d=o?1:-1;return s>=Mr[0]+n&&s<=Mr[1]+n?d:0}if(i>r){const d=i;i=r,r=d}i<0&&(i+=Zt,r+=Zt);let h=0;for(let d=0;d<2;d++){const c=Mr[d];if(c+n>s){let f=Math.atan2(a,c),g=o?1:-1;f<0&&(f=Zt+f),(f>=i&&f<=r||f+Zt>=i&&f+Zt<=r)&&(f>Ae/2&&f<1.5*Ae&&(g=-g),h+=g)}}return h}function lv(n){return Math.round(n/Ae*1e8)/1e8%2*Ae}function F8(n,t){let e=lv(n[0]);e<0&&(e+=Zt);const i=e-n[0];let r=n[1];r+=i,!t&&r-e>=Zt?r=e+Zt:t&&e-r>=Zt?r=e-Zt:!t&&e>r?r=e+(Zt-lv(e-r)):t&&e<r&&(r=e-(Zt-lv(r-e))),n[0]=e,n[1]=r}const oh=[0,0];function sL(n,t,e,i,r){const o=n,s=n.length;let a,l,u=0,h=0,d=0,c=0,f=0;for(let g=0;g<s;g++){const m=o[g],p=g===0;m[0]===pe.M&&g>1&&(e||(u+=ua(h,d,c,f,i,r))),p&&(h=m[1],d=m[2],c=h,f=d);const v=m[0],b=m[1],C=m[2],y=m[3],w=m[4],_=m[5],A=m[6];let T=w,S=_;oh[0]=T,oh[1]=S,F8(oh,!!m[6]),T=oh[0],S=oh[1];const x=T,E=S-T,M=!!(1-(m[6]?0:1)),L=(i-b)*y/y+b;switch(v){case pe.M:c=b,f=C,h=c,d=f;break;case pe.L:if(e){if(pl(h,d,b,C,t,i,r))return!0}else u+=ua(h,d,b,C,i,r)||0;h=b,d=C;break;case pe.C:if(e){if(R8(h,d,b,C,y,w,_,A,t,i,r))return!0}else u+=L8(h,d,b,C,y,w,_,A,i,r)||0;h=_,d=A;break;case pe.Q:if(e){if(A8(h,d,b,C,y,w,t,i,r))return!0}else u+=D8(h,d,b,C,y,w,i,r)||0;h=y,d=w;break;case pe.A:if(a=Math.cos(x)*y+b,l=Math.sin(x)*y+C,p?(c=a,f=l):u+=ua(h,d,a,l,i,r),e){if(E8(b,C,y,x,x+E,M,t,L,r))return!0}else u+=I8(b,C,y,x,x+E,M,L,r);h=Math.cos(x+E)*y+b,d=Math.sin(x+E)*y+C;break;case pe.R:if(c=h=b,f=d=C,a=c+y,l=f+w,e){if(pl(c,f,a,f,t,i,r)||pl(a,f,a,l,t,i,r)||pl(a,l,c,l,t,i,r)||pl(c,l,c,f,t,i,r))return!0}else u+=ua(a,f,a,l,i,r),u+=ua(c,l,c,f,i,r);break;case pe.Z:if(e){if(pl(h,d,c,f,t,i,r))return!0}else u+=ua(h,d,c,f,i,r);h=c,d=f}}return e||P8(d,f)||(u+=ua(h,d,c,f,i,r)||0),u!==0}function O8(n,t,e){return sL(n,0,!1,t,e)}function H8(n,t,e,i){return sL(n,t,!0,e,i)}class z8{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){const i=E_(Object.assign({nativeCanvas:Mt.global.createCanvas(t)},t));return this.allocatedCanvas.push(i),i}const e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){const i={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},r=E_(Object.assign({nativeCanvas:Mt.global.createCanvas(i)},i));return this.allocatedCanvas.push(r),r}const e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const Va=new z8;var N8=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},W8=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const fd=Symbol.for("VWindow"),mw=Symbol.for("WindowHandlerContribution");let M_=class extends Ek{get width(){if(this._handler){const n=this._handler.getWH();return this._width=n.width}return this._width}get height(){if(this._handler){const n=this._handler.getWH();return this._height=n.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){super(),this.hooks={onChange:new Vr(["x","y","width","height"])},this.active=()=>{const n=this.global;!n.env||this.actived||(te.getNamed(mw,n.env).configure(this,n),this.actived=!0)},this._uid=bi.GenAutoIncrementId(),this.global=Mt.global,this.postInit()}_nativeAddEventListener(n,t,e){return this._handler.addEventListener(n,t,e)}_nativeRemoveEventListener(n,t,e){return this._handler.removeEventListener(n,t,e)}_nativeDispatchEvent(n){return this._handler.dispatchEvent(n)}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var n;return(n=this._handler.getStyle())!==null&&n!==void 0?n:{}}set style(n){this._handler.setStyle(n)}create(n){var t,e;this._handler.createWindow(n);const i=this._handler.getWH();this._width=i.width,this._height=i.height,n.viewBox?this.setViewBox(n.viewBox):n.canvasControled!==!1?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:(t=n.width)!==null&&t!==void 0?t:this._width,y2:(e=n.height)!==null&&e!==void 0?e:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(n){this._handler=n}setDpr(n){return this._handler.setDpr(n)}resize(n,t){return this._handler.resizeWindow(n,t)}configure(){throw new Error("暂不支持")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(n){return this._handler.getImageBuffer?this._handler.getImageBuffer(n):null}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(n){this._handler.clearViewBox(n)}setViewBox(n){this._handler.setViewBox(n)}setViewBoxTransform(n,t,e,i,r,o){this._handler.setViewBoxTransform(n,t,e,i,r,o)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(n,t){const e=this._handler.getViewBox(),i={x:n,y:t};return this._handler.getViewBoxTransform().transformPoint({x:n,y:t},i),i.x-=e.x1,i.y-=e.y1,i}hasSubView(){const n=this._handler.getViewBox();return!(n.x1===0&&n.y1===0&&Xn(this.width,n.width())&&Xn(this.height,n.height()))}isVisible(n){return this._handler.isVisible(n)}onVisibleChange(n){return this._handler.onVisibleChange(n)}getTopLeft(n){return this._handler.getTopLeft(n)}};M_=N8([Tt(),W8("design:paramtypes",[])],M_);var aL=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},lL=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Kx=function(n,t){return function(e,i){t(e,i,n)}};let B_=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(n){this.contributions=n,this.configured=!1,this.global=Mt.global,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,i)=>{this.configured=!1,this.configure(i,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}configure(n,t){this.configured||(this.contributions.getContributions().forEach(e=>{e.configure(this,t)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){const n=Va.shareCanvas();this._canvas=n,this._context=n.getContext("2d")}}bindTextMeasure(n){this._textMeasure=n}measureText(n,t,e="native"){var i;this.configure(this.global,this.global.env);const r=this.global.measureTextMethod;this.global.measureTextMethod=e;const o={width:this._textMeasure.measureTextWidth(n,t),height:(i=t.fontSize)!==null&&i!==void 0?i:Gr.fontSize};return this.global.measureTextMethod=r,o}createTextMeasureInstance(n,t,e){return this.configure(this.global,this.global.env),new ss(Object.assign({defaultFontParams:{fontFamily:Gr.fontFamily,fontSize:Gr.fontSize},getCanvasForMeasure:e||(()=>this.canvas),getTextBounds:void 0,specialCharSet:`-/: .,@%'"~`+ss.ALPHABET_CHAR_SET+ss.ALPHABET_CHAR_SET.toUpperCase()},t??{}),n)}drawGraphicToCanvas(n,t,e){if(!t.defaultLayer)return null;const i=te.get(fd),r=n.AABBBounds,o=r.width(),s=r.height(),a=-r.x1,l=-r.y1;i.create({viewBox:{x1:a,y1:l,x2:r.x2,y2:r.y2},width:o,height:s,canvas:e,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:""});const u=t.params.optimize.disableCheckGraphicWidthOutRange;t.params.optimize.disableCheckGraphicWidthOutRange=!0,t.defaultLayer.getNativeHandler().drawTo(i,[n],{transMatrix:i.getViewBoxTransform(),viewBox:i.getViewBox(),stage:t,layer:t.defaultLayer,renderService:t.renderService,background:"transparent",clear:!0,updateBounds:!1}),t.params.optimize.disableCheckGraphicWidthOutRange=u;const h=i.getNativeHandler();return h.nativeCanvas?h.nativeCanvas:null}};B_=aL([Tt(),Kx(0,ge(ci)),Kx(0,Di(as)),lL("design:paramtypes",[Object])],B_);var Es;(function(n){n[n.transform=0]="transform",n[n.matrix=1]="matrix"})(Es||(Es={}));const Ti=new Xe;let P_=class{constructor(){this.matrix=new Xe}init(n){return this.mode=Es.transform,this.originTransform=n,this.matrix.reset(),this}fromMatrix(n,t){return this.mode=Es.matrix,this.outSourceMatrix=n,this.outTargetMatrix=t,this}scaleMatrix(n,t,e){const i=this.outSourceMatrix;if(Ti.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){const{x:r,y:o}=e;this.outTargetMatrix.translate(r,o),this.outTargetMatrix.scale(n,t),this.outTargetMatrix.translate(-r,-o)}else this.outTargetMatrix.scale(n,t);return this.outTargetMatrix.multiply(Ti.a,Ti.b,Ti.c,Ti.d,Ti.e,Ti.f),this}rotateMatrix(n,t){const e=this.outSourceMatrix;if(Ti.setValue(e.a,e.b,e.c,e.d,e.e,e.f),this.outTargetMatrix.reset(),t){const{x:i,y:r}=t;this.outTargetMatrix.translate(i,r),this.outTargetMatrix.rotate(n),this.outTargetMatrix.translate(-i,-r)}else this.outTargetMatrix.rotate(n);return this.outTargetMatrix.multiply(Ti.a,Ti.b,Ti.c,Ti.d,Ti.e,Ti.f),this}scale(n,t,e){return this.mode===Es.matrix?this.scaleMatrix(n,t,e):this}rotate(n,t){return this.mode===Es.matrix?this.rotateMatrix(n,t):this}translateMatrix(n,t){const e=this.outSourceMatrix;return Ti.setValue(e.a,e.b,e.c,e.d,e.e,e.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(n,t),this.outTargetMatrix.multiply(Ti.a,Ti.b,Ti.c,Ti.d,Ti.e,Ti.f),this}translate(n,t){return this.mode===Es.matrix?this.translateMatrix(n,t):this}simplify(n){return this.mode===Es.matrix?this.simplifyMatrix(n):this}simplifyMatrix(n){return this}};P_=aL([Tt(),lL("design:paramtypes",[])],P_);const cr={arc:J6,area:t8,circle:e8,line:n8,path:o8,symbol:u8,text:Jk,rect:l8,polygon:s8,star:a8,richtext:Zo,richtextIcon:h8,image:dd,group:i8,glyph:r8},uv=Object.keys(cr);function U8(){return{arc:Object.assign({},cr.arc),area:Object.assign({},cr.area),circle:Object.assign({},cr.circle),line:Object.assign({},cr.line),path:Object.assign({},cr.path),symbol:Object.assign({},cr.symbol),text:Object.assign({},cr.text),rect:Object.assign({},cr.rect),polygon:Object.assign({},cr.polygon),star:Object.assign({},cr.star),richtext:Object.assign({},cr.richtext),richtextIcon:Object.assign({},cr.richtextIcon),image:Object.assign({},cr.image),group:Object.assign({},cr.group),glyph:Object.assign({},cr.glyph)}}function jc(n,t){Object.keys(t).forEach(e=>{n[e]=t[e]})}const Zx=U8();class gd{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},uv.forEach(t=>{this._defaultTheme[t]=Object.create(Zx[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;let e={};const i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,i=!1){if(this.dirty){const r=this.getParentWithTheme(t);if(r){const o=r.theme;(o.dirty||i)&&o.applyTheme(r,e,!0)}this.userTheme?this.doCombine(r&&r.theme.combinedTheme):(r?this.combinedTheme=r.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Er.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}doCombine(t){const e=this.userTheme,i=this.combinedTheme;uv.forEach(r=>{const o=Object.create(Zx[r]);t&&t[r]&&jc(o,t[r]),i[r]&&jc(o,i[r]),e[r]&&jc(o,e[r]),this.combinedTheme[r]=o}),e.common&&uv.forEach(r=>{jc(this.combinedTheme[r],e.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(r=>{i[r]?Object.assign(i[r],t[r]):i[r]=Object.assign({},t[r])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(e=>{e.isContainer&&(e.theme&&(e.theme.dirty=!0),this.dirtyChildren(e))})}}const uL=new gd;function ae(n,t){return n.glyphHost?ae(n.glyphHost):t?(n.isContainer,t):V8(n)||n.attachedThemeGraphic&&ae(n.attachedThemeGraphic)||uL.getTheme()}function V8(n){let t;if(t=n.isContainer?n:n.parent,t){for(;t&&!t.theme;)t=t.parent;return t?(t.theme||t.createTheme(),t.theme.getTheme(t)):uL.getTheme()}return null}var j8=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};class G8 extends ol{get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=bi.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let i=this._lastChild,r=0;for(;i;){if(t(i,r++))return;i=i._prev}}else{let i=this._firstChild,r=0;for(;i;){if(t(i,r++))return;i=i._next}}}forEachChildrenAsync(t,e=!1){return j8(this,void 0,void 0,function*(){if(e){let i=this._lastChild,r=0;for(;i;){let o=t(i,r++);if(o.then&&(o=yield o),o)return;i=i._prev}}else{let i=this._firstChild,r=0;for(;i;){let o=t(i,r++);if(o.then&&(o=yield o),o)return;i=i._next}}})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return console.error("暂不支持该函数"),t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&Er.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,e===0)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let i=this._firstChild;for(let r=0;r<e;r++){if(!i)return null;r>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){const o=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,o)}let i;this._nodeList[e]=t;for(let o=e-1;o>=0&&(i=this._nodeList[o],!i);o--);if(i)return i._next?this.insertBefore(t,i._next):this.appendChild(t);this._ignoreWarn=!0;const r=this.insertInto(t,0);return this._ignoreWarn=!1,r}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){const e=this._nodeList.findIndex(i=>i===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){const i=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=i}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw new Error("暂不支持")}find(t,e=!1){let i=null;return this.forEachChildren((r,o)=>!(r===this||!t(r,o))&&(i=r,!0)),e&&this.forEachChildren(r=>{if(r.isContainer){const o=r.find(t,!0);if(o)return i=o,!0}return!1}),i}findAll(t,e=!1){let i=[];return this.forEachChildren((r,o)=>{r!==this&&t(r,o)&&i.push(r)}),e&&this.forEachChildren(r=>{if(r.isContainer){const o=r.findAll(t,!0);o.length&&(i=i.concat(o))}}),i}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(i=>i.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;t!=null&&t.parent;)t=t.parent;return t||this}hasChildNodes(){return this._firstChild!==null}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){const t=[];let e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(e!==null);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw new Error("暂不支持")}setAllDescendantsProps(t,e){let i=this._firstChild;for(;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(e!==null)}clone(){throw new Error("暂不支持")}cloneTo(t){throw new Error("暂不支持")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,i){const r=cs(i,!0)&&i||$i(i)&&i.capture,o=$i(i)&&i.once,s=Ce(e)?void 0:e;return t=r?`${t}capture`:t,e=Ce(e)?e:e.handleEvent,o?super.once(t,e,s):super.on(t,e,s),this}on(t,e,i){return this.addEventListener(t,e,i)}removeEventListener(t,e,i){const r=cs(i,!0)&&i||$i(i)&&i.capture,o=Ce(e)?void 0:e;t=r?`${t}capture`:t,e=Ce(e)?e:e.handleEvent;const s=$i(i)&&i.once;return super.off(t,e,o,s),this}off(t,e,i){return this.removeEventListener(t,e,i)}once(t,e,i){return $i(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}}class Gd{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Gd.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){const e=t.graphic;if(e.stage){const i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch{this.nativeEvent.preventDefault&&Ce(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch{this.nativeEvent.stopPropagation&&Ce(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw new Error("Method not implemented.")}}class fg extends Gd{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,o,s,a,l,u,h,d,c,f,g,m){throw new Error("Method not implemented.")}}class tn extends fg{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}clone(){var t,e,i;const r=new tn(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,(t=this.manager)===null||t===void 0||t.copyPointerData(this,r),(e=this.manager)===null||e===void 0||e.copyMouseData(this,r),(i=this.manager)===null||i===void 0||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();const o=this.composedDetailPath();return r.detailPath=o&&o.slice(),r.type=this.type,r}}class Ns extends fg{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,i;const r=new Ns(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,(t=this.manager)===null||t===void 0||t.copyWheelData(this,r),(e=this.manager)===null||e===void 0||e.copyMouseData(this,r),(i=this.manager)===null||i===void 0||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();const o=this.composedDetailPath();return r.detailPath=o&&o.slice(),r.type=this.type,r}}Ns.DOM_DELTA_PIXEL=0,Ns.DOM_DELTA_LINE=1,Ns.DOM_DELTA_PAGE=2;class vw extends Gd{constructor(t,e){super(),this.type=t,this.detail=e}}const hL="*",ka=typeof performance=="object"&&performance.now?performance:Date;function ys(n){return n==="mouse"||n==="pen"}let $8=class{constructor(t,e){this.dispatch=new ol,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(i,r)=>{if(!(i instanceof tn))return void Er.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const o=this.createPointerEvent(i,i.type,r);if(this.dispatchEvent(o,"pointerdown"),o.pointerType==="touch")this.dispatchEvent(o,"touchstart");else if(ys(o.pointerType)){const s=o.button===2;this.dispatchEvent(o,s?"rightdown":"mousedown")}this.trackingData(i.pointerId).pressTargetsByButton[i.button]=o.composedPath(),this.freeEvent(o)},this.onPointerMove=(i,r)=>{var o,s;if(!(i instanceof tn))return void Er.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const a=this.createPointerEvent(i,i.type,r),l=ys(a.pointerType),u=this.trackingData(i.pointerId),h=this.findMountedTarget(u.overTargets);if(u.overTargets&&h&&h!==this.rootTarget&&h!==a.target){const d=i.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(i,d,h||void 0);if(this.dispatchEvent(c,"pointerout"),l&&this.dispatchEvent(c,"mouseout"),!a.composedPath().includes(h)){const f=this.createPointerEvent(i,"pointerleave",h||void 0);for(f.eventPhase=f.AT_TARGET;f.target&&!a.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),l&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}if(h!==a.target){const d=i.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(a,d);this.dispatchEvent(c,"pointerover"),l&&this.dispatchEvent(c,"mouseover");let f=h==null?void 0:h.parent;for(;f&&f!==this.rootTarget.parent&&f!==a.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const g=this.clonePointerEvent(a,"pointerenter");g.eventPhase=g.AT_TARGET;let m=g.target;const p=new Set;let v=h;for(;v&&v!==this.rootTarget;)p.add(v),v=v.parent;for(;m&&m!==h&&m!==this.rootTarget.parent;)p.has(m)||(g.currentTarget=m,this.notifyTarget(g),l&&this.notifyTarget(g,"mouseenter")),m=m.parent;this.freeEvent(g)}this.freeEvent(c)}this.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&this.dispatchEvent(a,"touchmove"),l&&(this.dispatchEvent(a,"mousemove"),this.cursorTarget=a.target,this.cursor=((s=(o=a.target)===null||o===void 0?void 0:o.attribute)===null||s===void 0?void 0:s.cursor)||this.rootTarget.getCursor()),u.overTargets=a.composedPath(),this.freeEvent(a)},this.onPointerOver=(i,r)=>{var o,s;if(!(i instanceof tn))return void Er.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const a=this.trackingData(i.pointerId),l=this.createPointerEvent(i,i.type,r),u=ys(l.pointerType);this.dispatchEvent(l,"pointerover"),u&&this.dispatchEvent(l,"mouseover"),l.pointerType==="mouse"&&(this.cursorTarget=l.target,this.cursor=((s=(o=l.target)===null||o===void 0?void 0:o.attribute)===null||s===void 0?void 0:s.cursor)||this.rootTarget.getCursor());const h=this.clonePointerEvent(l,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),u&&this.notifyTarget(h,"mouseenter"),h.target=h.target.parent;a.overTargets=l.composedPath(),this.freeEvent(l),this.freeEvent(h)},this.onPointerOut=(i,r)=>{if(!(i instanceof tn))return void Er.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const o=this.trackingData(i.pointerId);if(o.overTargets){const s=ys(i.pointerType),a=this.findMountedTarget(o.overTargets),l=this.createPointerEvent(i,"pointerout",a||void 0);this.dispatchEvent(l),s&&this.dispatchEvent(l,"mouseout");const u=this.createPointerEvent(i,"pointerleave",a||void 0);for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==this.rootTarget.parent;)u.currentTarget=u.target,this.notifyTarget(u),s&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;o.overTargets=[],this.freeEvent(l),this.freeEvent(u)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(i,r)=>{var o;if(!(i instanceof tn))return void Er.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const s=ka.now(),a=this.createPointerEvent(i,i.type,r);if(this.dispatchEvent(a,"pointerup"),a.pointerType==="touch")this.dispatchEvent(a,"touchend");else if(ys(a.pointerType)){const d=a.button===2;this.dispatchEvent(a,d?"rightup":"mouseup")}const l=this.trackingData(i.pointerId),u=this.findMountedTarget(l.pressTargetsByButton[i.button]);let h=u;if(u&&!a.composedPath().includes(u)){let d=u;for(;d&&!a.composedPath().includes(d);){if(a.currentTarget=d,this.notifyTarget(a,"pointerupoutside"),a.pointerType==="touch")this.notifyTarget(a,"touchendoutside");else if(ys(a.pointerType)){const c=a.button===2;this.notifyTarget(a,c?"rightupoutside":"mouseupoutside")}d=d.parent}delete l.pressTargetsByButton[i.button],h=d}if(h){const d=this.clonePointerEvent(a,"click");d.target=h,d.path=[],d.detailPath=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:s});const c=l.clicksByButton[i.button];c.target===d.target&&s-c.timeStamp<((o=this._config.clickInterval)!==null&&o!==void 0?o:200)?++c.clickCount:c.clickCount=1,c.target=d.target,c.timeStamp=s,d.detail=c.clickCount,ys(d.pointerType)?(this.dispatchEvent(d,"click"),c.clickCount===2&&this.dispatchEvent(d,"dblclick")):d.pointerType==="touch"&&this._config.supportsTouchEvents&&(this.dispatchEvent(d,"tap"),c.clickCount===2&&this.dispatchEvent(d,"dbltap")),this.dispatchEvent(d,"pointertap"),this.freeEvent(d)}this.freeEvent(a)},this.onPointerUpOutside=(i,r)=>{if(!(i instanceof tn))return void Er.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const o=this.trackingData(i.pointerId),s=this.findMountedTarget(o.pressTargetsByButton[i.button]),a=this.createPointerEvent(i,i.type,r);if(s){let l=s;for(;l;)a.currentTarget=l,this.notifyTarget(a,"pointerupoutside"),a.pointerType==="touch"?this.notifyTarget(a,"touchendoutside"):ys(a.pointerType)&&this.notifyTarget(a,a.button===2?"rightupoutside":"mouseupoutside"),l=l.parent;delete o.pressTargetsByButton[i.button]}this.freeEvent(a)},this.onWheel=(i,r)=>{if(!(i instanceof Ns))return void Er.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");const o=this.createWheelEvent(i,r);this.dispatchEvent(o),this.freeEvent(o)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,r)=>i.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,i,r,o,s,a,l;if(!this.rootTarget)return;const u=this.mappingTable[t.type];let h;const d=`${t.canvasX}-${t.canvasY}`;if(!((e=this._prePointTargetCache)===null||e===void 0)&&e[d]&&(!((r=(i=this._prePointTargetCache)===null||i===void 0?void 0:i[d])===null||r===void 0)&&r.stage)&&((s=(o=this._prePointTargetCache)===null||o===void 0?void 0:o[d])===null||s===void 0?void 0:s.stage.renderCount)===((a=this._prePointTargetCache)===null||a===void 0?void 0:a.stageRenderCount)?h=this._prePointTargetCache[d]:(h=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[d]:h,stageRenderCount:(l=h==null?void 0:h.stage.renderCount)!==null&&l!==void 0?l:-1})),u)for(let c=0,f=u.length;c<f;c++)u[c].fn(t,h);else Er.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,o=i.length-1;r<o;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){const e=[t];for(let i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=e??t.type;const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){var r,o;const s=this.allocateEvent(tn);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i||this.pickTarget((r=s.viewX)!==null&&r!==void 0?r:s.global.x,(o=s.viewY)!==null&&o!==void 0?o:s.global.y,s),typeof e=="string"&&(s.type=e),s}createWheelEvent(t,e){var i,r;const o=this.allocateEvent(Ns);return this.copyWheelData(t,o),this.copyMouseData(t,o),this.copyData(t,o),o.nativeEvent=t.nativeEvent,o.originalEvent=t,o.target=e||this.pickTarget((i=o.viewX)!==null&&i!==void 0?i:o.global.x,(r=o.viewY)!==null&&r!==void 0?r:o.global.y,o),o}clonePointerEvent(t,e){const i=this.allocateEvent(tn);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();const r=t.composedDetailPath();return i.detailPath=r&&r.slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof tn&&e instanceof tn&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof fg&&e instanceof fg&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(i=>{e[i].x=t[i].x,e[i].y=t[i].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=ka.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);const i=((e=this.eventPool.get(t))===null||e===void 0?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}freeEvent(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");const i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),(e=this.eventPool.get(i))===null||e===void 0||e.push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(let r=0,o=i.length;r<o&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeEventListener(e,i[r].fn,{once:!0}),i[r].fn.call(i[r].context,t);this.emitDelegation(t,e)}emitDelegation(t,e){const i=t.currentTarget._events[hL];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(let r=0,o=i.length;r<o&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t,e)}pickTarget(t,e,i){let r;const o=this.rootTarget.pick(t,e);return r=o&&o.graphic?o.graphic:o&&o.group?o.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=o.params),r}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}};const q8={dispatchEvent(n){var t;if(!(n instanceof Gd))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=[],n.detailPath&&(n.detailPath=[]),n.target=this,(t=n==null?void 0:n.manager)===null||t===void 0||t.dispatchEvent(n),!n.defaultPrevented},emit(n,t){return this.dispatchEvent(new vw(n,t))}},X8={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class Y8{constructor(t){this.resolution=1,this.onPointerDown=h=>{if(this.supportsTouchEvents&&h.pointerType==="touch")return;const d=this.normalizeToPointerData(h);this.autoPreventDefault&&d[0].isNormalized&&(h.cancelable||!("cancelable"in h))&&h.preventDefault();for(let c=0,f=d.length;c<f;c++){const g=d[c],m=this.bootstrapEvent(this.rootPointerEvent,g);this.manager.mapEvent(m)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=h=>{if(this.supportsTouchEvents&&h.pointerType==="touch"||this.isEventOutsideOfTargetElement(h))return;const d=this.normalizeToPointerData(h);for(let c=0,f=d.length;c<f;c++){const g=this.bootstrapEvent(this.rootPointerEvent,d[c]);this.manager.mapEvent(g)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=h=>{if(this.supportsTouchEvents&&h.pointerType==="touch")return;const d=this.isEventOutsideOfTargetViewPort(h)?"outside":"",c=this.normalizeToPointerData(h);for(let f=0,g=c.length;f<g;f++){const m=this.bootstrapEvent(this.rootPointerEvent,c[f]);m.type+=d,this.manager.mapEvent(m)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=h=>{if(this.supportsTouchEvents&&h.pointerType==="touch")return;const d=this.normalizeToPointerData(h);for(let c=0,f=d.length;c<f;c++){const g=this.bootstrapEvent(this.rootPointerEvent,d[c]);this.manager.mapEvent(g)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=h=>{const d=this.normalizeWheelEvent(h);this.manager.mapEvent(d)};const{targetElement:e,resolution:i,rootNode:r,global:o,autoPreventDefault:s=!1,clickInterval:a,supportsTouchEvents:l=o.supportsTouchEvents,supportsPointerEvents:u=o.supportsPointerEvents}=t;this.manager=new $8(r,{clickInterval:a,supportsTouchEvents:l}),this.globalObj=o,this.supportsPointerEvents=u,this.supportsTouchEvents=l,this.supportsMouseEvents=o.supportsMouseEvents,this.applyStyles=o.applyStyles,this.autoPreventDefault=s,this.eventsAdded=!1,this.rootPointerEvent=new tn,this.rootWheelEvent=new Ns,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=i,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");const{applyStyles:i,domElement:r}=this;if(this.currentCursor===t)return;this.currentCursor=t;const o=this.cursorStyles[t];o?typeof o=="string"&&i?r.style.cursor=o:typeof o=="function"?o(t):typeof o=="object"&&i&&Object.assign(r.style,o):i&&lr(t)&&!H4(this.cursorStyles,t)&&(r.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,i;const r=(e=this.globalObj)===null||e===void 0?void 0:e.mapToCanvasPoint(t,this.domElement);if(r)return r;let o=0,s=0;if(t.changedTouches){const l=(i=t.changedTouches[0])!==null&&i!==void 0?i:{};o=l.clientX||0,s=l.clientY||0}else o=t.clientX||0,s=t.clientY||0;const a=this.domElement.getBoundingClientRect();return{x:o-a.left,y:s-a.top}}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let i=0,r=t.changedTouches.length;i<r;i++){const o=t.changedTouches[i];oi(o.button)&&(o.button=0),oi(o.buttons)&&(o.buttons=1),oi(o.isPrimary)&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),oi(o.width)&&(o.width=o.radiusX||1),oi(o.height)&&(o.height=o.radiusY||1),oi(o.tiltX)&&(o.tiltX=0),oi(o.tiltY)&&(o.tiltY=0),oi(o.pointerType)&&(o.pointerType="touch"),oi(o.pointerId)&&(o.pointerId=o.identifier||0),oi(o.pressure)&&(o.pressure=o.force||.5),oi(o.twist)&&(o.twist=0),oi(o.tangentialPressure)&&(o.tangentialPressure=0),oi(o.layerX)&&(o.layerX=o.offsetX=o.clientX),oi(o.layerY)&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=t.type,e.push(o)}else if(this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent))e.push(t);else{const i=t;oi(i.isPrimary)&&(i.isPrimary=!0),oi(i.width)&&(i.width=1),oi(i.height)&&(i.height=1),oi(i.tiltX)&&(i.tiltX=0),oi(i.tiltY)&&(i.tiltY=0),oi(i.pointerType)&&(i.pointerType="mouse"),oi(i.pointerId)&&(i.pointerId=1),oi(i.pressure)&&(i.pressure=.5),oi(i.twist)&&(i.twist=0),oi(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;const{x:i,y:r}=this.mapToCanvasPoint(t);e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r;const{x:o,y:s}=this.mapToViewportPoint(e);return e.viewport.x=o,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:i,y:r}=this.mapToCanvasPoint(e);t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r;const{x:o,y:s}=this.mapToViewportPoint(t);return t.viewport.x=o,t.viewport.y=s,t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=X8[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=ka.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){const e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),r=i.width(),o=i.height();return!(e.x<r&&e.y<o&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}class Oe{static GetImage(t,e){var i;const r=Oe.cache.get(t);r?r.loadState==="fail"?Mt.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):r.loadState==="init"||r.loadState==="loading"?(i=r.waitingMark)===null||i===void 0||i.push(e):e&&e.imageLoadSuccess(t,r.data):Oe.loadImage(t,e)}static GetSvg(t,e){var i;let r=Oe.cache.get(t);r?r.loadState==="fail"?Mt.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):r.loadState==="init"||r.loadState==="loading"?(i=r.waitingMark)===null||i===void 0||i.push(e):e&&e.imageLoadSuccess(t,r.data):(r={type:"image",loadState:"init"},Oe.cache.set(t,r),r.dataPromise=Mt.global.loadSvg(t),r.dataPromise?(r.waitingMark=[e],r.dataPromise.then(o=>{var s;r.loadState=o!=null&&o.data?"success":"fail",r.data=o==null?void 0:o.data,(s=r.waitingMark)===null||s===void 0||s.map((a,l)=>{o!=null&&o.data?(r.loadState="success",r.data=o.data,a.imageLoadSuccess(t,o.data)):(r.loadState="fail",a.imageLoadFail(t))}),r.waitingMark&&(r.waitingMark=[])})):(r.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let i=Oe.cache.get(t);return i?i.loadState==="fail"?Promise.reject():i.loadState==="init"||i.loadState==="loading"?i.dataPromise.then(r=>r.data):Promise.resolve(i.data):(i={type:e,loadState:"init"},Oe.cache.set(t,i),e==="arrayBuffer"?i.dataPromise=Mt.global.loadArrayBuffer(t):e==="blob"?i.dataPromise=Mt.global.loadBlob(t):e==="json"&&(i.dataPromise=Mt.global.loadJson(t)),i.dataPromise.then(r=>r.data))}static loading(){setTimeout(()=>{if(!Oe.isLoading&&Oe.toLoadAueue.length){Oe.isLoading=!0;const t=Oe.toLoadAueue.splice(0,10),e=[];t.forEach(i=>{const{url:r,marks:o}=i,s={type:"image",loadState:"init"};if(Oe.cache.set(r,s),s.dataPromise=Mt.global.loadImage(r),s.dataPromise){s.waitingMark=o;const a=s.dataPromise.then(l=>{var u;s.loadState=l!=null&&l.data?"success":"fail",s.data=l==null?void 0:l.data,(u=s.waitingMark)===null||u===void 0||u.map((h,d)=>{l!=null&&l.data?(s.loadState="success",s.data=l.data,h.imageLoadSuccess(r,l.data)):(s.loadState="fail",h.imageLoadFail(r))}),s.waitingMark&&(s.waitingMark=[])});e.push(a)}else s.loadState="fail",o.forEach(a=>a.imageLoadFail(r))}),Promise.all(e).then(()=>{Oe.isLoading=!1,this.onLoadSuccessCb.forEach(i=>i()),Oe.loading()}).catch(i=>{console.error(i),Oe.isLoading=!1,this.onLoadSuccessCb.forEach(r=>r()),Oe.loading()})}},0)}static loadImage(t,e){const i=Qx(t,Oe.toLoadAueue);if(i!==-1)return Oe.toLoadAueue[i].marks.push(e),void Oe.loading();Oe.toLoadAueue.push({url:t,marks:[e]}),Oe.loading()}static improveImageLoading(t){const e=Qx(t,Oe.toLoadAueue);if(e!==-1){const i=Oe.toLoadAueue.splice(e,1);Oe.toLoadAueue.unshift(i[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function Qx(n,t){for(let e=0;e<t.length;e++)if(t[e].url===n)return e;return-1}Oe.cache=new Map,Oe.isLoading=!1,Oe.toLoadAueue=[],Oe.onLoadSuccessCb=[];var Jx;(function(n){n[n.Top=1]="Top",n[n.Right=2]="Right",n[n.Bottom=4]="Bottom",n[n.Left=8]="Left",n[n.ALL=15]="ALL"})(Jx||(Jx={}));const Uo=[!1,!1,!1,!1],K8=n=>{var t;let e=!0;if(cs(n,!0)){for(let i=0;i<4;i++)Uo[i]=n,e&&(e=!((t=Uo[i])!==null&&t!==void 0&&!t));e=n}else if(Array.isArray(n))for(let i=0;i<4;i++)Uo[i]=!!n[i],e&&(e=!!Uo[i]);else Uo[0]=!1,Uo[1]=!1,Uo[2]=!1,Uo[3]=!1;return{isFullStroke:e,stroke:Uo}},sh=[0,0,0,0],gg=n=>n?jt(n)?n.length===0?0:n.length===1?n[0]:n.length===2?(sh[0]=n[0],sh[2]=n[0],sh[1]=n[1],sh[3]=n[1],sh):n:n:0,ml=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],Gc=[1,2,3,0,1,2,3,0];function k_(n,t,e,i){for(;n>=Zt;)n-=Zt;for(;n<0;)n+=Zt;for(;n>t;)t+=Zt;ml[0].x=e,ml[1].y=e,ml[2].x=-e,ml[3].y=-e;const r=Math.ceil(n/En)%4,o=Math.ceil(t/En)%4;if(i.add(Ei(n)*e,ti(n)*e),i.add(Ei(t)*e,ti(t)*e),r!==o||t-n>Ae){let s=!1;for(let a=0;a<Gc.length;a++)if(s||r!==Gc[a]){if(s&&o===Gc[a])break;if(s){const l=ml[Gc[a]];i.add(l.x,l.y)}}else{s=!0;const l=ml[r];i.add(l.x,l.y)}}}function L_(n,t,e){const{x:i,y:r}=kx(n.x,n.y,t.x,t.y,e),{x:o,y:s}=kx(n.x1,n.y1,t.x1,t.y1,e),a=new ze(i,r,o,s);return a.defined=t.defined,a}function bw(n,t,e){if(!n||!t)return[];Array.isArray(n)||(n=[n]),Array.isArray(t)||(t=[t]);let i=[];if(n.length>t.length){i=t.map(r=>{const o=new ze(r.x,r.y,r.x1,r.y1);return o.defined=r.defined,o});for(let r=0;r<t.length;r++)i[r]=L_(n[r],t[r],e)}else{i=t.map(r=>{const o=new ze(r.x,r.y,r.x1,r.y1);return o.defined=r.defined,o});for(let r=0;r<n.length;r++)i[r]=L_(n[r],t[r],e)}return i}function $c(n,t){if(jt(n)){let e;for(let i=0;i<n.length&&e===void 0;i++)e=n[i][t];return e}return n[t]}class Mm{constructor(t=Mm.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((e,i)=>e+i,0)/this.durations.length,1e3/60),1e3/30)}}Mm.TimeOut=1e3/60;const tT=new Mm,Z8=(n,t)=>lr(n)&&n[n.length-1]==="%"?t*(Number.parseFloat(n.substring(0,n.length-1))/100):n,$d=(n,t)=>{const e=Z8(n,t);return isNaN(e)?e:Math.max(t,e)};class _i{bounds(t,e){if(ne(t)){const i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}parseSize(t){return ne(t)?t:Math.min(t[0],t[1])}}function eT(n,t,e,i,r){return r?n.arc(e,i,t,0,nr,!1,r):n.arc(e,i,t,0,nr),!1}class Q8 extends _i{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,i,r,o){return eT(t,this.parseSize(e)/2,i,r,o)}drawOffset(t,e,i,r,o,s){return eT(t,this.parseSize(e)/2+o,i,r,s)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e-o}, ${i} a ${o},${o} 0 1,0 ${2*o},0 a ${o},${o} 0 1,0 -${2*o},0`}}const J8=new Q8;function tU(n,t,e,i,r){return n.moveTo(-3*t+e,-t+i,r),n.lineTo(-t+e,-t+i,r),n.lineTo(-t+e,-3*t+i,r),n.lineTo(t+e,-3*t+i,r),n.lineTo(t+e,-t+i,r),n.lineTo(3*t+e,-t+i,r),n.lineTo(3*t+e,t+i,r),n.lineTo(t+e,t+i,r),n.lineTo(t+e,3*t+i,r),n.lineTo(-t+e,3*t+i,r),n.lineTo(-t+e,t+i,r),n.lineTo(-3*t+e,t+i,r),n.closePath(),!0}function eU(n,t,e,i,r,o){return n.moveTo(-3*t+e-r,-t+i-r,o),n.lineTo(-t+e-r,-t+i-r,o),n.lineTo(-t+e-r,-3*t+i-r,o),n.lineTo(t+e+r,-3*t+i-r,o),n.lineTo(t+e+r,-t+i-r,o),n.lineTo(3*t+e+r,-t+i-r,o),n.lineTo(3*t+e+r,t+i+r,o),n.lineTo(t+e+r,t+i+r,o),n.lineTo(t+e+r,3*t+i+r,o),n.lineTo(-t+e-r,3*t+i+r,o),n.lineTo(-t+e-r,t+i+r,o),n.lineTo(-3*t+e-r,t+i+r,o),n.closePath(),!0}class iU extends _i{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,i,r,o){return tU(t,this.parseSize(e)/6,i,r,o)}drawOffset(t,e,i,r,o,s){return eU(t,this.parseSize(e)/6,i,r,o,s)}}const rU=new iU;function hv(n,t,e,i,r){return n.moveTo(e,i-t,r),n.lineTo(t+e,i,r),n.lineTo(e,i+t,r),n.lineTo(e-t,i,r),n.closePath(),!0}class nU extends _i{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,i,r,o){return hv(t,this.parseSize(e)/2,i,r,o)}drawFitDir(t,e,i,r,o){return hv(t,this.parseSize(e)/2,i,r,o)}drawOffset(t,e,i,r,o,s){return hv(t,this.parseSize(e)/2+o,i,r,s)}}const oU=new nU;function iT(n,t,e,i){const r=2*t;return n.rect(e-t,i-t,r,r),!1}class sU extends _i{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,i,r){return iT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return iT(t,this.parseSize(e)/2+o,i,r)}}const aU=new sU;function rT(n,t,e,i,r=0){return n.moveTo(e+t+2*r,t+i+r),n.lineTo(e-t-2*r,t+i+r),n.lineTo(e,i-t-2*r),n.closePath(),!0}class dL extends _i{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,i,r){return rT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return rT(t,this.parseSize(e)/2,i,r,o)}}const lU=new dL;class uU extends dL{constructor(){super(...arguments),this.type="triangle"}}const hU=new uU,cL=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),dU=Math.sin(nr/10)*cL,cU=-Math.cos(nr/10)*cL;function nT(n,t,e,i){const r=dU*t,o=cU*t;n.moveTo(e,-t+i),n.lineTo(r+e,o+i);for(let s=1;s<5;++s){const a=nr*s/5,l=Math.cos(a),u=Math.sin(a);n.lineTo(u*t+e,-l*t+i),n.lineTo(l*r-u*o+e,u*r+l*o+i)}return n.closePath(),!0}class fU extends _i{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,i,r){return nT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return nT(t,this.parseSize(e)/2+o,i,r)}}const gU=new fU,pU=Zn(3);function oT(n,t,e,i){const r=t,o=r/pU,s=o/5,a=t;return n.moveTo(0+e,-r+i),n.lineTo(o/2+e,i),n.lineTo(s/2+e,i),n.lineTo(s/2+e,a+i),n.lineTo(-s/2+e,a+i),n.lineTo(-s/2+e,i),n.lineTo(-o/2+e,i),n.closePath(),!0}class mU extends _i{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,i,r){return oT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return oT(t,this.parseSize(e)/2+o,i,r)}}const vU=new mU;function sT(n,t,e,i){const r=2*t;return n.moveTo(e,-t+i),n.lineTo(r/3/2+e,t+i),n.lineTo(-r/3/2+e,t+i),n.closePath(),!0}class bU extends _i{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,i,r){return sT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return sT(t,this.parseSize(e)/2+o,i,r)}}const _U=new bU;function aT(n,t,e,i){return n.moveTo(-t+e,i),n.lineTo(e,t+i),!1}class CU extends _i{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,i,r){return aT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return aT(t,this.parseSize(e)/2+o,i,r)}}const yU=new CU,_n=-.5,Cn=Zn(3)/2,lT=1/Zn(12);function uT(n,t,e,i){const r=t/2,o=t*lT,s=r,a=t*lT+t,l=-s,u=a;return n.moveTo(r+e,o+i),n.lineTo(s+e,a+i),n.lineTo(l+e,u+i),n.lineTo(_n*r-Cn*o+e,Cn*r+_n*o+i),n.lineTo(_n*s-Cn*a+e,Cn*s+_n*a+i),n.lineTo(_n*l-Cn*u+e,Cn*l+_n*u+i),n.lineTo(_n*r+Cn*o+e,_n*o-Cn*r+i),n.lineTo(_n*s+Cn*a+e,_n*a-Cn*s+i),n.lineTo(_n*l+Cn*u+e,_n*u-Cn*l+i),n.closePath(),!1}class wU extends _i{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,i,r){return uT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return uT(t,this.parseSize(e)/2+o,i,r)}}const SU=new wU;function hT(n,t,e,i,r){return n.moveTo(-t+e-2*r,i),n.lineTo(t+e+r,t+i+2*r),n.lineTo(t+e+r,i-t-2*r),n.closePath(),!0}class xU extends _i{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,i,r){return hT(t,this.parseSize(e)/2,i,r,0)}drawOffset(t,e,i,r,o){return hT(t,this.parseSize(e)/2,i,r,o)}}const TU=new xU;function dT(n,t,e,i,r=0){return n.moveTo(e-t-r,t+i+2*r),n.lineTo(t+e+2*r,i),n.lineTo(e-t-r,i-t-2*r),n.closePath(),!0}class AU extends _i{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,i,r){return dT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return dT(t,this.parseSize(e)/2,i,r,o)}}const RU=new AU;function cT(n,t,e,i,r=0){return n.moveTo(e-t-2*r,i-t-r),n.lineTo(e+t+2*r,i-t-r),n.lineTo(e,i+t+2*r),n.closePath(),!0}class EU extends _i{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,i,r){return cT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return cT(t,this.parseSize(e)/2,i,r,o)}}const MU=new EU,D_=Zn(3);function fT(n,t,e,i){const r=t*D_;return n.moveTo(e,i+-r/3*2),n.lineTo(t+e,i+r),n.lineTo(e-t,i+r),n.closePath(),!0}class BU extends _i{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,i,r){return fT(t,this.parseSize(e)/2/D_,i,r)}drawOffset(t,e,i,r,o){return fT(t,this.parseSize(e)/2/D_+o,i,r)}}const PU=new BU;function gT(n,t,e,i){const r=2*t;return n.moveTo(t+e,i-r),n.lineTo(e-t,i),n.lineTo(t+e,r+i),!0}class kU extends _i{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,i,r){return gT(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return gT(t,this.parseSize(e)/4+o,i,r)}}const LU=new kU;function pT(n,t,e,i){const r=2*t;return n.moveTo(e-t,i-r),n.lineTo(e+t,i),n.lineTo(e-t,r+i),!0}class DU extends _i{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,i,r){return pT(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return pT(t,this.parseSize(e)/4+o,i,r)}}const IU=new DU;function mT(n,t,e,i){const r=2*t;return n.moveTo(e-r,i+t),n.lineTo(e,i-t),n.lineTo(e+r,i+t),!0}class FU extends _i{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,i,r){return mT(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return mT(t,this.parseSize(e)/4+o,i,r)}}const OU=new FU;function vT(n,t,e,i){const r=2*t;return n.moveTo(e-r,i-t),n.lineTo(e,i+t),n.lineTo(e+r,i-t),!0}class HU extends _i{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,i,r){return vT(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return vT(t,this.parseSize(e)/4+o,i,r)}}const zU=new HU;function bT(n,t,e,i,r){return n.moveTo(e,i-t),n.lineTo(e,i+t),!0}class NU extends _i{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,i,r,o){return bT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o,s){return bT(t,this.parseSize(e)/2+o,i,r)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e}, ${i-o} L ${e},${i+o}`}}const WU=new NU;function _T(n,t,e,i,r){return n.moveTo(e-t,i),n.lineTo(e+t,i),!0}class UU extends _i{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,i,r,o){return _T(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o,s){return _T(t,this.parseSize(e)/2+o,i,r)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e-o}, ${i} L ${e+o},${i}`}}const VU=new UU;function CT(n,t,e,i,r){return n.moveTo(e-t,i-t),n.lineTo(e+t,i+t),n.moveTo(e+t,i-t),n.lineTo(e-t,i+t),!0}class jU extends _i{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,i,r,o){return CT(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o,s){return CT(t,this.parseSize(e)/2+o,i,r)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e-o}, ${i-o} L ${e+o},${i+o} M ${e+o}, ${i-o} L ${e-o},${i+o}`}}const GU=new jU;function yT(n,t,e,i){return n.rect(e-t[0]/2,i-t[1]/2,t[0],t[1]),!1}function wT(n,t,e,i){const r=t,o=t/2;return n.rect(e-r/2,i-o/2,r,o),!1}class $U extends _i{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,i,r){return ne(e)?wT(t,e,i,r):yT(t,e,i,r)}drawWithClipRange(t,e,i,r,o,s,a){ne(e)&&(e=[e,e/2]);const l=2*(e[0]+e[1])*o,u=[{x:i+e[0]/2,y:r-e[1]/2},{x:i+e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r-e[1]/2}];let h=0,d=u[3];t.moveTo(d.x,d.y);for(let c=0;c<u.length;c++){const f=u[c],g=Math.sqrt((f.x-d.x)*(f.x-d.x)+(f.y-d.y)*(f.y-d.y));if(h+g>l){const m=(f.x-d.x)*(l-h)/g,p=(f.y-d.y)*(l-h)/g;t.lineTo(d.x+m,d.y+p);break}t.lineTo(f.x,f.y),d=f,h+=g}return!1}drawOffset(t,e,i,r,o){return ne(e)?wT(t,e+2*o,i,r):yT(t,[e[0]+2*o,e[1]+2*o],i,r)}}const qU=new $U,ah=new Ye;class ST{constructor(t,e,i=!1){this.pathStr="",this.type=t,jt(e)?this.svgCache=e:this.path=e,this.isSvg=i}drawOffset(t,e,i,r,o,s,a){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(l=>{t.beginPath(),fs(l.path.commandList,t,i,r,e,e),a&&a(l.path,l.attribute)}),!1):(fs(this.path.commandList,t,i,r,e+o,e+o),!1)}draw(t,e,i,r,o,s){return e=this.parseSize(e),this.drawOffset(t,e,i,r,0,o,s)}parseSize(t){return ne(t)?t:Math.min(t[0],t[1])}drawWithClipRange(t,e,i,r,o,s,a){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(l=>{l.path.drawWithClipRange(t,e,i,r,o),a&&a(l.path,l.attribute)}),!1):(this.path.drawWithClipRange(t,e,i,r,o),!1)}bounds(t,e){if(t=this.parseSize(t),this.isSvg)return this.svgCache?(e.clear(),void this.svgCache.forEach(({path:i})=>{ah.x1=i.bounds.x1*t,ah.y1=i.bounds.y1*t,ah.x2=i.bounds.x2*t,ah.y2=i.bounds.y2*t,e.union(ah)})):void 0;this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}const XU=[J8,rU,oU,aU,PU,hU,gU,vU,_U,yU,SU,TU,RU,lU,MU,LU,IU,OU,zU,qU,WU,VU,GU],fL={};XU.forEach(n=>{fL[n.type]=n});const YU={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"};function KU(n,t){const e=[];let i=t.exec(n);for(;i;){const r=[];r.startIndex=t.lastIndex-i[0].length;const o=i.length;for(let s=0;s<o;s++)r.push(i[s]);e.push(r),i=t.exec(n)}return e}class dv{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function xT(n,t,e,i){const r=n.indexOf(t,e);if(r===-1)throw new Error(i);return r+t.length-1}function ZU(n,t,e=">"){let i,r="";for(let o=t;o<n.length;o++){let s=n[o];if(i)s===i&&(i="");else if(s==='"'||s==="'")i=s;else if(s===e[0]){if(!e[1])return{data:r,index:o};if(n[o+1]===e[1])return{data:r,index:o}}else s==="	"&&(s=" ");r+=s}}function TT(n,t,e,i=">"){const r=ZU(n,t+1,i);if(!r)return;let o=r.data;const s=r.index,a=o.search(/\s/);let l=o,u=!0;return a!==-1&&(l=o.substr(0,a).replace(/\s\s*$/,""),o=o.substr(a+1)),{tagName:l,tagExp:o,closeIndex:s,attrExpPresent:u,rawTagName:l}}const QU=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");class JU{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,i){const r=e.tagname;typeof r=="string"&&(e.tagname=r),t.addChild(e)}buildAttributesMap(t,e,i){const r={};if(!t)return;const o=KU(t,QU),s=o.length;for(let a=0;a<s;a++){const l=o[a][1],u=o[a][4],h=l;l&&(r[h]=u===void 0||(isNaN(u)?u:Number(u)))}return r}parseXml(t){t=t.replace(/\r\n?/g,`
`);const e=new dv("!xml");let i=e,r="",o="";for(let s=0;s<t.length;s++)if(t[s]==="<")if(t[s+1]==="/"){const a=xT(t,">",s,"Closing Tag is not closed."),l=o.lastIndexOf(".");o=o.substring(0,l),i=this.tagsNodeStack.pop(),i&&i.child&&r&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=r),r="",s=a}else if(t[s+1]==="?")s=TT(t,s,!1,"?>").closeIndex+1;else if(t.substr(s+1,3)==="!--")s=xT(t,"-->",s+4,"Comment is not closed.");else{const a=TT(t,s);let l=a.tagName,u=a.tagExp;const h=a.attrExpPresent,d=a.closeIndex;if(l!==e.tagname&&(o+=o?"."+l:l),u.length>0&&u.lastIndexOf("/")===u.length-1){l[l.length-1]==="/"?(l=l.substr(0,l.length-1),o=o.substr(0,o.length-1),u=l):u=u.substr(0,u.length-1);const c=new dv(l);l!==u&&h&&(c[":@"]=this.buildAttributesMap(u,o,l)),this.addChild(i,c,o),o=o.substr(0,o.lastIndexOf("."))}else{const c=new dv(l);this.tagsNodeStack.push(i),l!==u&&h&&(c[":@"]=this.buildAttributesMap(u,o,l)),this.addChild(i,c,o),i=c}r="",s=d}else r+=t[s];return e.child}}function t9(n,t){return gL(n)}function gL(n,t){const e={};for(let i=0;i<n.length;i++){const r=n[i],o=e9(r);if(o!==void 0&&r[o]){const s=gL(r[o]);r9(s),r[":@"]&&i9(s,r[":@"]),e[o]!==void 0&&e.hasOwnProperty(o)?(Array.isArray(e[o])||(e[o]=[e[o]]),e[o].push(s)):e[o]=s}}return e}function e9(n){const t=Object.keys(n);for(let e=0;e<t.length;e++){const i=t[e];if(i!==":@")return i}}function i9(n,t,e){if(t){const i=Object.keys(t),r=i.length;for(let o=0;o<r;o++){const s=i[o];n[s]=t[s]}}}function r9(n){return Object.keys(n).length===0}class Bm{constructor(t){this.options=Object.assign({},Bm.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){if(!this.valid)return!1;const e=new JU(this.options).parseXml(t);return t9(e,this.options)}}Bm.defaultOptions={};function n9(n){return n.startsWith("<svg")||n.startsWith("<?xml")}function pg(n,t,e,i=0){return n.expand(t+(i/2+(e?o9(e,t):0))),n}function o9(n,t){return n?t:0}let s9=0;function Ki(){return s9++}var Xl;(function(n){n[n.HORIZONTAL=0]="HORIZONTAL",n[n.VERTICAL=1]="VERTICAL"})(Xl||(Xl={}));function a9(n){const t=[];let e=0,i="";for(let r=0;r<n.length;r++)h9(n[r])?e?i+=n[r]:(e=1,i=n[r]):(e&&(t.push({text:i,direction:Xl.VERTICAL}),i="",e=0),t.push({text:n[r],direction:Xl.HORIZONTAL}));return i&&t.push({text:i,direction:Xl.VERTICAL}),t}const l9=["…","（","）","—","【","】","「","」","《","》"],pL=new Map;l9.forEach(n=>pL.set(n,!0));const u9=[""],mL=new Map;function h9(n){if(pL.has(n))return!0;if(mL.has(n))return!1;let t=!1;return n.codePointAt(0)<256&&(t=!0),t}u9.forEach(n=>mL.set(n,!0));const Pm=Ki(),d9=Ki(),vL=Ki(),km=Ki();Ki();const _w=Ki(),Lm=Ki(),qd=Ki(),Dm=Ki(),Im=Ki();Ki();const Cw=Ki();Ki();const yw=Ki();Ki();const Fm=Ki(),Om=Ki(),ww=Symbol.for("GraphicService"),bL=Symbol.for("GraphicCreator"),_L={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},c9=Object.keys(_L),f9={duration:200,easing:"cubicOut"};function CL(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function g9(n,t,e){const i=Math.sin(e),r=Math.cos(e),o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],h=t[9],d=t[10],c=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=o*r+u*i,n[5]=s*r+h*i,n[6]=a*r+d*i,n[7]=l*r+c*i,n[8]=u*r-o*i,n[9]=h*r-s*i,n[10]=d*r-a*i,n[11]=c*r-l*i,n}function p9(n,t,e){const i=Math.sin(e),r=Math.cos(e),o=t[0],s=t[1],a=t[2],l=t[3],u=t[8],h=t[9],d=t[10],c=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=o*r-u*i,n[1]=s*r-h*i,n[2]=a*r-d*i,n[3]=l*r-c*i,n[8]=o*i+u*r,n[9]=s*i+h*r,n[10]=a*i+d*r,n[11]=l*i+c*r,n}function m9(n,t,e){const i=Math.sin(e),r=Math.cos(e),o=t[0],s=t[1],a=t[2],l=t[3],u=t[4],h=t[5],d=t[6],c=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=o*r+u*i,n[1]=s*r+h*i,n[2]=a*r+d*i,n[3]=l*r+c*i,n[4]=u*r-o*i,n[5]=h*r-s*i,n[6]=d*r-a*i,n[7]=c*r-l*i,n}function lh(n,t,e){const i=e[0],r=e[1],o=e[2];let s,a,l,u,h,d,c,f,g,m,p,v;return t===n?(n[12]=t[0]*i+t[4]*r+t[8]*o+t[12],n[13]=t[1]*i+t[5]*r+t[9]*o+t[13],n[14]=t[2]*i+t[6]*r+t[10]*o+t[14],n[15]=t[3]*i+t[7]*r+t[11]*o+t[15]):(s=t[0],a=t[1],l=t[2],u=t[3],h=t[4],d=t[5],c=t[6],f=t[7],g=t[8],m=t[9],p=t[10],v=t[11],n[0]=s,n[1]=a,n[2]=l,n[3]=u,n[4]=h,n[5]=d,n[6]=c,n[7]=f,n[8]=g,n[9]=m,n[10]=p,n[11]=v,n[12]=s*i+h*r+g*o+t[12],n[13]=a*i+d*r+m*o+t[13],n[14]=l*i+c*r+p*o+t[14],n[15]=u*i+f*r+v*o+t[15]),n}function I_(n,t){n[0]=t.a,n[1]=t.b,n[2]=0,n[3]=0,n[4]=t.c,n[5]=t.d,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t.e,n[13]=t.f,n[14]=0,n[15]=1}function v9(n,t,e){const i=e[0],r=e[1],o=e[2];return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*r,n[5]=t[5]*r,n[6]=t[6]*r,n[7]=t[7]*r,n[8]=t[8]*o,n[9]=t[9]*o,n[10]=t[10]*o,n[11]=t[11]*o,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Xd(n,t,e){const i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],u=t[6],h=t[7],d=t[8],c=t[9],f=t[10],g=t[11],m=t[12],p=t[13],v=t[14],b=t[15];let C=e[0],y=e[1],w=e[2],_=e[3];return n[0]=C*i+y*a+w*d+_*m,n[1]=C*r+y*l+w*c+_*p,n[2]=C*o+y*u+w*f+_*v,n[3]=C*s+y*h+w*g+_*b,C=e[4],y=e[5],w=e[6],_=e[7],n[4]=C*i+y*a+w*d+_*m,n[5]=C*r+y*l+w*c+_*p,n[6]=C*o+y*u+w*f+_*v,n[7]=C*s+y*h+w*g+_*b,C=e[8],y=e[9],w=e[10],_=e[11],n[8]=C*i+y*a+w*d+_*m,n[9]=C*r+y*l+w*c+_*p,n[10]=C*o+y*u+w*f+_*v,n[11]=C*s+y*h+w*g+_*b,C=e[12],y=e[13],w=e[14],_=e[15],n[12]=C*i+y*a+w*d+_*m,n[13]=C*r+y*l+w*c+_*p,n[14]=C*o+y*u+w*f+_*v,n[15]=C*s+y*h+w*g+_*b,n}function zn(n,t,e){const i=t[0],r=t[1],o=t[2];let s=e[3]*i+e[7]*r+e[11]*o+e[15];return s=s||1,n[0]=(e[0]*i+e[4]*r+e[8]*o+e[12])/s,n[1]=(e[1]*i+e[5]*r+e[9]*o+e[13])/s,n[2]=(e[2]*i+e[6]*r+e[10]*o+e[14])/s,n}function AT(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}class b9{constructor(){this.pools=[]}allocate(t,e,i,r,o,s){if(!this.pools.length)return new Xe(t,e,i,r,o,s);const a=this.pools.pop();return a.a=t,a.b=e,a.c=i,a.d=r,a.e=o,a.f=s,a}allocateByObj(t){if(!this.pools.length)return new Xe(t.a,t.b,t.c,t.d,t.e,t.f);const e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}class Sw{constructor(){this.pools=[]}static identity(t){return CL(t)}allocate(){if(!this.pools.length)return AT();const t=this.pools.pop();return Sw.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():AT();for(let i=0;i<e.length;i++)e[i]=t[i];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const qi=new b9,Pi=new Sw;var _9=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},C9=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const y9=new Xe(1,0,0,1,0,0),vl={x:0,y:0};let F_=class{get nativeContext(){return this.path}constructor(n,t){this.matrix=new Xe(1,0,0,1,0,0),this.stack=[],this.dpr=t,this.applyedMatrix=new Xe(1,0,0,1,0,0),this.path=new Fi,this._clearMatrix=new Xe(1,0,0,1,0,0)}getCanvas(){throw new Error("不支持getCanvas")}getContext(){throw new Error("不支持getContext")}setTransformForCurrent(n=!1){!n&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}get currentMatrix(){return this.matrix}cloneMatrix(n){return qi.allocateByObj(n)}clear(){this.save(),this.resetTransform(),this.restore()}reset(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Xe(1,0,0,1,0,0),this.stack.length=0}restore(){this.stack.length>0&&(qi.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}highPerformanceRestore(){this.stack.length>0&&(qi.free(this.matrix),this.matrix=this.stack.pop())}rotate(n,t=!0){this.matrix.rotate(n),t&&this.setTransformForCurrent()}save(){const n=this.cloneMatrix(this.matrix);this.stack.push(n)}highPerformanceSave(){const n=this.cloneMatrix(this.matrix);this.stack.push(n)}scale(n,t,e=!0){this.matrix.scale(n,t),e&&this.setTransformForCurrent()}setScale(n,t,e=!0){this.matrix.setScale(n,t),e&&this.setTransformForCurrent()}scalePoint(n,t,e,i,r=!0){this.translate(e,i,!1),this.scale(n,t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}setTransform(n,t,e,i,r,o,s=!0,a=this.dpr){this.matrix.setValue(a*n,a*t,a*e,a*i,a*r,a*o),s&&this.setTransformForCurrent()}setTransformFromMatrix(n,t=!0,e=this.dpr){this.matrix.setValue(n.a*e,n.b*e,n.c*e,n.d*e,n.e*e,n.f*e),t&&this.setTransformForCurrent()}resetTransform(n=!0,t=this.dpr){this.setTransform(t,0,0,t,0,0),n&&this.setTransformForCurrent()}transform(n,t,e,i,r,o,s=!0){this.matrix.multiply(n,t,e,i,r,o),s&&this.setTransformForCurrent()}transformFromMatrix(n,t){this.matrix.multiply(n.a,n.b,n.c,n.d,n.e,n.f),t&&this.setTransformForCurrent()}translate(n,t,e=!0){this.matrix.translate(n,t),e&&this.setTransformForCurrent()}rotateDegrees(n,t=!0){const e=n*Math.PI/180;this.rotate(e,t)}rotateAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotate(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}rotateDegreesAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotateDegrees(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}beginPath(){this.path.clear()}clip(n,t){}arc(n,t,e,i,r,o){this.path.arc(n,t,e,i,r,o)}arcTo(n,t,e,i,r){this.path.arcTo(n,t,e,i,r)}bezierCurveTo(n,t,e,i,r,o){this.path.bezierCurveTo(n,t,e,i,r,o)}closePath(){this.path.closePath()}ellipse(n,t,e,i,r,o,s,a){}lineTo(n,t){this.path.lineTo(n,t)}moveTo(n,t){this.path.moveTo(n,t)}quadraticCurveTo(n,t,e,i){this.path.quadraticCurveTo(n,t,e,i)}rect(n,t,e,i){this.path.rect(n,t,e,i)}createImageData(n,t){return null}createLinearGradient(n,t,e,i){throw new Error("不支持createLinearGradient")}createPattern(n,t){throw new Error("不支持createPattern")}createRadialGradient(n,t,e,i,r,o){throw new Error("不支持createRadialGradient")}createConicGradient(n,t,e,i){return null}fill(n,t){}fillRect(n,t,e,i){this.path.rect(n,t,e,i)}clearRect(n,t,e,i){}fillText(n,t,e){}getImageData(n,t,e,i){return null}getLineDash(){return[]}isPointInPath(n,t){return this.matrix.transformPoint({x:n,y:t},vl),O8(this.path.commandList,vl.x,vl.y)}isPointInStroke(n,t){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:n,y:t},vl);const e=Po(this,this.lineWidth,this.dpr);return H8(this.path.commandList,e,vl.x,vl.y)}measureText(n){throw new Error("不支持measureText")}putImageData(n,t,e){throw new Error("不支持measureText")}setLineDash(n){}stroke(n){}strokeRect(n,t,e,i){this.path.rect(n,t,e,i)}strokeText(n,t,e){}drawImage(){}setCommonStyle(n,t,e,i,r){}_setCommonStyle(n,t,e,i){}setStrokeStyle(n,t,e,i,r){}_setStrokeStyle(n,t,e,i){}setTextStyleWithoutAlignBaseline(n,t){}setTextStyle(n,t){}draw(){}clearMatrix(n=!0,t=this.dpr){this.setTransformFromMatrix(y9,n,t)}setClearMatrix(n,t,e,i,r,o){this._clearMatrix.setValue(n,t,e,i,r,o)}onlyTranslate(n=this.dpr){return this.matrix.a===n&&this.matrix.b===0&&this.matrix.c===0&&this.matrix.d===n}release(...n){this.stack.forEach(t=>qi.free(t)),this.stack.length=0}};F_=_9([Tt(),C9("design:paramtypes",[Object,Number])],F_);const cv={WIDTH:500,HEIGHT:500,DPR:1};class xw{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}set nativeCanvas(t){this._nativeCanvas=t}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;const{nativeCanvas:i,width:r=cv.WIDTH,height:o=cv.HEIGHT,dpr:s=cv.DPR,x:a,y:l,id:u,canvasControled:h=!0}=t;this._x=a??0,this._y=l??0,this._pixelWidth=r*s,this._pixelHeight=o*s,this._visiable=t.visiable!==!1,this.controled=h,this._displayWidth=r,this._displayHeight=o,this._dpr=s,this._nativeCanvas=i,this._id=(e=i.id)!==null&&e!==void 0?e:u,u&&(i.id=u),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,i,r){return this._context.getImageData(t,e,i,r)}convertToBlob(t){throw new Error("暂未实现")}transferToImageBitmap(){throw new Error("暂未实现")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}xw.env="browser";var Qn;(function(n){n[n.Color255=0]="Color255",n[n.Color1=1]="Color1"})(Qn||(Qn={}));class Ri{static Get(t,e=Qn.Color1,i=[0,0,0,1]){if(e===Qn.Color1){const s=Ri.store1[t];if(s)return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i;const a=Gl.parseColorString(t);if(a){const l=[a.r/255,a.g/255,a.b/255,a.opacity];Ri.store1[t]=l,Ri.store255[t]=[a.r,a.g,a.b,a.opacity],i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3]}return i}const r=Ri.store255[t];if(r)return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i;const o=Gl.parseColorString(t);return o&&(Ri.store1[t]=[o.r/255,o.g/255,o.b/255,o.opacity],Ri.store255[t]=[o.r,o.g,o.b,o.opacity],i[0]=o.r,i[1]=o.g,i[2]=o.b,i[3]=o.opacity),i}static Set(t,e,i){if(e===Qn.Color1){if(Ri.store1[t])return;Ri.store1[t]=i,Ri.store255[t]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]}else{if(Ri.store255[t])return;Ri.store255[t]=i,Ri.store1[t]=[i[0]/255,i[1]/255,i[2]/255,i[3]]}}}Ri.store255={},Ri.store1={};function qc(n,t=!1){return Array.isArray(n)&&ne(n[0])?t?`rgb(${Math.round(n[0])},${Math.round(n[1])},${Math.round(n[2])},${n[3].toFixed(2)})`:`rgb(${Math.round(n[0])},${Math.round(n[1])},${Math.round(n[2])})`:n}function Ya(n,t,e,i,r){return Array.isArray(n)&&!ne(n[0])||Array.isArray(t)&&!ne(t[0])?new Array(4).fill(0).map((o,s)=>{var a,l;return RT(jt(n)?(a=n[s])!==null&&a!==void 0?a:n[0]:n,jt(t)?(l=t[s])!==null&&l!==void 0?l:t[0]:t,e,i)}):RT(n,t,e,i)}function RT(n,t,e,i,r){if(!n||!t)return n&&qc(n)||t&&qc(t)||!1;let o,s,a=!1,l=!1;if(Array.isArray(n)?o=n:typeof n=="string"?o=Ri.Get(n,Qn.Color255):a=!0,Array.isArray(t)?s=t:typeof t=="string"?s=Ri.Get(t,Qn.Color255):l=!0,a!==l){const u=a?n:t,h=a?t:n,d=Object.assign(Object.assign({},u),{stops:u.stops.map(c=>Object.assign(Object.assign({},c),{color:qc(h)}))});return a?Ya(u,d,e,i):Ya(d,u,e,i)}if(a){if(n.gradient===t.gradient){const u=n,h=t,d=u.stops,c=h.stops;if(d.length!==c.length)return!1;if(u.gradient==="linear")return w9(u,h,e);if(u.gradient==="radial")return S9(u,h,e);if(u.gradient==="conical")return x9(u,h,e)}return!1}return qc(T9(o,s,e),i)}function w9(n,t,e){const i=n.stops,r=t.stops;return{gradient:"linear",x0:n.x0+(t.x0-n.x0)*e,x1:n.x1+(t.x1-n.x1)*e,y0:n.y0+(t.y0-n.y0)*e,y1:n.y1+(t.y1-n.y1)*e,stops:new Array(i.length).fill(0).map((o,s)=>({color:Tw(i[s].color,r[s].color,e),offset:i[s].offset+(r[s].offset-i[s].offset)*e}))}}function S9(n,t,e){const i=n.stops,r=t.stops;return{gradient:"radial",x0:n.x0+(t.x0-n.x0)*e,x1:n.x1+(t.x1-n.x1)*e,y0:n.y0+(t.y0-n.y0)*e,y1:n.y1+(t.y1-n.y1)*e,r0:n.r0+(t.r0-n.r0)*e,r1:n.r1+(t.r1-n.r1)*e,stops:new Array(i.length).fill(0).map((o,s)=>({color:Tw(i[s].color,r[s].color,e),offset:i[s].offset+(r[s].offset-i[s].offset)*e}))}}function x9(n,t,e){const i=n.stops,r=t.stops;return{gradient:"conical",startAngle:n.startAngle+(t.startAngle-n.startAngle)*e,endAngle:n.endAngle+(t.endAngle-n.endAngle)*e,x:n.x+(t.x-n.x)*e,y:n.y+(t.y-n.y)*e,stops:new Array(i.length).fill(0).map((o,s)=>({color:Tw(i[s].color,r[s].color,e),offset:i[s].offset+(r[s].offset-i[s].offset)*e}))}}function T9(n,t,e){return[n[0]+(t[0]-n[0])*e,n[1]+(t[1]-n[1])*e,n[2]+(t[2]-n[2])*e,n[3]+(t[3]-n[3])*e]}function ET(n,t,e){return`rgba(${n[0]+(t[0]-n[0])*e},${n[1]+(t[1]-n[1])*e},${n[2]+(t[2]-n[2])*e},${n[3]+(t[3]-n[3])*e})`}const Vo=[0,0,0,0],uh=[0,0,0,0];function Tw(n,t,e){return Ri.Get(n,Qn.Color255,Vo),Ri.Get(t,Qn.Color255,uh),`rgba(${Math.round(Vo[0]+(uh[0]-Vo[0])*e)},${Math.round(Vo[1]+(uh[1]-Vo[1])*e)},${Math.round(Vo[2]+(uh[2]-Vo[2])*e)},${Vo[3]+(uh[3]-Vo[3])*e})`}class xn{static GetCanvas(){try{return xn.canvas||(xn.canvas=Mt.global.createCanvas({})),xn.canvas}catch{return null}}static GetCtx(){if(!xn.ctx){const t=xn.GetCanvas();xn.ctx=t.getContext("2d")}return xn.ctx}}class Ra extends u6{static getInstance(){return Ra._instance||(Ra._instance=new Ra),Ra._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;const i=xn.GetCanvas(),r=xn.GetCtx();if(i.width=e,i.height=1,!r)return;if(r.translate(0,0),!r)throw new Error("获取ctx发生错误");const o=r.createLinearGradient(0,0,e,0);t.forEach(s=>{o.addColorStop(s[0],s[1])}),r.fillStyle=o,r.fillRect(0,0,e,1),this.rgbaSet=r.getImageData(0,0,e,1).data}getColor(t){const e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,i,r,o=[],s=100){let a=`${t}${e}${i}${r}`;o.forEach(u=>a+=u.join()),a+=s;let l=this.dataMap.get(a);return l||(l={data:new Ra(o,s),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(a,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}class gr{static GetSize(t){for(let e=0;e<gr.ImageSize.length;e++)if(gr.ImageSize[e]>=t)return gr.ImageSize[e];return t}static Get(t,e,i,r,o,s,a){const l=gr.GenKey(t,e,i,r,o),u=gr.cache[l];if(!u||u.length===0)return null;for(let h=0;h<u.length;h++)if(u[h].width>=s&&u[h].height>=a)return u[h].pattern;return null}static Set(t,e,i,r,o,s,a,l){const u=gr.GenKey(t,e,i,r,o);gr.cache[u]?gr.cache[u].push({width:a,height:l,pattern:s}):gr.cache[u]=[{width:a,height:l,pattern:s}]}static GenKey(t,e,i,r,o){return`${e},${i},${r},${o},${t.join()}`}}gr.cache={},gr.ImageSize=[20,40,80,160,320,640,1280,2560];function A9(n,t,e,i){const{stops:r,startAngle:o,endAngle:s}=i;for(;e<0;)e+=Zt;for(;e>Zt;)e-=Zt;if(e<o||e>s)return r[0].color;let a,l,u=(e-o)/(s-o);for(let h=0;h<r.length;h++)if(r[h].offset>=u){a=r[h-1],l=r[h];break}return u=(u-a.offset)/(l.offset-a.offset),Ya(a.color,l.color,u,!1)}function R9(n,t,e,i,r,o,s,a,l){const u=Math.floor(180*r/Math.PI),h=xn.GetCanvas(),d=xn.GetCtx();if(!d)return null;const c=gr.GetSize(a),f=gr.GetSize(l);let g=gr.Get(t,e,i,o,s,c,f);if(g)return g;const m=Math.sqrt(Math.max(Math.max(Math.pow(e,2)+Math.pow(i,2),Math.pow(c-e,2)+Math.pow(i,2)),Math.max(Math.pow(c-e,2)+Math.pow(f-i,2),Math.pow(e,2)+Math.pow(f-i,2)))),p=u+1,v=r/Math.max(1,p-1),b=Ra.getInstance().GetOrCreate(e,i,c,f,t,p),C=2*Math.PI*m/360;h.width=c,h.height=f,d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,c,f),d.translate(e,i),d.rotate(o);for(let w=0,_=p-1;w<_&&!(o+w*v>s);w++){const A=b.getColor(w);d.beginPath(),d.rotate(v),d.moveTo(0,0),d.lineTo(m,-2*C),d.lineTo(m,0),d.fillStyle=A,d.closePath(),d.fill()}const y=d.getImageData(0,0,c,f);return h.width=y.width,h.height=y.height,d.putImageData(y,0,0),g=n.createPattern(h,"no-repeat"),g&&gr.Set(t,e,i,o,s,g,c,f),g}const Xc=new Ye,E9=new Xe;new Ye;const In=["lineWidth","scaleX","scaleY","angle","anchor","visible"],MT=["x","y"],BT=["scaleX","scaleY"],PT=["angle"],hh=new ze,so={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class Hi extends G8{static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const r=e[i];Object.defineProperty(Hi.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get AABBBounds(){return this.tryUpdateAABBBounds()}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new Ye,this._updateTag=He.INIT,this.attribute=t,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,t.background?this.loadImage((e=t.background.background)!==null&&e!==void 0?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}getGraphicService(){var t,e;return(e=(t=this.stage)===null||t===void 0?void 0:t.graphicService)!==null&&e!==void 0?e:Mt.graphicService}getAttributes(){return this.attribute}setMode(t){t==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var i,r;const{dx:o=t.dx,dy:s=t.dy}=this.attribute;if(e&&this.parent){const a=this.parent.attribute;hh.x=o+((i=a.scrollX)!==null&&i!==void 0?i:0),hh.y=s+((r=a.scrollY)!==null&&r!==void 0?r:0)}else hh.x=o,hh.y=s;return hh}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(){const t=this.attribute.boundsMode==="imprecise";if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),this.attribute.boundsMode==="empty"&&e.clear(),e}tryUpdateOBBBounds(){return this._OBBBounds||(this._OBBBounds=new dw),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}combindShadowAABBBounds(t){if(this.shadowRoot){const e=this.shadowRoot.AABBBounds.clone();t.union(e)}}doUpdateOBBBounds(){return this._OBBBounds}getClipPath(){const{clipConfig:t}=this.attribute;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);const{shape:e}=t;let i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),i=this.parsePath(e),i&&this.clipPathMap.set(e,i)),i}parsePath(t){if(!t)return null;let e=fL[t];if(e||(e=Hi.userSymbolMap[t],e))return e;const i=YU[t];if(n9(t=i||t)===!0){const u=new Bm,{svg:h}=u.parse(t);if(!h)return null;const d=jt(h.path)?h.path:[h.path];Xc.clear();const c=[];d.forEach(v=>{const b=new Fi().fromString(v.d),C={};c9.forEach(y=>{v[y]&&(C[_L[y]]=v[y])}),c.push({path:b,attribute:C}),Xc.union(b.bounds)});const f=Xc.width(),g=Xc.height(),m=1/un(f,g);c.forEach(v=>v.path.transform(0,0,m,m));const p=new ST(t,c,!0);return Hi.userSymbolMap[t]=p,p}const r=new Fi().fromString(t),o=r.bounds.width(),s=r.bounds.height(),a=1/un(o,s);r.transform(0,0,a,a);const l=new ST(t,r);return Hi.userSymbolMap[t]=l,l}doUpdateAABBBounds(t){this.updateAABBBoundsStamp++;const e=this.getGraphicTheme();this._AABBBounds.clear();const i=this.attribute,r=this.updateAABBBounds(i,e,this._AABBBounds,t),{boundsPadding:o=e.boundsPadding}=i,s=gg(o);return s&&r.expand(s),this.clearUpdateBoundTag(),r}updatePathProxyAABBBounds(t){const e=typeof this.pathProxy=="function"?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;const i=new fw(t);return fs(e.commandList,i,0,0),!0}tryUpdateGlobalAABBBounds(){const t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){const e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new Xe),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&He.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&He.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&He.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&He.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&He.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;const i=this.attribute;return Number.isFinite(((t=i.x)!==null&&t!==void 0?t:0)+((e=i.y)!==null&&e!==void 0?e:0))}_validNumber(t){return t==null||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&He.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=He.CLEAR_SHAPE}containsPoint(t,e,i,r){if(!r)return!1;if(i===ud.GLOBAL){const o=new ze(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(o,o),t=o.x,e=o.y}return r.containsPoint(this,{x:t,y:e})}setWidthHeightWithoutTransform(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}setAttributesAndPreventAnimate(t,e=!1,i,r){this.setAttributes(t,e,i),this.animates&&this.animates.forEach(o=>{(o.priority!==1/0||r)&&Object.keys(t).forEach(s=>{o.preventAttr(s)})})}setAttributes(t,e=!1,i){(t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i)}_setAttributes(t,e=!1,i){const r=Object.keys(t);for(let o=0;o<r.length;o++){const s=r[o];this.attribute[s]=t[s]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(r)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(t,e,i,r){var o;const s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);s?this._setAttributes(s,i,r):zt((o=this.normalAttrs)===null||o===void 0?void 0:o[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[t]=e,t==="background"?this.loadImage(e,!0):t==="shadowGraphic"&&this.setShadowGraphic(e)}needUpdateTags(t,e=In){for(let i=0;i<e.length;i++){const r=e[i];if(t.indexOf(r)!==-1)return!0}return!1}needUpdateTag(t,e=In){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}initAttributes(t){const e={type:Tr.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=He.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var i,r;if(t===0&&e===0)return this;const o={type:Tr.TRANSLATE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,MT,o);s&&(t=s.x,e=s.y,delete s.x,delete s.y,this._setAttributes(s));const a=this.attribute,l=a.postMatrix;return l?Mt.transformUtil.fromMatrix(l,l).translate(t,e):(a.x=((i=a.x)!==null&&i!==void 0?i:Ui.x)+t,a.y=((r=a.y)!==null&&r!==void 0?r:Ui.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this}translateTo(t,e){const i=this.attribute;if(i.x===t&&i.y===e)return this;const r={type:Tr.TRANSLATE_TO},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,MT,r);return o?(this._setAttributes(o,!1,r),this):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this)}scale(t,e,i){var r,o;if(t===1&&e===1)return this;const s={type:Tr.SCALE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,BT,s);a&&(t=a.scaleX,e=a.scaleY,delete a.scaleX,delete a.scaleY,this._setAttributes(a));const l=this.attribute;if(i){let{postMatrix:u}=this.attribute;u||(u=new Xe,l.postMatrix=u),Mt.transformUtil.fromMatrix(u,u).scale(t,e,i)}else l.scaleX=((r=l.scaleX)!==null&&r!==void 0?r:Ui.scaleX)*t,l.scaleY=((o=l.scaleY)!==null&&o!==void 0?o:Ui.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(s),this}scaleTo(t,e){const i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;const r={type:Tr.SCALE_TO},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,BT,r);return o?(this._setAttributes(o,!1,r),this):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this)}rotate(t,e){var i;if(t===0)return this;const r={type:Tr.ROTATE},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,PT,r);o&&(delete o.angle,this._setAttributes(o,!1,r));const s=this.attribute;if(e){let{postMatrix:a}=this.attribute;a||(a=new Xe,s.postMatrix=a),Mt.transformUtil.fromMatrix(a,a).rotate(t,e)}else s.angle=((i=s.angle)!==null&&i!==void 0?i:Ui.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}rotateTo(t){const e=this.attribute;if(e.angle===t)return this;const i={type:Tr.ROTATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,PT,i);return r?(this._setAttributes(r,!1,i),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i),this)}skewTo(t,e){return this}onAttributeUpdate(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!zt(t)||this.currentStates.includes(t))}getState(t){var e;return(e=this.states)===null||e===void 0?void 0:e[t]}applyStateAttrs(t,e,i,r){var o,s;if(i){const a=Object.keys(t),l=this.getNoWorkAnimateAttr(),u={};let h;a.forEach(c=>{l[c]?(h||(h={}),h[c]=t[c]):u[c]=r&&t[c]===void 0?this.getDefaultAttribute(c):t[c]});const d=(s=(o=this.context&&this.context.stateAnimateConfig)!==null&&o!==void 0?o:this.stateAnimateConfig)!==null&&s!==void 0?s:f9;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:u,duration:d.duration,easing:d.easing}}]),h&&this.setAttributesAndPreventAnimate(h,!1,{type:Tr.STATE})}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:Tr.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:Tr.STATE})}updateNormalAttrs(t){const e={};this.normalAttrs?(Object.keys(t).forEach(i=>{i in this.normalAttrs?(e[i]=this.normalAttrs[i],delete this.normalAttrs[i]):e[i]=this.getNormalAttribute(i)}),Object.keys(this.normalAttrs).forEach(i=>{t[i]=this.normalAttrs[i]})):Object.keys(t).forEach(i=>{e[i]=this.getNormalAttribute(i)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){var e,i;const r=this.attribute[t];return this.animates?(e=this.finalAttribute)===null||e===void 0?void 0:e[t]:r??((i=this.finalAttribute)===null||i===void 0?void 0:i[t])}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if(this.currentStates){const i=jt(t)?o=>!t.includes(o):o=>o!==t,r=this.currentStates.filter(i);r.length!==this.currentStates.length&&this.useStates(r,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){const i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}addState(t,e,i){var r;if(this.currentStates&&this.currentStates.includes(t)&&(e||this.currentStates.length===1))return;const o=e&&(!((r=this.currentStates)===null||r===void 0)&&r.length)?this.currentStates.concat([t]):[t];this.useStates(o,i)}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!(((i=this.currentStates)===null||i===void 0?void 0:i.length)!==t.length||t.some((o,s)=>this.currentStates[s]!==o)))return;const r={};t.forEach(o=>{var s;const a=this.stateProxy?this.stateProxy(o,t):(s=this.states)===null||s===void 0?void 0:s[o];a&&Object.assign(r,a)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}addUpdateBoundTag(){this._updateTag|=He.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=He.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=He.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&He.UPDATE_SHAPE_AND_BOUNDS)===He.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=He.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=He.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=He.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=He.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=He.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=He.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=He.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&He.UPDATE_LAYOUT)}getAnchor(t,e,i){const r=[0,0],o=()=>{if(e.b)return e.b;const s=this.clone();return s.attribute.angle=0,s.attribute.scaleCenter=null,i&&(s.attribute.scaleX=1,s.attribute.scaleY=1),e.b=s.AABBBounds,e.b};if(typeof t[0]=="string"){const s=parseFloat(t[0])/100,a=o();r[0]=a.x1+(a.x2-a.x1)*s}else r[0]=t[0];if(typeof t[1]=="string"){const s=parseFloat(t[1])/100,a=o();r[1]=a.y1+(a.y2-a.y1)*s}else r[1]=t[1];return r}doUpdateLocalMatrix(){const{x:t=Ui.x,y:e=Ui.y,scaleX:i=Ui.scaleX,scaleY:r=Ui.scaleY,angle:o=Ui.angle,scaleCenter:s,anchor:a,postMatrix:l}=this.attribute;let u=[0,0];const h={};if(a&&o&&(u=this.getAnchor(a,h)),!s||i===1&&r===1)l6(this._transMatrix,this._transMatrix.reset(),t,e,i,r,o,a&&u);else{const c=this._transMatrix;c.reset(),c.translate(u[0],u[1]),c.rotate(o),c.translate(-u[0],-u[1]),c.translate(t,e),u=this.getAnchor(s,h,!0),Mt.transformUtil.fromMatrix(c,c).scale(i,r,{x:u[0],y:u[1]})}const d=this.getOffsetXY(Ui);if(this._transMatrix.e+=d.x,this._transMatrix.f+=d.y,l){const c=E9.setValue(l.a,l.b,l.c,l.d,l.e,l.f),f=this._transMatrix;c.multiply(f.a,f.b,f.c,f.d,f.e,f.f),f.setValue(c.a,c.b,c.c,c.d,c.e,c.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);const{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){const i=t.getTimeline();this.animates.forEach(r=>{r.timeline.isGlobal&&(r.setTimeline(i),i.addAnimate(r))})}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:Tr.ANIMATE_END})}getDefaultAttribute(t){return this.getGraphicTheme()[t]}getComputedAttribute(t){var e;return(e=this.attribute[t])!==null&&e!==void 0?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=t??Mt.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return lr(t,!0)?this.pathProxy=new Fi().fromString(t):this.pathProxy=new Fi,this.pathProxy}loadImage(t,e=!1){if(!t||e&&M9(t))return;const i=t;this.resources||(this.resources=new Map);const r={data:"init",state:null};this.resources.set(i,r),typeof t=="string"?(r.state="loading",t.startsWith("<svg")?(Oe.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(P4(t)||t.includes("/")||k4(t))&&(Oe.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):$i(t)?(r.state="success",r.data=t,this.backgroundImg=this.backgroundImg||e):r.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,i){if(!this.resources)return;const r=this.resources.get(t);r&&(r.state="success",r.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;const i=this.resources.get(t);i&&(i.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(e=>{e.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",this.stopAnimates(),Mt.graphicService.onRelease(this)}_emitCustomEvent(t,e){var i,r;if(this._events&&t in this._events){const o=new vw(t,e);o.bubbles=!1,o.manager=(r=(i=this.stage)===null||i===void 0?void 0:i.eventSystem)===null||r===void 0?void 0:r.manager,this.dispatchEvent(o)}}toCustomPath(){var t,e,i;const r=(i=(e=((t=this.stage)===null||t===void 0?void 0:t.renderService)||Mt.renderService)===null||e===void 0?void 0:e.drawContribution)===null||i===void 0?void 0:i.getRenderContribution(this);if(r){const o=new F_(null,1);return r.drawShape(this,o,0,0,{},{}),o.path}return null}}function M9(n){return!(!n.fill&&!n.stroke)}Hi.userSymbolMap={},Hi.mixin(q8);var kT;(function(n){n[n.LESS_GROUP=0]="LESS_GROUP",n[n.MORE_GROUP=1]="MORE_GROUP"})(kT||(kT={}));let ko=class O_ extends Hi{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=_w,this._childUpdateTag=He.UPDATE_BOUNDS}setMode(t){t==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new gd),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new gd)}visibleAll(t){this.setAttribute("visible",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(t,e,i){if(i===ud.GLOBAL){const r=new ze(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),this.AABBBounds.contains(r.x,r.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&He.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),this.attribute.boundsMode==="empty"&&e.clear(),e}doUpdateLocalMatrix(){const{x:t=Ui.x,y:e=Ui.y,dx:i=Ui.dx,dy:r=Ui.dy,scaleX:o=Ui.scaleX,scaleY:s=Ui.scaleY,angle:a=Ui.angle,postMatrix:l}=this.attribute;if(t!==0||e!==0||i!==0||r!==0||o!==1||s!==1||a!==0||l)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return ae(this).group}updateAABBBounds(t,e,i){const r=i;i=i.clone();const{width:o,height:s,path:a,clip:l=e.clip}=t;if(a&&a.length?a.forEach(u=>{i.union(u.AABBBounds)}):o!=null&&s!=null&&i.set(0,0,Math.max(0,o),Math.max(0,s)),!l){this.forEachChildren(d=>{i.union(d.AABBBounds)});const{scrollX:u=0,scrollY:h=0}=t;i.translate(u,h)}return Mt.graphicService.updateTempAABBBounds(i),Mt.graphicService.transformAABBBounds(t,i,e,!1,this),r.copy(i),r}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;const t=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}clearUpdateBoundTag(){this._updateTag&=He.CLEAR_BOUNDS,this._childUpdateTag&=He.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=He.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&He.UPDATE_BOUNDS||(this._childUpdateTag|=He.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){const e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}_updateChildToStage(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}appendChild(t,e=!0){const i=super.appendChild(t);return e&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(t,e){return this._updateChildToStage(super.insertBefore(t,e))}insertAfter(t,e){return this._updateChildToStage(super.insertAfter(t,e))}insertInto(t,e){return this._updateChildToStage(super.insertInto(t,e))}removeChild(t){const e=super.removeChild(t);return t.stage=null,this.getGraphicService().onRemove(t),this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{this.getGraphicService().onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren(i=>{i.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){const e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&He.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(i=>i.name===t,e)}createOrUpdateChild(t,e,i){let r=this._getChildByName(t);return r?r.setAttributes(e):(r=Mt.graphicService.creator[i](e),r.name=t,this.add(r)),r}clone(){return new O_(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return O_.NOWORK_ANIMATE_ATTR}release(t){t&&this.forEachChildren(e=>{e.release(t)}),super.release()}};ko.NOWORK_ANIMATE_ATTR=so;function mg(n){return new ko(n)}class B9 extends ko{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw new Error("暂不支持")}get dpr(){return this._dpr}constructor(t,e,i,r){var o;super({}),this.stage=t,this.global=e,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:(o=r.zIndex)!==null&&o!==void 0?o:0}),this.layer=this,this.subLayers=new Map,this.theme=new gd,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){const e=Array.from(this.subLayers.values()).sort((i,r)=>i.zIndex-r.zIndex);this.layerHandler.merge(e.map(i=>(i.layer.subLayers.size&&i.layer.combineSubLayer(t),i.layer.getNativeHandler()))),t&&e.forEach(i=>{i.group&&(i.group.incremental=0)}),e.forEach(i=>{Mt.layerService.releaseLayer(this.stage,i.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw new Error("暂不支持")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(i=>{i.layer.renderCount=this.renderCount,i.layer.render(t,e)})}render(t,e){var i;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:(i=t.background)!==null&&i!==void 0?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(r=>r(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw new Error("暂不支持")}setToFrame(t){throw new Error("暂不支持")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{Mt.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var i;this.layerHandler.drawTo(t,[this],Object.assign({background:(i=e.background)!==null&&i!==void 0?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(r=>r(this))}}const yL=Symbol.for("TransformUtil"),wL=Symbol.for("GraphicUtil"),Aw=Symbol.for("LayerService"),SL=Symbol.for("StaticLayerHandlerContribution"),P9=Symbol.for("DynamicLayerHandlerContribution"),k9=Symbol.for("VirtualLayerHandlerContribution");var Ah,L9=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},D9=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let Rh=Ah=class{static GenerateLayerId(){return`${Ah.idprefix}_${Ah.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=Mt.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(n){return this.layerMap.get(n)}getRecommendedLayerType(n){return n||(this.staticLayerCountInEnv!==0?"static":this.dynamicLayerCountInEnv!==0?"dynamic":"virtual")}getLayerHandler(n){let t;return t=n==="static"?te.get(SL):n==="dynamic"?te.get(P9):te.get(k9),t}createLayer(n,t={main:!1}){var e;this.tryInit();let i=this.getRecommendedLayerType(t.layerMode);i=t.main||t.canvasId?"static":i;const r=this.getLayerHandler(i),o=new B9(n,this.global,n.window,Object.assign(Object.assign({main:!1},t),{layerMode:i,canvasId:(e=t.canvasId)!==null&&e!==void 0?e:Ah.GenerateLayerId(),layerHandler:r})),s=this.layerMap.get(n)||[];return s.push(o),this.layerMap.set(n,s),this.staticLayerCountInEnv--,o}prepareStageLayer(n){let t;n.forEachChildren(e=>{const i=e.getNativeHandler();i.type==="virtual"?(i.mainHandler=t,t.secondaryHandlers.push(i)):(t=i,t.secondaryHandlers=[])})}releaseLayer(n,t){t.release();const e=this.layerMap.get(n)||[];this.layerMap.set(n,e.filter(i=>i!==t))}layerCount(n){return(this.layerMap.get(n)||[]).length}restLayerCount(n){return this.global.env==="browser"?10:0}releaseStage(n){this.layerMap.delete(n)}};Rh.idprefix="visactor_layer",Rh.prefix_count=0,Rh=Ah=L9([Tt(),D9("design:paramtypes",[])],Rh);const I9=new ie(n=>{n(aw).to(__).inSingletonScope(),n(fd).to(M_),n(wL).to(B_).inSingletonScope(),n(yL).to(P_).inSingletonScope(),n(Aw).to(Rh).inSingletonScope()});function bu(n,t){return!(!n&&!t)}function pd(n,t){let e;return e=jt(n)?n.some(i=>i||i===void 0):!!n,e&&t>0}function Ka(n,t,e){return e&&n*t>0}function xL(n,t,e,i,r){return r&&n*t>0&&e!==0&&i!==0}function H_(n,t){return n*t>0}function TL(n,t,e,i){return n*t>0&&e!==0&&i!==0}function F9(n,t,e,i,r,o,s,a){const l=e-n,u=i-t,h=s-r,d=a-o;let c=d*l-h*u;return c*c<je?[]:(c=(h*(t-o)-d*(n-r))/c,[n+c*l,t+c*u])}function Fs(n,t,e,i,r,o,s){const a=n-e,l=t-i,u=(s?o:-o)/Math.sqrt(a*a+l*l),h=u*l,d=-u*a,c=n+h,f=t+d,g=e+h,m=i+d,p=(c+g)/2,v=(f+m)/2,b=g-c,C=m-f,y=b*b+C*C,w=r-o,_=c*m-g*f,A=(C<0?-1:1)*Math.sqrt(Math.max(0,w*w*y-_*_));let T=(_*C-b*A)/y,S=(-_*b-C*A)/y;const x=(_*C+b*A)/y,E=(-_*b+C*A)/y,M=T-p,L=S-v,I=x-p,D=E-v;return M*M+L*L>I*I+D*D&&(T=x,S=E),{cx:T,cy:S,x01:-h,y01:-d,x11:T*(r/w-1),y11:S*(r/w-1)}}function AL(n,t,e,i,r){const o=Se(e-t),s=n.getParsedCornerRadius(),a=jt(s),{outerDeltaAngle:l,innerDeltaAngle:u,outerStartAngle:h,outerEndAngle:d,innerEndAngle:c,innerStartAngle:f}=n.getParsePadAngle(t,e),g=a?s[0]:s,m=a?s[1]:s,p=a?s[2]:s,v=a?s[3]:s,b=Math.max(m,g),C=Math.max(p,v);let y=b,w=C;const _=r*Ei(h),A=r*ti(h),T=i*Ei(c),S=i*ti(c);let x,E,M,L;if((C>je||b>je)&&(x=r*Ei(d),E=r*ti(d),M=i*Ei(f),L=i*ti(f),o<Ae)){const I=F9(_,A,M,L,x,E,T,S);if(I){const D=_-I[0],H=A-I[1],O=x-I[0],N=E-I[1],U=1/ti(t6((D*O+H*N)/(Zn(D*D+H*H)*Zn(O*O+N*N)))/2),W=Zn(I[0]*I[0]+I[1]*I[1]);w=ki(C,(i-W)/(U-1)),y=ki(b,(r-W)/(U+1))}}return{outerDeltaAngle:l,xors:_,yors:A,xirs:M,yirs:L,xore:x,yore:E,xire:T,yire:S,limitedOcr:y,limitedIcr:w,outerCornerRadiusStart:g,outerCornerRadiusEnd:m,maxOuterCornerRadius:b,maxInnerCornerRadius:C,outerStartAngle:h,outerEndAngle:d,innerDeltaAngle:u,innerEndAngle:c,innerStartAngle:f,innerCornerRadiusStart:v,innerCornerRadiusEnd:p}}function z_(n,t,e,i,r,o,s){const{startAngle:a,endAngle:l}=n.getParsedAngle(),u=Se(l-a),h=l>a;let d=!1;if(r<o){const c=r;r=o,o=c}if(r<=je)t.moveTo(e,i);else if(u>=Zt-je)t.moveTo(e+r*Ei(a),i+r*ti(a)),t.arc(e,i,r,a,l,!h),o>je&&(t.moveTo(e+o*Ei(l),i+o*ti(l)),t.arc(e,i,o,l,a,h));else{const{outerDeltaAngle:c,xors:f,yors:g,xirs:m,yirs:p,limitedOcr:v,outerCornerRadiusStart:b,outerCornerRadiusEnd:C,maxOuterCornerRadius:y,xore:w,yore:_,xire:A,yire:T,outerStartAngle:S,outerEndAngle:x,limitedIcr:E,innerDeltaAngle:M,innerEndAngle:L,innerStartAngle:I,innerCornerRadiusStart:D,innerCornerRadiusEnd:H,maxInnerCornerRadius:O}=AL(n,a,l,o,r);if(c<.001)s&&(s[3]||s[1])&&t.moveTo(e+f,i+g),d=!0;else if(v>je){const N=ki(b,v),U=ki(C,v),W=Fs(m,p,f,g,r,N,Number(h)),j=Fs(w,_,A,T,r,U,Number(h));v<y&&N===U?!s||s[0]?(t.moveTo(e+W.cx+W.x01,i+W.cy+W.y01),t.arc(e+W.cx,i+W.cy,v,Te(W.y01,W.x01),Te(j.y01,j.x01),!h)):t.moveTo(e+W.cx+v*Ei(Te(j.y01,j.x01)),i+W.cy+v*ti(Te(j.y01,j.x01))):!s||s[0]?(t.moveTo(e+W.cx+W.x01,i+W.cy+W.y01),N>0&&t.arc(e+W.cx,i+W.cy,N,Te(W.y01,W.x01),Te(W.y11,W.x11),!h),t.arc(e,i,r,Te(W.cy+W.y11,W.cx+W.x11),Te(j.cy+j.y11,j.cx+j.x11),!h),U>0&&t.arc(e+j.cx,i+j.cy,U,Te(j.y11,j.x11),Te(j.y01,j.x01),!h)):U>0?t.moveTo(e+j.cx+U*Ei(Te(j.y01,j.x01)),i+j.cy+U*ti(Te(j.y01,j.x01))):t.moveTo(e+w,i+r*ti(x))}else!s||s[0]?(t.moveTo(e+f,i+g),t.arc(e,i,r,S,x,!h)):t.moveTo(e+r*Ei(x),i+r*ti(x));if(!(o>je)||M<.001)!s||s[1]?t.lineTo(e+A,i+T):t.moveTo(e+A,i+T),d=!0;else if(E>je){const N=ki(D,E),U=ki(H,E),W=Fs(A,T,w,_,o,-U,Number(h)),j=Fs(f,g,m,p,o,-N,Number(h));if(!s||s[1]?t.lineTo(e+W.cx+W.x01,i+W.cy+W.y01):t.moveTo(e+W.cx+W.x01,i+W.cy+W.y01),E<O&&N===U){const Y=Te(j.y01,j.x01);!s||s[2]?t.arc(e+W.cx,i+W.cy,E,Te(W.y01,W.x01),Y,!h):t.moveTo(e+W.cx+Ei(Y),i+W.cy+ti(Y))}else!s||s[2]?(U>0&&t.arc(e+W.cx,i+W.cy,U,Te(W.y01,W.x01),Te(W.y11,W.x11),!h),t.arc(e,i,o,Te(W.cy+W.y11,W.cx+W.x11),Te(j.cy+j.y11,j.cx+j.x11),h),N>0&&t.arc(e+j.cx,i+j.cy,N,Te(j.y11,j.x11),Te(j.y01,j.x01),!h)):N>0?t.moveTo(e+j.cx+N*Ei(Te(j.y01,j.x01)),i+j.cy+N*ti(Te(j.y01,j.x01))):t.moveTo(e+m,i+p)}else!s||s[1]?t.lineTo(e+A,i+T):t.moveTo(e+A,i+T),!s||s[2]?t.arc(e,i,o,L,I,h):t.moveTo(e+o*Ei(I),i+o*ti(I))}return s?s[3]&&t.lineTo(e+r*Ei(a),i+r*ti(a)):t.closePath(),d}const N_=Symbol.for("ArcRenderContribution"),O9=Symbol.for("AreaRenderContribution"),W_=Symbol.for("CircleRenderContribution"),Un=Symbol.for("GroupRenderContribution"),La=Symbol.for("ImageRenderContribution"),U_=Symbol.for("PathRenderContribution"),V_=Symbol.for("PolygonRenderContribution"),Da=Symbol.for("RectRenderContribution"),j_=Symbol.for("SymbolRenderContribution"),vg=Symbol.for("TextRenderContribution"),Rw=Symbol.for("InteractiveSubRenderContribution");function _u(n,t){return n==="end"||n==="right"?-t:n==="center"?-t/2:0}function md(n,t,e,i=0){return n==="middle"?-t/2:n==="top"?0:n==="bottom"?i-t:n&&n!=="alphabetic"?0:(e||(e=t),-(t-e)/2-.79*e)}var H9=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},z9=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},N9=function(n,t){return function(e,i){t(e,i,n)}};function RL(n,t,e){var i;const{x:r=e.x,y:o=e.y,z:s=e.z,dx:a=e.dx,dy:l=e.dy,dz:u=e.dz,scaleX:h=e.scaleX,scaleY:d=e.scaleY,scaleZ:c=e.scaleZ,alpha:f=e.alpha,beta:g=e.beta,angle:m=e.angle,anchor3d:p=t.attribute.anchor,anchor:v}=t.attribute,b=[0,0,0];if(p){if(typeof p[0]=="string"){const C=parseFloat(p[0])/100,y=t.AABBBounds;b[0]=y.x1+(y.x2-y.x1)*C}else b[0]=p[0];if(typeof p[1]=="string"){const C=parseFloat(p[1])/100,y=t.AABBBounds;b[1]=y.x1+(y.x2-y.x1)*C}else b[1]=p[1];b[2]=(i=p[2])!==null&&i!==void 0?i:0}if(CL(n),lh(n,n,[r+a,o+l,s+u]),lh(n,n,[b[0],b[1],b[2]]),g9(n,n,g),p9(n,n,f),lh(n,n,[-b[0],-b[1],b[2]]),v9(n,n,[h,d,c]),m){const C=Pi.allocate(),y=[0,0];if(v){if(typeof p[0]=="string"){const w=parseFloat(p[0])/100,_=t.AABBBounds;y[0]=_.x1+(_.x2-_.x1)*w}else y[0]=p[0];if(typeof p[1]=="string"){const w=parseFloat(p[1])/100,_=t.AABBBounds;y[1]=_.x1+(_.x2-_.x1)*w}else y[1]=p[1]}lh(C,C,[y[0],y[1],0]),m9(C,C,m),lh(C,C,[-y[0],-y[1],0]),Xd(n,n,C)}}function W9(n){const{alpha:t,beta:e}=n.attribute;return t||e}let G_=class{constructor(n){this.creator=n,this.hooks={onAttributeUpdate:new Vr(["graphic"]),onSetStage:new Vr(["graphic","stage"]),onRemove:new Vr(["graphic"]),onRelease:new Vr(["graphic"]),onAddIncremental:new Vr(["graphic","group","stage"]),onClearIncremental:new Vr(["graphic","group","stage"]),beforeUpdateAABBBounds:new Vr(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new Vr(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new Vr(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new Ye,this.tempAABBBounds2=new Ye}onAttributeUpdate(n){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(n)}onSetStage(n,t){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(n,t)}onRemove(n){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(n)}onRelease(n){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(n)}onAddIncremental(n,t,e){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(n,t,e)}onClearIncremental(n,t){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(n,t)}beforeUpdateAABBBounds(n,t,e,i){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(n,t,e,i)}afterUpdateAABBBounds(n,t,e,i,r){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(n,t,e,i,r)}clearAABBBounds(n,t,e){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(n,t,e)}updatePathProxyAABBBounds(n,t){const e=typeof t.pathProxy=="function"?t.pathProxy(t.attribute):t.pathProxy;if(!e)return!1;const i=new fw(n);return fs(e.commandList,i,0,0),!0}updateHTMLTextAABBBounds(n,t,e,i){const{textAlign:r,textBaseline:o}=n;if(n.forceBoundsHeight!=null){const s=ne(n.forceBoundsHeight)?n.forceBoundsHeight:n.forceBoundsHeight(),a=md(o,s,s);e.set(e.x1,a,e.x2,a+s)}if(n.forceBoundsWidth!=null){const s=ne(n.forceBoundsWidth)?n.forceBoundsWidth:n.forceBoundsWidth(),a=_u(r,s);e.set(a,e.y1,a+s,e.y2)}}combindShadowAABBBounds(n,t){if(t&&t.shadowRoot){const e=t.shadowRoot.AABBBounds;n.union(e)}}transformAABBBounds(n,t,e,i,r){if(!t.empty()){const{scaleX:a=e.scaleX,scaleY:l=e.scaleY,stroke:u=e.stroke,shadowBlur:h=e.shadowBlur,lineWidth:d=e.lineWidth,pickStrokeBuffer:c=e.pickStrokeBuffer,strokeBoundsBuffer:f=e.strokeBoundsBuffer}=n,g=this.tempAABBBounds1,m=this.tempAABBBounds2;if(u&&d){const p=(d+c)/Math.abs(a+l);pg(g,p,i,f),t.union(g),g.setValue(m.x1,m.y1,m.x2,m.y2)}if(h){const{shadowOffsetX:p=e.shadowOffsetX,shadowOffsetY:v=e.shadowOffsetY}=n,b=h/Math.abs(a+l)*2;pg(g,b,!1,f+1),g.translate(p,v),t.union(g)}}if(this.combindShadowAABBBounds(t,r),t.empty())return;let o=!0;const s=r.transMatrix;r&&r.isContainer&&(o=!(s.a===1&&s.b===0&&s.c===0&&s.d===1&&s.e===0&&s.f===0)),o&&hw(t,t,s)}validCheck(n,t,e,i){if(!i||n.forceBoundsHeight!=null||n.forceBoundsWidth!=null||i.shadowRoot||i.isContainer)return!0;const{visible:r=t.visible}=n;return!(!i.valid||!r)||(e.empty()||(i.parent&&e.transformWithMatrix(i.parent.globalTransMatrix),this.clearAABBBounds(i,i.stage,e),e.clear()),!1)}updateTempAABBBounds(n){const t=this.tempAABBBounds1,e=this.tempAABBBounds2;return t.setValue(n.x1,n.y1,n.x2,n.y2),e.setValue(n.x1,n.y1,n.x2,n.y2),{tb1:t,tb2:e}}};G_=H9([Tt(),N9(0,ge(bL)),z9("design:paramtypes",[Object])],G_);const Yd=(n,t,e)=>{const{outerBorder:i,shadowBlur:r=t.shadowBlur}=n;if(i){const o=t.outerBorder,{distance:s=o.distance,lineWidth:a=o.lineWidth}=i;e.expand(s+(r+a)/2)}return e},LT=["radius","startAngle","endAngle",...In];class Cu extends Hi{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=km}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:t,endAngle:e,radius:i}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)}getGraphicTheme(){return ae(this).circle}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));const{tb1:o,tb2:s}=Mt.graphicService.updateTempAABBBounds(i);return Yd(t,e,o),i.union(o),o.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,Mt.graphicService.transformAABBBounds(t,i,e,!1,this),i}updateCircleAABBBoundsImprecise(t,e,i){const{radius:r=e.radius}=t;return i.set(-r,-r,r,r),i}updateCircleAABBBoundsAccurate(t,e,i){const{startAngle:r=e.startAngle,endAngle:o=e.endAngle,radius:s=e.radius}=t;return o-r>Zt-je?i.set(-s,-s,s,s):k_(r,o,s,i),i}needUpdateTags(t){return super.needUpdateTags(t,LT)}needUpdateTag(t){return super.needUpdateTag(t,LT)}toCustomPath(){var t,e,i;let r=super.toCustomPath();if(r)return r;const o=this.attribute,s=(t=o.radius)!==null&&t!==void 0?t:this.getDefaultAttribute("radius"),a=(e=o.startAngle)!==null&&e!==void 0?e:this.getDefaultAttribute("startAngle"),l=(i=o.endAngle)!==null&&i!==void 0?i:this.getDefaultAttribute("endAngle");return r=new Fi,r.arc(0,0,s,a,l),r}clone(){return new Cu(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Cu.NOWORK_ANIMATE_ATTR}}Cu.NOWORK_ANIMATE_ATTR=so;function EL(n){return new Cu(n)}class $_{constructor(t,e,i){this.fontFamily=t,this.textOptions=e,this.textMeasure=i}LayoutBBox(t,e,i,r){if(t.xOffset=e==="left"||e==="start"?0:e==="center"?t.width/-2:e==="right"||e==="end"?-t.width:0,i==="top")t.yOffset=0;else if(i==="middle")t.yOffset=t.height/-2;else if(i==="alphabetic"){let o=.79;if(r.length===1){const s=r[0];o=s.ascent/(s.ascent+s.descent)}t.yOffset=t.height*-o}else t.yOffset=-t.height;return t}GetLayoutByLines(t,e,i,r,o="",s,a){const{lineWidth:l,suffixPosition:u="end",measureMode:h=Ua.actualBounding,keepCenterInLine:d=!1}=a??{};t=t.map(m=>m.toString());const c=[],f=[0,0];if(typeof l=="number"&&l!==1/0){let m;for(let p=0,v=t.length;p<v;p++){const b=this.textMeasure.measureTextPixelADscentAndWidth(t[p],this.textOptions,h);let C=t[p].toString();if(b.width>l){const y=this.textMeasure.clipTextWithSuffix(t[p],this.textOptions,l,o,s,u);C=y.str,m=y.width}else m=b.width;c.push({str:C,width:m,ascent:b.ascent,descent:b.descent,keepCenterInLine:d})}f[0]=l}else{let m,p,v=0;for(let b=0,C=t.length;b<C;b++){p=t[b];const y=this.textMeasure.measureTextPixelADscentAndWidth(t[b],this.textOptions,h);m=y.width,v=Math.max(v,m),c.push({str:p,width:m,ascent:y.ascent,descent:y.descent,keepCenterInLine:d})}f[0]=v}f[1]=c.length*r,f[0]=c.reduce((m,p)=>Math.max(m,p.width),0);const g={xOffset:0,yOffset:0,width:f[0],height:f[1]};return this.LayoutBBox(g,e,i,c),this.layoutWithBBox(g,c,e,i,r)}layoutWithBBox(t,e,i,r,o){const s=[0,0],a=e.length*o;r==="top"||(r==="middle"?s[1]=(t.height-a)/2:r==="bottom"&&(s[1]=t.height-a));for(let l=0;l<e.length;l++)this.lineOffset(t,e[l],i,r,o,s);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:o,textAlign:i,textBaseline:r}}lineOffset(t,e,i,r,o,s){if(i==="left"||i==="start"?e.leftOffset=0:i==="center"?e.leftOffset=(t.width-e.width)/2:i!=="right"&&i!=="end"||(e.leftOffset=t.width-e.width),e.topOffset=o/2+(e.ascent-e.descent)/2+s[1],!e.keepCenterInLine){const l=e.ascent+e.descent+0;if(l<o-0&&(r==="bottom"?e.topOffset+=(o-l)/2:r==="top"&&(e.topOffset-=(o-l)/2)),r==="alphabetic"){const u=o/(e.ascent+e.descent);e.topOffset=o/2+(e.ascent-e.descent)/2*u+s[1]}}return s[1]+=o,e}}const DT=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...In];let ji=class Rs extends Hi{get font(){const t=this.getGraphicTheme();return this._font||(this._font=lg(this.attribute,t)),this._font}get clipedText(){var t;const e=this.attribute,i=this.getGraphicTheme(),r=this.getMaxWidth(i);return Number.isFinite(r)?(this.tryUpdateAABBBounds(),this.cache.clipedText):((t=e.text)!==null&&t!==void 0?t:i.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var t,e;const i=this.getGraphicTheme(),r=this.attribute,o=this.getMaxWidth(i);if(!Number.isFinite(o))return!1;const{text:s}=this.attribute;if(this.tryUpdateAABBBounds(),(e=(t=this.cache)===null||t===void 0?void 0:t.layoutData)===null||e===void 0?void 0:e.lines){let a="";return this.cache.layoutData.lines.forEach(l=>{a+=l.str}),(Array.isArray(s)?s.join(""):s)!==a}return r.direction==="vertical"&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(a=>a.text).join("")!==r.text.toString():this.clipedText!=null&&this.clipedText!==r.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||this.attribute.whiteSpace==="normal"}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=Om,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{text:t}=this.attribute;return jt(t)?!t.every(e=>e==null||e===""):t!=null&&t!==""}getGraphicTheme(){return ae(this).text}doUpdateOBBBounds(){const t=this.getGraphicTheme();this._OBBBounds.clear();const e=this.attribute,{angle:i=t.angle}=e;if(!i){const u=this.AABBBounds;return this._OBBBounds.setValue(u.x1,u.y1,u.x2,u.y2),this._OBBBounds}this.obbText||(this.obbText=new Rs({})),this.obbText.setAttributes(Object.assign(Object.assign({},e),{angle:0}));const r=this.obbText.AABBBounds,{x:o,y:s}=e,a={x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2},l=Ro(a,i,{x:o,y:s});return this._OBBBounds.copy(r),this._OBBBounds.translate(l.x-a.x,l.y-a.y),this._OBBBounds.angle=i,this._OBBBounds}updateAABBBounds(t,e,i){const{text:r=e.text}=this.attribute;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);const{tb1:o}=Mt.graphicService.updateTempAABBBounds(i),{scaleX:s=e.scaleX,scaleY:a=e.scaleY,shadowBlur:l=e.shadowBlur,strokeBoundsBuffer:u=e.strokeBoundsBuffer}=t;if(l){const h=l/Math.abs(s+a);pg(o,h,!0,u),i.union(o)}return Mt.graphicService.combindShadowAABBBounds(i,this),t.forceBoundsHeight==null&&t.forceBoundsWidth==null||Mt.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,hw(i,i,this.transMatrix),i}updateSingallineAABBBounds(t){this.updateMultilineAABBBounds([t]);const e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){const i=e.lines[0];this.cache.clipedText=i.str,this.cache.clipedWidth=i.width}return this._AABBBounds}updateMultilineAABBBounds(t){const e=this.getGraphicTheme(),{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,o=i==="horizontal"?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return i==="horizontal"&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),o}guessLineHeightBuf(t){return t?.1*t:0}updateHorizontalMultilineAABBBounds(t){var e;const i=this.getGraphicTheme(),r=this.attribute,{fontFamily:o=i.fontFamily,textAlign:s=i.textAlign,textBaseline:a=i.textBaseline,fontSize:l=i.fontSize,fontWeight:u=i.fontWeight,ellipsis:h=i.ellipsis,maxLineWidth:d,stroke:c=i.stroke,wrap:f=i.wrap,measureMode:g=i.measureMode,lineWidth:m=i.lineWidth,whiteSpace:p=i.whiteSpace,suffixPosition:v=i.suffixPosition,ignoreBuf:b=i.ignoreBuf,keepCenterInLine:C=i.keepCenterInLine}=r,y=b?0:this.guessLineHeightBuf(l),w=this.getLineHeight(r,i,y);if(p==="normal"||f)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(!((e=this.cache)===null||e===void 0)&&e.layoutData)){const S=this.cache.layoutData.bbox;return this._AABBBounds.set(S.xOffset,S.yOffset,S.xOffset+S.width,S.yOffset+S.height),c&&this._AABBBounds.expand(m/2),this._AABBBounds}const _=Mt.graphicUtil.textMeasure,A=new $_(o,{fontSize:l,fontWeight:u,fontFamily:o,lineHeight:w},_).GetLayoutByLines(t,s,a,w,h===!0?i.ellipsis:h||void 0,!1,{lineWidth:d,suffixPosition:v,measureMode:g,keepCenterInLine:C}),{bbox:T}=A;return this.cache.layoutData=A,this.clearUpdateShapeTag(),this._AABBBounds.set(T.xOffset,T.yOffset,T.xOffset+T.width,T.yOffset+T.height),c&&this._AABBBounds.expand(m/2),this._AABBBounds}updateWrapAABBBounds(t){var e,i,r;const o=this.getGraphicTheme(),{fontFamily:s=o.fontFamily,textAlign:a=o.textAlign,textBaseline:l=o.textBaseline,fontSize:u=o.fontSize,ellipsis:h=o.ellipsis,maxLineWidth:d,stroke:c=o.stroke,lineWidth:f=o.lineWidth,wordBreak:g=o.wordBreak,fontWeight:m=o.fontWeight,ignoreBuf:p=o.ignoreBuf,measureMode:v=o.measureMode,suffixPosition:b=o.suffixPosition,heightLimit:C=0,lineClamp:y,keepCenterInLine:w=o.keepCenterInLine}=this.attribute,_=p?0:this.guessLineHeightBuf(u),A=this.getLineHeight(this.attribute,o,_);if(!this.shouldUpdateShape()&&(!((e=this.cache)===null||e===void 0)&&e.layoutData)){const O=this.cache.layoutData.bbox;return this._AABBBounds.set(O.xOffset,O.yOffset,O.xOffset+O.width,O.yOffset+O.height),c&&this._AABBBounds.expand(f/2),this._AABBBounds}const T=Mt.graphicUtil.textMeasure,S={fontSize:u,fontWeight:m,fontFamily:s,lineHeight:A},x=new $_(s,S,T),E=jt(t)?t.map(O=>O.toString()):[t.toString()],M=[],L=[0,0];let I=1/0;if(C>0&&(I=Math.max(Math.floor(C/A),1)),y&&(I=Math.min(I,y)),typeof d=="number"&&d!==1/0){if(d>0)for(let N=0;N<E.length;N++){const U=E[N];let W=!0;if(N===I-1){const rt=T.clipTextWithSuffix(U,S,d,h,!1,b,N!==E.length-1),J=T.measureTextPixelADscentAndWidth(rt.str,S,v);M.push({str:rt.str,width:rt.width,ascent:J.ascent,descent:J.descent,keepCenterInLine:w});break}const j=T.clipText(U,S,d,g!=="break-all",g==="keep-all");if(U!==""&&j.str===""||j.wordBreaked){if(h){const rt=T.clipTextWithSuffix(U,S,d,h,!1,b);j.str=(i=rt.str)!==null&&i!==void 0?i:"",j.width=(r=rt.width)!==null&&r!==void 0?r:0}else j.str="",j.width=0;W=!1}const Y=T.measureTextPixelADscentAndWidth(j.str,S,v);M.push({str:j.str,width:j.width,ascent:Y.ascent,descent:Y.descent,keepCenterInLine:w});let Z=j.str.length;if(!j.wordBreaked||U!==""&&j.str===""||(W=!0,Z=j.wordBreaked),j.str.length!==U.length){if(W){let rt=U.substring(Z);g==="keep-all"&&(rt=rt.replace(/^\s+/g,"")),E.splice(N+1,0,rt)}}}let O=0;M.forEach(N=>{O=Math.max(O,N.width)}),L[0]=O}else{let O,N,U=0;for(let W=0,j=E.length;W<j;W++){if(W===I-1){const Z=T.clipTextWithSuffix(E[W],S,d,h,!1,b),rt=T.measureTextPixelADscentAndWidth(Z.str,S,v);M.push({str:Z.str,width:Z.width,ascent:rt.ascent,descent:rt.descent,keepCenterInLine:w}),U=Math.max(U,Z.width);break}N=E[W],O=T.measureTextWidth(N,S),U=Math.max(U,O);const Y=T.measureTextPixelADscentAndWidth(N,S,v);M.push({str:N,width:O,ascent:Y.ascent,descent:Y.descent,keepCenterInLine:w})}L[0]=U}L[1]=M.length*A;const D={xOffset:0,yOffset:0,width:L[0],height:L[1]};x.LayoutBBox(D,a,l,M);const H=x.layoutWithBBox(D,M,a,l,A);return this.cache.layoutData=H,this.clearUpdateShapeTag(),this._AABBBounds.set(D.xOffset,D.yOffset,D.xOffset+D.width,D.yOffset+D.height),c&&this._AABBBounds.expand(f/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,i;const r=this.getGraphicTheme(),o=Mt.graphicUtil.textMeasure;let s;const a=this.attribute,{maxLineWidth:l=r.maxLineWidth,ellipsis:u=r.ellipsis,fontFamily:h=r.fontFamily,fontSize:d=r.fontSize,fontWeight:c=r.fontWeight,stroke:f=r.stroke,lineWidth:g=r.lineWidth,verticalMode:m=r.verticalMode,suffixPosition:p=r.suffixPosition}=a,v=this.getLineHeight(a,r,0);let{textAlign:b=r.textAlign,textBaseline:C=r.textBaseline}=a;if(!m){const T=b;b=(e=Rs.baselineMapAlign[C])!==null&&e!==void 0?e:"left",C=(i=Rs.alignMapBaseline[T])!==null&&i!==void 0?i:"top"}if(s=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(E=>{const M=E.reduce((L,I)=>L+I.width,0);s=un(M,s)});const T=_u(b,s),S=this.cache.verticalList.length*v,x=md(C,S,d);return this._AABBBounds.set(x,T,x+S,T+s),f&&this._AABBBounds.expand(g/2),this._AABBBounds}const y=t.map(T=>a9(T.toString()));y.forEach((T,S)=>{if(Number.isFinite(l))if(u){const x=u===!0?r.ellipsis:u,E=o.clipTextWithSuffixVertical(T,{fontSize:d,fontWeight:c,fontFamily:h},l,x,!1,p);y[S]=E.verticalList,s=E.width}else{const x=o.clipTextVertical(T,{fontSize:d,fontWeight:c,fontFamily:h},l,!1);y[S]=x.verticalList,s=x.width}else s=0,T.forEach(x=>{const E=x.direction===Xl.HORIZONTAL?d:o.measureTextWidth(x.text,{fontSize:d,fontWeight:c,fontFamily:h});s+=E,x.width=E})}),this.cache.verticalList=y,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(T=>{const S=T.reduce((x,E)=>x+E.width,0);s=un(S,s)});const w=_u(b,s),_=this.cache.verticalList.length*v,A=md(C,_,d);return this._AABBBounds.set(A,w,A+_,w+s),f&&this._AABBBounds.expand(g/2),this._AABBBounds}getMaxWidth(t){var e,i;const r=this.attribute;return(i=(e=r.maxLineWidth)!==null&&e!==void 0?e:r.maxWidth)!==null&&i!==void 0?i:t.maxWidth}getLineHeight(t,e,i){var r;return(r=$d(t.lineHeight,t.fontSize||e.fontSize))!==null&&r!==void 0?r:(t.fontSize||e.fontSize)+i}needUpdateTags(t,e=DT){return super.needUpdateTags(t,e)}needUpdateTag(t,e=DT){return super.needUpdateTag(t,e)}_interpolate(t,e,i,r,o){t==="text"&&(o.text=r)}clone(){return new Rs(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Rs.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return Rs.baselineMapAlign}getAlignMapBaseline(){return Rs.alignMapBaseline}};ji.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},so),ji.baselineMapAlign={top:"left",bottom:"right",middle:"center"},ji.alignMapBaseline={left:"top",right:"bottom",center:"middle"};function q_(n){return new ji(n)}const Yc=["heightLimit","lineClamp"];class Ew extends ji{constructor(t){super(Object.assign(Object.assign({},t),{wrap:!0}))}_isValid(){const{text:t}=this.attribute;return jt(t)?!t.every(e=>e==null||e===""):t!=null&&t!==""}updateMultilineAABBBounds(t){var e,i,r,o;const s=this.getGraphicTheme(),{fontFamily:a=s.fontFamily,textAlign:l=s.textAlign,textBaseline:u=s.textBaseline,fontSize:h=s.fontSize,ellipsis:d=s.ellipsis,maxLineWidth:c,stroke:f=s.stroke,lineWidth:g=s.lineWidth,wordBreak:m=s.wordBreak,fontWeight:p=s.fontWeight,ignoreBuf:v=s.ignoreBuf,heightLimit:b=0,suffixPosition:C=s.suffixPosition,lineClamp:y}=this.attribute,w=(e=$d(this.attribute.lineHeight,this.attribute.fontSize||s.fontSize))!==null&&e!==void 0?e:this.attribute.fontSize||s.fontSize,_=v?0:2;if(!this.shouldUpdateShape()&&(!((i=this.cache)===null||i===void 0)&&i.layoutData)){const D=this.cache.layoutData.bbox;return this._AABBBounds.set(D.xOffset,D.yOffset,D.xOffset+D.width,D.yOffset+D.height),f&&this._AABBBounds.expand(g/2),this._AABBBounds}const A=Mt.graphicUtil.textMeasure,T=new $_(a,{fontSize:h,fontWeight:p,fontFamily:a},A),S=t.map(D=>D.toString()),x=[],E=[0,0];let M=1/0;if(b>0&&(M=Math.max(Math.floor(b/w),1)),y&&(M=Math.min(M,y)),typeof c=="number"&&c!==1/0){if(c>0)for(let H=0;H<S.length;H++){const O=S[H];let N=!0;if(H===M-1){const W=T.textMeasure.clipTextWithSuffix(O,T.textOptions,c,d,!1,C);x.push({str:W.str,width:W.width,ascent:0,descent:0,keepCenterInLine:!1});break}const U=T.textMeasure.clipText(O,T.textOptions,c,m==="break-word");if(O!==""&&U.str===""){if(d){const W=T.textMeasure.clipTextWithSuffix(O,T.textOptions,c,d,!1,C);U.str=(r=W.str)!==null&&r!==void 0?r:"",U.width=(o=W.width)!==null&&o!==void 0?o:0}else U.str="",U.width=0;N=!1}if(x.push({str:U.str,width:U.width,ascent:0,descent:0,keepCenterInLine:!1}),U.str.length!==O.length){if(N){const W=O.substring(U.str.length);S.splice(H+1,0,W)}}}let D=0;x.forEach(H=>{D=Math.max(D,H.width)}),E[0]=D}else{let D,H,O=0;for(let N=0,U=S.length;N<U;N++){if(N===M-1){const W=T.textMeasure.clipTextWithSuffix(S[N],T.textOptions,c,d,!1,C);x.push({str:W.str,width:W.width,ascent:0,descent:0,keepCenterInLine:!1}),O=Math.max(O,W.width);break}H=S[N],D=T.textMeasure.measureTextWidth(H,T.textOptions,m==="break-word"),O=Math.max(O,D),x.push({str:H,width:D,ascent:0,descent:0,keepCenterInLine:!1})}E[0]=O}E[1]=x.length*(w+_);const L={xOffset:0,yOffset:0,width:E[0],height:E[1]};T.LayoutBBox(L,l,u);const I=T.layoutWithBBox(L,x,l,u,w);return this.cache.layoutData=I,this.clearUpdateShapeTag(),this._AABBBounds.set(L.xOffset,L.yOffset,L.xOffset+L.width,L.yOffset+L.height),f&&this._AABBBounds.expand(g/2),this._AABBBounds}needUpdateTags(t){for(let e=0;e<Yc.length;e++){const i=Yc[e];if(t.indexOf(i)!==-1)return!0}return super.needUpdateTags(t)}needUpdateTag(t){for(let e=0;e<Yc.length;e++)if(t===Yc[e])return!0;return super.needUpdateTag(t)}getNoWorkAnimateAttr(){return Ew.NOWORK_ANIMATE_ATTR}}function U9(n){return new Ew(n)}const V9=(n,t,e)=>{const{outerBorder:i,shadowBlur:r=t.shadowBlur,strokeBoundsBuffer:o=t.strokeBoundsBuffer}=n;if(i){const s=t.outerBorder,{distance:a=s.distance,lineWidth:l=s.lineWidth}=i;pg(e,a+(r+l)/2,!0,o)}return e},IT=["symbolType","size",...In];let ML=class X_ extends Hi{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=Fm}getParsedPath(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}getParsedPath2D(t=0,e=0,i=1){let r=null;try{r=new Path2D}catch{return null}const o=this.getParsedPath();if(!o)return null;o.draw(r,i,t,e)}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{size:t}=this.attribute;return jt(t)?t.length===2&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){const{symbolType:t="circle"}=this.attribute;return super.parsePath(t)}getGraphicTheme(){return ae(this).symbol}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));const{tb1:o,tb2:s}=Mt.graphicService.updateTempAABBBounds(i);V9(t,e,o),i.union(o),o.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;const{lineJoin:a=e.lineJoin}=t;return Mt.graphicService.transformAABBBounds(t,i,e,a==="miter",this),i}updateSymbolAABBBoundsImprecise(t,e,i){const{size:r=e.size}=t;if(jt(r))i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2);else{const o=r/2;i.set(-o,-o,o,o)}return i}updateSymbolAABBBoundsAccurate(t,e,i){const{size:r=e.size}=t;return this.getParsedPath().bounds(r,i),i}needUpdateTags(t){return super.needUpdateTags(t,IT)}needUpdateTag(t){return super.needUpdateTag(t,IT)}toCustomPath(){const t=this.getParsedPath(),e=this.attribute.size,i=jt(e)?e:[e,e];return t.path?new Fi().fromCustomPath2D(t.path,0,0,i[0],i[1]):new Fi().fromString(t.pathStr,0,0,i[0],i[1])}clone(){return new X_(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return X_.NOWORK_ANIMATE_ATTR}};ML.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},so);function yu(n){return new ML(n)}const FT=["segments","points","curveType","curveTension",...In];let BL=class Y_ extends Hi{constructor(t={}){super(t),this.type="line",this.numberType=qd}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;const{points:t,segments:e}=this.attribute;return e?e.length!==0:!!t&&!(t.length<=1)}_interpolate(t,e,i,r,o){t==="points"&&(o.points=bw(i,r,e))}getGraphicTheme(){return ae(this).line}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),Mt.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;const{lineJoin:r=e.lineJoin}=t;return Mt.graphicService.transformAABBBounds(t,i,e,r==="miter",this),i}updateLineAABBBoundsByPoints(t,e,i,r){const{points:o=e.points,connectedType:s}=t,a=i;return o.forEach(l=>{l.defined===!1&&s!=="connect"||a.add(l.x,l.y)}),a}updateLineAABBBoundsBySegments(t,e,i,r){const{segments:o=e.segments,connectedType:s}=t,a=i;return o.forEach(l=>{l.points.forEach(u=>{u.defined===!1&&s!=="connect"||a.add(u.x,u.y)})}),a}needUpdateTags(t){return super.needUpdateTags(t,FT)}needUpdateTag(t){return super.needUpdateTag(t,FT)}toCustomPath(){let t=super.toCustomPath();if(t)return t;const e=this.attribute;t=new Fi;const i=e.segments,r=o=>{if(o&&o.length){let s=!0;o.forEach(a=>{a.defined!==!1&&(s?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y),s=!1)})}};return i&&i.length?i.forEach(o=>{r(o.points)}):e.points&&r(e.points),t}clone(){return new Y_(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Y_.NOWORK_ANIMATE_ATTR}};BL.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},so);function ln(n){return new BL(n)}const j9=n=>{if(!n)return{x:0,y:0,width:0,height:0};let t=zt(n.width)?n.x1-n.x:n.width,e=zt(n.height)?n.y1-n.y:n.height,i=0,r=0;return t<0?(i=t,t=-t):Number.isNaN(t)&&(t=0),e<0?(r=e,e=-e):Number.isNaN(e)&&(e=0),{x:i,y:r,width:t,height:e}},OT=["width","x1","y1","height","cornerRadius",...In];let Kd=class K_ extends Hi{constructor(t){super(t),this.type="rect",this.numberType=Cw}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return ae(this).rect}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{width:s,height:a}=t;const{x1:l,y1:u,x:h,y:d}=t;s=s??l-h,a=a??u-d,(isFinite(s)||isFinite(a)||isFinite(h)||isFinite(d))&&i.set(0,0,s||0,a||0)}const{tb1:r,tb2:o}=Mt.graphicService.updateTempAABBBounds(i);return Yd(t,e,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,Mt.graphicService.transformAABBBounds(t,i,e,!1,this),i}needUpdateTags(t){return super.needUpdateTags(t,OT)}needUpdateTag(t){return super.needUpdateTag(t,OT)}toCustomPath(){let t=super.toCustomPath();if(t)return t;const e=this.attribute,{x:i,y:r,width:o,height:s}=j9(e);return t=new Fi,t.moveTo(i,r),t.rect(i,r,o,s),t}clone(){return new K_(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return K_.NOWORK_ANIMATE_ATTR}};Kd.NOWORK_ANIMATE_ATTR=so;function Ge(n){return new Kd(n)}class G9{constructor(t,e,i,r,o,s,a,l,u,h,d,c,f,g){this.left=t,this.top=e,this.width=i,this.height=r,this.actualHeight=0,this.bottom=e+r,this.right=t+i,this.ellipsis=o,this.wordBreak=s,this.verticalDirection=a,this.lines=[],this.globalAlign=l,this.globalBaseline=u,this.layoutDirection=h,this.directionKey=pw[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=c,this.singleLine=f,g?(g.clear(),this.icons=g):this.icons=new Map}draw(t,e){const{width:i,height:r}=this.getActualSize(),o=this.isWidthMax?Math.min(this.width,i):this.width||i||0;let s=this.isHeightMax?Math.min(this.height,r):this.height||r||0;s=Math.min(s,r);let a=0;switch(this.globalBaseline){case"top":a=0;break;case"middle":a=-s/2;break;case"bottom":a=-s}let l=0;this.globalAlign==="right"||this.globalAlign==="end"?l=-o:this.globalAlign==="center"&&(l=-o/2);let u=this[this.directionKey.height];this.singleLine&&(u=this.lines[0].height+1);let h=!1;if(this.verticalDirection==="middle")if(this.actualHeight>=u&&u!==0)for(let d=0;d<this.lines.length;d++){const{top:c,height:f}=this.lines[d];if(c+f<this[this.directionKey.top]||c+f>this[this.directionKey.top]+u)return h;let g=!1;this.ellipsis&&this.lines[d+1]&&this.lines[d+1].top+this.lines[d+1].height>this[this.directionKey.top]+u&&(g=!0,h=!0),this.lines[d].draw(t,g,this.lines[d][this.directionKey.left]+l,this.lines[d][this.directionKey.top]+a,this.ellipsis,e)}else{const d=Math.floor((u-this.actualHeight)/2);this.layoutDirection==="vertical"?l+=d:a+=d;for(let c=0;c<this.lines.length;c++)this.lines[c].draw(t,!1,this.lines[c][this.directionKey.left]+l,this.lines[c][this.directionKey.top]+a,this.ellipsis,e)}else if(this.verticalDirection==="bottom"&&this.layoutDirection!=="vertical")for(let d=0;d<this.lines.length;d++){const{top:c,height:f}=this.lines[d],g=u-this.lines[d].top-this.lines[d].height;if(u===0)this.lines[d].draw(t,!1,l,g+a,this.ellipsis,e);else{if(g+f>this[this.directionKey.top]+u||g<this[this.directionKey.top])return h;{let m=!1;this.ellipsis&&this.lines[d+1]&&g-this.lines[d+1].height<this[this.directionKey.top]&&(m=!0,h=!0),this.lines[d].draw(t,m,l,g+a,this.ellipsis,e)}}}else{this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(let d=0;d<this.lines.length;d++){this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&(l-=this.lines[d].height+this.lines[d].top);const{top:c,height:f}=this.lines[d];if(u===0)this.lines[d].draw(t,!1,this.lines[d][this.directionKey.left]+l,this.lines[d][this.directionKey.top]+a,this.ellipsis,e);else{if(c+f<this[this.directionKey.top]||c+f>this[this.directionKey.top]+u)return h;{let g=!1;this.ellipsis&&this.lines[d+1]&&this.lines[d+1].top+this.lines[d+1].height>this[this.directionKey.top]+u&&(g=!0,h=!0),this.lines[d].draw(t,g,this.lines[d][this.directionKey.left]+l,this.lines[d][this.directionKey.top]+a,this.ellipsis,e)}}}}return h}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let i=0;i<this.lines.length;i++){const r=this.lines[i];r.actualWidth>t&&(t=r.actualWidth),e+=r.height}return{width:this.layoutDirection==="vertical"?e:t,height:this.layoutDirection==="vertical"?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0;const{width:i,height:r}=this.getRawActualSize();this.width,this.height;let o=this[this.directionKey.height];if(this.singleLine&&(o=this.lines[0].height+1),this.verticalDirection==="middle")if(this.actualHeight>=o&&o!==0)for(let s=0;s<this.lines.length;s++){const{top:a,height:l}=this.lines[s];if(!(a+l<this[this.directionKey.top]||a+l>this[this.directionKey.top]+o))if(this.ellipsis&&this.lines[s+1]&&this.lines[s+1].top+this.lines[s+1].height>this[this.directionKey.top]+o){const u=this.ellipsis===!0?"...":this.ellipsis||"",h=this.lines[s].getWidthWithEllips(u);h>t&&(t=h),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else{Math.floor((o-this.actualHeight)/2);for(let s=0;s<this.lines.length;s++)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else if(this.verticalDirection==="bottom")for(let s=0;s<this.lines.length;s++){const{top:a,height:l}=this.lines[s],u=o-this.lines[s].top-this.lines[s].height;if(o===0)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height;else if(!(u+l>this[this.directionKey.top]+o||u<this[this.directionKey.top]))if(this.ellipsis&&this.lines[s+1]&&u-this.lines[s+1].height<this[this.directionKey.top]){const h=this.ellipsis===!0?"...":this.ellipsis||"",d=this.lines[s].getWidthWithEllips(h);d>t&&(t=d),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else for(let s=0;s<this.lines.length;s++){const{top:a,height:l}=this.lines[s];if(o===0)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height;else if(!(a+l<this[this.directionKey.top]||a+l>this[this.directionKey.top]+o))if(this.ellipsis&&this.lines[s+1]&&this.lines[s+1].top+this.lines[s+1].height>this[this.directionKey.top]+o){const u=this.ellipsis===!0?"...":this.ellipsis||"",h=this.lines[s].getWidthWithEllips(u);h>t&&(t=h),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}return{width:this.layoutDirection==="vertical"?e:t,height:this.layoutDirection==="vertical"?t:e}}}function dh(n,t,e,i){const r=Math.round(n),o=Math.round(e),s=Math.round(t),a=Math.round(i);return{left:n>r?r:r-.5,top:e>o?o:o-.5,right:s>t?s:s+.5,bottom:a>i?a:a+.5}}class Ia{constructor(t,e,i,r){var o,s;this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||"alphabetic",this.ascentDescentMode=r;const a=$d(i.lineHeight,this.fontSize);this.lineHeight=typeof a=="number"?a>this.fontSize?a:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;const{ascent:l,height:u,descent:h,width:d}=Aa(t,i,this.ascentDescentMode);let c=0,f=0,g=0;this.height>u&&(c=(this.height-u)/2,f=Math.ceil(c),g=Math.floor(c)),this.textBaseline==="top"?(this.ascent=c,this.descent=u-c):this.textBaseline==="bottom"?(this.ascent=u-c,this.descent=c):this.textBaseline==="middle"?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=l+f,this.descent=h+g),this.length=t.length,this.width=d||0,this.text=t||"",this.newLine=e||!1,this.character=i,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=i.space,this.dx=(o=i.dx)!==null&&o!==void 0?o:0,this.dy=(s=i.dy)!==null&&s!==void 0?s:0,i.direction==="vertical"&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){const{width:t}=Aa(this.text,this.character,this.ascentDescentMode);this.width=t,this.direction==="vertical"&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}drawBackground(t,e,i,r,o,s,a){if(this.text===""||this.text===`
`||!this.character.background||this.character.backgroundOpacity&&!(this.character.backgroundOpacity>0))return;let l=e+i,u=this.text,h=this.left+r;l+=this.top;let d=this.direction;if(this.verticalEllipsis)u=this.ellipsisStr,d="vertical",l-=this.ellipsisWidth/2;else{if(this.ellipsis==="hide")return;if(this.ellipsis==="add")u+=this.ellipsisStr,s!=="right"&&s!=="end"||(h-=this.ellipsisWidth);else if(this.ellipsis==="replace"){const f=Ef(u,(d==="vertical"?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,u.length-1);if(u=u.slice(0,f),u+=this.ellipsisStr,(s==="right"||s==="end")&&d!=="vertical"){const{width:g}=Aa(this.text.slice(f),this.character,this.ascentDescentMode);h-=this.ellipsisWidth-g}}}const c=dh(h,h+(this.widthOrigin||this.width),e,e+a);return Object.assign(Object.assign({},c),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}draw(t,e,i,r,o,s,a){var l;let u=e+i,h=this.text,d=this.left+r+((l=this.space)!==null&&l!==void 0?l:0)/2;u+=this.top;let c=this.direction;if(this.verticalEllipsis)h=this.ellipsisStr,c="vertical",u-=this.ellipsisWidth/2;else{if(this.ellipsis==="hide")return;if(this.ellipsis==="add")h+=this.ellipsisStr,s!=="right"&&s!=="end"||(d-=this.ellipsisWidth);else if(this.ellipsis==="replace"){const g=Ef(h,(c==="vertical"?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,h.length-1);if(h=h.slice(0,g),h+=this.ellipsisStr,(s==="right"||s==="end")&&c!=="vertical"){const{width:m}=Aa(this.text.slice(g),this.character,this.ascentDescentMode);d-=this.ellipsisWidth-m}}}switch(this.character.script){case"super":u-=this.ascent*(1/3);break;case"sub":u+=this.descent/2}c==="vertical"&&(t.save(),t.rotateAbout(Math.PI/2,d,u),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(d,u),d=0,u=0);const{lineWidth:f=1}=this.character;if(this.character.stroke&&f&&t.strokeText(h,d+this.dx,u+this.dy),this.character.fill&&t.fillText(h,d+this.dx,u+this.dy),this.character.fill){if(this.character.lineThrough||this.character.underline){if(this.character.underline){const g=1+u,m=dh(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(m.left,1+u,m.right-m.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){const g=1+u-this.ascent/2,m=dh(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(m.left,1+u-this.ascent/2,m.right-m.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if(this.character.textDecoration==="underline"){const g=1+u,m=dh(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(m.left,1+u,m.right-m.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if(this.character.textDecoration==="line-through"){const g=1+u-this.ascent/2,m=dh(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(m.left,1+u-this.ascent/2,m.right-m.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}c==="vertical"&&t.restore()}getWidthWithEllips(t){let e=this.text;const i=t==="vertical"?this.height:this.width;if(this.ellipsis==="hide")return i;if(this.ellipsis==="add")return i+this.ellipsisWidth;if(this.ellipsis==="replace"){const r=Ef(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,r),e+=this.ellipsisStr;const{width:o}=Aa(this.text.slice(r),this.character,this.ascentDescentMode);return i+this.ellipsisWidth-o}return i}}function $9(n,t){const e=n.text.slice(0,t),i=n.text.slice(t);return[new Ia(e,n.newLine,n.character,n.ascentDescentMode),new Ia(i,!0,n.character,n.ascentDescentMode)]}const HT=["width","height","image",...In];let Za=class Z_ extends Hi{constructor(t){super(t),this.type="image",this.numberType=Lm,this.loadImage(this.attribute.image)}getImageElement(){const{image:t}=this.attribute;if(!t||!this.resources)return null;const e=this.resources.get(t);return e.state!=="success"?null:e.data}get width(){return this.tryUpdateAABBBounds(),this._actualWidth}get height(){return this.tryUpdateAABBBounds(),this._actualHeight}get repeatX(){var t;return(t=this.attribute.repeatX)!==null&&t!==void 0?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return(t=this.attribute.repeatY)!==null&&t!==void 0?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,i){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()}),this.addUpdateBoundTag()}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,i){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,i)}setAttribute(t,e,i,r){return t==="image"&&this.loadImage(e),super.setAttribute(t,e,i,r)}getGraphicTheme(){return ae(this).image}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){const{maxWidth:s=e.maxWidth,maxHeight:a=e.maxHeight}=t;let{width:l,height:u}=t;if(l==null||u==null){const h=this.getImageElement();if(h){const d=h.width,c=h.height;if(l!=null)u=l*(c/d);else if(u!=null)l=u*(d/c);else{const f=d/c;f>s/a?(l=s,u=s/f):(u=a,l=a*f)}}else l=s,u=a}this._actualWidth=l,this._actualHeight=u,i.set(0,0,l,u)}const{tb1:r,tb2:o}=Mt.graphicService.updateTempAABBBounds(i);return Yd(t,e,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,Mt.graphicService.transformAABBBounds(t,i,e,!1,this),i}getDefaultAttribute(t){return dd[t]}needUpdateTags(t){return super.needUpdateTags(t,HT)}needUpdateTag(t){return super.needUpdateTag(t,HT)}clone(){return new Z_(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Z_.NOWORK_ANIMATE_ATTR}};Za.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},so);function Hm(n){return new Za(n)}class bo extends Za{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],t.backgroundShowMode==="always"&&(this._hovered=!0),t.margin){const e=gg(t.margin);this._marginArray=typeof e=="number"?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(e,i,r)=>{if(jt(r)&&r.indexOf("margin")!==-1||r==="margin")if(i.margin){const o=gg(i.margin);this._marginArray=typeof o=="number"?[o,o,o,o]:o}else this._marginArray=[0,0,0,0]}}get width(){var t;return((t=this.attribute.width)!==null&&t!==void 0?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return((t=this.attribute.height)!==null&&t!==void 0?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();const{width:t=dd.width,height:e=dd.height}=this.attribute,{backgroundWidth:i=t,backgroundHeight:r=e}=this.attribute,o=(i-t)/2,s=(r-e)/2;return this._AABBBounds.expand([0,2*o,2*s,0]),this._AABBBounds}setHoverState(t){this.attribute.backgroundShowMode==="hover"&&this._hovered!==t&&(this._hovered=t)}}class q9{constructor(t,e,i,r,o,s,a,l){this.left=t,this.width=e,this.baseline=i,this.ascent=r,this.descent=o,this.top=i-r,this.paragraphs=s.map(h=>h),this.textAlign=(this.paragraphs[0]instanceof bo?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=a,this.directionKey=pw[this.direction],this.actualWidth=0;let u=0;this.paragraphs.forEach((h,d)=>{if(d===0&&h instanceof Ia){const c=p8.exec(h.text);(c==null?void 0:c.index)!==0&&(h.text=h.text.slice(c==null?void 0:c.index),h.updateWidth())}this.actualWidth+=h[this.directionKey.width],u=Math.max(h[this.directionKey.height],u)}),this.height=u,this.blankWidth=l?0:this.width-this.actualWidth,this.calcOffset(e,l)}calcOffset(t,e){const i=this.directionKey,r=this.height;let o=this.left,s=0;this.actualWidth<t&&!e&&(this.textAlign==="right"||this.textAlign==="end"?o=t-this.actualWidth:this.textAlign==="center"?o=(t-this.actualWidth)/2:this.textAlign==="justify"&&(this.paragraphs.length<2?o=(t-this.actualWidth)/2:s=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(a){a instanceof bo?(a["_"+i.x]=o,o+=a[i.width]+s,a["_"+i.y]=a.attribute.textBaseline==="top"?0:a.attribute.textBaseline==="bottom"?r-a.height:(r-a.height)/2):(a[i.left]=o,o+=a[i.width]+s)})}draw(t,e,i,r,o,s){if(o&&(e||this.paragraphs.some(d=>d.overflow))){let d=!0,c=!1;for(let g=this.paragraphs.length-1;g>=0;g--){const m=this.paragraphs[g];if(m.overflow)d=d&&m.text==="";else if(d){c=!0;break}}let f=0;if(!c)for(let g=this.paragraphs.length-1;g>=0;g--){const m=this.paragraphs[g];if(m.overflow){if(m.text==="")break;continue}if(m instanceof bo)break;if(this.direction==="vertical"&&m.direction!=="vertical"){m.verticalEllipsis=!0;break}const p=o===!0?"...":o||"";m.ellipsisStr=p;const{width:v}=Aa(p,m.character,m.ascentDescentMode),b=v||0;if(b<=this.blankWidth+f){e&&(m.ellipsis="add");break}if(b<=this.blankWidth+f+m.width){m.ellipsis="replace",m.ellipsisWidth=b,m.ellipsisOtherParagraphWidth=this.blankWidth+f;break}m.ellipsis="hide",f+=m.width}}let a="",l=-1,u=[];const h=[u];this.paragraphs.forEach((d,c)=>{if(d instanceof bo)return;const f=d.drawBackground(t,r,this.ascent,i,c===0,this.textAlign,this.height);f&&(a===f.fillStyle&&l===f.globalAlpha||(u=[],h.push(u),a=f.fillStyle,l=f.globalAlpha),u.push(f))}),h.forEach(d=>{if(d.length===0)return;const c=d[0],f=d[d.length-1];t.fillStyle=c.fillStyle,t.globalAlpha=c.globalAlpha,t.fillRect(c.left,c.top,f.right-c.left,f.bottom-c.top)}),this.paragraphs.forEach((d,c)=>{if(d instanceof bo)return d.setAttributes({x:i+d._x,y:r+d._y}),void s(d,t,i+d._x,r+d._y,this.ascent);const f={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};v8(t,d.character),m8(t,d.character,f),d.draw(t,r,this.ascent,i,c===0,this.textAlign,this.height)})}getWidthWithEllips(t){let e=0;for(let r=this.paragraphs.length-1;r>=0;r--){const o=this.paragraphs[r];if(o instanceof bo)break;const{width:s}=Aa(t,o.character,o.ascentDescentMode),a=s||0;if(a<=this.blankWidth+e){o.ellipsis="add",o.ellipsisWidth=a;break}if(a<=this.blankWidth+e+o.width){o.ellipsis="replace",o.ellipsisWidth=a,o.ellipsisOtherParagraphWidth=this.blankWidth+e;break}o.ellipsis="hide",e+=o.width}let i=0;return this.paragraphs.forEach((r,o)=>{i+=r instanceof bo?r.width:r.getWidthWithEllips(this.direction)}),i}}class X9{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=pw[this.direction]}store(t){if(t instanceof bo){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,i=0;t.attribute.textBaseline==="top"?(e=0,i=t.height):t.attribute.textBaseline==="bottom"?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),t.text.length!==0?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(this.lineBuffer.length===0)return;const t=this.maxAscent===0?this.maxAscentForBlank:this.maxAscent,e=this.maxDescent===0?this.maxDescentForBlank:this.maxDescent,i=new q9(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,this.direction==="horizontal"?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t,e=!1){t instanceof bo?this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineBuffer.length===0?(this.store(t),this.send()):(this.send(),this.deal(t)):typeof this.width!="number"||this.width<0||(t.newLine&&this.send(),(t.text.length!==0||this.newLine)&&(this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}cut(t,e){const i=this[this.directionKey.width]-this.lineWidth||0,r=Math.ceil(i/t[this.directionKey.width]*t.length)||0,o=Ef(t.text,i,t.character,r,this.frame.wordBreak==="break-word");if(o!==0){const[s,a]=$9(t,o);this.store(s),e?this.send():this.deal(a)}else this.lineBuffer.length!==0&&(this.send(),this.deal(t))}}let Q_=!1;try{Q_=Intl&&typeof Intl.Segmenter=="function"}catch{Q_=!1}const zT=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...In];class li extends Hi{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=yw,this.onBeforeAttributeUpdate=(e,i,r)=>{for(const o in e)if(o==="hoverIconId"){if(e[o]===i[o])continue;const s=this._frameCache.icons.get(e[o]);this.updateHoverIconState(s)}}}get width(){var t;return(t=this.attribute.width)!==null&&t!==void 0?t:Zo.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return(t=this.attribute.height)!==null&&t!==void 0?t:Zo.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return(t=this.attribute.ellipsis)!==null&&t!==void 0?t:Zo.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return(t=this.attribute.wordBreak)!==null&&t!==void 0?t:Zo.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return(t=this.attribute.verticalDirection)!==null&&t!==void 0?t:Zo.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return(t=this.attribute.textAlign)!==null&&t!==void 0?t:Zo.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return(t=this.attribute.textBaseline)!==null&&t!==void 0?t:Zo.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return(t=this.attribute.textConfig)!==null&&t!==void 0?t:Zo.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return ae(this).richtext}static AllSingleCharacter(t){return t.lines?t.lines.every(e=>e.paragraphs.every(i=>!(i.text&&lr(i.text)&&li.splitText(i.text).length>1))):t.every(e=>e.isComposing||!(e.text&&lr(e.text)&&li.splitText(e.text).length>1))}static splitText(t){if(Q_){const e=new Intl.Segmenter(void 0,{granularity:"grapheme"}),i=[];for(const{segment:r}of e.segment(t))i.push(r);return i}return Array.from(t)}static TransformTextConfig2SingleCharacter(t){const e=[];return t.forEach(i=>{const r=li.splitText(i.text.toString());if(lr(i.text)&&r.length>1)for(let o=0;o<r.length;o++){const s=r[o];e.push(Object.assign(Object.assign({},i),{text:s}))}else e.push(i)}),e}updateAABBBounds(t,e,i){var r,o,s,a;const{width:l=e.width,height:u=e.height,maxWidth:h=e.maxWidth,maxHeight:d=e.maxHeight,textAlign:c=e.textAlign,textBaseline:f=(o=(r=t.textBaseline)!==null&&r!==void 0?r:e.textBaseline)!==null&&o!==void 0?o:"top",editOptions:g}=t;if(l>0&&u>0)i.set(0,0,l,u);else{const v=this.getFrameCache(),{width:b,height:C}=v.getActualSize();let y=l||b||0,w=u||C||0;w=typeof d=="number"&&w>d?d:w||0,y=typeof h=="number"&&y>h?h:y||0,i.set(0,0,y,w)}g&&g.keepHeightWhileEmpty&&!i.height()&&!(!((s=t.textConfig)===null||s===void 0)&&s.length)&&(i.y2=i.y1+((a=t.fontSize)!==null&&a!==void 0?a:12),i.x2=i.x1+2);let m=0;switch(f){case"top":m=0;break;case"middle":m=-i.height()/2;break;case"bottom":m=-i.height()}let p=0;switch(c){case"left":p=0;break;case"center":p=-i.width()/2;break;case"right":p=-i.width()}return i.translate(p,m),Mt.graphicService.updateTempAABBBounds(i),t.forceBoundsHeight==null&&t.forceBoundsWidth==null||Mt.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,Mt.graphicService.transformAABBBounds(t,i,e,!1,this),i.width()===0&&i.height()===0&&i.clear(),i}needUpdateTags(t){return super.needUpdateTags(t,zT)}needUpdateTag(t){return super.needUpdateTag(t,zT)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){const t=this.getFrameCache();if(t.actualHeight>t.height)return!0;const{disableAutoWrapLine:e}=this.attribute;if(e)for(let i=0;i<t.lines.length;i++){const r=t.lines[i];for(let o=0;o<r.paragraphs.length;o++){const s=r.paragraphs[o];if(s.overflow&&s.text!=="")return!0}}return!1}combinedStyleToCharacter(t){const{fill:e,stroke:i,fontSize:r,fontFamily:o,fontStyle:s,fontWeight:a,lineWidth:l,opacity:u,fillOpacity:h,lineHeight:d,strokeOpacity:c,upgradeAttrs:f}=this.attribute,g=Object.assign({fill:e,stroke:i,fontSize:r,fontFamily:o,fontStyle:s,fontWeight:a,lineWidth:l,opacity:u,fillOpacity:h,strokeOpacity:c},t);return f!=null&&f.lineHeight&&(g.lineHeight=d),g}doUpdateFrameCache(t){var e;const{maxWidth:i,maxHeight:r,width:o,height:s,ellipsis:a,wordBreak:l,verticalDirection:u,textAlign:h,textBaseline:d,layoutDirection:c,singleLine:f,disableAutoWrapLine:g,editable:m,ascentDescentMode:p,upgradeAttrs:v}=this.attribute,b=v&&v.multiBreakLine;let{textConfig:C=[]}=this.attribute;m&&C.length>0&&!li.AllSingleCharacter(C)&&(C=li.TransformTextConfig2SingleCharacter(C),this.attribute.textConfig=C);const y=[],w=t??C;for(let M=0;M<w.length;M++)if("image"in w[M]){const L=this.combinedStyleToCharacter(w[M]);L.lineWidth=void 0;const I=L.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(L.id);if(I)y.push(I);else{const D=new bo(L);D.successCallback=()=>{var H;this.addUpdateBoundTag(),(H=this.stage)===null||H===void 0||H.renderNextFrame()},D.richtextId=L.id,y.push(D)}}else{const L=this.combinedStyleToCharacter(w[M]);if(ne(L.text)&&(L.text=`${L.text}`),L.text&&L.text.includes(`
`)){const I=L.text.split(`
`);for(let D=0;D<I.length;D++)if(D===0)y.push(new Ia(I[D],!1,L,p));else if(I[D]||M===w.length-1)y.push(new Ia(I[D],!0,L,p));else{const H=this.combinedStyleToCharacter(w[M+1]);y.push(new Ia(I[D],!0,H,p))}}else L.text&&y.push(new Ia(L.text,!1,L,p))}const _=typeof i=="number"&&Number.isFinite(i)&&i>0,A=typeof r=="number"&&Number.isFinite(r)&&r>0,T=typeof o=="number"&&Number.isFinite(o)&&o>0&&(!_||o<=i),S=typeof s=="number"&&Number.isFinite(s)&&s>0&&(!A||s<=r),x=new G9(0,0,(T?o:_?i:0)||0,(S?s:A?r:0)||0,a,l,u,h,d,c||"horizontal",!T&&_,!S&&A,f||!1,(e=this._frameCache)===null||e===void 0?void 0:e.icons),E=new X9(x);if(E.newLine=b,g){let M=0,L=!1;for(let I=0;I<y.length;I++){const D=y[I];L?(D.overflow=!0,D.left=1/0,D.top=1/0,!D.newLine&&x.lines[x.lines.length-1].paragraphs.push(D)):E.deal(D,!0),x.lines.length!==M&&(M=x.lines.length,E.lineBuffer.length=0,D.overflow=!0,D.left=1e3,D.top=1e3,x.lines[x.lines.length-1].paragraphs.push(D),L=!0),D.newLine&&(L=!1,E.lineWidth=0),E.send()}}else for(let M=0;M<y.length;M++)E.deal(y[M]);if(E.send(),!(x.layoutDirection==="horizontal"?T:S)){const M=x.getActualSizeWidthEllipsis();let L=x.layoutDirection==="horizontal"?M.width:M.height;(x.layoutDirection==="horizontal"?_:A)&&(L=Math.min(L,x.layoutDirection==="horizontal"?i:r)),x.lines.forEach(function(I){I.calcOffset(L,!1)})}b&&x.lines.forEach(M=>{const L=M.paragraphs;M.paragraphs=M.paragraphs.filter(I=>I.text!==""),M.paragraphs.length===0&&L.length&&(L[0].text=`
`,M.paragraphs.push(L[0]))}),this._frameCache=x}clone(){return new li(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(i=>{i.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{const e=this.pickIcon(t.global);e&&e===this._currentHoverIcon||(e?this.setAttribute("hoverIconId",e.richtextId):!e&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",t=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(t){var e,i,r,o,s;t?((e=this._currentHoverIcon)===null||e===void 0||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),(i=this.stage)===null||i===void 0||i.setCursor(t.attribute.cursor),(r=this.stage)===null||r===void 0||r.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,(o=this.stage)===null||o===void 0||o.setCursor(),(s=this.stage)===null||s===void 0||s.renderNextFrame())}pickIcon(t){const e=this.getFrameCache(),{e:i,f:r}=this.globalTransMatrix;let o;return e.icons.forEach((s,a)=>{var l,u;const h=s.AABBBounds.clone();h.translate(s._marginArray[3],s._marginArray[0]),h.containsPoint({x:t.x-i,y:t.y-r})&&(o=s,o.globalX=((l=o.attribute.x)!==null&&l!==void 0?l:0)+i+s._marginArray[3],o.globalY=((u=o.attribute.y)!==null&&u!==void 0?u:0)+r+s._marginArray[0])}),o}getNoWorkAnimateAttr(){return li.NOWORK_ANIMATE_ATTR}}li.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},so);function Y9(n){return new li(n)}const NT=["path","customPath",...In];class vd extends Hi{constructor(t){super(t),this.type="path",this.numberType=Dm}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{path:t}=this.attribute;return t!=null&&t!==""}getParsedPathShape(){const t=this.getGraphicTheme();if(!this.valid)return t.path;const e=this.attribute;return e.path instanceof Fi?e.path:(zt(this.cache)&&this.doUpdatePathShape(),this.cache instanceof Fi?this.cache:t.path)}getGraphicTheme(){return ae(this).path}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){const a=this.getParsedPathShape();i.union(a.getBounds())}const{tb1:r,tb2:o}=Mt.graphicService.updateTempAABBBounds(i);Yd(t,e,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;const{lineJoin:s=e.lineJoin}=t;return Mt.graphicService.transformAABBBounds(t,i,e,s==="miter",this),i}doUpdateAABBBounds(t){return this.doUpdatePathShape(),super.doUpdateAABBBounds(t)}doUpdatePathShape(){const t=this.attribute;lr(t.path,!0)?this.cache=new Fi().fromString(t.path):t.customPath&&(this.cache=new Fi,t.customPath(this.cache,this))}needUpdateTags(t){return super.needUpdateTags(t,NT)}needUpdateTag(t){return super.needUpdateTag(t,NT)}toCustomPath(){return new Fi().fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new vd(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return vd.NOWORK_ANIMATE_ATTR}}vd.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},so);function K9(n){return new vd(n)}const WT=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...In];class wu extends Hi{constructor(t){super(t),this.type="arc",this.numberType=Pm}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:t,endAngle:e,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){const t=this.getGraphicTheme(),{cornerRadius:e=t.cornerRadius,innerPadding:i=t.innerPadding,outerPadding:r=t.outerPadding}=this.attribute;let{outerRadius:o=t.outerRadius,innerRadius:s=t.innerRadius}=this.attribute;if(o+=r,s-=i,e===0||e==="0%")return 0;const a=Math.abs(o-s),l=u=>Math.min(ne(u,!0)?u:a*parseFloat(u)/100,a/2);if(jt(e)){const u=e.map(h=>l(h)||0);return u.length===0?[u[0],u[0],u[0],u[0]]:u.length===2?[u[0],u[1],u[0],u[1]]:(u.length===3&&u.push(0),u)}return l(e)}getParsedAngle(){const t=this.getGraphicTheme();let{startAngle:e=t.startAngle,endAngle:i=t.endAngle}=this.attribute;const{cap:r=t.cap}=this.attribute,o=i-e>=0?1:-1,s=i-e;if(e=n6(e),i=e+s,r&&Se(s)<Zt-je){let a=1,l=1;r.length&&(a=Number(r[0]),l=Number(r[1]));let{outerRadius:u=t.outerRadius,innerRadius:h=t.innerRadius}=this.attribute;const{outerPadding:d=t.outerPadding,innerPadding:c=t.innerPadding}=this.attribute;u+=d,h-=c;const f=Math.abs(u-h)/2,g=f/u;if(f>je&&u>je)return{startAngle:e-o*g*a,endAngle:i+o*g*l,sc:o*g*a,ec:o*g*l}}return{startAngle:e,endAngle:i}}getParsePadAngle(t,e){const i=this.getGraphicTheme(),{innerPadding:r=i.innerPadding,outerPadding:o=i.outerPadding,padAngle:s=i.padAngle}=this.attribute;let{outerRadius:a=i.outerRadius,innerRadius:l=i.innerRadius}=this.attribute;a+=o,l-=r;const{padRadius:u=Zn(a*a+l*l)}=this.attribute,h=Se(e-t);let d=t,c=e,f=t,g=e;const m=s/2;let p=h,v=h;if(m>je&&u>je){const b=e>t?1:-1;let C=Px(Number(u)/l*ti(m)),y=Px(Number(u)/a*ti(m));return(p-=2*C)>je?(C*=b,f+=C,g-=C):(p=0,f=g=(t+e)/2),(v-=2*y)>je?(y*=b,d+=y,c-=y):(v=0,d=c=(t+e)/2),{outerStartAngle:d,outerEndAngle:c,innerStartAngle:f,innerEndAngle:g,innerDeltaAngle:p,outerDeltaAngle:v}}return{outerStartAngle:d,outerEndAngle:c,innerStartAngle:f,innerEndAngle:g,innerDeltaAngle:p,outerDeltaAngle:v}}getGraphicTheme(){return ae(this).arc}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));const{tb1:o,tb2:s}=Mt.graphicService.updateTempAABBBounds(i);Yd(t,e,o),i.union(o),o.setValue(s.x1,s.y1,s.x2,s.y2),this.setWidthHeightWithoutTransform(i);const{lineJoin:a=e.lineJoin}=t;return Mt.graphicService.transformAABBBounds(t,i,e,a==="miter",this),i}updateArcAABBBoundsImprecise(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:o=e.innerRadius}=t;const{outerPadding:s=e.outerPadding,innerPadding:a=e.innerPadding}=t;return r+=s,o-=a,r<o&&(r=o),i.set(-r,-r,r,r),i}updateArcAABBBoundsAccurate(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:o=e.innerRadius}=t;const{outerPadding:s=e.outerPadding,innerPadding:a=e.innerPadding}=t;if(r+=s,o-=a,r<o){const h=r;r=o,o=h}let{endAngle:l=e.endAngle,startAngle:u=e.startAngle}=t;if(u>l){const h=u;u=l,l=h}return r<=je?i.set(0,0,0,0):Math.abs(l-u)>Zt-je?i.set(-r,-r,r,r):(k_(u,l,r,i),k_(u,l,o,i)),i}needUpdateTags(t){return super.needUpdateTags(t,WT)}needUpdateTag(t){return super.needUpdateTag(t,WT)}toCustomPath(){var t,e,i,r;let o=super.toCustomPath();if(o)return o;const s=this.attribute,{startAngle:a,endAngle:l}=this.getParsedAngle();let u=((t=s.innerRadius)!==null&&t!==void 0?t:0)-((e=s.innerPadding)!==null&&e!==void 0?e:0),h=((i=s.outerRadius)!==null&&i!==void 0?i:0)-((r=s.outerPadding)!==null&&r!==void 0?r:0);const d=Se(l-a),c=l>a;if(h<u){const f=h;h=u,u=f}if(o=new Fi,h<=je)o.moveTo(0,0);else if(d>=Zt-je)o.moveTo(0+h*Ei(a),0+h*ti(a)),o.arc(0,0,h,a,l,!c),u>je&&(o.moveTo(0+u*Ei(l),0+u*ti(l)),o.arc(0,0,u,l,a,c));else{const f=h*Ei(a),g=h*ti(a),m=u*Ei(l),p=u*ti(l);o.moveTo(0+f,0+g),o.arc(0,0,h,a,l,!c),o.lineTo(0+m,0+p),o.arc(0,0,u,l,a,c),o.closePath()}return o}clone(){return new wu(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return wu.NOWORK_ANIMATE_ATTR}}wu.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},so);function bg(n){return new wu(n)}const UT=["points","cornerRadius",...In];class bd extends Hi{constructor(t){super(t),this.type="polygon",this.numberType=Im}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{points:t}=this.attribute;return t&&t.length>=2}getGraphicTheme(){return ae(this).polygon}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),Mt.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;const{lineJoin:r=e.lineJoin}=t;return Mt.graphicService.transformAABBBounds(t,i,e,r==="miter",this),i}updatePolygonAABBBoundsImprecise(t,e,i){const{points:r=e.points}=t;return r.forEach(o=>{i.add(o.x,o.y)}),i}_interpolate(t,e,i,r,o){t==="points"&&(o.points=bw(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,UT)}needUpdateTag(t){return super.needUpdateTag(t,UT)}toCustomPath(){const t=this.attribute.points,e=new Fi;return t.forEach((i,r)=>{r===0?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y)}),e.closePath(),e}clone(){return new bd(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return bd.NOWORK_ANIMATE_ATTR}}bd.NOWORK_ANIMATE_ATTR=so;function PL(n){return new bd(n)}class Z9 extends ko{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){const e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){const t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function Q9(n){return new Z9(n)}class J9{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){const i=this.store.get(t);return i?i(e):null}}const $t=new J9;let Kc;function zm(n){return Kc||(Kc=$t.CreateGraphic("text",{})),Kc.initAttributes(n),Kc.AABBBounds}var t7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},e7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},VT=function(n,t){return function(e,i){t(e,i,n)}};class Nm{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){var g;const{background:m,backgroundOpacity:p=(g=t.attribute.fillOpacity)!==null&&g!==void 0?g:u.backgroundOpacity,opacity:v=u.opacity,backgroundMode:b=u.backgroundMode,backgroundFit:C=u.backgroundFit,backgroundKeepAspectRatio:y=u.backgroundKeepAspectRatio,backgroundScale:w=u.backgroundScale,backgroundOffsetX:_=u.backgroundOffsetX,backgroundOffsetY:A=u.backgroundOffsetY,backgroundClip:T=u.backgroundClip}=t.attribute;if(m)if(t.backgroundImg&&t.resources){const S=t.resources.get(m);if(S.state!=="success"||!S.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){const E=ae(t.parent).group,{scrollX:M=E.scrollX,scrollY:L=E.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(M,L)}T&&e.clip();const x=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,r,u),e.globalAlpha=p*v,this.doDrawImage(e,S.data,x,{backgroundMode:b,backgroundFit:C,backgroundKeepAspectRatio:y,backgroundScale:w,backgroundOffsetX:_,backgroundOffsetY:A}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,u),e.globalAlpha=p*v,e.fillStyle=m,e.fill(),e.highPerformanceRestore()}doDrawImage(t,e,i,r){const{backgroundMode:o,backgroundFit:s,backgroundKeepAspectRatio:a,backgroundScale:l=1,backgroundOffsetX:u=0,backgroundOffsetY:h=0}=r,d=i.width(),c=i.height();let f=d,g=c;if(o==="no-repeat")if(s)if(a){const m=Math.max(d/e.width,c/e.height);t.drawImage(e,i.x1+u,i.y1+h,e.width*m*l,e.height*m*l)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{const m=e.width*l,p=e.height*l;t.drawImage(e,i.x1+u,i.y1+h,m,p)}else{if(s&&o!=="repeat"&&(e.width||e.height)){const v=e.width,b=e.height;o==="repeat-x"?(f=v*(c/b),g=c):o==="repeat-y"&&(g=b*(d/v),f=d);const C=t.dpr,y=Va.allocate({width:f,height:g,dpr:C}),w=y.getContext("2d");w&&(w.inuse=!0,w.clearMatrix(),w.setTransformForCurrent(!0),w.clearRect(0,0,f,g),w.drawImage(e,0,0,f,g),e=y.nativeCanvas),Va.free(y)}const m=t.dpr,p=t.createPattern(e,o);p.setTransform&&p.setTransform(new DOMMatrix([1/m,0,0,1/m,0,0])),t.fillStyle=p,t.translate(i.x1,i.y1),t.fillRect(0,0,d,c),t.translate(-i.x1,-i.y1)}}}const Ys=new Nm;let eo=class{constructor(n){this.subRenderContribitions=n,this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(f=>{f.render(n,t,e,i,r,o,s,a,l,u,h,d,c)})}};eo=t7([Tt(),VT(0,ge(ci)),VT(0,Di(Rw)),e7("design:paramtypes",[Object])],eo);class i7{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){var g,m;const{clipConfig:p}=t.attribute;if(!p)return;const v=t.getClipPath();if(!v)return;const b=!(d||c),C=t.AABBBounds,y=(g=t.attribute.width)!==null&&g!==void 0?g:C.width(),w=(m=t.attribute.height)!==null&&m!==void 0?m:C.height();b&&e.save(),e.beginPath(),v.draw(e,[y,w],i+y/2,r+w/2,0)===!1&&e.closePath(),d&&d(e,t.attribute,u,!0),b&&e.clip()}}const r7=new i7;class n7{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){const{clipConfig:g}=t.attribute;g&&t.getClipPath()&&(d||c||e.restore())}}const o7=new n7;function s7(n){return n<=.5?4*n-1:-4*n+3}function a7(n,t,e,i,r,o,s){const{fill:a="orange",percent:l=.6,frequency:u=4,opacity:h,phi:d=0}=r;let{amplitude:c=10}=r;c*=s7(t);const f=i*(1-l),g=e,m=Math.max(Math.round(g/70),2);n.beginPath(),n.moveTo(0+o,i+s),n.lineTo(0+o,f+s);const p=g/u*t,v=g/Math.PI/(2*u);for(let b=0;b<g;b+=m){const C=c*Math.sin((b+p+d)/v+d);n.lineTo(b+o,f+C+s)}n.lineTo(g+o,i+s),n.closePath(),n.fillStyle=a,isFinite(h)&&(n.globalAlpha=h),n.fill()}class Mw{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}createCommonPattern(t,e,i,r,o){const s=(t-2*e)/2,a=r.dpr,l=Va.allocate({width:t,height:t,dpr:a}),u=l.getContext("2d");if(!u)return null;u.inuse=!0,u.clearMatrix(),u.setTransformForCurrent(!0),u.clearRect(0,0,t,t),o(s,u);const h=r.createPattern(l.nativeCanvas,"repeat");return h.setTransform&&h.setTransform(new DOMMatrix([1/a,0,0,1/a,0,0])),Va.free(l),h}createCirclePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{s.fillStyle=i,s.arc(o,o,o,0,Zt),s.fill()})}createDiamondPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=t/2,l=a;s.fillStyle=i,s.moveTo(a,l-o),s.lineTo(o+a,l),s.lineTo(a,l+o),s.lineTo(a-o,l),s.closePath(),s.fill()})}createRectPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e,l=a;s.fillStyle=i,s.fillRect(a,l,2*o,2*o)})}createVerticalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e;s.fillStyle=i,s.fillRect(a,0,2*o,t)})}createHorizontalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e;s.fillStyle=i,s.fillRect(0,a,t,2*o)})}createBiasLRLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{s.strokeStyle=i,s.lineWidth=o,s.moveTo(0,0),s.lineTo(t,t);const a=t/2,l=-a;s.moveTo(a,l),s.lineTo(a+t,l+t),s.moveTo(-a,-l),s.lineTo(-a+t,-l+t),s.stroke()})}createBiasRLLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{s.strokeStyle=i,s.lineWidth=o,s.moveTo(t,0),s.lineTo(0,t);const a=t/2,l=a;s.moveTo(t+a,l),s.lineTo(a,l+t),s.moveTo(t-a,-l),s.lineTo(-a,-l+t),s.stroke()})}createGridPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e,l=a;s.fillStyle=i,s.fillRect(a,l,o,o),s.fillRect(a+o,l+o,o,o)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){this.textureMap||this.initTextureMap(e,t.stage);const{texture:g=u.texture,textureColor:m=u.textureColor,textureSize:p=u.textureSize,texturePadding:v=u.texturePadding}=t.attribute;g&&this.drawTexture(g,t,e,i,r,u,m,p,v)}drawTexture(t,e,i,r,o,s,a,l,u){var h;const{textureRatio:d=s.textureRatio,textureOptions:c=null}=e.attribute;let f=this.textureMap.get(t);if(!f)switch(t){case"circle":f=this.createCirclePattern(l,u,a,i);break;case"diamond":f=this.createDiamondPattern(l,u,a,i);break;case"rect":f=this.createRectPattern(l,u,a,i);break;case"vertical-line":f=this.createVerticalLinePattern(l,u,a,i);break;case"horizontal-line":f=this.createHorizontalLinePattern(l,u,a,i);break;case"bias-lr":f=this.createBiasLRLinePattern(l,u,a,i);break;case"bias-rl":f=this.createBiasRLLinePattern(l,u,a,i);break;case"grid":f=this.createGridPattern(l,u,a,i)}if(c&&c.dynamicTexture){const{gridConfig:g={},useNewCanvas:m}=c,p=e.AABBBounds;r=p.x1,o=p.y1;const v=i;let b;if(m){b=Va.allocate({width:p.width(),height:p.height(),dpr:i.dpr});const I=b.getContext("2d");I.clearRect(0,0,p.width(),p.height()),r=0,o=0,i=I}if(v.save(),e.parent&&!e.transMatrix.onlyTranslate()){const{scrollX:I=0,scrollY:D=0}=e.parent.attribute;v.setTransformFromMatrix(e.parent.globalTransMatrix),v.translate(I,D,!0)}v.setCommonStyle(e,e.attribute,r,o,s),v.clip();const C=p.width(),y=p.height(),w=u,_=l,A=g.columns?g.columns:Math.ceil(C/_),T=g.rows?g.rows:Math.ceil(y/_),S=g.gutterColumn?g.gutterColumn:2*w,x=g.gutterRow?g.gutterRow:2*w;this._tempSymbolGraphic||(this._tempSymbolGraphic=yu({}));const E=g.columns?C/g.columns:_,M=g.rows?y/g.rows:_;this._tempSymbolGraphic.setAttributes({size:[E-S,M-x],symbolType:t});const L=this._tempSymbolGraphic.getParsedPath();for(let I=0;I<T;I++)for(let D=0;D<A;D++){const H=r+_/2+D*_,O=o+_/2+I*_;(h=c.beforeDynamicTexture)===null||h===void 0||h.call(c,i,I,D,T,A,d,e,p.width(),p.height()),i.beginPath(),L.draw(i,Math.min(E-S,M-x),H,O,0)===!1&&i.closePath(),i.fillStyle=a,c.dynamicTexture(i,I,D,T,A,d,e,p.width(),p.height())}m&&(v.globalAlpha=1,v.drawImage(b.nativeCanvas,0,0,b.nativeCanvas.width,b.nativeCanvas.height,p.x1,p.y1,p.width()*v.dpr,p.height()*v.dpr)),v.restore()}else if(f)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,r,o,s),i.fillStyle=f,i.fill(),i.highPerformanceRestore();else if(t==="wave"){i.save(),i.setCommonStyle(e,e.attribute,r,o,s),i.clip();const g=e.AABBBounds;a7(i,d,g.width(),g.height(),Object.assign(Object.assign({},c||{}),{fill:a}),r+g.x1-r,o+g.y1-o),i.restore()}}}const Hu=new Mw;class l7{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){const{outerBorder:f,innerBorder:g}=t.attribute,m=f&&f.visible!==!1,p=g&&g.visible!==!1;if(!m&&!p)return;const{innerPadding:v=u.innerPadding,outerPadding:b=u.outerPadding,startAngle:C=u.startAngle,endAngle:y=u.endAngle,opacity:w=u.opacity,x:_=u.x,y:A=u.y,scaleX:T=u.scaleX,scaleY:S=u.scaleY,keepStrokeScale:x=u.keepStrokeScale}=t.attribute;let{innerRadius:E=u.innerRadius,outerRadius:M=u.outerRadius}=t.attribute;M+=b,E-=v;const L=(I,D)=>{const H=!(!I||!I.stroke),{distance:O=u[D].distance}=I,N=x?O:Po(e,O,e.dpr),U=O/M,W=D==="outerBorder"?1:-1;if(t.setAttributes({outerRadius:M+W*N,innerRadius:E-W*N,startAngle:C-W*U,endAngle:y+W*U}),e.beginPath(),z_(t,e,i,r,M+W*N,E-W*N),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),c)c(e,I,u[D]);else if(H){const j=u[D].opacity;u[D].opacity=w,e.setStrokeStyle(t,I,(_-i)/T,(A-r)/S,u[D]),u[D].opacity=j,e.stroke()}};m&&L(f,"outerBorder"),p&&L(g,"innerBorder"),t.setAttributes({outerRadius:M,innerRadius:E,startAngle:C,endAngle:y})}}const u7=new l7,h7=Hu,d7=Ys;class c7{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){const{outerBorder:f,innerBorder:g}=t.attribute,m=f&&f.visible!==!1,p=g&&g.visible!==!1;if(!m&&!p)return;const{radius:v=u.radius,startAngle:b=u.startAngle,endAngle:C=u.endAngle,opacity:y=u.opacity,x:w=u.x,y:_=u.y,scaleX:A=u.scaleX,scaleY:T=u.scaleY,keepStrokeScale:S=u.keepStrokeScale}=t.attribute,x=(E,M)=>{const L=!(!E||!E.stroke),{distance:I=u[M].distance}=E,D=S?I:Po(e,I,e.dpr),H=M==="outerBorder"?1:-1;if(e.beginPath(),e.arc(i,r,v+H*D,b,C),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),c)c(e,E,u[M]);else if(L){const O=u[M].opacity;u[M].opacity=y,e.setStrokeStyle(t,E,(w-i)/A,(_-r)/T,u[M]),u[M].opacity=O,e.stroke()}};m&&x(f,"outerBorder"),p&&x(g,"innerBorder")}}const f7=new c7,g7=Hu,p7=Ys;class m7 extends Nm{constructor(){super(...arguments),this.time=we.beforeFillStroke}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){const{background:f,backgroundMode:g=u.backgroundMode,backgroundFit:m=u.backgroundFit,backgroundKeepAspectRatio:p=u.backgroundKeepAspectRatio,backgroundScale:v=u.backgroundScale,backgroundOffsetX:b=u.backgroundOffsetX,backgroundOffsetY:C=u.backgroundOffsetY}=t.attribute;if(f)if(t.backgroundImg&&t.resources){const y=t.resources.get(f);if(y.state!=="success"||!y.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);const w=t.AABBBounds;this.doDrawImage(e,y.data,w,{backgroundMode:g,backgroundFit:m,backgroundKeepAspectRatio:p,backgroundScale:v,backgroundOffsetX:b,backgroundOffsetY:C}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=f,e.fill(),e.highPerformanceRestore()}}const jT=new m7,Zc=Ae/2;function Lo(n,t,e,i,r,o,s=!0,a){let l;if(Array.isArray(s)&&(a=s,s=!0),i<0&&(t+=i,i=-i),r<0&&(e+=r,r=-r),ne(o,!0))l=[o=Se(o),o,o,o];else if(Array.isArray(o)){const A=o;let T,S;switch(A.length){case 0:l=[0,0,0,0];break;case 1:T=Se(A[0]),l=[T,T,T,T];break;case 2:case 3:T=Se(A[0]),S=Se(A[1]),l=[T,S,T,S];break;default:l=A,l[0]=Se(l[0]),l[1]=Se(l[1]),l[2]=Se(l[2]),l[3]=Se(l[3])}}else l=[0,0,0,0];if(i<0||l[0]+l[1]+l[2]+l[3]<1e-12)return n.rect(t,e,i,r);const[u,h,d,c]=[[t,e],[t+i,e],[t+i,e+r],[t,e+r]],f=Math.min(i/2,r/2),g=[Math.min(f,l[0]),Math.min(f,l[1]),Math.min(f,l[2]),Math.min(f,l[3])],m=[u[0]+g[0],u[1]],p=[u[0],u[1]+g[0]],v=[h[0]-g[1],h[1]],b=[h[0],h[1]+g[1]],C=[d[0]-g[2],d[1]],y=[d[0],d[1]-g[2]],w=[c[0]+g[3],c[1]],_=[c[0],c[1]-g[3]];if(n.moveTo(m[0],m[1]),s){if(a&&a[0]?a[0](m[0],m[1],v[0],v[1]):n.lineTo(v[0],v[1]),!Oc(v,b)){a&&a[0]&&n.moveTo(v[0],v[1]);const A=v[0],T=v[1]+g[1];n.arc(A,T,g[1],-Zc,0,!1)}if(a&&a[1]?a[1](b[0],b[1],y[0],y[1]):n.lineTo(y[0],y[1]),!Oc(C,y)){const A=y[0]-g[2],T=y[1];a&&a[1]&&n.moveTo(y[0],y[1]),n.arc(A,T,g[2],0,Zc,!1)}if(a&&a[2]?a[2](C[0],C[1],w[0],w[1]):n.lineTo(w[0],w[1]),!Oc(w,_)){const A=w[0],T=w[1]-g[3];a&&a[2]&&n.moveTo(w[0],w[1]),n.arc(A,T,g[3],Zc,Ae,!1)}if(a&&a[3]?a[3](_[0],_[1],p[0],p[1]):n.lineTo(p[0],p[1]),!Oc(m,p)){const A=m[0],T=m[1]+g[0];a&&a[3]&&n.moveTo(p[0],p[1]),n.arc(A,T,g[0],Ae,Ae+Zc,!1)}}else a&&a[0]?a[0](m[0],m[1],v[0],v[1]):n.lineTo(v[0],v[1]),a&&a[1]?a[1](v[0],v[1],C[0],C[1]):n.lineTo(C[0],C[1]),a&&a[2]?a[2](C[0],C[1],w[0],w[1]):n.lineTo(w[0],w[1]),a&&a[2]?a[2](w[0],w[1],m[0],m[1]):n.lineTo(m[0],m[1]);return!a&&n.closePath(),n}var kL=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class LL{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){const{outerBorder:f,innerBorder:g}=t.attribute,m=f&&f.visible!==!1,p=g&&g.visible!==!1;if(!m&&!p)return;const{cornerRadius:v=u.cornerRadius,cornerType:b=u.cornerType,opacity:C=u.opacity,x:y=u.x,y:w=u.y,scaleX:_=u.scaleX,scaleY:A=u.scaleY,x1:T,y1:S,keepStrokeScale:x=u.keepStrokeScale}=t.attribute;let{width:E,height:M}=t.attribute;E=(E??T-i)||0,M=(M??S-r)||0;const L=(I,D)=>{const H=!(!I||!I.stroke),O=D==="outerBorder"?-1:1,{distance:N=u[D].distance}=I,U=x?N:Po(e,N,e.dpr),W=i+O*U,j=r+O*U,Y=2*U;if(v===0||jt(v)&&v.every(Z=>Z===0)?(e.beginPath(),e.rect(W,j,E-O*Y,M-O*Y)):(e.beginPath(),Lo(e,W,j,E-O*Y,M-O*Y,v,b!=="bevel")),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),c)c(e,I,u[D]);else if(H){const Z=u[D].opacity;u[D].opacity=C,e.setStrokeStyle(t,I,(y-i)/_,(w-r)/A,u[D]),u[D].opacity=Z,e.stroke()}};m&&L(f,"outerBorder"),p&&L(g,"innerBorder")}}let Su=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){const{stroke:g=u.stroke}=t.attribute;Array.isArray(g)&&g.some(m=>m===!1)&&(f.doStroke=!1)}};Su=kL([Tt()],Su);let xu=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){const{x1:f,y1:g,x:m=u.x,y:p=u.y,stroke:v=u.stroke,cornerRadius:b=u.cornerRadius,cornerType:C=u.cornerType}=t.attribute;let{width:y,height:w}=t.attribute;if(y=(y??f-m)||0,w=(w??g-p)||0,Array.isArray(v)&&v.some(_=>_===!1)){if(e.setStrokeStyle(t,t.attribute,i,r,u),!(b===0||jt(b)&&b.every(_=>_===0))){let _,A=0;return Lo(e,i,r,y,w,b,C!=="bevel",new Array(4).fill(0).map((T,S)=>(x,E,M,L)=>{v[S]&&(A===S-1&&v[S]===_||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:v[S]}),i,r,u),e.beginPath(),e.moveTo(x,E),_=v[S]),A=S,e.lineTo(M,L),e.stroke(),S===3&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(i,r),v[0]?e.lineTo(i+y,r):e.moveTo(i+y,r),v[1]?e.lineTo(i+y,r+w):e.moveTo(i+y,r+w),v[2]?e.lineTo(i,r+w):e.moveTo(i,r+w),v[3]){const _=v[0]?r-e.lineWidth/2:r;e.lineTo(i,_)}else e.moveTo(i,r);e.stroke()}}};xu=kL([Tt()],xu);const v7=new LL,b7=Hu,_7=Ys;class C7 extends LL{constructor(){super(...arguments),this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){return super.drawShape(t,e,i,r,o,s,a,l,u,h,d,c)}}const y7=new C7,w7=Ys;class S7{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){const f=t.getParsedPath();if(!f)return;const{outerBorder:g,innerBorder:m}=t.attribute,p=g&&g.visible!==!1,v=m&&m.visible!==!1;if(!p&&!v)return;const{size:b=u.size,opacity:C=u.opacity,x:y=u.x,y:w=u.y,scaleX:_=u.scaleX,scaleY:A=u.scaleY,keepStrokeScale:T=u.keepStrokeScale}=t.attribute,S=(x,E)=>{const M=!(!x||!x.stroke),{distance:L=u[E].distance}=x,I=T?L:Po(e,L,e.dpr),D=E==="outerBorder"?1:-1;if(e.beginPath(),f.drawOffset(e,b,i,r,D*I)===!1&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),c)c(e,x,u[E]);else if(M){const H=u[E].opacity;u[E].opacity=C,e.setStrokeStyle(t,x,(y-i)/_,(w-r)/A,u[E]),u[E].opacity=H,e.stroke()}};p&&S(g,"outerBorder"),v&&S(m,"innerBorder")}}class x7{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){const{clipRange:g=u.clipRange,x:m=u.x,y:p=u.y,z:v=u.z,size:b=u.size,scaleX:C=u.scaleX,scaleY:y=u.scaleY}=t.attribute,w=t.getParsedPath();w&&g<1&&g>0&&(e.beginPath(),w.drawWithClipRange&&w.drawWithClipRange(e,b,i,r,g,v,(_,A)=>{var T,S,x,E;if(t._parsedPath.svgCache){const M=Object.assign({},A);M.fill=(T=A.fill)!==null&&T!==void 0?T:t.attribute.fill,M.opacity=(S=A.opacity)!==null&&S!==void 0?S:t.attribute.opacity,M.fillOpacity=t.attribute.fillOpacity,M.stroke=(x=A.stroke)!==null&&x!==void 0?x:t.attribute.stroke,M.lineWidth=(E=A.lineWidth)!==null&&E!==void 0?E:t.attribute.lineWidth,A=M}A.stroke&&(c?c(e,t.attribute,u):l&&(e.setStrokeStyle(t,A,(m-i)/C,(p-r)/y,u),e.stroke()))}),s&&!w.isSvg&&(c?c(e,t.attribute,u):l&&(e.setStrokeStyle(t,t.attribute,(m-i)/C,(p-r)/y,u),e.stroke())))}}const T7=new S7,A7=new x7,R7=Hu,E7=Ys;class M7 extends Mw{constructor(){super(...arguments),this.time=we.afterFillStroke}drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f){var g,m,p,v;this.textureMap||this.initTextureMap(e,t.stage);const{attribute:b=t.attribute}=f||{},{texture:C=(g=t.attribute.texture)!==null&&g!==void 0?g:$c(u,"texture"),textureColor:y=(m=t.attribute.textureColor)!==null&&m!==void 0?m:$c(u,"textureColor"),textureSize:w=(p=t.attribute.textureSize)!==null&&p!==void 0?p:$c(u,"textureSize"),texturePadding:_=(v=t.attribute.texturePadding)!==null&&v!==void 0?v:$c(u,"texturePadding")}=b;C&&this.drawTexture(C,t,e,i,r,u,y,w,_)}}const gi={x:0,y:0,z:0,lastModelMatrix:null};class Xr{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(r7),this.builtinContributions.push(o7),this.builtinContributions.forEach(e=>this._renderContribitions.push(e)),this._renderContribitions.length&&(this._renderContribitions.sort((e,i)=>i.order-e.order),this._beforeRenderContribitions=this._renderContribitions.filter(e=>e.time===we.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(e=>e.time===we.afterFillStroke))}reInit(){this.init(this.graphicRenderContributions)}beforeRenderStep(t,e,i,r,o,s,a,l,u,h,d,c,f){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(g=>{g.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(g.supportedAppName)?g.supportedAppName:[g.supportedAppName]).includes(t.stage.params.context.appName)||g.drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f)})}afterRenderStep(t,e,i,r,o,s,a,l,u,h,d,c,f){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(g=>{g.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(g.supportedAppName)?g.supportedAppName:[g.supportedAppName]).includes(t.stage.params.context.appName)||g.drawShape(t,e,i,r,o,s,a,l,u,h,d,c,f)})}drawPathProxy(t,e,i,r,o,s,a,l){if(!t.pathProxy)return!1;const u=ae(t,s==null?void 0:s.theme)[t.type.replace("3d","")],{fill:h=u.fill,stroke:d=u.stroke,opacity:c=u.opacity,fillOpacity:f=u.fillOpacity,lineWidth:g=u.lineWidth,strokeOpacity:m=u.strokeOpacity,visible:p=u.visible,x:v=u.x,y:b=u.y}=t.attribute,C=Ka(c,f,h),y=H_(c,m),w=bu(h),_=pd(d,g);if(!p||!w&&!_||!(C||y||a||l))return!0;e.beginPath();const A=typeof t.pathProxy=="function"?t.pathProxy(t.attribute):t.pathProxy;return fs(A.commandList,e,i,r),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,r,w,_,C,y,u,o,a,l),_&&(l?l(e,t.attribute,u):y&&(e.setStrokeStyle(t,t.attribute,i-v,r-b,u),e.stroke())),w&&(a?a(e,t.attribute,u):C&&(e.setCommonStyle(t,t.attribute,i-v,r-b,u),e.fill())),this.afterRenderStep(t,e,i,r,w,_,C,y,u,o,a,l),!0}valid(t,e,i,r){const{fill:o=e.fill,background:s,stroke:a=e.stroke,opacity:l=e.opacity,fillOpacity:u=e.fillOpacity,lineWidth:h=e.lineWidth,strokeOpacity:d=e.strokeOpacity,visible:c=e.visible}=t.attribute,f=Ka(l,u,o),g=H_(l,d),m=bu(o,s),p=pd(a,h);return!(!t.valid||!c)&&!(!m&&!p)&&!!(f||g||i||r||s)&&{fVisible:f,sVisible:g,doFill:m,doStroke:p}}transform(t,e,i,r=!1){const{x:o=e.x,y:s=e.y,z:a=e.z,scaleX:l=e.scaleX,scaleY:u=e.scaleY,angle:h=e.angle,postMatrix:d}=t.attribute,c=i.modelMatrix,f=i.camera;gi.x=o,gi.y=s,gi.z=a,gi.lastModelMatrix=c;const g=f&&(r||W9(t)),m=g?t.transMatrix.onlyTranslate()&&!d:l===1&&u===1&&h===0&&!d;if(g){const p=Pi.allocate(),v=Pi.allocate();RL(v,t,e),Xd(p,c||p,v),gi.x=0,gi.y=0,gi.z=0,i.modelMatrix=p,i.setTransform(1,0,0,1,0,0,!0),Pi.free(v)}if(m&&!c){const p=t.getOffsetXY(e);gi.x+=p.x,gi.y+=p.y,gi.z=a,i.setTransformForCurrent()}else if(g)gi.x=0,gi.y=0,gi.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(f&&i.project){const p=t.getOffsetXY(e);gi.x+=p.x,gi.y+=p.y,this.transformWithoutTranslate(i,gi.x,gi.y,gi.z,l,u,h)}else i.transformFromMatrix(t.transMatrix,!0),gi.x=0,gi.y=0,gi.z=0;return gi}transformUseContext2d(t,e,i,r){const o=r.camera;if(this.camera=o,o){const s=t.AABBBounds,a=s.x2-s.x1,l=s.y2-s.y1,u=r.project(0,0,i),h=r.project(a,0,i),d=r.project(a,l,i),c={x:0,y:0},f={x:a,y:0},g={x:a,y:l};r.camera=null;const m=1/(c.x*(g.y-f.y)-f.x*g.y+g.x*f.y+(f.x-g.x)*c.y),p=-(c.y*(d.x-h.x)-f.y*d.x+g.y*h.x+(f.y-g.y)*u.x)*m,v=(f.y*d.y+c.y*(h.y-d.y)-g.y*h.y+(g.y-f.y)*u.y)*m,b=(c.x*(d.x-h.x)-f.x*d.x+g.x*h.x+(f.x-g.x)*u.x)*m,C=-(f.x*d.y+c.x*(h.y-d.y)-g.x*h.y+(g.x-f.x)*u.y)*m,y=(c.x*(g.y*h.x-f.y*d.x)+c.y*(f.x*d.x-g.x*h.x)+(g.x*f.y-f.x*g.y)*u.x)*m,w=(c.x*(g.y*h.y-f.y*d.y)+c.y*(f.x*d.y-g.x*h.y)+(g.x*f.y-f.x*g.y)*u.y)*m;r.setTransform(p,v,b,C,y,w,!0)}}restoreTransformUseContext2d(t,e,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(t,e,i,r,o,s,a){const l=t.project(e,i,r);t.translate(l.x,l.y,!1),t.scale(o,s,!1),t.rotate(a,!1),t.translate(-l.x,-l.y,!1),t.setTransformForCurrent()}_draw(t,e,i,r,o,s){const{context:a}=r;if(!a)return;const{renderable:l}=t.attribute;if(l===!1)return;a.highPerformanceSave();const u=this.transform(t,e,a,i),{x:h,y:d,z:c,lastModelMatrix:f}=u;this.z=c,this.drawPathProxy(t,a,h,d,r,o)||(this.drawShape(t,a,h,d,r,o,null,null,s),this.z=0,a.modelMatrix!==f&&Pi.free(a.modelMatrix),a.modelMatrix=f),a.highPerformanceRestore()}}var B7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},P7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},GT=function(n,t){return function(e,i){t(e,i,n)}};let _g=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=Pm,this.builtinContributions=[u7,d7,h7],this.init(n)}drawArcTailCapPath(n,t,e,i,r,o,s,a){const l=a-s,u=n.getParsedAngle(),h=u.startAngle;let d=u.endAngle;d=a;const c=d>h;let f=!1;if(r<o){const H=r;r=o,o=H}const{xors:g,yors:m,xirs:p,yirs:v,limitedOcr:b,outerCornerRadiusStart:C,outerCornerRadiusEnd:y,maxOuterCornerRadius:w,xore:_,yore:A,xire:T,yire:S,limitedIcr:x,innerDeltaAngle:E,innerStartAngle:M,innerCornerRadiusStart:L,innerCornerRadiusEnd:I,maxInnerCornerRadius:D}=AL(n,h,d,o,r);if(b>je){const H=ki(C,b),O=ki(y,b),N=Fs(p,v,g,m,r,H,Number(c)),U=Fs(_,A,T,S,r,O,Number(c));if(b<w&&H===O)t.moveTo(e+N.cx+N.x01,i+N.cy+N.y01),t.arc(e+N.cx,i+N.cy,b,Te(N.y01,N.x01),Te(U.y01,U.x01),!c);else{const W=d-l-.03,j=Te(U.y11,U.x11);t.arc(e,i,r,W,j,!c),O>0&&t.arc(e+U.cx,i+U.cy,O,Te(U.y11,U.x11),Te(U.y01,U.x01),!c)}}else t.moveTo(e+g,i+m);if(!(o>je)||E<.001)t.lineTo(e+T,i+S),f=!0;else if(x>je){const H=ki(L,x),O=ki(I,x),N=Fs(T,S,_,A,o,-O,Number(c)),U=Fs(g,m,p,v,o,-H,Number(c));if(t.lineTo(e+N.cx+N.x01,i+N.cy+N.y01),x<D&&H===O){const W=Te(U.y01,U.x01);t.arc(e+N.cx,i+N.cy,x,Te(N.y01,N.x01),W,!c)}else{O>0&&t.arc(e+N.cx,i+N.cy,O,Te(N.y01,N.x01),Te(N.y11,N.x11),!c);const W=Te(N.cy+N.y11,N.cx+N.x11),j=d-l-.03;t.arc(e,i,o,W,j,c)}}else t.lineTo(e+o*Ei(M),i+o*ti(M));return f}drawShape(n,t,e,i,r,o,s,a,l){l=l??ae(n,o==null?void 0:o.theme).arc;const{fill:u=l.fill,stroke:h=l.stroke,x:d=l.x,y:c=l.y,fillStrokeOrder:f=l.fillStrokeOrder}=n.attribute,g=this.valid(n,l,s,a);if(!g)return;const{fVisible:m,sVisible:p,doFill:v,doStroke:b}=g,{outerPadding:C=l.outerPadding,innerPadding:y=l.innerPadding,cap:w=l.cap,forceShowCap:_=l.forceShowCap}=n.attribute;let{outerRadius:A=l.outerRadius,innerRadius:T=l.innerRadius}=n.attribute;A+=C,T-=y;let S=0;const x=(cs(w)&&w||w[0])&&u.gradient==="conical";if(x){const{sc:I,startAngle:D,endAngle:H}=n.getParsedAngle();Se(H-D)<Zt-je&&(S=I||0,u.startAngle-=S,u.endAngle-=S)}let E=!1;const{isFullStroke:M,stroke:L}=K8(h);if((v||M)&&(t.beginPath(),z_(n,t,e,i,A,T),E=!0,t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,v,b,m,p,l,r,s,a),f?(this._runStroke(n,t,e,i,l,b,M,p,a),this._runFill(n,t,e,i,l,v,m,d,c,s)):(this._runFill(n,t,e,i,l,v,m,d,c,s),this._runStroke(n,t,e,i,l,b,M,p,a))),!M&&b&&(t.beginPath(),z_(n,t,e,i,A,T,L),E||this.beforeRenderStep(n,t,e,i,v,b,m,p,l,r,s,a),a?a(t,n.attribute,l):p&&(t.setStrokeStyle(n,n.attribute,e,i,l),t.stroke())),(cs(w)&&w||w[1])&&_){const{startAngle:I,endAngle:D}=n.getParsedAngle();if(Se(D-I)>=Zt-je){t.beginPath();const H=Math.abs(A-T)/2/A,{endAngle:O=l.endAngle,fill:N=l.fill}=n.attribute,U=O;this.drawArcTailCapPath(n,t,e,i,A,T,U,U+H),E||this.beforeRenderStep(n,t,e,i,v,b,m,p,l,r,s,a);const W=()=>{if(v){const Y=N;if(Y.gradient==="conical"){const Z=A9(0,0,O,Y);s||Ka&&(t.setCommonStyle(n,n.attribute,e,i,l),t.fillStyle=Z,t.fill())}}},j=()=>{b&&(a||p&&(t.setStrokeStyle(n,n.attribute,e,i,l),t.stroke()))};W(),j()}}this.afterRenderStep(n,t,e,i,v,b,m,p,l,r,s,a),x&&(u.startAngle+=S,u.endAngle+=S)}_runFill(n,t,e,i,r,o,s,a,l,u){o&&(u?u(t,n.attribute,r):s&&(t.setCommonStyle(n,n.attribute,a-e,l-i,r),t.fill()))}_runStroke(n,t,e,i,r,o,s,a,l){o&&s&&(l||a&&(t.setStrokeStyle(n,n.attribute,e,i,r),t.stroke()))}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).arc;this._draw(n,r,!1,e,i,r)}};_g=B7([Tt(),GT(0,ge(ci)),GT(0,Di(N_)),P7("design:paramtypes",[Object])],_g);var k7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},L7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},$T=function(n,t){return function(e,i){t(e,i,n)}};let Cg=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=km,this.builtinContributions=[f7,p7,g7],this.init(n)}drawShape(n,t,e,i,r,o,s,a){const l=ae(n,o==null?void 0:o.theme).circle,{radius:u=l.radius,startAngle:h=l.startAngle,endAngle:d=l.endAngle,x:c=l.x,y:f=l.y,fillStrokeOrder:g=l.fillStrokeOrder}=n.attribute,m=this.valid(n,l,s,a);if(!m)return;const{fVisible:p,sVisible:v,doFill:b,doStroke:C}=m;t.beginPath(),t.arc(e,i,u,h,d),t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,b,C,p,v,l,r,s,a);const y=()=>{b&&(s?s(t,n.attribute,l):p&&(t.setCommonStyle(n,n.attribute,c-e,f-i,l),t.fill()))},w=()=>{C&&(a?a(t,n.attribute,l):v&&(t.setStrokeStyle(n,n.attribute,c-e,f-i,l),t.stroke()))};g?(w(),y()):(y(),w()),this.afterRenderStep(n,t,e,i,b,C,p,v,l,r,s,a)}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).circle;this._draw(n,r,!1,e,i)}};Cg=k7([Tt(),$T(0,ge(ci)),$T(0,Di(W_)),L7("design:paramtypes",[Object])],Cg);function yg(n,t,e,i){if(!t.p1)return;const{offsetX:r=0,offsetY:o=0,offsetZ:s=0}=i||{};if(e===1)t.p2&&t.p3?n.bezierCurveTo(r+t.p1.x,o+t.p1.y,r+t.p2.x,o+t.p2.y,r+t.p3.x,o+t.p3.y,s):n.lineTo(r+t.p1.x,o+t.p1.y,s);else if(t.p2&&t.p3){const[a]=mu(t,e);n.bezierCurveTo(r+a.p1.x,o+a.p1.y,r+a.p2.x,o+a.p2.y,r+a.p3.x,o+a.p3.y,s)}else{const a=t.getPointAt(e);n.lineTo(r+a.x,o+a.y,s)}}function qT(n,t,e,i,r,o,s){var a;let l=t.p0,u=i;if(e&&e.originP1===e.originP2&&(l=e.p0),t.defined)i||(n.lineTo(l.x+r,l.y+o,s),u=!i);else{const{originP1:h,originP2:d}=t;let c;if(h&&h.defined!==!1&&!e?c=l:h&&d.defined!==!1&&(c=(a=t.p3)!==null&&a!==void 0?a:t.p1),i){u=!i;const f=c?c.x:t.p0.x,g=c?c.y:t.p0.y;n.moveTo(f+r,g+o,s)}else c&&(u=!i,n.lineTo(c.x+r,c.y+o,s))}return u}function DL(n,t,e,i,r){const{offsetX:o=0,offsetY:s=0,offsetZ:a=0,mode:l="none",drawConnect:u=!1}=r||{};if(u&&l==="none"||!t)return;let h=!0;const{curves:d}=t;if(e>=1){if(u){let v,b=!0;d.forEach((C,y)=>{C.originP1!==C.originP2&&(b=qT(n,C,v,b,o,s,a)),v=C})}else d.forEach(v=>{v.defined?(h&&n.moveTo(v.p0.x+o,v.p0.y+s,a),yg(n,v,1,r),h=!1):h=!0});return}if(e<=0)return;let c;i==="x"?c=ke.ROW:i==="y"?c=ke.COLUMN:i==="auto"&&(c=t.direction);const f=e*t.tryUpdateLength(c);let g=0,m=!0,p=null;for(let v=0,b=d.length;v<b;v++){const C=d[v],y=C.getLength(c),w=(f-g)/y;if(g+=y,w<0)break;if(u){if(C.originP1===C.originP2){p=C;continue}m=qT(n,C,p,m,o,s,a),p=C}else{if(!C.defined){h=!0;continue}h&&n.moveTo(C.p0.x+o,C.p0.y+s,a),yg(n,C,ki(w,1),r),h=!1}}}function D7(n,t,e,i){const{offsetX:r=0,offsetY:o=0}=i||{},s=t?t.points[t.points.length-1]:e.points[0];n.moveTo(s.x+r,s.y+o),e.points.forEach(a=>{a.defined!==!1?n.lineTo(a.x+r,a.y+o):n.moveTo(a.x+r,a.y+o)})}function I7(n,t,e,i){const{offsetX:r=0,offsetY:o=0}=i||{},{points:s}=e,a=[];for(let l=0;l<s.length;l++)s[l].defined;a.push(s),a.forEach((l,u)=>{var h,d,c,f;const g=t&&u===0?t.points[t.points.length-1]:l[0];n.moveTo(g.x+r,g.y+o),l.forEach(m=>{m.defined!==!1?n.lineTo(m.x+r,m.y+o):n.moveTo(m.x+r,m.y+o)});for(let m=l.length-1;m>=0;m--){const p=l[m];n.lineTo((h=p.x1)!==null&&h!==void 0?h:p.x,(d=p.y1)!==null&&d!==void 0?d:p.y)}n.lineTo((c=g.x1)!==null&&c!==void 0?c:g.x,(f=g.y1)!==null&&f!==void 0?f:g.y),n.closePath()})}var F7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let _d=class extends Xr{constructor(){super(...arguments),this.numberType=qd}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).line;this._draw(n,r,!1,e,i)}drawSegmentItem(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){var m;if(!t)return;n.beginPath();const p=(m=this.z)!==null&&m!==void 0?m:0;DL(n,t,l,u,{offsetX:h,offsetY:d,offsetZ:p}),c.cache&&!jt(c.cache)&&c.cache.curves.every(C=>C.defined)&&c.attribute.curveType&&c.attribute.curveType.includes("Closed")&&n.closePath(),n.setShadowBlendStyle&&n.setShadowBlendStyle(c,s,a);const{x:v=0,x:b=0}=s;return e!==!1&&(f?f(n,s,a):r&&(n.setCommonStyle(c,s,v-h,b-d,a),n.fill())),i!==!1&&(g?g(n,s,a):o&&(n.setStrokeStyle(c,s,v-h,b-d,a),n.stroke())),!1}drawLinearLineHighPerformance(n,t,e,i,r,o,s,a,l,u,h,d,c){var f;t.beginPath();const g=(f=this.z)!==null&&f!==void 0?f:0,{points:m}=n.attribute,p=m[0];t.moveTo(p.x+s,p.y+a,g);for(let C=1;C<m.length;C++){const y=m[C];t.lineTo(y.x+s,y.y+a,g)}t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l);const{x:v=0,x:b=0}=n.attribute;e!==!1&&(d?d(t,n.attribute,l):r&&(t.setCommonStyle(n,n.attribute,v-s,b-a,l),t.fill())),i!==!1&&(c?c(t,n.attribute,l):o&&(t.setStrokeStyle(n,n.attribute,v-s,b-a,l),t.stroke()))}drawShape(n,t,e,i,r,o,s,a){const l=ae(n,o==null?void 0:o.theme).line,{fill:u=l.fill,stroke:h=l.stroke,fillOpacity:d=l.fillOpacity,strokeOpacity:c=l.strokeOpacity,segments:f,points:g,closePath:m,curveTension:p=l.curveTension,connectedType:v=l.connectedType}=n.attribute;if(!this.valid(n,l,s,a))return;let{curveType:b=l.curveType}=n.attribute;m&&b==="linear"&&(b="linearClosed");const{clipRange:C=l.clipRange,clipRangeByDimension:y=l.clipRangeByDimension}=n.attribute;if(C===1&&!f&&!g.some(_=>_.defined===!1)&&b==="linear")return this.drawLinearLineHighPerformance(n,t,!!u,!!h,d,c,e,i,l,r,o,s,a);function w(_,A){return A==="none"?_:_.filter(T=>T.defined!==!1)}if(n.shouldUpdateShape()){const{points:_,segments:A}=n.attribute,T=_;if(A&&A.length){let S,x;if(n.cache=A.map((E,M)=>{if(E.points.length<=1&&M===0)return E.points[0]&&(x={endX:E.points[0].x,endY:E.points[0].y,curves:[{defined:E.points[0].defined!==!1}]}),null;M===1?S={x:x.endX,y:x.endY,defined:x.curves[x.curves.length-1].defined}:M>1&&(S.x=x.endX,S.y=x.endY,S.defined=x.curves[x.curves.length-1].defined);const L=Pa(w(E.points,v),b,{startPoint:S,curveTension:p});return x=L,L}).filter(E=>!!E),b==="linearClosed"){let E;for(let M=0;M<n.cache.length;M++){const L=n.cache[M];for(let I=0;I<L.curves.length;I++)if(L.curves[I].defined){E=L.curves[I].p0;break}if(E)break}n.cache[n.cache.length-1]&&n.cache[n.cache.length-1].lineTo(E.x,E.y,!0)}}else{if(!_||!_.length)return n.cache=null,void n.clearUpdateShapeTag();n.cache=Pa(w(T,v),b,{curveTension:p})}n.clearUpdateShapeTag()}if(Array.isArray(n.cache)){const _=n.attribute.segments.filter(A=>A.points.length);if(_[0].points.length===1&&_.shift(),C===1){let A=!1;n.cache.forEach((T,S)=>{A||(A=this.drawSegmentItem(t,T,!!u,!!h,d,c,_[S],[l,n.attribute],C,y,e,i,n,s,a))})}else{const A=n.cache.reduce((E,M)=>E+M.getLength(),0),T=C*A;let S=0,x=!1;n.cache.forEach((E,M)=>{if(x)return;const L=E.getLength(),I=(T-S)/L;S+=L,I>0&&(x=this.drawSegmentItem(t,E,!!u,!!h,d,c,_[M],[l,n.attribute],ki(I,1),y,e,i,n,s,a))})}}else this.drawSegmentItem(t,n.cache,!!u,!!h,d,c,n.attribute,l,C,y,e,i,n,s,a)}};_d=F7([Tt()],_d);function O7(n,t,e,i){var r;const{top:o,bottom:s}=t;if(o.curves.length!==s.curves.length)return;if(e>=1){const v=[],b=[];let C=!0;for(let y=0,w=o.curves.length;y<w;y++){const _=o.curves[y];C!==_.defined?(C?(Qc(n,v,b,i),v.length=0,b.length=0):(v.push(_),b.push(s.curves[w-y-1])),C=!C):C&&(v.push(_),b.push(s.curves[w-y-1]))}return void Qc(n,v,b,i)}if(e<=0)return;let{direction:a}=i||{};const{curves:l}=o,u=(r=l[l.length-1].p3)!==null&&r!==void 0?r:l[l.length-1].p1,h=Se(u.x-l[0].p0.x),d=Se(u.y-l[0].p0.y);a=a??(h>d?ke.ROW:ke.COLUMN),Number.isFinite(h)||(a=ke.COLUMN),Number.isFinite(d)||(a=ke.ROW);const c=e*(a===ke.ROW?h:d);let f=0,g=!0;const m=[],p=[];for(let v=0,b=o.curves.length;v<b;v++){const C=o.curves[v],y=C.getLength(a),w=(c-f)/y;if(w<0)break;f+=y;let _=null,A=null;g!==C.defined?(g?(Qc(n,m,p,i),m.length=0,p.length=0):(_=C,A=s.curves[b-v-1]),g=!g):g&&(_=C,A=s.curves[b-v-1]),_&&A&&(w<1&&(_=_.p2&&_.p3?mu(_,w)[0]:jx(_,w)[0],A=A.p2&&A.p3?mu(A,1-w)[1]:jx(A,1-w)[1]),_.defined=g,A.defined=g,m.push(_),p.push(A)),_=null,A=null}Qc(n,m,p,i)}function Qc(n,t,e,i){const{offsetX:r=0,offsetY:o=0,offsetZ:s=0}=i||{};let a=!0;t.forEach(l=>{l.defined?(a&&n.moveTo(l.p0.x+r,l.p0.y+o,s),yg(n,l,1,i),a=!1):a=!0}),a=!0;for(let l=e.length-1;l>=0;l--){const u=e[l];u.defined?(a&&n.lineTo(u.p0.x+r,u.p0.y+o,s),yg(n,u,1,i),a=!1):a=!0}n.closePath()}const H7=new M7,z7=Ys;var N7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},W7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},XT=function(n,t){return function(e,i){t(e,i,n)}};let J_=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=vL,this.builtinContributions=[H7,z7],this.init(n)}drawLinearAreaHighPerformance(n,t,e,i,r,o,s,a,l,u,h,d,c){var f,g,m;const{points:p}=n.attribute;if(p.length<2)return;t.beginPath();const v=(f=this.z)!==null&&f!==void 0?f:0,b=p[0];t.moveTo(b.x+s,b.y+a,v);for(let w=1;w<p.length;w++){const _=p[w];t.lineTo(_.x+s,_.y+a,v)}for(let w=p.length-1;w>=0;w--){const _=p[w];t.lineTo(((g=_.x1)!==null&&g!==void 0?g:_.x)+s,((m=_.y1)!==null&&m!==void 0?m:_.y)+a,v)}t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,s,a,!!r,!1,e,!1,l,u,d,null,{attribute:n.attribute});const{x:C=0,x:y=0}=n.attribute;e!==!1&&(d?d(t,n.attribute,l):r&&(t.setCommonStyle(n,n.attribute,C-s,y-a,l),t.fill())),this.afterRenderStep(n,t,s,a,!!r,!1,e,!1,l,u,d,null,{attribute:n.attribute}),(()=>{var w,_;if(i){const{stroke:A=l&&l.stroke}=n.attribute;if(jt(A)&&(A[0]||A[2])&&A[1]===!1){if(t.beginPath(),A[0]){t.moveTo(b.x+s,b.y+a,v);for(let T=1;T<p.length;T++){const S=p[T];t.lineTo(S.x+s,S.y+a,v)}}else if(A[2]){const T=p[p.length-1];t.moveTo(T.x+s,T.y+a,v);for(let S=p.length-2;S>=0;S--){const x=p[S];t.lineTo(((w=x.x1)!==null&&w!==void 0?w:x.x)+s,((_=x.y1)!==null&&_!==void 0?_:x.y)+a,v)}}}c?c(t,n.attribute,l):(t.setStrokeStyle(n,n.attribute,C-s,y-a,l),t.stroke())}})()}drawShape(n,t,e,i,r,o,s,a){var l,u,h,d,c,f;const g=ae(n,o==null?void 0:o.theme).area,{fill:m=g.fill,stroke:p=g.stroke,fillOpacity:v=g.fillOpacity,z:b=g.z,strokeOpacity:C=g.strokeOpacity,curveTension:y=g.curveTension,connectedType:w=g.connectedType}=n.attribute,_=this.valid(n,g,s,a);if(!_)return;const{doFill:A}=_,T=_.doStroke&&_.sVisible,{clipRange:S=g.clipRange,closePath:x,points:E,segments:M}=n.attribute;let{curveType:L=g.curveType}=n.attribute;function I(D,H){return H!=="connect"?D:D.filter(O=>O.defined!==!1)}if(x&&L==="linear"&&(L="linearClosed"),S===1&&!M&&!E.some(D=>D.defined===!1)&&L==="linear")return this.drawLinearAreaHighPerformance(n,t,!!m,T,v,C,e,i,g,r,o,s,a);if(n.shouldUpdateShape()){if(M&&M.length){let D,H;const O=M.map((W,j)=>{if(W.points.length<=1&&j===0)return W.points[0]&&(H={endX:W.points[0].x,endY:W.points[0].y}),null;j===1?D={x:H.endX,y:H.endY}:j>1&&(D.x=H.endX,D.y=H.endY);const Y=Pa(I(W.points,w),L,{startPoint:D,curveTension:y});return H=Y,Y}).filter(W=>!!W);let N;const U=[];for(let W=M.length-1;W>=0;W--){const j=M[W].points,Y=[];for(let Z=j.length-1;Z>=0;Z--)Y.push({x:(l=j[Z].x1)!==null&&l!==void 0?l:j[Z].x,y:(u=j[Z].y1)!==null&&u!==void 0?u:j[Z].y});if(W!==0){const Z=M[W-1].points,rt=Z[Z.length-1];rt&&Y.push({x:(h=rt.x1)!==null&&h!==void 0?h:rt.x,y:(d=rt.y1)!==null&&d!==void 0?d:rt.y})}Y.length>1&&(N=Pa(I(Y,w),L==="stepBefore"?"stepAfter":L==="stepAfter"?"stepBefore":L,{curveTension:y}),U.unshift(N))}n.cacheArea=U.map((W,j)=>({top:O[j],bottom:W}))}else{if(!E||!E.length)return n.cacheArea=null,void n.clearUpdateShapeTag();{const D=I(E,w),H=[];for(let U=D.length-1;U>=0;U--)H.push({x:(c=D[U].x1)!==null&&c!==void 0?c:D[U].x,y:(f=D[U].y1)!==null&&f!==void 0?f:D[U].y});const O=Pa(D,L,{curveTension:y}),N=Pa(H,L==="stepBefore"?"stepAfter":L==="stepAfter"?"stepBefore":L,{curveTension:y});n.cacheArea={top:O,bottom:N}}}n.clearUpdateShapeTag()}if(Array.isArray(n.cacheArea)){const D=n.attribute.segments.filter(H=>H.points.length);if(D[0].points.length===1&&D.shift(),S===1){let H=!1;n.cacheArea.forEach((O,N)=>{H||(H=this.drawSegmentItem(t,O,A,v,T,C,D[N],[g,n.attribute],S,e,i,b,n,r,s,a))})}else{const H=n.cacheArea.reduce((W,j)=>W+j.top.getLength(),0),O=S*H;let N=0,U=!1;n.cacheArea.forEach((W,j)=>{if(U)return;const Y=W.top.getLength(),Z=(O-N)/Y;N+=Y,Z>0&&(U=this.drawSegmentItem(t,W,A,v,T,C,D[j],[g,n.attribute],ki(Z,1),e,i,b,n,r,s,a))})}}else this.drawSegmentItem(t,n.cacheArea,A,v,T,C,n.attribute,g,S,e,i,b,n,r,s,a)}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).area;this._draw(n,r,!1,e,i)}drawSegmentItem(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m){return this._drawSegmentItem(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m)}_drawSegmentItem(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m){if(!(t&&t.top&&t.bottom&&t.top.curves&&t.top.curves.length&&t.bottom.curves&&t.bottom.curves.length))return;n.beginPath();const{points:p,segments:v}=c.attribute;let b,C,y=ke.ROW;if(v){const S=v[v.length-1];C=v[0].points[0],b=S.points[S.points.length-1]}else C=p[0],b=p[p.length-1];const w=Se(b.x-C.x),_=Se(b.y-C.y);y=b.x1==null?ke.ROW:b.y1==null?ke.COLUMN:Number.isFinite(w+_)?w>_?ke.ROW:ke.COLUMN:ke.ROW,O7(n,t,l,{offsetX:u,offsetY:h,offsetZ:d,direction:y}),this.beforeRenderStep(c,n,u,h,!!i,!1,e,!1,a,f,g,null,{attribute:s}),n.setShadowBlendStyle&&n.setShadowBlendStyle(c,s,a);const{x:A=0,x:T=0}=s;return e!==!1&&(g?g(n,s,a):i&&(n.setCommonStyle(c,s,A-u,T-h,a),n.fill())),this.afterRenderStep(c,n,u,h,!!i,!1,e,!1,a,f,g,null,{attribute:s}),(()=>{if(r!==!1)if(m)m(n,s,a);else{const{stroke:S=a&&a[1]&&a[1].stroke}=s;jt(S)&&(S[0]||S[2])&&S[1]===!1&&(n.beginPath(),DL(n,S[0]?t.top:t.bottom,l,y===ke.ROW?"x":"y",{offsetX:u,offsetY:h,offsetZ:d})),n.setStrokeStyle(c,s,A-u,T-h,a),n.stroke()}})(),!1}};J_=N7([Tt(),XT(0,ge(ci)),XT(0,Di(O9)),W7("design:paramtypes",[Object])],J_);const U7=Hu,V7=Ys;var j7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},G7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},YT=function(n,t){return function(e,i){t(e,i,n)}};let wg=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=Dm,this.builtinContributions=[V7,U7],this.init(n)}drawShape(n,t,e,i,r,o,s,a){var l,u,h;const d=(l=this.tempTheme)!==null&&l!==void 0?l:ae(n,o==null?void 0:o.theme).path,{x:c=d.x,y:f=d.y,fillStrokeOrder:g=d.fillStrokeOrder}=n.attribute,m=(u=this.z)!==null&&u!==void 0?u:0,p=this.valid(n,d,s,a);if(!p)return;const{fVisible:v,sVisible:b,doFill:C,doStroke:y}=p;if(t.beginPath(),n.pathShape)fs(n.pathShape.commandList,t,e,i,1,1,m);else{const A=(h=n.attribute.path)!==null&&h!==void 0?h:d.path;fs(A.commandList,t,e,i,1,1,m)}t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,d),this.beforeRenderStep(n,t,e,i,C,y,v,b,d,r,s,a);const w=()=>{y&&(a?a(t,n.attribute,d):b&&(t.setStrokeStyle(n,n.attribute,c-e,f-i,d),t.stroke()))},_=()=>{C&&(s?s(t,n.attribute,d):v&&(t.setCommonStyle(n,n.attribute,c-e,f-i,d),t.fill()))};g?(w(),_()):(_(),w()),this.afterRenderStep(n,t,e,i,C,y,v,b,d,r,s,a)}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).path;this.tempTheme=r,this._draw(n,r,!1,e,i),this.tempTheme=null}};wg=j7([Tt(),YT(0,ge(ci)),YT(0,Di(U_)),G7("design:paramtypes",[Object])],wg);var $7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},q7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},KT=function(n,t){return function(e,i){t(e,i,n)}};let Sg=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.type="rect",this.numberType=Cw,this.builtinContributions=[v7,_7,b7],this.init(n)}drawShape(n,t,e,i,r,o,s,a,l){l=l??ae(n,o==null?void 0:o.theme).rect;const{fill:u=l.fill,background:h,stroke:d=l.stroke,cornerRadius:c=l.cornerRadius,cornerType:f=l.cornerType,opacity:g=l.opacity,fillOpacity:m=l.fillOpacity,lineWidth:p=l.lineWidth,strokeOpacity:v=l.strokeOpacity,visible:b=l.visible,x1:C,y1:y,x:w=l.x,y:_=l.y,fillStrokeOrder:A=l.fillStrokeOrder}=n.attribute;let{width:T,height:S}=n.attribute;T=(T??C-w)||0,S=(S??y-_)||0;const x=xL(g,m,T,S,u),E=TL(g,v,T,S),M=bu(u,h),L=pd(d,p);if(!n.valid||!b||!M&&!L||!(x||E||s||a||h))return;c===0||jt(c)&&c.every(D=>D===0)?(t.beginPath(),t.rect(e,i,T,S)):(t.beginPath(),Lo(t,e,i,T,S,c,f!=="bevel"));const I={doFill:M,doStroke:L};t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,M,L,x,E,l,r,s,a,I),A?(this._runStroke(n,t,e,i,l,I,E,w,_,a),this._runFill(n,t,e,i,l,I,x,w,_,s)):(this._runFill(n,t,e,i,l,I,x,w,_,s),this._runStroke(n,t,e,i,l,I,E,w,_,a)),this.afterRenderStep(n,t,e,i,M,L,x,E,l,r,s,a)}_runFill(n,t,e,i,r,o,s,a,l,u){o.doFill&&(u?u(t,n.attribute,r):s&&(t.setCommonStyle(n,n.attribute,a-e,l-i,r),t.fill()))}_runStroke(n,t,e,i,r,o,s,a,l,u){o.doStroke&&(u?u(t,n.attribute,r):s&&(t.setStrokeStyle(n,n.attribute,a-e,l-i,r),t.stroke()))}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).rect;this._draw(n,r,!1,e,i,r)}};Sg=$7([Tt(),KT(0,ge(ci)),KT(0,Di(Da)),q7("design:paramtypes",[Object])],Sg);var X7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Y7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},ZT=function(n,t){return function(e,i){t(e,i,n)}};let xg=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=Fm,this.builtinContributions=[T7,E7,R7,A7],this.init(n)}drawShape(n,t,e,i,r,o,s,a,l){var u;l=l??ae(n,o==null?void 0:o.theme).symbol;const{size:h=l.size,x:d=l.x,y:c=l.y,scaleX:f=l.scaleX,scaleY:g=l.scaleY,fillStrokeOrder:m=l.fillStrokeOrder,clipRange:p=l.clipRange}=n.attribute,v=this.valid(n,l,s,a);if(!v)return;const{fVisible:b,sVisible:C,doFill:y,doStroke:w}=v,_=n.getParsedPath();if(!_)return;const{keepDirIn3d:A=l.keepDirIn3d}=n.attribute,T=(u=this.z)!==null&&u!==void 0?u:0;t.beginPath();let S=e,x=i,E=T;const M=t.camera;if(A&&M&&t.project){const L=t.project(e,i,T);t.camera=null,jt(h)?(h[0]*f,h[1]*g):h*f,S=L.x,x=L.y,E=void 0}_.draw(t,h,S,x,E,(L,I)=>{var D,H,O,N;if(n._parsedPath.svgCache){const j=Object.assign({},I);j.fill=(D=I.fill)!==null&&D!==void 0?D:n.attribute.fill,j.opacity=(H=I.opacity)!==null&&H!==void 0?H:n.attribute.opacity,j.fillOpacity=n.attribute.fillOpacity,j.stroke=(O=I.stroke)!==null&&O!==void 0?O:n.attribute.stroke,j.lineWidth=(N=I.lineWidth)!==null&&N!==void 0?N:n.attribute.lineWidth,I=j}const U=()=>{I.fill&&(s?s(t,n.attribute,l):(t.setCommonStyle(n,I,d-e,c-i,l),t.fill()))},W=()=>{I.stroke&&(a?a(t,n.attribute,l):C&&p>=1&&(t.setStrokeStyle(n,I,(d-e)/f,(c-i)/g,l),t.stroke()))};m?(W(),U()):(U(),W())})===!1&&t.closePath(),t.camera=M,t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,y,w,b,C,l,r,s,a),m?(this._runStroke(n,t,e,i,l,w,C,d,c,_,p,f,g,a),this._runFill(n,t,e,i,l,y,b,d,c,_,s)):(this._runFill(n,t,e,i,l,y,b,d,c,_,s),this._runStroke(n,t,e,i,l,w,C,d,c,_,p,f,g,a)),this.afterRenderStep(n,t,e,i,y,w,b,C,l,r,s,a)}_runFill(n,t,e,i,r,o,s,a,l,u,h){o&&!u.isSvg&&(h?h(t,n.attribute,r):s&&(t.setCommonStyle(n,n.attribute,a-e,l-i,r),t.fill()))}_runStroke(n,t,e,i,r,o,s,a,l,u,h,d,c,f){o&&!u.isSvg&&(f?f(t,n.attribute,r):s&&h>=1&&(t.setStrokeStyle(n,n.attribute,(a-e)/d,(l-i)/c,r),t.stroke()))}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).symbol;this._draw(n,r,!1,e,i)}};xg=X7([Tt(),ZT(0,ge(ci)),ZT(0,Di(j_)),Y7("design:paramtypes",[Object])],xg);class K7{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new Ye)}allocate(t,e,i,r){if(!this.pools.length)return new Ye().setValue(t,e,i,r);const o=this.pools.pop();return o.x1=t,o.y1=e,o.x2=i,o.y2=r,o}allocateByObj(t){if(!this.pools.length)return new Ye(t);const e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const Tg=new K7;class Z7 extends Nm{constructor(){super(...arguments),this.time=we.beforeFillStroke}drawShape(t,e,i,r,o,s,a,l,u,h,d,c){var f,g,m,p,v,b,C,y,w,_;const{backgroundMode:A=u.backgroundMode,backgroundFit:T=u.backgroundFit,backgroundKeepAspectRatio:S=u.backgroundKeepAspectRatio}=t.attribute;let x,{background:E}=t.attribute;if(!E)return;const M=()=>{t.type==="richtext"&&(e.restore(),e.save(),x&&e.setTransformFromMatrix(x,!0,1))};let L;t.type==="richtext"&&(x=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());const I=$i(E)&&E.background,D=t.transMatrix.onlyTranslate();if(I){const H=t.AABBBounds,O=((f=E.x)!==null&&f!==void 0?f:H.x1)+((g=E.dx)!==null&&g!==void 0?g:0),N=((m=E.y)!==null&&m!==void 0?m:H.y1)+((p=E.dy)!==null&&p!==void 0?p:0),U=(v=E.width)!==null&&v!==void 0?v:H.width(),W=(b=E.height)!==null&&b!==void 0?b:H.height();if(L=Tg.allocate(O,N,O+U,N+W),E=E.background,!D){const j=L.width(),Y=L.height();L.set(((C=E.x)!==null&&C!==void 0?C:0)+((y=E.dx)!==null&&y!==void 0?y:0),((w=E.y)!==null&&w!==void 0?w:0)+((_=E.dy)!==null&&_!==void 0?_:0),j,Y)}}else L=t.AABBBounds,D||(L=zm(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){const H=t.resources.get(E);if(H.state!=="success"||!H.data)return void M();e.highPerformanceSave(),D&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,r,u),this.doDrawImage(e,H.data,L,{backgroundMode:A,backgroundFit:T,backgroundKeepAspectRatio:S}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{const{backgroundCornerRadius:H}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,u),e.fillStyle=E,H?(Lo(e,L.x1,L.y1,L.width(),L.height(),H,!0),e.fill()):e.fillRect(L.x1,L.y1,L.width(),L.height()),e.highPerformanceRestore()}I&&Tg.free(L),M()}}const IL=new Z7;var Q7=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},J7=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},QT=function(n,t){return function(e,i){t(e,i,n)}};let tC=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=Om,this.builtinContributions=[IL],this.init(n)}drawShape(n,t,e,i,r,o,s,a){var l,u,h;const d=ae(n,o==null?void 0:o.theme).text,{text:c,underline:f=d.underline,lineThrough:g=d.lineThrough,keepDirIn3d:m=d.keepDirIn3d,direction:p=d.direction,fontSize:v=d.fontSize,verticalMode:b=d.verticalMode,x:C=d.x,y=d.y}=n.attribute,w=(l=$d(n.attribute.lineHeight,v))!==null&&l!==void 0?l:v,_=this.valid(n,d,s,a);if(!_)return;const{fVisible:A,sVisible:T,doFill:S,doStroke:x}=_,E=!m,M=this.z||0;t.beginPath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,d),this.beforeRenderStep(n,t,e,i,S,x,A,T,d,r,s,a),E&&this.transformUseContext2d(n,d,M,t);const L=(I,D,H,O)=>{let N=e+D;const U=i+H;if(O){t.highPerformanceSave(),N+=v;const W=qi.allocate(1,0,0,1,0,0);W.rotateByCenter(Math.PI/2,N,U),t.transformFromMatrix(W,!0),qi.free(W)}x&&(a?a(t,n.attribute,d):T&&(t.setStrokeStyle(n,n.attribute,C-e,y-i,d),t.strokeText(I,N,U,M))),S&&(s?s(t,n.attribute,d):A&&(t.setCommonStyle(n,n.attribute,C-e,y-i,d),t.fillText(I,N,U,M))),O&&(t.highPerformanceRestore(),t.setTransformForCurrent())};if(t.setTextStyleWithoutAlignBaseline(n.attribute,d,M),p==="horizontal"){const{multilineLayout:I}=n;if(!I)return void t.highPerformanceRestore();const{xOffset:D,yOffset:H}=I.bbox;x&&(a?a(t,n.attribute,d):T&&(t.setStrokeStyle(n,n.attribute,C-e,y-i,d),I.lines.forEach(O=>{t.strokeText(O.str,(O.leftOffset||0)+D+e,(O.topOffset||0)+H+i,M)}))),S&&(s?s(t,n.attribute,d):A&&(t.setCommonStyle(n,n.attribute,C-e,y-i,d),I.lines.forEach(O=>{t.fillText(O.str,(O.leftOffset||0)+D+e,(O.topOffset||0)+H+i,M),this.drawUnderLine(f,g,n,(O.leftOffset||0)+D+e,(O.topOffset||0)+H+i,O.descent,(O.descent-O.ascent)/2,M,d,t,{width:O.width})})))}else{let{textAlign:I=d.textAlign,textBaseline:D=d.textBaseline}=n.attribute;if(!b){const Y=I;I=(u=n.getBaselineMapAlign()[D])!==null&&u!==void 0?u:"left",D=(h=n.getAlignMapBaseline()[Y])!==null&&h!==void 0?h:"top"}n.tryUpdateAABBBounds();const H=n.cache,{verticalList:O}=H;t.textAlign="left",t.textBaseline="top";const N=w*O.length;let U=0;O.forEach(Y=>{const Z=Y.reduce((rt,J)=>rt+(J.width||0),0);U=un(Z,U)});let W=0,j=0;D==="bottom"?j=-N:D==="middle"&&(j=-N/2),I==="center"?W-=U/2:I==="right"&&(W-=U),O.forEach((Y,Z)=>{const rt=Y.reduce((ht,at)=>ht+(at.width||0),0),J=U-rt;let st=W;I==="center"?st+=J/2:I==="right"&&(st+=J),Y.forEach(ht=>{const{text:at,width:lt,direction:_t}=ht;L(at,N-(Z+1)*w+j,st,_t),st+=lt})})}E&&this.restoreTransformUseContext2d(n,d,M,t),this.afterRenderStep(n,t,e,i,S,x,A,T,d,r,s,a)}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).text,{keepDirIn3d:o=r.keepDirIn3d}=n.attribute,s=!o;this._draw(n,r,s,e,i)}drawUnderLine(n,t,e,i,r,o,s,a,l,u,h){if(t+n<=0)return;const{textAlign:d=l.textAlign,fill:c=l.fill,opacity:f=l.opacity,underlineOffset:g=l.underlineOffset,underlineDash:m=l.underlineDash,fillOpacity:p=l.fillOpacity}=e.attribute,v=!zt(h),b=v?h.width:e.clipedWidth,C=v?0:_u(d,b),y={lineWidth:0,stroke:c,opacity:f,strokeOpacity:p};if(n){y.lineWidth=n,u.setStrokeStyle(e,y,i,r,l),m&&u.setLineDash(m),u.beginPath();const w=r+o+g;u.moveTo(i+C,w,a),u.lineTo(i+C+b,w,a),u.stroke()}if(t){y.lineWidth=t,u.setStrokeStyle(e,y,i,r,l),u.beginPath();const w=r+s;u.moveTo(i+C,w,a),u.lineTo(i+C+b,w,a),u.stroke()}}};tC=Q7([Tt(),QT(0,ge(ci)),QT(0,Di(vg)),J7("design:paramtypes",[Object])],tC);function FL(n,t,e,i){if(t&&t.length){n.moveTo(t[0].x+e,t[0].y+i);for(let r=1;r<t.length;r++)n.lineTo(t[r].x+e,t[r].y+i)}}function tV(n,t,e,i,r,o=!0){var s;if(t.length<3)return void FL(n,t,e,i);let a=0,l=t.length-1;o||(a+=1,l-=1,n.moveTo(t[0].x+e,t[0].y+i));for(let u=a;u<=l;u++){const h=t[u===0?l:(u-1)%t.length],d=t[u%t.length],c=t[(u+1)%t.length],f=d.x-h.x,g=d.y-h.y,m=d.x-c.x,p=d.y-c.y,v=(Math.atan2(g,f)-Math.atan2(p,m))/2,b=Math.abs(Math.tan(v));let C=Array.isArray(r)?(s=r[u%t.length])!==null&&s!==void 0?s:0:r,y=C/b;const w=Jc(f,g),_=Jc(m,p),A=Math.min(w,_);y>A&&(y=A,C=A*b);const T=fv(d,y,w,f,g),S=fv(d,y,_,m,p),x=2*d.x-T.x-S.x,E=2*d.y-T.y-S.y,M=Jc(x,E),L=fv(d,Jc(y,C),M,x,E);let I=Math.atan2(T.y-L.y,T.x-L.x);const D=Math.atan2(S.y-L.y,S.x-L.x);let H=D-I;H<0&&(I=D,H=-H),H>Math.PI&&(H-=Math.PI),u===0?n.moveTo(T.x+e,T.y+i):n.lineTo(T.x+e,T.y+i),H&&n.arcTo(d.x+e,d.y+i,S.x+e,S.y+i,C),n.lineTo(S.x+e,S.y+i)}o||n.lineTo(t[l+1].x+e,t[l+1].y+i)}function Jc(n,t){return Math.sqrt(n*n+t*t)}function fv(n,t,e,i,r){const o=t/e;return{x:n.x-i*o,y:n.y-r*o}}const eV=Hu,iV=Ys;var rV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},nV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},JT=function(n,t){return function(e,i){t(e,i,n)}};let eC=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=Im,this.builtinContributions=[iV,eV],this.init(n)}drawShape(n,t,e,i,r,o,s,a){const l=ae(n,o==null?void 0:o.theme).polygon,{points:u=l.points,cornerRadius:h=l.cornerRadius,x:d=l.x,y:c=l.y,closePath:f=l.closePath,fillStrokeOrder:g=l.fillStrokeOrder}=n.attribute,m=this.valid(n,l,s,a);if(!m)return;const{fVisible:p,sVisible:v,doFill:b,doStroke:C}=m;t.beginPath(),h<=0||jt(h)&&h.every(_=>_===0)?FL(t.camera?t:t.nativeContext,u,e,i):tV(t.camera?t:t.nativeContext,u,e,i,h,f),f&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,b,C,p,v,l,r,s,a);const y=()=>{b&&(s?s(t,n.attribute,l):p&&(t.setCommonStyle(n,n.attribute,d-e,c-i,l),t.fill()))},w=()=>{C&&(a?a(t,n.attribute,l):v&&(t.setStrokeStyle(n,n.attribute,d-e,c-i,l),t.stroke()))};g?(w(),y()):(y(),w()),this.afterRenderStep(n,t,e,i,b,C,p,v,l,r,s,a)}draw(n,t,e,i){const r=ae(n,i==null?void 0:i.theme).polygon;this._draw(n,r,!1,e,i)}};eC=rV([Tt(),JT(0,ge(ci)),JT(0,Di(V_)),nV("design:paramtypes",[Object])],eC);var oV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},sV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},tA=function(n,t){return function(e,i){t(e,i,n)}};let iC=class{constructor(n){this.groupRenderContribitions=n,this.numberType=_w}reInit(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(jT)}drawShape(n,t,e,i,r,o,s,a,l){const{clip:u,fill:h,stroke:d,background:c}=n.attribute;if(!(u||h||d||c))return;l=l??ae(n,o==null?void 0:o.theme).group;const{opacity:f=l.opacity,width:g=l.width,height:m=l.height,fillOpacity:p=l.fillOpacity,strokeOpacity:v=l.strokeOpacity,cornerRadius:b=l.cornerRadius,path:C=l.path,lineWidth:y=l.lineWidth,visible:w=l.visible,fillStrokeOrder:_=l.fillStrokeOrder,cornerType:A=l.cornerType,x:T=l.x,y:S=l.y}=n.attribute,x=xL(f,p,g,m,h),E=TL(f,v,g,m),M=bu(h,c),L=pd(d,y);if(!n.valid||!w||!u&&(!M&&!L||!(x||E||s||a||c)))return;if(C&&C.length&&r.drawContribution){const O=t.disableFill,N=t.disableStroke,U=t.disableBeginPath;t.disableFill=!0,t.disableStroke=!0,t.disableBeginPath=!0,C.forEach(W=>{r.drawContribution.getRenderContribution(W).draw(W,r.renderService,r,o)}),t.disableFill=O,t.disableStroke=N,t.disableBeginPath=U}else b===0||jt(b)&&b.every(O=>O===0)?(t.beginPath(),t.rect(e,i,g,m)):(t.beginPath(),Lo(t,e,i,g,m,b,A!=="bevel"));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(jT));const I={doFill:M,doStroke:L};t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this._groupRenderContribitions.forEach(O=>{O.time===we.beforeFillStroke&&O.drawShape(n,t,e,i,M,L,x,E,l,r,s,a,I)}),u&&t.clip();const D=()=>{I.doFill&&(s?s(t,n.attribute,l):x&&(t.setCommonStyle(n,n.attribute,T-e,S-i,l),t.fill()))},H=()=>{I.doStroke&&(a?a(t,n.attribute,l):E&&(t.setStrokeStyle(n,n.attribute,T-e,S-i,l),t.stroke()))};_?(H(),D()):(D(),H()),this._groupRenderContribitions.forEach(O=>{O.time===we.afterFillStroke&&O.drawShape(n,t,e,i,M,L,x,E,l,r,s,a)})}draw(n,t,e,i){var r,o;const{context:s}=e;if(!s)return;const{clip:a,baseOpacity:l=1,drawMode:u}=n.attribute,h=s.nativeContext,d=s.canvas.nativeCanvas;if(u>0){const{x:v,y:b,width:C,height:y}=n.attribute,w=s.canvas,_=Mt.global.createCanvas({width:w.width,height:w.height,dpr:1}),A=_.getContext("2d"),T=s.nativeContext.getTransform();A.setTransform(T.a,T.b,T.c,T.d,T.e,T.f),u===1&&(A.save(),A.clearRect(0,0,w.width,w.height),A.beginPath(),A.rect(v,b,C,y),A.clip(),A.drawImage(w.nativeCanvas,0,0,w.width,w.height,0,0,w.displayWidth,w.displayHeight),A.restore()),s.nativeContext=A,w.nativeCanvas=_}a?s.save():s.highPerformanceSave();const c=s.baseGlobalAlpha;s.baseGlobalAlpha*=l;const f=s.modelMatrix;if(s.camera){const v=ae(n,i==null?void 0:i.theme).group,b=Pi.allocate(),C=Pi.allocate();RL(C,n,v),Xd(b,f||b,C),s.modelMatrix=b,Pi.free(C),s.setTransform(1,0,0,1,0,0,!0)}else s.transformFromMatrix(n.transMatrix,!0);s.beginPath(),i.skipDraw?this.drawShape(n,s,0,0,e,i,()=>!1,()=>!1):this.drawShape(n,s,0,0,e,null,null,null);const{scrollX:g,scrollY:m}=n.attribute;let p;if((g||m)&&s.translate(g,m),i&&i.renderInGroup&&(p=i.renderInGroup((r=i.renderInGroupParams)===null||r===void 0?void 0:r.skipSort,n,e,(o=i.renderInGroupParams)===null||o===void 0?void 0:o.nextM)),s.modelMatrix!==f&&Pi.free(s.modelMatrix),s.modelMatrix=f,s.baseGlobalAlpha=c,u>0){const{x:v,y:b,width:C,height:y}=n.attribute,w=s.nativeContext,_=s.canvas.nativeCanvas;h.save(),h.setTransform(s.dpr,0,0,s.dpr,0,0,!0),u===1&&w.rect(v,b,C,y),h.drawImage(_,0,0,_.width,_.height,0,0,s.canvas.displayWidth,s.canvas.displayHeight);const A=w.getTransform();h.setTransform(A.a,A.b,A.c,A.d,A.e,A.f),s.nativeContext=h,s.canvas.nativeCanvas=d,h.restore()}p&&p.then?p.then(()=>{a?s.restore():s.highPerformanceRestore()}):a?s.restore():s.highPerformanceRestore()}};iC=oV([Tt(),tA(0,ge(ci)),tA(0,Di(Un)),sV("design:paramtypes",[Object])],iC);var aV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},lV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},eA=function(n,t){return function(e,i){t(e,i,n)}};const uV=["","repeat-x","repeat-y","repeat"];let rC=class extends Xr{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=Lm,this.builtinContributions=[y7,w7],this.init(n)}drawShape(n,t,e,i,r,o,s,a){const l=ae(n).image,{repeatX:u=l.repeatX,repeatY:h=l.repeatY,x:d=l.x,y:c=l.y,cornerRadius:f=l.cornerRadius,fillStrokeOrder:g=l.fillStrokeOrder,cornerType:m=l.cornerType,image:p}=n.attribute,v=this.valid(n,l,s);if(!v)return;const{fVisible:b,sVisible:C,doFill:y,doStroke:w}=v;if(!p||!n.resources)return;const _=n.resources.get(p);if(_.state!=="success")return;const A=n.width,T=n.height;t.beginPath();let S=!1;f===0||jt(f)&&f.every(M=>M===0)?t.rect(e,i,A,T):(Lo(t,e,i,A,T,f,m!=="bevel"),S=!0),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l);const x=()=>{if(y){if(s)s(t,n.attribute,l);else if(b){t.setCommonStyle(n,n.attribute,e,i,l);let M=0;if(u==="repeat"&&(M|=1),h==="repeat"&&(M|=2),M){const L=t.createPattern(_.data,uV[M]);t.fillStyle=L,t.translate(e,i,!0),t.fillRect(0,0,A,T),t.translate(-e,-i,!0)}else t.drawImage(_.data,e,i,A,T)}}},E=()=>{w&&(a?a(t,n.attribute,l):C&&(t.setStrokeStyle(n,n.attribute,d-e,c-i,l),t.stroke()))};g?(E(),S&&(t.save(),t.clip()),this.beforeRenderStep(n,t,e,i,y,!1,b,!1,l,r,s),x(),S&&t.restore()):(S&&(t.save(),t.clip()),this.beforeRenderStep(n,t,e,i,y,!1,b,!1,l,r,s),x(),S&&t.restore(),E()),this.afterRenderStep(n,t,e,i,y,!1,b,!1,l,r,s)}draw(n,t,e){const{image:i}=n.attribute;if(!i||!n.resources)return;const r=n.resources.get(i);if(r.state==="loading"&&lr(i))return void Oe.improveImageLoading(i);if(r.state!=="success")return;const{context:o}=t.drawParams;if(!o)return;const s=ae(n).image;this._draw(n,s,!1,e)}};rC=aV([Tt(),eA(0,ge(ci)),eA(0,Di(La)),lV("design:paramtypes",[Object])],rC);const OL=Symbol.for("IncrementalDrawContribution"),Ag=Symbol.for("ArcRender"),Rg=Symbol.for("CircleRender"),zr=Symbol.for("GraphicRender"),iA=Symbol.for("GroupRender"),Eg=Symbol.for("LineRender"),Mg=Symbol.for("PathRender"),Bg=Symbol.for("PolygonRender"),Pg=Symbol.for("RectRender"),kg=Symbol.for("SymbolRender"),nC=Symbol.for("TextRender"),oC=Symbol.for("RichTextRender"),sC=Symbol.for("ImageRender"),Bw=Symbol.for("DrawContribution"),HL=(n,t,e,i)=>{let r,o=!1,s=!1;if(t.forEachChildren(a=>(o=a.numberType===d9,!o)),t.forEachChildren(a=>(s=!!a.findFace,!s)),o){const a=t.getChildren(),l=[...a];l.sort((u,h)=>{var d,c,f,g;let m=((c=(d=u.attribute.startAngle)!==null&&d!==void 0?d:0+u.attribute.endAngle)!==null&&c!==void 0?c:0)/2,p=((g=(f=h.attribute.startAngle)!==null&&f!==void 0?f:0+h.attribute.endAngle)!==null&&g!==void 0?g:0)/2;for(;m<0;)m+=Zt;for(;p<0;)p+=Zt;return p-m}),l.forEach(u=>{u._next=null,u._prev=null}),t.removeAllChild(),t.update(),l.forEach(u=>{t.appendChild(u)}),i.hack_pieFace="outside",r=e(o,s),r&&r.graphic||(i.hack_pieFace="inside",r=e(o,s)),r&&r.graphic||(i.hack_pieFace="top",r=e(o,s)),t.removeAllChild(),a.forEach(u=>{u._next=null,u._prev=null}),a.forEach(u=>{t.appendChild(u)})}else if(s){const a=t.getChildren(),l=a.map(u=>({ave_z:u.findFace().vertices.map(h=>{var d;return n.view(h[0],h[1],(d=h[2]+u.attribute.z)!==null&&d!==void 0?d:0)[2]}).reduce((h,d)=>h+d,0),g:u}));l.sort((u,h)=>h.ave_z-u.ave_z),t.removeAllChild(),l.forEach(u=>{u.g._next=null,u.g._prev=null}),t.update(),l.forEach(u=>{t.add(u.g)}),r=e(o,s),t.removeAllChild(),a.forEach(u=>{u._next=null,u._prev=null}),t.update(),a.forEach(u=>{t.add(u)})}else r=e(o,s);return r};var hV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},dV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const Cd=Symbol.for("DrawItemInterceptor"),rA=new Ye,nA=new Ye;class cV{constructor(){this.order=1}afterDrawItem(t,e,i,r,o){return t.attribute.shadowRootIdx==null&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,r,o),!1}beforeDrawItem(t,e,i,r,o){return t.attribute.shadowRootIdx==null&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,r,o),!1}drawItem(t,e,i,r,o){if(!t.shadowRoot)return!1;const{context:s}=i;if(s.highPerformanceSave(),s.transformFromMatrix(t.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds){rA.copy(r.dirtyBounds),nA.copy(r.backupDirtyBounds);const a=t.globalTransMatrix.getInverse();r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(a),r.backupDirtyBounds.copy(r.dirtyBounds)}return r.renderGroup(t.shadowRoot,i,qi.allocate(1,0,0,1,0,0)),s.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(rA),r.backupDirtyBounds.copy(nA)),!0}}class fV{constructor(){this.order=1}afterDrawItem(t,e,i,r,o){return t.attribute._debug_bounds&&this.drawItem(t,e,i,r,o),!1}drawItem(t,e,i,r,o){if(!t.attribute._debug_bounds)return!1;const{context:s}=i;s.highPerformanceSave(),t.parent&&s.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&s.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);const a=t.AABBBounds;return t.attribute._debug_bounds!==!0&&t.attribute._debug_bounds(s,t),s.strokeRect(a.x1,a.y1,a.width(),a.height()),s.highPerformanceRestore(),!0}}let Lg=class{constructor(){this.order=1,this.interceptors=[new cV,new pV,new gV,new fV]}afterDrawItem(n,t,e,i,r){if((!n.in3dMode||e.in3dInterceptor)&&!n.shadowRoot&&!n.attribute._debug_bounds&&!(n.baseGraphic||n.attribute.globalZIndex||n.interactiveGraphic))return!1;for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].afterDrawItem&&this.interceptors[o].afterDrawItem(n,t,e,i,r))return!0;return!1}beforeDrawItem(n,t,e,i,r){if((!n.in3dMode||e.in3dInterceptor)&&!n.shadowRoot&&!n.attribute._debug_bounds&&!(n.baseGraphic||n.attribute.globalZIndex||n.interactiveGraphic))return!1;for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].beforeDrawItem&&this.interceptors[o].beforeDrawItem(n,t,e,i,r))return!0;return!1}};Lg=hV([Tt(),dV("design:paramtypes",[])],Lg);class gV{constructor(){this.order=1}beforeDrawItem(t,e,i,r,o){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,r,o):this.beforeSetInteractive(t,e,i,r,o))}beforeSetInteractive(t,e,i,r,o){let s=t.interactiveGraphic;if(t.attribute.globalZIndex){s||(s=t.clone(),t.interactiveGraphic=s,s.baseGraphic=t),s.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();const a=i.stage.getLayer("_builtin_interactive");return a&&this.getShadowRoot(a).add(s),!0}if(s){i.stage.tryInitInteractiveLayer();const a=i.stage.getLayer("_builtin_interactive");a&&this.getShadowRoot(a).removeChild(s),t.interactiveGraphic=null,s.baseGraphic=null}return!1}beforeDrawInteractive(t,e,i,r,o){const s=t.baseGraphic;let a=!!s.stage,l=s.parent;for(;a&&l&&l.stage!==l;)a=!!l.stage,l=l.parent;if(!a){const u=i.stage.getLayer("_builtin_interactive");return u&&this.getShadowRoot(u).removeChild(t),!0}if(s){this.processing=!0;const{context:u}=i;return u.highPerformanceSave(),u.setTransformFromMatrix(s.parent.globalTransMatrix,!0),s.isContainer?r.renderGroup(s,i,s.parent.globalTransMatrix):r.renderItem(s,i),u.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let i=t.getElementById("_interactive_group");return i||(i=$t.CreateGraphic("group",{}),i.id="_interactive_group",t.add(i)),(e=i.shadowRoot)!==null&&e!==void 0?e:i.attachShadow()}}class pV{constructor(){this.order=1}beforeDrawItem(t,e,i,r,o){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;const{context:s,stage:a}=e.drawParams;s.canvas,s.save(),this.initCanvasCtx(s),s.camera=a.camera;const l=s.currentMatrix;l.a/=s.dpr,l.b/=s.dpr,l.c/=s.dpr,l.d/=s.dpr,l.e/=s.dpr,l.f/=s.dpr;const u=Pi.allocate();I_(u,l);const h=s.modelMatrix;if(h){if(u){const d=Pi.allocate();s.modelMatrix=Xd(d,h,u)}}else s.modelMatrix=u;return s.setTransform(1,0,0,1,0,0,!0),t.isContainer?HL(s,t,(d,c)=>r.renderGroup(t,i,t.parent.globalTransMatrix,!d&&c),i):r.renderItem(t,i),s.camera=null,s.restore(),s.modelMatrix!==h&&Pi.free(s.modelMatrix),s.modelMatrix=h,i.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}var mV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},vV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},bV=function(n,t){return function(e,i){t(e,i,n)}};const Pw=Symbol.for("RenderService");let aC=class{constructor(n){this.drawContribution=n}prepare(n){n&&this.renderTreeRoots.forEach(t=>{this._prepare(t,n)})}_prepare(n,t){n.forEachChildren(e=>{this._prepare(e,t)}),n.update({bounds:t,trans:!0})}prepareRenderList(){}beforeDraw(n){}draw(n){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(n){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}reInit(){this.drawContribution.reInit()}render(n,t){this.renderTreeRoots=n,this.drawParams=t;const e=t.updateBounds;this.prepare(e),this.prepareRenderList(),this.beforeDraw(t),this.draw(t),this.afterDraw(t),this.drawParams=null}};aC=mV([Tt(),bV(0,ge(Bw)),vV("design:paramtypes",[Object])],aC);const _V=new ie(n=>{n(Pw).to(aC)}),Yl=Symbol.for("PickerService"),oA=Symbol.for("GlobalPickerService"),Fl=Symbol.for("PickItemInterceptor"),Dg=Symbol.for("PickServiceInterceptor");var Wm=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Ig=class{constructor(){this.order=1}afterPickItem(n,t,e,i,r){if(n.graphic){let o=n.graphic;for(;o.parent;)o=o.parent;o.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=o.shadowHost)}return n}};Ig=Wm([Tt()],Ig);let Fg=class{constructor(){this.order=1}afterPickItem(n,t,e,i,r){return n.attribute.shadowRootIdx>0||!n.attribute.shadowRootIdx?this._pickItem(n,t,e,i,r):null}beforePickItem(n,t,e,i,r){return n.attribute.shadowRootIdx<0?this._pickItem(n,t,e,i,r):null}_pickItem(n,t,e,i,r){var o;if(!n.shadowRoot)return null;const{parentMatrix:s}=r||{};if(!s)return null;const a=t.pickContext;a.highPerformanceSave();const l=(o=ae(n))===null||o===void 0?void 0:o[n.type],{shadowPickMode:u=l==null?void 0:l.shadowPickMode}=n.attribute,h=n.shadowRoot,d=qi.allocateByObj(s),c=new ze(d.a*e.x+d.c*e.y+d.e,d.b*e.x+d.d*e.y+d.f),f=t.pickGroup(h,c,d,i);return a.highPerformanceRestore(),!f.graphic&&f.group&&u==="full"&&(f.graphic=f.group),f}};Fg=Wm([Tt()],Fg);let Og=class{constructor(){this.order=1}beforePickItem(n,t,e,i,r){const o=n.baseGraphic;if(o&&o.parent){const s=new ze(e.x,e.y),a=t.pickContext;a.highPerformanceSave();const l=o.parent.globalTransMatrix;l.transformPoint(s,s);const u=o.isContainer?t.pickGroup(o,s.clone(),l,i):t.pickItem(o,s.clone(),l,i);return a.highPerformanceRestore(),u}return null}};Og=Wm([Tt()],Og);let Hg=class{constructor(){this.order=1}beforePickItem(n,t,e,i,r){if(!n.in3dMode||i.in3dInterceptor)return null;const o=t.pickContext,s=n.stage;if(!o||!s)return null;if(i.in3dInterceptor=!0,o.save(),this.initCanvasCtx(o),o.camera=s.camera,n.isContainer){const a=HL(o,n,()=>t.pickGroup(n,e,r.parentMatrix,i),i);return o.camera=null,i.in3dInterceptor=!1,o.restore(),a}return o.restore(),null}initCanvasCtx(n){n.setTransformForCurrent()}};Hg=Wm([Tt()],Hg);const CV=new ie((n,t,e)=>{e(Yl)||(n(oA).toSelf(),n(Yl).toService(oA)),n(Hg).toSelf().inSingletonScope(),n(Fl).toService(Hg),n(Fg).toSelf().inSingletonScope(),n(Fl).toService(Fg),n(Og).toSelf().inSingletonScope(),n(Fl).toService(Og),ar(n,Fl),n(Ig).toSelf().inSingletonScope(),n(Dg).toService(Ig),ar(n,Dg)}),yV=new ie(n=>{n(ww).to(G_),n(bL).toConstantValue($t)}),yd=Symbol.for("AutoEnablePlugins"),zL=Symbol.for("PluginService");var wV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},SV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},sA=function(n,t){return function(e,i){t(e,i,n)}};let lC=class{constructor(n){this.autoEnablePlugins=n,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(n,t){this.stage=n,this.actived=!0;const{pluginList:e}=t;e&&te.isBound(yd)&&this.autoEnablePlugins.getContributions().forEach(i=>{e.includes(i.name)&&this.register(i)})}findPluginsByName(n){const t=[];return this.onStartupFinishedPlugin.forEach(e=>{e.name===n&&t.push(e)}),this.onRegisterPlugin.forEach(e=>{e.name===n&&t.push(e)}),t}register(n){n.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.push(n):n.activeEvent==="onRegister"&&(this.onRegisterPlugin.push(n),n.activate(this))}unRegister(n){n.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(n),1):n.activeEvent==="onRegister"&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(n),1),n.deactivate(this)}release(...n){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};lC=wV([Tt(),sA(0,ge(ci)),sA(0,Di(yd)),SV("design:paramtypes",[Object])],lC);const xV=new ie(n=>{n(zL).to(lC),y4(n,yd)}),TV=new ie(n=>{ar(n,Rm)}),AV=new ie(n=>{n(as).to(vu).inSingletonScope(),ar(n,as)});var RV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},EV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let zg=class{constructor(){this.type="static",this.offscreen=!1,this.global=Mt.global}setDpr(n){this.canvas.dpr=n}init(n,t,e){if(this.layer=n,this.window=t,e.main)this.main=!0,this.context=t.getContext(),this.canvas=this.context.getCanvas();else{let i;this.main=!1,e.canvasId&&(i=this.global.getElementById(e.canvasId)),i||(i=this.global.createCanvas({width:t.width,height:t.height})),i.style&&(i.style["pointer-events"]="none");const r=t.getContext().getCanvas().nativeCanvas,o=E_({nativeCanvas:i,width:t.width,height:t.height,dpr:t.dpr,id:e.canvasId,canvasControled:!0,container:t.getContainer(),x:r.offsetLeft,y:r.offsetTop});o.applyPosition(),this.canvas=o,this.context=o.getContext()}}resize(n,t){this.canvas.resize(n,t)}resizeView(n,t){}render(n,t,e){var i;if(!this.main){const r=this.window.getContext().getCanvas().nativeCanvas;!r||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition())}t.renderService.render(n,Object.assign(Object.assign({context:this.context,clear:(i=t.background)!==null&&i!==void 0?i:"#ffffff"},t),e))}merge(n){n.forEach(t=>{const e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(n,t){}drawTo(n,t,e){var i;const r=n.getContext();e.renderService.render(t,Object.assign(Object.assign({context:r},e),{clear:e.clear?(i=e.background)!==null&&i!==void 0?i:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};zg=RV([Tt(),EV("design:paramtypes",[])],zg);const MV=new ie(n=>{n(zg).toSelf(),n(SL).toService(zg)});function BV(n){n.load(TV),n.load(AV),n.load(MV)}var PV=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function NL(n,t,e){const i={},r=[];return n.forEachChildren(o=>{const{zIndex:s=t}=o.attribute;i[s]?i[s].push(o):(i[s]=[o],r.push(s))},e),r.sort((o,s)=>e?s-o:o-s),{childMap:i,zIdxArray:r}}function WL(n,t,e,i=!1,r=!1){let o=!1;if(r)o=!0;else{let s;n.forEachChildren((a,l)=>{const{zIndex:u=t}=a.attribute;if(l===0)s=u;else if(s!==u)return o=!0,!0;return!1},i)}if(o){const{childMap:s,zIdxArray:a}=NL(n,t,i);let l=!1;for(let u=0;u<a.length&&!l;u++){const h=s[a[u]];r&&h.sort((d,c)=>{var f,g;return(i?-1:1)*(((f=c.attribute.z)!==null&&f!==void 0?f:0)-((g=d.attribute.z)!==null&&g!==void 0?g:0))});for(let d=0;d<h.length;d++)if(e(h[d],d)){l=!0;break}}}else n.forEachChildren(e,i)}function aA(n,t,e,i=!1){return PV(this,void 0,void 0,function*(){yield n.forEachChildrenAsync(e,i)})}function kV(n,t,e,i=!1){let r=!1;n.forEachChildren((a,l)=>{const{zIndex:u=e}=a.attribute;if(l!==0){if(u!==void 0)return r=!0,!0}return!1},i);let o=null,s=!1;if(r){const{childMap:a,zIdxArray:l}=NL(n,e,i);let u=!1;for(let h=0;h<l.length&&!u;h++){const d=a[l[h]];for(let c=0;c<d.length;c++){if(s){u=!0,o=d[c];break}d[c]._uid!==t||(s=!0)}}}else n.forEachChildren(a=>s?(o=a,!0):(a._uid===t&&(s=!0),!1),i);return o}var LV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},DV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},gv=function(n,t){return function(e,i){t(e,i,n)}};let Ng=class{constructor(n,t){this.contributions=n,this.drawItemInterceptorContributions=t,this._renderInGroup=(e,i,r,o)=>{var s;e?i.forEachChildren(a=>{r.break||(a.isContainer?this.renderGroup(a,r,o):this.renderItem(a,r))}):WL(i,ui.zIndex,a=>{r.break||(a.isContainer?this.renderGroup(a,r,o):this.renderItem(a,r))},!1,!!(!((s=r.context)===null||s===void 0)&&s.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new pu,this.backupDirtyBounds=new pu,this.global=Mt.global,this.layerService=Mt.layerService,jt(this.contributions)||(this.contributions=[this.contributions]),this.init()}reInit(){this.init(),this.contributions.forEach(n=>{n.reInit()})}init(){this.contributions.forEach(n=>{if(n.style){const t=this.styleRenderMap.get(n.style)||new Map;t.set(n.numberType,n),this.styleRenderMap.set(n.style,t)}else this.defaultRenderMap.set(n.numberType,n)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((n,t)=>n.order-t.order)}prepareForDraw(n,t){t.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!t.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(n,t){this.prepareForDraw(n,t),t.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(t.renderStyle)||this.defaultRenderMap,this.currentRenderService=n;const{context:e,stage:i,viewBox:r,transMatrix:o}=t;if(!e)return;const s=this.dirtyBounds.setValue(0,0,r.width(),r.height());if(i.dirtyBounds&&!i.dirtyBounds.empty()){const l=Fk(s,i.dirtyBounds);s.x1=Math.floor(l.x1),s.y1=Math.floor(l.y1),s.x2=Math.ceil(l.x2),s.y2=Math.ceil(l.y2)}const a=e.dpr%1;(a||a!==.5)&&(s.x1=Math.floor(s.x1*e.dpr)/e.dpr,s.y1=Math.floor(s.y1*e.dpr)/e.dpr,s.x2=Math.ceil(s.x2*e.dpr)/e.dpr,s.y2=Math.ceil(s.y2*e.dpr)/e.dpr),this.backupDirtyBounds.copy(s),e.reset(!1),e.save(),e.setClearMatrix(o.a,o.b,o.c,o.d,o.e,o.f),e.clearMatrix(!1),e.translate(r.x1,r.y1,!0),e.beginPath(),e.rect(s.x1,s.y1,s.width(),s.height()),e.clip(),i.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(n,e,t),n.renderTreeRoots.sort((l,u)=>{var h,d;return((h=l.attribute.zIndex)!==null&&h!==void 0?h:ui.zIndex)-((d=u.attribute.zIndex)!==null&&d!==void 0?d:ui.zIndex)}).forEach(l=>{l.isContainer?this.renderGroup(l,t,qi.allocate(1,0,0,1,0,0)):this.renderItem(l,t)}),e.restore(),e.draw()}doRegister(){throw new Error("暂不支持")}_findNextGraphic(n){let t=n.parent,e=n._uid;for(;t;){const i=kV(t,e,ui.zIndex);if(i)return i;e=t._uid,t=t.parent}return null}renderGroup(n,t,e,i){if(t.break||n.attribute.visibleAll===!1)return;if(n.incremental&&(t.startAtId==null||t.startAtId===n._uid))return t.break=!0,void this._increaseRender(n,t);if(this.useDirtyBounds&&!S_(n.AABBBounds,this.dirtyBounds)&&n.attribute.boundsMode!=="empty")return;let r,o=e;if(this.useDirtyBounds){r=Tg.allocateByObj(this.dirtyBounds);const s=n.transMatrix;o=qi.allocateByObj(e).multiply(s.a,s.b,s.c,s.d,s.e,s.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(o.getInverse())}t.isGroupScroll=!(!n.attribute.scrollX&&!n.attribute.scrollY),this.renderItem(n,t,{renderInGroupParams:{skipSort:i,nextM:o},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(r),Tg.free(r),qi.free(o))}_increaseRender(n,t){const{layer:e,stage:i}=t,{subLayers:r}=e;let o=r.get(n._uid);o||(o={layer:this.layerService.createLayer(i),zIndex:r.size,group:n},r.set(n._uid,o));const s=o.layer.getNativeHandler().getContext(),a=o.drawContribution||te.get(OL);a.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:a,clear:"transparent",layer:o.layer,context:s,startAtId:n._uid,break:!1})),o.drawContribution=a;const l=this._findNextGraphic(n);if(l)if(l.isContainer&&l.incremental)this._increaseRender(l,t);else{let u=r.get(l._uid);u||(u={layer:this.layerService.createLayer(i),zIndex:r.size},r.set(l._uid,u));const h=u.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:a,clear:"transparent",layer:u.layer,context:h,startAtId:l._uid,break:!1}))}}getRenderContribution(n){let t;return t||(t=this.selectRenderByNumberType(n.numberType,n)),t||(t=this.selectRenderByType(n.type)),t}renderItem(n,t,e){if(this.InterceptorContributions.length)for(let a=0;a<this.InterceptorContributions.length;a++){const l=this.InterceptorContributions[a];if(l.beforeDrawItem&&l.beforeDrawItem(n,this.currentRenderService,t,this,e))return}const i=this.getRenderContribution(n);if(!i)return;let r,o=!1;if(t.isGroupScroll){const{scrollX:a=0,scrollY:l=0}=n.parent.attribute;o=!0,this.scrollMatrix||(this.scrollMatrix=qi.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-a,-l)}if(o&&(r=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!n.isContainer&&n.attribute.boundsMode!=="empty"&&!S_(n.AABBBounds,r??this.dirtyBounds)){if(o&&n.parent){const{scrollX:a=0,scrollY:l=0}=n.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(a,l)}return}const s=t.startAtId!=null&&n._uid!==t.startAtId;if(n._uid===t.startAtId&&(t.startAtId=null),e&&(e.skipDraw=s),s?n.isContainer&&i.draw(n,this.currentRenderService,t,e):i.draw(n,this.currentRenderService,t,e),o&&n.parent){const{scrollX:a=0,scrollY:l=0}=n.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(a,l)}if(this.InterceptorContributions.length)for(let a=0;a<this.InterceptorContributions.length;a++){const l=this.InterceptorContributions[a];if(l.afterDrawItem&&l.afterDrawItem(n,this.currentRenderService,t,this))return}}selectRenderByType(n){return Er.getInstance().warn("未知错误，不应该走到这里"),null}selectRenderByNumberType(n,t){let e;if(t.attribute.renderStyle){const i=this.styleRenderMap.get(t.attribute.renderStyle);e=i&&i.get(n)}return e||this.currentRenderMap.get(n)||this.defaultRenderMap.get(n)}clearScreen(n,t,e){var i,r;const{clear:o,viewBox:s}=e,a=s.width(),l=s.height();if(o){t.clearRect(0,0,a,l);const u=(i=n.drawParams)===null||i===void 0?void 0:i.stage;if(u&&(t.globalAlpha=(r=u.attribute.opacity)!==null&&r!==void 0?r:1),u&&u.backgroundImg&&u.resources){const h=u.resources.get(o);h&&h.state==="success"&&h.data&&t.drawImage(h.data,0,0,a,l)}else t.fillStyle=dg(t,o,{AABBBounds:{x1:0,y1:0,x2:0+a,y2:0+l}},0,0),t.fillRect(0,0,a,l)}}afterDraw(n,t){}};Ng=LV([Tt(),gv(0,xk(zr)),gv(1,ge(ci)),gv(1,Di(Cd)),DV("design:paramtypes",[Array,Object])],Ng);var IV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Wg=class extends _d{constructor(){super(...arguments),this.numberType=qd}drawShape(n,t,e,i,r,o,s,a){if(n.incremental&&r.multiGraphicOptions){const{startAtIdx:l,length:u}=r.multiGraphicOptions,{segments:h=[]}=n.attribute;if(l>h.length)return;const d=ae(n).line,{fill:c=d.fill,stroke:f=d.stroke,opacity:g=d.opacity,fillOpacity:m=d.fillOpacity,strokeOpacity:p=d.strokeOpacity,lineWidth:v=d.lineWidth,visible:b=d.visible}=n.attribute,C=Ka(g,m,c),y=H_(g,p),w=bu(c),_=pd(f,v);if(!n.valid||!b||!w&&!_||!(C||y||s||a))return;const{context:A}=r;for(let T=l;T<l+u;T++)this.drawIncreaseSegment(n,A,h[T-1],h[T],n.attribute.segments[T],[d,n.attribute],e,i)}else super.drawShape(n,t,e,i,r,o,s,a)}drawIncreaseSegment(n,t,e,i,r,o,s,a){i&&(t.beginPath(),D7(t.nativeContext,e,i,{offsetX:s,offsetY:a}),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,r,o),t.setStrokeStyle(n,r,s,a,o),t.stroke())}};Wg=IV([Tt()],Wg);var FV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let uC=class extends J_{constructor(){super(...arguments),this.numberType=vL}drawShape(n,t,e,i,r,o,s){if(n.incremental&&r.multiGraphicOptions){const{startAtIdx:a,length:l}=r.multiGraphicOptions,{segments:u=[]}=n.attribute;if(a>u.length)return;const h=ae(n).area,{fill:d=h.fill,fillOpacity:c=h.fillOpacity,opacity:f=h.opacity,visible:g=h.visible}=n.attribute,m=Ka(f,c,d),p=bu(d);if(!n.valid||!g||!p||!m&&!s)return;for(let v=a;v<a+l;v++)this.drawIncreaseSegment(n,t,u[v-1],u[v],n.attribute.segments[v],[h,n.attribute],e,i)}else super.drawShape(n,t,e,i,r,o,s)}drawIncreaseSegment(n,t,e,i,r,o,s,a){i&&(t.beginPath(),I7(t.camera?t:t.nativeContext,e,i,{offsetX:s,offsetY:a}),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,r,o),t.setCommonStyle(n,r,s,a,o),t.fill())}};uC=FV([Tt()],uC);var Ol,OV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},HV=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},ch=function(n,t){return function(e,i){t(e,i,n)}},co=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};(function(n){n[n.NORMAL=0]="NORMAL",n[n.STOP=1]="STOP"})(Ol||(Ol={}));let hC=class extends Ng{constructor(n,t,e,i){super(n,i),this.contributions=n,this.lineRender=t,this.areaRender=e,this.drawItemInterceptorContributions=i,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=Ol.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new Vr([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(n,t){return co(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=n,this.lastDrawContext=t,this.checkingForDrawPromise=this.checkForDraw(t);const e=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,e)return;this.currentRenderService=n;const{context:i,viewBox:r}=t;i&&(i.inuse=!0,i.clearMatrix(),i.setTransformForCurrent(!0),i.save(),t.restartIncremental&&this.clearScreen(this.currentRenderService,i,t),i.translate(r.x1,r.y1,!0),i.save(),n.renderTreeRoots.sort((o,s)=>{var a,l;return((a=o.attribute.zIndex)!==null&&a!==void 0?a:ui.zIndex)-((l=s.attribute.zIndex)!==null&&l!==void 0?l:ui.zIndex)}).forEach(o=>{this.renderGroup(o,t)}),this.hooks.completeDraw.tap("top-draw",()=>{i.restore(),i.restore(),i.draw(),i.inuse=!1,this.rendering=!1}))})}_increaseRender(n,t){return co(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(n,t)})}_renderIncrementalGroup(n,t){return co(this,void 0,void 0,function*(){this.count=n.count,yield new Promise(e=>{this.renderItem(n,t,{drawingCb:()=>co(this,void 0,void 0,function*(){if(n.count!==2)yield aA(n,ui.zIndex,(i,r)=>{if(this.status===Ol.STOP)return!0;if(i.isContainer||r<this.currentIdx)return!1;const o=this.currFrameStartAt+n.incremental;return r<o&&(this.currentIdx=r+1,this.renderItem(i,t)),r===o-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),e(!1);else{const i=n.getChildAt(0);if(i.incremental&&i.attribute.segments)for(i.incrementalAt||(i.incrementalAt=0);i.incrementalAt<i.attribute.segments.length;)t.multiGraphicOptions={startAtIdx:i.incrementalAt,length:i.incremental},this.renderItem(i,t),i.incrementalAt+=i.incremental,yield this.waitToNextFrame();else this.renderItem(i,t);e(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return co(this,void 0,void 0,function*(){return new Promise(n=>{this.global.getRequestAnimationFrame()(()=>{n(!1)})})})}checkForDraw(n){return co(this,void 0,void 0,function*(){let t=this.rendering;return n.restartIncremental&&(t=!1,yield this.forceStop(),this.resetToInit()),t})}forceStop(){return co(this,void 0,void 0,function*(){this.rendering&&(this.status=Ol.STOP,yield new Promise(n=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=Ol.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>t.name!=="stopCb"),n(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(n,t){return co(this,void 0,void 0,function*(){if(!t.break&&n.attribute.visibleAll!==!1)return n.incremental&&t.startAtId===n._uid?(yield this._increaseRender(n,t),void(t.break=!0)):void(yield new Promise(e=>{this.renderItem(n,t,{drawingCb:()=>co(this,void 0,void 0,function*(){yield aA(n,ui.zIndex,i=>co(this,void 0,void 0,function*(){t.break||i.isContainer&&(yield this.renderGroup(i,t))})),e(!1)})})}))})}};hC=OV([Tt(),ch(0,xk(zr)),ch(1,ge(Wg)),ch(2,ge(uC)),ch(3,ge(ci)),ch(3,Di(Cd)),HV("design:paramtypes",[Array,Object,Object,Object])],hC);const zV=new ie(n=>{n(Nm).toSelf().inSingletonScope(),n(Mw).toSelf().inSingletonScope(),n(Bw).to(Ng),n(OL).to(hC),n(iA).to(iC).inSingletonScope(),n(zr).toService(iA),ar(n,Un),n(eo).toSelf().inSingletonScope(),ar(n,Rw),ar(n,zr),n(Lg).toSelf().inSingletonScope(),n(Cd).toService(Lg),ar(n,Cd)});function NV(n){n.load(zV)}function wd(){wd.__loaded||(wd.__loaded=!0,te.load(I9),te.load(yV),te.load(_V),te.load(CV),te.load(xV),BV(te),NV(te))}wd.__loaded=!1,wd();const De=te.get(aw);Mt.global=De;const WV=te.get(wL);Mt.graphicUtil=WV;const UV=te.get(yL);Mt.transformUtil=UV;const VV=te.get(ww);Mt.graphicService=VV;const jV=te.get(Pw);Mt.renderService=jV;const GV=te.get(Aw);Mt.layerService=GV;class $V{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=bi.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&t.stage!=null&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t;const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}deactivate(t){const e=r=>r.filter(o=>o.name!==this.key),i=this.pluginService.stage;i&&(i.graphicService.hooks.onAttributeUpdate.taps=e(i.graphicService.hooks.onAttributeUpdate.taps),i.graphicService.hooks.onSetStage.taps=e(i.graphicService.hooks.onSetStage.taps),i.graphicService.hooks.onRemove.taps=e(i.graphicService.hooks.onRemove.taps))}}class qV{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=bi.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&t.stage!=null&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,this.dpr=Mt.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){const t=Mt.global.getRequestAnimationFrame();this.rafId=t(()=>{Mt.global.devicePixelRatio!==this.dpr&&(this.dpr=Mt.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{const t=`(resolution: ${window.devicePixelRatio}dppx)`,e=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))},i=matchMedia(t);i&&i.addEventListener("change",e),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push(()=>{i&&i.removeEventListener("change",e)})}catch{return!1}return!0}deactivate(t){var e;const i=Mt.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),(e=this.autoRefreshCbs)===null||e===void 0||e.forEach(r=>{r()}),this.autoRefreshCbs=void 0}}class XV{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=bi.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t;const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.tap(this.key,(i,r,o)=>{i.glyphHost&&(i=i.glyphHost),i.stage===t.stage&&i.stage!=null&&(this.nextUserParams.startAtId=r._uid,this.renderNextFrame(r))}),e.graphicService.hooks.onClearIncremental.tap(this.key,(i,r)=>{i.stage===t.stage&&i.stage!=null&&(this.nextUserParams.startAtId=i._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(i))}))}deactivate(t){const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.taps=e.graphicService.hooks.onAddIncremental.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.onClearIncremental.taps=e.graphicService.hooks.onClearIncremental.taps.filter(i=>i.name!==this.key))}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,Mt.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){const t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{const i=e.layer;if(!i||!e.layer.subLayers)return;const r=e.layer.subLayers.get(e._uid);r&&r.drawContribution&&r.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:i,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:r.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}const lA=new Ye;class YV{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=bi.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,i=>{i&&i===this.pluginService.stage&&i.dirtyBounds.clear()});const e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(i,r,o,s)=>{i.glyphHost&&(i=i.glyphHost),r&&r===this.pluginService.stage&&r.renderCount&&(i.isContainer&&!i.shouldSelfChangeUpdateAABBBounds()||o&&(lA.setValue(s.x1,s.y1,s.x2,s.y2),r.dirty(lA,i.parent&&i.parent.globalTransMatrix)))}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(i,r,o,s,a)=>{r&&r===this.pluginService.stage&&r.renderCount&&(i.isContainer&&!a||r.dirty(s.globalAABBBounds))}),e.graphicService.hooks.clearAABBBounds.tap(this.key,(i,r,o)=>{r&&r===this.pluginService.stage&&r.renderCount&&r&&r.dirty(o)}),e.graphicService.hooks.onRemove.tap(this.key,i=>{const r=i.stage;r&&r===this.pluginService.stage&&r.renderCount&&r&&r.dirty(i.globalAABBBounds)}))}deactivate(t){const e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.clearAABBBounds.taps=e.graphicService.hooks.clearAABBBounds.taps.filter(i=>i.name!==this.key),e.hooks.afterRender.taps=e.hooks.afterRender.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.onRemove.taps=e.graphicService.hooks.onRemove.taps.filter(i=>i.name!==this.key))}}let Ea;function UL(){if(Ea==null)try{const n=document.createElement("canvas"),t=n.getContext("2d");Ea=!!(window&&n.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&t&&t.isPointInPath&&t.isPointInStroke),Ea&&(Ea=!!document.createElement)}catch{Ea=!1}}function kw(){UL();const n=Mt.global&&Mt.global.env;return n?n==="browser":Ea}function KV(){UL();const n=Mt.global&&Mt.global.env;return n?n==="node":!Ea}let Ms=class dC{static registerPlugin(t,e){dC._pluginClasses[t]=e}static getPlugin(t){return dC._pluginClasses[t]}};Ms._pluginClasses={};const uA={BACKGROUND:"white"};class ZV extends ko{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){const e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){const e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return(t=this._background)!==null&&t!==void 0?t:uA.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}get ticker(){return this._ticker}set ticker(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}constructor(t={}){var e,i;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=r=>{if(!(this._skipRender<0))if(r){if(this.dirtyBounds){const o=this.window.getViewBox();this.dirtyBounds.setValue(o.x1,o.y1,o.width(),o.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=r=>{this._beforeRender&&this._beforeRender(r)},this.afterRender=r=>{this.renderCount++,this._afterRender&&this._afterRender(r),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(o=>o(r)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{this.tickedBeforeRender=!0,this.state!=="rendering"&&this.renderNextFrame()},this.params=t,this.theme=new gd,this.hooks={beforeRender:new Vr(["stage"]),afterRender:new Vr(["stage"])},this.global=Mt.global,!this.global.env&&kw()&&this.global.setEnv("browser"),this.window=te.get(fd),this.renderService=te.get(Pw),this.pluginService=te.get(zL),this.layerService=te.get(Aw),this.graphicService=te.get(ww),this.pluginService.active(this,t),this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:t.canvasControled!==!1,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=(e=t.background)!==null&&e!==void 0?e:uA.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),t.autoRefresh&&this.enableAutoRefresh(),t.disableDirtyBounds===!1&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),this._beforeRender=t.beforeRender,this._afterRender=t.afterRender,this.supportInteractiveLayer=t.interactiveLayer!==!1,t.optimize||(t.optimize={tickRenderMode:"effect"}),this.optmize(t.optimize),t.background&&lr(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.initAnimate(t),this.rafId=(i=t.rafId)!==null&&i!==void 0?i:Math.floor(6*Math.random())}initAnimate(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),((e=this.params.optimize)===null||e===void 0?void 0:e.tickRenderMode)==="performance"&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}startAnimate(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}pauseRender(t=-1){this._skipRender=t}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new Y8(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-1/0:this.params.optimize.skipRenderWithOutRange!==!1?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){const{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:o=0,camera:s,fieldRatio:a=1,fieldDepth:l}=t;return Object.assign(Object.assign({},t),{center:e,light:i,alpha:r,beta:o,camera:s,fieldRatio:a,fieldDepth:l})}set3dOptions(t){var e,i,r,o,s,a;this.option3d=t;const l=this.get3dOptions(t),{light:u,center:h,camera:d,alpha:c,beta:f,fieldRatio:g,fieldDepth:m}=l,{dir:p=[1,1,-1],color:v="white",ambient:b}=u,C=((e=h.x)!==null&&e!==void 0?e:this.width/2)+((i=h.dx)!==null&&i!==void 0?i:0),y=((r=h.y)!==null&&r!==void 0?r:this.height/2)+((o=h.dy)!==null&&o!==void 0?o:0),w=[C,y,((s=h.z)!==null&&s!==void 0?s:0)+((a=h.dz)!==null&&a!==void 0?a:0)];let _=0,A=0,T=0;d||(_=Math.sin(c)+C,A=Math.sin(f)+y,T=Math.cos(c)*Math.cos(f)*1);const S=Ms.getPlugin("DirectionalLight");S&&(this.light=new S(p,v,b));const x={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:g,fieldDepth:m,viewParams:{pos:[_,A,T],center:w,up:[0,1,0]}};if(this.camera)this.camera.params=x;else{const E=Ms.getPlugin("OrthoCamera");E&&(this.camera=new E(x))}t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRender=t}setAfterRender(t){this._afterRender=t}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;const t=Ms.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new $V))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new qV))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new XV))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new pu;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new YV,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;const t=Ms.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){if(this.htmlAttribute)return;const e=Ms.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){if(this.reactAttribute)return;const e=Ms.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){const t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw new Error("暂不支持")}createLayer(t,e){if(this.releaseStatus==="released")return;const i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}sortLayer(t){const e=this.children;e.sort(t),this.removeAllChild(),e.forEach(i=>{this.appendChild(i)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){this.releaseStatus!=="released"&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if(this.releaseStatus==="released")return;this.startAnimate();const i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}combineLayersToWindow(){if(this.global.env==="harmony"){const t=this.window.getContext().nativeContext;this.forEachChildren((e,i)=>{if(i>0){const r=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(r)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(i=>{this.nextFrameRenderLayerSet.add(i)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if(this.releaseStatus==="released")return;this.startAnimate();const t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){const i=[];for(let r=0;r<t.length;r++){let o=t[r];o.layerMode==="virtual"&&(o=o.getNativeHandler().mainHandler.layer),i.includes(o)||i.push(o)}i.forEach(r=>{r.renderCount>this.renderCount||(r.renderCount=this.renderCount+1,r===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),r.render({renderService:this.renderService,background:r===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}resizeWindow(t,e,i=!0){this.window.resize(t,e),i&&this.render()}resize(t,e,i=!0){this.releaseStatus!=="released"&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(r=>{r.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}resizeView(t,e,i=!0){this.releaseStatus!=="released"&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(r=>{r.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}setViewBox(t,e,i,r,o){let s=!0;typeof t=="object"?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),e===!1&&(s=!1)):(this.viewBox.setValue(t,e,t+i,e+r),o===!1&&(s=!1)),this.forEachChildren(a=>{a.resizeView(this.viewBox.width(),this.viewBox.height())}),s&&this.render()}setDpr(t,e=!0){this.forEachChildren(i=>{i.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw new Error("暂不支持")}export(t){throw new Error("暂不支持")}pick(t,e){if(this.releaseStatus==="released")return;const i=this.getPickerService().pick(this.children,new ze(t,e),{bounds:this.AABBBounds});return!(!(i!=null&&i.graphic)&&!(i!=null&&i.group))&&i}setToFrame(t){throw new Error("暂不支持")}release(){var t,e;super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(i=>{i.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(i=>{i.setStage&&i.setStage(null,null),this.interactiveLayer.removeChild(i)}),this.interactiveLayer.release()),this.window.release(),(t=this._ticker)===null||t===void 0||t.remTimeline(this==null?void 0:this.timeline),(e=this._ticker)===null||e===void 0||e.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){this.releaseStatus!=="released"&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){this.releaseStatus!=="released"&&this.forEachChildren((e,i)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:i===0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if(this.releaseStatus==="released")return;const i=te.get(fd),r=e?-e.x1:0,o=e?-e.y1:0,s=e?e.x2:this.viewWidth,a=e?e.y2:this.viewHeight,l=e?e.width():this.viewWidth,u=e?e.height():this.viewHeight;return i.create({viewBox:{x1:r,y1:o,x2:s,y2:a},width:l,height:u,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(i),i}toCanvas(t=!0,e){if(this.releaseStatus==="released")return;const i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){const e=this.global.mapToCanvasPoint(t,this.window.getContext().canvas.nativeCanvas);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=te.get(Yl)),this.pickerService}reInit(){this.renderService.reInit(),this.pickerService.reInit()}}function QV(n){return new ZV(n)}var JV=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},tj=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};let Ug=class{configure(n,...t){n.env===this.type&&n.setActiveEnvContribution(this)}getNativeAABBBounds(n){return new Ye}removeDom(n){return!1}createDom(n){return null}updateDom(n,t){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(n){return document.getElementById(n)}getRootElement(){return document.body}loadJson(n){const t=fetch(n).then(e=>e.json());return t.then(e=>({data:e,state:"success"})).catch(()=>({data:null,state:"fail"})),t}loadArrayBuffer(n){return fetch(n).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(n){return fetch(n).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(n,t){return 0}getElementLeft(n,t){return 0}getElementTopLeft(n,t){return{top:0,left:0}}loadFont(n,t,e){return tj(this,void 0,void 0,function*(){return{loadState:"fail"}})}isMacOS(){return!1}copyToClipBoard(n){return Promise.resolve(null)}};Ug=JV([Tt()],Ug);var ej=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},ij=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let Vg=class{constructor(){this._uid=bi.GenAutoIncrementId(),this.viewBox=new Ye,this.modelMatrix=new Xe(1,0,0,1,0,0)}onChange(n){this._onChangeCb=n}configure(n,t){t.env===this.type&&n.setWindowHandler(this)}release(...n){this.releaseWindow()}isVisible(n){return!0}onVisibleChange(n){}getTopLeft(n){return{top:0,left:0}}setViewBox(n){this.viewBox.setValue(n.x1,n.y1,n.x2,n.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(n,t,e,i,r,o){this.modelMatrix.setValue(n,t,e,i,r,o)}getViewBoxTransform(){return this.modelMatrix}};Vg=ej([Tt(),ij("design:paramtypes",[])],Vg);var rj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},nj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},tf=function(n,t){return function(e,i){t(e,i,n)}};let cC=class{constructor(n,t){this.pickItemInterceptorContributions=n,this.pickServiceInterceptorContributions=t,this.type="default",this.global=Mt.global}reInit(){this._init()}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((n,t)=>n.order-t.order),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((n,t)=>n.order-t.order)}pick(n,t,e){let i={graphic:null,group:null};e.pickerService=this;const r=e.bounds.width(),o=e.bounds.height();if(!new Ye().setValue(0,0,r,o).containsPoint(t))return i;this.pickContext&&(this.pickContext.inuse=!0),e.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);const s=new Xe(1,0,0,1,0,0);let a;for(let l=n.length-1;l>=0&&(i=n[l].isContainer?this.pickGroup(n[l],t,s,e):this.pickItem(n[l],t,s,e),!i.graphic);l--)a||(a=i.group);if(i.graphic||(i.group=a),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(let l=0;l<this.pickerServiceInterceptorContributions.length;l++){const u=this.pickerServiceInterceptorContributions[l];u.afterPickItem&&(i=u.afterPickItem(i,this,t,e,{parentMatrix:s}))}return i}containsPoint(n,t,e){var i;return!!(!((i=this.pickItem(n,t,null,e??{pickContext:this.pickContext,pickerService:this}))===null||i===void 0)&&i.graphic)}pickGroup(n,t,e,i){let r={group:null,graphic:null};if(n.attribute.visibleAll===!1)return r;const o=i.pickContext,s=o.modelMatrix;if(o.camera){const f=n.transMatrix,g=Pi.allocate();if(I_(g,f),s){if(g){const m=Pi.allocate();o.modelMatrix=Xd(m,s,g),Pi.free(g)}}else I_(g,n.globalTransMatrix),o.modelMatrix=g}if(this.InterceptorContributions.length)for(let f=0;f<this.InterceptorContributions.length;f++){const g=this.InterceptorContributions[f];if(g.beforePickItem){const m=g.beforePickItem(n,this,t,i,{parentMatrix:e});if(m)return o.modelMatrix!==s&&Pi.free(o.modelMatrix),o.modelMatrix=s,m}}const a=n.transMatrix,l=qi.allocateByObj(e),u=new ze(t.x,t.y);l.transformPoint(u,u);const h=n.AABBBounds.containsPoint(u);if(!h&&!n.stage.camera)return r;const d=this.pickItem(n,u.clone(),e,i);d&&d.graphic&&(r.graphic=d.graphic,r.params=d.params);const c=n.attribute.pickable!==!1&&h;return l.multiply(a.a,a.b,a.c,a.d,a.e,a.f),n.attribute.childrenPickable===!1||d&&d.graphic||WL(n,ui.zIndex,f=>{if(f.isContainer){const g=new ze(t.x,t.y),m=ae(n).group,{scrollX:p=m.scrollX,scrollY:v=m.scrollY}=n.attribute;g.x-=p,g.y-=v,r=this.pickGroup(f,g,l,i)}else{const g=new ze(t.x,t.y);l.transformPoint(g,g);const m=ae(n).group,{scrollX:p=m.scrollX,scrollY:v=m.scrollY}=n.attribute;g.x-=p,g.y-=v;const b=this.pickItem(f,g,e,i);b&&b.graphic&&(r.graphic=b.graphic,r.params=b.params)}return!!r.graphic||!!r.group},!0,!!o.camera),o.modelMatrix!==s&&Pi.free(o.modelMatrix),o.modelMatrix=s,r.graphic||r.group||!c||n.stage.camera||(r.group=n),qi.free(l),r}selectPicker(n){return this.pickerMap.get(n.numberType)||null}};cC=rj([Tt(),tf(0,ge(ci)),tf(0,Di(Fl)),tf(1,ge(ci)),tf(1,Di(Dg)),nj("design:paramtypes",[Object,Object])],cC);function oj(n,t,e){const i={};for(const r in t)r in n&&C_(n[r],t[r])||(i[r]=t[r]);return i}let hA=!1;const sj=new ie(n=>{hA||(hA=!0,n(_g).toSelf().inSingletonScope(),n(Ag).to(_g).inSingletonScope(),n(zr).toService(Ag),n(N_).toService(eo),ar(n,N_))});let dA=!1;const aj=new ie(n=>{dA||(dA=!0,n(Sg).toSelf().inSingletonScope(),n(Pg).to(Sg).inSingletonScope(),n(zr).toService(Pg),n(xu).toSelf(),n(Su).toSelf(),n(Da).toService(xu),n(Da).toService(Su),n(Da).toService(eo),ar(n,Da))});let cA=!1;const lj=new ie(n=>{cA||(cA=!0,n(_d).toSelf().inSingletonScope(),n(Wg).toSelf().inSingletonScope(),n(Eg).to(_d).inSingletonScope(),n(zr).toService(Eg))});let fA=!1;const uj=new ie(n=>{fA||(fA=!0,n(xg).toSelf().inSingletonScope(),n(kg).to(xg).inSingletonScope(),n(zr).toService(kg),n(j_).toService(eo),ar(n,j_))});let gA=!1;const hj=new ie(n=>{gA||(gA=!0,n(Cg).toSelf().inSingletonScope(),n(Rg).to(Cg).inSingletonScope(),n(zr).toService(Rg),n(W_).toService(eo),ar(n,W_))});let pA=!1;const dj=new ie(n=>{pA||(pA=!0,n(nC).to(tC).inSingletonScope(),n(zr).toService(nC),n(vg).toService(eo),ar(n,vg))});let mA=!1;const cj=new ie(n=>{mA||(mA=!0,n(wg).toSelf().inSingletonScope(),n(Mg).to(wg).inSingletonScope(),n(zr).toService(Mg),n(U_).toService(eo),ar(n,U_))});let vA=!1;const fj=new ie(n=>{vA||(vA=!0,n(Bg).to(eC).inSingletonScope(),n(zr).toService(Bg),n(V_).toService(eo),ar(n,V_))});var gj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},pj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let fC=class extends Xr{constructor(){super(),this.numberType=yw,this.builtinContributions=[IL],this.init()}drawShape(n,t,e,i,r){const o=ae(n).richtext,{strokeOpacity:s=o.strokeOpacity,opacity:a=o.opacity,fillOpacity:l=o.fillOpacity,visible:u=o.visible}=n.attribute;if(!n.valid||!u)return;const h=Ka(a,l,!0),d=Ka(a,s,!0);h&&(t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,o),t.translate(e,i),this.beforeRenderStep(n,t,e,i,h,d,h,d,o,r),n.getFrameCache().draw(t,this.drawIcon),this.afterRenderStep(n,t,e,i,h,d,h,d,o,r))}drawIcon(n,t,e,i,r){var o;const s=ae(n).richtextIcon,{width:a=s.width,height:l=s.height,opacity:u=s.opacity,image:h,backgroundFill:d=s.backgroundFill,backgroundFillOpacity:c=s.backgroundFillOpacity,backgroundStroke:f=s.backgroundStroke,backgroundStrokeOpacity:g=s.backgroundStrokeOpacity,backgroundRadius:m=s.backgroundRadius,margin:p}=n.attribute,{backgroundWidth:v=a,backgroundHeight:b=l}=n.attribute;if(p&&(e+=n._marginArray[3],i+=n._marginArray[0]),n._hovered){const y=(v-a)/2,w=(b-l)/2;m===0?(t.beginPath(),t.rect(e-y,i-w,v,b)):(t.beginPath(),Lo(t,e-y,i-w,v,b,m,!0)),d&&(t.globalAlpha=c,t.fillStyle=d,t.fill()),f&&(t.globalAlpha=g,t.strokeStyle=f,t.stroke())}const C=h&&((o=n==null?void 0:n.resources)===null||o===void 0?void 0:o.get(h));C&&C.state==="success"&&(t.globalAlpha=u,t.drawImage(C.data,e,i,a,l))}draw(n,t,e){const i=ae(n).richtext;this._draw(n,i,!1,e)}};fC=gj([Tt(),pj("design:paramtypes",[])],fC);let bA=!1;const mj=new ie(n=>{bA||(bA=!0,n(oC).to(fC).inSingletonScope(),n(zr).toService(oC))});let _A=!1;const vj=new ie(n=>{_A||(_A=!0,n(sC).to(rC).inSingletonScope(),n(zr).toService(sC),n(La).toService(eo),ar(n,La))});function bj(){$t.RegisterGraphicCreator("arc",bg)}function _j(){$t.RegisterGraphicCreator("circle",EL)}function Cj(){$t.RegisterGraphicCreator("group",mg)}function yj(){$t.RegisterGraphicCreator("image",Hm)}function wj(){$t.RegisterGraphicCreator("line",ln)}function Sj(){$t.RegisterGraphicCreator("path",K9)}function xj(){$t.RegisterGraphicCreator("polygon",PL)}function Tj(){$t.RegisterGraphicCreator("rect",Ge)}function Aj(){$t.RegisterGraphicCreator("richtext",Y9)}function Rj(){$t.RegisterGraphicCreator("symbol",yu)}function Ej(){$t.RegisterGraphicCreator("text",q_)}function Mj(){$t.RegisterGraphicCreator("shadowRoot",Q9)}function Bj(){$t.RegisterGraphicCreator("wrapText",U9)}const CA=new Ye;class Pj{constructor(){this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=bi.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new Ye}pauseLayout(t){this.pause=t}tryLayoutChildren(t){t.firstChild&&this.tryLayout(t.firstChild)}tryLayout(t,e=!0){if(this.pause)return;const i=t.parent;if(!(e||i&&t.needUpdateLayout()))return;const r=ae(i).group,{display:o=r.display}=i.attribute;if(o!=="flex")return;const{flexDirection:s=r.flexDirection,flexWrap:a=r.flexWrap,alignItems:l=r.alignItems,clip:u=r.clip}=i.attribute,{alignContent:h=l??r.alignContent}=i.attribute;let{width:d,height:c,justifyContent:f=r.justifyContent}=i.attribute;const g=i.getChildren();if(d==null||c==null){let T=0,S=0,x=0;if(g.forEach(E=>{const M=this.getAABBBounds(E);M.empty()||(s==="column"||s==="column-reverse"?(S+=M.height(),T=Math.max(T,M.width())):(T+=M.width(),S=Math.max(S,M.height())),x+=M.x1,x+=M.y1,x+=M.x2,x+=M.y2)}),!isFinite(x))return;d=T,c=S}i.attribute.width==null?i.attribute.width=d:d=i.attribute.width,i.attribute.height==null?i.attribute.height=c:c=i.attribute.height,this.tempBounds.copy(i._AABBBounds);const m={main:{len:d,field:"x"},cross:{len:c,field:"y"}},p=m.main,v=m.cross;s!=="column"&&s!=="column-reverse"||(p.len=c,v.len=d,p.field="y",v.field="x"),s!=="row-reverse"&&s!=="column-reverse"||(f==="flex-start"?f="flex-end":f==="flex-end"?f="flex-start":g.reverse());let b=0,C=0;const y=[];g.forEach(T=>{const S=this.getAABBBounds(T);if(S.empty())return;const x=p.field==="x"?S.width():S.height(),E=v.field==="x"?S.width():S.height();y.push({mainLen:x,crossLen:E}),b+=x,C=Math.max(C,E)});const w=[];if(b>p.len&&a==="wrap"){let T=0,S=0;y.forEach(({mainLen:x,crossLen:E},M)=>{T+x>p.len?T===0?(w.push({idx:M,mainLen:T+x,crossLen:E}),T=0,S=0):(w.push({idx:M-1,mainLen:T,crossLen:S}),T=x,S=E):(T+=x,S=Math.max(S,E))}),w.push({idx:y.length-1,mainLen:T,crossLen:S})}else w.push({idx:y.length-1,mainLen:b,crossLen:C});let _=0;if(w.forEach(T=>{this.layoutMain(i,g,f,p,y,_,T),_=T.idx+1}),C=w.reduce((T,S)=>T+S.crossLen,0),w.length===1){const T={"flex-start":0,"flex-end":v.len,center:v.len/2};this.layoutCross(g,l,v,T,y,w[0],0)}else if(h==="flex-start"){_=0;let T=0;w.forEach((S,x)=>{const E={"flex-start":T,"flex-end":T+S.crossLen,center:T+S.crossLen/2};this.layoutCross(g,"flex-start",v,E,y,w[x],_),_=S.idx+1,T+=S.crossLen})}else if(h==="center"){_=0;let T=Math.max(0,(v.len-C)/2);w.forEach((S,x)=>{const E={"flex-start":T,"flex-end":T+S.crossLen,center:T+S.crossLen/2};this.layoutCross(g,"center",v,E,y,w[x],_),_=S.idx+1,T+=S.crossLen})}else if(h==="space-around"){_=0;const T=Math.max(0,(v.len-C)/w.length/2);let S=T;w.forEach((x,E)=>{const M={"flex-start":S,"flex-end":S+x.crossLen,center:S+x.crossLen/2};this.layoutCross(g,"flex-start",v,M,y,w[E],_),_=x.idx+1,S+=x.crossLen+2*T})}else if(h==="space-between"){_=0;const T=Math.max(0,(v.len-C)/(2*w.length-2));let S=0;w.forEach((x,E)=>{const M={"flex-start":S,"flex-end":S+x.crossLen,center:S+x.crossLen/2};this.layoutCross(g,"flex-start",v,M,y,w[E],_),_=x.idx+1,S+=x.crossLen+2*T})}g.forEach((T,S)=>{T.addUpdateBoundTag(),T.addUpdatePositionTag(),T.clearUpdateLayoutTag()}),i.addUpdateLayoutTag();const A=this.getAABBBounds(i);u||this.tempBounds.equals(A)||this.tryLayout(i,!1)}getAABBBounds(t){this.skipBoundsTrigger=!0;const e=t.AABBBounds;return this.skipBoundsTrigger=!1,e}updateChildPos(t,e,i){return t+(e??0)-i}layoutMain(t,e,i,r,o,s,a){if(i==="flex-start"){let l=0;for(let u=s;u<=a.idx;u++){const h=l+fo(e[u],r.field),d=this.getAABBBounds(e[u]);!d.empty()&&(e[u].attribute[r.field]=this.updateChildPos(h,e[u].attribute[r.field],d[`${r.field}1`])),l+=o[u].mainLen}}else if(i==="flex-end"){let l=r.len;for(let u=a.idx;u>=s;u--){l-=o[u].mainLen;const h=l+fo(e[u],r.field),d=this.getAABBBounds(e[u]);!d.empty()&&(e[u].attribute[r.field]=this.updateChildPos(h,e[u].attribute[r.field],d[`${r.field}1`]))}}else if(i==="space-around")if(a.mainLen>=r.len){let l=0;for(let u=s;u<=a.idx;u++){const h=l+fo(e[u],r.field),d=this.getAABBBounds(e[u]);!d.empty()&&(e[u].attribute[r.field]=this.updateChildPos(h,e[u].attribute[r.field],d[`${r.field}1`])),l+=o[u].mainLen}}else{const l=a.idx-s+1,u=(r.len-a.mainLen)/l/2;let h=u;for(let d=s;d<=a.idx;d++){const c=h+fo(e[d],r.field),f=this.getAABBBounds(e[d]);!f.empty()&&(e[d].attribute[r.field]=this.updateChildPos(c,e[d].attribute[r.field],f[`${r.field}1`])),h+=o[d].mainLen+2*u}}else if(i==="space-between")if(a.mainLen>=r.len){let l=0;for(let u=s;u<=a.idx;u++){const h=l+fo(e[u],r.field),d=this.getAABBBounds(e[u]);!d.empty()&&(e[u].attribute[r.field]=this.updateChildPos(h,e[u].attribute[r.field],d[`${r.field}1`])),l+=o[u].mainLen}}else{const l=a.idx-s+1,u=(r.len-a.mainLen)/(2*l-2);let h=0;for(let d=s;d<=a.idx;d++){const c=h+fo(e[d],r.field),f=this.getAABBBounds(e[d]);!f.empty()&&(e[d].attribute[r.field]=this.updateChildPos(c,e[d].attribute[r.field],f[`${r.field}1`])),h+=o[d].mainLen+2*u}}else if(i==="center"){let l=(r.len-a.mainLen)/2;for(let u=s;u<=a.idx;u++){const h=l+fo(e[u],r.field),d=this.getAABBBounds(e[u]);!d.empty()&&(e[u].attribute[r.field]=this.updateChildPos(h,e[u].attribute[r.field],d[`${r.field}1`])),l+=o[u].mainLen}}}layoutCross(t,e,i,r,o,s,a){var l;for(let u=a;u<=s.idx;u++){const h=t[u];let{alignSelf:d}=h.attribute;d&&d!=="auto"||(d=e);const c=this.getAABBBounds(h),f=(l=r[d])!==null&&l!==void 0?l:r["flex-start"];d==="flex-end"?!c.empty()&&(h.attribute[i.field]=this.updateChildPos(f-o[u].crossLen+fo(h,i.field),h.attribute[i.field],c[`${i.field}1`])):d==="center"?!c.empty()&&(h.attribute[i.field]=this.updateChildPos(f-o[u].crossLen/2+fo(h,i.field),h.attribute[i.field],c[`${i.field}1`])):!c.empty()&&(h.attribute[i.field]=this.updateChildPos(f+fo(h,i.field),h.attribute[i.field],c[`${i.field}1`]))}}activate(t){this.pluginService=t;const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,i=>{i.glyphHost&&(i=i.glyphHost),i.stage&&i.stage===this.pluginService.stage&&this.tryLayout(i,!1)}),e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(i,r,o,s)=>{i.glyphHost&&(i=i.glyphHost),r&&r===this.pluginService.stage&&i.isContainer&&!this.skipBoundsTrigger&&CA.copy(s)}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(i,r,o,s,a)=>{r&&r===this.pluginService.stage&&i.isContainer&&!this.skipBoundsTrigger&&(CA.equals(o)||this.tryLayout(i,!1))}),e.graphicService.hooks.onSetStage.tap(this.key,i=>{i.glyphHost&&(i=i.glyphHost),this.tryLayout(i,!1)}))}deactivate(t){const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.taps=e.graphicService.hooks.onAttributeUpdate.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.onSetStage.taps=e.graphicService.hooks.onSetStage.taps.filter(i=>i.name!==this.key))}}function fo(n,t){return 0}const yA=()=>{Ms.registerPlugin("FlexLayoutPlugin",Pj)},kj=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class gn extends ko{constructor(t,e){super(t),this._skipRenderAttributes=kj,e!=null&&e.mode&&(this.mode=e.mode,this.setMode(e.mode)),e!=null&&e.skipDefault&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,i,r){const o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);if(o)return this._setAttributes(o,i);jl(this.attribute[t])&&jl(e)&&!Ce(this.attribute[t])&&!Ce(e)?Jt(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}_setAttributes(t,e){const i=Object.keys(t);this._mergeAttributes(t,i),i.every(r=>this._skipRenderAttributes.includes(r))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(i)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){zt(e)&&(e=Object.keys(t));for(let i=0;i<e.length;i++){const r=e[i];!jl(this.attribute[r])||Ce(this.attribute[r])||Ce(t[r])?this.attribute[r]=t[r]:Jt(this.attribute[r],t[r])}}bindEvents(){}_getNodeId(t){var e;return`${(e=this.id)!==null&&e!==void 0?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var i;const r=new vw(t,e);r.manager=(i=this.stage)===null||i===void 0?void 0:i.eventSystem.manager,this.dispatchEvent(r)}eventPosToStagePos(t){var e,i;const r={x:0,y:0},o=(i=(e=this.stage)===null||e===void 0?void 0:e.eventPointTransform(t))!==null&&i!==void 0?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(o,r),r}}const Ks=Symbol.for("MathPickerContribution"),wA=Symbol.for("MathArcPicker"),SA=Symbol.for("MathCirclePicker"),jg=Symbol.for("MathImagePicker"),xA=Symbol.for("MathLinePicker"),TA=Symbol.for("MathPathPicker"),AA=Symbol.for("MathRectPicker"),RA=Symbol.for("MathSymbolPicker"),EA=Symbol.for("MathTextPicker"),MA=Symbol.for("MathPolygonPicker"),BA=Symbol.for("CanvasArcPicker"),PA=Symbol.for("CanvasCirclePicker"),kA=Symbol.for("CanvasImagePicker"),LA=Symbol.for("CanvasLinePicker"),DA=Symbol.for("CanvasPathPicker"),IA=Symbol.for("CanvasRectPicker"),FA=Symbol.for("CanvasSymbolPicker"),OA=Symbol.for("CanvasTextPicker"),HA=Symbol.for("CanvasPolygonPicker"),zA=Symbol.for("CanvasRichTextPicker"),NA=Symbol.for("CanvasGroupPicker"),qr=Symbol.for("CanvasPickerContribution"),Lj={onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerUpOutside:"pointerupoutside",onPointerTap:"pointertap",onPointerOver:"pointerover",onPointerMove:"pointermove",onPointerEnter:"pointerenter",onPointerLeave:"pointerleave",onPointerOut:"pointerout",onMouseDown:"mousedown",onMouseUp:"mouseup",onMouseUpOutside:"mouseupoutside",onMouseMove:"mousemove",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onPinch:"pinch",onPinchStart:"pinchstart",onPinchEnd:"pinchend",onPan:"pan",onPanStart:"panstart",onPanEnd:"panend",onDrag:"drag",onDragStart:"dragstart",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragEnd:"dragend",onRightDown:"rightdown",onRightUp:"rightup",onRightUpOutside:"rightupoutside",onTouchStart:"touchstart",onTouchEnd:"touchend",onTouchEndOutside:"touchendoutside",onTouchMove:"touchmove",onTouchCancel:"touchcancel",onPress:"press",onPressUp:"pressup",onPressEnd:"pressend",onSwipe:"swipe",onDrop:"drop",onWeel:"wheel",onClick:"click",onDblClick:"dblclick"},WA=(n,t)=>{const e=t.x-n.x,i=t.y-n.y;return Math.abs(e)>Math.abs(i)?e>0?"right":"left":i>0?"down":"up"},ef=(n,t)=>{const e=Math.abs(t.x-n.x),i=Math.abs(t.y-n.y);return Math.sqrt(e*e+i*i)},Dj=n=>{const t=n.length;if(t===1)return{x:Math.round(n[0].x),y:Math.round(n[0].y)};let e=0,i=0,r=0;for(;r<t;)e+=n[r].x,i+=n[r].y,r++;return{x:Math.round(e/t),y:Math.round(i/t)}};class Ij extends ol{constructor(t,e={}){var i,r,o,s,a,l,u,h,d,c;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=f=>{this.startTime=ka.now();const{cachedEvents:g,startPoints:m}=this;f&&g.push(f.clone()),m.length=g.length;for(let p=0;p<g.length;p++){const{x:v,y:b}=g[p],C={x:v,y:b};m[p]=C}if(m.length!==1)this.startDistance=ef(m[0],m[1]),this.center=Dj([m[0],m[1]]);else{const p=g[0];this.pressTimeout=setTimeout(()=>{p.direction="none",p.deltaX=0,p.deltaY=0,p.points=m,this.triggerStartEvent("press",p),this.triggerEvent("press",p),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=f=>{this.clearPressTimeout();const{startPoints:g,cachedEvents:m}=this;if(!g.length)return;const p=f.clone(),{x:v,y:b,pointerId:C}=p;for(let S=0,x=m.length;S<x;S++)if(C===m[S].pointerId){m[S]=p;break}const y={x:v,y:b},w=m.map(S=>({x:S.x,y:S.y})),_=ka.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=_,this.lastMovePoint=y,g.length===1){const S=g[0],x=v-S.x,E=b-S.y,M=this.direction||WA(S,y);this.direction=M;const L=this.getEventType(y);return p.direction=M,p.deltaX=x,p.deltaY=E,p.points=w,this.triggerStartEvent(L,p),void this.triggerEvent(L,p)}const{startDistance:A}=this,T=ef(w[0],w[1]);p.scale=T/A,p.center=this.center,p.points=w,this.triggerStartEvent("pinch",p),this.triggerEvent("pinch",p)},this.onEnd=f=>{const g=f.clone(),{cachedEvents:m,startPoints:p}=this,v=m.map(b=>({x:b.x,y:b.y}));if(g.points=v,this.triggerEndEvent(g),m.length===1){const b=ka.now(),C=this.lastMoveTime;if(b-C<100){const y=C-(this.prevMoveTime||this.startTime);if(y>0){const w=this.prevMovePoint||p[0],_=this.lastMovePoint||p[0],A=ef(w,_),T=A/y;if(T>this.config.swipe.velocity&&A>this.config.swipe.threshold)return g.velocity=T,g.direction=WA(w,_),this.triggerEvent("swipe",g),this.cachedEvents=[],this.startPoints=[],void this.reset()}}b-this.startTime<this.config.press.time&&(b-this.lastTapTime<this.config.tap.interval&&f.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=b,this.lastTapTarget=f.target,this.tapCount===1?this.triggerEvent("tap",g):this.tapCount===2&&(this.triggerEvent("doubletap",g),this.tapCount=0))}for(let b=0,C=m.length;b<C;b++)if(m[b].pointerId===g.pointerId){m.splice(b,1),p.splice(b,1);break}this.reset(),m.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:(r=(i=e==null?void 0:e.press)===null||i===void 0?void 0:i.time)!==null&&r!==void 0?r:251,threshold:(s=(o=e==null?void 0:e.press)===null||o===void 0?void 0:o.threshold)!==null&&s!==void 0?s:9},swipe:{threshold:(l=(a=e==null?void 0:e.swipe)===null||a===void 0?void 0:a.threshold)!==null&&l!==void 0?l:10,velocity:(h=(u=e==null?void 0:e.swipe)===null||u===void 0?void 0:u.velocity)!==null&&h!==void 0?h:.3},tap:{interval:(c=(d=e==null?void 0:e.tap)===null||d===void 0?void 0:d.interval)!==null&&c!==void 0?c:300}},this.initEvents()}initEvents(){const{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){const{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){const{eventType:e,startTime:i,startPoints:r}=this;if(e==="press")return e;let o;return o=ka.now()-i>this.config.press.time&&ef(r[0],t)<this.config.press.threshold?"press":"pan",this.eventType=o,o}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){const{emitThrottles:i}=this,r={type:t,ev:e};for(let o=0,s=i.length;o<s;o++)if(i[o].type===t)return void i.splice(o,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);const{throttleTimer:i,emitThrottles:r}=this;i||(this.throttleTimer=Mt.global.getRequestAnimationFrame()(()=>{Mt.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let o=0,s=r.length;o<s;o++){const{type:a,ev:l}=r[o];this.emitEvent(a,l)}this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){const e=this.processEvent;Object.keys(e).forEach(i=>{this.triggerEvent(`${i}end`,t),i==="press"&&this.triggerEvent(`${i}up`,t),delete e[i]})}emitEvent(t,e){if(!this.element)return;const i=this.element._events[hL];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(let r=0,o=i.length;r<o&&!e.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,e,t);this.emit(t,e)}}var Fj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Oj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const ce=[0,0,0],Hj=(n,t,e,i,r,o,s,a)=>{if(a)for(;e>t;)e-=Zt;else for(;e<t;)e+=Zt;const l=Ae/3*(e>t?1:-1);let u=t,h=u;for(;h!==e;){h=l>0?Math.min(h+l,e):Math.max(h+l,e);const d=Math.abs(h-u),c=4*Math.tan(d/4)/3,f=h<u?-1:1,g=Math.cos(u),m=Math.sin(u),p=Math.cos(h),v=Math.sin(h),b=g*o+i,C=m*s+r,y=p*o+i,w=v*s+r,_=o*c*f,A=s*c*f;n.push([b-_*m,C+A*g,y+_*v,w-A*p,y,w]),u=h}};let Kl=class{set fillStyle(n){this.nativeContext.fillStyle=n}get fillStyle(){return this.nativeContext.fillStyle}set font(n){n!==this._font&&(this._font=n,this.nativeContext.font=n)}get font(){var n;return(n=this._font)!==null&&n!==void 0?n:this.nativeContext.font}set globalAlpha(n){this.nativeContext.globalAlpha=n*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(n){this.nativeContext.lineCap=n}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(n){this.nativeContext.lineDashOffset=n}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(n){this.nativeContext.lineJoin=n}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(n){this.nativeContext.lineWidth=n}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(n){this.nativeContext.miterLimit=n}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(n){this.nativeContext.shadowBlur=n}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(n){this.nativeContext.shadowColor=n}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(n){this.nativeContext.shadowOffsetX=n}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(n){this.nativeContext.shadowOffsetY=n}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(n){this.nativeContext.strokeStyle=n}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(n){this.nativeContext.textAlign=n}get textAlign(){return this.nativeContext.textAlign}set textBaseline(n){this.nativeContext.textBaseline=n}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(n){n!==!!this._inuse&&(this._inuse=n,n?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(n,t){this.fillAttributes=Object.assign(Object.assign({},Kk),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},Zk),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},Gr),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;const e=n.nativeCanvas.getContext("2d");if(!e)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=e,this.canvas=n,this.matrix=new Xe(1,0,0,1,0,0),this.stack=[],this.dpr=t,this.applyedMatrix=new Xe(1,0,0,1,0,0),this._clearMatrix=new Xe(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(n=!0){this.stack.length&&Er.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Xe(1,0,0,1,0,0),this.stack.length=0,n&&this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(n=!1){!n&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(n){return qi.allocateByObj(n)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(qi.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}highPerformanceRestore(){this.stack.length>0&&(qi.free(this.matrix),this.matrix=this.stack.pop())}rotate(n,t=!0){this.matrix.rotate(n),t&&this.setTransformForCurrent()}save(){const n=this.cloneMatrix(this.matrix);this.stack.push(n),this.nativeContext.save()}highPerformanceSave(){const n=this.cloneMatrix(this.matrix);this.stack.push(n)}scale(n,t,e=!0){this.matrix.scale(n,t),e&&this.setTransformForCurrent()}setScale(n,t,e=!0){this.matrix.setScale(n,t),e&&this.setTransformForCurrent()}scalePoint(n,t,e,i,r=!0){this.translate(e,i,!1),this.scale(n,t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}setTransform(n,t,e,i,r,o,s=!0,a=this.dpr){this.matrix.setValue(a*n,a*t,a*e,a*i,a*r,a*o),s&&this.setTransformForCurrent()}setTransformFromMatrix(n,t=!0,e=this.dpr){this.matrix.setValue(n.a*e,n.b*e,n.c*e,n.d*e,n.e*e,n.f*e),t&&this.setTransformForCurrent()}resetTransform(n=!0,t=this.dpr){this.setTransform(t,0,0,t,0,0),n&&this.setTransformForCurrent()}transform(n,t,e,i,r,o,s=!0){this.matrix.multiply(n,t,e,i,r,o),s&&this.setTransformForCurrent()}transformFromMatrix(n,t){this.matrix.multiply(n.a,n.b,n.c,n.d,n.e,n.f),t&&this.setTransformForCurrent()}translate(n,t,e=!0){this.matrix.translate(n,t),e&&this.setTransformForCurrent()}rotateDegrees(n,t=!0){const e=n*Math.PI/180;this.rotate(e,t)}rotateAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotate(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}rotateDegreesAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotateDegrees(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(n,t){n?typeof n=="string"?this.nativeContext.clip(n):this.nativeContext.clip(n,t):this.nativeContext.clip()}arc(n,t,e,i,r,o,s){if(s=s||0,this.camera){const a=[];Hj(a,i,r,n,t,e,e,o);for(let l=0;l<a.length;++l){const u=a[l];this.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5],s)}}else this.nativeContext.arc(n,t,Math.max(0,e),i,r,o)}arcTo(n,t,e,i,r){this.nativeContext.arcTo(n,t,e,i,r)}bezierCurveTo(n,t,e,i,r,o,s){if(s=s||0,this.camera){let a=s,l=s;this.modelMatrix&&(zn(ce,[n,t,s],this.modelMatrix),n=ce[0],t=ce[1],a=ce[2],zn(ce,[e,i,s],this.modelMatrix),e=ce[0],i=ce[1],l=ce[2],zn(ce,[r,o,s],this.modelMatrix),r=ce[0],o=ce[1],s=ce[2]);let u=this.camera.vp(r,o,s);r=u.x,o=u.y,u=this.camera.vp(n,t,a),n=u.x,t=u.y,u=this.camera.vp(e,i,l),e=u.x,i=u.y}this.nativeContext.bezierCurveTo(n,t,e,i,r,o)}closePath(){this.nativeContext.closePath()}ellipse(n,t,e,i,r,o,s,a){a==null?this.nativeContext.ellipse(n,t,e,i,r,o,s):this.nativeContext.ellipse(n,t,e,i,r,o,s,a)}lineTo(n,t,e){if(e=e||0,this.camera){this.modelMatrix&&(zn(ce,[n,t,e],this.modelMatrix),n=ce[0],t=ce[1],e=ce[2]);const i=this.camera.vp(n,t,e);n=i.x,t=i.y}this.nativeContext.lineTo(n,t)}moveTo(n,t,e){if(e=e||0,this.camera){this.modelMatrix&&(zn(ce,[n,t,e],this.modelMatrix),n=ce[0],t=ce[1],e=ce[2]);const i=this.camera.vp(n,t,e);n=i.x,t=i.y}this.nativeContext.moveTo(n,t)}quadraticCurveTo(n,t,e,i,r){if(r=r||0,this.camera){let o=r;this.modelMatrix&&(zn(ce,[n,t,r],this.modelMatrix),n=ce[0],t=ce[1],o=ce[2],zn(ce,[e,i,r],this.modelMatrix),e=ce[0],i=ce[1],r=ce[2]);let s=this.camera.vp(e,i,r);e=s.x,i=s.y,s=this.camera.vp(n,t,o),n=s.x,t=s.y}this.nativeContext.quadraticCurveTo(n,t,e,i)}rect(n,t,e,i,r){r=r||0,this.camera?(this.moveTo(n,t,r),this.lineTo(n+e,t,r),this.lineTo(n+e,t+i,r),this.lineTo(n,t+i,r),this.closePath()):this.nativeContext.rect(n,t,e,i)}createImageData(){const n=arguments;return n.length===2?this.nativeContext.createImageData(n[0],n[1]):n.length===1?this.nativeContext.createImageData(n[0]):null}createLinearGradient(n,t,e,i){return isFinite(n+t+e+i)||(n=0,t=0,e=0,i=0),this.nativeContext.createLinearGradient(n,t,e,i)}createPattern(n,t){return n.width===0||n.height===0?null:this.nativeContext.createPattern(n,t)}createRadialGradient(n,t,e,i,r,o){return this.nativeContext.createRadialGradient(n,t,e,i,r,o)}createConicGradient(n,t,e,i){if(this.nativeContext.createConicGradient&&Math.abs(i-e-2*Math.PI)<.001)return this.nativeContext.createConicGradient(e,n,t);let r,o=!1;const s=this;return{stops:[],addColorStop(a,l){this.stops.push([a,l]),o=!0},GetPattern(a,l,u){return o&&(u||(u=i-e),r=R9(s,this.stops,n,t,u,e,i,a,l),o=!1),r}}}fill(n,t){this.disableFill||(n?this.nativeContext.fill(n):this.nativeContext.fill())}fillRect(n,t,e,i){this.nativeContext.fillRect(n,t,e,i)}clearRect(n,t,e,i){this.nativeContext.clearRect(n,t,e,i)}project(n,t,e){if(e=e||0,this.camera){this.modelMatrix&&(zn(ce,[n,t,e],this.modelMatrix),n=ce[0],t=ce[1],e=ce[2]);const i=this.camera.vp(n,t,e);n=i.x,t=i.y}return{x:n,y:t}}view(n,t,e){return e=e||0,this.camera?(this.modelMatrix&&(zn(ce,[n,t,e],this.modelMatrix),n=ce[0],t=ce[1],e=ce[2]),this.camera.view(n,t,e)):[n,t,e]}fillText(n,t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(zn(ce,[t,e,i],this.modelMatrix),t=ce[0],e=ce[1],i=ce[2]);const r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.fillText(n,t,e)}getImageData(n,t,e,i){return this.nativeContext.getImageData(n,t,e,i)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(n,t){return this.nativeContext.isPointInPath(n,t)}isPointInStroke(n,t){return this.nativeContext.isPointInStroke(n,t)}measureText(n,t=Mt.global.measureTextMethod){var e,i;if(!t||t==="native")return this.nativeContext.measureText(n);this.mathTextMeasure||(this.mathTextMeasure=Mt.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));const r=(e=this.fontFamily)!==null&&e!==void 0?e:Gr.fontFamily,o=(i=this.fontSize)!==null&&i!==void 0?i:Gr.fontSize;return this.mathTextMeasure.textSpec.fontFamily===r&&this.mathTextMeasure.textSpec.fontSize===o||(this.mathTextMeasure.textSpec.fontFamily=r,this.mathTextMeasure.textSpec.fontSize=o,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(n,t)}putImageData(n,t,e){this.nativeContext.putImageData(n,t,e)}setLineDash(n){const t=arguments,e=this.nativeContext;this.nativeContext.setLineDash?t[0]&&e.setLineDash(t[0]):"mozDash"in e?e.mozDash=t[0]:"webkitLineDash"in e&&(e.webkitLineDash=t[0])}stroke(n){this.disableStroke||(n?this.nativeContext.stroke(n):this.nativeContext.stroke())}strokeRect(n,t,e,i){this.nativeContext.strokeRect(n,t,e,i)}strokeText(n,t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(zn(ce,[t,e,i],this.modelMatrix),t=ce[0],e=ce[1],i=ce[2]);const r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.strokeText(n,t,e)}drawImage(){const n=this.nativeContext,t=arguments;t.length===3?n.drawImage(t[0],t[1],t[2]):t.length===5?n.drawImage(t[0],t[1],t[2],t[3],t[4]):t.length===9&&n.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}setCommonStyle(n,t,e,i,r){if(Array.isArray(r)){if(r.length<=1)return this._setCommonStyle(n,t,e,i,r[0]);const o=Object.create(r[0]);return r.forEach((s,a)=>{a!==0&&Object.assign(o,s)}),this._setCommonStyle(n,t,e,i,o)}return this._setCommonStyle(n,t,e,i,r)}_setCommonStyle(n,t,e,i,r){const o=this.nativeContext;r||(r=this.fillAttributes);const{fillOpacity:s=r.fillOpacity,opacity:a=r.opacity,fill:l=r.fill}=t;o.globalAlpha=s*a*this.baseGlobalAlpha,s>1e-12&&a>1e-12&&(o.fillStyle=dg(this,l,n,e,i))}setShadowBlendStyle(n,t,e){if(Array.isArray(e)){if(e.length<=1)return this._setShadowBlendStyle(n,e[0]);const i=Object.create(e[0]);return e.forEach((r,o)=>{o!==0&&Object.assign(i,r)}),this._setShadowBlendStyle(n,t,i)}return this._setShadowBlendStyle(n,t,e)}_setShadowBlendStyle(n,t,e){const i=this.nativeContext;e||(e=this.fillAttributes);const{opacity:r=e.opacity,shadowBlur:o=e.shadowBlur,shadowOffsetX:s=e.shadowOffsetX,shadowOffsetY:a=e.shadowOffsetY,blur:l=e.blur,globalCompositeOperation:u=e.globalCompositeOperation}=t;if(!(r<=1e-12)){if(s||a||o){const{shadowColor:h=e.shadowColor,shadowOffsetX:d=e.shadowOffsetX,shadowOffsetY:c=e.shadowOffsetY}=t;i.shadowBlur=o*this.dpr,i.shadowColor=h,i.shadowOffsetX=d*this.dpr,i.shadowOffsetY=c*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0);l?(i.filter=`blur(${l}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(i.filter="blur(0px)",this._clearFilterStyle=!1),u?(i.globalCompositeOperation=u,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(i.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}setStrokeStyle(n,t,e,i,r){if(Array.isArray(r)){if(r.length<=1)return this._setStrokeStyle(n,t,e,i,r[0]);const o=Object.create(r[0]);return r.forEach((s,a)=>{a!==0&&Object.assign(o,s)}),this._setStrokeStyle(n,t,e,i,o)}return this._setStrokeStyle(n,t,e,i,r)}_setStrokeStyle(n,t,e,i,r){const o=this.nativeContext;r||(r=this.strokeAttributes);const{strokeOpacity:s=r.strokeOpacity,opacity:a=r.opacity}=t;if(o.globalAlpha=s*a*this.baseGlobalAlpha,s>1e-12&&a>1e-12){const{lineWidth:l=r.lineWidth,stroke:u=r.stroke,lineJoin:h=r.lineJoin,lineDash:d=r.lineDash,lineDashOffset:c=r.lineDashOffset,lineCap:f=r.lineCap,miterLimit:g=r.miterLimit,keepStrokeScale:m=r.keepStrokeScale}=t;o.lineWidth=m?l:Po(this,l,this.dpr),o.strokeStyle=dg(this,u,n,e,i),o.lineJoin=h,d&&(o.setLineDash(d),o.lineDashOffset=c),o.lineCap=f,o.miterLimit=g}}setTextStyleWithoutAlignBaseline(n,t,e){const i=this.nativeContext;t||(t=this.textAttributes);const{scaleIn3d:r=t.scaleIn3d}=n;n.font?this.font=n.font:this.font=lg(n,t,r&&this.camera&&this.camera.getProjectionScale(e));const{fontFamily:o=t.fontFamily,fontSize:s=t.fontSize}=n;this.fontFamily=o,this.fontSize=s,i.textAlign="left",i.textBaseline="alphabetic"}setTextStyle(n,t,e){var i,r;const o=this.nativeContext;t||(t=this.textAttributes),n.font?this.font=n.font:this.font=lg(n,t,this.camera&&this.camera.getProjectionScale(e));const{fontFamily:s=t.fontFamily,fontSize:a=t.fontSize}=n;this.fontFamily=s,this.fontSize=a,o.textAlign=(i=n.textAlign)!==null&&i!==void 0?i:t.textAlign,o.textBaseline=(r=n.textBaseline)!==null&&r!==void 0?r:t.textBaseline}draw(){}clearMatrix(n=!0,t=this.dpr){this.setTransformFromMatrix(this._clearMatrix,n,t)}setClearMatrix(n,t,e,i,r,o){this._clearMatrix.setValue(n,t,e,i,r,o)}onlyTranslate(n=this.dpr){return this.matrix.a===n&&this.matrix.b===0&&this.matrix.c===0&&this.matrix.d===n}release(...n){this.stack.forEach(t=>qi.free(t)),this.stack.length=0}};Kl.env="browser",Kl=Fj([Tt(),Oj("design:paramtypes",[Object,Number])],Kl);var zj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Nj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let Zl=class extends xw{constructor(n){super(n)}init(n){const{container:t}=n;if(typeof t=="string"){const e=Mt.global.getElementById(t);e&&(this._container=e)}else this._container=t;this._context=new Kl(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;const{nativeCanvas:n}=this;n.width=this._pixelWidth,n.height=this._pixelHeight,!n.style||this.setCanvasStyle(n,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(n),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){const n=this._nativeCanvas;n.style.position="absolute",n.style.top=`${this._y}px`,n.style.left=`${this._x}px`}resetStyle(n){if(!this.controled)return;const{width:t=this._displayWidth,height:e=this._displayHeight,dpr:i=this._dpr,x:r=this._x,y:o=this._y}=n,{nativeCanvas:s}=this;s.width=t*i,s.height=e*i,!s.style||this.setCanvasStyle(s,r,o,t,e),n.id&&(s.id=n.id),this.visiable||this.hide()}setCanvasStyle(n,t,e,i,r){this.controled&&(n.style.width=`${i}px`,n.style.height=`${r}px`)}toDataURL(n,t){return n==="image/jpeg"?this._nativeCanvas.toDataURL(n,t):n==="image/png"?this._nativeCanvas.toDataURL(n):this._nativeCanvas.toDataURL(n,t)}resize(n,t){this.controled&&(this._pixelWidth=n*this._dpr,this._pixelHeight=t*this._dpr,this._displayWidth=n,this._displayHeight=t,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${n}px`,this._nativeCanvas.style.height=`${t}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};Zl.env="browser",Zl=zj([Tt(),Nj("design:paramtypes",[Object])],Zl);function VL(n,t){return new ie(e=>{e(rL).toDynamicValue(()=>i=>new n(i)).whenTargetNamed(n.env),e(y8).toDynamicValue(()=>(i,r)=>new t(i,r)).whenTargetNamed(t.env)})}const Wj=VL(Zl,Kl);var Uj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Vj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},ha=function(n,t){return function(e,i){t(e,i,n)}};let Hl=class extends cC{constructor(n,t,e,i){super(e,i),this.contributions=n,this.drawContribution=t,this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.global.hooks.onSetEnv.tap("canvas-picker-service",(r,o,s)=>{this.configure(s,o)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(n=>{this.pickerMap.set(n.numberType,n)}),super._init()}configure(n,t){this.pickCanvas=Va.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(n,t,e,i){if(n.attribute.pickable===!1)return null;if(this.InterceptorContributions.length)for(let l=0;l<this.InterceptorContributions.length;l++){const u=this.InterceptorContributions[l];if(u.beforePickItem){const h=u.beforePickItem(n,this,t,i,{parentMatrix:e});if(h)return h}}const r=this.pickerMap.get(n.numberType);if(!r)return null;const o=r.contains(n,t,i),s=o?n:null,a={graphic:s,params:o};if(s)return a;if(this.InterceptorContributions.length)for(let l=0;l<this.InterceptorContributions.length;l++){const u=this.InterceptorContributions[l];if(u.afterPickItem){const h=u.afterPickItem(n,this,t,i,{parentMatrix:e});if(h)return h}}return a}};Hl=Uj([Tt(),ha(0,ge(ci)),ha(0,Di(qr)),ha(1,ge(Bw)),ha(2,ge(ci)),ha(2,Di(Fl)),ha(3,ge(ci)),ha(3,Di(Dg)),Vj("design:paramtypes",[Object,Object,Object,Object])],Hl);var jj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let gC=class{constructor(){this.type="group",this.numberType=_w}contains(n,t,e){return!1}};gC=jj([Tt()],gC);const Gg=new ie((n,t,e,i)=>{Gg.__vloaded||(Gg.__vloaded=!0,n(NA).to(gC).inSingletonScope(),n(qr).toService(NA),ar(n,qr))});Gg.__vloaded=!1;const Gj=new ie((n,t,e,i)=>{e(Hl)||n(Hl).toSelf().inSingletonScope(),e(Yl)?i(Yl).toService(Hl):n(Yl).toService(Hl)});function $j(n){n.load(Gg),n.load(Gj)}var Eh,qj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Xj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let Bs=Eh=class extends Vg{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${Eh.idprefix}_${Eh.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=Mt.global,this.viewBox=new Ye,this.modelMatrix=new Xe(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(n){n.canvas?this.createWindowByCanvas(n):this.createWindowByConfig(n),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch{console.error("发生错误，该环境不存在IntersectionObserver")}}isElementVisible(n){const t=n.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight;return!(t.right<0||t.bottom<0||t.left>e||t.top>i)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);const n=new IntersectionObserver((t,e)=>{t.forEach(i=>{this._canvasIsIntersecting!==i.isIntersecting?(this._canvasIsIntersecting=i.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(i.isIntersecting)):this._canvasIsIntersecting=i.isIntersecting})});n&&n.observe(this.canvas.nativeCanvas)}createWindowByConfig(n){const t=this.global.createCanvas({width:n.width,height:n.height});let e;if(e=typeof n.container=="string"?this.global.getElementById(n.container):n.container?n.container:this.global.getRootElement(),!e)throw new Error("发生错误，containerId可能传入有误");n.offscreen?e=null:e.appendChild(t);const i={width:n.width,height:n.height,dpr:n.dpr,nativeCanvas:t,container:e,id:Eh.GenerateCanvasId(),canvasControled:!0};this.canvas=new Zl(i)}createWindowByCanvas(n){var t;let e;if(typeof n.canvas=="string"){if(e=this.global.getElementById(n.canvas),!e)throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=n.canvas;if(!e)throw new Error("发生错误，传入的canvas不正确");let i=n.width,r=n.height;if(i==null||r==null||!n.canvasControled){const s=e.getBoundingClientRect();i=s.width,r=s.height}let o=n.dpr;o==null&&(o=(t=e.getContext("2d").pixelRatio)!==null&&t!==void 0?t:e.width/i),this.canvas=new Zl({width:i,height:r,dpr:o,nativeCanvas:e,canvasControled:n.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(n,t){this.canvas.resize(n,t)}setDpr(n){this.canvas.dpr=n}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(n,t,e){return this.canvas.nativeCanvas.addEventListener(n,t,e)}removeEventListener(n,t,e){return this.canvas.nativeCanvas.removeEventListener(n,t,e)}dispatchEvent(n){return this.canvas.nativeCanvas.dispatchEvent(n)}getStyle(){var n;return(n=this.canvas.nativeCanvas.style)!==null&&n!==void 0?n:{}}setStyle(n){this.canvas.nativeCanvas.style=n}getBoundingClientRect(){const n=this.canvas.nativeCanvas,t=this.getWH();return n.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(n){const t=this.viewBox,e=this.getContext(),i=this.getDpr();e.nativeContext.save(),e.nativeContext.setTransform(i,0,0,i,0,0),e.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),n&&(e.fillStyle=n,e.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),e.nativeContext.restore()}isVisible(n){return this._canvasIsIntersecting}onVisibleChange(n){this._onVisibleChangeCb=n}getTopLeft(n){return this.global.getElementTopLeft(this.canvas.nativeCanvas,n)}};Bs.env="browser",Bs.idprefix="visactor_window",Bs.prefix_count=0,Bs=Eh=qj([Tt(),Xj("design:paramtypes",[])],Bs);const Yj=new ie(n=>{n(Bs).toSelf(),n(mw).toDynamicValue(t=>t.container.get(Bs)).whenTargetNamed(Bs.env)});var Kj=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Zj=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Qj=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};class Jj{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function UA(n,t=!1){const e=document.createElement("img");if(Mt.global.isImageAnonymous&&(e.crossOrigin="anonymous"),t){const i=new Blob([n],{type:"image/svg+xml"});n=window.URL.createObjectURL(i)}return e.src=n,e.complete?Promise.resolve(e):new Promise((i,r)=>{e.onload=()=>{i(e)},e.onerror=()=>{r(new Error("加载失败"))}})}let $g=class extends Ug{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch{this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(n,t){var e,i;let r=0,o=0,s=0,a=0;if(n.changedTouches){const l=(e=n.changedTouches[0])!==null&&e!==void 0?e:{};r=l.clientX||0,o=l.clientY||0,s=r,a=o}else r=n.clientX||0,o=n.clientY||0,s=n.offsetX||0,a=n.offsetY||0;if(t){const l=r,u=o,h=t.getBoundingClientRect(),d=(i=t.getNativeHandler)===null||i===void 0?void 0:i.call(t).nativeCanvas;let c,f;return d&&(c=h.width/d.offsetWidth,f=h.height/d.offsetHeight),{x:(l-h.left)/(Ne(c)?c:1),y:(u-h.top)/(Ne(f)?f:1)}}return{x:s,y:a}}getNativeAABBBounds(n){let t=n;if(typeof n=="string"&&(t=new DOMParser().parseFromString(n,"text/html").firstChild,t.lastChild&&(t=t.lastChild.firstChild)),t.getBoundingClientRect){const e=t.getBoundingClientRect();return new Jj(e)}return new Ye}removeDom(n){return n.parentElement.removeChild(n),!0}updateDom(n,t){const{width:e,height:i,style:r}=t;return r&&(lr(r)?n.setAttribute("style",r):Object.keys(r).forEach(o=>{n.style[o]=r[o]})),e!=null&&(n.style.width=`${e}px`),i!=null&&(n.style.height=`${i}px`),!0}createDom(n){const{tagName:t="div",parent:e}=n,i=document.createElement(t);if(this.updateDom(i,n),e){const r=lr(e)?this.getElementById(e):e;r&&r.appendChild&&r.appendChild(i)}return i}loadImage(n){return UA(n,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(n){return UA(n,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(n){var t,e;const i=document.createElement("canvas");n.id&&(i.id=(t=n.id)!==null&&t!==void 0?t:bi.GenAutoIncrementId().toString());const r=(e=n.dpr)!==null&&e!==void 0?e:window.devicePixelRatio;return n.width&&n.height&&(i.style.width=`${n.width}px`,i.style.height=`${n.height}px`,i.width=n.width*r,i.height=n.height*r),i}createOffscreenCanvas(n){var t;const e=(t=n.dpr)!==null&&t!==void 0?t:window.devicePixelRatio;return new OffscreenCanvas(n.width*e,n.height*e)}releaseCanvas(n){let t;t=typeof n=="string"?document.getElementById(n):n,t&&t.parentElement&&t.parentElement.removeChild(t)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(n,t,e){return document.addEventListener(n,t,e)}removeEventListener(n,t,e){return document.removeEventListener(n,t,e)}dispatchEvent(n){return document.dispatchEvent(n)}getElementById(n){return document.getElementById(n)}getRootElement(){return document.body}getDocument(){return document}release(...n){}getElementTop(n,t){let e=n.offsetTop,i=n.offsetParent;for(;i!==null;)e+=i.offsetTop,i=i.offsetParent;return e}getElementLeft(n,t){let e=n.offsetLeft,i=n.offsetParent;for(;i!==null;)e+=i.offsetLeft,i=i.offsetParent;return e}getElementTopLeft(n,t){let e=n.offsetTop,i=n.offsetLeft,r=n.offsetParent;for(;r!==null;)e+=r.offsetTop,i+=r.offsetLeft,r=r.offsetParent;return{top:e,left:i}}loadFont(n,t,e){return Qj(this,void 0,void 0,function*(){return new FontFace(n,lr(t)?`url(${t})`:t,e).load().then(function(i){return document.fonts.add(i),{loadState:"success"}}).catch(function(i){return console.error("Failed to load font:",i),{loadState:"fail"}})})}isMacOS(){if(this._isMacOS===void 0)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch{this._isMacOS=!1}return this._isMacOS}copyToClipBoard(n){return navigator.clipboard.writeText(n).then(()=>{}).catch(t=>{})}};$g=Kj([Tt(),Zj("design:paramtypes",[])],$g);const qg=new ie(n=>{qg.isBrowserBound||(qg.isBrowserBound=!0,n($g).toSelf().inSingletonScope(),n(Rm).toService($g))});qg.isBrowserBound=!1;function Xg(n,t=!0){Xg.__loaded||(Xg.__loaded=!0,n.load(qg),n.load(Wj),n.load(Yj),t&&$j(n))}Xg.__loaded=!1;class Do{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise"||!this.canvasRenderer)return!0;const{pickContext:r}=i??{};if(!r)return!1;const o=t.getGraphicTheme();r.highPerformanceSave();let{x:s=o.x,y:a=o.y}=t.attribute;if(t.transMatrix.onlyTranslate()){const h=t.getOffsetXY(o);s+=h.x,a+=h.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let l=!1,u=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(h,d,c,f)=>!(!l&&!u)||(l=h.isPointInPath(e.x,e.y),u=f||u,l),(h,d,c,f)=>{if(l||u)return!0;const g=d.lineWidth||c.lineWidth,m=d.pickStrokeBuffer||c.pickStrokeBuffer,p=d.keepStrokeScale||c.keepStrokeScale;return r.lineWidth=p?g+m:Po(r,g+m,r.dpr),l=h.isPointInStroke(e.x,e.y),u=f||u,l}),r.highPerformanceRestore(),l}}var tG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},eG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},iG=function(n,t){return function(e,i){t(e,i,n)}};let pC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="arc",this.numberType=Pm}};pC=tG([Tt(),iG(0,ge(Ag)),eG("design:paramtypes",[Object])],pC);let VA=!1;const rG=new ie((n,t,e,i)=>{VA||(VA=!0,n(wA).to(pC).inSingletonScope(),n(Ks).toService(wA))});var nG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},oG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},sG=function(n,t){return function(e,i){t(e,i,n)}};let mC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="circle",this.numberType=km}};mC=nG([Tt(),sG(0,ge(Rg)),oG("design:paramtypes",[Object])],mC);let jA=!1;const aG=new ie((n,t,e,i)=>{jA||(jA=!0,n(SA).to(mC).inSingletonScope(),n(Ks).toService(SA))});var lG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Tu=class{constructor(){this.type="image",this.numberType=Lm}contains(n,t,e){const{pickContext:i}=e??{};return!!i&&!!n.AABBBounds.containsPoint(t)}};Tu=lG([Tt()],Tu);let GA=!1;const uG=new ie((n,t,e,i)=>{GA||(GA=!0,n(jg).to(Tu).inSingletonScope(),n(Tu).toService(jg))});var hG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},dG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},cG=function(n,t){return function(e,i){t(e,i,n)}};let vC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="line",this.numberType=qd}};vC=hG([Tt(),cG(0,ge(Eg)),dG("design:paramtypes",[Object])],vC);let $A=!1;const fG=new ie((n,t,e,i)=>{$A||($A=!0,n(xA).to(vC).inSingletonScope(),n(Ks).toService(xA))});var gG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},pG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},mG=function(n,t){return function(e,i){t(e,i,n)}};let bC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="polygon",this.numberType=Im}};bC=gG([Tt(),mG(0,ge(Bg)),pG("design:paramtypes",[Object])],bC);let qA=!1;const vG=new ie((n,t,e,i)=>{qA||(qA=!0,n(MA).to(bC).inSingletonScope(),n(Ks).toService(MA))});var bG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},_G=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},CG=function(n,t){return function(e,i){t(e,i,n)}};let _C=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="path",this.numberType=Dm}};_C=bG([Tt(),CG(0,ge(Mg)),_G("design:paramtypes",[Object])],_C);let XA=!1;const yG=new ie((n,t,e,i)=>{XA||(XA=!0,n(TA).to(_C).inSingletonScope(),n(Ks).toService(TA))}),pv=new Ye;class jL{constructor(){this.type="rect",this.numberType=Cw}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:r}=i??{};if(!r)return!1;const o=t.getGraphicTheme(),{cornerRadius:s=o.cornerRadius}=t.attribute;let{x:a=o.x,y:l=o.y}=t.attribute;r.highPerformanceSave();let u=!0;if(t.transMatrix.onlyTranslate()){const d=t.getOffsetXY(o);a+=d.x,l+=d.y,r.setTransformForCurrent()}else a=0,l=0,u=!1,r.transformFromMatrix(t.transMatrix,!0);let h=!0;if(!u||t.shadowRoot||ne(s,!0)&&s!==0||jt(s)&&s.some(d=>d!==0))h=!1,this.canvasRenderer.drawShape(t,r,a,l,{},null,(d,c,f)=>!!h||(h=d.isPointInPath(e.x,e.y),h),(d,c,f)=>{if(h)return!0;const g=c.lineWidth||f.lineWidth,m=c.pickStrokeBuffer||f.pickStrokeBuffer,p=c.keepStrokeScale||f.keepStrokeScale;return r.lineWidth=p?g+m:Po(r,g+m,r.dpr),h=d.isPointInStroke(e.x,e.y),h});else{const{fill:d=o.fill,stroke:c=o.stroke,lineWidth:f=o.lineWidth}=t.attribute;if(d)h=!0;else if(c){const g=t.AABBBounds;pv.setValue(g.x1,g.y1,g.x2,g.y2),pv.expand(-f/2),h=!pv.containsPoint(e)}}return r.highPerformanceRestore(),h}}var wG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},SG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},xG=function(n,t){return function(e,i){t(e,i,n)}};let CC=class extends jL{constructor(n){super(),this.canvasRenderer=n}};CC=wG([Tt(),xG(0,ge(Pg)),SG("design:paramtypes",[Object])],CC);let YA=!1;const TG=new ie((n,t,e,i)=>{YA||(YA=!0,n(AA).to(CC).inSingletonScope(),n(Ks).toService(AA))});let KA=!1;const AG=new ie((n,t,e,i)=>{KA||(KA=!0,n(jg).to(Tu).inSingletonScope(),n(Tu).toService(jg))});var RG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},EG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},MG=function(n,t){return function(e,i){t(e,i,n)}};let yC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="symbol",this.numberType=Fm}};yC=RG([Tt(),MG(0,ge(kg)),EG("design:paramtypes",[Object])],yC);let ZA=!1;const BG=new ie((n,t,e,i)=>{ZA||(ZA=!0,n(RA).to(yC).inSingletonScope(),n(Ks).toService(RA))});var PG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let wC=class{constructor(){this.type="text",this.numberType=Om}contains(n,t,e){return!!n.AABBBounds.containsPoint(t)}};wC=PG([Tt()],wC);let QA=!1;const kG=new ie((n,t,e,i)=>{QA||(QA=!0,n(EA).to(wC).inSingletonScope(),n(Ks).toService(EA))});var LG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},DG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let zh=class extends Kl{constructor(n,t){super(n,t);const e=n.nativeCanvas.getContext("2d");if(!e)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=e,this.canvas=n,this.matrix=new Xe(1,0,0,1,0,0),this.stack=[],this.dpr=t??1}release(...n){}};zh.env="node",zh=LG([Tt(),DG("design:paramtypes",[Object,Number])],zh);var IG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},FG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let Ql=class extends xw{constructor(n){super(n)}init(){this._context=new zh(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...n){this._nativeCanvas.release&&Ce(this._nativeCanvas.release)&&this._nativeCanvas.release()}};Ql.env="node",Ql=IG([Tt(),FG("design:paramtypes",[Object])],Ql);const OG=VL(Ql,zh);var HG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},zG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},NG=function(n,t){return function(e,i){t(e,i,n)}};let Jl=class extends Vg{get container(){return null}constructor(n){super(),this.global=n,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(n){n.canvas?this.createWindowByCanvas(n):this.createWindowByConfig(n)}createWindowByConfig(n){const t=this.global.createCanvas({width:n.width,height:n.height}),e={width:n.width,height:n.height,dpr:n.dpr,nativeCanvas:t,id:bi.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new Ql(e)}createWindowByCanvas(n){var t;const e=n.canvas,i=(t=n.dpr)!==null&&t!==void 0?t:1;let r=n.width,o=n.height;r!=null&&o!=null&&n.canvasControled||(r=e.width/i,o=e.height/i),this.canvas=new Ql({width:r,height:o,dpr:i,nativeCanvas:e,canvasControled:n.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(n,t){this.canvas.resize(n,t)}setDpr(n){this.canvas.dpr=n}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(n="image/png"){return this.canvas.nativeCanvas.toBuffer(n)}addEventListener(n,t,e){}dispatchEvent(n){return!0}removeEventListener(n,t,e){}getStyle(){}setStyle(n){}getBoundingClientRect(){return null}clearViewBox(n){}};Jl.env="node",Jl=HG([Tt(),NG(0,ge(aw)),zG("design:paramtypes",[Object])],Jl);const WG=new ie(n=>{n(Jl).toSelf(),n(mw).toDynamicValue(t=>t.container.get(Jl)).whenTargetNamed(Jl.env)});var UG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Yg=class extends Ug{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(n,t){n.env===this.type&&(n.setActiveEnvContribution(this),this.pkg=t)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(n){const t=fetch(n).then(e=>e.json());return t.then(e=>({data:e,state:"success"})).catch(()=>({data:null,state:"fail"})),t}loadArrayBuffer(n){return fetch(n).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(n){const{loadImage:t}=this.pkg;return t?t(n).then(e=>({loadState:e?"success":"fail",data:e})).catch(()=>({loadState:"fail",data:null})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}loadSvg(n){const t=this.pkg.Resvg;if(!t)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));const e=new t(n).render().asPng();return this.loadImage(e)}createCanvas(n){return this.pkg.createCanvas(n.width,n.height)}releaseCanvas(n){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(n){return tT.call(n)}}getCancelAnimationFrame(){return n=>{tT.clear(n)}}addEventListener(n,t,e){}removeEventListener(n,t,e){}getElementById(n){return null}getRootElement(){return null}dispatchEvent(n){}release(...n){}createOffscreenCanvas(n){}};Yg=UG([Tt()],Yg);const Kg=new ie(n=>{Kg.isNodeBound||(Kg.isNodeBound=!0,n(Yg).toSelf().inSingletonScope(),n(Rm).toService(Yg))});Kg.isNodeBound=!1;function Zg(n,t=!0){Zg.__loaded||(Zg.__loaded=!0,n.load(Kg),n.load(OG),n.load(WG))}Zg.__loaded=!1;var VG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},jG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},GG=function(n,t){return function(e,i){t(e,i,n)}};let SC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="arc",this.numberType=Pm}};SC=VG([Tt(),GG(0,ge(Ag)),jG("design:paramtypes",[Object])],SC);let JA=!1;const $G=new ie((n,t,e,i)=>{JA||(JA=!0,n(BA).to(SC).inSingletonScope(),n(qr).toService(BA))});var qG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},XG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},YG=function(n,t){return function(e,i){t(e,i,n)}};let xC=class extends jL{constructor(n){super(),this.canvasRenderer=n}};xC=qG([Tt(),YG(0,ge(Pg)),XG("design:paramtypes",[Object])],xC);let t2=!1;const KG=new ie((n,t,e,i)=>{t2||(t2=!0,n(IA).to(xC).inSingletonScope(),n(qr).toService(IA))});class GL extends Xr{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:r}=i??{};if(!r)return!1;r.highPerformanceSave();const o=t.getGraphicTheme(),s=this.transform(t,o,r),{x:a,y:l,z:u,lastModelMatrix:h}=s;let d=e;if(r.camera){d=e.clone();const f=t.parent.globalTransMatrix;d.x=f.a*e.x+f.c*e.y+f.e,d.y=f.b*e.x+f.d*e.y+f.f}this.canvasRenderer.z=u;let c=!1;return this.canvasRenderer.drawShape(t,r,a,l,{},null,f=>!!c||(c=f.isPointInPath(d.x,d.y),c),(f,g,m)=>{if(c)return!0;const p=g.lineWidth||m.lineWidth,v=g.pickStrokeBuffer||m.pickStrokeBuffer,b=g.keepStrokeScale||m.keepStrokeScale;return r.lineWidth=b?p+v:Po(r,p+v,r.dpr),c=f.isPointInStroke(d.x,d.y),c}),this.canvasRenderer.z=0,r.modelMatrix!==h&&Pi.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),c}}var ZG=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},QG=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},JG=function(n,t){return function(e,i){t(e,i,n)}};let TC=class extends GL{constructor(n){super(),this.canvasRenderer=n,this.type="line",this.numberType=qd}};TC=ZG([Tt(),JG(0,ge(Eg)),QG("design:paramtypes",[Object])],TC);let e2=!1;const t$=new ie((n,t,e,i)=>{e2||(e2=!0,n(LA).to(TC).inSingletonScope(),n(qr).toService(LA))});class $L extends Xr{contains(t,e,i){const{pickContext:r}=i??{};if(!r)return!1;const o=t.getGraphicTheme();r.highPerformanceSave();const s=this.transform(t,o,r),{x:a,y:l,z:u,lastModelMatrix:h}=s;let d=e;if(r.camera){d=e.clone();const f=t.parent.globalTransMatrix;d.x=f.a*e.x+f.c*e.y+f.e,d.y=f.b*e.x+f.d*e.y+f.f}this.canvasRenderer.z=u;let c=!1;return this.canvasRenderer.drawShape(t,r,a,l,i,null,(f,g,m)=>!!c||(c=f.isPointInPath(d.x,d.y),c)),this.canvasRenderer.z=0,r.modelMatrix!==h&&Pi.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),c}}var e$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},i$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},r$=function(n,t){return function(e,i){t(e,i,n)}};let AC=class extends $L{constructor(n){super(),this.canvasRenderer=n,this.type="symbol",this.numberType=Fm}contains(n,t,e){const{pickContext:i}=e??{};if(!i)return!1;const r=n.getParsedPath();if(!i.camera){if(!n.AABBBounds.containsPoint(t))return!1;if(r.isSvg||n.attribute.pickMode==="imprecise")return!0}i.highPerformanceSave();const o=n.getGraphicTheme(),s=this.transform(n,o,i),{x:a,y:l,z:u,lastModelMatrix:h}=s;let d=t;if(i.camera){d=t.clone();const f=n.parent.globalTransMatrix;d.x=f.a*t.x+f.c*t.y+f.e,d.y=f.b*t.x+f.d*t.y+f.f}this.canvasRenderer.z=u;let c=!1;return this.canvasRenderer.drawShape(n,i,a,l,{},null,(f,g,m)=>!!c||(c=f.isPointInPath(d.x,d.y),c),(f,g,m)=>{if(c)return!0;const p=g.lineWidth||m.lineWidth,v=g.pickStrokeBuffer||m.pickStrokeBuffer,b=g.keepStrokeScale||m.keepStrokeScale;return i.lineWidth=b?p+v:Po(i,p+v,i.dpr),c=f.isPointInStroke(d.x,d.y),c}),this.canvasRenderer.z=0,i.modelMatrix!==h&&Pi.free(i.modelMatrix),i.modelMatrix=h,i.highPerformanceRestore(),c}};AC=e$([Tt(),r$(0,ge(kg)),i$("design:paramtypes",[Object])],AC);let i2=!1;const n$=new ie((n,t,e,i)=>{i2||(i2=!0,n(FA).to(AC).inSingletonScope(),n(qr).toService(FA))});var o$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},s$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},a$=function(n,t){return function(e,i){t(e,i,n)}};let RC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="circle",this.numberType=km}};RC=o$([Tt(),a$(0,ge(Rg)),s$("design:paramtypes",[Object])],RC);let r2=!1;const l$=new ie((n,t,e,i)=>{r2||(r2=!0,n(PA).to(RC).inSingletonScope(),n(qr).toService(PA))});var u$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},h$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},d$=function(n,t){return function(e,i){t(e,i,n)}};let EC=class extends $L{constructor(n){super(),this.canvasRenderer=n,this.type="text",this.numberType=Om}contains(n,t,e){const{pickContext:i}=e??{};if(!i)return!1;const r=n.AABBBounds;if(!i.camera)return!!r.containsPoint(t);i.highPerformanceSave();const o=n.getGraphicTheme(),{keepDirIn3d:s=o.keepDirIn3d}=n.attribute,a=!s,l=this.transform(n,o,i,a),{x:u,y:h,z:d,lastModelMatrix:c}=l;this.canvasRenderer.z=d;let f=t;if(i.camera){f=t.clone();const m=n.parent.globalTransMatrix;f.x=m.a*t.x+m.c*t.y+m.e,f.y=m.b*t.x+m.d*t.y+m.f}let g=!1;return this.canvasRenderer.drawShape(n,i,u,h,{},null,(m,p,v)=>{if(g)return!0;const{fontSize:b=o.fontSize,textBaseline:C=o.textBaseline,textAlign:y=o.textAlign}=n.attribute,w=n.AABBBounds,_=w.height(),A=w.width(),T=md(C,_,b),S=_u(y,A);return m.rect(S+u,T+h,A,_,d),g=m.isPointInPath(f.x,f.y),g},(m,p,v)=>g),this.canvasRenderer.z=0,i.modelMatrix!==c&&Pi.free(i.modelMatrix),i.modelMatrix=c,i.highPerformanceRestore(),g}};EC=u$([Tt(),d$(0,ge(nC)),h$("design:paramtypes",[Object])],EC);let n2=!1;const c$=new ie((n,t,e,i)=>{n2||(n2=!0,n(OA).to(EC).inSingletonScope(),n(qr).toService(OA))});var f$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},g$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},p$=function(n,t){return function(e,i){t(e,i,n)}};let MC=class extends GL{constructor(n){super(),this.canvasRenderer=n,this.type="path",this.numberType=Dm}};MC=f$([Tt(),p$(0,ge(Mg)),g$("design:paramtypes",[Object])],MC);let o2=!1;const m$=new ie((n,t,e,i)=>{o2||(o2=!0,n(DA).to(MC).inSingletonScope(),n(qr).toService(DA))});var v$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},b$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},_$=function(n,t){return function(e,i){t(e,i,n)}};let BC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="polygon",this.numberType=Im}};BC=v$([Tt(),_$(0,ge(Bg)),b$("design:paramtypes",[Object])],BC);let s2=!1;const C$=new ie((n,t,e,i)=>{s2||(s2=!0,n(HA).to(BC).inSingletonScope(),n(qr).toService(HA))});var y$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},w$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},S$=function(n,t){return function(e,i){t(e,i,n)}};let PC=class{constructor(n){this.canvasRenderer=n,this.type="richtext",this.numberType=yw}contains(n,t,e){return!!n.AABBBounds.containsPoint(t)}};PC=y$([Tt(),S$(0,ge(oC)),w$("design:paramtypes",[Object])],PC);let a2=!1;const x$=new ie((n,t,e,i)=>{a2||(a2=!0,n(zA).to(PC).inSingletonScope(),n(qr).toService(zA))});var T$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},A$=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},R$=function(n,t){return function(e,i){t(e,i,n)}};let kC=class extends Do{constructor(n){super(),this.canvasRenderer=n,this.type="image",this.numberType=Lm}};kC=T$([Tt(),R$(0,ge(sC)),A$("design:paramtypes",[Object])],kC);let l2=!1;const E$=new ie((n,t,e,i)=>{l2||(l2=!0,n(kA).to(kC).inSingletonScope(),n(qr).toService(kA))});var jo={},mv={},Go={},u2;function qL(){if(u2)return Go;u2=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.loop=Go.conditional=Go.parse=void 0;var n=function i(r,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;if(Array.isArray(o))o.forEach(function(u){return i(r,u,s,a)});else if(typeof o=="function")o(r,s,a,i);else{var l=Object.keys(o)[0];Array.isArray(o[l])?(a[l]={},i(r,o[l],s,a[l])):a[l]=o[l](r,s,a,i)}return s};Go.parse=n;var t=function(r,o){return function(s,a,l,u){o(s,a,l)&&u(s,r,a,l)}};Go.conditional=t;var e=function(r,o){return function(s,a,l,u){for(var h=[],d=s.pos;o(s,a,l);){var c={};if(u(s,r,a,c),s.pos===d)break;d=s.pos,h.push(c)}return h}};return Go.loop=e,Go}var Ai={},h2;function XL(){if(h2)return Ai;h2=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.readBits=Ai.readArray=Ai.readUnsigned=Ai.readString=Ai.peekBytes=Ai.readBytes=Ai.peekByte=Ai.readByte=Ai.buildStream=void 0;var n=function(d){return{data:d,pos:0}};Ai.buildStream=n;var t=function(){return function(d){return d.data[d.pos++]}};Ai.readByte=t;var e=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(c){return c.data[c.pos+d]}};Ai.peekByte=e;var i=function(d){return function(c){return c.data.subarray(c.pos,c.pos+=d)}};Ai.readBytes=i;var r=function(d){return function(c){return c.data.subarray(c.pos,c.pos+d)}};Ai.peekBytes=r;var o=function(d){return function(c){return Array.from(i(d)(c)).map(function(f){return String.fromCharCode(f)}).join("")}};Ai.readString=o;var s=function(d){return function(c){var f=i(2)(c);return d?(f[1]<<8)+f[0]:(f[0]<<8)+f[1]}};Ai.readUnsigned=s;var a=function(d,c){return function(f,g,m){for(var p=typeof c=="function"?c(f,g,m):c,v=i(d),b=new Array(p),C=0;C<p;C++)b[C]=v(f);return b}};Ai.readArray=a;var l=function(d,c,f){for(var g=0,m=0;m<f;m++)g+=d[c+m]&&Math.pow(2,f-m-1);return g},u=function(d){return function(c){for(var f=t()(c),g=new Array(8),m=0;m<8;m++)g[7-m]=!!(f&1<<m);return Object.keys(d).reduce(function(p,v){var b=d[v];return b.length?p[v]=l(g,b.index,b.length):p[v]=g[b.index],p},{})}};return Ai.readBits=u,Ai}var d2;function M$(){return d2||(d2=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=qL(),e=XL(),i={blocks:function(c){for(var f=0,g=[],m=c.data.length,p=0,v=(0,e.readByte)()(c);v!==f&&v;v=(0,e.readByte)()(c)){if(c.pos+v>=m){var b=m-c.pos;g.push((0,e.readBytes)(b)(c)),p+=b;break}g.push((0,e.readBytes)(v)(c)),p+=v}for(var C=new Uint8Array(p),y=0,w=0;w<g.length;w++)C.set(g[w],y),y+=g[w].length;return C}},r=(0,t.conditional)({gce:[{codes:(0,e.readBytes)(2)},{byteSize:(0,e.readByte)()},{extras:(0,e.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,e.readUnsigned)(!0)},{transparentColorIndex:(0,e.readByte)()},{terminator:(0,e.readByte)()}]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===249}),o=(0,t.conditional)({image:[{code:(0,e.readByte)()},{descriptor:[{left:(0,e.readUnsigned)(!0)},{top:(0,e.readUnsigned)(!0)},{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{lct:(0,e.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,t.conditional)({lct:(0,e.readArray)(3,function(d,c,f){return Math.pow(2,f.descriptor.lct.size+1)})},function(d,c,f){return f.descriptor.lct.exists}),{data:[{minCodeSize:(0,e.readByte)()},i]}]},function(d){return(0,e.peekByte)()(d)===44}),s=(0,t.conditional)({text:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{preData:function(c,f,g){return(0,e.readBytes)(g.text.blockSize)(c)}},i]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===1}),a=(0,t.conditional)({application:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{id:function(c,f,g){return(0,e.readString)(g.blockSize)(c)}},i]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===255}),l=(0,t.conditional)({comment:[{codes:(0,e.readBytes)(2)},i]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===254}),u=[{header:[{signature:(0,e.readString)(3)},{version:(0,e.readString)(3)}]},{lsd:[{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{gct:(0,e.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,e.readByte)()},{pixelAspectRatio:(0,e.readByte)()}]},(0,t.conditional)({gct:(0,e.readArray)(3,function(d,c){return Math.pow(2,c.lsd.gct.size+1)})},function(d,c){return c.lsd.gct.exists}),{frames:(0,t.loop)([r,a,l,o,s],function(d){var c=(0,e.peekByte)()(d);return c===33||c===44})}],h=u;n.default=h}(mv)),mv}var fh={},c2;function B$(){if(c2)return fh;c2=1,Object.defineProperty(fh,"__esModule",{value:!0}),fh.deinterlace=void 0;var n=function(e,i){for(var r=new Array(e.length),o=e.length/i,s=function(f,g){var m=e.slice(g*i,(g+1)*i);r.splice.apply(r,[f*i,i].concat(m))},a=[0,4,2,1],l=[8,8,4,2],u=0,h=0;h<4;h++)for(var d=a[h];d<o;d+=l[h])s(d,u),u++;return r};return fh.deinterlace=n,fh}var gh={},f2;function P$(){if(f2)return gh;f2=1,Object.defineProperty(gh,"__esModule",{value:!0}),gh.lzw=void 0;var n=function(e,i,r){var o=4096,s=-1,a=r,l,u,h,d,c,f,g,A,m,p,_,v,T,S,E,x,b=new Array(r),C=new Array(o),y=new Array(o),w=new Array(o+1);for(v=e,u=1<<v,c=u+1,l=u+2,g=s,d=v+1,h=(1<<d)-1,m=0;m<u;m++)C[m]=0,y[m]=m;var _,A,T,S,x,E;for(_=A=T=S=x=E=0,p=0;p<a;){if(S===0){if(A<d){_+=i[E]<<A,A+=8,E++;continue}if(m=_&h,_>>=d,A-=d,m>l||m==c)break;if(m==u){d=v+1,h=(1<<d)-1,l=u+2,g=s;continue}if(g==s){w[S++]=y[m],g=m,T=m;continue}for(f=m,m==l&&(w[S++]=T,m=g);m>u;)w[S++]=y[m],m=C[m];T=y[m]&255,w[S++]=T,l<o&&(C[l]=g,y[l]=T,l++,(l&h)===0&&l<o&&(d++,h+=l)),g=f}S--,b[x++]=w[S],p++}for(p=x;p<a;p++)b[p]=0;return b};return gh.lzw=n,gh}var g2;function k$(){if(g2)return jo;g2=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.decompressFrames=jo.decompressFrame=jo.parseGIF=void 0;var n=o(M$()),t=qL(),e=XL(),i=B$(),r=P$();function o(h){return h&&h.__esModule?h:{default:h}}var s=function(d){var c=new Uint8Array(d);return(0,t.parse)((0,e.buildStream)(c),n.default)};jo.parseGIF=s;var a=function(d){for(var c=d.pixels.length,f=new Uint8ClampedArray(c*4),g=0;g<c;g++){var m=g*4,p=d.pixels[g],v=d.colorTable[p]||[0,0,0];f[m]=v[0],f[m+1]=v[1],f[m+2]=v[2],f[m+3]=p!==d.transparentIndex?255:0}return f},l=function(d,c,f){if(!d.image){console.warn("gif frame does not have associated image.");return}var g=d.image,m=g.descriptor.width*g.descriptor.height,p=(0,r.lzw)(g.data.minCodeSize,g.data.blocks,m);g.descriptor.lct.interlaced&&(p=(0,i.deinterlace)(p,g.descriptor.width));var v={pixels:p,dims:{top:d.image.descriptor.top,left:d.image.descriptor.left,width:d.image.descriptor.width,height:d.image.descriptor.height}};return g.descriptor.lct&&g.descriptor.lct.exists?v.colorTable=g.lct:v.colorTable=c,d.gce&&(v.delay=(d.gce.delay||10)*10,v.disposalType=d.gce.extras.disposal,d.gce.extras.transparentColorGiven&&(v.transparentIndex=d.gce.transparentColorIndex)),f&&(v.patch=a(v)),v};jo.decompressFrame=l;var u=function(d,c){return d.frames.filter(function(f){return f.image}).map(function(f){return l(f,d.gct,c)})};return jo.decompressFrames=u,jo}var p2=k$();const Io=kw();function Qg(){Qg.__loaded||(Qg.__loaded=!0,bj(),te.load(sj),te.load(Io?$G:rG))}Qg.__loaded=!1;const L$=Qg;function Jg(){Jg.__loaded||(Jg.__loaded=!0,_j(),te.load(hj),te.load(Io?l$:aG))}Jg.__loaded=!1;const YL=Jg;function tp(){tp.__loaded||(tp.__loaded=!0,Cj())}tp.__loaded=!1;const Yr=tp;function ep(){ep.__loaded||(ep.__loaded=!0,yj(),te.load(vj),te.load(Io?E$:uG))}ep.__loaded=!1;const Um=ep;function ip(){ip.__loaded||(ip.__loaded=!0,wj(),te.load(lj),te.load(Io?t$:fG))}ip.__loaded=!1;const Lw=ip;function rp(){rp.__loaded||(rp.__loaded=!0,Sj(),te.load(cj),te.load(Io?m$:yG))}rp.__loaded=!1;const D$=rp;function np(){np.__loaded||(np.__loaded=!0,xj(),te.load(fj),te.load(Io?C$:vG))}np.__loaded=!1;const I$=np;function op(){op.__loaded||(op.__loaded=!0,Tj(),te.load(aj),te.load(Io?KG:TG))}op.__loaded=!1;const bs=op;function sp(){sp.__loaded||(sp.__loaded=!0,Aj(),te.load(mj),te.load(Io?x$:AG))}sp.__loaded=!1;const Vm=sp;function ap(){ap.__loaded||(ap.__loaded=!0,Mj())}ap.__loaded=!1;const F$=ap;function lp(){lp.__loaded||(lp.__loaded=!0,Rj(),te.load(uj),te.load(Io?n$:BG))}lp.__loaded=!1;const zu=lp;function up(){up.__loaded||(up.__loaded=!0,Ej(),te.load(dj),te.load(Io?c$:kG))}up.__loaded=!1;const Fo=up;function hp(){hp.__loaded||(hp.__loaded=!0,Bj())}hp.__loaded=!1;const O$=hp;function KL(){Yr(),bs()}const ZL="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",H$=14;var Ir;(function(n){n.selected="selected",n.selectedReverse="selected_reverse",n.hover="hover",n.hoverReverse="hover_reverse"})(Ir||(Ir={}));const bl={[Ir.selectedReverse]:{},[Ir.selected]:{},[Ir.hover]:{},[Ir.hoverReverse]:{}},m2={container:"",width:30,height:30,style:{}},z$="scrollDown",N$="scrollDrag",W$="scrollUp";function Nh(){return De.env==="browser"?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}const v2={debounce:Dk,throttle:Ik};KL();class Qa extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Qa.defaultAttributes,t)),this.name="scrollbar",this._handleTouchMove=i=>{Et(this._prePos)&&i.preventDefault()},this._onRailPointerDown=i=>{const{viewX:r,viewY:o}=i,{direction:s,width:a,height:l,range:u}=this.attribute,h=this._sliderSize,[d,c]=this._getScrollRange();let f;if(s==="vertical"){const g=o-this._viewPosition.y,m=nn(g-h/2,d,c);f=g/l,this._slider.setAttribute("y",m,!0)}else{const g=r-this._viewPosition.x,m=nn(g-h/2,d,c);f=g/a,this._slider.setAttribute("x",m,!0)}this.setScrollRange([f-(u[1]-u[0])/2,f+(u[1]-u[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=i=>{this._clearDragEvents();const{stopSliderDownPropagation:r=!0}=this.attribute;r&&i.stopPropagation();const{direction:o}=this.attribute,{x:s,y:a}=this.stage.eventPointTransform(i);this._prePos=o==="horizontal"?s:a,this._dispatchEvent(z$,{pos:this._prePos,event:i});const l=Nh(),u=De.env==="browser"?De:this.stage;u.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),l.forEach(h=>{u.addEventListener(h,this._onSliderPointerUp)})},this._computeScrollValue=i=>{const{direction:r}=this.attribute,{x:o,y:s}=this.stage.eventPointTransform(i);let a,l,u=0;const{width:h,height:d}=this.getSliderRenderBounds();return r==="vertical"?(l=s,u=l-this._prePos,a=u/d):(l=o,u=l-this._prePos,a=u/h),[l,a]},this._onSliderPointerMove=i=>{const{stopSliderMovePropagation:r=!0}=this.attribute;r&&i.stopPropagation();const o=this.getScrollRange(),[s,a]=this._computeScrollValue(i);this.setScrollRange([o[0]+a,o[1]+a],!0),this._prePos=s},this._onSliderPointerMoveWithDelay=this.attribute.delayTime===0?this._onSliderPointerMove:v2[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=i=>{const{range:r,limitRange:o=[0,1]}=this.attribute,s=this.getScrollRange(),[a,l]=this._computeScrollValue(i),u=[s[0]+l,s[1]+l];this._prePos=null,this._dispatchEvent(W$,{pre:r,value:pa(u,o[0],o[1])}),this._clearDragEvents()}}setScrollRange(t,e=!0){const{direction:i="horizontal",limitRange:r=[0,1],range:o,realTime:s=!0}=this.attribute,a=pa(t,r[0],r[1]);if(e){const l=this._getSliderPos(a);if(this._slider){const u=l[1]-l[0];this._sliderSize=u,i==="horizontal"?this._slider.setAttributes({x:l[0],width:u},!0):this._slider.setAttributes({y:l[0],height:u},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=a,s&&this._dispatchEvent(N$,{pre:o,value:a})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;const{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",v2[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),(De.env==="browser"?De:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}render(){this._reset();const{direction:t="horizontal",width:e,height:i,range:r,limitRange:o=[0,1],railStyle:s,sliderStyle:a,padding:l=2}=this.attribute,u=this.createOrUpdateChild("scrollbar-container",{},"group"),h=u.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:e,height:i},s),"rect");this._rail=h;const d=this.getSliderRenderBounds(),c=this._getSliderPos(pa(r,o[0],o[1])),f=c[1]-c[0];let g;this._sliderSize=f,g=t==="horizontal"?{x:c[0],y:d.y1,width:f,height:d.height}:{x:d.x1,y:c[0],width:d.width,height:f};const m=u.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},g),{cornerRadius:this._getDefaultSliderCornerRadius()}),a),{boundsPadding:Bo(l),pickMode:"imprecise"}),"rect");this._slider=m,this._container=u;const p=this._container.AABBBounds;this._viewPosition={x:p.x1,y:p.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;const{width:t,height:e,padding:i=2}=this.attribute,[r,o,s,a]=Bo(i),l={x1:a,y1:r,x2:t-o,y2:e-s,width:Math.max(0,t-(a+o)),height:Math.max(0,e-(r+s))};return this._sliderRenderBounds=l,l}_getDefaultSliderCornerRadius(){const{direction:t,round:e}=this.attribute;if(e){const{width:i,height:r}=this.getSliderRenderBounds();return t==="horizontal"?r:i}return 0}_getSliderPos(t){const{direction:e}=this.attribute,{width:i,height:r,x1:o,y1:s}=this.getSliderRenderBounds();return e==="horizontal"?[i*t[0]+o,i*t[1]+o]:[r*t[0]+s,r*t[1]+s]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;const{limitRange:t=[0,1],direction:e}=this.attribute,[i,r]=pa(t,0,1),{width:o,height:s,x1:a,y1:l}=this.getSliderRenderBounds(),u=this._sliderSize;return e==="horizontal"?pa([a+i*o,a+r*o],a,o-u):pa([l+i*s,l+r*s],l,s-u)}_clearDragEvents(){const t=Nh(),e=De.env==="browser"?De:this.stage;e.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),t.forEach(i=>{e.removeEventListener(i,this._onSliderPointerUp)})}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}release(t){super.release(t),(De.env==="browser"?De:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}Qa.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};function Ja(n,t){n.forEachChildren(e=>{const i=t(e);e.isContainer&&!i&&Ja(e,t)})}function QL(n,t){return[n[0]*t,n[1]*t]}function JL(n){const[t,e]=n;return Math.sqrt(t*t+e*e)}function U$(n){let t=JL(n);return t>0&&(t=1/t),[n[0]*t,n[1]*t]}function V$(n,t){const[e,i]=n,[r,o]=t,s=Math.sqrt((e*e+i*i)*(r*r+o*o)),a=s&&(e*r+i*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function j$(n,t,e){const i=V$(n,t),r=e6(n,t)>=0;return e?r?2*Math.PI-i:i:r?i:2*Math.PI-i}const tD=(n,t,e,i)=>new ss(Object.assign({defaultFontParams:Object.assign({fontFamily:ZL,fontSize:H$},i),getTextBounds:zm,specialCharSet:`-/: .,@%'"~`+ss.ALPHABET_CHAR_SET+ss.ALPHABET_CHAR_SET.toUpperCase()},{}),n);function jm(n,t,e={}){if(!n)return{width:0,height:0};const i=zm({text:n,fontFamily:t.fontFamily||e.fontFamily||ZL,fontSize:t.fontSize||e.fontSize||12,fontWeight:t.fontWeight||e.fontWeight,textAlign:t.textAlign||"center",textBaseline:t.textBaseline,ellipsis:!!t.ellipsis,maxLineWidth:t.maxLineWidth||1/0,lineHeight:t.fontSize||e.fontSize||12});return{width:i.width(),height:i.height()}}function G$(n,t="type"){return eD(n,t)==="rich"}function eD(n,t="type"){var e,i;return $i(n.text)&&"type"in n.text?(e=n.text.type)!==null&&e!==void 0?e:"text":t in n&&(i=n[t])!==null&&i!==void 0?i:"text"}function iD(n){var t,e;return Et(n.maxLineWidth)&&(n.maxWidth=n.maxLineWidth,delete n.maxLineWidth),n.width=(t=n.width)!==null&&t!==void 0?t:0,n.height=(e=n.height)!==null&&e!==void 0?e:0,n.textConfig=n.text.text||n.text,n}function $$(n){const{text:t,_originText:e}=n,{text:i}=t;return n.html=i,n.text=e,n.renderable=!1,n}function q$(n){const{text:t,_originText:e}=n,{text:i}=t;return n.react=i,n.text=e,n.renderable=!1,n}function LC(n,t="type"){const e=eD(n,t);return e==="rich"?$t.richtext(iD(n)):(e==="html"?n=$$(n):e==="react"&&(n=q$(n)),$t.text(n))}function rD(){Yr(),bs(),zu(),Vm(),Fo()}var b2=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};rD();class Gs extends gn{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Gs.defaultAttributes,t)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var t,e,i;this.cacheStates();const{text:r="",textStyle:o={},shape:s={},panel:a={},space:l=4,minWidth:u,maxWidth:h,padding:d=4,visible:c,state:f,type:g,textAlwaysCenter:m,containerTextAlign:p}=this.attribute,v=Bo(d),b=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group");let C,y=-v[3],w=-v[0],_=v[1]+v[3],A=v[0]+v[2],T=0,S=0;const{visible:x}=s,E=b2(s,["visible"]);if(cs(x)){const J=(E==null?void 0:E.size)||10,st=ne(J)?J:Math.max(J[0],J[1]);C=b.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:J,strokeBoundsBuffer:0},E),{visible:x,x:st/2,y:st/2}),"symbol"),We(f==null?void 0:f.shape)||(C.states=f.shape),x&&(S=st+l)}let M,L,I;if(_+=S,T+=S,G$({text:r})||g==="rich"){const J=Object.assign(Object.assign(Object.assign({},iD(Object.assign({type:g,text:r},o))),o),{visible:Et(r)&&c!==!1,x:T,y:0});zt(J.lineHeight)&&(J.lineHeight=o.fontSize),M=b.createOrUpdateChild("tag-text",J,"richtext"),L=M.AABBBounds.width(),I=M.AABBBounds.height()}else{const J=Object.assign(Object.assign({text:$i(r)&&"type"in r&&r.type==="text"?r.text:r,visible:Et(r)&&c!==!1,lineHeight:o==null?void 0:o.fontSize},o),{x:T,y:0});zt(J.lineHeight)&&(J.lineHeight=o.fontSize),M=b.createOrUpdateChild("tag-text",J,"text");const st=jm(J.text,o,(e=(t=this.stage)===null||t===void 0?void 0:t.getTheme())===null||e===void 0?void 0:e.text);L=st.width,I=st.height}_+=L;const D=(i=s.size)!==null&&i!==void 0?i:10,H=ne(D)?D:Math.max(D[0],D[1]);A+=Math.max(I,s.visible?H:0);const{textAlign:O,textBaseline:N}=o;(Et(u)||Et(h))&&(Et(u)&&_<u&&(_=u),Et(h)&&_>h&&(_=h,M.setAttribute("maxLineWidth",h-v[1]-v[2]))),y=0,w=0;let U=0;O==="left"||O==="start"?U=1:O==="right"||O==="end"?U=-1:O==="center"&&(U=0),U?U<0?(y-=_,C&&C.setAttribute("x",(C.attribute.x||0)-L),b.setAttribute("x",-v[1]-S)):U>0&&b.setAttribute("x",v[3]):(y-=_/2,C&&C.setAttribute("x",(C.attribute.x||0)-L/2),b.setAttribute("x",-S/2));const W=p==="right"||p==="end",j=p==="left"||p==="start",Y=(J,st)=>{M.type==="richtext"?M.setAttributes({x:J,textAlign:st,textConfig:sg(M.attribute.textConfig).map(ht=>Object.assign(Object.assign({},ht),{textAlign:st}))}):M.setAttributes({x:J,textAlign:st})};if((p?p==="center":m)&&U){const J=_-v[1]-v[3],st=L+S,ht=U===1?(J-st)/2+S+L/2:v[0]+S-(_/2+st/2-S)+L/2;if(Y(ht,"center"),C){const at=ht-L/2-S+H/2;C.setAttributes({x:at})}}if(j&&U!==1){const J=_-v[1]-v[3],st=U===0?-J/2+S/2:-_+v[3]+v[1]+S;if(Y(st+S,"left"),C){const ht=st+H/2;C.setAttributes({x:ht})}}if(W&&U!==-1){const J=_-v[1]-v[3],st=U===0?J/2+S/2:J;if(Y(st,"right"),C){const ht=st-L-S+H/2;C.setAttributes({x:ht})}}N==="middle"?(w-=A/2,C&&C.setAttribute("y",0)):N==="bottom"?(w-=A,C&&C.setAttribute("y",-I/2),b.setAttribute("y",-v[2])):N==="top"&&(b.setAttribute("y",v[0]),C&&C.setAttribute("y",I/2)),We(f==null?void 0:f.text)||(M.states=f.text);const{visible:Z}=a,rt=b2(a,["visible"]);if(c&&cs(Z)){const J=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},rt),{visible:Z&&!!r,width:_,height:A,x:y,y:w}),"rect");if(We(f==null?void 0:f.panel)||(J.states=f.panel),rt.customShape){const st=rt.customShape;J.pathProxy=ht=>st(this,ht,new Fi)}this._bgRect=J}this._textShape=M,this._symbol=C,this.resetStates()}initAttributes(t,e){t=e!=null&&e.skipDefault?t:Jt({},Gs.defaultAttributes,t),super.initAttributes(t),this.render()}addState(t,e,i){super.addState(t,e,i),this._textShape&&this._textShape.addState(t,e,i),this._bgRect&&this._bgRect.addState(t,e,i),this._symbol&&this._symbol.addState(t,e,i)}removeState(t,e){super.removeState(t,e),this._textShape&&this._textShape.removeState(t,e),this._bgRect&&this._bgRect.removeState(t,e),this._symbol&&this._symbol.removeState(t,e)}cacheStates(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g;this._tagStates=(e=(t=this.currentStates)===null||t===void 0?void 0:t.slice())!==null&&e!==void 0?e:[],this._rectStates=(o=(r=(i=this._bgRect)===null||i===void 0?void 0:i.currentStates)===null||r===void 0?void 0:r.slice())!==null&&o!==void 0?o:[],this._symbolStates=(l=(a=(s=this._symbol)===null||s===void 0?void 0:s.currentStates)===null||a===void 0?void 0:a.slice())!==null&&l!==void 0?l:[],this._textStates=(d=(h=(u=this._textShape)===null||u===void 0?void 0:u.currentStates)===null||h===void 0?void 0:h.slice())!==null&&d!==void 0?d:[],this.clearStates(),(c=this._bgRect)===null||c===void 0||c.clearStates(),(f=this._symbol)===null||f===void 0||f.clearStates(),(g=this._textShape)===null||g===void 0||g.clearStates()}resetStates(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&((t=this._bgRect)===null||t===void 0||t.useStates(this._rectStates)),this._symbolStates.length&&((e=this._symbol)===null||e===void 0||e.useStates(this._symbolStates)),this._textStates.length&&((i=this._textShape)===null||i===void 0||i.useStates(this._textStates))}}Gs.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};const nD={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},oD={poptip:Jt({},nD)};function X$(){Yr(),Fo(),zu(),bs()}function Y$(n){Jt(oD.poptip,nD,n)}var K$=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const _2=new Ye;X$();const C2="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",y2="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",w2="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",S2="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",Z$={tl:C2,tr:w2,bl:y2,br:S2,lt:C2,lb:y2,rt:w2,rb:S2};class Sd extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Sd.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,i,r,o,s,a,l,u;const{titleStyle:h={},position:d,contentStyle:c={},panel:f,logoSymbol:g,poptipAnchor:m="position",logoText:p,logoTextStyle:v={},triangleMode:b="default",space:C=4,minWidth:y=0,maxWidth:w=1/0,padding:_=4,maxWidthPercent:A,visible:T,state:S,dx:x=0,dy:E=0,positionBounds:M}=this.attribute;let{title:L="",content:I=""}=this.attribute;L=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(L):L,I=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(I):I;const D=Bo(_),H=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=H;const O=w-D[1]-D[3],N=Et(L)&&T!==!1,U=Object.assign(Object.assign({text:jt(L)?L:[L],visible:N,wrap:!0},h),{x:D[3],y:D[0],maxLineWidth:O,textAlign:"left",textBaseline:"top"}),W=H.createOrUpdateChild("poptip-title",U,"text");We(S==null?void 0:S.title)||(W.states=S.title);const j=W.AABBBounds,Y=j.height(),Z=j.width();let rt=Y+C;N||(rt=0);const J=Et(I)&&T!==!1,st=Object.assign(Object.assign({text:jt(I)?I:[I],visible:J,wrap:!0},c),{x:D[3],y:D[0]+rt,maxLineWidth:O,textAlign:"left",textBaseline:"top"}),ht=H.createOrUpdateChild("poptip-content",st,"text");We(S==null?void 0:S.content)||(ht.states=S.content);const at=ht.AABBBounds,lt=at.height(),_t=at.width();J&&(rt+=lt),this.titleShape=W,this.contentShape=ht;let vt=un(Z+D[1]+D[3],_t+D[1]+D[3]);vt>w?vt=w:vt<y&&(vt=y);let yt=D[0]+D[2]+rt;const{visible:mt,square:ft}=f,Ft=K$(f,["visible","square"]);if(ft){const gt=un(vt,yt);vt=gt;const Ht=gt-yt;yt=gt,W.setAttributes({dy:Ht/2}),ht.setAttributes({dy:Ht/2})}const St=(t=Ft.size)!==null&&t!==void 0?t:12,Kt=jt(St)?[St[0]+((e=Ft.space)!==null&&e!==void 0?e:0),St[1]+((i=Ft.space)!==null&&i!==void 0?i:0)]:St+((r=Ft.space)!==null&&r!==void 0?r:0),At=(o=Ft.lineWidth)!==null&&o!==void 0?o:1,Pt=this.stage?[(s=this.stage.viewWidth)!==null&&s!==void 0?s:this.stage.width,(a=this.stage.viewHeight)!==null&&a!==void 0?a:this.stage.height]:void 0;if(Pt){const gt=this.AABBBounds,Ht=(l=this.attribute.x)!==null&&l!==void 0?l:gt.x1,bt=Pt[0]-gt.x1;let Fe=Math.max(Ht,bt);const hi=(jt(St)?St[0]:12)+3;if(Fe=Math.min(Fe-hi,Fe*A),Fe<vt){vt=Fe;const le=D[1]+D[3];W.setAttribute("maxLineWidth",Fe-le),ht.setAttribute("maxLineWidth",Fe-le),yt=D[0]+D[2],N&&(yt+=W.AABBBounds.height()+C),yt+=ht.AABBBounds.height()}}const Bt=d==="auto"||jt(d),It=jt(d)?d:this.positionList;let Ot,qt=-1/0;for(let gt=0;gt<It.length+1;gt++){const Ht=Bt?It[gt===It.length?Ot:gt]:d;let bt="arrow2Left",Fe=(jt(St)?St[0]:St)/4,hi=0;Ht==="top"||Ht==="bottom"||Ht==="left"||Ht==="right"?bt="arrow2Left":b==="concise"&&(bt=Z$[Ht],Fe=["tl","bl","rt","rb"].includes(Ht)?(jt(St)?St[0]:St)/2:-(jt(St)?St[0]:St)/2,hi=["tl","tr","lb","rb"].includes(Ht)?-(jt(St)?St[1]:St)/2:(jt(St)?St[1]:St)/2);const{angle:le,offset:Ci}=this.getAngleAndOffset(Ht,vt,yt,jt(Kt)?Kt:[Kt,Kt-At],bt);let se,vr={x:0,y:0};if(m==="bounds"&&M&&(vr=this.calculateAnchorPoint(Ht,M)),cs(mt)){let Re;se=H.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},Ft),{visible:mt&&(J||N),x:Fe,y:hi,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:bt,angle:le,dx:Ci[0],dy:Ci[1]-((u=Ft.space)!==null&&u!==void 0?u:0),size:St,zIndex:9}),"symbol"),We(S==null?void 0:S.panel)||(se.states=S.panel),Re=f.panelSymbolType?H.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},Ft),{visible:mt&&(J||N),x:0,y:0,symbolType:"rect",size:[vt,yt],zIndex:-8}),"symbol"):H.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},Ft),{visible:mt&&(J||N),x:0,y:0,width:vt,height:yt,zIndex:-8}),"rect"),We(S==null?void 0:S.panel)||(Re.states=S.panel)}if(H.setAttributes({x:-Ci[0]+x+vr.x,y:-Ci[1]+E+vr.y,anchor:[Fe,hi]}),g){const{size:Re=12}=g,Ke=jt(Re)?Re:[Re,Re];Ke[1]==="auto"&&(Ke[1]=yt),Ke[0]==="auto"&&(Ke[0]=yt);const yi=Ke[0];H.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},g),{x:0,y:yt/2,visible:mt&&(J||N),zIndex:10,size:Ke}),"symbol"),H.setAttributes({x:-Ci[0]+x+yi/2,y:-Ci[1]+E}),p&&H.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},v),{x:0,y:yt/2,visible:mt&&(J||N),text:p,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!Pt)break;{_2.setValue(0,0,vt,yt).transformWithMatrix(H.globalTransMatrix);const Re=_2,Ke=new pu().setValue(0,0,Pt[0],Pt[1]);if(Bt){if(s6(Re,Ke))break;{const yi=Fk(Re,Ke),wi=(yi.x2-yi.x1)*(yi.y2-yi.y1);wi>qt&&(qt=wi,Ot=gt)}}if(["top","bottom","left","right"].includes(Ht)){const yi=Ht==="top"||Ht==="bottom",wi=Ht==="left"||Ht==="right";let zi=!1;if(yi?zi=Ht==="top"&&Re.y1<0||Ht==="bottom"&&Re.y2>Ke.y2:wi&&(zi=Ht==="left"&&Re.x1<0||Ht==="right"&&Re.x2>Ke.x2),!zi){let br=0;const ur=(jt(St)?St[1]:St)/2;yi?(Re.x1<0?br=-Re.x1:Re.x2>Ke.x2&&(br=Ke.x2-Re.x2),H.setAttribute("x",H.attribute.x+br),se.setAttribute("dx",ki(un(se.attribute.dx-br,ur),Re.width()-ur))):wi&&(Re.y1<0?br=-Re.y1:Re.y2>Ke.y2&&(br=Ke.y2-Re.y2),H.setAttribute("y",H.attribute.y+br),se.setAttribute("dy",ki(un(se.attribute.dy-br,ur),Re.height()-ur)));break}}if(!Bt)break}}}calculateAnchorPoint(t,e){if(!e)return{x:0,y:0};const{x:i,y:r}=this.attribute,{x1:o,y1:s,x2:a,y2:l}=e,u=a-o,h=l-s;switch(t){case"top":case"tl":case"tr":return{x:o+u/2-i,y:s-r};case"bottom":case"bl":case"br":return{x:o+u/2-i,y:l-r};case"left":case"lt":case"lb":return{x:o-i,y:s+h/2-r};case"right":case"rt":case"rb":return{x:a-i,y:s+h/2-r};default:return{x:0,y:0}}}getAngleAndOffset(t,e,i,r,o){const s=o==="arrow2Left"?r[1]/2:r[1];switch(t){case"tl":return{angle:o==="arrow2Left"?Ae/2*3:0,offset:o==="arrow2Left"?[e/4,i+s]:[0,i+s]};case"top":return{angle:Ae/2*3,offset:[e/2,i+s]};case"tr":return{angle:o==="arrow2Left"?Ae/2*3:0,offset:o==="arrow2Left"?[e/4*3,i+s]:[e,i+s]};case"rt":return{angle:0,offset:o==="arrow2Left"?[-s,i/5]:[-s,0]};case"right":return{angle:0,offset:[-s,i/2]};case"rb":return{angle:0,offset:o==="arrow2Left"?[-s,i/5*4]:[-s,i]};case"bl":return{angle:o==="arrow2Left"?Ae/2:0,offset:o==="arrow2Left"?[e/4,-s]:[0,-s]};case"bottom":return{angle:Ae/2,offset:[e/2,-s]};case"br":return{angle:o==="arrow2Left"?Ae/2:0,offset:o==="arrow2Left"?[e/4*3,-s]:[e,-s]};case"lt":return{angle:o==="arrow2Left"?Ae:0,offset:o==="arrow2Left"?[e+s,i/5]:[e+s,0]};case"left":return{angle:Ae,offset:[e+s,i/2]};case"lb":return{angle:o==="arrow2Left"?Ae:0,offset:o==="arrow2Left"?[e+s,i/5*4]:[e+s,i]}}}}Sd.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var Q$=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};function J$(n,t){return Jt(n,oD.poptip,t),n}let Wh=class{render(n,t,e,i,r,o,s,a,l,u,h,d,c){var f,g;if(n._showPoptip===1){const{visible:m,visibleCb:p}=n.attribute.poptip||{};if(m===!1||p&&p(n)===!1)return;const v={};Jt(v,Sd.defaultAttributes,n.attribute.poptip?n.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(v):this.poptipComponent=new Sd(v);let b=n.attribute.poptip||{};if(n.type==="text"&&b.title==null&&b.content==null){const w={};J$(w,b),b=w,b.content=(f=b.content)!==null&&f!==void 0?f:n.attribute.text}const C=n.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},b),{x:C.e,y:C.f,positionBounds:n.globalAABBBounds})),u.stage.tryInitInteractiveLayer();const y=u.stage.getLayer("_builtin_interactive");y&&y.add(this.poptipComponent)}else n._showPoptip===2&&(n._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),(g=this.poptipComponent.parent)===null||g===void 0||g.removeChild(this.poptipComponent),this.poptipComponent=null))}};Wh=Q$([Tt()],Wh);var sD=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class aD{constructor(){this.activeEvent="onRegister",this._uid=bi.GenAutoIncrementId(),this.poptip=t=>{const e=t.target;this.needHide(e)?this.unpoptip(t):e!==this.activeGraphic&&(this.needShow(e)&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0))},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;const{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}needHide(t){return t.isContainer||!t.attribute}needShow(t){return!!t.attribute.poptip}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){const{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}}let Uh=class extends aD{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};Uh=sD([Tt()],Uh);let Vh=class extends aD{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=n=>{const{stage:t}=this.pluginService;n.target===t&&this.unpoptip(n)}}activate(n){super.activate(n);const{stage:t}=this.pluginService;t.addEventListener("pointerleave",this.pointerlave)}needHide(n){return n.type!=="text"||!n.cliped||n.isContainer||!n.attribute||n.attribute.disableAutoClipedPoptip}needShow(n){return!0}deactivate(n){const{stage:t}=this.pluginService;super.deactivate(n),t.removeEventListener("pointerleave",this.pointerlave)}};Vh=sD([Tt()],Vh);const tq=new ie((n,t,e,i)=>{e(Wh)||(n(Wh).toSelf().inSingletonScope(),n(Rw).toService(Wh)),e(Uh)||(n(Uh).toSelf(),n(yd).toService(Uh)),e(Vh)||(n(Vh).toSelf(),n(yd).toService(Vh))});function eq(){te.load(tq)}function iq(){Yr(),Lw(),I$(),zu()}iq();class Gm extends gn{getStartAngle(){return Lx(this._startAngle)}getEndAngle(){return Lx(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Gm.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();const{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:o=!0,multiSegment:s,mainSegmentIndex:a}=this.attribute;if(!o)return;this._computeLineAngle();const l=this._getMainSegmentPoints(),u=this._renderSymbol(t,l,"start"),h=this._renderSymbol(e,l,"end");if(this.startSymbol=u,this.endSymbol=h,s){const d=[...this.attribute.points];if(Ne(a))d[a]=this._clipPoints(d[a]);else{const c=this._clipPoints(w_(d));d[0][0]=c[0],d[d.length-1][d[d.length-1].length-1]=c[c.length-1]}d.forEach((c,f)=>{var g,m;const p=$t.line(Object.assign(Object.assign({points:c},jt(i)?(g=i[f])!==null&&g!==void 0?g:i[i.length-1]:i),{fill:!1}));p.name=`${this.name}-line`,p.id=this._getNodeId("line"+f),We(r==null?void 0:r.line)||(p.states=jt(r.line)?(m=r.line[f])!==null&&m!==void 0?m:r.line[r.line.length-1]:r.line),this.add(p),this.lines.push(p)})}else{let d=$t.line;sg(i)[0].cornerRadius&&(d=$t.polygon);const c=d(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},sg(i)[0]),{fill:!1,closePath:!1}));c.name=`${this.name}-line`,c.id=this._getNodeId("line"),We(r==null?void 0:r.line)||(c.states=[].concat(r.line)[0]),this.add(c),this.lines.push(c)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,i){if(!e.length)return;const{autoRotate:r=!0}=t;let o;if(t&&t.visible){const s=this.getStartAngle(),a=this.getEndAngle(),{state:l}=this.attribute,u=e[0],h=e[e.length-1],{refX:d=0,refY:c=0,refAngle:f=0,style:g,symbolType:m,size:p=12}=t;let v,b;i==="start"?(v={x:u.x+(Ne(s)?d*Math.cos(s)+c*Math.cos(s-Math.PI/2):0),y:u.y+(Ne(s)?d*Math.sin(s)+c*Math.sin(s-Math.PI/2):0)},b=this._computeStartRotate(this._startAngle)):(v={x:h.x+(Ne(a)?d*Math.cos(a)+c*Math.cos(a-Math.PI/2):0),y:h.y+(Ne(a)?d*Math.sin(a)+c*Math.sin(a-Math.PI/2):0)},b=this._computeEndRotate(this._endAngle)),o=$t.symbol(Object.assign(Object.assign(Object.assign({},v),{symbolType:m,size:p,angle:r?b+f:0,strokeBoundsBuffer:0}),g)),o.name=`${this.name}-${i}-symbol`,o.id=this._getNodeId(`${i}-symbol`),We(l==null?void 0:l.symbol)||(o.states=l.symbol),i==="start"?We(l==null?void 0:l.startSymbol)||(o.states=l.startSymbol):We(l==null?void 0:l.endSymbol)||(o.states=l.endSymbol),this.add(o)}return o}_getMainSegmentPoints(){if(this._mainSegmentPoints)return this._mainSegmentPoints;const{points:t,multiSegment:e,mainSegmentIndex:i}=this.attribute;let r;return r=e?Ne(i)?t[i]:w_(t):t,this._mainSegmentPoints=r,r}_clipPoints(t){const{startSymbol:e={},endSymbol:i={}}=this.attribute;let r=t;if(e.visible){const o=e.clip?e.size||10:0;r=[{x:t[0].x-o/2*(Math.cos(this._startAngle)||0),y:t[0].y-o/2*(Math.sin(this._startAngle)||0)},...r.slice(1)]}if(i.visible){const o=i.clip?i.size||10:0,s={x:t[t.length-1].x-o/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-o/2*(Math.sin(this._endAngle)||0)};r=[...r.slice(0,r.length-1),s]}return r}_computeLineAngle(){const t=this._getMainSegmentPoints();if(t.length<=1)return;const e=t[0],i=t[1],r=t[t.length-2],o=t[t.length-1],s=[e.x-i.x,e.y-i.y],a=Math.atan2(s[1],s[0]),l=[o.x-r.x,o.y-r.y],u=Math.atan2(l[1],l[0]);this._startAngle=a,this._endAngle=u}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}Gm.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}};var rr;(function(n){n.innerView="inner-view",n.axisContainer="axis-container",n.labelContainer="axis-label-container",n.tickContainer="axis-tick-container",n.tick="axis-tick",n.subTick="axis-sub-tick",n.label="axis-label",n.title="axis-title",n.gridContainer="axis-grid-container",n.grid="axis-grid",n.gridRegion="axis-grid-region",n.line="axis-line",n.background="axis-background",n.axisLabelBackground="axis-label-background",n.axisBreak="axis-break",n.axisBreakSymbol="axis-break-symbol"})(rr||(rr={}));var zl;(function(n){n.selected="selected",n.selectedReverse="selected_reverse",n.hover="hover",n.hoverReverse="hover_reverse"})(zl||(zl={}));const _l={[zl.selectedReverse]:{},[zl.selected]:{},[zl.hover]:{},[zl.hoverReverse]:{}},rq=999,DC={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},x2={size:8,stroke:"#000",lineWidth:1,zIndex:1};function nq(n){const t=n.AABBBounds;return{x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,centerX:n.attribute.x,centerY:n.attribute.y,angle:n.attribute.angle}}function oq(n){n.forEach(t=>{if(t.rotatedBounds||!t.attribute.angle)return;const e=nq(t),i=Ro({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),r=i.x-e.centerX,o=i.y-e.centerY;e.x1+=r,e.x2+=r,e.y1+=o,e.y2+=o,e.centerX+=r,e.centerY+=o,t.rotatedBounds=e})}function sq(n,t){var e,i;return!((e=n.OBBBounds)===null||e===void 0)&&e.empty()||!((i=t.OBBBounds)===null||i===void 0)&&i.empty()?S_(n.AABBBounds,t.AABBBounds)&&(!n.rotatedBounds||!t.rotatedBounds||Hk(n.rotatedBounds,t.rotatedBounds,!0)):n.OBBBounds.intersects(t.OBBBounds)}const lD=Math.sin(Math.PI/10);function uD(n,t=lD){const e=!zt(n)&&n!==0,i=e?Math.cos(n):1;return e&&Math.abs(i)<=t}function Dw(n,t=lD){const e=!zt(n)&&n!==0,i=e?Math.sin(n):0;return!e||Math.abs(i)<=t}function aq(n,t){return{x:n.x+t[0],y:n.y+t[1]}}function lq(n={}){var t,e;const{style:i={},angle:r=.5*Math.PI}=n,o=Jt({},x2,i),s=(t=o.size)!==null&&t!==void 0?t:x2.size;return Object.assign(Object.assign({},o),{symbolType:(e=o.symbolType)!==null&&e!==void 0?e:`M ${-s/2} ${s*Math.sin(r)} L ${s/2} ${-s*Math.sin(r)}`,symbolSize:s})}function uq(n){const t={};return Ja(n,e=>{e.type!=="group"&&e.id&&(t[e.id]=e)}),t}function hD(n,t){return{x:n.x+t[0],y:n.y+t[1]}}function T2(n,t,e,i=!1,r=!1){const o=[t.x-e.x,t.y-e.y];return QL(o,(i?-1:1)*(r?-1:1)*n/JL(o))}function hq(n,t,e,i,r){const o=o6({x:0,y:0},e,n),s=hD(o,T2(i,o,t,r));return aq(s,T2(i||1,s,t,r))}function Yn(n,t,e){var i;const r=(i=n.attribute)===null||i===void 0?void 0:i.angle;if(Dw(r,Number.EPSILON))return e>Fx(n.AABBBounds,t.AABBBounds);const o=n.OBBBounds,s=t.OBBBounds;return!o||!s||o.empty()||s.empty()?e>Fx(n.AABBBounds,t.AABBBounds):o.intersects(s)||e>a6(o,s)}function IC(n,t){for(let e,i=1,r=n.length,o=n[0];i<r;o=e,++i)if(e=n[i],Yn(o,e,t))return!0;return!1}const dq=(n,t,e)=>{const i=n.target;return i!==e&&i.name&&!We(i.states)?(i.addState(Ir.hover,!0),Ja(t,r=>{r!==i&&r.name&&!We(r.states)&&r.addState(Ir.hoverReverse,!0)}),i):e},cq=(n,t,e)=>e&&(Ja(t,i=>{i.name&&!We(i.states)&&(i.removeState(Ir.hoverReverse),i.removeState(Ir.hover))}),null),fq=(n,t,e)=>{const i=n.target;return e===i&&i.hasState(Ir.selected)?(Ja(t,r=>{r.name&&!We(r.states)&&(r.removeState(Ir.selectedReverse),r.removeState(Ir.selected))}),null):i.name&&!We(i.states)?(i.addState(Ir.selected,!0),Ja(t,r=>{r!==i&&r.name&&!We(r.states)&&r.addState(Ir.selectedReverse,!0)}),i):e};class gq extends gn{_prepareAnimate(t){if(this.attribute.animation!==!1){const{animation:e,animationEnter:i,animationExit:r,animationUpdate:o}=this.attribute,s=$i(e)?e:{};this._animationConfig={enter:i!==!1&&Jt({},t,s,i??{}),exit:r!==!1&&Jt({},t,s,r??{}),update:o!==!1&&(jt(o)?o:Jt({},t,s,o??{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}const pq={type:"default",duration:300,easing:"linear"};class mq extends gq{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=dq(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=cq(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=fq(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){const e=Mk(this.attribute);e.scale=this.attribute.scale,this.attribute=t;const i=$t.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}render(){this._prepare(),this._prevInnerView=this._innerView&&uq(this._innerView),this.removeAllChild(!0),this._innerView=$t.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}_prepare(){this._prepareAnimate(pq)}_bindEvent(){if(this.attribute.disableTriggerEvent)return;const{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){const{title:e,label:i,tick:r,line:o,items:s}=this.attribute,a=$t.group({x:0,y:0,zIndex:1,pickable:!1});if(a.name=rr.axisContainer,a.id=this._getNodeId("container"),a.setMode(this.mode),this.axisContainer=a,t.add(a),o&&o.visible&&this.renderLine(a),s&&s.length&&(this.data=this._transformItems(s[0]),r&&r.visible&&this.renderTicks(a),i&&i.visible)){const l=$t.group({x:0,y:0,pickable:!1});l.name=rr.labelContainer,l.id=this._getNodeId("label-container"),this.axisLabelsContainer=l,a.add(l),s.forEach((u,h)=>{const d=this.renderLabels(l,u,h),c=d.getChildren();this.beforeLabelsOverlap(c,u,d,h,s.length),this.handleLabelsOverlap(c,u,d,h,s.length),this.afterLabelsOverlap(c,u,d,h,s.length);let f=0,g=0,m="center",p="middle",v=0;c.forEach((b,C)=>{var y;const w=b.attribute,_=(y=w.angle)!==null&&y!==void 0?y:0,A=b.AABBBounds;let T=A.width(),S=A.height();_&&(T=Math.abs(T*Math.cos(_)),S=Math.abs(S*Math.sin(_))),f=Math.max(f,T),g=Math.max(g,S),m=w.textAlign,p=w.textBaseline,C===0&&(v=w.x)}),this.axisLabelLayerSize[h]={width:f,height:g,labelPos:v,textAlign:m,textBaseline:p}})}e&&e.visible&&this.renderTitle(a)}renderTicks(t){const e=this.getTickLineItems(),i=$t.group({x:0,y:0,pickable:!1});i.name=rr.tickContainer,i.id=this._getNodeId("tick-container"),t.add(i),e.forEach((o,s)=>{var a;const l=$t.line(Object.assign({},this._getTickLineAttribute("tick",o,s,e)));if(l.name=rr.tick,l.id=this._getNodeId(o.id),We((a=this.attribute.tick)===null||a===void 0?void 0:a.state))l.states=bl;else{const u=this.data[s],h=Jt({},bl,this.attribute.tick.state);Object.keys(h).forEach(d=>{Ce(h[d])&&(h[d]=h[d](u.rawValue,s,u,this.data))}),l.states=h}i.add(l)}),this.tickLineItems=e;const{subTick:r}=this.attribute;if(r&&r.visible){const o=this.getSubTickLineItems();o.length&&o.forEach((s,a)=>{const l=$t.line(Object.assign({},this._getTickLineAttribute("subTick",s,a,e)));if(l.name=rr.subTick,l.id=this._getNodeId(`${a}`),We(r.state))l.states=bl;else{const u=Jt({},bl,r.state);Object.keys(u).forEach(h=>{Ce(u[h])&&(u[h]=u[h](s.value,a,s,e))}),l.states=u}i.add(l)}),this.subTickLineItems=o}}renderLabels(t,e,i){const{dataFilter:r}=this.attribute.label;r&&Ce(r)&&(e=r(e,i));const o=this._transformItems(e),s=$t.group({x:0,y:0,pickable:!1});return s.name=`${rr.labelContainer}-layer-${i}`,s.id=this._getNodeId(`label-container-layer-${i}`),t.add(s),o.forEach((a,l)=>{var u;const h=this._getLabelAttribute(a,l,o,i),d=LC(h);if(d.name=rr.label,d.id=this._getNodeId(`layer${i}-label-${a.id}`),We((u=this.attribute.label)===null||u===void 0?void 0:u.state))d.states=bl;else{const c=Jt({},bl,this.attribute.label.state);Object.keys(c).forEach(f=>{Ce(c[f])&&(c[f]=c[f](a,l,o,i))}),d.states=c}d.data=Object.assign(Object.assign({},a),{index:l,layer:i}),s.add(d)}),s}renderTitle(t){const e=this.getTitleAttribute(),i=new Gs(Object.assign({},e));i.name=rr.title,i.id=this._getNodeId("title"),t.add(i)}getVerticalCoord(t,e,i){return hD(t,this.getVerticalVector(e,i,t))}getTickLineItems(){const{tick:t}=this.attribute,e=this.data,i=[],{alignWithLabel:r,inside:o=!1,length:s,dataFilter:a}=t;let l=1;return e.length>=2&&(l=e[1].value-e[0].value),(a&&Ce(a)?a(e):e).forEach(u=>{let h=u.point,d=u.value;if(!r){const f=u.value-l/2;if(this.isInValidValue(f))return;h=this.getTickCoord(f),d=f}const c=this.getVerticalCoord(h,s,o);if(this.mode==="3d"){const f=this.getVerticalVector(s,o,h);let g=0,m=0;Se(f[0])>Se(f[1])?g=Ae/2*(c.x>h.x?1:-1):m=Ae/2*(c.y>h.y?-1:1),i.push({start:h,end:c,value:d,id:`tick-${u.id}`,anchor:[h.x,h.y],alpha:g,beta:m})}else i.push({start:h,end:c,value:d,id:`tick-${u.id}`})}),i}getSubTickLineItems(){const{subTick:t}=this.attribute,e=[],{count:i=4,inside:r=!1,length:o=2}=t,s=this.tickLineItems,a=s.length;if(a>=2)for(let l=0;l<a-1;l++){const u=s[l],h=s[l+1];for(let d=0;d<i;d++){const c=(d+1)/(i+1),f=(1-c)*u.value+c*h.value,g=this.getTickCoord(f),m=this.getVerticalCoord(g,o,r);e.push({start:g,end:m,value:f,id:`sub-tick-${f}`})}}return e}_getTickLineAttribute(t,e,i,r){let o=Rr(this.attribute,`${t}.style`);const s=this.data[i];o=Ce(o)?Jt({},Rr(DC,`${t}.style`),t==="tick"?o(s.rawValue,i,s,this.data):o(e.value,i,e,r)):o;const{start:a,end:l,anchor:u,alpha:h,beta:d}=e;return Object.assign({points:[a,l],anchor:u,alpha:h,beta:d},o)}_getLabelAttribute(t,e,i,r){var o,s;const{space:a=4,inside:l=!1,formatMethod:u,type:h="text",text:d}=this.attribute.label;let c=a,f=0;!((o=this.attribute.tick)===null||o===void 0)&&o.visible&&this.attribute.tick.inside===l&&(f=this.attribute.tick.length||4),!((s=this.attribute.subTick)===null||s===void 0)&&s.visible&&this.attribute.subTick.inside===l&&(f=Math.max(f,this.attribute.subTick.length||2)),c+=f;const g=this.getRelativeVector(t.point);r>0&&(g[1]===0?c+=(this.axisLabelLayerSize[r-1].height+Rr(this.attribute,"label.space",4))*r:c+=(this.axisLabelLayerSize[r-1].width+Rr(this.attribute,"label.space",4))*r);const m=this.getVerticalCoord(t.point,c,l),p=this.getVerticalVector(c||1,l,m),v=u?u(`${t.label}`,t,e,i,r):t.label;let{style:b}=this.attribute.label;b=Ce(b)?Jt({},DC.label.style,b(t,e,i,r)):b;const C=this.getLabelAlign(p,l,b.angle);return b=Jt(C,b),Ce(b.text)&&(b.text=b.text({label:t.label,value:t.rawValue,index:t.index,layer:r})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(m,p,v,b)),{text:d??v,_originText:t.label,lineHeight:b==null?void 0:b.fontSize,type:h}),b)}getLabelPosition(t,e,i,r){return t}_transformItems(t){const e=[];return t.forEach(i=>{var r;e.push(Object.assign(Object.assign({},i),{point:this.getTickCoord(i.value),id:(r=i.id)!==null&&r!==void 0?r:i.label}))}),e}runAnimation(){const t=this.lastScale;if(this.attribute.scale){const e=this.attribute.scale;this.lastScale=e.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){const e=this.getInnerView(),i=this.getPrevInnerView();if(!i)return;const r=this._animationConfig;this._newElementAttrMap={},Ja(e,o=>{var s;if(o.type!=="group"&&o.id){const a=i[o.id];if(o.setFinalAttributes(o.attribute),a){a.release();const l=a.attribute,u=o.getFinalAttribute(),h=oj(l,u);let d=Object.keys(h).length>0;if("opacity"in l&&u.opacity!==l.opacity&&(h.opacity=(s=u.opacity)!==null&&s!==void 0?s:1,d=!0),r.update&&d){this._newElementAttrMap[o.id]={state:"update",node:o,attrs:o.attribute};const c=a.attribute;o.setAttributes(c),o.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},r.update),{type:"axisUpdate",customParameters:{config:r.update,diffAttrs:h,lastScale:t}})}])}}else r.enter&&(this._newElementAttrMap[o.id]={state:"enter",node:o,attrs:o.attribute},o.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:r.enter,lastScale:t,getTickCoord:this.getTickCoord.bind(this)}})}]))}})}}release(){super.release(),this._prevInnerView=null,this._innerView=null}}const A2={parity:function(n){return n.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(n,t){let e;return n.filter((i,r)=>r&&Yn(e,i,t)?i.setAttribute("opacity",0):(e=i,1))}};function vq(n){let t;return t=n.OBBBounds.empty()?n.AABBBounds:n.OBBBounds,t.width()>1&&t.height()>1}function bq(n){return n.forEach(t=>t.setAttribute("opacity",1)),n}function R2(n,t,e,i,r=!1){if(e&&!n.attribute.opacity){const o=t.length;if(o>1){n.setAttribute("opacity",1);for(let s=0;s<o;s++){const a=r?t[o-1-s]:t[s];if(!i(a))break;a.setAttribute("opacity",0)}}}}function _q(n,t){if(We(n))return;const e=n.filter(vq);if(We(e))return;let i;i=bq(e);const{method:r="parity",separation:o=0}=t,s=Ce(r)?r:A2[r]||A2.parity;if(i.length>=3&&IC(i,o)){do i=s(i,o);while(i.length>=3&&IC(i,o));const a=(c,f,g=!0)=>g&&c<3||f,l=a(i.length,t.firstVisible,!1);let u=a(i.length,t.lastVisible);const h=e[0],d=Ll(e);Yn(h,d,o)&&l&&u&&(d.setAttribute("opacity",0),u=!1),R2(h,i,l,c=>Yn(c,h,o)),R2(d,i,u,c=>Yn(c,d,o)||!(!l||c===h)&&Yn(c,h,o),!0)}e.forEach(a=>{a.setAttribute("visible",!!a.attribute.opacity)})}function Cq(n,t){if(We(n))return;const{orient:e,labelRotateAngle:i=[0,45,90]}=t;if(i.length===0||n.some(s=>!!s.attribute.angle))return;let r=0,o=0;for(i&&i.length>0&&(o=i.length);r<o;){const s=i[r++];if(n.forEach(a=>{a.attribute.angle=Ds(s)}),wq(e,n),!yq(n))break}}function yq(n){for(let t=1;t<n.length;t++)if(sq(n[t-1],n[t]))return!0;return!1}function wq(n,t){n!=="bottom"&&n!=="top"||xq(n,t),n!=="left"&&n!=="right"||Sq(n,t),oq(t)}function $m(n=0){if(n<0)for(;n<0;)n+=2*Math.PI;if(n>0)for(;n>=2*Math.PI;)n-=2*Math.PI;return n}function Sq(n,t){t.forEach((e,i)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},cD(n,e.attribute.angle)),{angle:$m(e.attribute.angle)}))})}function xq(n,t){t.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},dD(n,e.attribute.angle)),{angle:$m(e.attribute.angle)}))})}function dD(n,t=0){let e=["center","left","left","left","center","right","right","right","left"],i=["top","top","middle","bottom","bottom","bottom","middle","top","top"];n==="top"&&(e=["center","right","right","right","center","left","left","left","right"],i=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);const r=(t=$m(t))/(.5*Math.PI);let o;return o=r===Math.floor(r)?2*Math.floor(r):2*Math.floor(r)+1,{textAlign:e[o],textBaseline:i[o]}}function cD(n,t=0){let e=["right","right","center","left","left","left","center","right","right"],i=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];n==="right"&&(e=["left","left","center","right","right","right","center","left","left"],i=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);const r=(t=$m(t))/(.5*Math.PI);let o;return o=r===Math.floor(r)?2*Math.floor(r):2*Math.floor(r)+1,{textAlign:e[o],textBaseline:i[o]}}function Tq(n){return Ne(n)?{left:n,right:n}:$i(n)?{left:n.left||0,right:n.right||0}:{left:0,right:0}}function Aq(n,t){const{limitLength:e,verticalLimitLength:i,ellipsis:r="...",orient:o,axisLength:s}=t;if(We(n)||!Ne(e))return;const a=Tq(t.overflowLimitLength),l=n[0],u=l.attribute.angle,h=!zt(u),d=h?Math.cos(u):1,c=h?Math.sin(u):0,f=Dw(u),g=uD(u),m=o==="top"||o==="bottom",p=l.attribute.direction,v=!f&&!g&&m&&(n.length<2||n.some(b=>Math.abs(b.AABBBounds.width()-l.AABBBounds.width())>=2))&&l.AABBBounds.width()>Math.abs(e/c);n.forEach(b=>{var C;if(m&&(g&&Math.floor(b.AABBBounds.height())<=e||f&&Math.floor(b.AABBBounds.width())<=i)||!m&&(p==="vertical"&&Math.floor(b.AABBBounds.height())<=i||p!=="vertical"&&(f&&Math.floor(b.AABBBounds.width())<=e||g&&Math.floor(b.AABBBounds.height())<=i)))return;let y=null;if(f||g)y=m?f?i:e:p==="vertical"||g?i:e;else if(m){const{x1:w,x2:_}=b.AABBBounds,A=c/d,T=Math.abs(e/c);if(v&&A>0&&w<=s+a.right&&e/A+w>s+a.right){const S=(s-w+a.right)/Math.abs(d);y=Math.min(S,T)}else if(v&&A<0&&_>=-a.left&&e/A+_<-a.left){const S=(_+a.left)/Math.abs(d);y=Math.min(S,T)}else y=T}else y=Math.abs(e/d);Ne(b.attribute.maxLineWidth)&&(y=Ne(y)?Math.min(b.attribute.maxLineWidth,y):b.attribute.maxLineWidth),b.setAttributes({maxLineWidth:y,ellipsis:(C=b.attribute.ellipsis)!==null&&C!==void 0?C:r})})}function Rq(n,t){const{limitLength:e,axisLength:i,ellipsis:r="...",orient:o}=t;if(We(n)||!Ne(e))return;const s=n[0].attribute.angle,a=Dw(s),l=uD(s),u=o==="top"||o==="bottom";let h=i/n.length;n.forEach((d,c)=>{var f,g,m,p,v;if(u){if(l&&Math.floor(d.AABBBounds.height())<=e)return;if(a){const y=E2(d.attribute.x,(f=n[c+1])===null||f===void 0?void 0:f.attribute.x,(g=n[c-1])===null||g===void 0?void 0:g.attribute.x);Ne(y)&&(h=ki(h,y))}}else{if(l){const y=E2(d.attribute.y,(m=n[c+1])===null||m===void 0?void 0:m.attribute.y,(p=n[c-1])===null||p===void 0?void 0:p.attribute.y);Ne(y)&&(h=ki(h,y))}if(a&&Math.floor(d.AABBBounds.width())<=e)return}let b=null,C=null;u?l?(b=e,C=h):(b=h,C=e):l?(b=h,C=e):(b=e,C=h),d.setAttributes({maxLineWidth:b,ellipsis:(v=d.attribute.ellipsis)!==null&&v!==void 0?v:r,whiteSpace:"normal",heightLimit:C})})}function E2(n,t,e){let i;return Ne(t)&&(i=Math.abs(t-n)),Ne(e)&&(i=Ne(i)?Math.min(Math.abs(n-e),i):Math.abs(n-e)),i}function Eq(n,t,e,i,r){i==="left"||i==="right"?r==="left"?n.forEach(o=>{var s;o.setAttributes({dx:((s=o.attribute.dx)!==null&&s!==void 0?s:0)+t-o.AABBBounds.x1})}):r==="right"?n.forEach(o=>{var s;o.setAttributes({dx:((s=o.attribute.dx)!==null&&s!==void 0?s:0)+t+e-o.AABBBounds.x2})}):r==="center"&&n.forEach(o=>{var s;o.setAttributes({dx:((s=o.attribute.dx)!==null&&s!==void 0?s:0)+t+e/2-(o.AABBBounds.x1+o.AABBBounds.x2)/2})}):i!=="bottom"&&i!=="top"||(r==="top"?n.forEach(o=>{var s;o.setAttributes({dy:((s=o.attribute.dy)!==null&&s!==void 0?s:0)+t-o.AABBBounds.y1})}):r==="bottom"?n.forEach(o=>{var s;o.setAttributes({dy:((s=o.attribute.dy)!==null&&s!==void 0?s:0)+t+e-o.AABBBounds.y2})}):r==="middle"&&n.forEach(o=>{var s;o.setAttributes({dy:((s=o.attribute.dy)!==null&&s!==void 0?s:0)+t+e/2-(o.AABBBounds.y1+o.AABBBounds.y2)/2})}))}class Mq{isInValidValue(t){return t<0||t>1}getTickCoord(t){const{start:e}=this.attribute,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}getRelativeVector(t){const{start:e,end:i}=this.attribute;return[i.x-e.x,i.y-e.y]}getVerticalVector(t,e=!1,i){const{verticalFactor:r=1}=this.attribute,o=this.getRelativeVector(),s=U$(o),a=[s[1],-1*s[0]];return QL(a,t*(e?1:-1)*r)}}class re{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return t===0?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return t===0?0:Math.pow(2,10*t-10)}static expoOut(t){return t===1?1:1-Math.pow(2,-10*t)}static expoInOut(t){return t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-re.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*re.bounceIn(2*t):.5*re.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(i){if(i===0||i===1)return i;const r=e/Zt*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*Zt/e)}}static getElasticOut(t,e){return function(i){if(i===0||i===1)return i;const r=e/Zt*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*Zt/e)+1}}static getElasticInOut(t,e){return function(i){const r=e/Zt*Math.asin(1/t);return(i*=2)<1?t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*Zt/e)*-.5:t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*Zt/e)*.5+1}}static registerFunc(t,e){re[t]=e}}function Bq(n,t){const e=1/t;let i=1;for(;n>e;)n-=e,i*=-1;const r=i*n/e;return r>0?r:1+r}re.quadIn=re.getPowIn(2),re.quadOut=re.getPowOut(2),re.quadInOut=re.getPowInOut(2),re.cubicIn=re.getPowIn(3),re.cubicOut=re.getPowOut(3),re.cubicInOut=re.getPowInOut(3),re.quartIn=re.getPowIn(4),re.quartOut=re.getPowOut(4),re.quartInOut=re.getPowInOut(4),re.quintIn=re.getPowIn(5),re.quintOut=re.getPowOut(5),re.quintInOut=re.getPowInOut(5),re.backIn=re.getBackIn(1.7),re.backOut=re.getBackOut(1.7),re.backInOut=re.getBackInOut(1.7),re.elasticIn=re.getElasticIn(1,.3),re.elasticOut=re.getElasticOut(1,.3),re.elasticInOut=re.getElasticInOut(1,.3*1.5),re.easeInOutQuad=n=>(n/=.5)<1?.5*Math.pow(n,2):-.5*((n-=2)*n-2),re.easeOutElastic=n=>{const t=2*Math.PI/3;return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((10*n-.75)*t)+1},re.easeInOutElastic=n=>{const t=2*Math.PI/4.5;return n===0?0:n===1?1:n<.5?-Math.pow(2,20*n-10)*Math.sin((20*n-11.125)*t)/2:Math.pow(2,-20*n+10)*Math.sin((20*n-11.125)*t)/2+1};for(let n=0;n<10;n++)re[`flicker${n}`]=t=>Bq(t,n);for(let n=2;n<10;n++)re[`aIn${n}`]=t=>n*t*t+(1-n)*t;function Qe(n,t,e){return n+(t-n)*e}class Pq{constructor(){this.opacity=(t,e,i,r,o,s)=>{s.attribute.opacity=Qe(e,i,r)},this.baseOpacity=(t,e,i,r,o,s)=>{s.attribute.baseOpacity=Qe(e,i,r)},this.fillOpacity=(t,e,i,r,o,s)=>{s.attribute.fillOpacity=Qe(e,i,r)},this.strokeOpacity=(t,e,i,r,o,s)=>{s.attribute.strokeOpacity=Qe(e,i,r)},this.zIndex=(t,e,i,r,o,s)=>{s.attribute.zIndex=Qe(e,i,r)},this.backgroundOpacity=(t,e,i,r,o,s)=>{s.attribute.backgroundOpacity=Qe(e,i,r)},this.shadowOffsetX=(t,e,i,r,o,s)=>{s.attribute.shadowOffsetX=Qe(e,i,r)},this.shadowOffsetY=(t,e,i,r,o,s)=>{s.attribute.shadowOffsetY=Qe(e,i,r)},this.shadowBlur=(t,e,i,r,o,s)=>{s.attribute.shadowBlur=Qe(e,i,r)},this.fill=(t,e,i,r,o,s)=>{s.attribute.fill=Ya(e,i,r,!1)},this.fillPure=(t,e,i,r,o,s)=>{s.attribute.fill=o.fromParsedProps.fill?ET(o.fromParsedProps.fill,o.toParsedProps.fill,r):o.toParsedProps.fill},this.stroke=(t,e,i,r,o,s)=>{s.attribute.stroke=Ya(e,i,r,!1)},this.strokePure=(t,e,i,r,o,s)=>{s.attribute.stroke=o.fromParsedProps.stroke?ET(o.fromParsedProps.stroke,o.toParsedProps.stroke,r):o.toParsedProps.stroke},this.width=(t,e,i,r,o,s)=>{s.attribute.width=Qe(e,i,r),s.addUpdateBoundTag()},this.height=(t,e,i,r,o,s)=>{s.attribute.height=Qe(e,i,r),s.addUpdateBoundTag()},this.x=(t,e,i,r,o,s)=>{s.attribute.x=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.y=(t,e,i,r,o,s)=>{s.attribute.y=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.dx=(t,e,i,r,o,s)=>{s.attribute.dx=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.dy=(t,e,i,r,o,s)=>{s.attribute.dy=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.angle=(t,e,i,r,o,s)=>{s.attribute.angle=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.scaleX=(t,e,i,r,o,s)=>{s.attribute.scaleX=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.scaleY=(t,e,i,r,o,s)=>{s.attribute.scaleY=Qe(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.lineWidth=(t,e,i,r,o,s)=>{s.attribute.lineWidth=Qe(e,i,r),s.addUpdateBoundTag()},this.startAngle=(t,e,i,r,o,s)=>{s.attribute.startAngle=Qe(e,i,r),s.addUpdateBoundTag()},this.endAngle=(t,e,i,r,o,s)=>{s.attribute.endAngle=Qe(e,i,r),s.addUpdateBoundTag()},this.radius=(t,e,i,r,o,s)=>{s.attribute.radius=Qe(e,i,r),s.addUpdateBoundTag()},this.outerRadius=(t,e,i,r,o,s)=>{s.attribute.outerRadius=Qe(e,i,r),s.addUpdateBoundTag()},this.innerRadius=(t,e,i,r,o,s)=>{s.attribute.innerRadius=Qe(e,i,r),s.addUpdateBoundTag()},this.size=(t,e,i,r,o,s)=>{s.attribute.size=Qe(e,i,r),s.addUpdateBoundTag()},this.points=(t,e,i,r,o,s)=>{s.attribute.points=bw(e,i,r),s.addUpdateBoundTag()}}}const ph=new Pq;function M2(n,t,e,i,r,o){if(Number.isFinite(e)&&Number.isFinite(t))return o.attribute[n]=t+(e-t)*i,!0;if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){const s=[];let a=!0;for(let l=0;l<e.length;l++){const u=t[l],h=u+(e[l]-u)*i;if(!Number.isFinite(h)){a=!1;break}s.push(h)}return a&&(o.attribute[n]=s),!0}return!1}function B2(){}class dp{constructor(t,e,i,r){var o;this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=()=>{this.target.setAttributes(this.target.attribute)},this.type=t,this.props=e,this.duration=i,this.easing=r?typeof r=="function"?r:(o=re[r])!==null&&o!==void 0?o:re.linear:re.linear,t==="wait"&&(this.onUpdate=B2),this.id=bi.GenAutoIncrementId(),this.syncAttributeUpdate=B2}bind(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}append(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}updateDownstreamStartTimes(){let t=this.next,e=this._startTime+this.duration;for(;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}getLastProps(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}setDuration(t,e=!0){this.duration=t,e&&this.updateDownstreamStartTimes()}getDuration(){return this.duration}determineInterpolateUpdateFunction(){if(!this.props)return;const t=[];this.propKeys.forEach(e=>{if(e==="fill"||e==="stroke"){const i=this.fromProps[e],r=this.props[e];if(lr(i)&&lr(r)){const o=Ri.Get(i,Qn.Color255),s=Ri.Get(r,Qn.Color255);this.fromParsedProps||(this.fromParsedProps={}),this.toParsedProps||(this.toParsedProps={}),this.fromParsedProps[e]=o,this.toParsedProps[e]=s,t.push(ph[e==="fill"?"fillPure":"strokePure"])}else ph[e]?t.push(ph[e]):t.push(M2)}else ph[e]?t.push(ph[e]):t.push(M2)}),this.interpolateUpdateFunctions=t}setStartTime(t,e=!0){this._startTime=t,e&&this.updateDownstreamStartTimes()}getStartTime(){return this._startTime}onBind(){this.target.type==="glyph"&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}onFirstRun(){}onStart(){if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();const t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.fromProps[e]=(i=this.fromProps[e])!==null&&i!==void 0?i:t[e]}),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}tryPreventConflict(){const t=this.animate;this.target.animates.forEach(e=>{if(e===t||e.priority>t.priority||e.priority===1/0)return;const i=e.getStartProps();this.propKeys.forEach(r=>{i[r]!=null&&e.preventAttr(r)})})}deleteSelfAttr(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];const i=this.propKeys.indexOf(t);i!==-1&&(this.propKeys.splice(i,1),(e=this.interpolateUpdateFunctions)===null||e===void 0||e.splice(i,1))}trySyncStartProps(){this.propKeys.forEach(t=>{this.fromProps[t]=this.animate.target.getComputedAttribute(t)})}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.fromProps[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}onUpdate(t,e,i){}onEnd(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}getEndProps(){return this.props}getFromProps(){return this.fromProps}getMergedEndProps(){return this.getEndProps()}stop(){}}class kq extends dp{constructor(t,e,i,r){super(t,e,i,r)}onStart(){super.onStart()}onFirstRun(){const t=this.getFromProps();this.target.setAttributes(t)}update(t,e,i){this.onStart()}determineInterpolateUpdateFunction(){}}class Iw extends ol{get animateCount(){return this._animateCount}constructor(){super(),this.head=null,this.tail=null,this.animateMap=new Map,this._animateCount=0,this._playSpeed=1,this._totalDuration=0,this._startTime=0,this._currentTime=0,this._animationEndFlag=!0,this.id=bi.GenAutoIncrementId(),this.paused=!1}isRunning(){return!this.paused&&this._animateCount>0}forEachAccessAnimate(t){let e=this.head,i=0;for(;e;){const r=e.next;t(e.animate,i),i++,e=r}}addAnimate(t){const e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));const e=t*this._playSpeed;this._currentTime+=e,this.forEachAccessAnimate((i,r)=>{i.status===fr.END?this.removeAnimate(i,!0):i.status!==fr.RUNNING&&i.status!==fr.INITIAL||i.advance(e)}),this._animateCount===0&&(this._animationEndFlag=!0,this.emit("animationEnd"))}clear(){this.forEachAccessAnimate(t=>{t.release()}),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}removeAnimate(t,e=!0){const i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach(r=>r()),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}recalculateTotalDuration(){this._totalDuration=0,this.forEachAccessAnimate(t=>{this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())})}getTotalDuration(){return this._totalDuration}getPlaySpeed(){return this._playSpeed}setPlaySpeed(t){this._playSpeed=t}getPlayState(){return this.paused?"paused":this.animateCount===0?"stopped":"playing"}setStartTime(t){this._startTime=t}getStartTime(){return this._startTime}getCurrentTime(){return this._currentTime}setCurrentTime(t){this._currentTime=t}}const Fw=new Iw;Fw.isGlobal=!0;class fD{constructor(t=bi.GenAutoIncrementId(),e=Fw,i){this.id=t,this.status=fr.INITIAL,this._timeline=e,e.addAnimate(this),this.slience=i,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}getStartProps(){return this._startProps}getEndProps(){return this._endProps}setTimeline(t){this._timeline=t}getTimeline(){return this._timeline}get timeline(){return this._timeline}bind(t){return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove(()=>{this.stop(),this.target.animates.delete(this.id)}),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}to(t,e=300,i="linear"){const r=new dp(Hh.to,t,e,i);return r.bind(this.target,this),this.updateStepAfterAppend(r),this}wait(t){const e=new kq(Hh.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}updateStepAfterAppend(t){this._firstStep?(this._lastStep.append(t),this._lastStep=t):(this._firstStep=t,this._lastStep=t),this.parseStepProps(t),this.updateDuration()}parseStepProps(t){this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=(i=t.props[e])!==null&&i!==void 0?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}))}reSyncProps(){if(!this._lastStep)return;this._endProps={};let t=this._firstStep;for(;t;)Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=(i=t.props[e])!==null&&i!==void 0?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}),t=t.next}from(t,e=300,i="linear"){const r=new dp(Hh.from,t,e,i);return this._firstStep?(this._lastStep.append(r),this._lastStep=r):(this._firstStep=r,this._lastStep=r),this.updateDuration(),this}play(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}pause(){this.status===fr.RUNNING&&(this.status=fr.PAUSED)}resume(){this.status===fr.PAUSED&&(this.status=fr.RUNNING)}onStart(t){var e;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):((e=this._onStart)===null||e===void 0||e.forEach(i=>i()),Object.keys(this._endProps).forEach(i=>{this._startProps[i]=this.target.getComputedAttribute(i)}))}onEnd(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):(e=this._onEnd)===null||e===void 0||e.forEach(i=>i())}onFrame(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}onRemove(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):(e=this._onRemove)===null||e===void 0||e.forEach(i=>i())}preventAttr(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];let e=this._firstStep;for(;e;)e.deleteSelfAttr(t),e=e.next}preventAttrs(t){t.forEach(e=>this._preventAttrs.add(e))}validAttr(t){return!this._preventAttrs.has(t)}runCb(t){var e;return(e=this._lastStep)===null||e===void 0||e.onEnd(t),this}startAt(t){return this._startTime=t,this}customInterpolate(t,e,i,r,o,s){return!1}getFromValue(){return this._startProps}getToValue(){return this._endProps}stop(t){let e=this._firstStep;for(;e;)e.stop(),e=e.next;this.status!==fr.END&&this.onEnd(),this.status=fr.END,this.target&&(t==="start"?this.target.setAttributes(this._startProps):t==="end"?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}release(){this.status=fr.END,this._onRemove&&this._onRemove.forEach(t=>t()),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[]}getDuration(){return this._duration}getStartTime(){return this._startTime}afterAll(t){if(!t||t.length===0)return this;let e=0;return t.forEach(i=>{const r=i.getStartTime()+i.getTotalDuration();e=Math.max(e,r)}),this.startAt(e)}after(t){if(!t)return this;const e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}parallel(t){return t?(this.startAt(t.getStartTime()),this):this}loop(t){return t===!0?t=1/0:t===!1&&(t=0),this._loopCount=t,this.updateDuration(),this}bounce(t){return this._bounce=t,this}advance(t){var e,i,r;if(this.status===fr.END)return void console.warn("aaa 动画已经结束，不能推进");const o=this.currentTime+t;if(o<this._startTime)return void(this.currentTime=o);if(o>=this._startTime+this._totalDuration)return(e=this._lastStep)===null||e===void 0||e.onUpdate(!0,1,{}),(i=this._lastStep)===null||i===void 0||i.onEnd(),this.onEnd(),void(this.status=fr.END);this.status=fr.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=o;let s=o-this._startTime,a=!1,l=!1;if(this._loopCount>0){s=(o-this._startTime)%this._duration;const c=Math.floor((o-this._startTime)/this._duration);a=c>this._currentLoop,this._currentLoop=c,l=this._bounce&&c%2==1,l&&(s=this._duration-s)}a&&!l&&this.target.setAttributes(this._startProps);let u=null;if(this._lastStep===this._firstStep)u=this._firstStep;else{let c=this._firstStep;for(;c;){const f=c.getStartTime(),g=c.getDuration();if(s>=f&&s<=f+g){u=c;break}c=c.next}}if(!u)return;u!==this.lastRunStep&&((r=this.lastRunStep)===null||r===void 0||r.onEnd()),this.lastRunStep=u;const h=(s-u.getStartTime())/u.getDuration(),d=h>=1;u.update(d,h,{}),d&&(u.onEnd(),this.lastRunStep=null)}updateDuration(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}getTotalDuration(){return this._totalDuration}getLoop(){return this._loopCount}}const Lq=new Rk;class Dq{constructor(){this.released=!1}tick(t,e){Lq.addAnimationFrameCb(()=>{if(!this.released)return e(this)})}release(){this.released=!0}getTime(){return Date.now()}}class gD extends ol{constructor(t){super(),this.timelines=[],this.frameTimeHistory=[],this.handleTick=(e,i)=>{const{once:r=!1}=i??{};if(this.ifCanStop())return this.stop(),!1;const o=e.getTime();this._lastTickTime=o,this.lastFrameTime<0&&(this.lastFrameTime=o-this.interval+this.timeOffset,this.frameTimeHistory.push(this.lastFrameTime));const s=o-this.lastFrameTime,a=this.checkSkip(s);return a||(this._handlerTick(s),this.lastFrameTime=o,this.frameTimeHistory.push(this.lastFrameTime)),r||e.tick(this.interval,this.handleTick),!a},this._handlerTick=e=>{this.status===Wr.RUNNING&&(this.tickCounts++,this.timelines.forEach(i=>{i.tick(e)}),this.emit("tick",e))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.stage=t,this.autoStop=!0,this.interval=16,this.computeTimeOffsetAndJitter()}bindStage(t){this.stage=t}computeTimeOffsetAndJitter(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}init(){this.interval=16,this.status=Wr.INITIAL,Mt.global.hooks.onSetEnv.tap("graph-ticker",()=>{this.initHandler(!1)}),Mt.global.env&&this.initHandler(!1)}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}getTimelines(){return this.timelines}initHandler(t=!1){this.setupTickHandler(t)}setupTickHandler(t=!1){if(!t&&this.tickerHandler)return!0;const e=new Dq;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0}setInterval(t){this.interval=t,this.computeTimeOffsetAndJitter()}getInterval(){return this.interval}setFPS(t){this.setInterval(Math.floor(1e3/t))}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,e=>this.handleTick(e,{once:!0}))}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,e=>{this.handleTick(e,{once:!0})})}pause(){return this.status!==Wr.INITIAL&&(this.status=Wr.PAUSE,!0)}resume(){return this.status!==Wr.INITIAL&&(this.status=Wr.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.every(t=>!t.isRunning())))}start(t=!1){return this.status===Wr.RUNNING||!this.tickerHandler||!t&&(this.status===Wr.PAUSE||this.ifCanStop())?!1:(this.status=Wr.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=Wr.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}trySyncTickStatus(){this.status===Wr.INITIAL&&this.timelines.some(t=>t.isRunning())?this.start():this.status===Wr.RUNNING&&this.timelines.every(t=>!t.isRunning())&&this.stop()}release(){var t;this.stop(),this.timelines=[],(t=this.tickerHandler)===null||t===void 0||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}checkSkip(t){var e,i,r;return((r=(i=(e=this.stage)===null||e===void 0?void 0:e.params)===null||i===void 0?void 0:i.optimize)===null||r===void 0?void 0:r.tickRenderMode)==="performance"?!1:t<this.interval+2*(Math.random()-.5)*this._jitter}}class Fa{constructor(){this.transitions=new Map,this.registerDefaultTransitions()}static getInstance(){return Fa.instance||(Fa.instance=new Fa),Fa.instance}registerDefaultTransitions(){this.registerTransition("appear","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("appear","appear",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("appear","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("appear","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("normal","normal",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("normal","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("exit","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","enter",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","exit",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("enter","enter",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("enter","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("disappear","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("disappear","appear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}isTransitionAllowed(t,e,i){var r,o,s,a;let l=(r=this.transitions.get(t))===null||r===void 0?void 0:r.get(e);return l?l(i,t):(l=(o=this.transitions.get(t))===null||o===void 0?void 0:o.get("*"),l?l(i,t):(l=(s=this.transitions.get("*"))===null||s===void 0?void 0:s.get(e),l?l(i,t):(l=(a=this.transitions.get("*"))===null||a===void 0?void 0:a.get("*"),l?l(i,t):{allowTransition:!0,stopOriginalTransition:!0})))}registerTransition(t,e,i){let r=this.transitions.get(t);r||(r=new Map,this.transitions.set(t,r)),r.set(e,i)}}Fa.getInstance();class Vt{static registerBuiltInAnimate(t,e){Vt.builtInAnimateMap[t]=e}constructor(t){this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=t}onStart(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach(e=>{e()})}onEnd(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach(e=>{e()})}_trackAnimation(t){this._animates.push(t),this._activeCount++,this._activeCount!==1||this._started||(this._started=!0,this.onStart()),t.onEnd(()=>{this._activeCount--;const e=this._animates.indexOf(t);e>=0&&this._animates.splice(e,1),this._activeCount===0&&this._started&&(this._started=!1,this.onEnd())})}parseParams(t,e,i){var r,o;const s=this.resolveValue(t.totalTime,void 0,void 0),a=this.resolveValue(t.startTime,void 0,0),l=Object.assign({},t);l.oneByOneDelay=0,l.startTime=a,l.totalTime=s;const u=this.resolveValue(t.oneByOne,i,!1);if(e){const h=l.timeSlices;jt(h)||(l.timeSlices=[h]);let d=0;l.timeSlices=l.timeSlices.map(g=>{const m=this.resolveValue(g.delay,i,0),p=this.resolveValue(g.delayAfter,i,0),v=this.resolveValue(g.duration,i,300);return d+=m+v+p,Object.assign(Object.assign({},g),{delay:m,delayAfter:p,duration:v})});let c=0;u&&(c=typeof u=="number"?u:u?d:0),l.oneByOneDelay=c;let f=1;if(s){const g=d+c*(this._target.count-2);f=s?s/g:1}l.timeSlices=l.timeSlices.map(g=>{let m=g.effects;return Array.isArray(m)||(m=[m]),Object.assign(Object.assign({},g),{delay:g.delay*f,delayAfter:g.delayAfter*f,duration:g.duration*f,effects:m.map(p=>{var v,b;const C=(v=p.custom)!==null&&v!==void 0?v:Vt.builtInAnimateMap[(b=p.type)!==null&&b!==void 0?b:"fromTo"],y=C&&Ce(C)?/^class\s/.test(Function.prototype.toString.call(C))?1:2:0;return Object.assign(Object.assign({},p),{custom:C,customType:y})})})}),l.oneByOneDelay=c*f,l.startTime=a*f}else{const h=this.resolveValue(t.delay,i,0),d=this.resolveValue(t.delayAfter,i,0),c=this.resolveValue(t.duration,i,300);let f=0;u&&(f=typeof u=="number"?u:u?h+d+c:0),l.oneByOneDelay=f,l.custom=(r=t.custom)!==null&&r!==void 0?r:Vt.builtInAnimateMap[(o=t.type)!==null&&o!==void 0?o:"fromTo"];const g=l.custom&&Ce(l.custom)?/^class\s/.test(Function.prototype.toString.call(l.custom))?1:2:0;if(l.customType=g,s){const m=h+d+c+f*(this._target.count-2),p=s?s/m:1;l.delay=h*p,l.delayAfter=d*p,l.duration=c*p,l.oneByOneDelay=f*p,l.startTime=a}}return l}execute(t){Array.isArray(t)?t.forEach(e=>this._execute(e)):this._execute(t)}_execute(t){if(t.selfOnly)return this._executeItem(t,this._target,0,1);const e="timeSlices"in t;let i;e&&t.partitioner&&(i=(i??this._target.getChildren()).filter(o=>{var s,a;return t.partitioner((a=(s=o.context)===null||s===void 0?void 0:s.data)===null||a===void 0?void 0:a[0],o,{})})),e&&t.sort&&(i=i??this._target.getChildren(),i.sort((o,s)=>{var a,l,u,h;return t.sort((l=(a=o.context)===null||a===void 0?void 0:a.data)===null||l===void 0?void 0:l[0],(h=(u=s.context)===null||u===void 0?void 0:u.data)===null||h===void 0?void 0:h[0],o,s,{})}));const r=e?(o,s,a)=>{const l=this.parseParams(t,e,o),u=this.executeTimelineItem(l,o,s,a);u&&this._trackAnimation(u)}:(o,s,a)=>{const l=this.parseParams(t,e,o),u=this.executeTypeConfigItem(l,o,s,a);u&&this._trackAnimation(u)};i?i.forEach((o,s)=>r(o,s,i.length)):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((o,s)=>r(o,s,this._target.count-1))}executeTypeConfigItem(t,e,i,r){var o,s,a,l,u,h,d,c;const{type:f="fromTo",channel:g,customParameters:m,easing:p="linear",delay:v=0,delayAfter:b=0,duration:C=300,startTime:y=0,oneByOneDelay:w=0,loop:_,bounce:A,priority:T=0,options:S,custom:x,customType:E,controlOptions:M}=t,L=e.animate();L.priority=T;const I=Ce(v)?v((s=(o=e.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],e,{}):v,D=(l=(a=e.context)===null||a===void 0?void 0:a.data)===null||l===void 0?void 0:l[0],H=(u=e.context)===null||u===void 0?void 0:u.indexKey;D&&H&&(i=(h=D[H])!==null&&h!==void 0?h:i),L.startAt(y);const O=i*w+I;O>0&&L.wait(O);let N=null,U=t.to,W=t.from;U||(N||(N=this.createPropsFromChannel(g,e)),U=N.props),W||(N||(N=this.createPropsFromChannel(g,e)),W=N.from),this._handleRunAnimate(L,x,E,W,U,C,p,m,M,S,f,e);let j=0;w&&(j=w*(r-i-1));const Y=Ce(b)?b((c=(d=e.context)===null||d===void 0?void 0:d.data)===null||c===void 0?void 0:c[0],e,{}):b;return Y>0&&(j+=Y),j>0&&L.wait(j),_&&_>0&&L.loop(_),A&&L.bounce(!0),L}_handleRunAnimate(t,e,i,r,o,s,a,l,u,h,d,c){var f,g,m,p;if(e&&i){const v=Object.assign({width:c.stage.width,height:c.stage.height,group:this._target.parent},this.resolveValue(l,c)),b=Ce(h)?h.call(null,(g=v&&((f=v.data)===null||f===void 0?void 0:f[0]))!==null&&g!==void 0?g:(p=(m=c.context)===null||m===void 0?void 0:m.data)===null||p===void 0?void 0:p[0],c,v):h;v.options=b,v.controlOptions=u,i===1?this.createCustomAnimation(t,e,r,o,s,a,v):i===2&&this.createCustomInterpolatorAnimation(t,e,o,s,a,v)}else d==="to"?t.to(o,s,a):d==="from"&&t.from(o,s,a)}executeTimelineItem(t,e,i,r){var o,s,a,l;const{timeSlices:u,startTime:h=0,loop:d,bounce:c,oneByOneDelay:f,priority:g,controlOptions:m}=t,p=(s=(o=e.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],v=(a=e.context)===null||a===void 0?void 0:a.indexKey;p&&v&&(i=(l=p[v])!==null&&l!==void 0?l:i);const b=e.animate();return b.priority=g,b.startAt(h),b.wait(i*f),d&&d>0&&b.loop(d),c&&b.bounce(!0),(Array.isArray(u)?u:[u]).forEach(C=>{this.applyTimeSliceToAnimate(C,b,e,m)}),f&&b.wait(f*(r-i-1)),b}applyTimeSliceToAnimate(t,e,i,r){var o,s,a,l;const{effects:u,duration:h=300,delay:d=0,delayAfter:c=0}=t,f=Ce(d)?d((s=(o=i.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],i,{}):d,g=Ce(c)?c((l=(a=i.context)===null||a===void 0?void 0:a.data)===null||l===void 0?void 0:l[0],i,{}):c;f>0&&e.wait(f),(Array.isArray(u)?u:[u]).forEach(m=>{var p;const{type:v="fromTo",channel:b,customParameters:C,easing:y="linear",options:w}=m;let _=null,A=m.to,T=m.from;A||(_||(_=this.createPropsFromChannel(b,i)),A=_.props),T||(_||(_=this.createPropsFromChannel(b,i)),T=_.from);const S=(p=m.custom)!==null&&p!==void 0?p:Vt.builtInAnimateMap[v],x=m.customType;this._handleRunAnimate(e,S,x,T,A,h,y,C,r,w,v,i)}),g>0&&e.wait(g)}createCustomInterpolatorAnimation(t,e,i,r,o,s){Object.keys(i).forEach(l=>{t.target.getComputedAttribute(l)}),t.interpolateUpdateFunction=(l,u,h,d,c)=>{e(h,l,u,d,c,t.target,s)},t.to(i,r,o)}createCustomAnimation(t,e,i,r,o,s,a){const l=new e(i,r,o,s,a);t.play(l)}createPropsFromChannel(t,e){const i={};let r=null;return t?(Array.isArray(t)?t.forEach(o=>{var s,a;const l=(a=(s=e.context)===null||s===void 0?void 0:s.diffAttrs)===null||a===void 0?void 0:a[o];l!==void 0&&(i[o]=l)}):Object.keys(t).forEach(o=>{var s,a,l,u;const h=t[o];h.to!==void 0&&(typeof h.to=="function"?i[o]=h.to((a=(s=e.context)===null||s===void 0?void 0:s.data)===null||a===void 0?void 0:a[0],e,{}):i[o]=h.to),h.from!==void 0&&(r||(r={}),typeof h.from=="function"?r[o]=h.from((u=(l=e.context)===null||l===void 0?void 0:l.data)===null||u===void 0?void 0:u[0],e,{}):r[o]=h.from)}),{from:r,props:i}):{from:r,props:i}}resolveValue(t,e,i){var r,o;return t===void 0?i:typeof t=="function"&&e?t((o=(r=e.context)===null||r===void 0?void 0:r.data)===null||o===void 0?void 0:o[0],e,{}):t}executeItem(t,e,i=0,r=1){return Array.isArray(t)?t.map(o=>this._executeItem(o,e,i,r)).filter(Boolean):[this._executeItem(t,e,i,r)].filter(Boolean)}_executeItem(t,e,i=0,r=1){if(!e)return null;const o="timeSlices"in t;let s=null;const a=this.parseParams(t,o);return s=o?this.executeTimelineItem(a,e,i,r):this.executeTypeConfigItem(a,e,i,r),s&&this._trackAnimation(s),s}stop(t){for(;this._animates.length>0;){const e=this._animates.pop();e==null||e.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,this.onEnd())}}Vt.builtInAnimateMap={};const go={APPEAR:"appear",DISAPPEAR:"disappear",UPDATE:"update",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight"};class Iq{constructor(t){this.graphic=t}registerState(t){this.states||(this.states=new Map),this.states.set(t.name,t)}clearStates(){var t;(t=this.states)===null||t===void 0||t.clear()}}class Fq{constructor(t){this.stateList=null,this.graphic=t}applyState(t,e,i){const r=Fa.getInstance(),o=[],s=[];if(this.stateList&&this.stateList.length?t.forEach((a,l)=>{const u={allowTransition:!0};this.stateList.forEach(h=>{const d=r.isTransitionAllowed(h.state,a,this.graphic);u.allowTransition=u.allowTransition&&d.allowTransition}),u.allowTransition&&(s.push({state:a,animationConfig:jt(e[l])?e[l].map(h=>h.animation):e[l].animation,executor:new Vt(this.graphic)}),this.stateList.forEach(h=>{r.isTransitionAllowed(h.state,a,this.graphic).stopOriginalTransition&&o.push(h)}))}):t.forEach((a,l)=>{s.push({state:a,animationConfig:jt(e[l])?e[l].map(u=>u.animation):e[l].animation,executor:new Vt(this.graphic)})}),o.forEach(a=>{a.executor.stop()}),s.length){s[0].executor.execute(s[0].animationConfig);for(let a=0;a<s.length;a++){const l=s[a+1],u=s[a];u.executor.onEnd(()=>{l&&l.executor.execute(l.animationConfig),this.stateList=this.stateList.filter(h=>h!==u),a===s.length-1&&i&&i(!1)})}}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter(a=>!o.includes(a)):this.stateList=[],this.stateList.push(...s)}applyAppearState(t,e){this.applyState([go.APPEAR],[{name:go.APPEAR,animation:t}],e)}applyDisappearState(t,e){this.applyState([go.DISAPPEAR],[{name:go.DISAPPEAR,animation:t}],e)}applyUpdateState(t,e){this.applyState([go.UPDATE],[{name:go.UPDATE,animation:t}],e)}applyHighlightState(t,e){this.applyState([go.HIGHLIGHT],[{name:go.HIGHLIGHT,animation:t}],e)}applyUnhighlightState(t,e){this.applyState([go.UNHIGHLIGHT],[{name:go.UNHIGHLIGHT,animation:t}],e)}stopState(t,e){var i;const r=(i=this.stateList)===null||i===void 0?void 0:i.find(o=>o.state===t);r&&r.executor.stop(e)}clearState(){var t;(t=this.stateList)===null||t===void 0||t.forEach(e=>{e.executor.stop()}),this.stateList=null}}class Ow{_getAnimationStateManager(t){return t._animationStateManager||(t._animationStateManager=new Fq(t)),t._animationStateManager}_getAnimationStateStore(t){return t._animationStateStore||(t._animationStateStore=new Iq(t)),t._animationStateStore}registerAnimationState(t){return this._getAnimationStateStore(this).registerState(t),this}applyAnimationState(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}applyAppearState(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}applyDisappearState(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}applyUpdateState(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}applyHighlightState(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}applyUnhighlightState(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}stopAnimationState(t,e){return this._getAnimationStateManager(this).stopState(t,e),this}clearAnimationStates(){return this._getAnimationStateManager(this).clearState(),this}static extend(t){return new Ow()._getAnimationStateManager(t),t}}class Oq{getAttributes(t=!1){return t&&this.finalAttribute?this.finalAttribute:this.attribute}animate(t){var e,i,r;const o=new fD(t==null?void 0:t.id,(i=(e=t==null?void 0:t.timeline)!==null&&e!==void 0?e:this.stage&&this.stage.getTimeline())!==null&&i!==void 0?i:Fw,t==null?void 0:t.slience);if(o.bind(this),t){const{onStart:s,onEnd:a,onRemove:l}=t;s!=null&&o.onStart(s),a!=null&&o.onEnd(a),l!=null&&o.onRemove(l)}return(r=this.stage)===null||r===void 0||r.ticker.start(),o}createTimeline(){return new Iw}createTicker(t){return new gD(t)}setFinalAttributes(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}initFinalAttributes(t){this.finalAttribute=t}initAnimateExecutor(){this._animateExecutor||(this._animateExecutor=new Vt(this))}executeAnimation(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}executeAnimations(t){return this.initAnimateExecutor(),t.forEach(e=>{this._animateExecutor.execute(e)}),this}getFinalAttribute(){return this.finalAttribute}getGraphicAttribute(t,e=!1){return!e&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}}function Hq(){y_(Hi,Ow),y_(Hi,Oq)}class ve extends dp{constructor(t,e,i,r,o){super("customAnimate",e,i,r),this.type="customAnimate",this.customFrom=t,this.params=o,this.from=t,this.to=e}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.onUpdate(t,r,i),this.syncAttributeUpdate()}setProps(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}class Nu extends ve{completeBind(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}stop(){this._animator&&this._animator.stop()}}class zq{constructor(t){this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=t}animate(t,e){return this.started?(console.warn("Cannot add animations after animation has started"),this):(this.tasks.push({graphic:t,config:e}),this)}onStart(t){return this.onStartCallbacks.push(t),this}onEnd(t){return this.onEndCallbacks.push(t),this}onUpdate(t){return this.onUpdateCallbacks.push(t),this}start(){return this.started?(console.warn("Animation has already started"),this):(this.started=!0,this.completed=0,this.onStartCallbacks.forEach(t=>t()),this.tasks.length===0?(setTimeout(()=>{this.onEndCallbacks.forEach(t=>t())},0),this):(this.tasks.forEach(t=>{const e=new Vt(t.graphic);e.onEnd(()=>{this.completed++,this.completed===this.tasks.length&&this.onEndCallbacks.forEach(r=>r())});const i=e.executeItem(t.config,t.graphic);t.animate=i,i.forEach(r=>{this.totalDuration=Math.max(this.totalDuration,r.getStartTime()+r.getDuration())})}),this))}deleteSelfAttr(t){this.tasks.forEach(e=>{e.animate&&e.animate.forEach(i=>i.preventAttr(t))})}stop(t){return this.tasks.forEach(e=>{e.animate&&e.animate.forEach(i=>i.stop(t))}),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach(e=>e()),this.completed=this.tasks.length),this}getDuration(){return this.totalDuration}}function Wu(n){return new zq(n)}class Nq extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.formatTemplate=null,this.decimalLength=o==null?void 0:o.decimalLength,o!=null&&o.formatTemplate&&o.formatTemplate.includes("{{var}}")&&(this.formatTemplate=o.formatTemplate)}onFirstRun(){var t,e,i;const r=this.getLastProps(),o=this.getEndProps(),s=(t=r.text)!==null&&t!==void 0?t:0,a=(e=o.text)!==null&&e!==void 0?e:0;this.valid=!0;let l=0,u=0,h="",d="",c=0;if(typeof s=="number"){l=s;const f=s.toString().split(".")[1]||"";c=Math.max(c,f.length)}else{if(typeof s!="string")return void(this.valid=!1);if(s.endsWith("%")){h="%";const f=s.substring(0,s.length-1).replace(/,/g,"");if(l=parseFloat(f)/100,isNaN(l))return void(this.valid=!1);const g=f.split(".")[1]||"";c=Math.max(c,g.length+2)}else{const f=s.replace(/,/g,"");if(l=parseFloat(f),isNaN(l))return void(this.valid=!1);s.includes(",")&&(h=",");const g=f.split(".")[1]||"";c=Math.max(c,g.length)}}if(typeof a=="number"){u=a;const f=a.toString().split(".")[1]||"";c=Math.max(c,f.length)}else{if(typeof a!="string")return void(this.valid=!1);if(a.endsWith("%")){d="%";const f=a.substring(0,a.length-1).replace(/,/g,"");if(u=parseFloat(f)/100,isNaN(u))return void(this.valid=!1);const g=f.split(".")[1]||"";c=Math.max(c,g.length+2)}else{const f=a.replace(/,/g,"");if(u=parseFloat(f),isNaN(u))return void(this.valid=!1);a.includes(",")&&(d=",");const g=f.split(".")[1]||"";c=Math.max(c,g.length)}}if(!((i=this.params)===null||i===void 0)&&i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=d||h}this.format==="%"&&d!=="%"&&h!=="%"&&this.decimalLength===void 0&&(this.decimalLength=2),this.format==="%"||d!=="%"&&h!=="%"||(l*=100,u*=100)}else this.format=d||h;this.fromNumber=l,this.toNumber=u,this.decimalLength===void 0&&(this.decimalLength=c)}onEnd(t){super.onEnd(t),t||this.props&&this.target.setAttributes(this.props)}onUpdate(t,e,i){if(!this.valid)return;const r=this.fromNumber+(this.toNumber-this.fromNumber)*e;let o="";const s=this.format,a=(s==="%"?100*r:r).toFixed(this.decimalLength);let l,u=a;if(parseFloat(a)===Math.floor(parseFloat(a))&&(u=Math.floor(parseFloat(a))),s==="%")l=`${u}%`;else if(s===","){const h=u.toString().split(".");h[0]=h[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),l=h.join(".")}else l=u;o=this.formatTemplate?this.formatTemplate.replace("{{var}}",l.toString()):l,this.target.setAttribute("text",o)}}class xd extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromText="",this.toText="",this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",(o==null?void 0:o.showCursor)!==void 0&&(this.showCursor=o.showCursor),(o==null?void 0:o.cursorChar)!==void 0&&(this.cursorChar=o.cursorChar),(o==null?void 0:o.blinkCursor)!==void 0&&(this.blinkCursor=o.blinkCursor),(o==null?void 0:o.beforeText)!==void 0&&(this.beforeText=o.beforeText),(o==null?void 0:o.afterText)!==void 0&&(this.afterText=o.afterText)}onFirstRun(){var t,e;const i=this.getLastProps(),r=this.getEndProps(),o=(t=i.text)!==null&&t!==void 0?t:"",s=(e=r.text)!==null&&e!==void 0?e:"";this.valid=!0,this.fromText=o.toString(),this.toText=s.toString(),this.toText||this.toText===""||(this.valid=!1)}onEnd(t){super.onEnd(t),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}onUpdate(t,e,i){if(!this.valid)return;const r=this.toText.length,o=this.fromText.length;let s,a;o>r?(s=Math.round(o-(o-r)*e),a=this.fromText.substring(0,s)):(s=Math.round(o+(r-o)*e),a=this.toText.startsWith(this.fromText)?this.toText.substring(0,s):s<=o?this.fromText.substring(0,s):this.toText.substring(0,s-o+Math.min(o,s)));let l=this.beforeText+a+this.afterText;this.showCursor&&(this.blinkCursor?Math.floor(e/.1)%2==0&&(l=this.beforeText+a+this.cursorChar+this.afterText):l=this.beforeText+a+this.cursorChar+this.afterText),this.target.setAttribute("text",l)}}class pD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i;super.onBind();const r=this.target.getFinalAttribute(),o=(t=this.target.attribute)!==null&&t!==void 0?t:{},s={},a=(e=this.from)!==null&&e!==void 0?e:{};this.keys.forEach(u=>{var h,d,c;s[u]=(h=r==null?void 0:r[u])!==null&&h!==void 0?h:1,a[u]=(c=(d=a[u])!==null&&d!==void 0?d:o[u])!==null&&c!==void 0?c:0});const l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),this.props=s,this.propKeys=this.keys,this.from=a,this.to=s,((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(a)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class mD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const t=this.target.attribute,e={},i={};this.keys.forEach(r=>{var o;e[r]=0,i[r]=(o=t[r])!==null&&o!==void 0?o:1}),this.props=e,this.propKeys=this.keys,this.from=i,this.to=e,Object.assign(this.target.attribute,i),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class Wq extends pD{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["clipRange"],this.from={clipRange:0}}onFirstRun(){var t;super.onFirstRun();const{clipDimension:e}=((t=this.params)===null||t===void 0?void 0:t.options)||{};e&&(this.target.attribute.clipRangeByDimension=e)}}class Uq extends mD{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["clipRange"]}}class Vq extends pD{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["opacity","fillOpacity","strokeOpacity"],this.from={opacity:0,fillOpacity:0,strokeOpacity:0}}}class jq extends mD{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["opacity","fillOpacity","strokeOpacity"]}}const Gq=(n,t,e)=>{const i=n.getFinalAttribute();return t&&t.orient==="anticlockwise"?{from:{startAngle:i==null?void 0:i.endAngle},to:{startAngle:i==null?void 0:i.startAngle}}:{from:{endAngle:i==null?void 0:i.startAngle},to:{endAngle:i==null?void 0:i.endAngle}}},$q=(n,t,e)=>{const i=n.getFinalAttribute();if(t&&t.orient==="anticlockwise"){const o=ne(t.overall)?t.overall:2*Math.PI;return{from:{startAngle:o,endAngle:o},to:{startAngle:i==null?void 0:i.startAngle,endAngle:i==null?void 0:i.endAngle}}}const r=ne(t==null?void 0:t.overall)?t.overall:0;return{from:{startAngle:r,endAngle:r},to:{startAngle:i==null?void 0:i.startAngle,endAngle:i==null?void 0:i.endAngle}}},qq=(n,t,e)=>{var i;return((i=t==null?void 0:t.overall)!==null&&i!==void 0&&i)!==!1?$q(n,t):Gq(n,t)},Xq=(n,t,e)=>{const i=n.attribute;return t&&t.orient==="anticlockwise"?{from:{startAngle:i.startAngle},to:{startAngle:i==null?void 0:i.endAngle}}:{from:{endAngle:i.endAngle},to:{endAngle:i==null?void 0:i.startAngle}}},Yq=(n,t,e)=>{const i=n.attribute;if(t&&t.orient==="anticlockwise"){const o=ne(t.overall)?t.overall:2*Math.PI;return{from:{startAngle:i.startAngle,endAngle:i.endAngle},to:{startAngle:o,endAngle:o}}}const r=ne(t==null?void 0:t.overall)?t.overall:0;return{from:{startAngle:i.startAngle,endAngle:i.endAngle},to:{startAngle:r,endAngle:r}}};class vD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}determineUpdateFunction(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:this.propKeys[0]==="startAngle"?this._updateFunction=this.updateStartAngle:this.propKeys[0]==="endAngle"?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];const e=this.propKeys.indexOf(t);e!==-1&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:this.propKeys[0]==="startAngle"?this._updateFunction=this.updateStartAngle:this.propKeys[0]==="endAngle"?this._updateFunction=this.updateEndAngle:this._updateFunction=null}updateStartAngle(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}updateEndAngle(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}updateAngle(t){this.updateStartAngle(t),this.updateEndAngle(t)}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}class Kq extends vD{onBind(){var t,e;super.onBind();const{from:i,to:r}=qq(this.target,this.params.options,this.params),o=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:i;this.props=r,this.propKeys=Object.keys(r).filter(a=>r[a]!=null),this.from=o,this.to=r;const s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),this.target.setAttributes(o),this.determineUpdateFunction()}}class Zq extends vD{onBind(){super.onBind();const{from:t,to:e}=(i=this.target,r=this.params.options,this.params,((o=r==null?void 0:r.overall)!==null&&o!==void 0&&o)!==!1?Yq(i,r):Xq(i,r));var i,r,o;const s=t;this.props=e,this.propKeys=Object.keys(e).filter(a=>e[a]!=null),this.from=s??this.target.attribute,this.to=e,this.determineUpdateFunction()}}const Qq=(n,t,e)=>{const i=n.getFinalAttribute();switch(t==null?void 0:t.direction){case"x":{const r=i.x,o=i.x1,s=i.width;return{from:Et(s)?{x:r+s/2,x1:void 0,width:0}:{x:(r+o)/2,x1:(r+o)/2,width:void 0},to:{x:r,x1:o,width:s}}}case"y":{const r=i.y,o=i.y1,s=i.height;return{from:Et(s)?{y:r+s/2,y1:void 0,height:0}:{y:(r+o)/2,y1:(r+o)/2,height:void 0},to:{y:r,y1:o,height:s}}}default:{const r=i.x,o=i.x1,s=i.width,a=i.y,l=i.y1,u=i.height,h={};return Et(s)?(h.x=r+s/2,h.width=0,h.x1=void 0):(h.x=(r+o)/2,h.x1=(r+o)/2,h.width=void 0),Et(u)?(h.y=a+u/2,h.height=0,h.y1=void 0):(h.y=(a+l)/2,h.y1=(a+l)/2,h.height=void 0),{from:h,to:{x:r,y:a,x1:o,y1:l,width:s,height:u}}}}},Jq=(n,t,e)=>{const i=n.attribute;switch(t==null?void 0:t.direction){case"x":{const r=i.x,o=i.x1,s=i.width;return{to:Et(s)?{x:r+s/2,x1:void 0,width:0}:{x:(r+o)/2,x1:(r+o)/2,width:void 0}}}case"y":{const r=i.y,o=i.y1,s=i.height;return{to:Et(s)?{y:r+s/2,y1:void 0,height:0}:{y:(r+o)/2,y1:(r+o)/2,height:void 0}}}default:{const r=i.x,o=i.y,s=i.x1,a=i.y1,l=i.width,u=i.height,h={};return Et(l)?(h.x=r+l/2,h.width=0,h.x1=void 0):(h.x=(r+s)/2,h.x1=(r+s)/2,h.width=void 0),Et(u)?(h.y=o+u/2,h.height=0,h.y1=void 0):(h.y=(o+a)/2,h.y1=(o+a)/2,h.height=void 0),{to:h}}}};class tX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e;super.onBind();const{from:i,to:r}=Qq(this.target,this.params.options,this.params),o=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:i;this.props=r,this.propKeys=Object.keys(r).filter(a=>r[a]!=null),this.from=o,this.to=r;const s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),this.target.setAttributes(o)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class eX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const{from:t,to:e}=Jq(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(i=>e[i]!=null),this.from=t??this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}function iX(n,t,e){const i=n.getFinalAttribute(),r=i.y,o=i.y1,s=i.height;if(t&&t.orient==="negative"){const l=Et(s)?Math.max(r,r+s):Math.max(r,o);return{from:{y:l,y1:zt(o)?void 0:l,height:zt(s)?void 0:0},to:{y:r,y1:o,height:s}}}const a=Et(s)?Math.min(r,r+s):Math.min(r,o);return{from:{y:a,y1:zt(o)?void 0:a,height:zt(s)?void 0:0},to:{y:r,y1:o,height:s}}}function rX(n,t,e){var i,r,o;const s=n.getFinalAttribute(),a=s.y,l=s.y1,u=s.height;let h;return t&&t.orient==="negative"?ne(t.overall)?h=t.overall:e.group?(h=(o=(i=e.groupHeight)!==null&&i!==void 0?i:(r=t.layoutRect)===null||r===void 0?void 0:r.height)!==null&&o!==void 0?o:e.group.getBounds().height(),e.groupHeight=h):h=e.height:h=ne(t==null?void 0:t.overall)?t.overall:0,{from:{y:h,y1:zt(l)?void 0:h,height:zt(u)?void 0:0},to:{y:a,y1:l,height:u}}}const nX=(n,t,e)=>{var i;return((i=t==null?void 0:t.overall)!==null&&i!==void 0&&i)!==!1?rX(n,t,e):iX(n,t)};class oX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e;super.onBind();const{from:i,to:r}=nX(this.target,this.params.options,this.params),o=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:i;this.props=r,this.propKeys=Object.keys(r).filter(a=>r[a]!=null),this.from=o,this.to=r;const s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),this.target.setAttributes(o)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}function sX(n,t,e){const i=n.getFinalAttribute(),r=i.y,o=i.y1,s=i.height;if(t&&t.orient==="negative"){const l=Et(s)?Math.max(r,r+s):Math.max(r,o);return{to:{y:l,y1:zt(o)?void 0:l,height:zt(s)?void 0:0}}}const a=Et(s)?Math.min(r,r+s):Math.min(r,o);return{to:{y:a,y1:zt(o)?void 0:a,height:zt(s)?void 0:0}}}function aX(n,t,e){var i,r,o;const s=n.getFinalAttribute(),a=s.y1,l=s.height;let u;return t&&t.orient==="negative"?ne(t.overall)?u=t.overall:e.group?(u=(o=(i=e.groupHeight)!==null&&i!==void 0?i:(r=t.layoutRect)===null||r===void 0?void 0:r.height)!==null&&o!==void 0?o:e.group.getBounds().height(),e.groupHeight=u):u=e.height:u=ne(t==null?void 0:t.overall)?t.overall:0,{to:{y:u,y1:zt(a)?void 0:u,height:zt(l)?void 0:0}}}class lX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const{from:t,to:e}=(i=this.target,r=this.params.options,o=this.params,((s=r==null?void 0:r.overall)!==null&&s!==void 0&&s)!==!1?aX(i,r,o):sX(i,r));var i,r,o,s;this.props=e,this.propKeys=Object.keys(e).filter(a=>e[a]!=null),this.from=t??this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}const bD=(n,t,e)=>{const i=n.getFinalAttribute().points,r={x:0,y:0};return i.forEach(o=>{r.x+=o.x,r.y+=o.y}),r.x/=i.length,r.y/=i.length,t&&t.center&&(Ne(t.center.x)&&(r.x=t.center.x),Ne(t.center.y)&&(r.y=t.center.y)),n.type==="area"&&(r.x1=r.x,r.y1=r.y),i.map(o=>Object.assign({},o,r))},uX=(n,t,e)=>{const i=n.getFinalAttribute();return{from:{points:bD(n,t)},to:{points:i.points}}};class Uu extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){var r,o;const s=(r=this.from)===null||r===void 0?void 0:r.points,a=(o=this.to)===null||o===void 0?void 0:o.points;s&&a&&(this.target.attribute.points=s.map((l,u)=>L_(s[u],a[u],e)),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}class hX extends Uu{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:e,to:i}=uX(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}else this.valid=!1}}class dX extends Uu{onBind(){if(super.onBind(),["area","line"].includes(this.target.type)){const i=this.target.getFinalAttribute(),{from:r,to:o}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:bD(t,e)}});this.props=o,this.propKeys=Object.keys(o).filter(s=>o[s]!=null),this.from=r||i,this.to=o}else this.valid=!1;var t,e}}const _D=(n,t,e)=>n.getFinalAttribute().points.map(i=>{if(t&&t.orient==="negative"){let r=n.stage.viewWidth;return n.parent.parent.parent&&(r=n.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:r,y:i.y,x1:r,y1:i.y1,defined:i.defined!==!1})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:i.defined!==!1})}),cX=(n,t,e)=>{const i=n.getFinalAttribute();return{from:{points:_D(n,t)},to:{points:i.points}}};class fX extends Uu{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:e,to:i}=cX(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}else this.valid=!1}}class gX extends Uu{onBind(){if(super.onBind(),["area","line"].includes(this.target.type)){const i=this.target.getFinalAttribute(),{from:r,to:o}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:_D(t,e)}});this.props=o,this.propKeys=Object.keys(o).filter(s=>o[s]!=null),this.from=r||i,this.to=o}else this.valid=!1;var t,e}}const CD=(n,t,e)=>n.getFinalAttribute().points.map(i=>{if(t&&t.orient==="negative"){let r=n.stage.viewHeight;return n.parent.parent.parent&&(r=n.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:r,x1:i.x1,y1:r,defined:i.defined!==!1})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:i.defined!==!1})}),pX=(n,t,e)=>{const i=n.getFinalAttribute();return{from:{points:CD(n,t)},to:{points:i.points}}};class mX extends Uu{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:e,to:i}=pX(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}else this.valid=!1}}class vX extends Uu{onBind(){if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:i,to:r}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:CD(t,e)}});this.props=r,this.propKeys=Object.keys(r).filter(o=>r[o]!=null),this.from=i??this.target.attribute,this.to=r}else this.valid=!1;var t,e}}const bX=(n,t,e)=>{const i=n.getFinalAttribute();return t&&t.orient==="inside"?{from:{innerRadius:i==null?void 0:i.outerRadius},to:{innerRadius:i==null?void 0:i.innerRadius}}:{from:{outerRadius:i==null?void 0:i.innerRadius},to:{outerRadius:i==null?void 0:i.outerRadius}}},_X=(n,t,e)=>{const i=n.getFinalAttribute(),r=ne(t==null?void 0:t.overall)?t.overall:0;return{from:{innerRadius:r,outerRadius:r},to:{innerRadius:i==null?void 0:i.innerRadius,outerRadius:i==null?void 0:i.outerRadius}}},CX=(n,t,e)=>{var i;return((i=t==null?void 0:t.overall)!==null&&i!==void 0&&i)!==!1?_X(n,t):bX(n,t)},yX=(n,t,e)=>{const i=n.getFinalAttribute();return t&&t.orient==="inside"?{from:{innerRadius:i==null?void 0:i.innerRadius},to:{innerRadius:i==null?void 0:i.outerRadius}}:{from:{outerRadius:i==null?void 0:i.outerRadius},to:{outerRadius:i==null?void 0:i.innerRadius}}},wX=(n,t,e)=>{const i=n.getFinalAttribute(),r=ne(t==null?void 0:t.overall)?t.overall:0;return{from:{innerRadius:i==null?void 0:i.innerRadius,outerRadius:i==null?void 0:i.outerRadius},to:{innerRadius:r,outerRadius:r}}};class yD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class SX extends yD{onBind(){var t,e;super.onBind();const{from:i,to:r}=CX(this.target,this.params.options,this.params),o=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:i;this.props=r,this.propKeys=Object.keys(r).filter(a=>r[a]!=null),this.from=o,this.to=r;const s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),this.target.setAttributes(o)}}class xX extends yD{onBind(){super.onBind();const{to:t}=(e=this.target,i=this.params.options,this.params,((r=i==null?void 0:i.overall)!==null&&r!==void 0&&r)!==!1?wX(e,i):yX(e,i));var e,i,r;this.props=t,this.propKeys=Object.keys(t).filter(o=>t[o]!=null),this.from=this.target.attribute,this.to=t}}function TX(n,t,e){const i=n.getFinalAttribute(),r=i.x,o=i.x1,s=i.width;if(t&&t.orient==="negative"){const l=Et(s)?Math.max(r,r+s):Math.max(r,o);return{from:{x:l,x1:zt(o)?void 0:l,width:zt(s)?void 0:0},to:{x:r,x1:o,width:s}}}const a=Et(s)?Math.min(r,r+s):Math.min(r,o);return{from:{x:a,x1:zt(o)?void 0:a,width:zt(s)?void 0:0},to:{x:r,x1:o,width:s}}}function AX(n,t,e){var i;const r=n.getFinalAttribute(),o=r.x,s=r.x1,a=r.width;let l;return t&&t.orient==="negative"?ne(t.overall)?l=t.overall:e.group?(l=(i=e.groupWidth)!==null&&i!==void 0?i:e.group.getBounds().width(),e.groupWidth=l):l=e.width:l=ne(t==null?void 0:t.overall)?t==null?void 0:t.overall:0,{from:{x:l,x1:zt(s)?void 0:l,width:zt(a)?void 0:0},to:{x:o,x1:s,width:a}}}const RX=(n,t,e)=>{var i;return((i=t==null?void 0:t.overall)!==null&&i!==void 0&&i)!==!1?AX(n,t,e):TX(n,t)};function EX(n,t,e){const i=n.getFinalAttribute(),r=i.x,o=i.x1,s=i.width;if(t&&t.orient==="negative"){const l=Et(s)?Math.max(r,r+s):Math.max(r,o);return{to:{x:l,x1:zt(o)?void 0:l,width:zt(s)?void 0:0}}}const a=Et(s)?Math.min(r,r+s):Math.min(r,o);return{to:{x:a,x1:zt(o)?void 0:a,width:zt(s)?void 0:0}}}function MX(n,t,e){var i;const r=n.getFinalAttribute(),o=r.x1,s=r.width;let a;return t&&t.orient==="negative"?ne(t.overall)?a=t.overall:e.group?(a=(i=e.groupWidth)!==null&&i!==void 0?i:e.group.getBounds().width(),e.groupWidth=a):a=e.width:a=ne(t==null?void 0:t.overall)?t.overall:0,{to:{x:a,x1:zt(o)?void 0:a,width:zt(s)?void 0:0}}}class BX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e;super.onBind();const{from:i,to:r}=RX(this.target,this.params.options,this.params),o=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:i;this.props=r,this.propKeys=Object.keys(r).filter(a=>r[a]!=null),this.from=o,this.to=r;const s=this.target.getFinalAttribute();s&&this.target.setAttributes(s),this.target.setAttributes(o)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class PX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const{from:t,to:e}=(i=this.target,r=this.params.options,o=this.params,((s=r==null?void 0:r.overall)!==null&&s!==void 0&&s)!==!1?MX(i,r,o):EX(i,r));var i,r,o,s;this.props=e,this.propKeys=Object.keys(e).filter(a=>e[a]!=null),this.from=t??this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class kX extends Nu{onBind(){super.onBind();const t=Wu(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target,{symbolStartOuterType:o="scale",titleType:s="typewriter",titlePanelType:a="scale"}=this.params,l=e/10;let u,h;if(r._symbolStart.setAttributes({scaleX:0,scaleY:0}),t.animate(r._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*l,easing:i}),o==="scale"?(u={scaleX:0,scaleY:0},h={scaleX:1,scaleY:1}):(u={clipRange:0},h={clipRange:1}),r._symbolStartOuter.setAttributes(u),t.animate(r._symbolStartOuter,{type:"to",to:h,duration:5*l,easing:i}),r._symbolEnd.setAttributes({scaleX:0,scaleY:0}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*l,delay:8*l,easing:i}),r._line.setAttributes({clipRange:0}),t.animate(r._line,{type:"to",to:{clipRange:1},duration:9*l,easing:i}),s==="typewriter"){const d=r._titleTop.attribute.text;r._titleTop.setAttributes({text:""}),t.animate(r._titleTop,{type:"custom",delay:5*l,duration:4*l,easing:"linear",to:{text:d},custom:xd});const c=r._titleBottom.attribute.text;r._titleBottom.setAttributes({text:""}),t.animate(r._titleBottom,{type:"custom",delay:5*l,duration:4*l,easing:"linear",to:{text:c},custom:xd})}else r._titleTop.setAttributes({dy:r._titleTop.AABBBounds.height()+10}),t.animate(r._titleTop,{type:"to",to:{dy:0},delay:5*l,duration:4*l,easing:"linear"}),r._titleBottom.setAttributes({dy:-(10+r._titleBottom.AABBBounds.height())}),t.animate(r._titleBottom,{type:"to",to:{dy:0},delay:5*l,duration:4*l,easing:"linear"});a==="scale"?[r._titleTopPanel,r._titleBottomPanel].forEach(d=>{var c;const f=(c=d.attribute.scaleX)!==null&&c!==void 0?c:1;d.setAttributes({scaleX:0}),t.animate(d,{type:"to",to:{scaleX:f},duration:e,easing:i})}):a==="stroke"&&[r._titleTopPanel,r._titleBottomPanel].forEach(d=>{const c=d.AABBBounds,f=2*(c.width()+c.height());d.setAttributes({lineDash:[0,10*f]}),t.animate(d,{type:"to",to:{lineDash:[f,10*f]},duration:e,easing:i})}),this.completeBind(t)}}class LX extends Nu{onBind(){super.onBind();const t=Wu(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target,{mode:o}=this.params;o==="scale"?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:e,easing:i}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:e/2,easing:i}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:e/2,easing:i}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:e,easing:i}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:e,easing:i})),this.completeBind(t)}}class DX extends Nu{onBind(){super.onBind();const t=Wu(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target,{wave:o}=this.params;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:e/3*2,easing:i}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:e,easing:i,custom:xd}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:e,easing:i,custom:xd}),o){const s=e/6;t.animate(r.group,{timeSlices:[{duration:s,effects:{type:"to",to:{angle:o},easing:i}},{duration:2*s,effects:{type:"to",to:{angle:-o},easing:i}},{duration:2*s,effects:{type:"to",to:{angle:o},easing:i}},{duration:s,effects:{type:"to",to:{angle:0},easing:i}}]})}this.completeBind(t)}}class IX extends Nu{onBind(){super.onBind();const t=Wu(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),this.completeBind(t)}}class FX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.fadeInChars=!1,this.fadeInDuration=.3,this.strokeFirst=!1,this.strokeToFillRatio=.3,(o==null?void 0:o.showCursor)!==void 0&&(this.showCursor=o.showCursor),(o==null?void 0:o.cursorChar)!==void 0&&(this.cursorChar=o.cursorChar),(o==null?void 0:o.blinkCursor)!==void 0&&(this.blinkCursor=o.blinkCursor),(o==null?void 0:o.fadeInChars)!==void 0&&(this.fadeInChars=o.fadeInChars),(o==null?void 0:o.fadeInDuration)!==void 0&&(this.fadeInDuration=o.fadeInDuration),(o==null?void 0:o.strokeFirst)!==void 0&&(this.strokeFirst=o.strokeFirst),(o==null?void 0:o.strokeToFillRatio)!==void 0&&(this.strokeToFillRatio=o.strokeToFillRatio)}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?li.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=li.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){if(!this.valid)return;const r=this.toTextConfig.length,o=this.fromTextConfig.length,s=this.fadeInChars?1-this.fadeInDuration:1;let a,l;if(o>r)a=Math.round(o-(o-r)*e);else if(this.fadeInChars){const u=Math.min(1,e/s);a=Math.round(o+(r-o)*u)}else a=Math.round(o+(r-o)*e);if(l=o>r?this.fromTextConfig.slice(0,a):this.toTextConfig.slice(0,a).map((u,h)=>{if("text"in u){const d=Object.assign({},u);if(this.strokeFirst){const c=h/r*s,f=Math.max(0,e-c),g=1-c,m=Math.min(1,f/(this.strokeToFillRatio*g));if("fill"in d&&d.fill&&(d.stroke=d.fill,m<1&&(d.fillOpacity=m)),this.fadeInChars){const p=Math.min(1,f/(this.fadeInDuration*g));d.opacity=Math.max(0,Math.min(1,p))}}else if(this.fadeInChars){const c=(e-h/r*s)/this.fadeInDuration;d.opacity=Math.max(0,Math.min(1,c))}return d}return u}),this.showCursor&&a<r){let u=!0;if(this.blinkCursor&&(u=Math.floor(e/.1)%2==0),u&&l.length>0){const h=l.length-1,d=l[h];if("text"in d)l[h]=Object.assign(Object.assign({},d),{text:String(d.text)+this.cursorChar});else{const c={text:this.cursorChar,fontSize:16};l.push(c)}}}this.target.setAttribute("textConfig",l)}}class OX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",this.fadeOutChars=!1,this.fadeOutDuration=.3,this.direction="backward",(o==null?void 0:o.showCursor)!==void 0&&(this.showCursor=o.showCursor),(o==null?void 0:o.cursorChar)!==void 0&&(this.cursorChar=o.cursorChar),(o==null?void 0:o.blinkCursor)!==void 0&&(this.blinkCursor=o.blinkCursor),(o==null?void 0:o.beforeText)!==void 0&&(this.beforeText=o.beforeText),(o==null?void 0:o.afterText)!==void 0&&(this.afterText=o.afterText),(o==null?void 0:o.fadeOutChars)!==void 0&&(this.fadeOutChars=o.fadeOutChars),(o==null?void 0:o.fadeOutDuration)!==void 0&&(this.fadeOutDuration=o.fadeOutDuration),(o==null?void 0:o.direction)!==void 0&&(this.direction=o.direction),this.propKeys=["textConfig"]}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=li.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?li.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){if(!this.valid)return;const r=this.fromTextConfig.length,o=this.fadeOutChars?1-this.fadeOutDuration:1;let s;if(this.direction==="forward"){if(this.fadeOutChars){const l=Math.min(1,e/o);s=Math.round(r*(1-l))}else s=Math.round(r*(1-e));let a=this.direction==="forward"?this.fromTextConfig.slice(r-s):this.fromTextConfig.slice(0,s);this.fadeOutChars&&(a=this.applyFadeEffect(a,e,r,s)),this.showCursor&&s>0&&(a=this.addCursor(a,e)),this.target.setAttribute("textConfig",a)}else{if(this.fadeOutChars){const l=Math.min(1,e/o);s=Math.round(r*(1-l))}else s=Math.round(r*(1-e));let a=this.fromTextConfig.slice(0,s);this.fadeOutChars&&(a=this.applyFadeEffect(a,e,r,s)),this.showCursor&&s>0&&(a=this.addCursor(a,e)),this.target.setAttribute("textConfig",a)}}applyFadeEffect(t,e,i,r){this.direction==="forward"&&i-r;const o=(e-(1-this.fadeOutDuration))/this.fadeOutDuration,s=Math.max(0,1-Math.min(1,o));return t.map((a,l)=>{if(this.direction==="forward"){if(l===0&&"text"in a)return Object.assign(Object.assign({},a),{opacity:s})}else if(l===t.length-1&&"text"in a)return Object.assign(Object.assign({},a),{opacity:s});return a})}addCursor(t,e){let i=!0;if(this.blinkCursor&&(i=Math.floor(e/.1)%2==0),i&&t.length>0){const r=this.direction==="forward"?0:t.length-1,o=t[r];if("text"in o){const s=[...t];return this.direction==="forward"?s[r]=Object.assign(Object.assign({},o),{text:this.cursorChar+String(o.text)}):s[r]=Object.assign(Object.assign({},o),{text:String(o.text)+this.cursorChar}),s}}return t}}class HX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeInDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],(o==null?void 0:o.fadeInDuration)!==void 0&&(this.fadeInDuration=o.fadeInDuration),(o==null?void 0:o.slideDirection)!==void 0&&(this.slideDirection=o.slideDirection),(o==null?void 0:o.slideDistance)!==void 0&&(this.slideDistance=o.slideDistance),(o==null?void 0:o.wordByWord)!==void 0&&(this.wordByWord=o.wordByWord),(o==null?void 0:o.wordRegex)!==void 0&&(this.wordRegex=o.wordRegex)}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?li.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=li.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map(i=>"text"in i?Object.assign(Object.assign({},i),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}):Object.assign(Object.assign({},i),{opacity:0})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="";const e={};let i,r=0;for(this.toTextConfig.forEach((s,a)=>{if("text"in s){const l=String(s.text);t+=l,e[r]=a,r++}}),this.wordRegex.lastIndex=0;(i=this.wordRegex.exec(t))!==null;){const s=i.index,a=i.index+i[0].length,l=[];for(let u=s;u<a;u++)e[u]!==void 0&&l.push(e[u]);l.length>0&&this.wordGroups.push(l)}const o=new Set;this.wordGroups.forEach(s=>{s.forEach(a=>o.add(a))});for(let s=0;s<this.toTextConfig.length;s++)"text"in this.toTextConfig[s]&&!o.has(s)&&this.wordGroups.push([s])}getInitialDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getInitialDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){if(!this.valid)return;const r=1-this.fadeInDuration;let o;o=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",o)}updateByWord(t,e){const i=this.wordGroups.length,r=[...this.singleCharConfig];for(let o=0;o<this.wordGroups.length;o++){let s;if(s=this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<s){for(const d of this.wordGroups[o]){const c=r[d];"text"in c&&(r[d]=Object.assign(Object.assign({},c),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}continue}const a=(t-s)/this.fadeInDuration,l=Math.max(0,Math.min(1,a)),u=this.getInitialDx()*(1-l),h=this.getInitialDy()*(1-l);for(const d of this.wordGroups[o]){const c=r[d];"text"in c&&(r[d]=Object.assign(Object.assign({},c),{opacity:l,dx:u,dy:h}))}}return r}updateByCharacter(t,e){const i=this.toTextConfig.length,r=[...this.singleCharConfig];for(let o=0;o<r.length;o++){const s=r[o];if("text"in s){let a;if(a=this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<a){r[o]=Object.assign(Object.assign({},s),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}const l=(t-a)/this.fadeInDuration,u=Math.max(0,Math.min(1,l)),h=this.getInitialDx()*(1-u),d=this.getInitialDy()*(1-u);r[o]=Object.assign(Object.assign({},s),{opacity:u,dx:h,dy:d})}}return r}}class zX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeOutDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],this.reverseOrder=!1,(o==null?void 0:o.fadeOutDuration)!==void 0&&(this.fadeOutDuration=o.fadeOutDuration),(o==null?void 0:o.slideDirection)!==void 0&&(this.slideDirection=o.slideDirection),(o==null?void 0:o.slideDistance)!==void 0&&(this.slideDistance=o.slideDistance),(o==null?void 0:o.wordByWord)!==void 0&&(this.wordByWord=o.wordByWord),(o==null?void 0:o.wordRegex)!==void 0&&(this.wordRegex=o.wordRegex),(o==null?void 0:o.reverseOrder)!==void 0&&(this.reverseOrder=o.reverseOrder),this.propKeys=["textConfig"]}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=li.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?li.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map(i=>"text"in i?Object.assign(Object.assign({},i),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},i),{opacity:1})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="";const e={};let i,r=0;for(this.fromTextConfig.forEach((s,a)=>{if("text"in s){const l=String(s.text);t+=l,e[r]=a,r++}}),this.wordRegex.lastIndex=0;(i=this.wordRegex.exec(t))!==null;){const s=i.index,a=i.index+i[0].length,l=[];for(let u=s;u<a;u++)e[u]!==void 0&&l.push(e[u]);l.length>0&&this.wordGroups.push(l)}const o=new Set;this.wordGroups.forEach(s=>{s.forEach(a=>o.add(a))});for(let s=0;s<this.fromTextConfig.length;s++)"text"in this.fromTextConfig[s]&&!o.has(s)&&this.wordGroups.push([s])}getTargetDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getTargetDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){if(!this.valid)return;const r=1-this.fadeOutDuration;let o;o=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",o)}updateByWord(t,e){const i=this.wordGroups.length,r=[...this.singleCharConfig];for(let o=0;o<this.wordGroups.length;o++){let s;if(s=this.reverseOrder?this.slideDirection==="left"?o/i*e:(i-1-o)/i*e:this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<s){for(const c of this.wordGroups[o]){const f=r[c];"text"in f&&(r[c]=Object.assign(Object.assign({},f),{opacity:1,dx:0,dy:0}))}continue}const a=(t-s)/this.fadeOutDuration,l=Math.max(0,Math.min(1,a)),u=this.getTargetDx()*l,h=this.getTargetDy()*l,d=1-l;for(const c of this.wordGroups[o]){const f=r[c];"text"in f&&(r[c]=Object.assign(Object.assign({},f),{opacity:d,dx:u,dy:h}))}}return r}updateByCharacter(t,e){const i=this.fromTextConfig.length,r=[...this.singleCharConfig];for(let o=0;o<r.length;o++){const s=r[o];if("text"in s){let a;if(a=this.reverseOrder?this.slideDirection==="left"?o/i*e:(i-1-o)/i*e:this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<a){r[o]=Object.assign(Object.assign({},s),{opacity:1,dx:0,dy:0});continue}const l=(t-a)/this.fadeOutDuration,u=Math.max(0,Math.min(1,l)),h=this.getTargetDx()*u,d=this.getTargetDy()*u,c=1-u;r[o]=Object.assign(Object.assign({},s),{opacity:c,dx:h,dy:d})}}return r}}class NX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a,l,u,h,d;let c,f;super.onBind();const g=this.target.getFinalAttribute(),m=(t=this.target.attribute)!==null&&t!==void 0?t:{};switch((e=this.params)===null||e===void 0?void 0:e.direction){case"x":c={scaleX:(i=m.scaleX)!==null&&i!==void 0?i:0},f={scaleX:(r=g==null?void 0:g.scaleX)!==null&&r!==void 0?r:1},this._updateFunction=this.updateX;break;case"y":c={scaleY:(o=m.scaleY)!==null&&o!==void 0?o:0},f={scaleY:(s=g==null?void 0:g.scaleY)!==null&&s!==void 0?s:1},this._updateFunction=this.updateY;break;default:c={scaleX:(a=m.scaleX)!==null&&a!==void 0?a:0,scaleY:(l=m.scaleY)!==null&&l!==void 0?l:0},f={scaleX:(u=g==null?void 0:g.scaleX)!==null&&u!==void 0?u:1,scaleY:(h=g==null?void 0:g.scaleY)!==null&&h!==void 0?h:1},this._updateFunction=this.updateXY}const p=this.target.getFinalAttribute();p&&this.target.setAttributes(p),this.props=f,this.from=c,this.to=f,((d=this.params.controlOptions)===null||d===void 0?void 0:d.immediatelyApply)!==!1&&this.target.setAttributes(c)}onEnd(t){super.onEnd(t)}updateX(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}updateY(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}updateXY(t){this.updateX(t),this.updateY(t)}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];const e=this.propKeys.indexOf(t);e!==-1&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:this.propKeys[0]==="scaleX"?this._updateFunction=this.updateX:this.propKeys[0]==="scaleY"?this._updateFunction=this.updateY:this._updateFunction=null}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}class WX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o;let s,a;super.onBind();const l=this.target.attribute;switch((t=this.params)===null||t===void 0?void 0:t.direction){case"x":s={scaleX:(e=l==null?void 0:l.scaleX)!==null&&e!==void 0?e:1},a={scaleX:0};break;case"y":s={scaleY:(i=l==null?void 0:l.scaleY)!==null&&i!==void 0?i:1},a={scaleY:0};break;default:s={scaleX:(r=l==null?void 0:l.scaleX)!==null&&r!==void 0?r:1,scaleY:(o=l==null?void 0:l.scaleY)!==null&&o!==void 0?o:1},a={scaleX:0,scaleY:0}}this.props=a,this.from=s,this.to=a}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}class UX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.fromProps[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}class Hw extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a,l,u,h,d,c;super.onBind();const f=this.target.getFinalAttribute(),g=((t=this.params)===null||t===void 0?void 0:t.direction)||"right",m=((e=this.params)===null||e===void 0?void 0:e.distance)||50,p=(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:0,v={opacity:p,baseOpacity:p},b={opacity:1,baseOpacity:1};g==="top"?(v.y=((o=f.y)!==null&&o!==void 0?o:0)-m,b.y=(s=f.y)!==null&&s!==void 0?s:0,this.propKeys=["opacity","baseOpacity","y"]):g==="bottom"?(v.y=((a=f.y)!==null&&a!==void 0?a:0)+m,b.y=(l=f.y)!==null&&l!==void 0?l:0,this.propKeys=["opacity","baseOpacity","y"]):g==="left"?(v.x=((u=f.x)!==null&&u!==void 0?u:0)-m,b.x=(h=f.x)!==null&&h!==void 0?h:0,this.propKeys=["opacity","baseOpacity","x"]):(v.x=((d=f.x)!==null&&d!==void 0?d:0)+m,b.x=(c=f.x)!==null&&c!==void 0?c:0,this.propKeys=["opacity","baseOpacity","x"]),this.from=v,this.to=b,this.props=b,this.target.setAttributes(v)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class wD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a;super.onBind();const l=this.target.getFinalAttribute(),u=(e=(t=this.params)===null||t===void 0?void 0:t.fromScale)!==null&&e!==void 0?e:0,h=((i=this.params)===null||i===void 0?void 0:i.direction)||"xy",d=(o=(r=this.params)===null||r===void 0?void 0:r.fromOpacity)!==null&&o!==void 0?o:0,c={opacity:d,baseOpacity:d},f={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],h!=="x"&&h!=="xy"||(c.scaleX=u,f.scaleX=(s=l.scaleX)!==null&&s!==void 0?s:1,this.propKeys.push("scaleX")),h!=="y"&&h!=="xy"||(c.scaleY=u,f.scaleY=(a=l.scaleY)!==null&&a!==void 0?a:1,this.propKeys.push("scaleY")),this.from=c,this.to=f,this.props=f,this.target.setAttributes(c)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class SD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a,l,u;super.onBind();const h=this.target.getFinalAttribute(),d=(e=(t=this.params)===null||t===void 0?void 0:t.fromAngle)!==null&&e!==void 0?e:2*Math.PI,c=(r=(i=this.params)===null||i===void 0?void 0:i.fromScale)!==null&&r!==void 0?r:0,f=(s=(o=this.params)===null||o===void 0?void 0:o.fromOpacity)!==null&&s!==void 0?s:0,g={opacity:f,baseOpacity:f,angle:d,scaleX:c,scaleY:c},m={opacity:1,baseOpacity:1,angle:(a=h.angle)!==null&&a!==void 0?a:0,scaleX:(l=h.scaleX)!==null&&l!==void 0?l:1,scaleY:(u=h.scaleY)!==null&&u!==void 0?u:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=g,this.to=m,this.props=m,this.target.setAttributes(g)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class VX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.perimeter=0,this.originalAttributes={}}onBind(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b;if(super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.target.type==="rect"){const S=this.target.attribute,x=(t=S.width)!==null&&t!==void 0?t:100,E=(e=S.height)!==null&&e!==void 0?e:100;this.perimeter=2*(x+E)}else if(this.target.type==="circle"){const S=(i=this.target.attribute.radius)!==null&&i!==void 0?i:50;this.perimeter=2*Math.PI*S}else if(this.target.type==="ellipse"){const S=this.target.attribute,x=(r=S.radiusX)!==null&&r!==void 0?r:50,E=(o=S.radiusY)!==null&&o!==void 0?o:50;this.perimeter=2*Math.PI*Math.sqrt((x*x+E*E)/2)}else this.perimeter=1e3;const C=(a=(s=this.params)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:2,y=(u=(l=this.params)===null||l===void 0?void 0:l.strokeColor)!==null&&u!==void 0?u:"black",w=(d=(h=this.params)===null||h===void 0?void 0:h.fromOpacity)!==null&&d!==void 0?d:1,_=(f=(c=this.params)===null||c===void 0?void 0:c.dashLength)!==null&&f!==void 0?f:this.perimeter,A=(m=(g=this.params)===null||g===void 0?void 0:g.showFill)!==null&&m!==void 0&&m,T=(v=(p=this.params)===null||p===void 0?void 0:p.fillOpacity)!==null&&v!==void 0?v:0;this.from={lineDash:[_,_],lineDashOffset:_,lineWidth:C,stroke:y,strokeOpacity:w},this.to={lineDash:[_,_],lineDashOffset:0,lineWidth:C,stroke:y,strokeOpacity:w},A?(this.from.fillOpacity=T,this.to.fillOpacity=(b=this.originalAttributes.fillOpacity)!==null&&b!==void 0?b:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;const o=this.target.attribute;o.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,!((r=this.params)===null||r===void 0)&&r.showFill&&(o.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}onEnd(){var t;if(super.onEnd(),!(!((t=this.params)===null||t===void 0)&&t.showFill)){const e=Object.assign({},this.originalAttributes);e.fillOpacity=0,this.target.setAttributes(e)}}}class jX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.perimeter=0,this.originalAttributes={}}onFirstRun(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),this.target.type==="rect"){const _=this.target.attribute,A=(t=_.width)!==null&&t!==void 0?t:100,T=(e=_.height)!==null&&e!==void 0?e:100;this.perimeter=2*(A+T)}else if(this.target.type==="circle"){const _=(i=this.target.attribute.radius)!==null&&i!==void 0?i:50;this.perimeter=2*Math.PI*_}else if(this.target.type==="ellipse"){const _=this.target.attribute,A=(r=_.radiusX)!==null&&r!==void 0?r:50,T=(o=_.radiusY)!==null&&o!==void 0?o:50;this.perimeter=2*Math.PI*Math.sqrt((A*A+T*T)/2)}else this.perimeter=1e3;const v=(a=(s=this.params)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:2,b=(u=(l=this.params)===null||l===void 0?void 0:l.strokeColor)!==null&&u!==void 0?u:"black",C=(d=(h=this.params)===null||h===void 0?void 0:h.fromOpacity)!==null&&d!==void 0?d:1,y=(f=(c=this.params)===null||c===void 0?void 0:c.dashLength)!==null&&f!==void 0?f:this.perimeter,w=(m=(g=this.params)===null||g===void 0?void 0:g.showFill)!==null&&m!==void 0&&m;this.from={lineDash:[y,y],lineDashOffset:0,lineWidth:v,stroke:b,strokeOpacity:C},this.to={lineDash:[y,y],lineDashOffset:-y,lineWidth:v,stroke:b,strokeOpacity:C},w?(this.from.fillOpacity=(p=this.originalAttributes.fillOpacity)!==null&&p!==void 0?p:1,this.to.fillOpacity=0):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;const o=this.target.attribute;o.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,!((r=this.params)===null||r===void 0)&&r.showFill&&(o.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}class GX extends ve{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o==null?void 0:o.slideRatio)!==null&&s!==void 0?s:.5;this.slideInDuration=i*a,this.growInDuration=i*(1-a)}onBind(){var t,e,i,r,o,s;super.onBind();const a=new Vt(this.target);a.execute({type:"custom",custom:Hw,customParameters:{direction:((t=this.params)===null||t===void 0?void 0:t.slideDirection)||"right",distance:((e=this.params)===null||e===void 0?void 0:e.slideDistance)||50,fromOpacity:(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:0},duration:this.slideInDuration,easing:this.easing}),a.execute({type:"custom",custom:wD,customParameters:{fromScale:((o=this.params)===null||o===void 0?void 0:o.fromScale)||.5,direction:((s=this.params)===null||s===void 0?void 0:s.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class $X extends ve{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o==null?void 0:o.slideRatio)!==null&&s!==void 0?s:.5;this.slideInDuration=i*a,this.spinInDuration=i*(1-a)}onBind(){var t,e,i,r,o,s;super.onBind();const a=new Vt(this.target);a.execute({type:"custom",custom:Hw,customParameters:{direction:((t=this.params)===null||t===void 0?void 0:t.slideDirection)||"right",distance:((e=this.params)===null||e===void 0?void 0:e.slideDistance)||50,fromOpacity:(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:0},duration:this.slideInDuration,easing:this.easing}),a.execute({type:"custom",custom:SD,customParameters:{fromAngle:((o=this.params)===null||o===void 0?void 0:o.fromAngle)||Math.PI,fromScale:((s=this.params)===null||s===void 0?void 0:s.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class zw extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onFirstRun(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g;const m=this.target.getAttributes(),p=((t=this.params)===null||t===void 0?void 0:t.direction)||"right",v=((e=this.params)===null||e===void 0?void 0:e.distance)||50,b=(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:1,C=(s=(o=this.params)===null||o===void 0?void 0:o.toOpacity)!==null&&s!==void 0?s:0,y={opacity:b,baseOpacity:b},w={opacity:C,baseOpacity:C};p==="top"?(y.y=(a=m.y)!==null&&a!==void 0?a:0,w.y=((l=m.y)!==null&&l!==void 0?l:0)-v,this.propKeys=["opacity","baseOpacity","y"]):p==="bottom"?(y.y=(u=m.y)!==null&&u!==void 0?u:0,w.y=((h=m.y)!==null&&h!==void 0?h:0)+v,this.propKeys=["opacity","baseOpacity","y"]):p==="left"?(y.x=(d=m.x)!==null&&d!==void 0?d:0,w.x=((c=m.x)!==null&&c!==void 0?c:0)-v,this.propKeys=["opacity","baseOpacity","x"]):(y.x=(f=m.x)!==null&&f!==void 0?f:0,w.x=((g=m.x)!==null&&g!==void 0?g:0)+v,this.propKeys=["opacity","baseOpacity","x"]),this.from=y,this.to=w,this.props=w}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class xD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onFirstRun(){var t,e,i,r,o,s,a,l,u;const h=this.target.getAttributes(),d=(e=(t=this.params)===null||t===void 0?void 0:t.fromScale)!==null&&e!==void 0?e:0,c=((i=this.params)===null||i===void 0?void 0:i.direction)||"xy",f=(o=(r=this.params)===null||r===void 0?void 0:r.fromOpacity)!==null&&o!==void 0?o:1,g=(a=(s=this.params)===null||s===void 0?void 0:s.toOpacity)!==null&&a!==void 0?a:0,m={opacity:f,baseOpacity:f},p={opacity:g,baseOpacity:g};this.propKeys=["opacity","baseOpacity"],c!=="x"&&c!=="xy"||(m.scaleX=(l=h.scaleX)!==null&&l!==void 0?l:1,p.scaleX=d,this.propKeys.push("scaleX")),c!=="y"&&c!=="xy"||(m.scaleY=(u=h.scaleY)!==null&&u!==void 0?u:1,p.scaleY=d,this.propKeys.push("scaleY")),this.from=m,this.to=p,this.props=p}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class TD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onFirstRun(){var t,e,i,r,o,s,a,l,u,h,d;const c=this.target.getAttributes(),f=(e=(t=this.params)===null||t===void 0?void 0:t.fromAngle)!==null&&e!==void 0?e:2*Math.PI,g=(r=(i=this.params)===null||i===void 0?void 0:i.fromScale)!==null&&r!==void 0?r:0,m=(s=(o=this.params)===null||o===void 0?void 0:o.fromOpacity)!==null&&s!==void 0?s:1,p=(l=(a=this.params)===null||a===void 0?void 0:a.toOpacity)!==null&&l!==void 0?l:0,v={opacity:m,baseOpacity:m,angle:(u=c.angle)!==null&&u!==void 0?u:0,scaleX:(h=c.scaleX)!==null&&h!==void 0?h:1,scaleY:(d=c.scaleY)!==null&&d!==void 0?d:1},b={opacity:p,baseOpacity:p,angle:f,scaleX:g,scaleY:g};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=v,this.to=b,this.props=b}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class qX extends ve{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o==null?void 0:o.slideRatio)!==null&&s!==void 0?s:.5;this.growOutDuration=i*(1-a),this.slideOutDuration=i*a}onFirstRun(){var t,e,i,r;const o=new Vt(this.target);o.execute({type:"custom",custom:xD,customParameters:{fromScale:((t=this.params)===null||t===void 0?void 0:t.fromScale)||.5,direction:((e=this.params)===null||e===void 0?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),o.execute({type:"custom",custom:zw,customParameters:{direction:((i=this.params)===null||i===void 0?void 0:i.slideDirection)||"right",distance:((r=this.params)===null||r===void 0?void 0:r.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}onUpdate(t,e,i){}}class XX extends ve{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o==null?void 0:o.slideRatio)!==null&&s!==void 0?s:.5;this.spinOutDuration=i*(1-a),this.slideOutDuration=i*a}onFirstRun(){var t,e,i,r;const o=new Vt(this.target);o.execute({type:"custom",custom:TD,customParameters:{fromAngle:((t=this.params)===null||t===void 0?void 0:t.fromAngle)||Math.PI,fromScale:((e=this.params)===null||e===void 0?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),o.execute({type:"custom",custom:zw,customParameters:{direction:((i=this.params)===null||i===void 0?void 0:i.slideDirection)||"right",distance:((r=this.params)===null||r===void 0?void 0:r.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}onUpdate(t,e,i){}}class YX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.originalAttributes={},this.pulseCount=3,this.pulseOpacity=.3,this.pulseScale=1.05,this.pulseColor=null,this.pulseColorIntensity=.2,this.strokeOnly=!1,this.fillOnly=!1,this.useScale=!0,this.useOpacity=!0,this.useStroke=!0,this.useFill=!0,this.useColor=!1,this.originalFill=null,this.originalStroke=null,(o==null?void 0:o.pulseCount)!==void 0&&(this.pulseCount=o.pulseCount),(o==null?void 0:o.pulseScale)!==void 0&&(this.pulseScale=o.pulseScale),(o==null?void 0:o.pulseColor)!==void 0&&(this.pulseColor=o.pulseColor),(o==null?void 0:o.pulseColorIntensity)!==void 0&&(this.pulseColorIntensity=o.pulseColorIntensity),(o==null?void 0:o.strokeOnly)!==void 0&&(this.strokeOnly=o.strokeOnly),(o==null?void 0:o.fillOnly)!==void 0&&(this.fillOnly=o.fillOnly),(o==null?void 0:o.useScale)!==void 0&&(this.useScale=o.useScale),(o==null?void 0:o.useOpacity)!==void 0&&(this.useOpacity=o.useOpacity),(o==null?void 0:o.useStroke)!==void 0&&(this.useStroke=o.useStroke),(o==null?void 0:o.useFill)!==void 0&&(this.useFill=o.useFill),(o==null?void 0:o.useColor)!==void 0&&(this.useColor=o.useColor)}onBind(){super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}onUpdate(t,e,i){const r=e*Math.PI*this.pulseCount,o=Math.abs(Math.sin(r)),s=this.target.attribute;if(this.useOpacity){const a=1+(this.pulseOpacity-1)*o;this.useStroke&&(s.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*a),this.useFill&&(s.fillOpacity=(this.originalAttributes.fillOpacity||1)*a)}if(this.useScale){const a=1+(this.pulseScale-1)*o;s.scaleX=(this.originalAttributes.scaleX||1)*a,s.scaleY=(this.originalAttributes.scaleY||1)*a}this.useColor&&this.pulseColor&&this.applyColorPulse(s,o),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}applyColorPulse(t,e){const i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=Ya(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=Ya(this.originalStroke,this.pulseColor,i,!0))}onEnd(){super.onEnd(),this.target.setAttributes(this.originalAttributes)}}class KX extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e;super.onBind();let{diffAttrs:i={}}=(t=this.target.context)!==null&&t!==void 0?t:{};const{options:r}=this.params;i=Object.assign({},i),!((e=r==null?void 0:r.excludeChannels)===null||e===void 0)&&e.length&&r.excludeChannels.forEach(o=>{delete i[o]}),this.props=i}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.fromProps[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i)}}const ZX=(n,t,e)=>{var i,r,o,s;const{offset:a=0,orient:l,direction:u,point:h,excludeChannels:d=[],layoutRect:c={}}=t??{};let f=0,g=0;l==="negative"&&(f=(i=c.width)!==null&&i!==void 0?i:n.stage.viewWidth,g=(r=c.height)!==null&&r!==void 0?r:n.stage.viewHeight),f+=a,g+=a;const m=Ce(h)?h.call(null,(s=(o=n.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],n,e):h,p=m&&Ne(m.x)?m.x:f,v=m&&Ne(m.y)?m.y:g,b=n.getFinalAttribute(),C=d.includes("x")?n.attribute.x:b.x,y=d.includes("y")?n.attribute.y:b.y;switch(u){case"x":return{from:{x:p},to:{x:C}};case"y":return{from:{y:v},to:{y}};default:return{from:{x:p,y:v},to:{x:C,y}}}},QX=(n,t,e)=>{var i,r,o,s;const{offset:a=0,orient:l,direction:u,point:h}=t??{},d=e.group?e.group.AABBBounds:null,c=(i=d.width())!==null&&i!==void 0?i:e.width,f=(r=d.height())!==null&&r!==void 0?r:e.height,g=(l==="negative"?c:0)+a,m=(l==="negative"?f:0)+a,p=Ce(h)?h.call(null,(s=(o=n.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],n,e):h,v=p&&Ne(p.x)?p.x:g,b=p&&Ne(p.y)?p.y:m;switch(u){case"x":return{from:{x:n.attribute.x},to:{x:v}};case"y":return{from:{y:n.attribute.y},to:{y:b}};default:return{from:{x:n.attribute.x,y:n.attribute.y},to:{x:v,y:b}}}};class AD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class JX extends AD{onBind(){var t;super.onBind();const{from:e,to:i}=ZX(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}}class tY extends AD{onBind(){super.onBind();const{from:t,to:e}=QX(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(i=>e[i]!=null),this.from=t,this.to=e}}const eY=(n,t)=>{var e;const i=(e=n.getFinalAttribute().angle)!==null&&e!==void 0?e:0;let r=0;return r=Xn(i/(2*Math.PI),0)?Math.round(i/(2*Math.PI))*Math.PI*2:Ne(t==null?void 0:t.angle)?t.angle:(t==null?void 0:t.orient)==="anticlockwise"?Math.ceil(i/(2*Math.PI))*Math.PI*2:Math.floor(i/(2*Math.PI))*Math.PI*2,{from:{angle:r},to:{angle:i}}},iY=(n,t)=>{var e;const i=(e=n.getFinalAttribute().angle)!==null&&e!==void 0?e:0;let r=0;return r=Xn(i/(2*Math.PI),0)?Math.round(i/(2*Math.PI))*Math.PI*2:Ne(t==null?void 0:t.angle)?t.angle:(t==null?void 0:t.orient)==="anticlockwise"?Math.ceil(i/(2*Math.PI))*Math.PI*2:Math.floor(i/(2*Math.PI))*Math.PI*2,{from:{angle:i},to:{angle:r}}};class RD extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class rY extends RD{onBind(){var t;super.onBind();const{from:e,to:i}=eY(this.target,this.params.options);this.props=i,this.propKeys=["angle"],this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}}class nY extends RD{onBind(){super.onBind();const{from:t,to:e}=iY(this.target,this.params.options);this.props=e,this.propKeys=["angle"],this.from=t,this.to=e}}class oY extends ve{constructor(t,e,i,r,o){var s;super(t,e,i,r,o),o&&(this.pathLength=o.path.getLength(),this.path=o.path,this.distance=o.distance,this.totalLength=this.distance*this.pathLength,this.initAngle=(s=o.initAngle)!==null&&s!==void 0?s:0,this.changeAngle=!!o.changeAngle,this.cb=o.cb)}onBind(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}onUpdate(t,e,i){const r={},o=this.totalLength*e,{pos:s,angle:a}=this.path.getAttrAt(o);r.x=s.x,r.y=s.y,this.changeAngle&&(r.angle=a+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(r)}}class sY extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o),this.from=t??{}}onBind(){var t,e;super.onBind(),Object.keys(this.from).forEach(r=>{this.props[r]==null&&(this.props[r]=this.target.getGraphicAttribute(r))});const i=this.target.getFinalAttribute();((t=this.target.context)===null||t===void 0?void 0:t.animationState)==="appear"&&i&&this.target.setAttributes(i),((e=this.params.controlOptions)===null||e===void 0?void 0:e.immediatelyApply)!==!1&&this.target.setAttributes(this.from)}onFirstRun(){this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);const t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.from[e]=(i=this.from[e])!==null&&i!==void 0?i:t[e]}),this.target.setAttributes(this.from)}deleteSelfAttr(t){super.deleteSelfAttr(t),delete this.from[t]}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.from[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}class aY extends ve{constructor(t,e,i,r,o){super(t,e,i,r,o)}getEndProps(){return{}}onStart(){this.target&&(this.target.type==="rect"?this.onStartRect():this.target.type==="line"?this.onStartLineOrArea("line"):this.target.type==="area"&&this.onStartLineOrArea("area"))}onStartLineOrArea(t){var e;const i=this.target.attachShadow(),r=Mt.graphicService.creator[t](Object.assign({},(e=this.params)===null||e===void 0?void 0:e.attribute));this[t]=r,r.pathProxy=new Fi,i.add(r)}onStartRect(){var t,e,i;const r=this.target.attachShadow(),o=(e=(t=this.params)===null||t===void 0?void 0:t.isHorizontal)===null||e===void 0||e,s=o?"height":"width",a=o?"width":"height",l=this.target.AABBBounds[s](),u=o?0:this.target.AABBBounds.y1,h=Mt.graphicService.creator.rect(Object.assign(Object.assign({[s]:l,fill:"#bcdeff",shadowBlur:30,shadowColor:"#bcdeff"},(i=this.params)===null||i===void 0?void 0:i.attribute),{x:0,y:u,[a]:0}));this.rect=h,r.add(h)}onBind(){}onEnd(){this.target.detachShadow()}onUpdate(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}onUpdateRect(t,e,i){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C;const y=(o=(r=this.params)===null||r===void 0?void 0:r.isHorizontal)===null||o===void 0||o,w=this.target.attribute;if(y){const _=(a=(s=w.width)!==null&&s!==void 0?s:Math.abs(w.x1-w.x))!==null&&a!==void 0?a:250,A=(u=(l=this.params)===null||l===void 0?void 0:l.streamLength)!==null&&u!==void 0?u:_,T=(c=(d=(h=this.params)===null||h===void 0?void 0:h.attribute)===null||d===void 0?void 0:d.width)!==null&&c!==void 0?c:60,S=-T,x=S+(A-S)*e,E=Math.max(x,0),M=Math.min(Math.min(x+T,T),A-x),L=M+E>_?Math.max(_-E,0):M;this.rect.setAttributes({x:E,width:L,dx:Math.min(w.x1-w.x,0)},!1,{type:Tr.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{const _=(g=(f=w.height)!==null&&f!==void 0?f:Math.abs(w.y1-w.y))!==null&&g!==void 0?g:250,A=(p=(m=this.params)===null||m===void 0?void 0:m.streamLength)!==null&&p!==void 0?p:_,T=(C=(b=(v=this.params)===null||v===void 0?void 0:v.attribute)===null||b===void 0?void 0:b.height)!==null&&C!==void 0?C:60,S=_-(A+T)*e;let x=Math.min(S,_);const E=Math.min(_-S,T);let M;x<=0?(M=Math.max(x+E,0),x=0):M=E,this.rect.setAttributes({y:x,height:M,dy:Math.min(w.y1-w.y,0)},!1,{type:Tr.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}onUpdateLineOrArea(t,e,i){const r=this.line||this.area;if(!r)return;const o=r.pathProxy,s=this.target;s.cache||s.cacheArea?this._onUpdateLineOrAreaWithCache(o,s,t,e,i):this._onUpdateLineWithoutCache(o,s,t,e,i);const a=s.attribute;r.setAttributes(Object.assign({stroke:a.stroke},r.attribute)),r.addUpdateBoundTag()}_onUpdateLineOrAreaWithCache(t,e,i,r,o){var s,a;if(t.clear(),e.type==="line"){let l=e.cache;Array.isArray(l)||(l=[l]);const u=l.reduce((d,c)=>d+c.getLength(),0),h=[];return l.forEach(d=>{d.curves.forEach(c=>h.push(c))}),this._updateCurves(t,h,u,r)}if(e.type==="area"&&(!((a=(s=e.cacheArea)===null||s===void 0?void 0:s.top)===null||a===void 0)&&a.curves)){const l=e.cacheArea,u=l.top.curves.reduce((h,d)=>h+d.getLength(),0);return this._updateCurves(t,l.top.curves,u,r)}}_updateCurves(t,e,i,r){var o,s;const a=i*r,l=Math.min(a+((s=(o=this.params)===null||o===void 0?void 0:o.streamLength)!==null&&s!==void 0?s:10),i);let u=0,h=!1;for(let d=0;d<e.length;d++)if(e[d].defined!==!1){const c=e[d],f=c.getLength(),g=1-(u+f-a)/f;let m,p=1-(u+f-l)/f;if(u<a&&u+f>a)if(h=!0,c.p2&&c.p3){const[v,b]=mu(c,g);t.moveTo(b.p0.x,b.p0.y),m=b}else{const v=c.getPointAt(g);t.moveTo(v.x,v.y)}if(u<l&&u+f>l){if(c.p2&&c.p3){m&&(p=(l-a)/m.getLength());const[v]=mu(m||c,p);t.bezierCurveTo(v.p1.x,v.p1.y,v.p2.x,v.p2.y,v.p3.x,v.p3.y)}else{const v=c.getPointAt(p);t.lineTo(v.x,v.y)}break}if(h)if(c.p2&&c.p3){const v=m||c;t.bezierCurveTo(v.p1.x,v.p1.y,v.p2.x,v.p2.y,v.p3.x,v.p3.y)}else t.lineTo(c.p1.x,c.p1.y);u+=f}}_onUpdateLineWithoutCache(t,e,i,r,o){var s,a;const{points:l,curveType:u}=e.attribute;if(!l||l.length<2||u!=="linear")return;let h=0;for(let m=1;m<l.length;m++)h+=Dr.distancePP(l[m],l[m-1]);const d=h*r,c=Math.min(d+((a=(s=this.params)===null||s===void 0?void 0:s.streamLength)!==null&&a!==void 0?a:10),h),f=[];let g=0;for(let m=1;m<l.length;m++){const p=Dr.distancePP(l[m],l[m-1]);if(g<d&&g+p>d&&f.push(Dr.pointAtPP(l[m-1],l[m],1-(g+p-d)/p)),g<c&&g+p>c){f.push(Dr.pointAtPP(l[m-1],l[m],1-(g+p-c)/p));break}f.length&&f.push(l[m]),g+=p}if(f.length&&!(f.length<2)){t.clear(),t.moveTo(f[0].x,f[0].y);for(let m=1;m<f.length;m++)t.lineTo(f[m].x,f[m].y)}}}const lY=()=>{Vt.registerBuiltInAnimate("increaseCount",Nq),Vt.registerBuiltInAnimate("fromTo",sY),Vt.registerBuiltInAnimate("scaleIn",NX),Vt.registerBuiltInAnimate("scaleOut",WX),Vt.registerBuiltInAnimate("growHeightIn",oX),Vt.registerBuiltInAnimate("growHeightOut",lX),Vt.registerBuiltInAnimate("growWidthIn",BX),Vt.registerBuiltInAnimate("growWidthOut",PX),Vt.registerBuiltInAnimate("growCenterIn",tX),Vt.registerBuiltInAnimate("growCenterOut",eX),Vt.registerBuiltInAnimate("clipIn",Wq),Vt.registerBuiltInAnimate("clipOut",Uq),Vt.registerBuiltInAnimate("fadeIn",Vq),Vt.registerBuiltInAnimate("fadeOut",jq),Vt.registerBuiltInAnimate("growPointsIn",hX),Vt.registerBuiltInAnimate("growPointsOut",dX),Vt.registerBuiltInAnimate("growPointsXIn",fX),Vt.registerBuiltInAnimate("growPointsXOut",gX),Vt.registerBuiltInAnimate("growPointsYIn",mX),Vt.registerBuiltInAnimate("growPointsYOut",vX),Vt.registerBuiltInAnimate("growAngleIn",Kq),Vt.registerBuiltInAnimate("growAngleOut",Zq),Vt.registerBuiltInAnimate("growRadiusIn",SX),Vt.registerBuiltInAnimate("growRadiusOut",xX),Vt.registerBuiltInAnimate("moveIn",JX),Vt.registerBuiltInAnimate("moveOut",tY),Vt.registerBuiltInAnimate("rotateIn",rY),Vt.registerBuiltInAnimate("rotateOut",nY),Vt.registerBuiltInAnimate("update",KX),Vt.registerBuiltInAnimate("state",UX),Vt.registerBuiltInAnimate("labelItemAppear",kX),Vt.registerBuiltInAnimate("labelItemDisappear",LX),Vt.registerBuiltInAnimate("poptipAppear",DX),Vt.registerBuiltInAnimate("poptipDisappear",IX),Vt.registerBuiltInAnimate("inputText",xd),Vt.registerBuiltInAnimate("inputRichText",FX),Vt.registerBuiltInAnimate("outputRichText",OX),Vt.registerBuiltInAnimate("slideRichText",HX),Vt.registerBuiltInAnimate("slideOutRichText",zX),Vt.registerBuiltInAnimate("slideIn",Hw),Vt.registerBuiltInAnimate("growIn",wD),Vt.registerBuiltInAnimate("spinIn",SD),Vt.registerBuiltInAnimate("moveScaleIn",GX),Vt.registerBuiltInAnimate("moveRotateIn",$X),Vt.registerBuiltInAnimate("strokeIn",VX),Vt.registerBuiltInAnimate("slideOut",zw),Vt.registerBuiltInAnimate("growOut",xD),Vt.registerBuiltInAnimate("spinOut",TD),Vt.registerBuiltInAnimate("moveScaleOut",qX),Vt.registerBuiltInAnimate("moveRotateOut",XX),Vt.registerBuiltInAnimate("strokeOut",jX),Vt.registerBuiltInAnimate("pulse",YX),Vt.registerBuiltInAnimate("MotionPath",oY),Vt.registerBuiltInAnimate("streamLight",aY)};class uY extends Nu{onBind(){var t;const e=Wu(this.target);this._animator=e;const i=this.duration,r=this.easing,{config:o,lastScale:s,getTickCoord:a}=this.params;let l=1;const u=this.target.data;if(s&&a&&u){l=.7;const h=a(s.scale(u.rawValue)),d=this.target.attribute.x,c=this.target.attribute.y;this.target.setAttributes({x:h.x,y:h.y}),e.animate(this.target,{type:"to",to:{x:d,y:c},duration:i,easing:r})}e.animate(this.target,{type:(t=o.type)!==null&&t!==void 0?t:"fadeIn",to:o.to,duration:i*l,easing:r}),this.completeBind(e)}}class hY extends Nu{onBind(){const t=Wu(this.target);this._animator=t;const e=this.duration,i=this.easing,{config:r,diffAttrs:o}=this.params;t.animate(this.target,{type:"to",to:Object.assign({},o),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},o)}}),this.completeBind(t)}deleteSelfAttr(t){super.deleteSelfAttr(t),this._animator.deleteSelfAttr(t)}tryPreventConflict(){}}function dY(){Vt.registerBuiltInAnimate("axisEnter",uY),Vt.registerBuiltInAnimate("axisUpdate",hY)}function cY(){Yr(),Lw(),Vm(),Fo(),dY()}function fY(){cY(),bs()}var P2=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};fY();class Td extends mq{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Td.defaultAttributes,t),e)}_renderInner(t){var e;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){const r=[];for(let o=0;o<this.attribute.breaks.length;o++){const s=this.attribute.breaks[o],{range:a,breakSymbol:l,rawRange:u}=s;r.push({startPoint:this.getTickCoord(a[0]),endPoint:this.getTickCoord(a[1]),range:a,breakSymbol:l,rawRange:u})}this._breaks=r}super._renderInner(t),this._breaks&&this._breaks.length&&this._breaks.forEach((r,o)=>{const{startPoint:s,endPoint:a,breakSymbol:l,rawRange:u}=r;if((l==null?void 0:l.visible)!==!1){const h=$t.group({zIndex:rq});h.name=rr.axisBreak,h.id=this._getNodeId(`${rr.axisBreak}-${o}`),h.data=u;const d=lq(l),c=$t.symbol(Object.assign({x:s.x,y:s.y},d));c.name=rr.axisBreakSymbol;const f=$t.symbol(Object.assign({x:a.x,y:a.y},d));f.name=rr.axisBreakSymbol,h.add(c),h.add(f),t.add(h)}});const{panel:i}=this.attribute;if(i&&i.visible){const r=this.axisContainer,o=r.AABBBounds,s=$t.rect(Object.assign({x:o.x1,y:o.y1,width:o.width(),height:o.height()},i.style));s.name=rr.background,s.id=this._getNodeId("background"),s.states=Jt({},_l,(e=i.state)!==null&&e!==void 0?e:{}),r.insertBefore(s,r.firstChild)}}renderLine(t){const{start:e,end:i,line:r}=this.attribute,o=r,{startSymbol:s,endSymbol:a,style:l,state:u}=o,h=P2(o,["startSymbol","endSymbol","style","state"]),d=Object.assign({startSymbol:s,endSymbol:a,lineStyle:l},h);if(this._breaks&&this._breaks.length){const f=[];let g=e;this._breaks.forEach(m=>{const{startPoint:p,endPoint:v}=m;f.push([g,p]),g=v}),f.push([g,i]),d.points=f,d.multiSegment=!0}else d.points=[e,i];We(u)||(d.state={line:Jt({},_l,u),symbol:Jt({},_l,u)});const c=new Gm(d);c.name=rr.line,c.id=this._getNodeId("line"),t.add(c)}getTextAlign(t){let e="center";return Xn(t[0],0)?Xn(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTitleAttribute(){var t,e,i;const r=this.attribute.title,{position:o="middle",space:s=4,textStyle:a={},autoRotate:l=!0,shape:u,background:h,state:d={},maxWidth:c}=r,f=P2(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]);let g=.5;o==="start"?g=0:o==="end"&&(g=1);const{verticalFactor:m=1}=this.attribute,p=-1*m,v=this.getTickCoord(g),b=this.getRelativeVector();let C=0;if(!((t=this.attribute.label)===null||t===void 0)&&t.visible&&this.attribute.label.inside===!1){const L=+Rr(this.attribute,"label.space",4);C+=L;const I=Object.keys(this.axisLabelLayerSize).length;if(b[1]===0){const D=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(D)?C+=D+(I-1)*L:C=0}else if(b[0]===0)if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){const D=this.axisLabelLayerSize[0].labelPos,H=this.axisLabelsContainer.AABBBounds;C+=(p===1?H.x2>D?Math.min(H.x2-D,H.width()):0:H.x1<D?Math.min(D-H.x1,H.width()):0)+(I-1)*L}else C=0;else Object.keys(this.axisLabelLayerSize).forEach((D,H)=>{C+=this.axisLabelLayerSize[D].width+(H>0?L:0)})}let y=0;!((e=this.attribute.tick)===null||e===void 0)&&e.visible&&this.attribute.tick.inside===!1&&(y=this.attribute.tick.length||4),!((i=this.attribute.subTick)===null||i===void 0)&&i.visible&&this.attribute.subTick.inside===!1&&(y=Math.max(y,this.attribute.subTick.length||2));const w=y+C+s,_=this.getVerticalCoord(v,w,!1),A=this.getVerticalVector(w,!1,{x:0,y:0});let T,S,{angle:x}=f;if(T=o==="start"?"start":o==="end"?"end":"center",zt(x)&&l){x=j$(b,[1,0],!0);const{verticalFactor:L=1}=this.attribute;S=-1*L===1?"bottom":"top"}else T=this.getTextAlign(A),S=this.getTextBaseline(A,!1);let E=c;if(zt(E)){const{verticalLimitSize:L,verticalMinSize:I,orient:D}=this.attribute,H=Math.min(L||1/0,I||1/0);if(Ne(H))if(D==="bottom"||D==="top")if(x!==Math.PI/2){const O=Math.abs(Math.cos(x??0));E=O<1e-6?1/0:this.attribute.end.x/O}else E=H-w;else if(x&&x!==0){const O=Math.abs(Math.sin(x));E=O<1e-6?1/0:this.attribute.end.y/O}else E=H-w}const M=Object.assign(Object.assign(Object.assign({},_),f),{maxWidth:E,textStyle:Object.assign({textAlign:T,textBaseline:S},a),state:{text:Jt({},_l,d.text),shape:Jt({},_l,d.shape),panel:Jt({},_l,d.background)}});return M.angle=x,u&&u.visible&&(M.shape=Object.assign({visible:!0},u.style),u.space&&(M.space=u.space)),h&&h.visible&&(M.panel=Object.assign({visible:!0},h.style)),M}getTextBaseline(t,e){let i="middle";const{verticalFactor:r=1}=this.attribute,o=(e?1:-1)*r;return Xn(t[1],0)?i=!Xn(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":o===1?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}getLabelAlign(t,e,i){const r=this.attribute.orient;if(["top","bottom","right","left"].includes(r)||t[0]===0&&t[1]===0){if(r==="top"||r==="bottom")return dD(e?r==="bottom"?"top":"bottom":r,i);if(r==="left"||r==="right")return cD(e?r==="left"?"right":"left":r,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,i,r,o){var s,a,l,u;const{flush:h=!1}=this.attribute.label||{};if(h&&t.length){const{orient:d,start:c,end:f}=this.attribute,g=d==="bottom"||d==="top",m=t[0],p=Ll(t),v=g?m.attribute.x>p.attribute.x:m.attribute.y<p.attribute.y;if(g){const b=v?p:m,C=v?m:p,y=c.x,w=f.x,_=b.AABBBounds.x1,A=C.AABBBounds.x2;_<y&&(b.attribute.angle?b.setAttributes({dx:((s=b.attribute.dx)!==null&&s!==void 0?s:0)+y-_}):b.setAttributes({x:y,textAlign:"left"})),A>w&&(C.attribute.angle?C.setAttributes({dx:((a=C.attribute.dx)!==null&&a!==void 0?a:0)+w-A}):C.setAttributes({x:w,textAlign:"right"}))}else{const b=v?p:m,C=v?m:p,y=b.AABBBounds.y2,w=C.AABBBounds.y1,_=c.y,A=f.y;w<_&&(C.attribute.angle?C.setAttributes({dy:((l=C.attribute.dy)!==null&&l!==void 0?l:0)+_-w}):C.setAttributes({y:_,textBaseline:"top"})),y>A&&(b.attribute.angle?b.setAttributes({dy:((u=b.attribute.dy)!==null&&u!==void 0?u:0)+A-y}):b.setAttributes({y:A,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,i,r,o){if(We(t))return;const{verticalLimitSize:s,label:a,orient:l}=this.attribute,u=this._getAxisLabelLimitLength(s,o),{layoutFunc:h,autoRotate:d,autoRotateAngle:c,autoLimit:f,limitEllipsis:g,autoHide:m,autoHideMethod:p,autoHideSeparation:v,lastVisible:b,firstVisible:C,autoWrap:y,overflowLimitLength:w}=a;if(Ce(h))h(t,e,r,this);else{if(d)Cq(t,{labelRotateAngle:c,orient:l});else if(y){const _=Math.abs(l==="left"||l==="right"?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x);Rq(t,{orient:l,limitLength:u,axisLength:_,ellipsis:g})}if(!y&&f&&Ne(u)&&u>0){const _=l==="left"||l==="right",A=Math.abs(_?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x),T=_?A/t.length:m||d?1/0:A/t.length;Aq(t,{limitLength:u,verticalLimitLength:T,ellipsis:g,orient:l,axisLength:A,overflowLimitLength:w})}m&&_q(t,{method:p,separation:v,lastVisible:b,firstVisible:C})}}afterLabelsOverlap(t,e,i,r,o){const{verticalLimitSize:s,orient:a}=this.attribute,l=a==="bottom"||a==="top",u=i.AABBBounds;let h=l?u.height():u.width();const{verticalMinSize:d}=this.attribute;if(Ne(d)&&(!Ne(s)||d<=s)){const c=this._getAxisLabelLimitLength(d,o);let f,g;h=Math.max(h,c),a==="left"?(f=u.x2-h,g=u.y1):a==="right"?(f=u.x1,g=u.y1):a==="top"?(f=u.x1,g=u.y2-h):a==="bottom"&&(f=u.x1,g=u.y1);const m=$t.rect({x:f,y:g,width:l?u.width():h,height:l?h:u.height(),pickable:!1});m.name=rr.axisLabelBackground,m.id=this._getNodeId("axis-label-background"),i.insertBefore(m,i.firstChild)}if(Et(this.attribute.label.containerAlign)){let c;a==="left"?c=u.x2-h:a==="right"?c=u.x1:a==="top"?c=u.y2-h:a==="bottom"&&(c=u.y1),Eq(t,c,h,a,this.attribute.label.containerAlign)}}_getAxisLabelLimitLength(t,e){var i,r,o,s,a;const{label:l,title:u,line:h,tick:d}=this.attribute,c=(i=l.space)!==null&&i!==void 0?i:4;let f=t,g=0,m=0;const p=h&&h.visible?(r=h.style.lineWidth)!==null&&r!==void 0?r:1:0,v=d&&d.visible?(o=d.length)!==null&&o!==void 0?o:4:0;if(u&&u.visible&&typeof u.text=="string"){g=jm(u.text,u.textStyle,(a=(s=this.stage)===null||s===void 0?void 0:s.getTheme())===null||a===void 0?void 0:a.text).height;const b=Bo(u.padding);m=u.space+b[0]+b[2]}return f&&(f=(f-c-m-g-p-v)/e),f}release(){super.release(),this._breaks=null}}Td.defaultAttributes=DC,y_(Td,Mq);const ls=n=>n.map((t,e)=>({index:e,value:t})),k2=(n,t,e=0)=>{const i=new Ye(n).expand(e/2),r=new Ye(t).expand(e/2);return i.intersects(r)},L2=12,rf=(n,t,e,i)=>e<n?Math.max(n-t/2,e):e>n?Math.min(n-t/2,e-t):e<i?e:e-t,FC=(n,t,e)=>{var i,r,o;const{labelStyle:s,axisOrientType:a,labelFlush:l,labelFormatter:u,startAngle:h=0}=e;let d=(i=s.angle)!==null&&i!==void 0?i:0;s.direction==="vertical"&&(d+=Ds(90));const c=["bottom","top"].includes(a),f=["left","right"].includes(a);let g=1,m=0;c||(f?(g=0,m=1):h&&(g=Math.cos(h),m=-Math.sin(h)));const p=tD(s),v=n.range();let b=[];for(let C=0;C<t.length;C++){const y=t[C],w=u?u(y):`${y}`;if(jl(w)){b=void 0;break}const{width:_,height:A}=p.quickMeasure(w),T=Math.max(_,12),S=Math.max(A,12),x=n.scale(y),E=g*x,M=m*x;let L,I,D=E,H=M;l&&c&&C===0?D=rf(E,T,v[0],v[v.length-1]):l&&c&&C===t.length-1?D=rf(E,T,v[v.length-1],v[0]):L=(r=s.textAlign)!==null&&r!==void 0?r:"center",L==="right"?D-=T:L==="center"&&(D-=T/2),l&&f&&C===0?H=rf(M,S,v[0],v[v.length-1]):l&&f&&C===t.length-1?H=rf(M,S,v[v.length-1],v[0]):I=(o=s.textBaseline)!==null&&o!==void 0?o:"middle",I==="bottom"?H-=S:I==="middle"&&(H-=S/2);const O=new Ye().set(D,H,D+T,H+S);d&&O.rotate(d,E,M),b.push(O)}return b},gY=n=>["bottom","top","z"].includes(n);var on;(function(n){n.Identity="identity",n.Linear="linear",n.Log="log",n.Pow="pow",n.Sqrt="sqrt",n.Symlog="symlog",n.Time="time",n.Quantile="quantile",n.Quantize="quantize",n.Threshold="threshold",n.Ordinal="ordinal",n.Point="point",n.Band="band"})(on||(on={}));Object.values(on).forEach(n=>{});function ED(n){switch(n){case on.Linear:case on.Log:case on.Pow:case on.Sqrt:case on.Symlog:case on.Time:return!0;default:return!1}}function pY(n){switch(n){case on.Ordinal:case on.Point:case on.Band:return!0;default:return!1}}function mh(n){return n}function OC(n,t){if(n=Number(n),t=Number(t),t-=n)return i=>(i-n)/t;const e=Number.isNaN(t)?NaN:.5;return()=>e}function D2(n,t,e){const i=n[0],r=n[1],o=t[0],s=t[1];let a,l;return r<i?(a=OC(r,i),l=e(s,o)):(a=OC(i,r),l=e(o,s)),u=>l(a(u))}function mY(n,t){const e=(n[1]-n[0])/(t[1]-t[0]),i=n[0]-e*t[0];return[i,e+i]}function vY(n,t,e){const i=Math.min(n.length,t.length)-1,r=new Array(i),o=new Array(i);let s=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=OC(n[s],n[s+1]),o[s]=e(t[s],t[s+1]);return function(a){const l=q4(n,a,1,i)-1;return o[l](r[l](a))}}let bY=class{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:Et(this._rangeFactorStart)&&Et(this._rangeFactorEnd)&&t.length===2?(this._wholeRange=mY(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(t.length===2&&t.every(r=>r>=0&&r<=1)&&(this._wholeRange=null,t[0]===0&&t[1]===1?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):Et(this._rangeFactorStart)&&Et(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return zt(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!zt(this._rangeFactorEnd)&&this._rangeFactorEnd!==1?(this._rangeFactorStart=t,this._rangeFactorEnd=(i=this._rangeFactorEnd)!==null&&i!==void 0?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}rangeFactorEnd(t,e){var i;return zt(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!zt(this._rangeFactorStart)&&this._rangeFactorStart!==0?(this._rangeFactorEnd=t,this._rangeFactorStart=(i=this._rangeFactorStart)!==null&&i!==void 0?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);const{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,o=this.range(),s=o[0],a=o[o.length-1],l=Math.min(s,a),u=Math.max(s,a),h=nn((t=this._fishEyeOptions.focus)!==null&&t!==void 0?t:0,l,u),d=zt(r)?(u-l)*i:r;let c=Math.exp(e);c=c/(c-1)*d;const f=e/d;this._fishEyeTransform=g=>{const m=Math.abs(g-h);if(m>=d)return g;if(m<=1e-6)return h;const p=c*(1-Math.exp(-m*f))/m*.75+.25;return h+(g-h)*p}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return(i=this==null?void 0:this[t])!==null&&i!==void 0?i:e}};const{interpolateRgb:vv}=p6;function _Y(n,t){const e=typeof t;let i;if(zt(t)||e==="boolean")return()=>t;if(e==="number")return Af(n,t);if(e==="string"){if(i=Gl.parseColorString(t)){const r=vv(Gl.parseColorString(n),i);return o=>r(o).formatRgb()}return Af(Number(n),Number(t))}return t instanceof Fr?vv(n,t):t instanceof Gl?vv(n.color,t.color):t instanceof Date?J4(n,t):Af(Number(n),Number(t))}let CY=class extends bY{constructor(t=mh,e=mh){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=mh,this._piecewise=D2,this._interpolate=_Y}calculateVisibleDomain(t){var e;return Et(this._rangeFactorStart)&&Et(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:(e=this._niceDomain)!==null&&e!==void 0?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),Af)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;const r=Array.from(t,G4);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();const i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){const i=Array.from(t);return this._range=i,this._interpolate=Q4,this.rescale(e)}rescale(t){var e;if(t)return this;const i=(e=this._niceDomain)!==null&&e!==void 0?e:this._domain,r=i.length,o=this._range.length;let s=Math.min(r,o);if(r&&r<o&&this._forceAlign){const a=o-r+1,l=i[r-1],u=r>=2?(l-i[r-2])/a:0;for(let h=1;h<=a;h++)i[r-2+h]=l-u*(a-h);s=o}return this._autoClamp&&(this._clamp=Z4(i[0],i[s-1])),this._piecewise=s>2?vY:D2,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:mh),this.rescale(i)):this._clamp!==mh}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){const e=this.ticks(t);return(e??[]).map((i,r)=>({index:r,tick:i,value:(this.scale(i)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return zt(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return zt(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}};const yY=Math.sqrt(50),wY=Math.sqrt(10),SY=Math.sqrt(2),nf=[1,2,5,10],I2=(n,t,e)=>{let i=1,r=n;const o=Math.floor((t-1)/2),s=Math.abs(n);return n>=0&&n<=Number.MIN_VALUE?r=0:n<0&&n>=-Number.MIN_VALUE?r=-(t-1):!e&&s<1?i=MD(s).step:(e||s>1)&&(r=Math.floor(n)-o*i),i>0?(n>0?r=Math.max(r,0):n<0&&(r=Math.min(r,-(t-1)*i)),V4(0,t).map(a=>r+a*i)):n>0?cp(0,-(t-1)/i,i):cp((t-1)/i,0,i)},xY=Lk((n,t,e,i)=>{let r,o,s,a,l=-1;if(e=+e,(n=+n)==(t=+t))return[n];if(Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return[n];if((r=t<n)&&(o=n,n=t,t=o),a=Nw(n,t,e).step,!isFinite(a))return[];if(a>0){let u=Math.round(n/a),h=Math.round(t/a);for(u*a<n&&++u,h*a>t&&--h,s=new Array(o=h-u+1);++l<o;)s[l]=(u+l)*a}else if(a<0&&(i!=null&&i.noDecimals)){a=1;const u=Math.ceil(n),h=Math.floor(t);if(!(u<=h))return[];for(s=new Array(o=h-u+1);++l<o;)s[l]=u+l}else{a=-a;let u=Math.round(n*a),h=Math.round(t*a);for(u/a<n&&++u,h/a>t&&--h,s=new Array(o=h-u+1);++l<o;)s[l]=(u+l)/a}return r&&s.reverse(),s}),cp=(n,t,e)=>{let i,r,o=-1;if(e>0){let s=Math.floor(n/e),a=Math.ceil(t/e);for((s+1)*e<n&&++s,(a-1)*e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)*e}else{e=-e;let s=Math.floor(n*e),a=Math.ceil(t*e);for((s+1)/e<n&&++s,(a-1)/e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)/e}return r},TY=(n,t,e)=>{let i;const r=n[0],o=n[n.length-1],s=t-n.length;if(o<=0){const u=[];for(i=s;i>=1;i--)u.push(r-i*e);return u.concat(n)}if(r>=0){for(i=1;i<=s;i++)n.push(o+i*e);return n}let a=[];const l=[];for(i=1;i<=s;i++)i%2==0?a=[r-Math.floor(i/2)*e].concat(a):l.push(o+Math.ceil(i/2)*e);return a.concat(n).concat(l)},AY=Lk((n,t,e,i)=>{let r,o,s;if(e=+e,(n=+n)==(t=+t)||Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return I2(n,e,i==null?void 0:i.noDecimals);(r=t<n)&&(s=n,n=t,t=s);const a=Nw(n,t,e);let l=a.step;if(!isFinite(l))return[];if(l>0){let u=1;const{power:h,gap:d}=a,c=d===10?2*10**h:1*10**h;for(;u<=5&&(o=cp(n,t,l),o.length>e+1)&&e>2;)l+=c,u+=1;e>2&&o.length<e-1&&(o=TY(o,e,l))}else i!=null&&i.noDecimals&&l<0&&(l=1),o=cp(n,t,l);return r&&o.reverse(),o}),MD=n=>{const t=Math.floor(Math.log(n)/Math.LN10),e=n/10**t;let i=nf[0];return e>=yY?i=nf[3]:e>=wY?i=nf[2]:e>=SY&&(i=nf[1]),t>=0?{step:i*10**t,gap:i,power:t}:{step:-(10**-t)/i,gap:i,power:t}};function Nw(n,t,e){const i=(t-n)/Math.max(0,e);return MD(i)}function RY(n,t,e){let i;if(e=+e,(n=+n)==(t=+t)&&e>0)return[n];if(e<=0||(i=EY(n,t,e))===0||!isFinite(i))return[];const r=new Array(e);for(let o=0;o<e;o++)r[o]=n+o*i;return r}function EY(n,t,e){return(t-n)/Math.max(1,e-1)}function MY(n,t,e){let i,r,o=-1;if(e=+e,(r=(t=+t)<(n=+n))&&(i=n,n=t,t=i),!isFinite(e)||t-n<=e)return[n];const s=Math.floor((t-n)/e+1),a=new Array(s);for(;++o<s;)a[o]=n+o*e;return r&&a.reverse(),a}function bv(n,t=10){let e,i,r=0,o=n.length-1,s=n[r],a=n[o],l=10;for(a<s&&(i=s,s=a,a=i,i=r,r=o,o=i);l-- >0;){if(i=Nw(s,a,t).step,i===e)return n[r]=s,n[o]=a,n;if(i>0)s=Math.floor(s/i)*i,a=Math.ceil(a/i)*i;else{if(!(i<0))break;s=Math.ceil(s*i)/i,a=Math.floor(a*i)/i}e=i}}function BY(n,t){const e=ne(t.forceMin),i=ne(t.forceMax);let r=null;const o=[];let s=null;const a=e&&i?l=>l>=t.forceMin&&l<=t.forceMax:e?l=>l>=t.forceMin:i?l=>l<=t.forceMax:null;return e?o[0]=t.forceMin:ne(t.min)&&t.min<=Math.min(n[0],n[n.length-1])&&(o[0]=t.min),i?o[1]=t.forceMax:ne(t.max)&&t.max>=Math.max(n[0],n[n.length-1])&&(o[1]=t.max),ne(o[0])&&ne(o[1])?(s=n.slice(),s[0]=o[0],s[s.length-1]=o[1]):r=ne(o[0])||ne(o[1])?ne(o[0])?"max":"min":"all",{niceType:r,niceDomain:s,niceMinMax:o,domainValidator:a}}let PY=class BD extends CY{constructor(){super(...arguments),this.type=on.Linear}clone(){var t;const e=new BD;return e.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(e._niceType=this._niceType,e._domainValidator=this._domainValidator,e._niceDomain=(t=this._niceDomain)===null||t===void 0?void 0:t.slice()),e}tickFormat(){return()=>{}}d3Ticks(t=10,e){const i=this.calculateVisibleDomain(this._range);return xY(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(Ce(e==null?void 0:e.customTicks))return e.customTicks(this,t);if(Et(this._rangeFactorStart)&&Et(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&this._range.length===2||!this._niceType)return this.d3Ticks(t,e);const r=(i=this._niceDomain)!==null&&i!==void 0?i:this._domain,o=this._domain,s=r[0],a=r[r.length-1];let l=AY(o[0],o[o.length-1],t,e);if(!l.length)return l;if(this._domainValidator)l=l.filter(this._domainValidator);else if((l[0]!==s||l[l.length-1]!==a)&&this._niceType){const u=r.slice();if(this._niceType==="all"?(u[0]=l[0],u[u.length-1]=l[l.length-1],this._niceDomain=u,this.rescale()):this._niceType==="min"&&l[0]!==s?(u[0]=l[0],this._niceDomain=u,this.rescale()):this._niceType==="max"&&l[l.length-1]!==a&&(u[u.length-1]=l[l.length-1],this._niceDomain=u,this.rescale()),this._niceType!=="all"){const h=Math.min(u[0],u[u.length-1]),d=Math.max(u[0],u[u.length-1]);l=l.filter(c=>c>=h&&c<=d)}}return l}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return RY(e[0],e[e.length-1],t)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return MY(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;const o=this._domain;let s=[];if(e){const a=BY(o,e);if(s=a.niceMinMax,this._domainValidator=a.domainValidator,this._niceType=a.niceType,a.niceDomain)return this._niceDomain=a.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){const a=bv(o.slice(),t);this._niceType==="min"?a[a.length-1]=(i=s[1])!==null&&i!==void 0?i:a[a.length-1]:this._niceType==="max"&&(a[0]=(r=s[0])!==null&&r!==void 0?r:a[0]),this._niceDomain=a,this.rescale()}return this}niceMin(t=10){this._niceType="min";const e=this._domain[this._domain.length-1],i=bv(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";const e=this._domain[0],i=bv(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}};function _v(n,t,e,i){let r;const{breakData:o}=n;if(o&&o()){const{breakDomains:s}=o(),a=t.domain();r=[];for(let l=0;l<a.length-1;l++)i(e,[a[l],a[l+1]]).forEach(u=>{s.some(h=>u>=h[0]&&u<=h[1])||r.push(u)});t.domain(a)}else r=i(e);return r}function F2(n,t,e,i,r=!1){if(e&&!t.includes(n)){let o=t.length;if(o>1){r?t.push(n):t.unshift(n);for(let s=0;s<o;s++){const a=r?o-1-s:s;if(!i(t[a]))break;t.splice(a,1),s--,o--}}}}const kY=(n,t)=>{var e,i,r,o;if(!ED(n.type))return ls(n.domain());const s=n.range(),a=Math.abs(s[s.length-1]-s[0]);if(a<2)return ls([n.domain()[0]]);const{tickCount:l,forceTickCount:u,tickStep:h,noDecimals:d=!1,labelStyle:c,breakData:f}=t;let g;if(Et(h))m=n.stepTicks(h),p=f&&f()?f().breakDomains:null,g=p&&p.length?m.filter(b=>p.every(C=>b<C[0]||b>C[1])):m;else if(Et(u))g=_v(t,n,u,(b,C)=>C&&C.length?n.domain(C,!0).forceTicks(b):n.forceTicks(b));else if(t.tickMode==="d3"){const b=(e=Ce(l)?l({axisLength:a,labelStyle:c}):l)!==null&&e!==void 0?e:5;g=_v(t,n,b,(C,y)=>y&&y.length?n.domain(y,!0).d3Ticks(C,{noDecimals:d}):n.d3Ticks(C,{noDecimals:d}))}else{const b=(i=Ce(l)?l({axisLength:a,labelStyle:c}):l)!==null&&i!==void 0?i:5,C=Ce(t.tickMode)?t.tickMode:void 0;g=_v(t,n,b,(y,w)=>w&&w.length?n.domain(w,!0).ticks(y,{noDecimals:d,customTicks:C}):n.ticks(y,{noDecimals:d,customTicks:C}))}var m,p;const v=n.domain();if(t.labelFirstVisible&&v[0]!==g[0]&&!g.includes(v[0])&&g.unshift(v[0]),t.labelLastVisible&&v[v.length-1]!==g[g.length-1]&&!g.includes(v[v.length-1])&&g.push(v[v.length-1]),t.sampling&&g.length>1&&(t.coordinateType==="cartesian"||t.coordinateType==="polar"&&t.axisOrientType==="radius")){const{labelGap:b=4,labelFlush:C}=t,y=6;let w;if(g.length*y>a){const _=[],A=Math.floor(g.length*y/a);g.forEach((T,S)=>{S%A!=0&&S!==g.length-1||_.push(T)}),w=(r=FC(n,_,t))===null||r===void 0?void 0:r.map((T,S)=>({AABBBounds:T,value:_[S]}))}else w=(o=FC(n,g,t))===null||o===void 0?void 0:o.map((_,A)=>({AABBBounds:_,value:g[A]}));if(w){const _=w[0],A=Ll(w),T=f&&f()?O2.greedy:O2.parity;for(;w.length>=3&&IC(w,b);)w=T(w,b);const S=t.labelFirstVisible;let x=t.labelLastVisible;Yn(_,A,b)&&w.includes(A)&&w.length>1&&S&&x&&(w.splice(w.indexOf(A),1),x=!1),F2(_,w,S,M=>Yn(M,_,b)),F2(A,w,x,M=>Yn(M,A,b)||!(!S||M===_)&&Yn(M,_,b),!0);const E=w.map(M=>M.value);E.length<3&&C&&(E.length>1&&E.pop(),Ll(E)!==Ll(g)&&E.push(Ll(g))),g=E}}return ls(g)},O2={parity:function(n){return n.filter((t,e)=>e%2==0)},greedy:function(n,t){let e;return n.filter((i,r)=>(!r||!Yn(e,i,t))&&(e=i,!0))}},H2=(n,t,e,i)=>{const r=FC(n,t,e);return r&&r.map(o=>i?[o.x1,o.x2,o.width()]:[o.y1,o.y2,o.height()])},z2=(n,t,e=0)=>Math.max(n[0],t[0])-e/2<=Math.min(n[1],t[1])+e/2,N2=(n,t)=>n[1]<t[0]?t[0]-n[1]:t[1]<n[0]?n[0]-t[1]:0,LY=(n,t)=>{var e;const i=n.domain();if(!i.length)return[];const{tickCount:r,forceTickCount:o,tickStep:s,labelGap:a=4,axisOrientType:l,labelStyle:u}=t,h=gY(l),d=n.range(),c=n.calculateWholeRangeSize();if(c<2)return t.labelLastVisible?ls([i[i.length-1]]):ls([i[0]]);let f;if(Et(s))f=n.stepTicks(s);else if(Et(o))f=n.forceTicks(o);else if(Et(r)){const g=Ce(r)?r({axisLength:c,labelStyle:u}):r;f=n.ticks(g)}else if(t.sampling){const g=((e=t.labelStyle.fontSize)!==null&&e!==void 0?e:12)+2,m=uw(d),p=kk(d);if(i.length<=c/g){const v=H2(n,i,t,h);if(v){const b=Math.min(...v.map(w=>w[2])),C=(p-m)/i.length,y=DY(i,v,a,t.labelLastVisible,Math.floor(b/C));f=n.stepTicks(y.step),t.labelLastVisible&&(y.delCount&&(f=f.slice(0,f.length-y.delCount)),f.push(i[i.length-1]))}}else{const v=[i[0],i[Math.floor(i.length/2)],i[i.length-1]],b=H2(n,v,t,h);if(b){let C=null;b.forEach(w=>{C?C[2]<w[2]&&(C=w):C=w});const y=p-m-a>0?Math.ceil(i.length*(a+C[2])/(p-m-a)):i.length-1;f=n.stepTicks(y),!t.labelLastVisible||f.length&&f[f.length-1]===i[i.length-1]||(f.length&&Math.abs(n.scale(f[f.length-1])-n.scale(i[i.length-1]))<C[2]&&(f=f.slice(0,-1)),f.push(i[i.length-1]))}}}return zt(f)&&(f=n.domain()),ls(f)},DY=(n,t,e,i,r,o)=>{let s=0,a=0,l=-1,u=Number.MAX_VALUE;const h=f=>{let g=!0,m=0;do m+f<n.length&&z2(t[m],t[m+f],e)&&(g=!1),m+=f;while(g&&m<n.length);return g},d=X4(r,n.length,f=>h(f)?1:-1);let c=d;do if(c>d&&!h(c))c++;else{if(!i){a=c;break}{const f=n.length-1;let g,m=0;g=n.length%c>0?n.length-n.length%c+c:n.length;do{if(g-=c,g!==f&&!z2(t[g],t[f],e))break;m++}while(g>0);if(g===f){a=c,s=m;break}{const p=Math.floor(n.length/c)-m+1;if(p<l)break;{l=p;const v=N2(t[g],t[f]),b=g-c>=0?N2(t[g-c],t[g]):v,C=Math.abs(v-b);if(C<u&&(u=C,a=c,s=m),v<=b)break}}}c++}while(c<=n.length);return{step:a,delCount:s}},IY=(n,t,e)=>{var i;const{labelStyle:r,getRadius:o,labelOffset:s,labelFormatter:a,inside:l}=e,u=o==null?void 0:o(),h=(i=r.angle)!==null&&i!==void 0?i:0,d=tD(r);return t.map(c=>{const f=a?a(c):`${c}`,{width:g,height:m}=d.quickMeasure(f),p=Math.max(g,L2),v=Math.max(m,L2),b=n.scale(c),C={x:0,y:0};let y=0,w=0;const _={align:r.textAlign,baseline:r.textBaseline},{x:A,y:T}=hq(b,C,u,s,l);return _.align||(Xn(A,C.x)?_.baseline||(_.baseline=T>C.y?"top":"bottom"):A>C.x?_.align="left":A<C.x&&(_.align="right")),y=A+(_.align==="right"?-p:_.align==="left"?0:-p/2),w=T+(_.baseline==="bottom"?-v:_.baseline==="top"?0:-v/2),new Ye().set(y,w,y+p,w+v).rotate(h,y+p/2,w+v/2)})},FY=(n,t)=>{const{tickCount:e,forceTickCount:i,tickStep:r,getRadius:o,labelOffset:s,labelGap:a=0,labelStyle:l}=t,u=o==null?void 0:o();if(!u)return ls(n.domain());let h;if(Et(r))h=n.stepTicks(r);else if(Et(i))h=n.forceTicks(i);else if(Et(e)){const d=n.range(),c=Math.abs(d[d.length-1]-d[0]),f=Ce(e)?e({axisLength:c,labelStyle:l}):e;h=n.ticks(f)}else if(t.sampling){const d=n.domain(),c=n.range(),f=IY(n,d,t),g=uw(c),m=kk(c),p=Math.abs(m-g)*(u+s)/d.length,{step:v,delCount:b}=OY(d,f,a,Math.floor(f.reduce((C,y)=>Math.min(C,y.width(),y.height()),Number.MAX_VALUE)/p));h=n.stepTicks(v),h=h.slice(0,h.length-b)}else h=n.domain();return ls(h)},OY=(n,t,e,i)=>{let r=i;do{let s=!0;r++;let a=0;do a+r<n.length&&k2(t[a],t[a+r],e)&&(s=!1),a+=r;while(s&&a<n.length);if(s)break}while(r<=n.length);let o=0;if(n.length>2){let s=n.length-n.length%r;for(s>=n.length&&(s-=r);s>0&&k2(t[0],t[s]);)o++,s-=r}return{step:r,delCount:o}},HY=(n,t)=>{if(ED(n.type))return kY(n,t);if(pY(n.type)){if(t.coordinateType==="cartesian")return LY(n,t);if(t.coordinateType==="polar"&&t.axisOrientType==="angle")return FY(n,t)}return ls(n.domain())};function PD(){Yr(),zu(),Fo()}const kD={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};PD();class Ad extends gn{getCurrent(){return this._current}constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Ad.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=i=>{const r=i.target;r.hasState("disable")||r.addState("hover")},this._onUnHover=i=>{i.target.removeState("hover")},this._onClick=i=>{const r=i.target;if(r.name==="preHandler"){if(this._current===1)return;this._current-=1,this._current===1?r.addState("disable"):r.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:i})}if(r.name==="nextHandler"){if(this._current===this._total)return;this._current+=1,this._current===this._total?r.addState("disable"):r.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:i})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,i;this._reset();const{layout:r="horizontal",handler:o=kD,total:s,defaultCurrent:a=1,textStyle:l,padding:u=0}=this.attribute;this._current=a;const h=Bo(u),d=r==="horizontal",c=$t.group({x:0,y:0}),f=o.style||{},g=f.size||15,m=(t=o.space)!==null&&t!==void 0?t:8,p=o.state||{};let{preShape:v,nextShape:b}=o;v||(v=d?"triangleLeft":"triangleUp"),b||(b=d?"triangleRight":"triangleDown");const C=$t.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},f),{x:0,y:0,symbolType:v,size:g}));C.states=p,C.name="preHandler",this.preHandler=C,c.add(C);const{width:y,height:w}=jm(this._getPageText(s),Object.assign({textAlign:"center",textBaseline:"middle"},l),(i=(e=this.stage)===null||e===void 0?void 0:e.getTheme())===null||i===void 0?void 0:i.text),_=ne(g)?g:g[0],A=ne(g)?g:g[1],T=$t.text(Object.assign({x:d?_/2+m+y/2:0,y:d?0:A/2+m+w/2,text:this._getPageText(a),textAlign:"center",textBaseline:"middle",lineHeight:l==null?void 0:l.fontSize},l));this.text=T,c.add(T);const S=$t.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},f),{x:d?_+2*m+y:0,y:d?0:A+2*m+w,symbolType:b,size:g}));S.name="nextHandler",S.states=p,this.nextHandler=S,c.add(S),this._total===1?(C.addState("disable"),S.addState("disable")):this._current===1?C.addState("disable"):this._current===s&&S.addState("disable");const x=c.AABBBounds,E=x.width(),M=x.height();c.translateTo(0-x.x1+h[3],0-x.y1+h[0]),this.add(c),this.attribute.width=E+h[1]+h[3],this.attribute.height=M+h[0]+h[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){const{pageFormatter:e}=this.attribute;return e?Ce(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,this._current!==1&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}Ad.defaultAttributes={handler:kD,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};const fp=10,LD=8,DD=8,zY=8,Bf=16,Pf=8,Zd=12,HC=12;var Xt;(function(n){n.selected="selected",n.unSelected="unSelected",n.selectedHover="selectedHover",n.unSelectedHover="unSelectedHover",n.focus="focus"})(Xt||(Xt={}));var Tn;(function(n){n.legendItemHover="legendItemHover",n.legendItemUnHover="legendItemUnHover",n.legendItemClick="legendItemClick",n.legendItemAttributeUpdate="legendItemAttributeUpdate"})(Tn||(Tn={}));var tr;(function(n){n.innerView="innerView",n.title="legendTitle",n.item="legendItem",n.itemShape="legendItemShape",n.itemLabel="legendItemLabel",n.itemValue="legendItemValue",n.focus="legendItemFocus"})(tr||(tr={}));class Ww extends gn{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);const{interactive:t=!0,title:e,padding:i=0}=this.attribute;this._parsedPadding=Bo(i);const r=$t.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:t,childrenPickable:t});r.name=tr.innerView,this.add(r),this._innerView=r,e!=null&&e.visible&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();const o=this._innerView.AABBBounds;this.attribute.width=o.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=o.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(t){const{text:e="",textStyle:i,padding:r=0,background:o,minWidth:s,maxWidth:a,shape:l}=t,u={x:0,y:0,text:e,textStyle:i,padding:Bo(r),minWidth:s,maxWidth:a};l&&l.visible&&(u.shape=Object.assign({visible:!0},l.style),Et(l.space)&&(u.space=l.space)),o&&o.visible&&(u.panel=Object.assign({visible:!0},o.style));const h=new Gs(u);h.name=tr.title,this._title=h,this._innerView.add(h)}_adjustLayout(){var t;if(this._title){const e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),r=(t=this.attribute.title)===null||t===void 0?void 0:t.align;r==="center"?this._title.setAttribute("x",(e-i)/2):r==="end"&&this._title.setAttribute("x",e-i)}}}function Uw(){Yr(),Fo(),bs(),zu()}function Vw(){Yr(),rD()}function NY(){Vw(),PD(),KL()}function WY(){Vw(),Uw()}function UY(){Vw(),Uw(),D$()}var W2=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const VY={[Xt.focus]:{},[Xt.selected]:{},[Xt.selectedHover]:{},[Xt.unSelected]:{},[Xt.unSelectedHover]:{}};NY();class qm extends Ww{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},qm.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=i=>{const r=i.target;if(r&&r.name&&r.name.startsWith(tr.item)){const o=r.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===o.id)return;this._unHover(this._lastActiveItem,i)}this._hover(o,i)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,i),this._lastActiveItem=null)},this._onUnHover=i=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,i),this._lastActiveItem=null)},this._onClick=i=>{var r,o,s,a;const l=i.target;if(l&&l.name&&l.name.startsWith(tr.item)){const u=l.delegate,{selectMode:h="multiple"}=this.attribute;if(l.name===tr.focus||h==="focus"){const d=u.hasState(Xt.focus);u.toggleState(Xt.focus),d?(r=this._itemsContainer)===null||r===void 0||r.getChildren().forEach(c=>{this._removeLegendItemState(c,[Xt.unSelected,Xt.unSelectedHover,Xt.focus],i),this._setLegendItemState(c,Xt.selected,i)}):(this._setLegendItemState(u,Xt.selected,i),this._removeLegendItemState(u,[Xt.unSelected,Xt.unSelectedHover],i),(o=this._itemsContainer)===null||o===void 0||o.getChildren().forEach(c=>{u!==c&&(this._removeLegendItemState(c,[Xt.selected,Xt.selectedHover,Xt.focus],i),this._setLegendItemState(c,Xt.unSelected,i))}))}else{(s=this._itemsContainer)===null||s===void 0||s.getChildren().forEach(g=>{g.removeState(Xt.focus)});const{allowAllCanceled:d=!0}=this.attribute,c=u.hasState(Xt.selected),f=this._getSelectedLegends();if(h==="multiple"){if(d===!1&&c&&f.length===1)return void this._dispatchLegendEvent(Tn.legendItemClick,u,i);c?(this._removeLegendItemState(u,[Xt.selected,Xt.selectedHover],i),this._setLegendItemState(u,Xt.unSelected,i)):(this._setLegendItemState(u,Xt.selected,i),this._removeLegendItemState(u,[Xt.unSelected,Xt.unSelectedHover],i))}else this._setLegendItemState(u,Xt.selected,i),this._removeLegendItemState(u,[Xt.unSelected,Xt.unSelectedHover],i),(a=this._itemsContainer)===null||a===void 0||a.getChildren().forEach(g=>{u!==g&&(this._removeLegendItemState(g,[Xt.selected,Xt.selectedHover],i),this._setLegendItemState(g,Xt.unSelected,i))})}this._dispatchLegendEvent(Tn.legendItemClick,u,i)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;((e=this._itemsContainer)===null||e===void 0?void 0:e.getChildren()).forEach(i=>{const r=i.data;t.includes(r.label)?(this._setLegendItemState(i,Xt.selected),this._removeLegendItemState(i,[Xt.unSelected,Xt.unSelectedHover])):(this._removeLegendItemState(i,[Xt.selected,Xt.selectedHover]),this._setLegendItemState(i,Xt.unSelected))})}_renderItems(){const{item:t={},maxCol:e=1,maxRow:i=2,maxWidth:r,defaultSelected:o,lazyload:s,autoPage:a}=this.attribute,{spaceCol:l=Bf,spaceRow:u=Pf,verticalAlign:h="middle"}=t,d=this._itemsContainer,{items:c,isHorizontal:f,startIndex:g,isScrollbar:m}=this._itemContext,p=m?1:f?i:e,v=this._contentMaxHeight;let b,{doWrap:C,maxWidthInCol:y,startX:w,startY:_,pages:A}=this._itemContext,T=0,S=0;const x=[];for(let E=g,M=c.length;E<M&&!(s&&A>this._itemContext.currentPage*p);E++){s&&(this._itemContext.startIndex=E+1),b=c[E],b.id||(b.id=b.label),b.index=E;let L=!0;jt(o)&&(L=o.includes(b.label));const I=this._renderEachItem(b,L,E,c),D=I.attribute.width,H=I.attribute.height;this._itemHeight=Math.max(this._itemHeight,H),y=Math.max(D,y),this._itemMaxWidth=Math.max(D,this._itemMaxWidth),f?(Et(r)&&(m&&a?(A=Math.ceil((w+D)/r),C=A>1):w+D>r&&(C=!0,w>0&&(h!=="middle"&&h!=="bottom"||x.forEach(O=>{O.setAttributes({y:O.attribute.y+(S-O.attribute.height)/(h==="middle"?2:1)})}),A+=1,w=0,_+=S+u,S=0,x.length=0))),w===0&&_===0||I.setAttributes({x:w,y:_}),w+=l+D,S=Math.max(S,H),x.push(I)):(Et(v)&&(m&&a?(A=Math.ceil((_+H)/v),C=A>1):v<=H?(A+=1,C=!0,_=0,E>0&&(w+=T+l)):v<_+H&&(A+=1,C=!0,_=0,w+=y+l,y=0)),w===0&&_===0||I.setAttributes({x:w,y:_}),_+=u+H),d.add(I),T=D}return!f||h!=="middle"&&h!=="bottom"||x.forEach(E=>{E.setAttributes({y:E.attribute.y+(S-E.attribute.height)/(h==="middle"?2:1)})}),this._itemContext.doWrap=C,this._itemContext.startX=w,this._itemContext.startY=_,this._itemContext.maxWidthInCol=y,this._itemContext.pages=A,this._itemContext.maxPages=p,m&&(this._itemContext.totalPage=A),s||(this._itemContext.startIndex=c.length),this._itemContext}_renderContent(){const{item:t={},items:e,reversed:i,maxWidth:r,maxHeight:o}=this.attribute;if(t.visible===!1||We(e))return;let s=e;i&&(s=e==null?void 0:e.reverse()),this._contentMaxHeight=Math.max(0,o-this._parsedPadding[0]-this._parsedPadding[2]);const a=$t.group({x:0,y:0});this._itemsContainer=a;const{layout:l,autoPage:u}=this.attribute,h=l==="horizontal",{maxWidth:d,width:c,height:f}=t,g=[];Et(d)&&g.push(d),Et(c)&&g.push(c),g.length&&(Et(r)&&g.push(r),this._itemWidthByUser=uw(g)),Et(f)&&(this._itemHeightByUser=f);const m=this.attribute.pager;this._itemContext={currentPage:m&&m.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:s,isHorizontal:h,totalPage:1/0,isScrollbar:m&&m.type==="scrollbar",clipContainer:void 0},this._itemContext=this._renderItems();let p=!1;this._itemContext.doWrap&&u&&this._itemContext.pages>this._itemContext.maxPages&&(p=this._renderPagerComponent()),p||(a.setAttribute("y",this._title?this._title.AABBBounds.height()+Rr(this.attribute,"title.space",8):0),this._innerView.add(a))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;const{hover:t=!0,select:e=!0}=this.attribute;if(t){let i="pointermove",r="pointerleave";$i(t)&&(t.trigger&&(i=t.trigger),t.triggerOff&&(r=t.triggerOff)),this._itemsContainer.addEventListener(i,this._onHover),this._itemsContainer.addEventListener(r,this._onUnHover)}if(e){let i="pointerdown";$i(e)&&e.trigger&&(i=e.trigger),this._itemsContainer.addEventListener(i,this._onClick)}}_autoEllipsis(t,e,i,r){var o,s;const{label:a,value:l}=this.attribute.item,u=r.AABBBounds,h=i.AABBBounds,d=u.width(),c=h.width();let f=!1;t==="labelFirst"?c>e?f=!0:r.setAttribute("maxLineWidth",e-c):t==="valueFirst"?d>e?f=!0:i.setAttribute("maxLineWidth",e-d):d+c>e&&(f=!0),f&&(r.setAttribute("maxLineWidth",Math.max(e*((o=a.widthRatio)!==null&&o!==void 0?o:.5),e-c)),i.setAttribute("maxLineWidth",Math.max(e*((s=l.widthRatio)!==null&&s!==void 0?s:.5),e-d)))}_renderEachItem(t,e,i,r){var o,s;const{id:a,label:l,value:u,shape:h}=t,{padding:d=0,focus:c,focusIconStyle:f,align:g,autoEllipsisStrategy:m}=this.attribute.item,{shape:p,label:v,value:b,background:C}=this.attribute.item,y=this._handleStyle(p,t,e,i,r),w=this._handleStyle(v,t,e,i,r),_=this._handleStyle(b,t,e,i,r),A=this._handleStyle(C,t,e,i,r),T=Bo(d);let S;C.visible===!1?(S=$t.group({x:0,y:0,cursor:(o=A.style)===null||o===void 0?void 0:o.cursor}),this._appendDataToShape(S,tr.item,t,S)):(S=$t.group(Object.assign({x:0,y:0},A.style)),this._appendDataToShape(S,tr.item,t,S,A.state)),S.id=`${a??l}-${i}`,S.addState(e?Xt.selected:Xt.unSelected);const x=$t.group({x:0,y:0,pickable:!1});S.add(x);let E,M=0,L=0,I=0;if(p&&p.visible!==!1){const J=Rr(y,"style.size",fp);L=jt(J)?J[0]||0:J,I=Rr(p,"space",LD);const st=$t.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},h),y.style));Object.keys(y.state||{}).forEach(ht=>{const at=y.state[ht].fill||y.state[ht].stroke;h.fill&&zt(y.state[ht].fill)&&at&&(y.state[ht].fill=at),h.stroke&&zt(y.state[ht].stroke)&&at&&(y.state[ht].stroke=at)}),this._appendDataToShape(st,tr.itemShape,t,S,y.state),st.addState(e?Xt.selected:Xt.unSelected),x.add(st)}let D=0;if(c){const J=Rr(f,"size",fp);E=$t.symbol(Object.assign(Object.assign({x:0,y:-J/2-1,strokeBoundsBuffer:0,boundsPadding:T},f),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(E,tr.focus,t,S),D=J}const H=v.formatMethod?v.formatMethod(l,t,i):l,O=Object.assign(Object.assign({x:L/2+I,y:0,textAlign:"start",textBaseline:"middle",lineHeight:(s=w.style)===null||s===void 0?void 0:s.fontSize},w.style),{text:H,_originText:v.formatMethod?l:void 0}),N=LC(O);this._appendDataToShape(N,tr.itemLabel,t,S,w.state),N.addState(e?Xt.selected:Xt.unSelected),x.add(N);const U=Rr(v,"space",DD);if(Et(u)){const J=Rr(b,"space",c?zY:0),st=b.formatMethod?b.formatMethod(u,t,i):u,ht=Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:_.style.fontSize},_.style),{text:st,_originText:b.formatMethod?u:void 0}),at=LC(ht);if(this._appendDataToShape(at,tr.itemValue,t,S,_.state),at.addState(e?Xt.selected:Xt.unSelected),this._itemWidthByUser){const lt=this._itemWidthByUser-T[1]-T[3]-L-I-U-D-J;this._autoEllipsis(m,lt,N,at),b.alignRight?at.setAttributes({textAlign:"right",x:this._itemWidthByUser-L/2-T[1]-T[3]-D-J}):at.setAttribute("x",U+(N.AABBBounds.empty()?0:N.AABBBounds.x2))}else at.setAttribute("x",U+(N.AABBBounds.empty()?0:N.AABBBounds.x2));M=J+(at.AABBBounds.empty()?0:at.AABBBounds.x2),x.add(at)}else this._itemWidthByUser&&N.setAttribute("maxLineWidth",this._itemWidthByUser-T[1]-T[3]-L-I-D),M=U+(N.AABBBounds.empty()?0:N.AABBBounds.x2);E&&(E.setAttribute("x",M),x.add(E));const W=x.AABBBounds,j=W.width();if(g==="right"){const J=W.x2,st=W.x1;x.forEachChildren((ht,at)=>{ht.type!=="symbol"&&ht.attribute.textAlign!=="right"||ht===E?ht.setAttribute("x",st+J-ht.attribute.x-ht.AABBBounds.width()):ht.type!=="symbol"?ht.setAttributes({x:st+J-ht.attribute.x,textAlign:"left"}):ht.setAttribute("x",st+J-ht.attribute.x)})}const Y=W.height(),Z=Et(this.attribute.item.width)?this.attribute.item.width:j+T[1]+T[3],rt=this._itemHeightByUser||Y+T[0]+T[2];return S.attribute.width=Z,S.attribute.height=rt,E&&E.setAttribute("visible",!1),x.translateTo(-W.x1+T[3],-W.y1+T[0]),S}_createPager(t){var e,i;const{disableTriggerEvent:r,maxRow:o}=this.attribute,s=a=>a<=99?99:a<=999?999:9999;return this._itemContext.isHorizontal?new Ad(Object.assign(Object.assign({layout:o===1?"horizontal":"vertical",total:s(this._itemContext.pages)},Jt({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:(e=this.attribute.pager)===null||e===void 0?void 0:e.defaultCurrent,disableTriggerEvent:r})):new Ad(Object.assign({layout:"horizontal",total:s(this._itemContext.pages),disableTriggerEvent:r,defaultCurrent:(i=this.attribute.pager)===null||i===void 0?void 0:i.defaultCurrent},t))}_createScrollbar(t,e){const{disableTriggerEvent:i}=this.attribute;return this._itemContext.isHorizontal?new Qa(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:t.visible===!1?0:12},t),{width:e})):new Qa(Object.assign(Object.assign({direction:"vertical",width:t.visible===!1?0:12,range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}_updatePositionOfPager(t,e,i){const{pager:r}=this.attribute,{totalPage:o,isHorizontal:s}=this._itemContext,a=r&&r.position||"middle";if(this._pagerComponent.setTotal(o),s){let l;l=a==="start"?t:a==="end"?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:l})}else{let l;l=a==="start"?0:a==="end"?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:l,y:i-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){const{isHorizontal:t,clipContainer:e}=this._itemContext,i=this._itemsContainer.AABBBounds,r=e.AABBBounds;let o,s;return t?(s=r.width(),o=s/i.width()):(s=r.height(),o=s/i.height()),o}_updatePositionOfScrollbar(t,e,i){const{isHorizontal:r,currentPage:o,totalPage:s}=this._itemContext,a=(o-1)/s;this._pagerComponent.setScrollRange([a,a+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}_bindEventsOfPager(t,e){const i=this.attribute.pager||{},{animation:r=!0,animationDuration:o=450,animationEasing:s="quadIn"}=i,a=this._itemContext.isScrollbar?h=>{const{value:d}=h.detail;let c;return c=d[0]===0?1:d[1]===1?this._itemContext.totalPage:d[0]*this._itemContext.totalPage+1,c}:h=>h.detail.current,l=h=>{const d=this._pagerComponent,c=d.getScrollRange(),{direction:f}=d.attribute,{width:g,height:m}=d.getSliderRenderBounds(),p=f==="vertical"?h.deltaY/m:h.deltaX/g;d.setScrollRange([c[0]+p,c[1]+p],!0),this.updateScrollMask()},u=h=>{const d=a(h);if(d!==this._itemContext.currentPage){if(this._itemContext.currentPage=d,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();const c=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=c,this._itemContext.isScrollbar&&this._pagerComponent){const f=this._computeScrollbarDelta(),[g]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([g,g+f])}}if(this._itemContext.isScrollbar){const[c]=this._pagerComponent.getScrollRange();let f;f=this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height();const g=f*c;this.updateScrollMask(),r?this._itemsContainer.animate().to({[e]:-g},o,s):this._itemsContainer.setAttribute(e,-g)}else r?this._itemsContainer.animate().to({[e]:-(d-1)*t},o,s):this._itemsContainer.setAttribute(e,-(d-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",u),this._pagerComponent.addEventListener("scrollUp",u),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",d=>d.nativeEvent.preventDefault()),this.addEventListener("wheel",Ik(l,50)))):(this._pagerComponent.addEventListener("toPrev",u),this._pagerComponent.addEventListener("toNext",u))}_renderPager(){const t=this._title?this._title.AABBBounds.height()+Rr(this.attribute,"title.space",8):0,{maxWidth:e,maxCol:i=1,maxRow:r=2,item:o={},pager:s={}}=this.attribute,{spaceCol:a=Bf,spaceRow:l=Pf}=o,u=this._itemsContainer,{space:h=HC,defaultCurrent:d=1}=s,c=W2(s,["space","defaultCurrent"]),{isHorizontal:f}=this._itemContext,g=this._contentMaxHeight;let m,p=0,v=0,b=0,C=0,y=0,w=0,_=1;if(f){if(v=(r-1)*l+this._itemHeight*r,p=e,m=this._createPager(c),this._pagerComponent=m,this._innerView.add(m),b=e-m.AABBBounds.width()-h,b<=0)return this._innerView.removeChild(m),!1;u.getChildren().forEach((S,x)=>{const{width:E,height:M}=S.attribute;b<y+E&&(y=0,w+=M+l,_+=1),x>0&&S.setAttributes({x:y,y:w}),y+=a+E}),this._itemContext.startX=y,this._itemContext.startY=w,this._itemContext.pages=_;const T=Math.ceil(_/r);this._itemContext.totalPage=T,this._updatePositionOfPager(t,p,v)}else{if(p=this._itemMaxWidth*i+(i-1)*a,v=g,b=p,m=this._createPager(c),this._pagerComponent=m,this._innerView.add(m),C=g-m.AABBBounds.height()-h-t,C<=0)return this._innerView.removeChild(m),!1;u.getChildren().forEach((S,x)=>{const{height:E}=S.attribute;C<w+E&&(w=0,y+=this._itemMaxWidth+a,_+=1),x>0&&S.setAttributes({x:y,y:w}),w+=l+E});const T=Math.ceil(_/i);this._itemContext.totalPage=T,this._updatePositionOfPager(t,p,v)}d>1&&(f?u.setAttribute("y",-(d-1)*(v+l)):u.setAttribute("x",-(d-1)*(p+a)));const A=$t.group({x:0,y:t,width:f?b:p,height:f?v:C,clip:!0,pickable:!1});return A.add(u),this._innerView.add(A),this._itemContext.clipContainer=A,this._bindEventsOfPager(f?v+l:p+a,f?"y":"x"),!0}_renderScrollbar(){var t;const e=this._title?this._title.AABBBounds.height()+Rr(this.attribute,"title.space",8):0,{maxWidth:i,item:r={},pager:o={}}=this.attribute,{spaceCol:s=Bf,spaceRow:a=Pf}=r,l=this._itemsContainer,{space:u=HC,defaultCurrent:h=1}=o,d=W2(o,["space","defaultCurrent"]),{isHorizontal:c}=this._itemContext,f=this._contentMaxHeight;let g,m=0,p=0,v=0,b=1;if(c)m=i,p=this._itemHeight,g=this._createScrollbar(d,m),this._pagerComponent=g,this._innerView.add(g);else{if(p=f-e,m=this._itemMaxWidth,g=this._createScrollbar(d,p),this._pagerComponent=g,this._innerView.add(g),p<=0)return this._innerView.removeChild(g),!1;const y=l.getChildren(),w=y.map(_=>_.attribute.height);if(w.length===1||w.every(_=>_===w[0])){const _=w[0],A=p,T=Math.floor(A/(a+_));p=T*(a+_),b=Math.ceil(y.length/T)}else y.forEach((_,A)=>{const{height:T}=_.attribute,S=b,x=v;b=Math.floor((v+T)/p)+1,v+=a+T,S!==b&&A===l.getChildren().length-1&&v-p>=1/3*T&&(p=x+T,b-=1)});this._itemContext.totalPage=b,this._itemContext.pages=b}if(h>1)if(c){const y=this._itemsContainer.AABBBounds.width()-m;l.setAttribute("x",-Math.min((h-1)*(m+s),y))}else{const y=this._itemsContainer.AABBBounds.height()-p;l.setAttribute("y",-Math.min((h-1)*(p+a),y))}const C=$t.group({x:0,y:e,width:m,height:p,clip:!0,pickable:!1});return C.add(l),this._innerView.add(C),this._itemContext.clipContainer=C,this._updatePositionOfScrollbar(m,p,e),!((t=o.scrollMask)===null||t===void 0)&&t.visible&&this.renderScrollMask(C),this._bindEventsOfPager(c?m:p,c?"x":"y"),!0}renderScrollMask(t){const{scrollMask:e={}}=this.attribute.pager,{visible:i=!0,gradientLength:r=16,gradientStops:o}=e;if(!i||!o)return;const s=t.AABBBounds.width(),a=t.AABBBounds.height(),l=this._itemContext.isHorizontal?s:a,u=o.map(c=>({offset:r*c.offset/l,color:c.color})),h=o.map(c=>({offset:(l-r*c.offset)/l,color:c.color})),d=$t.rect({x:0,y:0,width:s,height:a});this._scrollMask=d,this._scrollMaskContext={startStops:u,endStops:h},this.updateScrollMask(),t.add(d)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;const[t,e]=this._pagerComponent.getScrollRange(),i=[];Xn(nn(e,0,1),1)||i.push(...this._scrollMaskContext.endStops),Xn(nn(t,0,1),0)||i.push(...this._scrollMaskContext.startStops),i.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:i}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:i}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(Xt.selected)?this._setLegendItemState(t,Xt.selectedHover,e):this._setLegendItemState(t,Xt.unSelectedHover,e);const i=t.getChildren()[0].find(r=>r.name===tr.focus,!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(Tn.legendItemHover,t,e)}_unHover(t,e){let i=!1;(t.hasState(Xt.unSelectedHover)||t.hasState(Xt.selectedHover))&&(i=!0),t.removeState(Xt.unSelectedHover),t.removeState(Xt.selectedHover),t.getChildren()[0].getChildren().forEach(o=>{i||!o.hasState(Xt.unSelectedHover)&&!o.hasState(Xt.selectedHover)||(i=!0),o.removeState(Xt.unSelectedHover),o.removeState(Xt.selectedHover)});const r=t.getChildren()[0].find(o=>o.name===tr.focus,!1);r&&r.setAttribute("visible",!1),i&&this._dispatchLegendEvent(Tn.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(Tn.legendItemUnHover,t,e)}_setLegendItemState(t,e,i){let r=!1;t.hasState(e)||(r=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(o=>{o.name!==tr.focus&&(r||o.hasState(e)||(r=!0),o.addState(e,!0))}),r&&this._dispatchLegendEvent(Tn.legendItemAttributeUpdate,t,i)}_removeLegendItemState(t,e,i){let r=!1;e.forEach(o=>{!r&&t.hasState(o)&&(r=!0),t.removeState(o)}),t.getChildren()[0].getChildren().forEach(o=>{o.name!==tr.focus&&e.forEach(s=>{!r&&o.hasState(s)&&(r=!0),o.removeState(s)})}),r&&this._dispatchLegendEvent(Tn.legendItemAttributeUpdate,t,i)}_getSelectedLegends(){var t;const e=[];return(t=this._itemsContainer)===null||t===void 0||t.getChildren().forEach(i=>{i.hasState(Xt.selected)&&e.push(i.data)}),e}_appendDataToShape(t,e,i,r,o={}){t.name=e,t.data=i,t.delegate=r,t.states=Jt({},VY,o)}_dispatchLegendEvent(t,e,i){const r=this._getSelectedLegends();r.sort((s,a)=>s.index-a.index);const o=r.map(s=>s.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(Xt.selected),currentSelectedItems:r,currentSelected:o,event:i})}_handleStyle(t,e,i,r,o){const s={};return t.style&&(Ce(t.style)?s.style=t.style(e,i,r,o):s.style=t.style),t.state&&(s.state={},Object.keys(t.state).forEach(a=>{t.state[a]&&(Ce(t.state[a])?s.state[a]=t.state[a](e,i,r,o):s.state[a]=t.state[a])})),s}release(){super.release(),this.removeAllEventListeners()}}qm.defaultAttributes={layout:"horizontal",title:{align:"start",space:Zd,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:Bf,spaceRow:Pf,shape:{space:LD,style:{size:fp,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:DD,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:fp,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:HC,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0};var Ji;(function(n){n.innerView="innerView",n.railContainer="sliderRailContainer",n.rail="sliderRail",n.startText="sliderStartText",n.endText="sliderEndText",n.startHandler="sliderStartHandler",n.startHandlerText="startHandlerText",n.endHandler="sliderEndHandler",n.endHandlerText="sliderEndHandlerText",n.track="sliderTrack",n.trackContainer="sliderTrackContainer"})(Ji||(Ji={}));function Cv(n){return jt(n)?n:[n,n]}function of(n){return n?"ew-resize":"ns-resize"}Uw();class Qd extends gn{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Qd.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=i=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(i),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=i=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;const r=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),o=nn(this._isHorizontal?(i.viewX-this._rail.globalAABBBounds.x1)/r:(i.viewY-this._rail.globalAABBBounds.y1)/r,0,1);o!==this._tooltipState.pos&&(this._tooltipState.pos=o,this._tooltipState.value=this.calculateValueByPos(o*r),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{const{tooltip:i}=this.attribute;i&&i.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=i=>{this._clearAllDragEvents(),this._isChanging=!0;const{x:r,y:o}=this.stage.eventPointTransform(i);this._currentHandler=i.target,this._prePos=this._isHorizontal?r:o;const s=Nh(),a=De.env==="browser"?De:this.stage;a.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),s.forEach(l=>{a.addEventListener(l,this._onHandlerPointerUp)})},this._onHandlerPointerMove=i=>{var r,o;this._isChanging=!0;const{railWidth:s,railHeight:a,min:l,max:u}=this.attribute;if(u===l)return;const{x:h,y:d}=this.stage.eventPointTransform(i);let c,f,g,m=0;this._isHorizontal?(c=h,m=c-this._prePos,f=(o=this._currentHandler)===null||o===void 0?void 0:o.attribute.x,g=s):(c=d,m=c-this._prePos,f=(r=this._currentHandler)===null||r===void 0?void 0:r.attribute.y,g=a);const p=nn(f+m,0,g),v=this.calculateValueByPos(p);this._currentHandler.type==="text"?this._updateHandlerText(this._currentHandler,p,v):this._updateHandler(this._currentHandler,p,v),this._updateTrack(),this._prePos=c,this._dispatchChangeEvent()},this._onHandlerPointerUp=i=>{this._isChanging=!1,this._currentHandler=null,this._clearAllDragEvents()},this._handleTouchMove=i=>{this._isChanging&&i.preventDefault()},this._onTrackPointerdown=i=>{this._clearAllDragEvents(),this._isChanging=!0;const{x:r,y:o}=this.stage.eventPointTransform(i);this._prePos=this._isHorizontal?r:o;const s=Nh(),a=De.env==="browser"?De:this.stage;a.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),s.forEach(l=>{a.addEventListener(l,this._onTrackPointerUp)})},this._onTrackPointerMove=i=>{this._isChanging=!0;const{railWidth:r,railHeight:o,min:s,max:a,inverse:l}=this.attribute;if(a===s)return;const{startHandler:u,endHandler:h}=this._getHandlers();let d,c,f;const{x:g,y:m}=this.stage.eventPointTransform(i);this._isHorizontal?(d=g,c=this._track.attribute.width,f=r):(d=m,c=this._track.attribute.height,f=o);const p=d-this._prePos;if(u){const v=this._isHorizontal?u.attribute.x:u.attribute.y,b=l?nn(v+p,c,f):nn(v+p,0,f-c),C=this.calculateValueByPos(b);this._updateHandler(u,b,C)}if(h){const v=this._isHorizontal?h.attribute.x:h.attribute.y,b=l?nn(v+p,0,f-c):nn(v+p,c,f),C=this.calculateValueByPos(b),y=u==null?void 0:u.attribute;this._updateHandler(h,b,C),this._track.setAttributes(this._isHorizontal?{x:Math.min(y.x,h.attribute.x),width:Math.abs(y.x-h.attribute.x)}:{y:Math.min(y.y,h.attribute.y),height:Math.abs(y.y-h.attribute.y)})}this._prePos=d,this._dispatchChangeEvent()},this._onTrackPointerUp=i=>{this._isChanging=!1,this._clearAllDragEvents()},this._onRailPointerDown=i=>{this._clearAllDragEvents(),this._isChanging=!0;const{railWidth:r,railHeight:o,min:s,max:a}=this.attribute;if(a===s)return;const l=this._startHandler,u=this._endHandler;let h,d,c;this._isHorizontal?(h=i.viewX-this._rail.globalAABBBounds.x1,d=l==null?void 0:l.attribute.x,c=u==null?void 0:u.attribute.x):(h=i.viewY-this._rail.globalAABBBounds.y1,d=l==null?void 0:l.attribute.y,c=u==null?void 0:u.attribute.y);const f=this.calculateValueByPos(h);if(Et(c)){const g=Math.abs(h-d)>Math.abs(h-c)?u:l;this._updateHandler(g,h,f)}else this._updateHandler(l,h,f);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){const{layout:i,railWidth:r,railHeight:o,min:s,max:a,inverse:l}=this.attribute;let u=0;return u=s===a?e==="start"?0:e==="end"?1:0:(t-s)/(a-s),(l?1-u:u)*(i==="vertical"?o:r)}calculateValueByPos(t){const{layout:e,railWidth:i,railHeight:r,min:o,max:s,inverse:a}=this.attribute,l=e==="vertical"?r:i;return o+(s-o)*(a?1-t/l:t/l)}setValue(t){const{min:e,max:i}=this.attribute;if(i===e)return;const[r,o]=sg(t),{startHandler:s,endHandler:a}=this._getHandlers();s&&this._updateHandler(s,this.calculatePosByValue(r),r),a&&this._updateHandler(a,this.calculatePosByValue(o),o),this._updateTrack()}render(){var t,e;this.removeAllChild(!0);const{layout:i="horizontal",railWidth:r,railHeight:o,startText:s,endText:a,min:l,max:u,showHandler:h=!0,showTooltip:d}=this.attribute;let{value:c}=this.attribute;zt(c)&&(c=[l,u]),this._currentValue={startValue:Cv(c)[0],endValue:Cv(c)[1]};const f=i==="horizontal";this._isHorizontal=f;const g=$t.group({x:0,y:0});g.name=Ji.innerView,this.add(g),this._innerView=g;let m,p=0;if(s&&s.visible){m=$t.text(Object.assign({x:f?0:r/2,y:f?o/2:0,textAlign:f?"start":"center",textBaseline:f?"middle":"top",text:s.text,lineHeight:(t=s.style)===null||t===void 0?void 0:t.fontSize},s.style)),m.name=Ji.startText,g.add(m);const y=Et(s.space)?s.space:0;p+=(f?m.AABBBounds.width():m.AABBBounds.height())+y}const v=$t.group({x:f?p:0,y:f?0:p});g.add(v);const b=$t.group({x:0,y:0});let C;if(b.name=Ji.railContainer,this._railContainer=b,v.add(b),this._mainContainer=v,this._renderRail(b),p+=f?r:o,a&&a.visible){const y=Et(a.space)?a.space:0;C=$t.text(Object.assign({x:f?p+y:r/2,y:f?o/2:p+y,textAlign:f?"start":"center",textBaseline:f?"middle":"top",text:a.text,lineHeight:(e=a.style)===null||e===void 0?void 0:e.fontSize},a.style)),C.name=Ji.endText,g.add(C)}this._renderTrack(b),h&&(this._renderHandlers(v),this._bindEvents()),d&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){const{railWidth:e,railHeight:i,railStyle:r,slidable:o}=this.attribute;let s="default";o!==!1&&(s="pointer");const a=$t.rect(Object.assign({x:0,y:0,width:e,height:i,cursor:s},r));return a.name=Ji.rail,t.add(a),this._rail=a,a}_renderHandlers(t){const{range:e,min:i,max:r,handlerSize:o=14,handlerStyle:s,handlerText:a,railHeight:l,railWidth:u,slidable:h}=this.attribute;let{value:d}=this.attribute;zt(d)&&(d=[i,r]);const c=a&&a.visible,f=this._isHorizontal,[g,m]=Cv(d),p=this.calculatePosByValue(g,e?"start":"end"),v=this._renderHandler(Object.assign({x:f?p:u/2,y:f?l/2:p,size:o,strokeBoundsBuffer:0,cursor:h===!1?"default":of(f)},s));if(v.name=Ji.startHandler,this._startHandler=v,t.add(v),this._currentValue.startPos=p,c){const b=this._renderHandlerText(g,e?"start":"end");b.name=Ji.startHandlerText,t.add(b),this._startHandlerText=b}if(e){const b=this.calculatePosByValue(m,"end"),C=this._renderHandler(Object.assign({x:f?b:u/2,y:f?l/2:b,size:o,strokeBoundsBuffer:0,cursor:h===!1?"default":of(f)},s));if(C.name=Ji.endHandler,this._endHandler=C,t.add(C),this._currentValue.endPos=b,c){const y=this._renderHandlerText(m,"end");y.name=Ji.endHandlerText,t.add(y),this._endHandlerText=y}}}_renderTrack(t){const{range:e,min:i,max:r,railHeight:o,railWidth:s,trackStyle:a,railStyle:l,slidable:u,value:h}=this.attribute;let d,c;if(zt(h))e?(d=i,c=r):d=c=i;else if(e){const y=pa(h,i,r);d=y[0],c=y[1]}else d=i,c=nn(h,i,r);const f=this._isHorizontal;e||(d=i);const g=$t.group({x:0,y:0,width:s,height:o,cornerRadius:l==null?void 0:l.cornerRadius,clip:!0,pickable:!1});g.name=Ji.trackContainer;const m=$i(e)&&e.draggableTrack===!0;let p;p=u===!1?"default":e===!1||m===!1?"pointer":of(f);const v=this.calculatePosByValue(d,"start"),b=this.calculatePosByValue(c,e?"end":"start"),C=$t.rect(Object.assign({x:f?Math.min(v,b):0,y:f?0:Math.min(v,b),width:f?Math.abs(b-v):s,height:f?o:Math.abs(b-v),cursor:p},a));C.name=Ji.track,this._track=C,g.add(C),t.add(g)}_renderHandler(t){return $t.symbol(t)}_renderHandlerText(t,e){var i,r,o;const{align:s,handlerSize:a=14,handlerText:l={},railHeight:u,railWidth:h,slidable:d}=this.attribute,c=this._isHorizontal,f=this.calculatePosByValue(t,e),g=(i=l.space)!==null&&i!==void 0?i:4,m={text:l.formatter?l.formatter(t):t.toFixed((r=l.precision)!==null&&r!==void 0?r:0),lineHeight:(o=l.style)===null||o===void 0?void 0:o.lineHeight,cursor:d===!1?"default":of(c)};return c?s==="top"?(m.textBaseline="bottom",m.textAlign="center",m.x=f,m.y=(u-a)/2-g):(m.textBaseline="top",m.textAlign="center",m.x=f,m.y=(u+a)/2+g):s==="left"?(m.textBaseline="middle",m.textAlign="end",m.x=(h-a)/2-g,m.y=f):(m.textBaseline="middle",m.textAlign="start",m.x=(h+a)/2+g,m.y=f),$t.text(Object.assign(Object.assign({},m),l.style))}_renderTooltip(){var t;const{tooltip:e,railHeight:i,railWidth:r,align:o}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;const s=this._isHorizontal?0:r/2,a=this._isHorizontal?i/2:0;if(e&&e.shape){const c=$t.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:s,y:a,symbolType:"circle"},e.shapeStyle));this._tooltipShape=c,this._mainContainer.add(c)}const l=e&&e.text||{},u=(t=l.space)!==null&&t!==void 0?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=s,h.y=o==="top"?a-i/2-u:a+i/2+u,h.textAlign="center",h.textBaseline=o==="top"?"bottom":"top"):(h.y=a,h.x=o==="left"?s-r/2-u:a+r/2+u,h.textAlign=o==="left"?"end":"start",h.textBaseline="middle");const d=$t.text(Object.assign(Object.assign({},h),l.style));this._mainContainer.add(d),this._tooltipText=d,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;const{railWidth:i,railHeight:r}=this.attribute,o=this._isHorizontal?i:r,s=this._tooltipState.pos*o,a=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[a]:s});const{align:l}=this.attribute;if(this._tooltipText){const u=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[a]:s,text:u.formatter?u.formatter(this._tooltipState.value):this._isHorizontal||l!=="left"?`≈ ${this._tooltipState.value.toFixed((e=u.precision)!==null&&e!==void 0?e:0)}`:`${this._tooltipState.value.toFixed((t=u.precision)!==null&&t!==void 0?t:0)} ≈`})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;const{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),$i(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),(De.env==="browser"?De:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_clearAllDragEvents(){const t=Nh(),e=De.env==="browser"?De:this.stage;e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),t.forEach(i=>{e.removeEventListener(i,this._onHandlerPointerUp)}),e.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),t.forEach(i=>{e.removeEventListener(i,this._onTrackPointerUp)})}_updateTrack(){const{inverse:t,railWidth:e,railHeight:i}=this.attribute,r=this._startHandler,o=this._endHandler;if(this._isHorizontal){const s=r==null?void 0:r.attribute.x;if(o){const a=o==null?void 0:o.attribute.x;this._track.setAttributes({x:Math.min(s,a),width:Math.abs(s-a)})}else t?this._track.setAttributes({x:s,width:e-s}):this._track.setAttributes({width:s})}else{const s=r==null?void 0:r.attribute.y;if(o){const a=o==null?void 0:o.attribute.y;this._track.setAttributes({y:Math.min(s,a),height:Math.abs(s-a)})}else t?this._track.setAttributes({y:s,height:i-s}):this._track.setAttributes({height:s})}}_updateHandler(t,e,i){var r;const o=this._isHorizontal;t.setAttribute(o?"x":"y",e);const s=t.name===Ji.startHandler?this._startHandlerText:this._endHandlerText;if(s){const{handlerText:a={}}=this.attribute;s.setAttributes({text:a.formatter?a.formatter(i):i.toFixed((r=a.precision)!==null&&r!==void 0?r:0),[o?"x":"y"]:e})}t.name===Ji.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_updateHandlerText(t,e,i){var r;const o=this._isHorizontal,{handlerText:s={}}=this.attribute;t.setAttributes({[o?"x":"y"]:e,text:s.formatter?s.formatter(i):i.toFixed((r=s.precision)!==null&&r!==void 0?r:0)});const a=t.name===Ji.startHandlerText?this._startHandler:this._endHandler;a&&a.setAttributes({[o?"x":"y"]:e}),t.name===Ji.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_dispatchChangeEvent(){const t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){const{inverse:t}=this.attribute;let e=this._startHandler,i=this._endHandler;return i?(this._isHorizontal?(!t&&i.attribute.x<(e==null?void 0:e.attribute.x)||t&&i.attribute.x>(e==null?void 0:e.attribute.x))&&([e,i]=[i,e]):(!t&&i.attribute.y<(e==null?void 0:e.attribute.y)||t&&i.attribute.y>(e==null?void 0:e.attribute.y))&&([e,i]=[i,e]),{startHandler:e,endHandler:i}):{startHandler:e,endHandler:i}}release(t){super.release(t),(De.env==="browser"?De:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}Qd.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}};WY();class Xm extends Ww{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Xm.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=i=>{const r=this._slider.tooltipShape;if(r&&i.detail&&!zt(i.detail.value)){const o=this._colorScale.scale(i.detail.value);r.setAttribute("fill",o)}this.dispatchEvent(i)},this._onSliderChange=i=>{this._updateColor(),this.dispatchEvent(i)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){const{colors:t,slidable:e,layout:i,align:r,min:o,max:s,value:a,railWidth:l,railHeight:u,showHandler:h=!0,handlerSize:d,handlerStyle:c,railStyle:f,trackStyle:g,startText:m,endText:p,handlerText:v,showTooltip:b,tooltip:C,inverse:y,disableTriggerEvent:w}=this.attribute,_=[],A=(s-o)/(t.length-1);for(let S=0;S<t.length;S++)_.push(o+A*S);this._colorScale=new PY().domain(_,!0).range(t),this._color=this._getTrackColor();const T=new Qd({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:i,align:r,min:o,max:s,value:a,railWidth:l,railHeight:u,showHandler:h,handlerSize:d,handlerStyle:c,railStyle:f,trackStyle:Object.assign({fill:this._color},g),startText:m,endText:p,handlerText:v,showTooltip:b,tooltip:C,disableTriggerEvent:w,inverse:y});this._innerView.add(T),this._slider=T,T.translateTo(0-T.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+Rr(this.attribute,"title.space",Zd):0)-T.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){const{colors:t,layout:e,inverse:i}=this.attribute;if(We(t))return;const r=t.length;if(r===1)return t[0];const o=[];for(let l=0;l<r;l++){const u=l/(r-1);o.push({offset:u,color:t[l]})}const s=e==="horizontal",a={gradient:"linear",stops:o,x0:0,y0:0,x1:s?1:0,y1:s?0:1};return i&&(s?(a.x0=1,a.x1=0):(a.y0=1,a.y1=0)),a}_updateColor(){var t;const{layout:e="horizontal",colors:i,railWidth:r,railHeight:o}=this.attribute,{startHandler:s,endHandler:a,track:l,attribute:u}=this._slider,{startValue:h,endValue:d,startPos:c,endPos:f}=this._slider.currentValue,g=(t=u.handlerStyle)===null||t===void 0?void 0:t.fill;if(s&&!g){const p=this._colorScale.scale(h);s.setAttribute("fill",p)}if(a&&!g){const p=this._colorScale.scale(d);a.setAttribute("fill",p)}const m=e==="horizontal"?r:o;if(Math.abs(c-f)!==m&&i&&i.length>1){const p=this._color.stops,v=Math.min(c,f),b=Math.max(c,f),C=v/m,y=b/m,w=y-C,_=p.filter(M=>M.offset>C&&M.offset<y),A=Math.min(h,d),T=Math.max(h,d),S=this._colorScale.scale(A),x=this._colorScale.scale(T),E=[{offset:0,color:S}];_.forEach(M=>{E.push({offset:(M.offset-C)/w,color:M.color})}),E.push({offset:1,color:x}),l.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:E}))}}}Xm.defaultAttributes={layout:"horizontal",title:{align:"start",space:Zd,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}};function jY(n="bottom"){let t=0;return n==="top"?`
    M${t},-6L${t-3.5},-2.5
    v5
    h7
    v-5
    Z
`:n==="left"?(t=1,`
    M${t-6},0L${t-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):n==="right"?(t=-1,`
    M${t+6},0L${t+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${t},6L${t-3.5},2.5
    v-5
    h7
    v5
    Z
`}UY();class Ym extends Ww{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Ym.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=i=>{this.dispatchEvent(i)},this._onSliderToolipChange=i=>{this.dispatchEvent(i)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){const{slidable:t,layout:e,align:i,min:r,max:o,value:s,railWidth:a,railHeight:l,showHandler:u=!0,handlerSize:h,handlerStyle:d,railStyle:c,trackStyle:f,startText:g,endText:m,handlerText:p,showTooltip:v,tooltip:b,sizeBackground:C,disableTriggerEvent:y,inverse:w}=this.attribute,_=$t.group({x:0,y:0});this._innerView.add(_);const A=new Qd({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:i,min:r,max:o,value:s,railWidth:a,railHeight:l,showHandler:u,handlerSize:h,handlerStyle:Object.assign({symbolType:jY(i)},d),railStyle:c,trackStyle:f,startText:g,endText:m,handlerText:p,showTooltip:v,tooltip:b,disableTriggerEvent:y,inverse:w});_.add(A);let T,S=0;e==="horizontal"?i==="top"?(T=`M0,0L${a},0L${w?0:a},12Z`,S=l):(T=`M0,12L${a},12L${w?0:a},0Z`,A.setAttribute("y",12)):i==="left"?T=`M${a},0L${a+12},${w?0:l}L${a},${l}Z`:(T=`M0,${w?0:l}L12,${l}L12,0Z`,A.setAttribute("x",12));const x=$t.path(Object.assign(Object.assign({x:0,y:S,path:T},C),{zIndex:0}));_.add(x);const E=this._title?this._title.AABBBounds.height()+Rr(this.attribute,"title.space",Zd):0;_.translate(0-_.AABBBounds.x1,E-_.AABBBounds.y1),this._slider=A}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}Ym.defaultAttributes={layout:"horizontal",title:{align:"start",space:Zd,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}};function GY(){Yr(),Fo(),Vm()}GY();let ID=class FD extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},FD.defaultAttributes,t)),this.name="title"}render(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y;const{textType:w,text:_,subtextType:A,textStyle:T={},subtext:S,subtextStyle:x={},width:E,height:M,minWidth:L,maxWidth:I,minHeight:D,maxHeight:H,align:O,verticalAlign:N,padding:U=0}=this.attribute,W=Bo(U),j=this.createOrUpdateChild("title-container",{x:W[3],y:W[0],zIndex:1},"group"),Y=(t=T.height)!==null&&t!==void 0?t:M;if(this.attribute.visible!==!1&&T.visible!==!1){const{width:lt,maxHeight:_t,maxWidth:vt,x:yt=0,y:mt=0,ellipsis:ft=!0,wordBreak:Ft="break-word",maxWidth:St,lineClamp:Kt}=T;if(w==="rich"||Et(T.character)){const At=Object.assign({x:yt,y:mt,width:(e=lt??E)!==null&&e!==void 0?e:0,height:Y??0,ellipsis:ft==null||ft,wordBreak:Ft??"break-word",maxHeight:_t??H,maxWidth:vt??St,textConfig:(i=T.character)!==null&&i!==void 0?i:_},T);this._mainTitle=j.createOrUpdateChild("mainTitle",At,"richtext")}else if(w==="html"){const At=Object.assign({html:Object.assign(Object.assign({dom:_},m2),T),x:yt,y:mt,width:(r=lt??E)!==null&&r!==void 0?r:0,height:Y??0,ellipsis:ft,wordBreak:Ft,maxHeight:_t??H,maxWidth:vt??St,textConfig:[]},T);this._mainTitle=j.createOrUpdateChild("mainTitle",At,"richtext")}else Et(_)&&(this._mainTitle=j.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:jt(_)?_:[_],whiteSpace:"normal"},T),{maxLineWidth:(s=(o=T.maxLineWidth)!==null&&o!==void 0?o:lt)!==null&&s!==void 0?s:E,heightLimit:(a=T.height)!==null&&a!==void 0?a:H,lineClamp:Kt,ellipsis:ft,x:yt,y:mt}),"text"))}const Z=this._mainTitle?this._mainTitle.AABBBounds.height():0,rt=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(this.attribute.visible!==!1&&x.visible!==!1){const{width:lt,height:_t,maxWidth:vt,maxHeight:yt,x:mt=0,y:ft=0,ellipsis:Ft=!0,wordBreak:St="break-word",lineClamp:Kt}=x,At=Math.max(Number.MIN_VALUE,H-Z);if(A==="rich"||Et(x.character)){const Pt=Object.assign({x:mt,y:ft,width:(l=lt??E)!==null&&l!==void 0?l:0,height:(u=_t??M)!==null&&u!==void 0?u:0,ellipsis:Ft,wordBreak:St,maxHeight:yt??At,maxWidth:vt??I,textConfig:(h=x.character)!==null&&h!==void 0?h:S},x);this._subTitle=j.createOrUpdateChild("subTitle",Pt,"richtext")}else if(A==="html"){const Pt=Object.assign({html:Object.assign(Object.assign({dom:S},m2),x),x:mt,y:ft,width:(d=lt??E)!==null&&d!==void 0?d:0,height:(c=_t??M)!==null&&c!==void 0?c:0,ellipsis:Ft,wordBreak:St,maxHeight:yt??At,maxWidth:vt??I,textConfig:[]},x);this._subTitle=j.createOrUpdateChild("subTitle",Pt,"richtext")}else Et(S)&&(this._subTitle=j.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:jt(S)?S:[S],whiteSpace:"normal"},x),{maxLineWidth:(f=x.maxLineWidth)!==null&&f!==void 0?f:E,heightLimit:(g=x.heightLimit)!==null&&g!==void 0?g:At,lineClamp:Kt,ellipsis:Ft,x:0,y:Z}),"text"))}const J=this._subTitle?this._subTitle.AABBBounds.height():0,st=this._subTitle?this._subTitle.AABBBounds.width():0;let ht=Math.max(rt,st),at=Z+((m=x.height)!==null&&m!==void 0?m:J);if(Et(E)&&(ht=E),Et(M)&&(at=M),Et(L)&&ht<L&&(ht=L),Et(I)&&ht>I&&(ht=I),Et(D)&&at<D&&(at=D),Et(H)&&at>H&&(at=H),j.attribute.width=ht,j.attribute.height=at,j.attribute.boundsPadding=W,this._mainTitle){if(Et(O)||Et(T.align)){const vt=T.align?T.align:O,yt=(p=T.width)!==null&&p!==void 0?p:ht;vt==="center"?(this._mainTitle.setAttribute("x",yt/2),this._mainTitle.setAttribute("textAlign","center")):vt==="right"?(this._mainTitle.setAttribute("x",yt),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}const lt=T.verticalAlign?T.verticalAlign:N,_t=Y??(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height());lt==="middle"?(this._mainTitle.setAttribute("y",_t/2),this._mainTitle.setAttribute("textBaseline","middle")):lt==="bottom"?(this._mainTitle.setAttribute("y",_t),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if(Et(O)||Et(x.align)){const yt=x.align?x.align:O,mt=(b=(v=x.width)!==null&&v!==void 0?v:T.width)!==null&&b!==void 0?b:ht;yt==="center"?(this._subTitle.setAttribute("x",mt/2),this._subTitle.setAttribute("textAlign","center")):yt==="right"?(this._subTitle.setAttribute("x",mt),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}const lt=x.verticalAlign?x.verticalAlign:N,_t=this._mainTitle?Et(Y)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),Y):this._mainTitle.AABBBounds.y2:0,vt=(y=(C=x.height)!==null&&C!==void 0?C:M)!==null&&y!==void 0?y:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();lt==="middle"?(this._subTitle.setAttribute("y",_t+vt/2),this._subTitle.setAttribute("textBaseline","middle")):lt==="bottom"?(this._subTitle.setAttribute("y",_t+vt),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",_t),this._subTitle.setAttribute("textBaseline","top"))}}};ID.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};function $Y(){Yr(),bs(),Fo(),Um()}const qY='<svg width="200" height="200" viewBox="0 0 1024 1024" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M877.44815445 206.10060629a64.72691371 64.72691371 0 0 0-95.14856334 4.01306852L380.73381888 685.46812814 235.22771741 533.48933518a64.72691371 64.72691371 0 0 0-92.43003222-1.03563036l-45.82665557 45.82665443a64.72691371 64.72691371 0 0 0-0.90617629 90.61767965l239.61903446 250.10479331a64.72691371 64.72691371 0 0 0 71.19960405 15.14609778 64.33855261 64.33855261 0 0 0 35.08198741-21.23042702l36.24707186-42.71976334 40.5190474-40.77795556-3.36579926-3.49525333 411.40426297-486.74638962a64.72691371 64.72691371 0 0 0-3.88361443-87.64024149l-45.3088404-45.43829334z"></path></svg>',XY='<svg width="200" height="200" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="5" d="M5 12h14"/></svg>';$Y();class $s extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},$s.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?(this.setAttribute("checked",!1),this.setAttribute("indeterminate",!1)):(this.setAttribute("checked",!0),this.setAttribute("indeterminate",!1)),this._dispatchEvent("checkbox_state_change",{eventType:"checkbox_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(i,r,o)=>{"interactive"in i&&this.setAttribute("pickable",i.interactive),"disabled"in i&&this.setAttribute("cursor",i.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderIcon(),this.renderText(),this.layout()}renderBox(){this._box=new Kd(Jt({},this.attribute.box));const t=this.attribute.checked||this.attribute.indeterminate;t&&this.attribute.disabled?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill,stroke:this.attribute.box.disableCheckedStroke}):t?this._box.setAttributes({fill:this.attribute.box.checkedFill,stroke:this.attribute.box.checkedStroke}):this.attribute.disabled&&this._box.setAttributes({fill:this.attribute.box.disableFill}),this.appendChild(this._box)}renderIcon(){this._checkIcon=new Za(Jt({image:this.attribute.icon.checkIconImage},this.attribute.icon)),this.appendChild(this._checkIcon),this._indeterminateIcon=new Za(Jt({image:this.attribute.icon.indeterminateIconImage},this.attribute.icon)),this.appendChild(this._indeterminateIcon),this.attribute.checked?(this._checkIcon.setAttribute("visible",!0),this._indeterminateIcon.setAttribute("visible",!1)):this.attribute.indeterminate?(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!0)):(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!1))}renderText(){this._text=new ji(Jt({wrap:!0},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){const t=this.attribute.box.height,e=this.attribute.icon.height,i=this._text.AABBBounds.height(),r=Math.max(t,e,i),o=r/2-t/2,s=r/2-e/2,a=r/2-i/2,l=this.attribute.box.width,u=this.attribute.icon.width,h=Math.max(l,u),d=h/2-l/2,c=h/2-u/2,f=h+this.attribute.spaceBetweenTextAndIcon;this._box.setAttributes({x:d,y:o}),this._checkIcon.setAttributes({x:c,y:s}),this._indeterminateIcon.setAttributes({x:c,y:s}),this._text.setAttributes({x:f,y:a})}initAttributes(t,e){t=e!=null&&e.skipDefault?t:Jt({},$s.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}$s.defaultAttributes={interactive:!0,disabled:!1,checked:!1,indeterminate:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},icon:{checkIconImage:qY,indeterminateIconImage:XY,width:10,height:10,pickable:!1},box:{width:14,height:14,cornerRadius:2,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}};function YY(){Yr(),bs(),O$(),Um()}YY();class Au extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Au.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||this.attribute.checked||(this.setAttribute("checked",!0),this._dispatchEvent("radio_checked",{eventType:"radio_checked",target:this}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(i,r,o)=>{"interactive"in i&&this.setAttribute("pickable",i.interactive),"disabled"in i&&this.setAttribute("cursor",i.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderCircle(),this.renderText(),this.layout()}renderCircle(){this._circle=new wu(Jt({},this.attribute.circle));const t=this.attribute.checked;t&&this.attribute.disabled?this._circle.setAttributes({fill:this.attribute.circle.disableCheckedFill,stroke:this.attribute.circle.disableCheckedStroke}):t?this._circle.setAttributes({fill:this.attribute.circle.checkedFill,stroke:this.attribute.circle.checkedStroke}):this.attribute.disabled&&this._circle.setAttributes({fill:this.attribute.circle.disableFill}),this.appendChild(this._circle)}renderText(){this._text=new ji(Jt({},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){const t=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),e=this._text.AABBBounds.height(),i=Math.max(t,e),r=i/2-t/2+this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,o=i/2-e/2,s=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),a=this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,l=s+this.attribute.spaceBetweenTextAndIcon;this._circle.setAttributes({x:a,y:r}),this._text.setAttributes({x:l,y:o})}initAttributes(t,e){t=e!=null&&e.skipDefault?t:Jt({},Au.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}Au.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},circle:{outerRadius:7,innerRadius:3,startAngle:0,endAngle:2*Math.PI,lineWidth:1,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}};function KY(){Yr(),Fo(),Um()}const ZY='<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>';KY();let OD=class HD extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},HD.defaultAttributes,t))}render(){this.removeAllChild(!0),this.renderIcon(),this.renderText(),this.layout()}renderIcon(){this._emptyTipIcon=new Za(Jt({image:this.attribute.icon.image},this.attribute.icon)),this.appendChild(this._emptyTipIcon)}renderText(){this._text=new ji(Jt({wrap:!0},this.attribute.text)),this.appendChild(this._text)}layout(){const t=this.attribute.icon.height,e=this._text.AABBBounds.height(),i=this.attribute.icon.width,{width:r,height:o,spaceBetweenTextAndIcon:s}=this.attribute;this._emptyTipIcon.setAttribute("x",r/2-i/2),this._emptyTipIcon.setAttribute("y",o/2-t/2-e/2-s/2),this._text.setAttribute("x",r/2),this._text.setAttribute("textAlign","center"),this._text.setAttribute("y",o/2+t/2+s/2),this._text.setAttribute("textBaseline","middle")}};OD.defaultAttributes={spaceBetweenTextAndIcon:20,text:{text:"no data",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",pickable:!1},icon:{image:ZY,width:100,height:100,pickable:!1}};function QY(){Yr(),bs(),Fo(),YL()}QY();class Rd extends gn{constructor(t,e){super(e!=null&&e.skipDefault?t:Jt({},Rd.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this._dispatchEvent("switch_state_change",{eventType:"switch_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(i,r,o)=>{"interactive"in i&&this.setAttribute("pickable",i.interactive),"disabled"in i&&this.setAttribute("cursor",i.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderCircle(),this.renderText(),this.layout()}renderBox(){this._box=new Kd(Jt({},this.attribute.box)),this.attribute.disabled&&this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill}):this.attribute.disabled&&!this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableUncheckedFill}):this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.checkedFill}):this._box.setAttributes({fill:this.attribute.box.uncheckedFill}),this.appendChild(this._box)}renderCircle(){this._circle=new Cu(Jt({},this.attribute.circle)),this.appendChild(this._circle)}renderText(){var t,e,i;this._text=new ji(Jt({},(t=this.attribute.text)!==null&&t!==void 0?t:{})),this.attribute.checked&&(!((e=this.attribute.text)===null||e===void 0)&&e.checkedText)?this._text.setAttributes({text:this.attribute.text.checkedText}):!((i=this.attribute.text)===null||i===void 0)&&i.uncheckedText&&this._text.setAttributes({text:this.attribute.text.uncheckedText}),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){var t,e,i,r,o,s,a,l,u,h;const d=this.attribute.spaceBetweenTextAndCircle,c=this.attribute.circle.radius,f=this.attribute.box.height,g=2*c,m=this._text.AABBBounds.height(),p=Math.max(f,g,m),v=p/2-g/2+c,b=p/2-m/2,C=this.attribute.box.width,y=2*c,w=jm(((i=(e=(t=this.attribute.text)===null||t===void 0?void 0:t.checkedText)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0)>((s=(o=(r=this.attribute.text)===null||r===void 0?void 0:r.uncheckedText)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0)?(l=(a=this.attribute.text)===null||a===void 0?void 0:a.checkedText)!==null&&l!==void 0?l:"":(h=(u=this.attribute.text)===null||u===void 0?void 0:u.uncheckedText)!==null&&h!==void 0?h:"",this._text.attribute).width,_=Math.max(C,y+w+3*d),A=f/2-y/2+c,T=A+c+d;this._box.setAttributes({width:_,height:p}),this._circle.setAttributes({y:v,x:this.attribute.checked?_-A:A}),this._text.setAttributes({x:this.attribute.checked?_-T-w:T,y:b})}initAttributes(t,e){t=e!=null&&e.skipDefault?t:Jt({},Rd.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}Rd.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",circle:{radius:8,fill:"#FFF",pickable:!1},box:{width:40,height:24,cornerRadius:12,uncheckedFill:"rgb(201,205,212)",checkedFill:"#165DFF",disableUncheckedFill:"rgb(242,243,245)",disableCheckedFill:"rgb(148,191,255)",pickable:!1},text:{textAlign:"left",textBaseline:"top",pickable:!1},spaceBetweenTextAndCircle:6};let U2=!1;function JY(){U2||(U2=!0,wd(),kw()?Xg(te):KV()&&Zg(te),L$(),YL(),Yr(),Um(),Lw(),bs(),Vm(),F$(),zu(),Fo(),yA(),eq(),yA())}var Qt;(function(n){n.default="default",n.grabing="grabing",n.scrolling="scrolling"})(Qt||(Qt={}));var ye;(function(n){n.single="single",n.column="column",n.row="row",n.cross="cross",n.none="none"})(ye||(ye={}));const tK=["bgColor","color","strokeColor","borderColor","linkColor"];var ai;(function(n){n.RECORD="RECORD",n.NONE="NONE",n.SUM="SUM",n.MIN="MIN",n.MAX="MAX",n.AVG="AVG",n.COUNT="COUNT",n.CUSTOM="CUSTOM",n.RECALCULATE="RECALCULATE"})(ai||(ai={}));var V2;(function(n){n.ASC="ASC",n.DESC="DESC",n.NORMAL="NORMAL",n.desc="desc",n.asc="asc",n.normal="normal"})(V2||(V2={}));var en;(function(n){n.top="top",n.bottom="bottom",n.left="left",n.right="right"})(en||(en={}));var Yt;(function(n){n.expand="expand",n.collapse="collapse",n.none="none",n.loading="loading"})(Yt||(Yt={}));var Be;(function(n){n.inlineFront="inlineFront",n.inlineEnd="inlineEnd",n.left="left",n.right="right",n.absoluteRight="absoluteRight",n.contentLeft="contentLeft",n.contentRight="contentRight",n.absolute="absolute"})(Be||(Be={}));var Pe;(function(n){n.frozen="frozen",n.sort="sort",n.dropDown="dropDown",n.dropDownState="dropDownState",n.play="play",n.damagePic="damagePic",n.expand="expand",n.collapse="collapse",n.drillDown="drillDown",n.drillUp="drillUp",n.dragReorder="dragReorder"})(Pe||(Pe={}));var ir;(function(n){n.upwardIconName="sort_upward",n.downwardIconName="sort_downward",n.normalIconName="sort_normal",n.freezeIconName="freeze",n.frozenIconName="frozen",n.frozenCurrentIconName="frozenCurrent",n.dropdownIconName="dropdownIcon",n.expandIconName="expand",n.collapseIconName="collapse",n.dragReorderIconName="dragReorder",n.loadingIconName="loading"})(ir||(ir={}));const Vu=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,Eo=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||Vu(n,"Boolean"),pn=n=>typeof n=="function",xe=n=>n==null,et=n=>n!=null,Li=n=>{const t=typeof n;return n!==null&&t==="object"||t==="function"},eK=n=>typeof n=="object"&&n!==null,jw=function(n){if(!eK(n)||!Vu(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},ei=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||Vu(n,"String")},Wt=n=>Array.isArray?Array.isArray(n):Vu(n,"Array"),Gw=function(n){return n!==null&&typeof n!="function"&&Number.isFinite(n.length)},iK=n=>Vu(n,"Date"),wt=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||Vu(n,"Number")},Oa=n=>wt(n)&&Number.isFinite(n),rK=n=>({}).toString.call(n).replace(/^\[object /,"").replace(/]$/,""),nK=Object.prototype,oK=function(n){const t=n&&n.constructor;return n===(typeof t=="function"&&t.prototype||nK)},sK=Object.prototype.hasOwnProperty;function or(n){if(xe(n))return!0;if(Gw(n))return!n.length;const t=rK(n);if(t==="Map"||t==="Set")return!n.size;if(oK(n))return!Object.keys(n).length;for(const e in n)if(sK.call(n,e))return!1;return!0}const kf=(n,t,e)=>{const i=ei(t)?t.split("."):t;for(let r=0;r<i.length;r++)n=n?n[i[r]]:void 0;return n===void 0?e:n};function al(n,t,e){let i;if(!et(n)||typeof n!="object"||t)return n;const r=Wt(n),o=n.length;i=r?new Array(o):typeof n=="object"?{}:Eo(n)||wt(n)||ei(n)?n:iK(n)?new Date(+n):void 0;const s=r?void 0:Object.keys(Object(n));let a=-1;if(i)for(;++a<(s||n).length;){const l=s?s[a]:a,u=n[l];e&&e.includes(l.toString())?i[l]=u:i[l]=al(u,t,e)}return i}function zD(n,t,e=!1,i=!1){if(t){if(n===t)return;if(et(t)&&typeof t=="object"){const r=Object(t),o=[];for(const l in r)o.push(l);let{length:s}=o,a=-1;for(;s--;){const l=o[++a];!et(r[l])||typeof r[l]!="object"||i&&Wt(n[l])?ND(n,l,r[l]):aK(n,t,l,e,i)}}}}function aK(n,t,e,i=!1,r=!1){const o=n[e],s=t[e];let a=t[e],l=!0;if(Wt(s)){if(i)a=[];else if(Wt(o))a=o;else if(Gw(o)){a=new Array(o.length);let u=-1;const h=o.length;for(;++u<h;)a[u]=o[u]}}else jw(s)?(a=o??{},typeof o!="function"&&typeof o=="object"||(a={})):l=!1;l&&zD(a,s,i,r),ND(n,e,a)}function ND(n,t,e){(e!==void 0&&!lK(n[t],e)||e===void 0&&!(t in n))&&(n[t]=e)}function lK(n,t){return n===t||Number.isNaN(n)&&Number.isNaN(t)}function Ie(n,...t){let e=-1;const i=t.length;for(;++e<i;)zD(n,t[e],!0);return n}function uK(n,t){if(!n||!jw(n))return n;const e={};return Object.keys(n).forEach(i=>{const r=n[i];let o=!1;t.forEach(s=>{(ei(s)&&s===i||s instanceof RegExp&&i.match(s))&&(o=!0)}),o||(e[i]=r)}),e}function j2(n){return Object.prototype.toString.call(n)}function G2(n){return Object.keys(n)}function Ed(n,t,e){if(n===t)return!0;if(typeof n!=typeof t||n==null||t==null)return!1;if(Number.isNaN(n)&&Number.isNaN(t))return!0;if(j2(n)!==j2(t)||pn(n)||typeof n!="object")return!1;if(Wt(n)){if(n.length!==t.length)return!1;for(let o=n.length-1;o>=0;o--)if(!Ed(n[o],t[o]))return!1;return!0}if(!jw(n))return!1;const i=G2(n),r=G2(t);if(i.length!==r.length)return!1;i.sort(),r.sort();for(let o=i.length-1;o>=0;o--)if(i[o]!=r[o])return!1;for(let o=i.length-1;o>=0;o--){const s=i[o];if(!Ed(n[s],t[s]))return!1}return!0}function hK(n){if(Gw(n))return n[n.length-1]}const dK=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)>0&&(i=o)}return i},cK=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)<0&&(i=o)}return i};function fK(n,t){if(!Wt(n)||!Wt(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function gp(n){return n*(Math.PI/180)}const $2=n=>{let t=n.charCodeAt(0),e=n.length===2?n.charCodeAt(1):0,i=t;return 55296<=t&&t<=56319&&56320<=e&&e<=57343&&(t&=1023,e&=1023,i=t<<10|e,i+=65536),i===12288||65281<=i&&i<=65376||65504<=i&&i<=65510?"F":i===8361||65377<=i&&i<=65470||65474<=i&&i<=65479||65482<=i&&i<=65487||65490<=i&&i<=65495||65498<=i&&i<=65500||65512<=i&&i<=65518?"H":4352<=i&&i<=4447||4515<=i&&i<=4519||4602<=i&&i<=4607||9001<=i&&i<=9002||11904<=i&&i<=11929||11931<=i&&i<=12019||12032<=i&&i<=12245||12272<=i&&i<=12283||12289<=i&&i<=12350||12353<=i&&i<=12438||12441<=i&&i<=12543||12549<=i&&i<=12589||12593<=i&&i<=12686||12688<=i&&i<=12730||12736<=i&&i<=12771||12784<=i&&i<=12830||12832<=i&&i<=12871||12880<=i&&i<=13054||13056<=i&&i<=19903||19968<=i&&i<=42124||42128<=i&&i<=42182||43360<=i&&i<=43388||44032<=i&&i<=55203||55216<=i&&i<=55238||55243<=i&&i<=55291||63744<=i&&i<=64255||65040<=i&&i<=65049||65072<=i&&i<=65106||65108<=i&&i<=65126||65128<=i&&i<=65131||110592<=i&&i<=110593||127488<=i&&i<=127490||127504<=i&&i<=127546||127552<=i&&i<=127560||127568<=i&&i<=127569||131072<=i&&i<=194367||177984<=i&&i<=196605||196608<=i&&i<=262141?"W":32<=i&&i<=126||162<=i&&i<=163||165<=i&&i<=166||i===172||i===175||10214<=i&&i<=10221||10629<=i&&i<=10630?"Na":i===161||i===164||167<=i&&i<=168||i===170||173<=i&&i<=174||176<=i&&i<=180||182<=i&&i<=186||188<=i&&i<=191||i===198||i===208||215<=i&&i<=216||222<=i&&i<=225||i===230||232<=i&&i<=234||236<=i&&i<=237||i===240||242<=i&&i<=243||247<=i&&i<=250||i===252||i===254||i===257||i===273||i===275||i===283||294<=i&&i<=295||i===299||305<=i&&i<=307||i===312||319<=i&&i<=322||i===324||328<=i&&i<=331||i===333||338<=i&&i<=339||358<=i&&i<=359||i===363||i===462||i===464||i===466||i===468||i===470||i===472||i===474||i===476||i===593||i===609||i===708||i===711||713<=i&&i<=715||i===717||i===720||728<=i&&i<=731||i===733||i===735||768<=i&&i<=879||913<=i&&i<=929||931<=i&&i<=937||945<=i&&i<=961||963<=i&&i<=969||i===1025||1040<=i&&i<=1103||i===1105||i===8208||8211<=i&&i<=8214||8216<=i&&i<=8217||8220<=i&&i<=8221||8224<=i&&i<=8226||8228<=i&&i<=8231||i===8240||8242<=i&&i<=8243||i===8245||i===8251||i===8254||i===8308||i===8319||8321<=i&&i<=8324||i===8364||i===8451||i===8453||i===8457||i===8467||i===8470||8481<=i&&i<=8482||i===8486||i===8491||8531<=i&&i<=8532||8539<=i&&i<=8542||8544<=i&&i<=8555||8560<=i&&i<=8569||i===8585||8592<=i&&i<=8601||8632<=i&&i<=8633||i===8658||i===8660||i===8679||i===8704||8706<=i&&i<=8707||8711<=i&&i<=8712||i===8715||i===8719||i===8721||i===8725||i===8730||8733<=i&&i<=8736||i===8739||i===8741||8743<=i&&i<=8748||i===8750||8756<=i&&i<=8759||8764<=i&&i<=8765||i===8776||i===8780||i===8786||8800<=i&&i<=8801||8804<=i&&i<=8807||8810<=i&&i<=8811||8814<=i&&i<=8815||8834<=i&&i<=8835||8838<=i&&i<=8839||i===8853||i===8857||i===8869||i===8895||i===8978||9312<=i&&i<=9449||9451<=i&&i<=9547||9552<=i&&i<=9587||9600<=i&&i<=9615||9618<=i&&i<=9621||9632<=i&&i<=9633||9635<=i&&i<=9641||9650<=i&&i<=9651||9654<=i&&i<=9655||9660<=i&&i<=9661||9664<=i&&i<=9665||9670<=i&&i<=9672||i===9675||9678<=i&&i<=9681||9698<=i&&i<=9701||i===9711||9733<=i&&i<=9734||i===9737||9742<=i&&i<=9743||9748<=i&&i<=9749||i===9756||i===9758||i===9792||i===9794||9824<=i&&i<=9825||9827<=i&&i<=9829||9831<=i&&i<=9834||9836<=i&&i<=9837||i===9839||9886<=i&&i<=9887||9918<=i&&i<=9919||9924<=i&&i<=9933||9935<=i&&i<=9953||i===9955||9960<=i&&i<=9983||i===10045||i===10071||10102<=i&&i<=10111||11093<=i&&i<=11097||12872<=i&&i<=12879||57344<=i&&i<=63743||65024<=i&&i<=65039||i===65533||127232<=i&&i<=127242||127248<=i&&i<=127277||127280<=i&&i<=127337||127344<=i&&i<=127386||917760<=i&&i<=917999||983040<=i&&i<=1048573||1048576<=i&&i<=1114109?"A":"N"};function gK(n,t={},e){e||(e=1);const{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=t.fontWeight,fontSize:s=t.fontSize,fontFamily:a=t.fontFamily}=n;return(i?i+" ":"")+(r?r+" ":"")+(o?o+" ":"")+s*e+"px "+(a||"sans-serif")}class sn{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'"~`,this._option=t,this._userSpec=e??{},this.textSpec=this._initSpec(),et(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=et(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(xe(this._canvas)&&(et(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),xe(this._canvas)&&typeof window<"u"&&window.document!==void 0&&globalThis&&et(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),xe(this._context)&&et(this._canvas)){const t=this._canvas.getContext("2d");et(t)&&(t.save(),t.font=gK(this.textSpec),this._contextSaved=!0,this._context=t)}return!xe(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;const{defaultFontParams:r={}}=this._option,{fontStyle:o=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:a=(t=r.fontWeight)!==null&&t!==void 0?t:"normal",fontSize:l=(e=r.fontSize)!==null&&e!==void 0?e:12,fontFamily:u=(i=r.fontFamily)!==null&&i!==void 0?i:"sans-serif",align:h,textAlign:d=h??"center",baseline:c,textBaseline:f=c??"middle",ellipsis:g,limit:m}=this._userSpec;let{lineHeight:p=l}=this._userSpec;if(ei(p)&&p[p.length-1]==="%"){const v=Number.parseFloat(p.substring(0,p.length-1))/100;p=l*v}return{fontStyle:o,fontVariant:s,fontFamily:u,fontSize:l,fontWeight:a,textAlign:d,textBaseline:f,ellipsis:g,limit:m,lineHeight:p}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){if(xe(t))return{width:0,height:0};if(xe(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);const{fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:a,limit:l,lineHeight:u}=this.textSpec;let h;try{const d=this._option.getTextBounds({text:t,fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:!!a,maxLineWidth:l||1/0,lineHeight:u});h={width:d.width(),height:d.height()}}catch{this._notSupportVRender=!0,h=this.measureWithNaiveCanvas(t)}return h}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);const i=this._context.measureText(t),{fontSize:r,lineHeight:o}=this.textSpec;return{width:i.width,height:(e=o)!==null&&e!==void 0?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){const e={width:0,height:0};for(let i=0;i<t.length;i++){const r=t[i];let o=this._measureSpecialChar(r);xe(o)&&sn.NUMBERS_CHAR_SET.includes(r)&&(o=this._measureNumberChar()),xe(o)&&["F","W"].includes($2(r))&&(o=this._measureFullSizeChar()),xe(o)&&(o=this._measureLetterChar()),e.width+=o.width,e.height=Math.max(e.height,o.height),!xe(o.fontBoundingBoxAscent)&&(e.fontBoundingBoxAscent=o.fontBoundingBoxAscent),!xe(o.fontBoundingBoxDescent)&&(e.fontBoundingBoxDescent=o.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){var e;const i={width:0,height:0},{fontSize:r,lineHeight:o}=this.textSpec;for(let s=0;s<t.length;s++){const a=t[s],l=["F","W"].includes($2(a))?1:.53;i.width+=l*r}return i.height=(e=o)!==null&&e!==void 0?e:r,i}_measureReduce(t,e){var i;const{fontSize:r,lineHeight:o}=this.textSpec,s={width:0,height:0};if(xe(t))return s;if(Wt(t)){const a=t.filter(et).map(l=>l.toString());return a.length===0?s:a.length===1?e(a[0]):{width:a.reduce((l,u)=>Math.max(l,e(u).width),0),height:a.length*(((i=o)!==null&&i!==void 0?i:r)+1)+1}}return e(t.toString())}_measureNumberChar(){if(xe(this._numberCharSize)){const t=this._standardMethod(sn.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/sn.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return xe(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(sn.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(xe(this._letterCharSize)){const t=this._standardMethod(sn.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/sn.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return et(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){et(this._canvas)&&(this._canvas=null),et(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}sn.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",sn.NUMBERS_CHAR_SET="0123456789",sn.FULL_SIZE_CHAR="字";function pK(n,t,e){const{x1:i,y1:r,x2:o,y2:s}=t;return e.onlyTranslate()?(n!==t&&n.setValue(t.x1,t.y1,t.x2,t.y2),n.translate(e.e,e.f),t):(n.clear(),n.add(e.a*i+e.c*r+e.e,e.b*i+e.d*r+e.f),n.add(e.a*o+e.c*r+e.e,e.b*o+e.d*r+e.f),n.add(e.a*o+e.c*s+e.e,e.b*o+e.d*s+e.f),n.add(e.a*i+e.c*s+e.e,e.b*i+e.d*s+e.f),t)}class qs{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new qs(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return Wt(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){const r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){const o=this.scalePoints(t,e,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return pK(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){const{x1:r,y1:o,x2:s,y2:a}=this,l=Math.cos(t),u=Math.sin(t),h=e-e*l+i*u,d=i-e*u-i*l;return[l*r-u*o+h,u*r+l*o+d,l*r-u*a+h,u*r+l*a+d,l*s-u*o+h,u*s+l*o+d,l*s-u*a+h,u*s+l*a+d]}scalePoints(t,e,i,r){const{x1:o,y1:s,x2:a,y2:l}=this;return[t*o+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}}class jh extends qs{}class Zs{constructor(t){var e;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.children=[],this.key=t.key,this.field=t.field,this.formatFun=t.formatFun,this.isRecord=(e=t.isRecord)!==null&&e!==void 0?e:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(t,e,i){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),t,e,i):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.clearCacheValue()}}class mK extends Zs{constructor(){super(...arguments),this.type=ai.RECORD,this.isRecord=!0}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t))),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.clearCacheValue())}value(){var t;return(t=this.changedValue)!==null&&t!==void 0?t:this.records}reset(){this.children=[],this.changedValue=void 0,this.records=[]}recalculate(){}}class vK extends Zs{constructor(){super(...arguments),this.type=ai.NONE,this.isRecord=!0}push(t){t&&(this.isRecord&&(this.records=[t]),t.isAggregator&&this.children&&(this.children=[t]),this.field&&(this.fieldValue=t[this.field])),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){var t;return(t=this.changedValue)!==null&&t!==void 0?t:this.fieldValue}reset(){this.children=[],this.changedValue=void 0,this.records=[],this.fieldValue=void 0}recalculate(){}}class bK extends Zs{constructor(t){super(t),this.type=ai.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=t.aggregationFun}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.field&&this.values.push(t[this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.values=this.records.map(i=>i[this.field])),this.clearCacheValue())}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.values=this.records.map(e=>e[this.field]))),this.clearCacheValue()}value(){var t,e;return this.fieldValue||(this.fieldValue=(t=this.aggregationFun)===null||t===void 0?void 0:t.call(this,this.values,this.records,this.field)),(e=this.changedValue)!==null&&e!==void 0?e:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}}class _K extends Zs{constructor(t){var e;super(t),this.type=ai.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=(e=t.needSplitPositiveAndNegative)!==null&&e!==void 0&&e}push(t){if(t){if(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children){this.children.push(t);const e=t.value();this.sum+=e??0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const e=parseFloat(t[this.field]);this.sum+=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}this.clearCacheValue()}deleteRecord(t){if(t){if(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children){this.children=this.children.filter(i=>i!==t);const e=t.value();this.sum-=e??0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const e=parseFloat(t[this.field]);this.sum-=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}}this.clearCacheValue()}updateRecord(t,e){if(t&&e){if(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&this.children){const i=t.value();this.children=this.children.filter(o=>o!==t);const r=e.value();this.children.push(e),this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const i=parseFloat(t[this.field]),r=parseFloat(e[this.field]);this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}this.clearCacheValue()}}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.sum+=i??0,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum+=i:i<0&&(this.nagetiveSum+=i))}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];if(e.isAggregator){const i=e.value();this.sum+=i??0,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum+=i:i<0&&(this.nagetiveSum+=i))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){const i=parseFloat(e[this.field]);this.sum+=i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum+=i:i<0&&(this.nagetiveSum+=i))}}}}class CK extends Zs{constructor(){super(...arguments),this.type=ai.COUNT,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.count+=t.value()):this.count++),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.count-=t.value()):this.count--),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&(this.count+=e.value()-t.value()),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)))}value(){var t;return(t=this.changedValue)!==null&&t!==void 0?t:this.count}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.count+=i??0}else this.count++}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.count+=e.value():this.count++}}}class yK extends Zs{constructor(){super(...arguments),this.type=ai.AVG,this.sum=0,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&t.type===ai.AVG?(this.children&&this.children.push(t),this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&t.type===ai.AVG?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.sum-=t.sum,this.count-=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum-=parseFloat(t[this.field]),this.count--)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&t.type===ai.AVG?(this.children&&e.isAggregator&&(this.children=this.children.map(i=>i===t?e:i)),this.sum+=e.sum-t.sum,this.count+=e.count-t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(e[this.field])-parseFloat(t[this.field])),this.clearCacheValue())}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.sum/this.count:void 0}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator&&e.type===ai.AVG){const i=e.value();this.sum+=i*e.count,this.count+=e.count}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator&&e.type===ai.AVG?(this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)}}}class wK extends Zs{constructor(){super(...arguments),this.type=ai.MAX,this.max=Number.MIN_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.max=t.max>this.max?t.max:this.max):typeof t=="number"?this.max=t>this.max?t:this.max:this.field&&typeof t[this.field]=="number"?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.max:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.max=Math.max(this.max,i)}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.max=e.max>this.max?e.max:this.max:typeof e=="number"?this.max=e>this.max?e:this.max:this.field&&typeof e[this.field]=="number"?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)}}}class SK extends Zs{constructor(){super(...arguments),this.type=ai.MIN,this.min=Number.MAX_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.min=t.min<this.min?t.min:this.min):typeof t=="number"?this.min=t<this.min?t:this.min:this.field&&typeof t[this.field]=="number"?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.min:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.min=Math.min(this.min,i)}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.min=e.min<this.min?e.min:this.min:typeof e=="number"?this.min=e<this.min?e:this.min:this.field&&typeof e[this.field]=="number"?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)}}}let xK=1,Km=class{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,e){const i=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]);i.push(e);const r=xK++;return this.listenersData.listenerData[r]={type:t,listener:e,remove:()=>{delete this.listenersData.listenerData[r];const o=i.indexOf(e);i.splice(o,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},r}off(t,e){var i;if(e){const r=t;this.removeEventListener(r,e)}else{const r=t;if(!this.listenersData)return;(i=this.listenersData.listenerData[r])===null||i===void 0||i.remove()}}addEventListener(t,e,i){this.on(t,e)}removeEventListener(t,e){if(this.listenersData)for(const i in this.listenersData.listenerData){const r=this.listenersData.listenerData[i];r.type===t&&r.listener===e&&this.off(i)}}hasListeners(t){return!!this.listenersData&&!!this.listenersData.listeners[t]}fireListeners(t,e){if(!this.listenersData)return[];const i=this.listenersData.listeners[t];return i?i.map(r=>r.call(this,e)).filter(r=>et(r)):[]}release(){delete this.listenersData}},q2;const TK={CHANGE_STYLE:"change_style"};let io=class zC extends Km{static get EVENT_TYPE(){return TK}static get DEFAULT(){return q2||(q2=new zC)}constructor(t={},e={}){var i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O;super(),this._defaultPadding=[10,16,10,16],this._textAlign=(i=t==null?void 0:t.textAlign)!==null&&i!==void 0?i:e==null?void 0:e.textAlign,this._textBaseline=(r=t==null?void 0:t.textBaseline)!==null&&r!==void 0?r:e==null?void 0:e.textBaseline,this._color=(o=t==null?void 0:t.color)!==null&&o!==void 0?o:e==null?void 0:e.color,this._strokeColor=(s=t==null?void 0:t.strokeColor)!==null&&s!==void 0?s:e==null?void 0:e.strokeColor,this._fontSize=(a=t.fontSize)!==null&&a!==void 0?a:e==null?void 0:e.fontSize,this._fontFamily=(l=t.fontFamily)!==null&&l!==void 0?l:e==null?void 0:e.fontFamily,this._fontWeight=(u=t.fontWeight)!==null&&u!==void 0?u:e==null?void 0:e.fontWeight,this._fontVariant=(h=t.fontVariant)!==null&&h!==void 0?h:e==null?void 0:e.fontVariant,this._fontStyle=(d=t.fontStyle)!==null&&d!==void 0?d:e==null?void 0:e.fontStyle,this._padding=(f=(c=t==null?void 0:t.padding)!==null&&c!==void 0?c:e==null?void 0:e.padding)!==null&&f!==void 0?f:this._defaultPadding,this._borderColor=(g=t==null?void 0:t.borderColor)!==null&&g!==void 0?g:e==null?void 0:e.borderColor,this._textOverflow=(m=t==null?void 0:t.textOverflow)!==null&&m!==void 0?m:e==null?void 0:e.textOverflow,this._textStick=(v=(p=t.textStick)!==null&&p!==void 0?p:e==null?void 0:e.textStick)!==null&&v!==void 0&&v,this._textStickBaseOnAlign=(C=(b=t.textStickBaseOnAlign)!==null&&b!==void 0?b:e==null?void 0:e.textStickBaseOnAlign)!==null&&C!==void 0&&C,this._bgColor=(y=t==null?void 0:t.bgColor)!==null&&y!==void 0?y:e==null?void 0:e.bgColor,this._lineHeight=(w=t==null?void 0:t.lineHeight)!==null&&w!==void 0?w:e==null?void 0:e.lineHeight,this._underline=(_=t==null?void 0:t.underline)!==null&&_!==void 0?_:e==null?void 0:e.underline,this._underlineColor=(A=t==null?void 0:t.underlineColor)!==null&&A!==void 0?A:e==null?void 0:e.underlineColor,this._underlineDash=(T=t==null?void 0:t.underlineDash)!==null&&T!==void 0?T:e==null?void 0:e.underlineDash,this._underlineOffset=(S=t==null?void 0:t.underlineOffset)!==null&&S!==void 0?S:e==null?void 0:e.underlineOffset,this._lineThrough=(x=t==null?void 0:t.lineThrough)!==null&&x!==void 0?x:e==null?void 0:e.lineThrough,this._lineThroughColor=(E=t==null?void 0:t.lineThroughColor)!==null&&E!==void 0?E:e==null?void 0:e.lineThroughColor,this._lineThroughDash=(M=t==null?void 0:t.lineThroughDash)!==null&&M!==void 0?M:e==null?void 0:e.lineThroughDash,this._linkColor=(L=t==null?void 0:t.linkColor)!==null&&L!==void 0?L:e==null?void 0:e.linkColor,this._cursor=(I=t.cursor)!==null&&I!==void 0?I:e==null?void 0:e.cursor,this._borderLineWidth=(D=t.borderLineWidth)!==null&&D!==void 0?D:e==null?void 0:e.borderLineWidth,this._borderLineDash=(H=t.borderLineDash)!==null&&H!==void 0?H:e==null?void 0:e.borderLineDash,this._marked=(O=t.marked)!==null&&O!==void 0?O:e==null?void 0:e.marked}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get padding(){return this._padding}set padding(t){this._padding=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}get marked(){return this._marked}set marked(t){this._marked=t}clone(){return new zC(this,null)}},X2,AK=class NC extends io{static get DEFAULT(){return X2||(X2=new NC)}constructor(t={},e={}){super(t,e)}clone(){return new NC(this,null)}},Y2;class Md extends io{static get DEFAULT(){return Y2||(Y2=new Md)}constructor(t={},e={}){var i,r;super(t,e),this._autoWrapText=(i=t==null?void 0:t.autoWrapText)!==null&&i!==void 0?i:e==null?void 0:e.autoWrapText,this._lineClamp=(r=t==null?void 0:t.lineClamp)!==null&&r!==void 0?r:e==null?void 0:e.lineClamp}clone(){return new Md(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let K2,WC=class Lf extends io{static get DEFAULT(){return K2||(K2=new Lf)}constructor(t={},e={},i={}){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S;super(t,e),this._size=((o=(r=t==null?void 0:t.size)!==null&&r!==void 0?r:e==null?void 0:e.size)!==null&&o!==void 0?o:i==null?void 0:i.size)||14,this._spaceBetweenTextAndIcon=((a=(s=t==null?void 0:t.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e==null?void 0:e.spaceBetweenTextAndIcon)!==null&&a!==void 0?a:i==null?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=(u=(l=t==null?void 0:t.checkboxStyle)===null||l===void 0?void 0:l.defaultFill)!==null&&u!==void 0?u:i==null?void 0:i.defaultFill,this._defaultStroke=(d=(h=t==null?void 0:t.checkboxStyle)===null||h===void 0?void 0:h.defaultStroke)!==null&&d!==void 0?d:i==null?void 0:i.defaultStroke,this._disableFill=(f=(c=t==null?void 0:t.checkboxStyle)===null||c===void 0?void 0:c.disableFill)!==null&&f!==void 0?f:i==null?void 0:i.disableFill,this._checkedFill=(m=(g=t==null?void 0:t.checkboxStyle)===null||g===void 0?void 0:g.checkedFill)!==null&&m!==void 0?m:i==null?void 0:i.checkedFill,this._checkedStroke=(v=(p=t==null?void 0:t.checkboxStyle)===null||p===void 0?void 0:p.checkedStroke)!==null&&v!==void 0?v:i==null?void 0:i.checkedStroke,this._disableCheckedFill=(C=(b=t==null?void 0:t.checkboxStyle)===null||b===void 0?void 0:b.disableCheckedFill)!==null&&C!==void 0?C:i==null?void 0:i.disableCheckedFill,this._disableCheckedStroke=(w=(y=t==null?void 0:t.checkboxStyle)===null||y===void 0?void 0:y.disableCheckedStroke)!==null&&w!==void 0?w:i==null?void 0:i.disableCheckedStroke,this._checkIconImage=(A=(_=t==null?void 0:t.checkboxStyle)===null||_===void 0?void 0:_.checkIconImage)!==null&&A!==void 0?A:i==null?void 0:i.checkIconImage,this._indeterminateIconImage=(S=(T=t==null?void 0:t.checkboxStyle)===null||T===void 0?void 0:T.indeterminateIconImage)!==null&&S!==void 0?S:i==null?void 0:i.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new Lf(t,this)}clone(){return new Lf(this)}},Z2;class ja extends io{static get DEFAULT(){return Z2||(Z2=new ja)}constructor(t={},e={},i={}){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E;super(t,e),this._size=((o=(r=t==null?void 0:t.size)!==null&&r!==void 0?r:e==null?void 0:e.size)!==null&&o!==void 0?o:i==null?void 0:i.size)||14,this._spaceBetweenTextAndIcon=((a=(s=t==null?void 0:t.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e==null?void 0:e.spaceBetweenTextAndIcon)!==null&&a!==void 0?a:i==null?void 0:i.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=((u=(l=t==null?void 0:t.spaceBetweenRadio)!==null&&l!==void 0?l:e==null?void 0:e.spaceBetweenRadio)!==null&&u!==void 0?u:i==null?void 0:i.spaceBetweenRadio)||2,this._innerRadius=(d=(h=t==null?void 0:t.radioStyle)===null||h===void 0?void 0:h.innerRadius)!==null&&d!==void 0?d:i==null?void 0:i.innerRadius,this._outerRadius=(f=(c=t==null?void 0:t.radioStyle)===null||c===void 0?void 0:c.outerRadius)!==null&&f!==void 0?f:i==null?void 0:i.outerRadius,this._defaultFill=(m=(g=t==null?void 0:t.radioStyle)===null||g===void 0?void 0:g.defaultFill)!==null&&m!==void 0?m:i==null?void 0:i.defaultFill,this._defaultStroke=(v=(p=t==null?void 0:t.radioStyle)===null||p===void 0?void 0:p.defaultStroke)!==null&&v!==void 0?v:i==null?void 0:i.defaultStroke,this._disableFill=(C=(b=t==null?void 0:t.radioStyle)===null||b===void 0?void 0:b.disableFill)!==null&&C!==void 0?C:i==null?void 0:i.disableFill,this._checkedFill=(w=(y=t==null?void 0:t.radioStyle)===null||y===void 0?void 0:y.checkedFill)!==null&&w!==void 0?w:i==null?void 0:i.checkedFill,this._checkedStroke=(A=(_=t==null?void 0:t.radioStyle)===null||_===void 0?void 0:_.checkedStroke)!==null&&A!==void 0?A:i==null?void 0:i.checkedStroke,this._disableCheckedFill=(S=(T=t==null?void 0:t.radioStyle)===null||T===void 0?void 0:T.disableCheckedFill)!==null&&S!==void 0?S:i==null?void 0:i.disableCheckedFill,this._disableCheckedStroke=(E=(x=t==null?void 0:t.radioStyle)===null||x===void 0?void 0:x.disableCheckedStroke)!==null&&E!==void 0?E:i==null?void 0:i.disableCheckedStroke}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(t){this._spaceBetweenRadio=t}get innerRadius(){return this._innerRadius}set innerRadius(t){this._innerRadius=t}get outerRadius(){return this._outerRadius}set outerRadius(t){this._outerRadius=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}getStyle(t){return new ja(t,this)}clone(){return new ja(this)}}let Q2;class Ga extends io{static get DEFAULT(){return Q2||(Q2=new Ga)}constructor(t={},e={},i={}){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w;super(t,e),this._spaceBetweenTextAndCircle=((o=(r=t==null?void 0:t.spaceBetweenTextAndCircle)!==null&&r!==void 0?r:e==null?void 0:e.spaceBetweenTextAndCircle)!==null&&o!==void 0?o:i==null?void 0:i.spaceBetweenTextAndCircle)||6,this._circleRadius=((a=(s=t==null?void 0:t.switchStyle)===null||s===void 0?void 0:s.circleRadius)!==null&&a!==void 0?a:i==null?void 0:i.circleRadius)||8,this._boxWidth=((u=(l=t==null?void 0:t.switchStyle)===null||l===void 0?void 0:l.boxWidth)!==null&&u!==void 0?u:i==null?void 0:i.boxWidth)||40,this._boxHeight=((d=(h=t==null?void 0:t.switchStyle)===null||h===void 0?void 0:h.boxHeight)!==null&&d!==void 0?d:i==null?void 0:i.boxHeight)||24,this._checkedFill=((f=(c=t==null?void 0:t.switchStyle)===null||c===void 0?void 0:c.checkedFill)!==null&&f!==void 0?f:i==null?void 0:i.checkedFill)||"#165DFF",this._uncheckedFill=((m=(g=t==null?void 0:t.switchStyle)===null||g===void 0?void 0:g.uncheckedFill)!==null&&m!==void 0?m:i==null?void 0:i.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=((v=(p=t==null?void 0:t.switchStyle)===null||p===void 0?void 0:p.disableCheckedFill)!==null&&v!==void 0?v:i==null?void 0:i.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=((C=(b=t==null?void 0:t.switchStyle)===null||b===void 0?void 0:b.disableUncheckedFill)!==null&&C!==void 0?C:i==null?void 0:i.disableUncheckedFill)||"#f2f3f5",this._circleFill=((w=(y=t==null?void 0:t.switchStyle)===null||y===void 0?void 0:y.circleFill)!==null&&w!==void 0?w:i==null?void 0:i.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(t){this._spaceBetweenTextAndCircle=t}get circleRadius(){return this._circleRadius}set circleRadius(t){this._circleRadius=t}get boxWidth(){return this._boxWidth}set boxWidth(t){this._boxWidth=t}get boxHeight(){return this._boxHeight}set boxHeight(t){this._boxHeight=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(t){this._uncheckedFill=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(t){this._disableUncheckedFill=t}get circleFill(){return this._circleFill}set circleFill(t){this._circleFill=t}getStyle(t){return new Ga(t,this)}clone(){return new Ga(this)}}let J2;class $a extends io{static get DEFAULT(){return J2||(J2=new $a)}constructor(t={},e={},i={}){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S;super(t,e),this._buttonColor=((o=(r=t==null?void 0:t.buttonStyle)===null||r===void 0?void 0:r.buttonColor)!==null&&o!==void 0?o:i==null?void 0:i.buttonColor)||"#165DFF",this._buttonBorderColor=((a=(s=t==null?void 0:t.buttonStyle)===null||s===void 0?void 0:s.buttonBorderColor)!==null&&a!==void 0?a:i==null?void 0:i.buttonBorderColor)||"#165DFF",this._buttonLineWidth=((u=(l=t==null?void 0:t.buttonStyle)===null||l===void 0?void 0:l.buttonLineWidth)!==null&&u!==void 0?u:i==null?void 0:i.buttonLineWidth)||1,this._buttonBorderRadius=((d=(h=t==null?void 0:t.buttonStyle)===null||h===void 0?void 0:h.buttonBorderRadius)!==null&&d!==void 0?d:i==null?void 0:i.buttonBorderRadius)||2,this._buttonHoverColor=((f=(c=t==null?void 0:t.buttonStyle)===null||c===void 0?void 0:c.buttonHoverColor)!==null&&f!==void 0?f:i==null?void 0:i.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=((m=(g=t==null?void 0:t.buttonStyle)===null||g===void 0?void 0:g.buttonHoverBorderColor)!==null&&m!==void 0?m:i==null?void 0:i.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=(v=(p=t==null?void 0:t.buttonStyle)===null||p===void 0?void 0:p.buttonTextHoverColor)!==null&&v!==void 0?v:i==null?void 0:i.buttonTextHoverColor,this._buttonDisableColor=((C=(b=t==null?void 0:t.buttonStyle)===null||b===void 0?void 0:b.buttonDisableColor)!==null&&C!==void 0?C:i==null?void 0:i.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=((w=(y=t==null?void 0:t.buttonStyle)===null||y===void 0?void 0:y.buttonDisableBorderColor)!==null&&w!==void 0?w:i==null?void 0:i.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=(A=(_=t==null?void 0:t.buttonStyle)===null||_===void 0?void 0:_.buttonTextDisableColor)!==null&&A!==void 0?A:i==null?void 0:i.buttonTextDisableColor,this._buttonPadding=((S=(T=t==null?void 0:t.buttonStyle)===null||T===void 0?void 0:T.buttonPadding)!==null&&S!==void 0?S:i==null?void 0:i.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(t){this._buttonColor=t}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(t){this._buttonBorderColor=t}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(t){this._buttonLineWidth=t}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(t){this._buttonBorderRadius=t}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(t){this._buttonHoverColor=t}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(t){this._buttonHoverBorderColor=t}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(t){this._buttonTextHoverColor=t}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(t){this._buttonDisableColor=t}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(t){this._buttonDisableBorderColor=t}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(t){this._buttonTextDisableColor=t}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(t){this._buttonTextHoverBorderColor=t}get buttonPadding(){return this._buttonPadding}set buttonPadding(t){this._buttonPadding=t}getStyle(t){return new $a(t,this)}clone(){return new $a(this)}}const{EVENT_TYPE:Iat}=io;function $w(n,t,e,i=io,r,o){var s,a,l,u;return n||t?n instanceof io?n:typeof n=="function"?$w(n(e),t,e,i,r,o):(n||(n={}),r&&!et(n.autoWrapText)&&(n.autoWrapText=!0),i===WC?new WC(n??{},t??{},(s=o.checkboxStyle)!==null&&s!==void 0?s:{}):i===ja?new ja(n??{},t??{},(a=o.radioStyle)!==null&&a!==void 0?a:{}):i===Ga?new Ga(n??{},t??{},(l=o.switchStyle)!==null&&l!==void 0?l:{}):i===$a?new $a(n??{},t??{},(u=o.buttonStyle)!==null&&u!==void 0?u:{}):new i(n??{},t??{})):i.DEFAULT}class be{static get mode(){return be._mode||(be._mode=RK()),be._mode}static set mode(t){be._mode=t}static RegisterCreateCanvas(t){be.CreateCanvas=t}static RegisterLoadImage(t){be.LoadImage=t}static GetCreateCanvasFunc(){return be.CreateCanvas?be.CreateCanvas:be.mode==="worker"?(t=200,e=200)=>new OffscreenCanvas(t,e):void 0}static RegisterRequestAnimationFrame(t){be.RequestAnimationFrame=t()}static GetRequestAnimationFrame(){if(be.RequestAnimationFrame)return be.RequestAnimationFrame}static RegisterCancelAnimationFrame(t){be.CancelAnimationFrame=t()}static GetCancelAnimationFrame(){if(be.CancelAnimationFrame)return be.CancelAnimationFrame}}function RK(){let n="browser";try{window.type==="node"?n="node":typeof window>"u"||window.performance?typeof window>"u"&&(n="node"):n="miniApp"}catch{n="node"}return n}be.dpr=0;function EK(){try{const n=window.getSelection();if(n){if(typeof n.removeAllRanges=="function")return void n.removeAllRanges();if(typeof n.empty=="function")return void n.empty();if(typeof n.collapse=="function")return void n.collapse(document.body,0)}}catch{}}function MK(){if(be.mode==="node")return;const n=document.createElement("style");n.id="vtable-style-styleSheet",n.textContent=`
.vtable .input-container {
	position: absolute;
	top:0px;
}
.vtable .table-scrollable {
	position: absolute;
	overflow: scroll;
}
.vtable .table-scrollable::-webkit-scrollbar-button{
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-track-piece{
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-corner {
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-thumb {
	border-radius      : 4px;
	background-color   : rgba(100, 100, 100, .5);
}

.vtable .table-scroll-end-point {
	opacity: 0;
	position: relative;
}
.vtable {
	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */
	/* overflow: auto; */
	position: relative;
	width: 100%;
	height: 100%;
	text-align: left;
  -webkit-font-smoothing:auto;

  overflow: hidden; // for react-vtable dom custom element
}

.vtable-gantt {
	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */
	/* overflow: auto; */
	position: absolute;
	width: 100%;
	height: 100%;
	text-align: left;
  -webkit-font-smoothing:auto;

  overflow: hidden; // for react-vtable dom custom element
}
.vtable .table-component-container {
  pointer-events: none;
  overflow: hidden;
  position: absolute;
  top: 0px;
  left: 0px;
}
.vtable > canvas {
	position: absolute;
	width: 0;
	height: 0;
}
.vtable .table-focus-control {
	position: relative !important;
	width: 1px;
	height: 1px;
	opacity: 0;
	padding: 0;
	margin: 0;
	box-sizing: border-box;
	pointer-events: none;
	max-width: 500px;
	max-height: 500px;
	float: none !important;
}
.vtable input.table-focus-control::-ms-clear {
	visibility: hidden;
}
.vtable input.table-focus-control.composition {
	opacity: 1;
	max-width: none;
	max-height: none;
}
`,document.head.appendChild(n)}function BK(n){var t;return n!=null&&n.hoverOn||n!=null&&n.horizontalVisible&&(n==null?void 0:n.horizontalVisible)==="none"||!(n!=null&&n.horizontalVisible)&&(n==null?void 0:n.visible)==="none"?0:(t=n==null?void 0:n.width)!==null&&t!==void 0?t:7}function PK(n){var t;return n!=null&&n.hoverOn||n!=null&&n.verticalVisible&&(n==null?void 0:n.verticalVisible)==="none"||!(n!=null&&n.verticalVisible)&&(n==null?void 0:n.visible)==="none"?0:(t=n==null?void 0:n.width)!==null&&t!==void 0?t:7}function kK(n){return!!et(n)&&(!Wt(n)||n.some(t=>et(t)))}function LK(n){return n===0||Wt(n)&&n.every(t=>t===0)}const DK=n=>{switch(Object.prototype.toString.call(n)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},Zm=(n,t)=>DK(n)===t,sf=n=>Zm(n,"object"),IK=n=>Zm(n,"string"),FK=n=>Zm(n,"number"),OK=n=>Zm(n,"boolean");function Ve(n,...t){if(!t.length)return n||{};const e=t.shift();if(sf(n)&&sf(e))for(const i in e)sf(e[i])?(n[i]||Object.assign(n,{[i]:{}}),sf(n[i])||Object.assign(n,{[i]:e[i]}),Ve(n[i],e[i])):e[i]!==null&&e[i]!==void 0&&Object.assign(n,{[i]:e[i]});return Ve(n,...t)}function tR(n){return typeof n=="function"&&(n=n()),et(n)?`${n}`:""}function eR(n,t){let e=null;return function(...i){e||(n.apply(this,i),e=setTimeout(()=>{e=null},t))}}function HK(n,t){let e=null;return function(...i){e||(e=setTimeout(()=>{n.apply(this,i),e=null},t))}}function yv(n,t){for(n=`${n}`;n.length<t;)n="0"+n;return n}function ws(n,t,e){n=(n=n.replace(/^\s*|\s*$/,"")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");const i=Math.round(256*t)*1,r=n.match(new RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),o=r&&et(r[4])?r[4]:null,s=r?[r[1],r[2],r[3]]:n.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},${parseInt(arguments[3],16)}`}).split(/,/);return r?`rgb${o!==null?"a":""}(${Math.min(parseInt(s[0],10)+i,255)}, ${Math.min(parseInt(s[1],10)+i,255)}, ${Math.min(parseInt(s[2],10)+i,255)}${o!==null?`, ${o}`:""})`:["#",yv(Math.min(parseInt(s[0],10)+i,255).toString(16),2),yv(Math.min(parseInt(s[1],10)+i,255).toString(16),2),yv(Math.min(parseInt(s[2],10)+i,255).toString(16),2)].join("")}function Qm(n){return IK(n)||FK(n)||OK(n)?n.toString():""}function UC(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function pp(n,t,e){return e!=="desc"?n===t?0:n>t?1:-1:n===t?0:n<t?1:-1}function zK(n,t){let e,i=n;for(;(e=t.shift())&&(i=i[e],i););return i}function NK(n){return/^-?\d+(\.\d+)?$/.test(n)}function Gh(n){const t=[];for(let e=0;e<n.length;e++)t.indexOf(n[e])===-1&&t.push(n[e]);return t}function WK(n){const t=window.getSelection();if(t.rangeCount){const e=t.getRangeAt(0);return e.endOffset>e.startOffset&&n.contains(e.commonAncestorContainer)}return!1}function qw(n,t,e){e(n),n!=null&&n[t]&&Array.isArray(n==null?void 0:n[t])&&n[t].forEach(i=>qw(i,t,e))}const WD=typeof window>"u"||window.window===void 0;let wv,Sv;const UD={get find(){return wv||(wv=Array.prototype.find?(n,t)=>Array.prototype.find.call(n,t):(n,t)=>{const e=UD.findIndex(n,t);return e>=0?n[e]:void 0},wv)},get findIndex(){return Sv||(Sv=Array.prototype.findIndex?(n,t)=>Array.prototype.findIndex.call(n,t):(n,t)=>{const{length:e}=n;for(let i=0;i<e;i++)if(t(n[i],i,n))return i;return-1},Sv)}};function UK(){if(WD)return{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1};const n=window.navigator.userAgent.toLowerCase();return{IE:!!/(msie|trident)/.exec(n),Edge:n.indexOf("edge")>-1,Chrome:n.indexOf("chrome")>-1&&n.indexOf("edge")===-1,Firefox:n.indexOf("firefox")>-1,Safari:n.indexOf("safari")>-1&&n.indexOf("edge")===-1}}const{IE:VK,Chrome:Fat,Firefox:Oat,Edge:Hat,Safari:zat}=UK();function jK(n){return n===Object(n)}function Jd(...n){const t={};return n.forEach(e=>{for(const i in e)Object.defineProperty(t,i,{get:()=>e[i],set(r){e[i]=r},configurable:!0,enumerable:!0})}),t}function VD(n,t,...e){let i=n;for(let r=0;r<e.length&&i!=null;r++)i=t(i,e[r]);return i}function af(n,...t){return VD(n,(e,i)=>e[i],...t)}function Me(n,...t){return typeof n=="function"?n(...t):n}function GK(n,t,e){const i=Qm(n);(typeof e!="number"||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;const r=i.lastIndexOf(t,e);return r!==-1&&r===e}function ao(n){return!!(n&&typeof n.then=="function")}function mp(n,t){ao(n)?n.then(e=>{t(e)}).catch(e=>{}):t(n)}function $K(n){return!!n.changedTouches}function qK(n,t){if(n[t])return n[t];const e=t.toLowerCase();if(n[e])return n[e];const i=t.toLowerCase();if(n[i])return n[i];for(const r in n)if(r.toLowerCase()===e)return n[r]}function jD(n){return Array.isArray(n)?n.length===3?[n[0],n[1],n[2],n[1]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:[n[0],n[1],n[2],n[3]]:[n,n,n,n]}function Ln(n,t,e){return n.start.col<=t&&t<=n.end.col&&n.start.row<=e&&e<=n.end.row||n.end.col<=t&&t<=n.start.col&&n.end.row<=e&&e<=n.start.row||n.end.col<=t&&t<=n.start.col&&n.start.row<=e&&e<=n.end.row||n.start.col<=t&&t<=n.end.col&&n.end.row<=e&&e<=n.start.row}function XK(n,t,e){for(let i=0;i<n.length;i++){const r=n[i],o=Math.min(r.start.col,r.end.col),s=Math.max(r.start.col,r.end.col),a=Math.min(r.start.row,r.end.row),l=Math.max(r.start.row,r.end.row);if(o<=t&&t<=s&&a<=e&&e<=l||s<=t&&t<=o&&l<=e&&e<=a)return!0}return!1}function iR(n){return{start:{col:Math.min(n.start.col,n.end.col),row:Math.min(n.start.row,n.end.row)},end:{col:Math.max(n.start.col,n.end.col),row:Math.max(n.start.row,n.end.row)}}}function YK(n,t){const e=iR(n),i=iR(t);return Math.max(e.start.col,i.start.col)<=Math.min(e.end.col,i.end.col)&&Math.max(e.start.row,i.start.row)<=Math.min(e.end.row,i.end.row)}const KK={IE:VK},GD={isObject:jK},lf={endsWith:GK},ZK={isTouchEvent:$K},QK={toBoxArray:jD},JK=Function.prototype,ut={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",BEFORE_KEYDOWN:"before_keydown",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",CAN_SCROLL:"can_scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",BEFORE_SET_SIZE:"before_set_size",BEFORE_INIT:"before_init",AFTER_RENDER:"after_render",INITIALIZED:"initialized",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click",BEFORE_CACHE_CHART_IMAGE:"before_cache_chart_image",PASTED_DATA:"pasted_data"},tZ=n=>{switch(Object.prototype.toString.call(n)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},eZ=(n,t)=>tZ(n)===t,iZ=n=>eZ(n,"object");function $D(n,t,e){let i,r,o,s,a,l,u=0,h=!1,d=!1,c=!0;const f=!t&&t!==0&&typeof requestAnimationFrame=="function";if(typeof n!="function")throw new TypeError("Expected a function");function g(b){const C=i,y=r;return r=void 0,i=void 0,u=b,s=n.apply(y,C),s}function m(b,C){return f?requestAnimationFrame(b):setTimeout(b,C)}function p(b){const C=b-l;return l===void 0||C>=t||C<0||h&&b-u>=o}function v(){const b=Date.now();if(p(b))return function(C){return a=void 0,c&&i?g(C):(r=void 0,i=void 0,s)}(b);a=m(v,function(C){const y=C-u,w=t&&-(C-l);return h?Math.min(w,o-y):w}(b))}return t=+t||0,iZ(e)&&(d=!!e.leading,h="maxWait"in e,h&&(o=Math.max(+e.maxWait||0,t)),c="trailing"in e?!!e.trailing:c),function(...b){const C=Date.now(),y=p(C);if(i=b,r=this,l=C,y){if(a===void 0)return function(w){return u=w,a=m(v,t),d?g(w):s}(l);if(h)return a=m(v,t),g(l)}return a===void 0&&(a=m(v,t)),s}}let rZ=1,nZ=class{constructor(t,e,i){var r;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const o=this.getSize();let s=!1;o.width===this.lastSize.width&&o.height===this.lastSize.height&&(s=!0),this.lastSize=o,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:s}))},this.onResize=()=>{this.callBackDebounce()},this.element=t,this.cb=e,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=$D(this.callBack,this.resizeTime),window==null||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){const o=window.ResizeObserver;this.observer=new o(this.mutationResize),(r=this.observer)===null||r===void 0||r.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(t){this.lastSize=t}checkSize(){const t=this.getSize();return t.width!==this.lastSize.width||t.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}};class Jm{constructor(){this.listeners={},this.reseizeListeners={}}on(t,e,i,...r){if(be.mode==="node")return-1;const o=rZ++;if(t!=null&&t.addEventListener)if(e!=="resize"||t===window)t==null||t.addEventListener(e,i,...r);else{const a=new nZ(t,i,this.resizeTime);this.reseizeListeners[o]=a}const s={target:t,type:e,listener:i,options:r};return this.listeners[o]=s,o}once(t,e,i,...r){if(be.mode==="node")return-1;const o=this.on(t,e,(...s)=>{this.off(o),i(...s)},...r);return o}off(t){var e;if(be.mode==="node"||t===null)return;const i=(e=this.listeners)===null||e===void 0?void 0:e[t];i&&(delete this.listeners[t],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(t,e,...i){if(be.mode!=="node")for(const r in this.listeners){const o=this.listeners[r];o.target===t&&o.type===e&&o.listener.call(o.target,...i)}}hasListener(t,e){if(be.mode==="node")return!1;let i=!1;for(const r in this.listeners){const o=this.listeners[r];o.target===t&&o.type===e&&(i=!0)}return i}clear(){if(be.mode!=="node"){for(const t in this.listeners){const e=this.listeners[t];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(const t in this.reseizeListeners){const e=this.reseizeListeners[t];e==null||e.disConnect()}this.listeners={}}}release(){be.mode!=="node"&&(this.clear(),this.listeners={})}}const da=(n,t)=>{let e=0,i=n.length-1;for(;e<=i;){const r=Math.floor((e+i)/2);if(n[r]===t)return r;n[r]>t?i=r-1:e=r+1}return i<0?0:i};class Os{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(t,e,i){const{_keys:r}=this;if(this._sorted||(r.sort((s,a)=>s<a?-1:s>a?1:0),this._sorted=!0),t>e){const s=[];for(let a=da(r,t+i-1);a>=0;a--){const l=r[a];if(l>=t)s.push(this.get(l));else if(e<=l&&l<t)this.put(l+i,this.get(l));else if(l<e)break}for(let a=0;a<i;a++)this.put(e+a,s[i-1-a])}const{length:o}=r;if(t<e){const s=[];for(let a=da(r,t);a<o;a++){const l=r[a];if(l>=t&&l<t+i)s.push(this.get(l));else if(t+i<=l&&l<=e)this.put(l-i,this.get(l));else if(l>e)break}for(let a=0;a<i;a++)this.put(e+a,s[a])}}exchangeOrder(t,e,i,r,o){const{_keys:s}=this;if(this._sorted||(s.sort((a,l)=>a<l?-1:a>l?1:0),this._sorted=!0),t>i){const a=[],l=[];for(let u=da(s,i);u<da(s,t)+e;u++){const h=s[u];h>=t&&h<t+e?l.push(this.get(h)):a.push(this.get(h))}for(let u=0;u<e;u++)this.put(o+u,l[u]);for(let u=0;u<a.length;u++)this.put(o+e+u,a[u])}else{const a=[],l=[];for(let u=da(s,t);u<da(s,i)+r;u++){const h=s[u];h>=t&&h<t+e?l.push(this.get(h)):a.push(this.get(h))}for(let u=0;u<e;u++)this.put(o+u,l[u]);for(let u=0;u<a.length;u++)this.put(t+u,a[u])}}del(t){delete this._vals[t];const e=this._keys.indexOf(t);e!==-1&&this._keys.splice(e,1)}put(t,e){t in this._vals||(this._keys.push(t),this._sorted=!1),this._vals[t]=e}get(t){return this._vals[t]}has(t){return et(this._vals[t])}contain(t){return Object.values(this._vals).indexOf(t)>=0}each(t,e,i){const{_keys:r}=this,{length:o}=r;this._sorted||(r.sort((s,a)=>s<a?-1:s>a?1:0),this._sorted=!0);for(let s=da(r,t);s<o;s++){const a=r[s];if(t<=a&&a<=e){if(i(this.get(a),a)===!1)break}else if(e<a)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){const t=this.getLastIndex();this.del(t)}delAndReorder(t){if(!this.has(t))return;const e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}addAndReorder(t,e){if(et(e)){const i=this.getLastIndex();this.adjustOrder(t,t+1,i-t),this.put(t,e)}}}class yo{constructor(t,e,i,r){this.bounds=new qs,this.bounds.set(t,e,t+i,e+r)}static bounds(t,e,i,r){return new yo(t,e,Math.round(i-t),Math.round(r-e))}get left(){return this.bounds.x1}set left(t){this.bounds.x1=t}get top(){return this.bounds.y1}set top(t){this.bounds.y1=t}get right(){return this.bounds.x2}set right(t){this.bounds.x2=t}get bottom(){return this.bounds.y2}set bottom(t){this.bounds.y2=t}get width(){return this.bounds.width()}set width(t){this.bounds.x2=this.bounds.x1+t}get height(){return this.bounds.height()}set height(t){this.bounds.y2=this.bounds.y1+t}offsetLeft(t){this.bounds.translate(t,0)}offsetTop(t){this.bounds.translate(0,t)}copy(){return new yo(this.left,this.top,this.width,this.height)}contains(t){return this.bounds.encloses(t.bounds)}inPoint(t,e){return this.bounds.contains(t,e)}}function oZ(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#282a2e":"#2d3137"}const rR={name:"DARK",underlayBackgroundColor:"transparent",defaultStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},headerStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:"#e5e7ea",bgColor:oZ,fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#29364D"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(255, 255, 255, 0.1)",cellBorderColor:"#4284FF",cellBorderLineWidth:2},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"},functionalIconsStyle:{sort_color:"#FFFFFF",sort_color_opacity:"0.75",sort_color_2:"#416EFF",sort_color_opacity_2:"1",frozen_color:"#FFFFFF",frozen_color_opacity:"0.75",collapse_color:"#FFF",collapse_color_opacity:"0.75",expand_color:"#FFF",expand_color_opacity:"0.75",dragReorder_color:"#FFF",dragReorder_color_opacity:"0.75"}};function sZ(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#FFF":"#F4F8FF"}const nR={name:"BRIGHT",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#5286FA",hover:{cellBgColor:"#2E67E3"}},headerStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#A1C1FF",hover:{cellBgColor:"#2E67E3"}},bodyStyle:{color:"#000",bgColor:sZ,borderColor:"#E0EAFE",hover:{cellBgColor:"#E9EFFD"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"#CBDCFE",endColor:"#CBDCFE",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function aZ(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#fbfbfc":"#FFF"}const oR={name:"ARCO",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12]},headerStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},rowHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},cornerHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},bodyStyle:{padding:[8,12,8,12],color:"#141414",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:400,textAlign:"left",bgColor:aZ,borderColor:"#e1e4e8",lineHeight:14,hover:{cellBgColor:"#F7F8FA",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#3073f2"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function lZ(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#FDFDFD":"#FAF9FB"}const sR={name:"DEFAULT",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:"#E1E4E8",color:"#000",bgColor:"#ECF1F5"},headerStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},rowHeaderStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},cornerHeaderStyle:{fontSize:16,fontWeight:"bold"},bodyStyle:{fontSize:14,bgColor:lZ,hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"rgba(225, 228, 232, 0.6)",endColor:"rgba(225, 228, 232, 0.6)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#0000ff"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function uZ(n){const{row:t,table:{frozenRowCount:e}}=n;return e-1===t?["#f2f2f2","#f2f2f2","#ccc7c7","#f2f2f2"]:["#f2f2f2"]}function hZ(n){const{col:t,table:e}=n,{colCount:i,frozenColCount:r}=e,o="#ccc7c7";return r-1===t||i-1===t?[o,"#f2f2f2","#ccc7c7",null]:[o,null,"#ccc7c7",null]}const aR={name:"SIMPLIFY",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:hZ,hover:{cellBorderColor:"#0000FF",cellBgColor:"#D0E0E3"},bgColor:"#FFF"},headerStyle:{color:"rgba(0, 0, 0, 0.87)",borderColor:uZ},bodyStyle:{color:"rgba(0, 0, 0, 0.87)"},frameStyle:{borderColor:"#f2f2f2",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF"},selectionStyle:{cellBorderColor:"#FD5",cellBgColor:"rgba(111, 168, 220, 0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},dZ={},lR=16,uR="Arial,sans-serif",cZ="#FFF",fZ="#000",gZ=1,pZ=[],mZ="#000",Xw=/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,uf="$$indicator$$",vZ='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path  d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z"></path></svg>',bZ='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z"></path></svg>',_Z={type:"line"};function CZ(n){return{defaultAxisStyle:vh(n.defaultAxisStyle),leftAxisStyle:vh(n.leftAxisStyle),rightAxisStyle:vh(n.rightAxisStyle),topAxisStyle:vh(n.topAxisStyle),bottomAxisStyle:vh(n.bottomAxisStyle)}}function vh(n){return n||{}}const yZ={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:12,fontWeight:"bold",fill:"#4E5969"},contentStyle:{fontSize:12,fill:"#4E5969"},panel:{visible:!0,fill:"#fff",stroke:"#ffffff",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:"rgba(0, 0, 0, 0.1)",size:0,space:12}};function Cl(n,t,e,i){var r,o,s;return(s=(o=(r=af(n,...e))!==null&&r!==void 0?r:af(t,...e))!==null&&o!==void 0?o:i&&af(n,...i))!==null&&s!==void 0?s:i&&af(t,...i)}class hn{constructor(t,e){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name="",this.internalTheme={obj:t,superTheme:e},this.name=Cl(t,e,["name"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){const{obj:t,superTheme:e}=this.internalTheme;return Cl(t,e,["font"],["bodyStyle","font"])}get underlayBackgroundColor(){const{obj:t,superTheme:e}=this.internalTheme;return Cl(t,e,["underlayBackgroundColor"])}get cellInnerBorder(){var t;const{obj:e,superTheme:i}=this.internalTheme;return(t=Cl(e,i,["cellInnerBorder"]))===null||t===void 0||t}get cellBorderClipDirection(){var t;const{obj:e,superTheme:i}=this.internalTheme;return(t=Cl(e,i,["cellBorderClipDirection"]))!==null&&t!==void 0?t:"top-left"}get _contentOffset(){var t;const{obj:e,superTheme:i}=this.internalTheme;return(t=Cl(e,i,["_contentOffset"]))!==null&&t!==void 0?t:0}get defaultStyle(){const t=this;if(!this._defaultStyle){const{obj:e,superTheme:i}=this.internalTheme,r=Ve({},i.defaultStyle,e.defaultStyle);this._defaultStyle={get fontSize(){var o;return(o=r.fontSize)!==null&&o!==void 0?o:lR},get fontFamily(){var o;return(o=r.fontFamily)!==null&&o!==void 0?o:uR},get fontWeight(){return r.fontWeight},get fontVariant(){return r.fontVariant},get fontStyle(){return r.fontStyle},get bgColor(){var o;return(o=r.bgColor)!==null&&o!==void 0?o:cZ},get color(){var o;return(o=r.color)!==null&&o!==void 0?o:mZ},get borderColor(){var o;return(o=r.borderColor)!==null&&o!==void 0?o:fZ},get borderLineWidth(){var o;return(o=r.borderLineWidth)!==null&&o!==void 0?o:gZ},get borderLineDash(){var o;return(o=r.borderLineDash)!==null&&o!==void 0?o:pZ},get hover(){if(r.hover)return{get cellBgColor(){var o,s;return(s=(o=r.hover)===null||o===void 0?void 0:o.cellBgColor)!==null&&s!==void 0?s:void 0},get inlineColumnBgColor(){var o,s,a,l,u,h;return(h=(s=(o=r.hover)===null||o===void 0?void 0:o.inlineColumnBgColor)!==null&&s!==void 0?s:!((a=r.hover)===null||a===void 0)&&a.cellBgColor&&typeof((l=r.hover)===null||l===void 0?void 0:l.cellBgColor)=="string"?ws((u=r.hover)===null||u===void 0?void 0:u.cellBgColor,.1):void 0)!==null&&h!==void 0?h:void 0},get inlineRowBgColor(){var o,s,a,l,u,h;return(h=(s=(o=r.hover)===null||o===void 0?void 0:o.inlineRowBgColor)!==null&&s!==void 0?s:!((a=r.hover)===null||a===void 0)&&a.cellBgColor&&typeof((l=r.hover)===null||l===void 0?void 0:l.cellBgColor)=="string"?ws((u=r.hover)===null||u===void 0?void 0:u.cellBgColor,.1):void 0)!==null&&h!==void 0?h:void 0}}},get select(){if(r.select)return{get inlineColumnBgColor(){var o,s,a,l,u,h;return(h=(l=(s=(o=r.select)===null||o===void 0?void 0:o.inlineColumnBgColor)!==null&&s!==void 0?s:(a=t.selectionStyle)===null||a===void 0?void 0:a.inlineColumnBgColor)!==null&&l!==void 0?l:!((u=t.selectionStyle)===null||u===void 0)&&u.cellBgColor&&typeof t.selectionStyle.cellBgColor=="string"?ws(t.selectionStyle.cellBgColor,.1):void 0)!==null&&h!==void 0?h:void 0},get inlineRowBgColor(){var o,s,a,l,u;return(u=(a=(s=(o=r.select)===null||o===void 0?void 0:o.inlineRowBgColor)!==null&&s!==void 0?s:t.selectionStyle.inlineRowBgColor)!==null&&a!==void 0?a:!((l=t.selectionStyle)===null||l===void 0)&&l.cellBgColor&&typeof t.selectionStyle.cellBgColor=="string"?ws(t.selectionStyle.cellBgColor,.1):void 0)!==null&&u!==void 0?u:void 0}}},get padding(){var o;return(o=r.padding)!==null&&o!==void 0?o:[10,16,10,16]},get textAlign(){var o;return(o=r.textAlign)!==null&&o!==void 0?o:"left"},get textBaseline(){var o;return(o=r.textBaseline)!==null&&o!==void 0?o:"middle"},get textOverflow(){var o;return(o=r.textOverflow)!==null&&o!==void 0?o:"ellipsis"},get lineHeight(){return r.lineHeight},get autoWrapText(){var o;return(o=r.autoWrapText)!==null&&o!==void 0&&o},get lineClamp(){var o;return(o=r.lineClamp)!==null&&o!==void 0?o:"auto"},get linkColor(){var o;return(o=r.linkColor)!==null&&o!==void 0?o:"#3772ff"},get cursor(){var o;return(o=r.cursor)!==null&&o!==void 0?o:"auto"},get marked(){var o;return(o=r.marked)!==null&&o!==void 0&&o},get underline(){var o;return(o=r.underline)!==null&&o!==void 0&&o},get underlineColor(){return r.underlineColor},get underlineDash(){return r.underlineDash},get underlineOffset(){return r.underlineOffset},get lineThrough(){var o;return(o=r.lineThrough)!==null&&o!==void 0&&o},get lineThroughColor(){return r.lineThroughColor},get lineThroughDash(){return r.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){if(!this._cornerHeader){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},this.defaultStyle,e.cornerHeaderStyle,t.cornerHeaderStyle);this._cornerHeader=this.getStyle(i)}return this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightTopCellStyle&&!t.cornerRightTopCellStyle)return this._cornerRightTopCell;const i=Ve({},this.defaultStyle,e.cornerRightTopCellStyle,t.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(i)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerLeftBottomCellStyle&&!t.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;const i=Ve({},this.defaultStyle,e.cornerLeftBottomCellStyle,t.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(i)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightBottomCellStyle&&!t.cornerRightBottomCellStyle)return this._cornerRightBottomCell;const i=Ve({},this.defaultStyle,e.cornerRightBottomCellStyle,t.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(i)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){const{obj:t,superTheme:e}=this.internalTheme;if(!e.rightFrozenStyle&&!t.rightFrozenStyle)return this._rightFrozen;const i=Ve({},this.defaultStyle,this.rowHeaderStyle,e.rightFrozenStyle,t.rightFrozenStyle);this._rightFrozen=this.getStyle(i)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){const{obj:t,superTheme:e}=this.internalTheme;if(!e.bottomFrozenStyle&&!t.bottomFrozenStyle)return this._bottomFrozen;const i=Ve({},this.defaultStyle,this.headerStyle,e.bottomFrozenStyle,t.bottomFrozenStyle);this._bottomFrozen=this.getStyle(i)}return this._bottomFrozen}get rowHeaderStyle(){var t;if(!this._rowHeader){const{obj:e,superTheme:i}=this.internalTheme,r=Ve({},this.defaultStyle,i.rowHeaderStyle,(t=e.rowHeaderStyle)!==null&&t!==void 0?t:this.isPivot?null:e.headerStyle);this._rowHeader=this.getStyle(r)}return this._rowHeader}get headerStyle(){if(!this._header){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},this.defaultStyle,e.headerStyle,t.headerStyle);this._header=this.getStyle(i)}return this._header}get bodyStyle(){if(!this._body){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},this.defaultStyle,e.bodyStyle,t.bodyStyle);this._body=this.getStyle(i)}return this._body}get groupTitleStyle(){if(!this._groupTitle){const{obj:t,superTheme:e}=this.internalTheme;if(!e.groupTitleStyle&&!t.groupTitleStyle)return this._groupTitle;const i=Ve({},this.defaultStyle,e.groupTitleStyle,t.groupTitleStyle);this._groupTitle=this.getStyle(i)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.frameStyle,t.frameStyle);this._frameStyle={get borderColor(){return i.borderColor},get borderLineWidth(){return i.borderLineWidth},get borderLineDash(){return i.borderLineDash},get innerBorder(){return i.innerBorder},get shadowBlur(){return i.shadowBlur},get shadowColor(){return i.shadowColor},get shadowOffsetX(){return i.shadowOffsetX},get shadowOffsetY(){return i.shadowOffsetY},get cornerRadius(){return i.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.scrollStyle,t.scrollStyle);this._scroll={get scrollSliderColor(){var r;return(r=i.scrollSliderColor)!==null&&r!==void 0?r:"#C0C0C0"},get scrollSliderCornerRadius(){return i.scrollSliderCornerRadius},get scrollRailColor(){return i.scrollRailColor},get visible(){var r;return(r=i.visible)!==null&&r!==void 0?r:"scrolling"},get verticalVisible(){return i.verticalVisible},get horizontalVisible(){return i.horizontalVisible},get width(){var r;return(r=i.width)!==null&&r!==void 0?r:7},get hoverOn(){var r;return(r=i.hoverOn)===null||r===void 0||r},get barToSide(){var r;return(r=i.barToSide)!==null&&r!==void 0&&r},get horizontalPadding(){var r;return(r=i.horizontalPadding)!==null&&r!==void 0?r:0},get verticalPadding(){var r;return(r=i.verticalPadding)!==null&&r!==void 0?r:0}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.tooltipStyle,t.tooltipStyle);this._tooltip={get fontFamily(){var r;return(r=i.fontFamily)!==null&&r!==void 0?r:uR},get fontSize(){var r;return(r=i.fontSize)!==null&&r!==void 0?r:lR},get bgColor(){var r;return(r=i.bgColor)!==null&&r!==void 0?r:"#000"},get padding(){var r;return(r=i.padding)!==null&&r!==void 0?r:[6,8]},get color(){var r;return(r=i.color)!==null&&r!==void 0?r:"#FFF"},get maxWidth(){return i.maxWidth},get maxHeight(){return i.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.columnResize,t.columnResize);this._columnResize={get lineColor(){var r;return(r=i.lineColor)!==null&&r!==void 0?r:"#416EFF"},get bgColor(){var r;return(r=i.bgColor)!==null&&r!==void 0?r:"#D9E2FF"},get lineWidth(){var r;return(r=i.lineWidth)!==null&&r!==void 0?r:1},get width(){var r;return(r=i.width)!==null&&r!==void 0?r:i.lineWidth+2},get resizeHotSpotSize(){var r;return(r=i.resizeHotSpotSize)!==null&&r!==void 0?r:16},get labelColor(){var r;return(r=i.labelColor)!==null&&r!==void 0?r:"#FFF"},get labelFontSize(){var r;return(r=i.labelFontSize)!==null&&r!==void 0?r:10},get labelFontFamily(){var r;return(r=i.labelFontFamily)!==null&&r!==void 0?r:"sans-serif"},get labelBackgroundFill(){var r;return(r=i.labelBackgroundFill)!==null&&r!==void 0?r:"#3073F2"},get labelBackgroundCornerRadius(){var r;return(r=i.labelBackgroundCornerRadius)!==null&&r!==void 0?r:5},get labelVisible(){var r;return(r=i.labelVisible)===null||r===void 0||r},get visibleOnHover(){var r;return(r=i.visibleOnHover)!==null&&r!==void 0&&r}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.dragHeaderSplitLine,t.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var r;return(r=i.lineColor)!==null&&r!==void 0?r:"blue"},get lineWidth(){var r;return(r=i.lineWidth)!==null&&r!==void 0?r:2},get shadowBlockColor(){var r;return(r=i.shadowBlockColor)!==null&&r!==void 0?r:"rgba(204,204,204,0.3)"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.frozenColumnLine,t.frozenColumnLine);this._frozenColumnLine={get shadow(){if(i.shadow)return{get width(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.width)!==null&&o!==void 0?o:24},get startColor(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.startColor)!==null&&o!==void 0?o:"rgba(00, 24, 47, 0.06)"},get endColor(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.endColor)!==null&&o!==void 0?o:"rgba(00, 24, 47, 0)"},get visible(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.visible)!==null&&o!==void 0?o:"always"}}},get border(){if(i.border)return{get lineColor(){var r,o;return(o=(r=i.border)===null||r===void 0?void 0:r.lineColor)!==null&&o!==void 0?o:"rgba(00, 24, 47, 0.06)"},get bgColor(){var r,o,s,a;return(a=(o=(r=i.border)===null||r===void 0?void 0:r.bgColor)!==null&&o!==void 0?o:(s=i.border)===null||s===void 0?void 0:s.lineColor)!==null&&a!==void 0?a:"rgba(00, 24, 47, 0.06)"},get lineWidth(){var r,o;return(o=(r=i.border)===null||r===void 0?void 0:r.lineWidth)!==null&&o!==void 0?o:4},get width(){var r,o,s,a;return(a=(o=(r=i.border)===null||r===void 0?void 0:r.width)!==null&&o!==void 0?o:(s=i.border)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.selectionStyle,t.selectionStyle);this._selectionStyle={get cellBgColor(){var r;return(r=i==null?void 0:i.cellBgColor)!==null&&r!==void 0?r:"rgba(0, 0, 255,0.1)"},get cellBorderColor(){var r;return(r=i==null?void 0:i.cellBorderColor)!==null&&r!==void 0?r:"#3073f2"},get cellBorderLineWidth(){var r;return(r=i==null?void 0:i.cellBorderLineWidth)!==null&&r!==void 0?r:2},get inlineColumnBgColor(){return i==null?void 0:i.inlineColumnBgColor},get inlineRowBgColor(){return i==null?void 0:i.inlineRowBgColor},get selectionFillMode(){var r;return(r=i==null?void 0:i.selectionFillMode)!==null&&r!==void 0?r:"overlay"},get dynamicUpdateSelectionSize(){var r;return(r=i==null?void 0:i.dynamicUpdateSelectionSize)!==null&&r!==void 0&&r}}}return this._selectionStyle}get axisStyle(){if(!this._axisStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.axisStyle,t.axisStyle);this._axisStyle=CZ(i)}return this._axisStyle}get checkboxStyle(){if(!this._checkboxStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.checkboxStyle,t.checkboxStyle);this._checkboxStyle=i}return this._checkboxStyle}get radioStyle(){if(!this._radioStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.radioStyle,t.radioStyle);this._radioStyle=i}return this._radioStyle}get switchStyle(){if(!this._switchStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.switchStyle,t.switchStyle);this._switchStyle=i}return this._switchStyle}get buttonStyle(){if(!this._buttonStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.buttonStyle,t.buttonStyle);this._buttonStyle=i}return this._buttonStyle}get textPopTipStyle(){if(!this._textPopTipStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},yZ,e.textPopTipStyle,t.textPopTipStyle);this._textPopTipStyle=i}return this._textPopTipStyle}get functionalIconsStyle(){if(!this._internalIconsStyle){const{obj:t,superTheme:e}=this.internalTheme,i=Ve({},e.functionalIconsStyle,t.functionalIconsStyle);this._internalIconsStyle=i}return this._internalIconsStyle}hasProperty(t){const{obj:e,superTheme:i}=this.internalTheme;return hR(e,t)||hR(i,t)}extends(t){return new hn(Ve({},t),Ve(this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(t){const e=this;return{get fontSize(){return t.fontSize},get fontFamily(){return t.fontFamily},get fontWeight(){return t.fontWeight},get fontVariant(){return t.fontVariant},get fontStyle(){return t.fontStyle},get bgColor(){return t.bgColor},get color(){return t.color},get strokeColor(){return t.strokeColor},get borderColor(){return t.borderColor},get borderLineWidth(){return t.borderLineWidth},get borderLineDash(){return t.borderLineDash},get hover(){if(t.hover)return{get cellBgColor(){var i,r;return(r=(i=t.hover)===null||i===void 0?void 0:i.cellBgColor)!==null&&r!==void 0?r:void 0},get inlineColumnBgColor(){var i,r,o,s,a,l;return(l=(r=(i=t.hover)===null||i===void 0?void 0:i.inlineColumnBgColor)!==null&&r!==void 0?r:!((o=t.hover)===null||o===void 0)&&o.cellBgColor&&typeof((s=t.hover)===null||s===void 0?void 0:s.cellBgColor)=="string"?ws((a=t.hover)===null||a===void 0?void 0:a.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0},get inlineRowBgColor(){var i,r,o,s,a,l;return(l=(r=(i=t.hover)===null||i===void 0?void 0:i.inlineRowBgColor)!==null&&r!==void 0?r:!((o=t.hover)===null||o===void 0)&&o.cellBgColor&&typeof((s=t.hover)===null||s===void 0?void 0:s.cellBgColor)=="string"?ws((a=t.hover)===null||a===void 0?void 0:a.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0}}},get select(){return{get inlineColumnBgColor(){var i,r,o,s,a,l;return(l=(s=(r=(i=t.select)===null||i===void 0?void 0:i.inlineColumnBgColor)!==null&&r!==void 0?r:(o=e.selectionStyle)===null||o===void 0?void 0:o.inlineColumnBgColor)!==null&&s!==void 0?s:!((a=e.selectionStyle)===null||a===void 0)&&a.cellBgColor&&typeof e.selectionStyle.cellBgColor=="string"?ws(e.selectionStyle.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0},get inlineRowBgColor(){var i,r,o,s,a;return(a=(o=(r=(i=t.select)===null||i===void 0?void 0:i.inlineRowBgColor)!==null&&r!==void 0?r:e.selectionStyle.inlineRowBgColor)!==null&&o!==void 0?o:!((s=e.selectionStyle)===null||s===void 0)&&s.cellBgColor&&typeof e.selectionStyle.cellBgColor=="string"?ws(e.selectionStyle.cellBgColor,.1):void 0)!==null&&a!==void 0?a:void 0},get cellBgColor(){var i,r,o;if(e.selectionStyle.selectionFillMode==="replace")return(o=(r=(i=t.select)===null||i===void 0?void 0:i.cellBgColor)!==null&&r!==void 0?r:e.selectionStyle.cellBgColor)!==null&&o!==void 0?o:void 0}}},get frameStyle(){if(t.frameStyle)return{get borderColor(){var i,r;return(r=(i=t.frameStyle)===null||i===void 0?void 0:i.borderColor)!==null&&r!==void 0?r:void 0},get borderLineWidth(){var i,r;return(r=(i=t.frameStyle)===null||i===void 0?void 0:i.borderLineWidth)!==null&&r!==void 0?r:void 0},get borderLineDash(){var i,r;return(r=(i=t.frameStyle)===null||i===void 0?void 0:i.borderLineDash)!==null&&r!==void 0?r:void 0}}},get padding(){return t.padding},get textAlign(){return t.textAlign},get textBaseline(){return t.textBaseline},get textOverflow(){return t.textOverflow},get lineHeight(){return t.lineHeight},get autoWrapText(){return t.autoWrapText},get lineClamp(){return t.lineClamp},get linkColor(){return t.linkColor},get cursor(){return t.cursor},get textStick(){return t.textStick},get marked(){return t.marked},get underline(){var i;return(i=t.underline)!==null&&i!==void 0&&i},get underlineColor(){return t.underlineColor},get underlineDash(){return t.underlineDash},get underlineOffset(){return t.underlineOffset},get lineThrough(){var i;return(i=t.lineThrough)!==null&&i!==void 0&&i},get lineThroughColor(){return t.lineThroughColor},get lineThroughDash(){return t.lineThroughDash}}}}function hR(n,t){if(n instanceof hn)return n.hasProperty(t);let e=n;if(!e)return!1;for(let i=0;i<t.length;i++)if(e=e[t[i]],!e)return!1;return!!e}const qD=new hn(rR,rR),XD=new hn(nR,nR),YD=new hn(oR,oR),KD=new hn(sR,sR),ZD=new hn(aR,aR),wZ={DEFAULT:KD,SIMPLIFY:ZD,ARCO:YD,DARK:qD,BRIGHT:XD},SZ={TableTheme:hn};function xZ(n){if(!n)return null;if(typeof n=="string"){const t=qK(QD(),n);return t?t instanceof hn?t:new hn(t,t):null}return n instanceof hn?n:new hn(n,n)}function QD(){return Jd(wZ,dZ)}const Ss={DARK:qD,BRIGHT:XD,ARCO:YD,DEFAULT:KD,SIMPLIFY:ZD,theme:SZ,of:xZ,get:QD};function vi(n,t,e){var i;if(n.internalProps.customMergeCell){const o=n.getCustomMerge(t,e);if(o)return o.range}if(!n.internalProps.enableTreeNodeMerge&&!n.isHeader(t,e)&&!(!((i=n.getBodyColumnDefine(t,e))===null||i===void 0)&&i.mergeCell))return!1;const r=n.getCellRange(t,e);return!(r.start.col===r.end.col&&r.start.row===r.end.row)&&r}class Gt{static registerComponent(t,e){Gt._components[t]=e}static getComponent(t){return Gt._components[t]}static registerFunction(t,e){Gt._functions[t]=e}static getFunction(t){return Gt._functions[t]}static registerCellType(t,e){Gt._cellTypes[t]=e}static getCellType(t){return Gt._cellTypes[t]}}Gt._components={},Gt._functions={},Gt._cellTypes={};function TZ(n,t){const e=new Array(t);for(let i=0;i<t;i++)e[i]=n(i);return e}function AZ(n,t,e,i,r,o){const s=TZ(n,e);s.sort((a,l)=>i(o(a),o(l),r));for(let a=0;a<e;a++)t(a,s[a])}function RZ(n){if(GD.isObject(n)){const t=n;if(et(t.get)&&et(t.set))return!0}return!1}const hf={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function Ps(n,t){const e=Me(n);if(ao(e)){const i=e.then(r=>(t(r),r));return t(i),i}return e}function vp(n,t,e,i,r,o){if(n==null)return;if(ao(n))return n.then(l=>vp(l,t,e,i,r,o));const s=RZ(t)?t.get:t;if((s===void 0||s==="")&&Array.isArray(n))return n[e-r.leftRowSeriesNumberCount];if(Li(n)&&s in n)return Ps(n[s],o);if(typeof s=="function")return Ps(s(n,e,i,r),o);if(Array.isArray(s))return Ps(zK(n,[...s]),o);const a=`${s}`.split(".");return a.length<=1?Ps(n[s],o):Ps(VD(n,(l,u)=>vp(l,u,e,i,r,JK),...a),o)}function yl(n,t){if(!n)return t;const e=n[t];return et(e)?e:t}class us extends Km{static get EVENT_TYPE(){return hf}constructor(t,e,i,r,o,s){var a;super(),this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.registerAggregators(),this.dataSourceObj=t,this.dataConfig=e,this._get=t==null?void 0:t.get,this.columns=r,this._source=t!=null&&t.records?this.processRecords(t==null?void 0:t.records):t,this._sourceLength=((a=this._source)===null||a===void 0?void 0:a.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=i,this.pagination=i||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},s>=1&&(this.hierarchyExpandLevel=s),this.currentIndexedData=Array.from({length:this._sourceLength},(l,u)=>u),o==="tree"&&this.initTreeHierarchyState(),this.rowHierarchyType=o,this.updatePagerData()}initTreeHierarchyState(){var t,e;this._sourceLength=((t=this._source)===null||t===void 0?void 0:t.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(r,o)=>o);let i=this._sourceLength;for(let r=0;r<i;r++){const o=this.currentIndexedData[r],s=this.getOriginalRecord(o);if(!s)continue;const a=(e=s.filteredChildren)!==null&&e!==void 0?e:s.children;if((a==null?void 0:a.length)>0){if(this.hierarchyExpandLevel>1?!s.hierarchyState&&(s.hierarchyState=Yt.expand):!s.hierarchyState&&(s.hierarchyState=Yt.collapse),this.hasHierarchyStateExpand=!0,s.hierarchyState===Yt.collapse)continue;const l=this.initChildrenNodeHierarchy(o,this.hierarchyExpandLevel,2,s);r+=l,i+=l}else s.children===!0&&!s.hierarchyState&&(s.hierarchyState=Yt.collapse)}}supplementConfig(t,e,i,r){var o;this.columns=e,this._sourceLength=((o=this._source)===null||o===void 0?void 0:o.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=t,this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},r>=1&&(this.hierarchyExpandLevel=r),this.currentIndexedData=Array.from({length:this._sourceLength},(s,a)=>a),i==="tree"&&this.initTreeHierarchyState(),this.rowHierarchyType=i,this.updatePagerData()}registerAggregator(t,e){this.registedAggregators[t]=e}registerAggregators(){this.registerAggregator(ai.RECORD,mK),this.registerAggregator(ai.SUM,_K),this.registerAggregator(ai.COUNT,CK),this.registerAggregator(ai.MAX,wK),this.registerAggregator(ai.MIN,SK),this.registerAggregator(ai.AVG,yK),this.registerAggregator(ai.NONE,vK),this.registerAggregator(ai.CUSTOM,bK)}updateColumns(t){this.columns=t}_generateFieldAggragations(){const t=this.columns;this.fieldAggregators=[];const e=r=>{delete r.vtable_aggregator;const o=r.field,s=r.aggregation;if(s)if(Array.isArray(s))for(const a of s){const l=new this.registedAggregators[a.aggregationType]({field:o,formatFun:a.formatFun,isRecord:!0,aggregationFun:a.aggregationFun});this.fieldAggregators.push(l),r.vtable_aggregator||(r.vtable_aggregator=[]),r.vtable_aggregator.push(l)}else{const a=new this.registedAggregators[s.aggregationType]({field:o,formatFun:s.formatFun,isRecord:!0,aggregationFun:s.aggregationFun});this.fieldAggregators.push(a),r.vtable_aggregator=a}},i=r=>{if(r&&r.length!==0)for(const o of r)e(o),o.columns&&i(o.columns)};i(t)}processRecords(t){var e,i,r,o,s,a,l,u;this._generateFieldAggragations();const h=[],d=this.fieldAggregators.length>=1;if(((i=(e=this.dataConfig)===null||e===void 0?void 0:e.filterRules)===null||i===void 0?void 0:i.length)>=1||((r=this.lastFilterRules)===null||r===void 0?void 0:r.length)>=1||d){for(let c=0,f=t.length;c<f;c++){const g=t[c];((s=(o=this.dataConfig)===null||o===void 0?void 0:o.filterRules)===null||s===void 0?void 0:s.length)>=1?this.filterRecord(g)&&(h.push(g),this.rowHierarchyType==="tree"&&g.children&&(g.filteredChildren=this.filteredChildren(g.children)),d&&this.processRecord(g)):((a=this.lastFilterRules)===null||a===void 0?void 0:a.length)>=1?(this.clearFilteredChildren(g),d&&this.processRecord(g)):d&&this.processRecord(g)}if(((u=(l=this.dataConfig)===null||l===void 0?void 0:l.filterRules)===null||u===void 0?void 0:u.length)>=1)return h}return t}filteredChildren(t){const e=[];for(let i=0,r=t.length;i<r;i++){const o=t[i];this.filterRecord(o)&&(e.push(o),o.children&&(o.filteredChildren=this.filteredChildren(o.children)))}return e}processRecord(t){for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t)}initChildrenNodeHierarchy(t,e,i,r){var o,s,a;let l=0;const u=r.filteredChildren?r.filteredChildren.length:(s=(o=r.children)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0;for(let h=0;h<u;h++){(i<=e||r.hierarchyState===Yt.expand)&&(l+=1);const d=r.filteredChildren?r.filteredChildren[h]:r.children[h],c=Array.isArray(t)?t.concat(h):[t,h];(i<=e||r.hierarchyState===Yt.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+l,0,c),(d.filteredChildren?d.filteredChildren.length>0:((a=d.children)===null||a===void 0?void 0:a.length)>0)&&(i<e||d.hierarchyState===Yt.expand?(!d.hierarchyState&&(d.hierarchyState=Yt.expand),this.hasHierarchyStateExpand=!0):!d.hierarchyState&&(d.hierarchyState=Yt.collapse)),d.hierarchyState===Yt.expand&&(l+=this.initChildrenNodeHierarchy(c,e,i+1,d)),d.children===!0&&!d.hierarchyState&&(d.hierarchyState=Yt.collapse)}return l}updatePagination(t){this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){const{currentIndexedData:t}=this,{perPageCount:e,currentPage:i}=this.pagination,r=e*(i||0),o=r+e;if(this._currentPagerIndexedData.length=0,t&&t.length>0){let s=-1;for(let a=0;a<t.length;a++)if((Array.isArray(t[a])&&t[a].length===1||!Array.isArray(t[a]))&&s++,s>=r&&s<o)this._currentPagerIndexedData.push(t[a]);else if(s>=o)break}else if(this._sourceLength>0)throw new Error("currentIndexedData should has values!")}getRecordIndexPaths(t){return this._currentPagerIndexedData[t]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(t){return this.getOriginalRecord(yl(this.currentPagerIndexedData,t))}getRaw(t){return this.getRawRecord(yl(this.currentPagerIndexedData,t))}getIndexKey(t){return yl(this.currentPagerIndexedData,t)}getTableIndex(t){return Array.isArray(t)?this.rowHierarchyType==="tree"?this.currentPagerIndexedData.findIndex(e=>fK(e,t)):this.currentPagerIndexedData.findIndex(e=>e===t[0]):this.currentPagerIndexedData.findIndex(e=>e===t)}getField(t,e,i,r,o){return this.getOriginalField(yl(this.currentPagerIndexedData,t),e,i,r,o)}getRawField(t,e,i,r,o){return this.getRawFieldData(yl(this.currentPagerIndexedData,t),e,i,r,o)}hasField(t,e){return this.hasOriginalField(yl(this.currentPagerIndexedData,t),e)}getHierarchyState(t){var e;const i=this.getOriginalRecord(this.currentPagerIndexedData[t]);if(i!=null&&i.hierarchyState){const r=i.hierarchyState;if(((e=i.children)===null||e===void 0?void 0:e.length)>0||i.children===!0)return r}return null}toggleHierarchyState(t,e,i){const r=this.currentIndexedData.slice(0),o=this.getIndexKey(t),s=this.getHierarchyState(t),a=this.getOriginalRecord(o);if(this.clearSortedIndexMap(),s===Yt.collapse)a.hierarchyState=Yt.expand,this.pushChildrenNode(o,Yt.expand,a),this.hasHierarchyStateExpand=!0;else if(s===Yt.expand){let h=0;const d=(c,f,g)=>{if(!f||f===Yt.collapse||f===Yt.none)return;const m=g.filteredChildren?g.filteredChildren:g.children;if(m)for(let p=0;p<m.length;p++){h+=1;const v=Array.isArray(c)?c.concat([p]):[c,p];d(v,m[p].hierarchyState,m[p])}};d(o,s,a),this.currentIndexedData.splice(this.currentIndexedData.indexOf(o)+1,h),a.hierarchyState=Yt.collapse}this.updatePagerData();const l=[],u=[];if(s===Yt.collapse){const h=this.currentIndexedData.length-r.length;for(let d=0;d<h;d++)l.push(t+d+1)}else if(s===Yt.expand){const h=r.length-this.currentIndexedData.length;for(let d=0;d<h;d++)u.push(t+d+1)}return{add:l,remove:u}}pushChildrenNode(t,e,i){var r,o;if(!e||e===Yt.collapse||e===Yt.none)return 0;let s=0;const a=i.filteredChildren?i.filteredChildren:i.children;if(a){const l=Array.from({length:a.length},(u,h)=>h);(r=this.lastSortStates)===null||r===void 0||r.forEach(u=>{u.order!=="normal"&&AZ(h=>et(l[h])?l[h]:l[h]=h,(h,d)=>{l[h]=d},a.length,u.orderFn,u.order,h=>this.getOriginalField(Array.isArray(t)?t.concat([h]):[t,h],u.field))});for(let u=0;u<l.length;u++){s+=1;const h=Array.isArray(t)?t.concat([l[u]]):[t,l[u]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+s,0,h);const d=this.getOriginalRecord(h);!d.hierarchyState&&((o=d.filteredChildren)!==null&&o!==void 0?o:d.children)&&(d.hierarchyState=Yt.collapse),s+=this.pushChildrenNode(h,d.hierarchyState,a[l[u]])}}return s}changeFieldValue(t,e,i,r,o,s){var a;if(i!==null&&e>=0){const l=this.getIndexKey(e);if(this.cacheBeforeChangedRecord(l,s),i!==void 0&&i!==""||(i=r-s.leftRowSeriesNumberCount),typeof i=="string"||typeof i=="number"){const u=(a=this.beforeChangedRecordsMap.get(l.toString()))===null||a===void 0?void 0:a[i],h=this.getOriginalRecord(l);let d=t;typeof u=="number"&&NK(t)&&(d=parseFloat(t)),ao(h)?h.then(c=>{c[i]=d}).catch(c=>{}):h?h[i]=d:(this.records[l]={},this.records[l][i]=d)}}}cacheBeforeChangedRecord(t,e){var i;if(!this.beforeChangedRecordsMap.has(t.toString())){const r=this.getOriginalRecord(t);this.beforeChangedRecordsMap.set(t.toString(),(i=al(r,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))!==null&&i!==void 0?i:{})}}setRecord(t,e){var i,r;let o=!0;if(((r=(i=this.dataConfig)===null||i===void 0?void 0:i.filterRules)===null||r===void 0?void 0:r.length)>=1&&(this.filterRecord(t)?this.rowHierarchyType==="tree"&&t.children&&(t.filteredChildren=this.filteredChildren(t.children)):o=!1),o&&Array.isArray(this.records)){const s=this.getIndexKey(e);Array.isArray(s)||this.records.splice(s,1,t)}}addRecord(t,e){var i;if(Array.isArray(this.records)){this.records.splice(e,0,t),this.adjustBeforeChangedRecordsMap(e,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let r=0;r<this.fieldAggregators.length;r++)this.fieldAggregators[r].push(t);if(this.rowHierarchyType==="tree"&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;const{perPageCount:r,currentPage:o}=this.pagination;e<r*(o||0)+r&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();!((i=this.dataSourceObj)===null||i===void 0)&&i.added&&this.dataSourceObj.added(e,1)}}addRecords(t,e){var i;if(Array.isArray(this.records)){if(Array.isArray(t)){this.records.splice(e,0,...t),this.adjustBeforeChangedRecordsMap(e,t.length);for(let r=0;r<t.length;r++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length;for(let r=0;r<this.fieldAggregators.length;r++)for(let o=0;o<t.length;o++)this.fieldAggregators[r].push(t[o])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;const{perPageCount:r,currentPage:o}=this.pagination;e<r*(o||0)+r&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();!((i=this.dataSourceObj)===null||i===void 0)&&i.added&&this.dataSourceObj.added(e,t.length)}}addRecordForSorted(t){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(t),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(t){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(t)){this.records.push(...t);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(t,e,i="add"){for(let r=this.beforeChangedRecordsMap.size-1;r>=t;r--){const o=this.beforeChangedRecordsMap.get(r.toString());this.beforeChangedRecordsMap.delete(r.toString()),this.beforeChangedRecordsMap.set((r+(i==="add"?e:-e)).toString(),o)}}deleteRecords(t){var e;if(Array.isArray(this.records)){const i=[],r=t.sort((o,s)=>s-o);for(let o=0;o<r.length;o++){const s=r[o];if(s>=this._sourceLength||s<0)continue;this.adjustBeforeChangedRecordsMap(s,1,"delete"),i.push(s);const a=this.records[s];for(let l=0;l<this.fieldAggregators.length;l++)this.fieldAggregators[l].deleteRecord(a);this.records.splice(s,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),!((e=this.dataSourceObj)===null||e===void 0)&&e.deleted&&this.dataSourceObj.deleted(i),i}return[]}deleteRecordsForSorted(t){if(Array.isArray(this.records)){const e=t.sort((i,r)=>r-i);for(let i=0;i<e.length;i++){const r=e[i];if(r>=this._sourceLength||r<0)continue;const o=this.currentIndexedData[r];this.records.splice(o,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(t,e){const i=[];for(let r=0;r<e.length;r++){const o=e[r];if(Array.isArray(o))this.beforeChangedRecordsMap.delete(o.toString()),i.push(o),o.slice(0,-1).reduce((s,a)=>(s[a]===void 0&&(s[a]={}),s[a].children),this.records)[o[o.length-1]]=t[r];else{if(o>=this._sourceLength||o<0)continue;this.beforeChangedRecordsMap.delete(o.toString()),i.push(o);for(let s=0;s<this.fieldAggregators.length;s++)this.fieldAggregators[s].updateRecord(this.records[o],t[r]);this.records[o]=t[r]}}return this.userPagination&&this.updatePagerData(),i}updateRecordsForSorted(t,e){for(let i=0;i<e.length;i++){const r=e[i];if(r>=this._sourceLength||r<0)continue;const o=this.currentIndexedData[r];if(typeof o!="number")return;this.beforeChangedRecordsMap.delete(o.toString()),this.records[o]=t[i]}this.sortedIndexMap.clear()}sort(t){t=(Array.isArray(t)?t:[t]).filter(o=>{const s=this.columns.find(a=>a.field===o.field);return(s==null?void 0:s.sort)!==!1&&o.order!=="normal"}),this.lastSortStates=t;let e=t.map(o=>this.sortedIndexMap.get(o==null?void 0:o.field)||{asc:[],desc:[],normal:[]}),i=null;if(e.length>0&&(i=t.reduce((o,s,a)=>{var l;const u=(l=e[a])===null||l===void 0?void 0:l[s.order];return u&&u.length>0?u:o},null),i&&i.length>0))return this.currentIndexedData=i,this.updatePagerData(),void this.fireListeners(hf.CHANGE_ORDER,null);const r=Array.from({length:this._sourceLength},(o,s)=>s);if(r.sort((o,s)=>t.reduce((a,l)=>a!==0?a:(l.orderFn||(l.order!=="desc"?(u,h)=>u===h?0:u>h?1:-1:(u,h)=>u===h?0:u<h?1:-1))(this.getOriginalField(o,l.field),this.getOriginalField(s,l.field),l.order),0)),this.currentIndexedData=r,this.hierarchyExpandLevel){let o=r.length;for(let s=0;s<o;s++){const a=this.getOriginalRecord(r[s]),l=this.pushChildrenNode(r[s],a.hierarchyState,this.getOriginalRecord(r[s]));o+=l,s+=l}}if(!e.length){e=t.map(()=>({asc:[],desc:[],normal:[]}));for(let o=0;o<t.length;o++)this.sortedIndexMap.set(t[o].field,e[o])}t.forEach((o,s)=>{e[s][o.order]=r.slice()}),this.updatePagerData(),this.fireListeners(hf.CHANGE_ORDER,null)}setSortedIndexMap(t,e){this.sortedIndexMap.set(t,e)}clearFilteredChildren(t){var e,i;t.filteredChildren=void 0;for(let r=0;r<((i=(e=t.children)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0);r++)this.clearFilteredChildren(t.children[r])}filterRecord(t){var e,i,r;let o=!0;for(let s=0;s<((e=this.dataConfig.filterRules)===null||e===void 0?void 0:e.length);s++){const a=(i=this.dataConfig)===null||i===void 0?void 0:i.filterRules[s];if(a.filterKey){const l=t[a.filterKey];if(a.filteredValues.indexOf(l)===-1){o=!1;break}}else if(!(!((r=a.filterFunc)===null||r===void 0)&&r.call(a,t))){o=!1;break}}return o}updateFilterRulesForSorted(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords((i=(e=this.dataSourceObj)===null||e===void 0?void 0:e.records)!==null&&i!==void 0?i:this.dataSourceObj),this._sourceLength=((r=this._source)===null||r===void 0?void 0:r.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(o,s)=>s),this.rowHierarchyType==="tree"&&this.initTreeHierarchyState(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords((i=(e=this.dataSourceObj)===null||e===void 0?void 0:e.records)!==null&&i!==void 0?i:this.dataSourceObj),this._sourceLength=((r=this._source)===null||r===void 0?void 0:r.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(o,s)=>s),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.rowHierarchyType==="tree"&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((t,e)=>{this.lastSortStates.some(i=>i.field===e)?this.lastSortStates.forEach(i=>{i.order==="asc"?(t.desc=[],t.normal=[]):i.order==="desc"?(t.asc=[],t.normal=[]):(t.asc=[],t.desc=[])}):this.sortedIndexMap.delete(e)})}get sourceLength(){return this._sourceLength}set sourceLength(t){this._sourceLength!==t&&(this._sourceLength=t,this.fireListeners(hf.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var t;(t=super.release)===null||t===void 0||t.call(this),this.lastFilterRules=null,this.clearSortedMap(),this.clearCurrentIndexedData(),this.currentPagerIndexedData.length=0}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(t=>{t.asc&&(t.asc.length=0),t.desc&&(t.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(t){let e;return e=this.dataSourceObj.records?Array.isArray(t)?VC(this.records,t):this.records[t]:this._get(t),Ps(e,i=>{this.recordPromiseCallBack(t,i)})}getRawRecord(t){var e,i;if(!((e=this.beforeChangedRecordsMap)===null||e===void 0)&&e.has(t.toString()))return(i=this.beforeChangedRecordsMap)===null||i===void 0?void 0:i.get(t.toString());let r;return r=this.dataSourceObj.records?Array.isArray(t)?VC(this.records,t):this.records[t]:this._get(t),Ps(r,o=>{this.recordPromiseCallBack(t,o)})}getOriginalField(t,e,i,r,o){if(e!==null)return vp(this.getOriginalRecord(t),e,i,r,o,s=>{this.fieldPromiseCallBack(t,e,s)})}getRawFieldData(t,e,i,r,o){if(e!==null)return vp(this.getRawRecord(t),e,i,r,o,s=>{this.fieldPromiseCallBack(t,e,s)})}hasOriginalField(t,e){if(e===null)return!1;if(typeof e=="function")return!0;const i=this.getOriginalRecord(t);return!!(i&&e in i)}fieldPromiseCallBack(t,e,i){}recordPromiseCallBack(t,e){}canChangeOrder(t,e){var i;if(!((i=this.dataSourceObj)===null||i===void 0)&&i.canChangeOrder)return this.dataSourceObj.canChangeOrder(t,e);if(this.hasHierarchyStateExpand){let r=this.currentPagerIndexedData[t],o=this.currentPagerIndexedData[e];if(r=Array.isArray(r)?[...r]:[r],o=Array.isArray(o)?[...o]:[o],e>t&&o.length>r.length){let s=this.currentPagerIndexedData[e+1];s=Array.isArray(s)?[...s]:[s],s.length<o.length&&o.splice(o.length-1,1)}if(r.length===o.length){for(let s=0;s<=r.length-2;s++)if(r[s]!==o[s])return!1;return!0}return!1}return!0}changeOrder(t,e){var i,r,o;if(!((i=this.dataSourceObj)===null||i===void 0)&&i.changeOrder)this.dataSourceObj.changeOrder(t,e);else if(!(!((r=this.lastSortStates)===null||r===void 0)&&r.some(s=>s.order==="asc"||s.order==="desc"))&&this.canChangeOrder(t,e))if(this.hasHierarchyStateExpand){let s,a,l=this.currentPagerIndexedData[t],u=this.currentPagerIndexedData[e];if(l=Array.isArray(l)?[...l]:[l],u=Array.isArray(u)?[...u]:[u],l.length>1||u.length>1){if(e>t&&u.length>l.length){let h=this.currentPagerIndexedData[e+1];h=Array.isArray(h)?[...h]:[h],h.length<u.length&&u.splice(u.length-1,1)}if(s=l.splice(l.length-1,1)[0],a=u.splice(u.length-1,1)[0],l.length>=1){const h=this.getOriginalRecord(l);if(h){const d=h.filteredChildren?h.filteredChildren.splice(s,1):h.children.splice(s,1);d.unshift(a,0),Array.prototype.splice.apply((o=h.filteredChildren)!==null&&o!==void 0?o:h.children,d)}}else{const h=this.records.splice(s,1);h.unshift(a,0),Array.prototype.splice.apply(this.records,h)}}else{s=this.currentPagerIndexedData[t],a=this.currentPagerIndexedData[e];const h=this.records.splice(s,1);h.unshift(a,0),Array.prototype.splice.apply(this.records,h)}this.restoreTreeHierarchyState(),this.updatePagerData()}else{const s=this.records.splice(t,1);s.unshift(e,0),Array.prototype.splice.apply(this.records,s)}}restoreTreeHierarchyState(){var t,e;if(this.hierarchyExpandLevel){for(let r=0;r<this._sourceLength;r++){const o=this.getOriginalRecord(r);o&&((t=o.filteredChildren)!==null&&t!==void 0?t:o.children)&&!o.hierarchyState&&(o.hierarchyState=Yt.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(r,o)=>o);let i=this._sourceLength;for(let r=0;r<i;r++){const o=this.currentIndexedData[r],s=this.getOriginalRecord(o);if(!s)continue;const a=(e=s.filteredChildren)!==null&&e!==void 0?e:s.children;if((a==null?void 0:a.length)>0&&s.hierarchyState===Yt.expand){this.hasHierarchyStateExpand=!0;const l=this.restoreChildrenNodeHierarchy(o,s);r+=l,i+=l}else s.children===!0&&!s.hierarchyState&&(s.hierarchyState=Yt.collapse)}}}restoreChildrenNodeHierarchy(t,e){var i,r;let o=0;const s=(i=e.filteredChildren)!==null&&i!==void 0?i:e.children,a=(r=s==null?void 0:s.length)!==null&&r!==void 0?r:0;for(let l=0;l<a;l++){e.hierarchyState===Yt.expand&&(o+=1);const u=s[l],h=Array.isArray(t)?t.concat(l):[t,l];e.hierarchyState===Yt.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+o,0,h),o+=this.restoreChildrenNodeHierarchy(h,u)}return o}_setNodeStateRecursive(t,e){var i;if(!t)return;const r=(i=t.filteredChildren)!==null&&i!==void 0?i:t.children;if(r&&(Array.isArray(r)?r.length>0:r===!0)&&(t.hierarchyState=e),r&&Array.isArray(r))for(const o of r)this._setNodeStateRecursive(o,e)}expandAllNodes(){if(Array.isArray(this._source)){for(const t of this._source)this._setNodeStateRecursive(t,Yt.expand);this.hasHierarchyStateExpand=!0,this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}collapseAllNodes(){if(Array.isArray(this._source)){for(const t of this._source)this._setNodeStateRecursive(t,Yt.collapse);this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}}us.EMPTY=new us({get(){},length:0});function VC(n,t){var e;let i=n;for(let r=0;r<t.length;r++){const o=t[r];if(!i[o])return;i=i[o];const s=(e=i.filteredChildren)!==null&&e!==void 0?e:i==null?void 0:i.children;s&&r+1<t.length&&(i=s)}return i}function dR(n,t){return n.sort((e,i)=>{var r,o;wt(e)&&(e=[e]),wt(i)&&(i=[i]);const s=Math.max(e.length,i.length);for(let a=0;a<s;a++){const l=(r=e[a])!==null&&r!==void 0?r:-1,u=(o=i[a])!==null&&o!==void 0?o:-1;if(l!==u)return u-l}return 0})}var xv,cR;function Yw(){if(cR)return xv;cR=1;var n=Array.isArray;return xv=n,xv}var Tv,fR;function EZ(){if(fR)return Tv;fR=1;var n=typeof ks=="object"&&ks&&ks.Object===Object&&ks;return Tv=n,Tv}var Av,gR;function Kw(){if(gR)return Av;gR=1;var n=EZ(),t=typeof self=="object"&&self&&self.Object===Object&&self,e=n||t||Function("return this")();return Av=e,Av}var Rv,pR;function Zw(){if(pR)return Rv;pR=1;var n=Kw(),t=n.Symbol;return Rv=t,Rv}var Ev,mR;function MZ(){if(mR)return Ev;mR=1;var n=Zw(),t=Object.prototype,e=t.hasOwnProperty,i=t.toString,r=n?n.toStringTag:void 0;function o(s){var a=e.call(s,r),l=s[r];try{s[r]=void 0;var u=!0}catch{}var h=i.call(s);return u&&(a?s[r]=l:delete s[r]),h}return Ev=o,Ev}var Mv,vR;function BZ(){if(vR)return Mv;vR=1;var n=Object.prototype,t=n.toString;function e(i){return t.call(i)}return Mv=e,Mv}var Bv,bR;function JD(){if(bR)return Bv;bR=1;var n=Zw(),t=MZ(),e=BZ(),i="[object Null]",r="[object Undefined]",o=n?n.toStringTag:void 0;function s(a){return a==null?a===void 0?r:i:o&&o in Object(a)?t(a):e(a)}return Bv=s,Bv}var Pv,_R;function PZ(){if(_R)return Pv;_R=1;function n(t){return t!=null&&typeof t=="object"}return Pv=n,Pv}var kv,CR;function Qw(){if(CR)return kv;CR=1;var n=JD(),t=PZ(),e="[object Symbol]";function i(r){return typeof r=="symbol"||t(r)&&n(r)==e}return kv=i,kv}var Lv,yR;function kZ(){if(yR)return Lv;yR=1;var n=Yw(),t=Qw(),e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function r(o,s){if(n(o))return!1;var a=typeof o;return a=="number"||a=="symbol"||a=="boolean"||o==null||t(o)?!0:i.test(o)||!e.test(o)||s!=null&&o in Object(s)}return Lv=r,Lv}var Dv,wR;function tI(){if(wR)return Dv;wR=1;function n(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}return Dv=n,Dv}var Iv,SR;function LZ(){if(SR)return Iv;SR=1;var n=JD(),t=tI(),e="[object AsyncFunction]",i="[object Function]",r="[object GeneratorFunction]",o="[object Proxy]";function s(a){if(!t(a))return!1;var l=n(a);return l==i||l==r||l==e||l==o}return Iv=s,Iv}var Fv,xR;function DZ(){if(xR)return Fv;xR=1;var n=Kw(),t=n["__core-js_shared__"];return Fv=t,Fv}var Ov,TR;function IZ(){if(TR)return Ov;TR=1;var n=DZ(),t=function(){var i=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function e(i){return!!t&&t in i}return Ov=e,Ov}var Hv,AR;function FZ(){if(AR)return Hv;AR=1;var n=Function.prototype,t=n.toString;function e(i){if(i!=null){try{return t.call(i)}catch{}try{return i+""}catch{}}return""}return Hv=e,Hv}var zv,RR;function OZ(){if(RR)return zv;RR=1;var n=LZ(),t=IZ(),e=tI(),i=FZ(),r=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,s=Function.prototype,a=Object.prototype,l=s.toString,u=a.hasOwnProperty,h=RegExp("^"+l.call(u).replace(r,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(c){if(!e(c)||t(c))return!1;var f=n(c)?h:o;return f.test(i(c))}return zv=d,zv}var Nv,ER;function HZ(){if(ER)return Nv;ER=1;function n(t,e){return t==null?void 0:t[e]}return Nv=n,Nv}var Wv,MR;function eI(){if(MR)return Wv;MR=1;var n=OZ(),t=HZ();function e(i,r){var o=t(i,r);return n(o)?o:void 0}return Wv=e,Wv}var Uv,BR;function t0(){if(BR)return Uv;BR=1;var n=eI(),t=n(Object,"create");return Uv=t,Uv}var Vv,PR;function zZ(){if(PR)return Vv;PR=1;var n=t0();function t(){this.__data__=n?n(null):{},this.size=0}return Vv=t,Vv}var jv,kR;function NZ(){if(kR)return jv;kR=1;function n(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}return jv=n,jv}var Gv,LR;function WZ(){if(LR)return Gv;LR=1;var n=t0(),t="__lodash_hash_undefined__",e=Object.prototype,i=e.hasOwnProperty;function r(o){var s=this.__data__;if(n){var a=s[o];return a===t?void 0:a}return i.call(s,o)?s[o]:void 0}return Gv=r,Gv}var $v,DR;function UZ(){if(DR)return $v;DR=1;var n=t0(),t=Object.prototype,e=t.hasOwnProperty;function i(r){var o=this.__data__;return n?o[r]!==void 0:e.call(o,r)}return $v=i,$v}var qv,IR;function VZ(){if(IR)return qv;IR=1;var n=t0(),t="__lodash_hash_undefined__";function e(i,r){var o=this.__data__;return this.size+=this.has(i)?0:1,o[i]=n&&r===void 0?t:r,this}return qv=e,qv}var Xv,FR;function jZ(){if(FR)return Xv;FR=1;var n=zZ(),t=NZ(),e=WZ(),i=UZ(),r=VZ();function o(s){var a=-1,l=s==null?0:s.length;for(this.clear();++a<l;){var u=s[a];this.set(u[0],u[1])}}return o.prototype.clear=n,o.prototype.delete=t,o.prototype.get=e,o.prototype.has=i,o.prototype.set=r,Xv=o,Xv}var Yv,OR;function GZ(){if(OR)return Yv;OR=1;function n(){this.__data__=[],this.size=0}return Yv=n,Yv}var Kv,HR;function $Z(){if(HR)return Kv;HR=1;function n(t,e){return t===e||t!==t&&e!==e}return Kv=n,Kv}var Zv,zR;function e0(){if(zR)return Zv;zR=1;var n=$Z();function t(e,i){for(var r=e.length;r--;)if(n(e[r][0],i))return r;return-1}return Zv=t,Zv}var Qv,NR;function qZ(){if(NR)return Qv;NR=1;var n=e0(),t=Array.prototype,e=t.splice;function i(r){var o=this.__data__,s=n(o,r);if(s<0)return!1;var a=o.length-1;return s==a?o.pop():e.call(o,s,1),--this.size,!0}return Qv=i,Qv}var Jv,WR;function XZ(){if(WR)return Jv;WR=1;var n=e0();function t(e){var i=this.__data__,r=n(i,e);return r<0?void 0:i[r][1]}return Jv=t,Jv}var tb,UR;function YZ(){if(UR)return tb;UR=1;var n=e0();function t(e){return n(this.__data__,e)>-1}return tb=t,tb}var eb,VR;function KZ(){if(VR)return eb;VR=1;var n=e0();function t(e,i){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,i])):r[o][1]=i,this}return eb=t,eb}var ib,jR;function ZZ(){if(jR)return ib;jR=1;var n=GZ(),t=qZ(),e=XZ(),i=YZ(),r=KZ();function o(s){var a=-1,l=s==null?0:s.length;for(this.clear();++a<l;){var u=s[a];this.set(u[0],u[1])}}return o.prototype.clear=n,o.prototype.delete=t,o.prototype.get=e,o.prototype.has=i,o.prototype.set=r,ib=o,ib}var rb,GR;function QZ(){if(GR)return rb;GR=1;var n=eI(),t=Kw(),e=n(t,"Map");return rb=e,rb}var nb,$R;function JZ(){if($R)return nb;$R=1;var n=jZ(),t=ZZ(),e=QZ();function i(){this.size=0,this.__data__={hash:new n,map:new(e||t),string:new n}}return nb=i,nb}var ob,qR;function tQ(){if(qR)return ob;qR=1;function n(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}return ob=n,ob}var sb,XR;function i0(){if(XR)return sb;XR=1;var n=tQ();function t(e,i){var r=e.__data__;return n(i)?r[typeof i=="string"?"string":"hash"]:r.map}return sb=t,sb}var ab,YR;function eQ(){if(YR)return ab;YR=1;var n=i0();function t(e){var i=n(this,e).delete(e);return this.size-=i?1:0,i}return ab=t,ab}var lb,KR;function iQ(){if(KR)return lb;KR=1;var n=i0();function t(e){return n(this,e).get(e)}return lb=t,lb}var ub,ZR;function rQ(){if(ZR)return ub;ZR=1;var n=i0();function t(e){return n(this,e).has(e)}return ub=t,ub}var hb,QR;function nQ(){if(QR)return hb;QR=1;var n=i0();function t(e,i){var r=n(this,e),o=r.size;return r.set(e,i),this.size+=r.size==o?0:1,this}return hb=t,hb}var db,JR;function oQ(){if(JR)return db;JR=1;var n=JZ(),t=eQ(),e=iQ(),i=rQ(),r=nQ();function o(s){var a=-1,l=s==null?0:s.length;for(this.clear();++a<l;){var u=s[a];this.set(u[0],u[1])}}return o.prototype.clear=n,o.prototype.delete=t,o.prototype.get=e,o.prototype.has=i,o.prototype.set=r,db=o,db}var cb,tE;function sQ(){if(tE)return cb;tE=1;var n=oQ(),t="Expected a function";function e(i,r){if(typeof i!="function"||r!=null&&typeof r!="function")throw new TypeError(t);var o=function(){var s=arguments,a=r?r.apply(this,s):s[0],l=o.cache;if(l.has(a))return l.get(a);var u=i.apply(this,s);return o.cache=l.set(a,u)||l,u};return o.cache=new(e.Cache||n),o}return e.Cache=n,cb=e,cb}var fb,eE;function aQ(){if(eE)return fb;eE=1;var n=sQ(),t=500;function e(i){var r=n(i,function(s){return o.size===t&&o.clear(),s}),o=r.cache;return r}return fb=e,fb}var gb,iE;function lQ(){if(iE)return gb;iE=1;var n=aQ(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e=/\\(\\)?/g,i=n(function(r){var o=[];return r.charCodeAt(0)===46&&o.push(""),r.replace(t,function(s,a,l,u){o.push(l?u.replace(e,"$1"):a||s)}),o});return gb=i,gb}var pb,rE;function uQ(){if(rE)return pb;rE=1;function n(t,e){for(var i=-1,r=t==null?0:t.length,o=Array(r);++i<r;)o[i]=e(t[i],i,t);return o}return pb=n,pb}var mb,nE;function hQ(){if(nE)return mb;nE=1;var n=Zw(),t=uQ(),e=Yw(),i=Qw(),r=n?n.prototype:void 0,o=r?r.toString:void 0;function s(a){if(typeof a=="string")return a;if(e(a))return t(a,s)+"";if(i(a))return o?o.call(a):"";var l=a+"";return l=="0"&&1/a==-1/0?"-0":l}return mb=s,mb}var vb,oE;function dQ(){if(oE)return vb;oE=1;var n=hQ();function t(e){return e==null?"":n(e)}return vb=t,vb}var bb,sE;function cQ(){if(sE)return bb;sE=1;var n=Yw(),t=kZ(),e=lQ(),i=dQ();function r(o,s){return n(o)?o:t(o,s)?[o]:e(i(o))}return bb=r,bb}var _b,aE;function fQ(){if(aE)return _b;aE=1;var n=Qw();function t(e){if(typeof e=="string"||n(e))return e;var i=e+"";return i=="0"&&1/e==-1/0?"-0":i}return _b=t,_b}var Cb,lE;function gQ(){if(lE)return Cb;lE=1;var n=cQ(),t=fQ();function e(i,r){r=n(r,i);for(var o=0,s=r.length;i!=null&&o<s;)i=i[t(r[o++])];return o&&o==s?i:void 0}return Cb=e,Cb}var yb,uE;function pQ(){if(uE)return yb;uE=1;var n=gQ();function t(e,i,r){var o=e==null?void 0:n(e,i);return o===void 0?r:o}return yb=t,yb}var mQ=pQ();const vQ=no(mQ);function bQ(n,t,e,i){(n[t]||(n[t]=new Map)).set(e,i)}class r0 extends us{static get EVENT_TYPE(){return us.EVENT_TYPE}static ofArray(t,e,i,r,o,s){return new r0({get:a=>t[a],length:t.length,records:t},e,i,r,o,s)}constructor(t,e,i,r,o,s){let a;Wt(e==null?void 0:e.groupByRules)&&(o="tree",a=!0),super(t,e,i,r,o,s),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(t){return wt(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:super.getOriginalRecord(t)}getRawRecord(t){var e,i,r,o;let s,a;if(this._isGrouped){if(s=this.getOriginRecordIndexForGroup(t),et(s)&&((e=this.beforeChangedRecordsMap)===null||e===void 0?void 0:e.has(s.toString())))return(i=this.beforeChangedRecordsMap)===null||i===void 0?void 0:i.get(s.toString())}else if(!((r=this.beforeChangedRecordsMap)===null||r===void 0)&&r.has(t.toString()))return(o=this.beforeChangedRecordsMap)===null||o===void 0?void 0:o.get(t.toString());return wt(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:(a=this.dataSourceObj.records?Array.isArray(t)?VC(this.records,t):this.records[t]:this._get(t),Ps(a,l=>{this.recordPromiseCallBack(t,l)}))}getOriginalField(t,e,i,r,o){const s=this._fieldCache&&this._fieldCache[t];if(s){const a=s.get(e);if(a)return a}return super.getOriginalField(t,e,i,r,o)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(t,e,i){bQ(this._fieldCache,t,e,i)}recordPromiseCallBack(t,e){this._recordCache&&(this._recordCache[t]=e)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var t;(t=super.release)===null||t===void 0||t.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var t;if(super._generateFieldAggragations(),Wt((t=this.dataConfig)===null||t===void 0?void 0:t.groupByRules)){const e=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[ai.CUSTOM]({field:"",aggregationFun:(i,r,o)=>{const s=new Map,a=[];for(let l=0;l<r.length;l++)jC(r[l],a,s,e,0);return a}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(t){var e;const i=super.processRecords(t);return((e=this.groupAggregator)===null||e===void 0?void 0:e.value())||i}getGroupLength(){var t,e,i;return(i=(e=(t=this.dataConfig)===null||t===void 0?void 0:t.groupByRules)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0}updateGroup(){var t,e,i;this.clearCache();const r=this.source;this._source=this.processRecords((e=(t=this.dataSourceObj)===null||t===void 0?void 0:t.records)!==null&&e!==void 0?e:this.dataSourceObj),r&&iI(r,this.source),this.sourceLength=((i=this.source)===null||i===void 0?void 0:i.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(o,s)=>s),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(t){const e=this.getOriginalRecord(t);if(et(e)&&!(e.children&&e.children.length>0)){for(let i=0;i<this.dataSourceObj.records.length;i++)if(this.dataSourceObj.records[i]===e)return i}}addRecordsForGroup(t,e){if(!Wt(t)||t.length===0)return;let i=this.getOriginRecordIndexForGroup(e);(i===void 0||i>this.dataSourceObj.records)&&(i=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(i,0,...t),this.adjustBeforeChangedRecordsMap(i,t.length),this.updateGroup()}deleteRecordsForGroup(t){if(!Wt(t)||t.length===0)return;const e=dR(t);for(let i=0;i<e.length;i++){const r=e[i];if(wt(r)&&(r>=this.sourceLength||r<0))continue;const o=this.getOriginRecordIndexForGroup(r);this.beforeChangedRecordsMap.delete(o.toString()),this.dataSourceObj.records.splice(o,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(o,1,"delete")}this.updateGroup()}updateRecordsForGroup(t,e){for(let i=0;i<e.length;i++){const r=e[i];if(wt(r)&&(r>=this.sourceLength||r<0))continue;const o=this.getOriginRecordIndexForGroup(r);this.beforeChangedRecordsMap.delete(o.toString()),this.dataSourceObj.records[o]=t[i]}this.updateGroup()}addRecordsForTree(t,e){if(Wt(t)&&t.length!==0){if(this.adjustBeforeChangedRecordsMap(e,t.length),wt(e))this.dataSourceObj.records.splice(e,0,...t);else{const i=[...e],r=i.pop(),o=this.getOriginalRecord(i);o.children?o.children.splice(r,0,...t):o.children=t}this.initTreeHierarchyState(),this.updatePagerData()}}deleteRecordsForTree(t){if(!Wt(t)||t.length===0)return;const e=dR(t);for(let i=0;i<e.length;i++){const r=e[i];if(!wt(r)||!(r>=this.sourceLength||r<0)){if(this.beforeChangedRecordsMap.delete(r.toString()),wt(r))this.dataSourceObj.records.splice(r,1);else{const o=[...r],s=o.pop();this.getOriginalRecord(o).children.splice(s,1)}this.adjustBeforeChangedRecordsMap(r,1,"delete")}}this.initTreeHierarchyState(),this.updatePagerData()}updateRecordsForTree(t,e){for(let i=0;i<e.length;i++){const r=e[i],o=t[i];if(!wt(r)||!(r>=this.sourceLength||r<0))if(this.beforeChangedRecordsMap.delete(r.toString()),wt(r))this.dataSourceObj.records.splice(r,1,o);else{const s=[...r],a=s.pop();this.getOriginalRecord(s).children.splice(a,1,o)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(t,e,i="add"){if(this.rowHierarchyType==="tree"){let r;r=wt(t)?[t]:t;const o=[];this.beforeChangedRecordsMap.forEach((s,a)=>{var l,u;const h=a.split(","),d=Math.max(h.length,r.length);for(let c=0;c<d;c++){const f=(l=r[c])!==null&&l!==void 0?l:-1,g=(u=Number(h[c]))!==null&&u!==void 0?u:-1;if(f<g||f===g&&c===h.length-1&&c===r.length-1)return h[c]=(g+(i==="add"?e:-e)).toString(),void o.push({originKey:a,targetKey:h.toString(),value:s})}}),o.forEach(({originKey:s,targetKey:a,value:l})=>{this.beforeChangedRecordsMap.delete(s),this.beforeChangedRecordsMap.set(a,l)})}else super.adjustBeforeChangedRecordsMap(t,e,i)}cacheBeforeChangedRecord(t,e){var i;const r=this.getOriginalRecord(t);e.options.groupBy&&(t=this.getOriginRecordIndexForGroup(t)),this.beforeChangedRecordsMap.has(t.toString())||this.beforeChangedRecordsMap.set(t.toString(),(i=al(r,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))!==null&&i!==void 0?i:{})}getGroupSeriesNumber(t){const e=this.dataSource.currentIndexedData[t],i=e.length-1;let r=e.length,o=1;for(;r>i;o++){const s=this.dataSource.currentIndexedData[t-o];r=wt(s)?1:s.length}return o-1}}function jC(n,t,e,i,r){const o=i[r];if(!et(o))return void t.push(n);const s=vQ(n,o);if(s!==void 0){if(e.has(s)){const a=e.get(s);return jC(n,t[a].children,t[a].map,i,r+1)}return e.set(s,t.length),t.push({vtableMerge:!0,vtableMergeName:s,children:[],map:new Map}),jC(n,t[t.length-1].children,t[t.length-1].map,i,r+1)}}function iI(n,t,e,i){if(!e){e=new Map;for(let r=0;r<n.length;r++){const o=n[r];o.vtableMerge&&e.set(o.vtableMergeName,r)}}if(!i){i=new Map;for(let r=0;r<t.length;r++){const o=t[r];o.vtableMerge&&i.set(o.vtableMergeName,r)}}for(let r=0;r<n.length;r++){const o=n[r],s=t[i.get(o.vtableMergeName)];et(s)&&(s.hierarchyState=n[r].hierarchyState),Wt(o.children)&&Wt(s.children)&&o.map.size!==0&&s.map.size!==0&&iI(o.children,s.children,o.map,s.map)}}var df={exports:{}},hE;function _Q(){if(hE)return df.exports;hE=1;var n={},t=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),e=["style","variant","weight","size","lineHeight","family"],i=/([\.0-9]+)(.*)/,r=function(l,u,h){var d=l.match(i);if(d){l=parseFloat(d[1]);var c=d[2].toLowerCase().trim(),f=Math.round(l);switch(f===l&&(l=f),c){case"em":return u===null?void 0:l*u;case"px":return l;case"pt":return l/(72/h);case"pc":return l/(6/h);case"mm":return l*(h/25.4);case"cm":return l*(h/2.54);case"in":return l*h;case"%":return u===null?void 0:u*(l/100)}}},o={size:r,lineHeight:r},s={serif:1,"sans-serif":1,cursive:1,fantasy:1,monospace:1},a=df.exports=function(l,u,h){var d=l+"-"+(u||"null")+"@"+h;if(h=h||96,typeof n[d]<"u")return n[d];if(u&&(u=a(u,null,h)),l==="inherit")return u;var c=t.exec(l);if(!c){n[d]=null;return}c.shift();for(var f={},g=0;g<c.length;g++){var m=e[g],p=c[g];if(o[m]&&p){var v=u&&u[m]||null,b=o[m](p,v,h);typeof b>"u"&&m==="lineHeight"&&p?p=f.size*parseFloat(p):p=b}if(!(!p||p==="normal")){if(p==="inherit"){if(!u)return;p=u[m]}p.trim&&(p=p.trim()),f[m]=p}}Object.keys(f).length||(f=null),n[d]=f;var C=[];f.style&&C.push(f.style),f.variant&&C.push(f.variant),f.weight&&f.weight!=="400"&&f.weight!=="normal"&&C.push(f.weight),C.push(f.size+"px"),f.lineHeight&&(C[C.length-1]+="/"+f.lineHeight+"px");var y=f.family.split(",");return f.family=y.map(function(w){return w=w.trim(),s[w.toLowerCase()]&&(w=w.toLowerCase()),w}),C.push(f.family),Object.defineProperty(f,"toString",{value:function(){return C.map(function(w){return Array.isArray(w)?w.map(function(_){return _.indexOf(" ")>-1?'"'+_.replace(/["']/g,"")+'"':_}).join(", "):w}).join(" ")}}),f};return df.exports.generics=s,df.exports}var CQ=_Q();const yQ=no(CQ);function wQ(n){return yQ(n)}function me(n){var t,e,i,r;if(wt(n)||ei(n)||Wt(n)){let o=gg(n);return typeof o=="number"||typeof o=="string"?o=[o,o,o,o]:Array.isArray(o)&&(o=o.slice(0)),o}return n&&(isFinite(n.bottom)||isFinite(n.left)||isFinite(n.right)||isFinite(n.top))?[(t=n.top)!==null&&t!==void 0?t:0,(e=n.right)!==null&&e!==void 0?e:0,(i=n.bottom)!==null&&i!==void 0?i:0,(r=n.left)!==null&&r!==void 0?r:0]:[0,0,0,0]}const Df=0,rI=1,bp=2,nI=3,oI=10,sI=11,aI=12,SQ=9,xQ=13,TQ=10,AQ=12,RQ=32,EQ=37,MQ=46,BQ=48,PQ=57,kQ=65,LQ=90,DQ=97,IQ=122;function FQ(n){return n>=kQ&&n<=LQ}function OQ(n){return n>=DQ&&n<=IQ}function HQ(n){return OQ(n)||FQ(n)}function zQ(n){return n===SQ||n===TQ||n===AQ||n===xQ||n===RQ}function wb(n){return n>=BQ&&n<=PQ}function dE(n){return n===MQ}function cE(n){return HQ(n)||n===EQ}function $h(n){return new Error(`calc parse error: ${n}`)}function NQ(n){const t=n.replace(/calc\(/g,"(").trim(),e=[],i=t.length;for(let a=0;a<i;a++){const l=t[a],u=l.charCodeAt(0);if(l==="("||l===")")e.push({value:l,type:Df});else if(l==="*"||l==="/")e.push({value:l,type:bp});else if(l==="+"||l==="-")a=r(l,a+1)-1;else if(wb(u)||dE(u))a=o(l,a+1)-1;else if(!zQ(u))throw $h(n)}function r(a,l){if(l<i){const u=t[l],h=u.charCodeAt(0);if(wb(h)||dE(h))return o(a+u,l+1)}return e.push({value:a,type:bp}),l}function o(a,l){let u=l;for(;u<i;u++){const h=t[u],d=h.charCodeAt(0);if(wb(d))a+=h;else{if(h!=="."){if(cE(d))return s(a,h,u+1);break}if(a.indexOf(".")>=0)throw $h(n);a+=h}}if(a===".")throw $h(n);return e.push({value:parseFloat(a),type:nI}),u}function s(a,l,u){let h=u;for(;h<i;h++){const d=t[h];if(!cE(d.charCodeAt(0)))break;l+=d}return e.push({value:parseFloat(a),unit:l,type:rI}),h}return e}const fE={"*":3,"/":3,"+":2,"-":2};function lI(n,t){function e(r){const o=r.pop(),s=r.pop(),a=r.pop();if(!(a&&a.nodeType&&s&&s.type===bp&&o&&o.nodeType))throw $h(t);return{nodeType:sI,left:a,op:s,right:o}}const i=[];for(;n.length;){const r=n.shift();if(r.type===Df&&r.value==="("){let o=0;const s=UD.findIndex(n,a=>{if(a.type===Df&&a.value==="(")o++;else if(a.type===Df&&a.value===")"){if(!o)return!0;o--}return!1});if(s===-1)throw $h(t);i.push(lI(n.splice(0,s),t)),n.shift()}else if(r.type===bp){if(i.length>=3){const o=i[i.length-2].value;fE[r.value]<=fE[o]&&i.push(e(i))}i.push(r)}else if(r.type===rI){const{value:o,unit:s}=r;i.push({nodeType:oI,value:o,unit:s})}else r.type===nI&&i.push({nodeType:aI,value:r.value})}for(;i.length>1;)i.push(e(i));return i[0]}function WQ(n){return lI(NQ(n),n)}function GC(n,t){if(n.nodeType===sI){const e=GC(n.left,t),i=GC(n.right,t);switch(n.op.value){case"+":return e+i;case"-":return e-i;case"*":return e*i;case"/":return e/i;default:throw new Error(`calc error. unknown operator: ${n.op.value}`)}}else if(n.nodeType===oI)switch(n.unit){case"%":return n.value*t.full/100;case"px":return n.value;default:throw new Error(`calc error. unknown unit: ${n.unit}`)}else if(n.nodeType===aI)return n.value;throw new Error("calc error.")}function UQ(n,t){return GC(WQ(n),t)}function VQ(n,t){return typeof n=="string"?UQ(n.trim(),t):n-0}function jQ(n){return!xe(n)&&(!!wt(n)||+n==+n)}function Sb(n){return!!ei(n)&&!!n.endsWith("%")&&jQ(n.substring(0,n.length-1))}function GQ(n,t="vtable"){var e,i;const r=document.createElement("div");r.setAttribute("tabindex","0"),r.classList.add(t),r.style.outline="none",r.style.margin=`${n.top}px ${n.right}px ${n.bottom}px ${n.left}px`;const o=(r.offsetWidth||((e=r.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,s=(r.offsetHeight||((i=r.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;return r.style.width=o&&o-n.left-n.right+"px"||"0px",r.style.height=s&&s-n.top-n.bottom+"px"||"0px",r}function $Q(n,t){var e,i;n.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;const r=(n.offsetWidth||((e=n.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,o=(n.offsetHeight||((i=n.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;n.style.width=r&&r-t.left-t.right+"px"||"0px",n.style.height=o&&o-t.top-t.bottom+"px"||"0px"}function uI(n,t){const{dataSourceEventIds:e}=n.internalProps;e&&e.forEach(i=>n.internalProps.handler.off(i)),t(n),n.internalProps.dataSourceEventIds=[n.internalProps.handler.on(n.internalProps.dataSource,us.EVENT_TYPE.CHANGE_ORDER,()=>{n.dataSource.hierarchyExpandLevel&&n.refreshRowColCount(),n.render()})]}function gE(n,t=[]){uI(n,()=>{n.internalProps.records=t;const e=n.internalProps.dataSource=r0.ofArray(t,n.internalProps.dataConfig,n.pagination,n.internalProps.columns,n.internalProps.layoutMap.rowHierarchyType,hI(n));n.addReleaseObj(e)})}function hI(n){var t;return n.options.hierarchyExpandLevel?n.options.hierarchyExpandLevel:n.options.groupBy?1/0:!((t=n._hasHierarchyTreeHeader)===null||t===void 0)&&t.call(n)?1:void 0}function qQ(n,t){uI(n,()=>{n.internalProps.dataSource&&n.internalProps.releaseList.forEach(e=>{e instanceof us&&(e.release(),n.internalProps.releaseList.splice(n.internalProps.releaseList.indexOf(e),1))}),t?t instanceof us?(n.internalProps.dataSource=t,n.internalProps.dataSource.supplementConfig(n.pagination,n.options.columns,n.internalProps.layoutMap.rowHierarchyType,hI(n))):n.internalProps.dataSource=new r0(t):n.internalProps.dataSource=us.EMPTY,n.addReleaseObj(n.internalProps.dataSource),n.internalProps.records=null})}function XQ(n,t){if(!n.internalProps.frozenRowCount)return null;let{scrollTop:e}=n;const i=n.internalProps.frozenRowCount;for(let r=0;r<i;r++){const o=n.getRowHeight(r),s=e+o;if(s>t)return{top:e,row:r,bottom:s,height:o};e=s}return null}function YQ(n,t){if(!n.internalProps.frozenColCount)return null;let{scrollLeft:e}=n;const i=n.internalProps.frozenColCount;for(let r=0;r<i;r++){const o=n.getColWidth(r),s=e+o;if(s>t)return{left:e,col:r,right:s,width:o};e=s}return null}function wl(n,t){return Math.round(VQ(t,n.internalProps.calcWidthContext))}function KQ(n,t){return n?n.min&&n.min>t?n.min:n.max&&n.max<t?n.max:t:t}function ZQ(n){let t=0,e=0;n.frozenColCount>0&&(t=n.getFrozenColsWidth()),n.rightFrozenColCount>0&&(e=n.getRightFrozenColsWidth());let i=0,r=0;return n.frozenRowCount>0&&(i=n.getFrozenRowsHeight()),n.bottomFrozenRowCount>0&&(r=n.getBottomFrozenRowsHeight()),new yo(n.scrollLeft+t,n.scrollTop+i,n.tableNoFrameWidth-t-e,n.tableNoFrameHeight-i-r)}function Qs(n,t,e,i,r,o=!0){const s=me(r("padding",n,e,i,t)),a=r("bgColor",n,e,i,t),l=r("font",n,e,i,t);let u,h,d,c,f;if(l){const{family:H,size:O,weight:N,style:U,variant:W}=wQ(l);u=H.join(" "),h=O,d=N,c=U,c=W}else u=r("fontFamily",n,e,i,t),h=r("fontSize",n,e,i,t),d=r("fontWeight",n,e,i,t),c=r("fontStyle",n,e,i,t),f=r("fontVariant",n,e,i,t);const g=r("textAlign",n,e,i,t),m=r("textBaseline",n,e,i,t),p=r("color",n,e,i,t),v=r("strokeColor",n,e,i,t),b=r("lineHeight",n,e,i,t),C=r("underline",n,e,i,t),y=r("underlineDash",n,e,i,t),w=r("underlineOffset",n,e,i,t),_=r("lineThrough",n,e,i,t),A=Math.max(1,Math.floor(h/10)),T=r("textOverflow",n,e,i,t),S=r("borderColor",n,e,i,t),x=r("borderLineWidth",n,e,i,t),E=r("borderLineDash",n,e,i,t),M=r("marked",n,e,i,t),L=r("cursor",n,e,i,t),I=!(s&&a&&l&&g&&m&&p&&T&&S&&x&&E&&typeof C=="boolean"&&typeof _=="boolean"&&typeof M=="boolean");if(!o)return{hasFunctionPros:I};const D={text:{fontFamily:u,fontSize:h,fontWeight:d,fontStyle:c,fontVariant:f,fill:p,stroke:v!=null&&v,textAlign:g,textBaseline:m,lineHeight:b??h,underline:C?A:void 0,underlineDash:y,underlineOffset:w,lineThrough:_?A:void 0,ellipsis:T==="clip"?"":T==="ellipsis"?"...":et(T)?T:void 0},group:{fill:a,lineDash:E,lineWidth:x,stroke:S,cursor:L==="auto"||L==="default"?void 0:L},_vtable:{padding:s,marked:M}};if(Array.isArray(x)&&(D.group.strokeArrayWidth=me(x)),Array.isArray(S)){const H=me(S);D.group.stroke=!H.every(O=>!O)&&H,D.group.strokeArrayColor=me(S)}return{theme:D,hasFunctionPros:I}}function n0(n,t,e){const i=e.theme.frameStyle.cornerRadius;if(e.theme.cellInnerBorder){if(Array.isArray(i)){const r=[0,0,0,0];return n===0&&t===0&&(r[0]=i[0]),n===e.colCount-1&&t===0&&(r[1]=i[1]),n===0&&t===e.rowCount-1&&(r[3]=i[3]),n===e.colCount-1&&t===e.rowCount-1&&(r[2]=i[2]),r}if(i){const r=[0,0,0,0];return n===0&&t===0&&(r[0]=i),n===e.colCount-1&&t===0&&(r[1]=i),n===0&&t===e.rowCount-1&&(r[3]=i),n===e.colCount-1&&t===e.rowCount-1&&(r[2]=i),r}}return 0}function cf(n){for(let t=0;t<n.internalProps.columns.length;t++){const e=n.internalProps.columns[t];if(!e.aggregation){if(n.options.aggregation){let i;if(i=typeof n.options.aggregation=="function"?n.options.aggregation({col:t,field:e.field}):n.options.aggregation,i)if(Array.isArray(i)){const r=[];i.forEach(o=>{r.push(Object.assign({showOnTop:!1},o))}),e.aggregation=r}else e.aggregation=Object.assign({showOnTop:!1},i)}}}}function pE(n){for(let t=0;t<n.length;t++)if(n[t].aggregation)return!0;return!1}function QQ(n){if(n.options.widthMode==="autoWidth"||n.options.defaultHeaderColWidth==="auto"||Array.isArray(n.options.defaultHeaderColWidth)&&n.options.defaultHeaderColWidth.includes("auto"))return!0;const t=n.internalProps.layoutMap.columnObjects;for(let e=0;e<t.length;e++)if(t[e].width==="auto")return!0;return!1}let Mh,Bh,$C,qC,ba,_a,XC,dI,cI,fI,gI,Ca,ya,pI,mI,YC,KC,vI,bI,ZC,QC,wa,Sa,JC;function ff(n){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T;Mh=(t=n==null?void 0:n.sort_color)!==null&&t!==void 0?t:"#282F38",Bh=(e=n==null?void 0:n.sort_color_opacity)!==null&&e!==void 0?e:"0.35",$C=(i=n==null?void 0:n.sort_color_2)!==null&&i!==void 0?i:"#416EFF",qC=(r=n==null?void 0:n.sort_color_opacity_2)!==null&&r!==void 0?r:"1",ba=(o=n==null?void 0:n.sort_size)!==null&&o!==void 0?o:16,_a=(s=n==null?void 0:n.sort_size_2)!==null&&s!==void 0?s:22,XC=(a=n==null?void 0:n.frozen_color)!==null&&a!==void 0?a:"#282F38",dI=(l=n==null?void 0:n.frozen_color_opacity)!==null&&l!==void 0?l:"0.35",cI=(u=n==null?void 0:n.frozen_color_opacity)!==null&&u!==void 0?u:"0.2",fI=(h=n==null?void 0:n.frozen_color_2)!==null&&h!==void 0?h:"#416EFF",gI=(d=n==null?void 0:n.frozen_color_opacity_2)!==null&&d!==void 0?d:"1",Ca=(c=n==null?void 0:n.frozen_size)!==null&&c!==void 0?c:22,ya=(f=n==null?void 0:n.frozen_size_2)!==null&&f!==void 0?f:22,pI=(g=n==null?void 0:n.collapse_color)!==null&&g!==void 0?g:"#141414",mI=(m=n==null?void 0:n.collapse_color_opacity)!==null&&m!==void 0?m:"0.65",YC=(p=n==null?void 0:n.collapse_size)!==null&&p!==void 0?p:16,KC=(v=n==null?void 0:n.frozen_size_2)!==null&&v!==void 0?v:22,vI=(b=n==null?void 0:n.expand_color)!==null&&b!==void 0?b:"#141414",bI=(C=n==null?void 0:n.expand_color_opacity)!==null&&C!==void 0?C:"0.65",ZC=(y=n==null?void 0:n.expand_size)!==null&&y!==void 0?y:16,QC=(w=n==null?void 0:n.expand_size_2)!==null&&w!==void 0?w:22,wa=(_=n==null?void 0:n.dragReorder_color)!==null&&_!==void 0?_:"#666666",Sa=(A=n==null?void 0:n.dragReorder_color_opacity)!==null&&A!==void 0?A:"1",JC=(T=n==null?void 0:n.dragReorder_size)!==null&&T!==void 0?T:20}const JQ={get sort_downward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${$C}"  fill-opacity="${qC}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${Mh}" fill-opacity="${Bh}"/></svg> `,width:ba,height:ba,funcType:Pe.sort,name:"sort_downward",positionType:Be.contentRight,marginLeft:3,hover:{width:_a,height:_a,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_upward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${Mh}"  fill-opacity="${Bh}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${$C}"  fill-opacity="${qC}"/> </svg>`,width:ba,height:ba,funcType:Pe.sort,positionType:Be.contentRight,name:"sort_upward",marginLeft:3,hover:{width:_a,height:_a,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_normal(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${Mh}" fill-opacity="${Bh}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${Mh}" fill-opacity="${Bh}"/></svg> `,width:ba,height:ba,funcType:Pe.sort,positionType:Be.contentRight,name:"sort_normal",marginLeft:3,hover:{width:_a,height:_a,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get freeze(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z" fill="${XC}" fill-opacity="${cI}"/></g><defs><clipPath id="clip0"><rect width="22" height="22" fill="white"/></clipPath></defs></svg>`,width:Ca,height:Ca,name:"freeze",funcType:Pe.frozen,positionType:Be.right,marginRight:0,hover:{width:ya,height:ya,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozen(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z" fill="${XC}" fill-opacity="${dI}"/></svg>`,width:Ca,height:Ca,name:"frozen",funcType:Pe.frozen,positionType:Be.right,marginRight:0,hover:{width:ya,height:ya,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozenCurrent(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"  fill="${fI}" fill-opacity="${gI}"/></svg>`,width:Ca,height:Ca,funcType:Pe.frozen,positionType:Be.right,name:"frozenCurrent",marginRight:0,hover:{width:ya,height:ya,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get dropdownIcon(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="white"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#959DA5"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="#4F5965"/></svg>',width:24,height:24,funcType:Pe.dropDown,positionType:Be.absoluteRight,name:"dropdownIcon",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)",image:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="#1E54C9"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#141414" stroke-opacity="0.2"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="white"/></svg>'},cursor:"pointer",visibleTime:"mouseenter_cell"}},get play(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01" /><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /></svg>',width:24,height:24,funcType:Pe.play,positionType:Be.right,name:"play",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get damage_pic(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',width:24,height:24,funcType:Pe.damagePic,positionType:Be.left,name:"damage_pic",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get loading_pic(){return{type:"svg",svg:'<svg viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="50" y="65" width="301" height="170"><path d="M350.3 65H50v169.8h300.3V65Z" fill="#fff"/></mask><g mask="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M58.3 233.2h32.8v-36.8H58.3v36.8Z" fill="#C7DEFF"/><path d="M91.1 224.5v8.8H58.3M82.4 196.2H58.3" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z" fill="#00E4E5"/><path fill-rule="evenodd" clip-rule="evenodd" d="M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z" fill="#00E4E5"/><path d="M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z" fill="#C7DEFF"/><path d="m337 74.2-30.6 129.2h-5.9" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path d="M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M148.3 138.1h97V119h-97v19.1Z" fill="#00E4E5"/><path d="M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z" fill="#C7DEFF"/><path d="M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3" stroke="#071F4D"/><path d="M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5" stroke="#071F4D"/><path d="M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1" stroke="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z" fill="#C7DEFF"/><path d="M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6" stroke="#071F4D"/><path d="M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z" fill="#fff"/><path d="M273.2 195.9h16.9M261.2 195.9h5" stroke="#fff"/><path d="M62.4 201.9v2.9M62.4 224.5v2.9" stroke="#071F4D"/><path d="m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1" stroke="#fff"/><path d="M148.3 138.1h121.6V119H148.3v19.1Z" stroke="#071F4D"/></g></svg>',width:400,height:300,name:"loading_pic",positionType:Be.left}},get expand(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z" fill="${vI}" fill-opacity="${bI}"/>
      </svg>`,width:ZC,height:ZC,funcType:Pe.expand,name:"expand",positionType:Be.contentLeft,marginLeft:0,marginRight:4,hover:{width:QC,height:QC,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get collapse(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z"  fill="${pI}" fill-opacity="${mI}"/>
      </svg>`,width:YC,height:YC,funcType:Pe.collapse,name:"collapse",positionType:Be.contentLeft,marginLeft:0,marginRight:4,hover:{width:KC,height:KC,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get drillDown(){return{name:"drillDown",type:"svg",positionType:Be.absolute,funcType:Pe.drillDown,svg:vZ,width:13,height:13,cursor:"pointer"}},get drillUp(){return{name:"drillUp",type:"svg",positionType:Be.absolute,funcType:Pe.drillUp,svg:bZ,width:13,height:13,cursor:"pointer"}},get dragReorder(){return{type:"svg",svg:`<svg t="1710129136961" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5166" width="200" height="200"><path d="M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${wa}"  fill-opacity="${Sa}" p-id="5167"></path><path d="M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${wa}"  fill-opacity="${Sa}" p-id="5168"></path><path d="M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${wa}"  fill-opacity="${Sa}" p-id="5169"></path><path d="M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${wa}"  fill-opacity="${Sa}" p-id="5170"></path><path d="M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${wa}"  fill-opacity="${Sa}" p-id="5171"></path><path d="M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${wa}"  fill-opacity="${Sa}" p-id="5172"></path></svg>`,width:JC,height:JC,funcType:Pe.dragReorder,positionType:Be.left,name:"dragReorder",marginLeft:-10,marginRight:10,cursor:"grab"}}},tJ={};function Fn(){return Jd(JQ,tJ)}class tl extends Za{constructor(t){super(t),this.failCallback=()=>{const e=Fn(),{svg:i,src:r}=e.damage_pic||{},o=i||r;o&&(super.image=o)},this.attribute.visibleTime!=="mouseenter_cell"&&this.attribute.visibleTime!=="click_cell"||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,Oe.GetFile(this.attribute.gif+`?role=gif&radom=${Math.random()}`,"arrayBuffer").then(t=>{const e=p2.parseGIF(t),i=p2.decompressFrames(e,!0);this.renderGIF(i),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(t=>{})}get backgroundWidth(){var t,e;return(e=(t=this.attribute.backgroundWidth)!==null&&t!==void 0?t:this.attribute.width)!==null&&e!==void 0?e:0}get backgroundHeight(){var t,e;return(e=(t=this.attribute.backgroundHeight)!==null&&t!==void 0?t:this.attribute.height)!==null&&e!==void 0?e:0}renderGIF(t){this.loadedFrames=t,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=t[0].dims.width,this.gifCanvas.height=t[0].dims.height,this.playing=!0,this.lastTime=new Date().getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(t,e,i){const r=this.loadedFrames[this.frameIndex||0];r.disposalType===2&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(r),this.manipulate(t,e,i);const o=new Date().getTime()-this.lastTime;r.delay<o&&(this.frameIndex++,this.lastTime=new Date().getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(t){const e=t.dims;this.frameImageData&&e.width===this.frameImageData.width&&e.height===this.frameImageData.height||(this.tempCanvas.width=e.width,this.tempCanvas.height=e.height,this.frameImageData=this.tempCtx.createImageData(e.width,e.height)),this.frameImageData.data.set(t.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,e.left,e.top)}manipulate(t,e,i){t.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,e,i,this.attribute.width,this.attribute.height)}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),t==="gif"&&this.loadGif()}setAttributes(t,e,i){super.setAttributes(t,e,i),t.gif&&this.loadGif()}}class _I extends ji{constructor(t){var e,i,r,o,s;t.fill=(e=t.fill)!==null&&e!==void 0?e:"#00F",t.fontSize=(i=t.fontSize)!==null&&i!==void 0?i:12,t.underline=(r=t.underline)!==null&&r!==void 0?r:1,t.textBaseline=(o=t.textBaseline)!==null&&o!==void 0?o:"top",t.cursor=(s=t.cursor)!==null&&s!==void 0?s:"pointer",super(t)}}function Bd(n){return{rootContainer:new ko({}),renderDefault:!0}}class eJ{constructor(t){this.table=t,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(t,e){return e?this.headerCustomLayoutFuncCache.has(t):this.customLayoutFuncCache.has(t)}setReactCreateGraphic(t,e,i){i?this.headerCustomLayoutFuncCache.set(t,e):this.customLayoutFuncCache.set(t,e)}setReactRemoveGraphic(t,e,i){i?this.headerReactRemoveGraphicCache.set(t,e):this.reactRemoveGraphicCache.set(t,e)}setReactRemoveAllGraphic(t,e,i){i?this.headerReactRemoveAllGraphicCache.set(t,e):this.reactRemoveAllGraphicCache.set(t,e)}updateCustomCell(t,e){const i=this.table;if(i.widthMode==="autoWidth"&&i.scenegraph.recalculateColWidths(),(i.isAutoRowHeight()||i.internalProps.defaultRowHeight==="auto"&&!e||i.internalProps.defaultHeaderRowHeight==="auto"&&e)&&i.scenegraph.recalculateRowHeights(),i.isPivotTable()){const r=rJ(t,i,e);for(let o=0;o<r.length;o++){const s=r[o];for(let a=s.start.col;a<=s.end.col;a++)for(let l=s.start.row;l<=s.end.row;l++)i.scenegraph.updateCellContent(a,l)}}else{const r=iJ(t,i,e);for(let o=r.start.col;o<=r.end.col;o++)for(let s=r.start.row;s<=r.end.row;s++)i.scenegraph.updateCellContent(o,s)}i.scenegraph.renderSceneGraph()}getCustomLayoutFunc(t,e){var i;if(this.table.isHeader(t,e)){const{componentId:o}=this.table.getHeaderDefine(t,e);return(i=this.headerCustomLayoutFuncCache.get(o))!==null&&i!==void 0?i:Bd}const{componentId:r}=this.table.getBodyColumnDefine(t,e);return this.customLayoutFuncCache.get(r)||Bd}removeCustomCell(t,e){let i;if(this.table.isHeader(t,e)){const r=this.table.getHeaderDefine(t,e),{componentId:o}=r;i=this.headerReactRemoveGraphicCache.get(o)}else{const r=this.table.getBodyColumnDefine(t,e),{componentId:o}=r;i=this.reactRemoveGraphicCache.get(o)}i&&i(t,e)}clearCache(){this.reactRemoveAllGraphicCache.forEach(t=>{t()}),this.headerReactRemoveAllGraphicCache.forEach(t=>{t()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e)}),this.headerCustomLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e,!0)})}}function iJ(n,t,e){const i=t.internalProps.rowSeriesNumber?1:0;if(e){const o=t.internalProps.layoutMap,{headerObjects:s}=t.internalProps.layoutMap;let a;for(let u=0;u<s.length;u++){const h=s[u];if(h.define.componentId===n){a=h.id;break}}const l=o.getHeaderCellAdressById(a);return o.getCellRange(l.col,l.row)}const{columnObjects:r}=t.internalProps.layoutMap;for(let o=0;o<r.length;o++)if(r[o].define.componentId===n)return{start:{col:i+o,row:t.columnHeaderLevelCount},end:{col:i+o,row:t.rowCount-1}};return{start:{col:0,row:0},end:{col:t.colCount-1,row:t.rowCount-1}}}function rJ(n,t,e){const i=t.internalProps.rowSeriesNumber?1:0,r=[],o=t.internalProps.layoutMap;if(e){const{headerObjects:s}=o,a=[];for(let l=0;l<s.length;l++){const u=s[l];u&&u.define.componentId===n&&a.push(u.id)}for(let l=0;l<a.length;l++){const u=a[l],h=o.getHeaderCellAdressById(u),d=o.getCellRange(h.col,h.row);r.push(d)}}else{let s;const{columnObjects:a,indicatorsAsCol:l}=o;for(let u=0;u<a.length;u++)if(a[u].define.componentId===n){s=u;break}if(l)for(let u=o.rowHeaderLevelCount+s;u<o.colCount;u+=a.length){const h={start:{col:u+i,row:o.columnHeaderLevelCount},end:{col:u+i,row:o.rowCount-1}};r.push(h)}else for(let u=o.columnHeaderLevelCount+s;u<o.rowCount;u+=a.length){const h={start:{col:o.rowHeaderLevelCount+i,row:u},end:{col:o.colCount-1,row:u}};r.push(h)}}return r}function Ii(n){const t={abstractPos:{x:n.viewport.x,y:n.viewport.y}},e=el(n.target);return e&&(t.eventArgs={col:e.col,row:e.row,event:n,targetCell:e,mergeInfo:nJ(e),target:n.target}),t}function el(n){for(;n&&n.parent;){if(n.role==="cell")return n;n=n.parent}return null}function nJ(n){if(et(n.mergeStartCol)&&et(n.mergeStartRow)&&et(n.mergeEndCol)&&et(n.mergeEndRow))return{colStart:n.mergeStartCol,colEnd:n.mergeEndCol,rowStart:n.mergeStartRow,rowEnd:n.mergeEndRow}}const oJ=/radio-\d+-\d+-(\d+)/,CI="_custom_",ro="custom-container",_p=CI+"_0";function Xs(n,t,e,i,r,o,s,a,l,u,h){var d,c,f;let g,m,p,v=!0,b=!1;if(n==="react-custom-layout"&&(n=((d=h.reactCustomLayout)===null||d===void 0?void 0:d.getCustomLayoutFunc(e,i))||Bd),typeof n=="function"){const C=n({col:(c=u==null?void 0:u.start.col)!==null&&c!==void 0?c:e,row:(f=u==null?void 0:u.start.row)!==null&&f!==void 0?f:i,dataValue:h.getCellOriginValue(e,i),value:h.getCellValue(e,i)||"",rect:{left:0,top:0,right:r,bottom:o,width:r,height:o},table:h,originCol:e,originRow:i});if(!C)return{renderDefault:!0};C.rootContainer&&(C.rootContainer=Pd(C.rootContainer,h.animationManager.timeline)),C.rootContainer instanceof ko&&(p=C.rootContainer,p.name=ro,p.col=e,p.row=i),v=C.renderDefault,b=C.enableCellPadding}else if(typeof t=="function"){const C=t({col:e,row:i,dataValue:h.getCellOriginValue(e,i),value:h.getCellValue(e,i)||"",rect:{left:0,top:0,right:r,bottom:o,width:r,height:o},table:h});C&&(m=C.elements,v=C.renderDefault,C.expectedWidth,g=C.expectedHeight)}else t&&(t.expectedWidth,g=t.expectedHeight,m=t.elements,v=t.renderDefault);return m&&(p=sJ(m,r,a?g:o,h.getCellValue(e,i))),b&&p.setAttributes({x:l[3],y:l[0],width:r-l[1]-l[3],height:o-l[0]-l[2]}),o0(p,r,o),!u||u.start.col===u.end.col&&u.start.row===u.end.row||yI(p,e,i,0),{elementsGroup:p,renderDefault:v}}function sJ(n,t,e,i){const r=new ko({x:0,y:0,width:t,height:e,fill:!1,stroke:!1,pickable:!1});return r.name=ro,aJ(n,t,e,i).forEach(o=>{var s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O;switch(o.clickable&&(o.pickable=o.clickable),o.type){case"arc":const N=bg({x:o.x,y:o.y,dx:(s=o.dx)!==null&&s!==void 0?s:0,dy:(a=o.dy)!==null&&a!==void 0?a:0,fill:o.fill,stroke:o.stroke,outerRadius:o.radius,startAngle:o.startAngle,endAngle:o.endAngle,pickable:!!o.pickable,cursor:o.cursor});N.name=o.name,r.appendChild(N);break;case"text":if(o.background){const J=(u=(l=o.background)===null||l===void 0?void 0:l.expandX)!==null&&u!==void 0?u:0,st=(d=(h=o.background)===null||h===void 0?void 0:h.expandY)!==null&&d!==void 0?d:0,ht=Ge({x:o.x-J,y:o.y-st,dx:(c=o.dx)!==null&&c!==void 0?c:0,dy:(f=o.dy)!==null&&f!==void 0?f:0,width:o.width+2*J,height:o.height+2*st,cornerRadius:(m=(g=o.background)===null||g===void 0?void 0:g.cornerRadius)!==null&&m!==void 0?m:0,fill:(v=(p=o.background)===null||p===void 0?void 0:p.fill)!==null&&v!==void 0?v:"#888"});r.appendChild(ht)}const U=new ji(Object.assign({pickable:!!o.pickable,fill:(b=o.color)!==null&&b!==void 0?b:o.fill},o));U.name=o.name,r.appendChild(U);break;case"rect":const W=Ge({x:o.x,y:o.y,dx:(C=o.dx)!==null&&C!==void 0?C:0,dy:(y=o.dy)!==null&&y!==void 0?y:0,width:o.width,height:o.height,cornerRadius:o.radius,fill:o.fill,stroke:o.stroke,pickable:!!o.pickable,cursor:o.cursor});W.name=o.name,r.appendChild(W);break;case"circle":const j=EL({x:o.x,y:o.y,dx:(w=o.dx)!==null&&w!==void 0?w:0,dy:(_=o.dy)!==null&&_!==void 0?_:0,radius:o.radius,fill:o.fill,stroke:o.stroke,pickable:!!o.pickable,cursor:o.cursor});j.name=o.name,r.appendChild(j);break;case"icon":const Y=new tl({x:o.x,y:o.y,dx:(A=o.dx)!==null&&A!==void 0?A:0,dy:(T=o.dy)!==null&&T!==void 0?T:0,width:o.width,height:o.height,image:o.svg,backgroundWidth:o.hover?(S=o.hover.width)!==null&&S!==void 0?S:o.width:void 0,backgroundHeight:o.hover?(x=o.hover.width)!==null&&x!==void 0?x:o.width:void 0,backgroundColor:o.hover?(E=o.hover.bgColor)!==null&&E!==void 0?E:"rgba(22,44,66,0.2)":void 0,pickable:!!o.pickable,cursor:o.cursor});Y.name=o.name,Y.role="icon-custom",r.appendChild(Y);break;case"image":const Z=new tl({x:o.x,y:o.y,dx:(M=o.dx)!==null&&M!==void 0?M:0,dy:(L=o.dy)!==null&&L!==void 0?L:0,width:o.width,height:o.height,image:o.src,backgroundWidth:o.hover?(I=o.hover.width)!==null&&I!==void 0?I:o.width:void 0,backgroundHeight:o.hover?(D=o.hover.width)!==null&&D!==void 0?D:o.width:void 0,backgroundColor:o.hover?(H=o.hover.bgColor)!==null&&H!==void 0?H:"rgba(22,44,66,0.2)":void 0,pickable:!!o.pickable,cursor:o.cursor,shape:o.shape});Z.name=o.name,Z.role="image-custom",r.appendChild(Z);break;case"line":const rt=ln({points:o.points,lineWidth:(O=o.lineWidth)!==null&&O!==void 0?O:1,stroke:o.stroke,pickable:!!o.pickable,cursor:o.cursor});rt.name=o.name,r.appendChild(rt)}}),r}function aJ(n,t,e,i){const r=[],o=[0,0,0,0];for(let s=0;s<n.length;s++){const a=n[s],l=Object.assign({},a);for(const h in l)l.hasOwnProperty(h)&&pn(l[h])&&(l[h]=l[h](i));const u=l;et(u.x)&&(u.x=ei(u.x)?$o(u.x,t-o[1]):Number(u.x)),et(u.y)&&(u.y=ei(u.y)?$o(u.y,e-o[2]):Number(u.y)),"width"in l&&(l.width=ei(l.width)?$o(l.width,t-o[1]):Number(l.width)),"height"in l&&(l.height=ei(l.height)?$o(l.height,e-o[2]):Number(l.height)),"radius"in l&&(l.radius=ei(l.radius)?$o(l.radius,Math.min(t-o[1],e-o[2])):Number(l.radius)),"hover"in l&&(l.hover.x=ei(l.hover.x)?$o(l.hover.x,t-o[1]):Number(l.hover.x),l.hover.y=ei(l.hover.y)?$o(l.hover.y,e-o[2]):Number(l.hover.y),l.hover.width=ei(l.hover.width)?$o(l.hover.width,t-o[1]):Number(l.hover.width),l.hover.height=ei(l.hover.height)?$o(l.hover.height,e-o[2]):Number(l.hover.height),l.hover.x+=0,l.hover.y+=0),u.x=u.x+0,u.y=u.y+0,r.push(l)}return r}function $o(n,t){return n.endsWith("px")?parseInt(n,10):n.endsWith("%")&&t?parseInt(n,10)/100*t:parseInt(n,10)}function o0(n,t,e){n&&n.forEachChildren(i=>{var r,o;i&&(Li(i.attribute.width)&&i.attribute.width.percent&&i.setAttribute("width",Math.max(0,i.attribute.width.percent/100*t+((r=i.attribute.width.delta)!==null&&r!==void 0?r:0))),i.attribute.width<0&&i.setAttribute("width",0),Li(i.attribute.height)&&i.attribute.height.percent&&i.setAttribute("height",Math.max(0,i.attribute.height.percent/100*e+((o=i.attribute.height.delta)!==null&&o!==void 0?o:0))),i.attribute.height<0&&i.setAttribute("height",0),i.type==="group"&&o0(i,i.attribute.width,i.attribute.height))})}function Pd(n,t){if(!n||!et(n.$$typeof)&&!et(n.vtype))return n;const e=n.type,{attribute:i,children:r,stateProxy:o,animation:s}=n.props,a=e({attribute:i});if(lJ(a,n.props),o&&(a.stateProxy=o),a.id=i.id,a.name=i.name,Wt(r)?r.forEach(l=>{const u=Pd(l,t);u&&u.type&&a.add(u)}):r&&a.add(Pd(r,t)),Wt(s)&&t){const l=a.animate();l.setTimeline(t),s.forEach(u=>{l[u[0]](...u.slice(1))})}return a}function lJ(n,t){let e=!1;switch(n.type){case"richtext":case"rich/image":break;default:e=!0}e&&Object.keys(t).forEach(i=>{const r=Lj[i];r&&n.on(r,t[i])})}function yI(n,t,e,i,r){n&&(n.name=`${CI}${r??""}_${i}`,n.onBeforeAttributeUpdate=uJ,n.type==="group"&&n.childrenCount&&n.forEachChildren((o,s)=>{yI(o,t,e,s,(r??"")+"_"+i)}))}function uJ(n,t){const e=this;if(e.skipMergeUpdate)return;const i=el(e);if(!i||!i.stage)return;const r=i.stage.table;e.skipAttributeUpdate=!0;const{mergeStartCol:o,mergeEndCol:s,mergeStartRow:a,mergeEndRow:l}=i;if(et(o)&&et(s)&&et(a)&&et(l)&&(o!==s||a!==l)){for(let u=o;u<=s;u++)for(let h=a;h<=l;h++){if(u===i.col&&h===i.row)continue;const d=r.scenegraph.highPerformanceGetCell(u,h);if(d.role==="cell"){const c=d.getChildByName(e.name,!0);if(!c||c.skipAttributeUpdate)continue;for(const f in n)n[f]!==c.attribute[f]&&f!=="dx"&&f!=="dy"&&c.setAttribute(f,n[f])}}e.skipAttributeUpdate=void 0}}class de extends ko{clear(){this.removeAllChild()}getChildByName(t,e){let i=null;return this.forEachChildren(r=>r.name===t&&(i=r,!0)),e&&this.forEachChildren(r=>{if(r.getChildByName){const o=r.getChildByName(t,!0);if(o)return i=o,!0}return!1}),i}get width(){var t;let e=this.AABBBounds.width();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,(t=this.attribute.width)!==null&&t!==void 0?t:0)}get height(){var t;let e=this.AABBBounds.height();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,(t=this.attribute.height)!==null&&t!==void 0?t:0)}setDeltaWidth(t){var e;t!==0&&(this.setAttribute("width",((e=this.attribute.width)!==null&&e!==void 0?e:0)+t),this.border&&(this.border.setAttribute("width",this.border.attribute.width+t),this.border.type==="group"&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+t)))}setDeltaHeight(t){var e;t!==0&&(this.setAttribute("height",((e=this.attribute.height)!==null&&e!==void 0?e:0)+t),this.border&&(this.border.setAttribute("height",this.border.attribute.height+t),this.border.type==="group"&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+t)))}setDeltaX(t){t!==0&&this.setAttribute("x",this.attribute.x+t)}setDeltaY(t){t!==0&&this.setAttribute("y",this.attribute.y+t)}forEachChildrenSkipChild(t,e="border-rect",i=!1){if(i){let r=this._lastChild,o=0;for(;r;){if(r.name!==e&&t(r,o++))return;r=r._prev}}else{let r=this._firstChild,o=0;for(;r;){if(r.name!==e&&t(r,o++))return;r=r._next}}}getColGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.col===t)return e;e=e._next}return null}getRowGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.row===t)return e;e=e._next}return null}addCellGroup(t){if(this.childrenCount===0||this.lastChild.row===t.row-1)this.addChild(t);else{let e=this._firstChild;for(let i=0;i<this.childrenCount;i++){if(e.row===t.row-1)return void this.insertAfter(t,e);e=e._next}this.addChild(t)}}getChildAt(t){const e=super.getChildAt(t);return e&&e.name==="border-rect"?e._next:e}tryUpdateAABBBounds(){if(this.role==="cell"){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;const t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),hJ(this,t),e}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if(this.role==="cell"){const t=this.attribute,{x:e,y:i,width:r,height:o}=t;return this._AABBBounds.setValue(e,i,e+r,i+o),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return this.role==="body"||this.role==="row-header"||this.role==="col-header"||this.role==="right-frozen"||this.role==="bottom-frozen"||this.role==="corner-header"||this.role==="corner-right-top-header"||this.role==="corner-right-bottom-header"||this.role==="corner-left-bottom-header"?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(t){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,t):this.rowNumber=t}updateColumnHeight(t){this.colHeight?this.colHeight+=t:this.colHeight=t}}function hJ(n,t){n.stage&&n.stage.dirtyBounds&&n.stage.renderCount&&(n.isContainer&&!t||n.stage.dirty(n.globalAABBBounds))}function s0(n,t,e,i){const r=n/t;let o,s;return r>e/i?(o=e,s=o/r,(i-s)/2):(s=i,o=s*r,(e-o)/2),{width:o,height:s}}function Jw(n,t,e,i,r,o,s="left",a="middle",l=[0,0,0,0],u=0,h=0,d=0,c=0){const f=n+e,g=t+i;let m=n+l[3]+u;s==="right"||s==="end"?m=f-r-l[1]-h:s==="center"&&(m=n+(e-r+u-h)/2);let p=t+l[0]+d;return a==="bottom"||a==="alphabetic"||a==="ideographic"?p=g-o-l[2]-c:a==="middle"&&(p=t+(i-o+d-c)/2),{x:m,y:p}}function pt(n,t,e,i,r){const o=t&&et(t[n])?t[n]:void 0;return typeof o=="function"?o({col:e,row:i,table:r,value:r.getCellValue(e,i),dataValue:r.getCellOriginValue(e,i),cellHeaderPaths:r.getCellHeaderPaths(e,i)}):o}function a0(n,t,e,i,r){const o=t&&et(t[n])?t[n]:void 0;if(typeof o=="function")return o({col:e,row:i,table:r,value:r.getCellValue(e,i),dataValue:r.getCellOriginValue(e,i),cellHeaderPaths:r.getCellHeaderPaths(e,i)})}function Oo(n,t,e,i){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w;let _=(o=(r=e==null?void 0:e.group)===null||r===void 0?void 0:r.strokeArrayWidth)!==null&&o!==void 0?o:void 0;return i.theme.cellInnerBorder||!kK(i.theme.frameStyle.borderLineWidth)||LK(i.theme.frameStyle.borderLineWidth)||(n===0&&(_=_??[(s=e==null?void 0:e.group)===null||s===void 0?void 0:s.lineWidth,(a=e==null?void 0:e.group)===null||a===void 0?void 0:a.lineWidth,(l=e==null?void 0:e.group)===null||l===void 0?void 0:l.lineWidth,(u=e==null?void 0:e.group)===null||u===void 0?void 0:u.lineWidth],_[3]=0),n===i.colCount-1&&(_=_??[(h=e==null?void 0:e.group)===null||h===void 0?void 0:h.lineWidth,(d=e==null?void 0:e.group)===null||d===void 0?void 0:d.lineWidth,(c=e==null?void 0:e.group)===null||c===void 0?void 0:c.lineWidth,(f=e==null?void 0:e.group)===null||f===void 0?void 0:f.lineWidth],_[1]=0),t===0&&(_=_??[(g=e==null?void 0:e.group)===null||g===void 0?void 0:g.lineWidth,(m=e==null?void 0:e.group)===null||m===void 0?void 0:m.lineWidth,(p=e==null?void 0:e.group)===null||p===void 0?void 0:p.lineWidth,(v=e==null?void 0:e.group)===null||v===void 0?void 0:v.lineWidth],_[0]=0),t===i.rowCount-1&&(_=_??[(b=e==null?void 0:e.group)===null||b===void 0?void 0:b.lineWidth,(C=e==null?void 0:e.group)===null||C===void 0?void 0:C.lineWidth,(y=e==null?void 0:e.group)===null||y===void 0?void 0:y.lineWidth,(w=e==null?void 0:e.group)===null||w===void 0?void 0:w.lineWidth],_[2]=0)),_}class dJ extends de{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new de({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new de({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new de({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addContent(t){const e=this._centerGroup.lastChild;e&&t.setAttributes({x:e.attribute.x+e.AABBBounds.width()}),this._centerGroup.appendChild(t),t instanceof ji&&(this._centerGroup.setAttribute("pickable",!1),t.setAttribute("textAlign","left"))}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){const s=this._centerGroup.width;this._cellWidth=t+e+s,this.setAttribute("width",this._cellWidth)}else{const s=this._cellWidth-t-e;this.updateCenterLayout(s);const a=this._centerGroup.width;this._cellWidth=t+e+a,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();const i=this._leftGroup.height,r=this._rightGroup.height,o=this._centerGroup.height;this._cellHeight=Math.max(i,r,o),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._centerGroup.forEachChildren(o=>{(o instanceof tl||o instanceof _I)&&(e-=o.AABBBounds.width())});const i=this._centerGroup.getChildByName("text");i instanceof li?i.setAttribute("width",e):i instanceof ji&&i.setAttribute("maxLineWidth",e);let r=0;this._centerGroup.forEachChildren(o=>{o.setAttribute("x",r),r+=o.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),this._align==="left"||this._align==="start"?this.setAttribute("dx",0):this._align==="center"?this.setAttribute("dx",-this.attribute.width/2):this._align!=="right"&&this._align!=="end"||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){this._baseline==="top"?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):this._baseline==="middle"?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):this._baseline==="bottom"&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(t){this._cellWidth=t,this._originCellWidth=t,this.layout()}updateHeight(t){this._cellHeight=t,this._cellWidth=this._originCellWidth;const e=this.getChildByName("text",!0);e&&e.setAttribute("heightLimit",t),this.layout()}}function dn(n,t,e){var i,r,o,s,a;let l=0;const u=e.internalProps.layoutMap;if(u.isHeader(n,t)){const h=u.getHeader(n,t);et(h==null?void 0:h.hierarchyLevel)&&(l=((i=h.hierarchyLevel)!==null&&i!==void 0?i:0)*(u.rowHierarchyType==="tree"&&(r=u.rowHierarchyIndent)!==null&&r!==void 0?r:0),u.rowHierarchyTextStartAlignment&&!e.internalProps.headerHelper.getHierarchyIcon(n,t)&&(l+=e.internalProps.headerHelper.getHierarchyIconWidth()))}else if(e.options.groupBy||!((o=e.getBodyColumnDefine(n,t))===null||o===void 0)&&o.tree){const h=e.dataSource.getIndexKey(e.getRecordShowIndexByCell(n,t)),d=(s=e.dataSource.getGroupLength())!==null&&s!==void 0?s:0;let c=Wt(h)?h.length-1:0;d>0&&c===d&&(c=0),l=Array.isArray(h)&&e.getHierarchyState(n,t)!==Yt.none?c*((a=u.hierarchyIndent)!==null&&a!==void 0?a:0):0,u.hierarchyTextStartAlignment&&!e.internalProps.bodyHelper.getHierarchyIcon(n,t)&&(l+=e.internalProps.bodyHelper.getHierarchyIconWidth())}return l}function kd(n,t){var e,i;let r,o=!1;for(ei(n)&&n.length>(t.options.maxCharactersNumber||200)&&(n=n.slice(0,t.options.maxCharactersNumber||200),n+="…",o=!0),r=t.internalProps.enableLineBreak||!((e=t.options.customConfig)===null||e===void 0)&&e.multilinesForXTable?tR(n).replace(/\r?\n/g,`
`).replace(/\r/g,`
`).split(`
`)||[]:[tR(n)];r.length&&r.length>1&&!r[r.length-1];)r.pop();if(!((i=t.options.customConfig)===null||i===void 0)&&i.multilinesForXTable&&!t.internalProps.autoWrapText)for(;r.length&&r.length>1&&!r[0];)r.shift();return{text:r,moreThanMaxCharacters:o}}function cJ(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){var m,p,v,b,C,y,w,_,A;let T,S=0,x=0,E=0;if(Array.isArray(t)&&t.length!==0){const{inlineFrontIcons:I,inlineEndIcons:D,contentLeftIcons:H,contentRightIcons:O,leftIconWidth:N,rightIconWidth:U,absoluteRightIconWidth:W}=ju(t,n,g,c);let j;if(S=N,x=U,E=W,I.length===0&&D.length===0){let Y=0;wt(c.theme._contentOffset)&&(h==="left"?Y=c.theme._contentOffset:h==="right"&&(Y=-c.theme._contentOffset));const Z=g?dn(g.start.col,g.start.row,c):dn(n.col,n.row,c),{text:rt,moreThanMaxCharacters:J}=kd(e,c),st={text:rt.length===1?rt[0]:rt,moreThanMaxCharacters:J,maxLineWidth:r?1/0:l-(i[1]+i[3])-S-x-Z,textBaseline:"top",heightLimit:((b=c.options.customConfig)===null||b===void 0?void 0:b.limitContentHeight)===!1||o&&!(!((C=c.options.customConfig)===null||C===void 0)&&C.multilinesForXTable)?-1:u-Math.floor(i[0]+i[2]),pickable:!1,autoWrapText:s,lineClamp:a,wordBreak:"break-word",whiteSpace:((y=c.options.customConfig)===null||y===void 0?void 0:y.limitContentHeight)===!1||rt.length!==1||s?"normal":"no-wrap",dx:(h==="left"?H.length?0:Z:0)+Y,keepCenterInLine:!0},ht=new ji(f.text?Object.assign({},f.text,st):st);ht.name="text",j=ht}else{const Y=Object.assign({text:e==null?void 0:e.toString()},((A=(_=(w=n.parent)===null||w===void 0?void 0:w.theme)===null||_===void 0?void 0:_.userTheme)===null||A===void 0?void 0:A.text)||{});f.text&&Object.assign(Y,f.text),Y.textBaseline="middle";const Z=[...I.map(J=>Cp(J)),Y,...D.map(J=>Cp(J))];Z[0].textAlign=h;const rt=new li({width:r?0:l-(i[1]+i[3])-S-x,height:o&&s?0:Math.ceil(u-(i[0]+i[2])),textConfig:Z,verticalDirection:o&&s?"top":d,ellipsis:Y.ellipsis});rt.name="text",j=rt,rt.bindIconEvent(),!g||g.start.col===g.end.col&&g.start.row===g.end.row||(rt.onBeforeAttributeUpdate=gJ)}if(H.length!==0||O.length!==0){const Y=new dJ({x:0,y:0,fill:!1,stroke:!1,pickable:!1});Y.name="content",Y.setCellContentOption({autoWidth:r,autoHeight:o,cellWidth:l-(i[1]+i[3])-S-x,cellHeight:u-(i[0]+i[2]),align:h,baseline:d});const Z={addedHierarchyOffset:0};H.forEach(rt=>{const J=cn(rt,void 0,n.col,n.row,g,c,Z);J.role="icon-content-left",J.name=rt.name,Y.addLeftOccupyingIcon(J)}),O.forEach(rt=>{const J=cn(rt,void 0,n.col,n.row,g,c,Z);J.role="icon-content-right",J.name=rt.name,Y.addRightOccupyingIcon(J)}),Y.addContent(j),n.appendChild(Y),Y.layout(),T=Y.AABBBounds.width(),Y.AABBBounds.height()}else n.firstChild?n.insertBefore(j,n.firstChild):n.appendChild(j),T=j.AABBBounds.width(),j.AABBBounds.height()}else if(et(e)){const{text:I,moreThanMaxCharacters:D}=kd(e,c),H=g?dn(g.start.col,g.start.row,c):dn(n.col,n.row,c);let O=0;wt(c.theme._contentOffset)&&(h==="left"?O=c.theme._contentOffset:h==="right"&&(O=-c.theme._contentOffset));const N={text:I.length===1?I[0]:I,moreThanMaxCharacters:D,maxLineWidth:r?1/0:l-(i[1]+i[3]+H),textBaseline:"top",autoWrapText:s,lineClamp:a,wordBreak:"break-word",heightLimit:((m=c.options.customConfig)===null||m===void 0?void 0:m.limitContentHeight)===!1||o&&!(!((p=c.options.customConfig)===null||p===void 0)&&p.multilinesForXTable)?-1:u-Math.floor(i[0]+i[2]),pickable:!1,dx:(h==="left"?H:0)+O,whiteSpace:((v=c.options.customConfig)===null||v===void 0?void 0:v.limitContentHeight)===!1||I.length!==1||s?"normal":"no-wrap",keepCenterInLine:!0},U=new ji(f.text?Object.assign({},f.text,N):N);U.name="text",U.textBaseline=d,n.appendChild(U),T=U.AABBBounds.width(),U.AABBBounds.height()}const M=r?S+T+x:l-(i[1]+i[3]),L=u-(i[0]+i[2]);n.forEachChildren(I=>{I.role==="icon-left"?I.setAttribute("x",I.attribute.x+i[3]):I.role==="icon-right"?I.setAttribute("x",I.attribute.x+M-x+i[3]):I.role==="icon-absolute-right"?I.setAttribute("x",I.attribute.x+M-E+i[3]+i[1]):I.name!=="content"&&I.name!=="text"||(h==="center"&&I.type!=="richtext"?I.setAttribute("x",i[3]+S+(M-S-x)/2):h==="right"&&I.type!=="richtext"?I.setAttribute("x",i[3]+M-x):I.setAttribute("x",i[3]+S))}),n.forEachChildren(I=>{I.name!==ro&&(d==="middle"?I.setAttribute("y",i[0]+(L-I.AABBBounds.height())/2):d==="bottom"?I.setAttribute("y",i[0]+L-I.AABBBounds.height()):I.setAttribute("y",i[0]))}),n.setAttributes({width:M+i[1]+i[3],height:L+i[0]+i[2]})}function cn(n,t,e,i,r,o,s){var a,l,u,h,d,c;const f={};n.type==="image"?(n.isGif&&(f.gif=n.src),f.image=n.src):(n.type==="svg"||"svg"in n)&&(f.image=n.svg),f.width=n.width,f.height=n.height,f.visibleTime=(a=n.visibleTime)!==null&&a!==void 0?a:"always",f.funcType=n.funcType,f.interactive=n.interactive,f.isGif=n.isGif;let g,m=0;return s&&(s==null?void 0:s.addedHierarchyOffset)!==0||!wt(e)||!wt(i)||!o||n.funcType!==Pe.collapse&&n.funcType!==Pe.expand&&n.positionType!==Be.contentLeft&&n.positionType!==Be.contentRight||(m=r?dn(r.start.col,r.start.row,o):dn(e,i,o),s&&(s.addedHierarchyOffset=1)),f.marginLeft=((l=n.marginLeft)!==null&&l!==void 0?l:0)+m,f.marginRight=(u=n.marginRight)!==null&&u!==void 0?u:0,n.interactive===!1&&(f.pickable=!1),n.hover&&(f.backgroundWidth=(h=n.hover.width)!==null&&h!==void 0?h:n.width,f.backgroundHeight=(d=n.hover.width)!==null&&d!==void 0?d:n.width,f.backgroundColor=(c=n.hover.bgColor)!==null&&c!==void 0?c:"rgba(22,44,66,0.2)",f.hoverImage=n.hover.image),n.cursor&&(f.cursor=n.cursor),"shape"in n&&n.shape==="circle"&&(f.shape=n.shape),t?(t.setAttributes(f),t.loadImage(f.image),t.tooltip=n.tooltip,t.name=n.name,t):(n.type==="text"?(f.text=n.content,Ie(f,n.style),g=new _I(f),g.tooltip=n.tooltip,g.name=n.name):(g=new tl(f),g.tooltip=n.tooltip,g.name=n.name),g)}function Cp(n){var t,e,i,r,o,s;const a={};return n.type==="image"?a.image=n.src:(n.type==="svg"||"svg"in n)&&(a.image=n.svg),a.visibleTime=(t=n.visibleTime)!==null&&t!==void 0?t:"always",a.funcType=n.funcType,a.id=n.name,a.width=n.width,a.height=n.height,(n.marginRight||n.marginLeft)&&(a.margin=[0,(e=n.marginRight)!==null&&e!==void 0?e:0,0,(i=n.marginLeft)!==null&&i!==void 0?i:0]),n.hover&&(a.backgroundWidth=(r=n.hover.width)!==null&&r!==void 0?r:n.width,a.backgroundHeight=(o=n.hover.height)!==null&&o!==void 0?o:n.height,a.backgroundShowMode="hover",a.hoverImage=n.hover.image,a.backgroundStroke=!1,a.backgroundFill=(s=n.hover.bgColor)!==null&&s!==void 0?s:"rgba(22,44,66,0.2)"),n.cursor&&(a.cursor=n.cursor),a.tooltip=n.tooltip,a}function yp(n,t,e,i,r,o,s,a,l){var u,h,d,c;Oa(n.contentWidth)&&(i=t-((u=n.contentWidth)!==null&&u!==void 0?u:n.attribute.width));let f,g=0,m=0,p=0,v=0;n.forEachChildren(_=>{var A,T,S,x;_.role==="icon-left"?(g+=_.AABBBounds.width()+((A=_.attribute.marginLeft)!==null&&A!==void 0?A:0)+((T=_.attribute.marginRight)!==null&&T!==void 0?T:0),m=Math.max(m,_.AABBBounds.height())):_.role==="icon-right"&&(p+=_.AABBBounds.width()+((S=_.attribute.marginLeft)!==null&&S!==void 0?S:0)+((x=_.attribute.marginRight)!==null&&x!==void 0?x:0),v=Math.max(v,_.AABBBounds.height()))});const b=n.getChildByName("text"),C=n.getChildByName("content");let y;b instanceof ji?(f=b.AABBBounds.height(),b.setAttribute("maxLineWidth",t-g-p-(o[1]+o[3])-((h=b.attribute.dx)!==null&&h!==void 0?h:0)-((d=l.table.theme._contentOffset)!==null&&d!==void 0?d:0)),y=b.AABBBounds.height()):b instanceof li?(f=b.AABBBounds.height(),b.setAttribute("width",t-g-p-(o[1]+o[3])),y=b.AABBBounds.height()):C&&(f=C.AABBBounds.height(),C.updateWidth(t-g-p-(o[1]+o[3])),y=C.AABBBounds.height());const w=Math.round(Math.max(m,v,f)+o[0]+o[2]);if(n.forEachChildren(_=>{var A;if(_.role!=="icon-left")if(_.role==="icon-right")_.setAttribute("x",_.attribute.x+i);else if(_.role==="icon-absolute-right")_.setAttribute("x",_.attribute.x+i);else if(_.name==="content"||_.name==="text"&&_.type!=="richtext"){const T=(A=_.attribute.textAlign)!==null&&A!==void 0?A:s;T==="center"?_.setAttribute("x",o[3]+g+(t-(o[1]+o[3])-g-p)/2):T==="right"&&_.setAttribute("x",o[3]+t-(o[1]+o[3])-p)}else _.name==="mark"&&_.setAttribute("x",n.attribute.width)}),r){let _=Math.max(m,y,v);if(fJ(l,n,Math.round(_+o[0]+o[2]),w))return!0;_=((c=n.contentHeight)!==null&&c!==void 0?c:e)-(o[0]+o[2]),n.forEachChildren(A=>{A.type!=="rect"&&A.type!=="chart"&&A.name!==ro&&(A.name==="mark"?A.setAttribute("y",0):a==="middle"?A.setAttribute("y",o[0]+(_-A.AABBBounds.height())/2):a==="bottom"?A.setAttribute("y",o[0]+_-A.AABBBounds.height()):A.setAttribute("y",o[0]))})}else a!=="middle"&&a!=="bottom"||n.forEachChildren(_=>{_.type!=="rect"&&_.type!=="chart"&&_.name!==ro&&(_.name==="mark"?_.setAttribute("y",0):a==="middle"?_.setAttribute("y",(e-o[2]+o[0]-_.AABBBounds.height())/2):a==="bottom"?_.setAttribute("y",e-_.AABBBounds.height()-o[2]):_.setAttribute("y",o[0]))});return!1}function wp(n,t,e,i,r,o,s,a){var l;const u=t-Math.floor(r[0]+r[2]),h=n.getChildByName("text");h instanceof ji&&!i?h.setAttributes({heightLimit:((l=a.options.customConfig)===null||l===void 0?void 0:l.limitContentHeight)===!1?-1:u}):h instanceof li&&!i?h.setAttributes({height:u}):n.getChildByName("content")&&n.getChildByName("content").updateHeight(u),n.forEachChildren(d=>{d.setAttribute("dy",0),d.type==="rect"||d.type==="chart"||d.name===ro||(d.name==="mark"?d.setAttribute("y",0):s==="middle"?d.setAttribute("y",r[0]+(u-d.AABBBounds.height())/2):s==="bottom"?d.setAttribute("y",r[0]+u-d.AABBBounds.height()):d.setAttribute("y",r[0]))})}function fJ(n,t,e,i){const r=n.table,o=vi(r,t.col,t.row);if(o&&o.end.row-o.start.row){i/=o.end.row-o.start.row+1,e/=o.end.row-o.start.row+1;for(let s=o.start.row;s<=o.end.row;s++){const a=r.getRowHeight(s);if(a===i&&e!==a||e>a)return!0}}else{const s=r.getRowHeight(t.row);if(s===i&&e!==s||e>s)return!0}return!1}function ju(n,t,e,i){const r=[],o=[],s=[],a=[],l=[],u=[],h=[],d=[];let c=0,f=0,g=0,m=0,p=0,v=0;return n.forEach(b=>{switch(b.positionType){case Be.left:r.push(b);break;case Be.right:o.push(b);break;case Be.contentLeft:s.push(b);break;case Be.contentRight:a.push(b);break;case Be.absoluteRight:d.push(b);break;case Be.inlineFront:l.push(b);break;case Be.inlineEnd:u.push(b)}}),r.forEach(b=>{var C,y,w;const _=cn(b,void 0,t.col,t.row,e,i);_.role="icon-left",_.name=b.name,_.setAttribute("x",c+((C=_.attribute.marginLeft)!==null&&C!==void 0?C:0)),c+=_.AABBBounds.width()+((y=_.attribute.marginLeft)!==null&&y!==void 0?y:0)+((w=_.attribute.marginRight)!==null&&w!==void 0?w:0),f=Math.max(f,_.AABBBounds.height()),t.appendChild(_)}),o.forEach(b=>{var C,y,w;const _=cn(b,void 0,t.col,t.row,e,i);_.role="icon-right",_.name=b.name,_.setAttribute("x",g+((C=_.attribute.marginLeft)!==null&&C!==void 0?C:0)),g+=_.AABBBounds.width()+((y=_.attribute.marginLeft)!==null&&y!==void 0?y:0)+((w=_.attribute.marginRight)!==null&&w!==void 0?w:0),m=Math.max(m,_.AABBBounds.height()),t.appendChild(_)}),h.forEach(b=>{var C,y,w;const _=cn(b,void 0,t.col,t.row,e,i);_.role="icon-absolute-left",_.name=b.name,_.setAttribute("x",p+((C=_.attribute.marginLeft)!==null&&C!==void 0?C:0)),p+=_.AABBBounds.width()+((y=_.attribute.marginLeft)!==null&&y!==void 0?y:0)+((w=_.attribute.marginRight)!==null&&w!==void 0?w:0),t.appendChild(_)}),d.forEach(b=>{var C,y,w;const _=cn(b,void 0,t.col,t.row,e,i);_.role="icon-absolute-right",_.name=b.name,_.setAttribute("x",v+((C=_.attribute.marginLeft)!==null&&C!==void 0?C:0)),v+=_.AABBBounds.width()+((y=_.attribute.marginLeft)!==null&&y!==void 0?y:0)+((w=_.attribute.marginRight)!==null&&w!==void 0?w:0),t.appendChild(_)}),{leftIcons:r,rightIcons:o,contentLeftIcons:s,contentRightIcons:a,inlineFrontIcons:l,inlineEndIcons:u,absoluteLeftIcons:h,absoluteRightIcons:d,leftIconWidth:c,leftIconHeight:f,rightIconWidth:g,rightIconHeight:m,absoluteLeftIconWidth:p,absoluteRightIconWidth:v}}function gJ(n,t){if(n.hasOwnProperty("hoverIconId")){const e=this;if(e.skipMergeUpdate)return;const i=el(e);if(!i||!i.stage)return;const r=i.stage.table;e.skipAttributeUpdate=!0;const{mergeStartCol:o,mergeEndCol:s,mergeStartRow:a,mergeEndRow:l}=i;if(et(o)&&et(s)&&et(a)&&et(l)&&(o!==s||a!==l)){for(let u=o;u<=s;u++)for(let h=a;h<=l;h++){if(u===i.col&&h===i.row){if(n.hoverIconId!==e.attribute.hoverIconId){const c=e._frameCache.icons.get(n.hoverIconId);e.updateHoverIconState(c)}continue}const d=r.scenegraph.highPerformanceGetCell(u,h);if(d.role==="cell"){const c=d.getChildByName(e.name,!0);if(!c||c.skipAttributeUpdate)continue;n.hoverIconId!==c.attribute.hoverIconId&&(c.setAttribute("hoverIconId",n.hoverIconId),d.addUpdateBoundTag())}}e.skipAttributeUpdate=void 0}}}function pJ(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p){var v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J,st,ht,at,lt,_t;const vt=f._getCellStyle(i,r),yt=a0("padding",vt,i,r,f);!((v=f.options.customConfig)===null||v===void 0)&&v.imageMargin?u=me((b=f.options.customConfig)===null||b===void 0?void 0:b.imageMargin):et(yt)&&(u=yt),!((C=g==null?void 0:g.text)===null||C===void 0)&&C.textAlign&&(h=(y=g==null?void 0:g.text)===null||y===void 0?void 0:y.textAlign),!((w=g==null?void 0:g.text)===null||w===void 0)&&w.textBaseline&&(d=(_=g==null?void 0:g.text)===null||_===void 0?void 0:_.textBaseline);const mt=Oo(i,r,g,f);let ft,Ft;if(p&&(ft=f.scenegraph.highPerformanceGetCell(i,r,!0),ft&&ft.role==="cell"&&ft.setAttributes({x:t,y:e,width:o,height:s,lineWidth:(T=(A=g==null?void 0:g.group)===null||A===void 0?void 0:A.lineWidth)!==null&&T!==void 0?T:void 0,fill:(x=(S=g==null?void 0:g.group)===null||S===void 0?void 0:S.fill)!==null&&x!==void 0?x:void 0,stroke:(M=(E=g==null?void 0:g.group)===null||E===void 0?void 0:E.stroke)!==null&&M!==void 0?M:void 0,strokeArrayWidth:mt??void 0,strokeArrayColor:(I=(L=g==null?void 0:g.group)===null||L===void 0?void 0:L.strokeArrayColor)!==null&&I!==void 0?I:void 0,cursor:(H=(D=g==null?void 0:g.group)===null||D===void 0?void 0:D.cursor)!==null&&H!==void 0?H:void 0,lineDash:(N=(O=g==null?void 0:g.group)===null||O===void 0?void 0:O.lineDash)!==null&&N!==void 0?N:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})),ft&&ft.role==="cell"||(ft=new de({x:t,y:e,width:o,height:s,lineWidth:(W=(U=g==null?void 0:g.group)===null||U===void 0?void 0:U.lineWidth)!==null&&W!==void 0?W:void 0,fill:(Y=(j=g==null?void 0:g.group)===null||j===void 0?void 0:j.fill)!==null&&Y!==void 0?Y:void 0,stroke:(rt=(Z=g==null?void 0:g.group)===null||Z===void 0?void 0:Z.stroke)!==null&&rt!==void 0?rt:void 0,strokeArrayWidth:mt??void 0,strokeArrayColor:(st=(J=g==null?void 0:g.group)===null||J===void 0?void 0:J.strokeArrayColor)!==null&&st!==void 0?st:void 0,cursor:(at=(ht=g==null?void 0:g.group)===null||ht===void 0?void 0:ht.cursor)!==null&&at!==void 0?at:void 0,lineDash:(_t=(lt=g==null?void 0:g.group)===null||lt===void 0?void 0:lt.lineDash)!==null&&_t!==void 0?_t:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),ft.role="cell",ft.col=i,ft.row=r,n==null||n.addCellGroup(ft)),c){let It=i,Ot=r;m&&(It=m.start.col,Ot=m.start.row),Ft=f.getCellIcons(It,Ot)}let St=0,Kt=0,At=0;if(Array.isArray(Ft)&&Ft.length!==0){const{leftIconWidth:It,rightIconWidth:Ot,absoluteRightIconWidth:qt}=ju(Ft,ft,m,f);St=It+Ot,Kt=It,At=Ot,ft.forEachChildren(gt=>{gt.role==="icon-left"?gt.setAttribute("x",gt.attribute.x+u[3]):gt.role==="icon-right"?gt.setAttribute("x",gt.attribute.x+o-Ot-u[1]):gt.role==="icon-absolute-right"&&gt.setAttribute("x",gt.attribute.x+o-qt-u[1])}),ft.forEachChildren(gt=>{d==="middle"?gt.setAttribute("y",(s-gt.AABBBounds.height())/2):d==="bottom"?gt.setAttribute("y",s-gt.AABBBounds.height()-u[2]):gt.setAttribute("y",u[0])}),ft._cellLeftIconWidth=Kt,ft._cellRightIconWidth=At}const Pt=f.getCellValue(i,r),Bt=Hm({x:u[3],y:u[0],width:o-u[1]-u[3]-St,height:s-u[0]-u[2],image:Pt,cursor:"pointer"});return Bt.name="image",Bt.keepAspectRatio=a,Bt.textAlign=h,Bt.textBaseline=d,a||l?Bt.resources&&Bt.resources.has(Bt.attribute.image)&&Bt.resources.get(Bt.attribute.image).state==="success"?(Bt.setAttribute("opacity",0),setTimeout(()=>{Bt.setAttribute("opacity",1),mE(l,a,u,h,d,Bt,ft,f),f.scenegraph.updateNextFrame()},0)):Bt.successCallback=()=>{mE(l,a,u,h,d,Bt,ft,f),f.scenegraph.updateNextFrame()}:Bt.resources&&Bt.resources.has(Bt.attribute.image)&&Bt.resources.get(Bt.attribute.image).state==="success"?Ld(ft,i,r,0,0,f):Bt.successCallback=()=>{Ld(ft,i,r,0,0,f)},Bt.failCallback=()=>{const It=Fn();Bt.image=It.damage_pic.svg},ft.appendChild(Bt),ft}function wI(n,t,e,i,r,o,s){let a=!1,l=null,u=null;const{width:h,height:d,isMerge:c}=Ru(s,r.table);if(h<e+o[1]+o[3]&&(l=e+o[1]+o[3],a=!0),d<i+o[2]+o[0]&&(u=i+o[2]+o[0],a=!0),a){if(typeof l=="number")if(c)for(let f=s.mergeStartCol;f<=s.mergeEndCol;f++)r.setColWidth(f,l/(s.mergeEndCol-s.mergeStartCol+1));else r.setColWidth(n,l);if(typeof u=="number")if(c)for(let f=s.mergeStartRow;f<=s.mergeEndRow;f++)r.setRowHeight(f,u/(s.mergeEndRow-s.mergeStartRow+1));else r.setRowHeight(t,u);return r.component.updateScrollBar(),!0}return!1}function Ld(n,t,e,i,r,o){var s,a,l,u,h,d,c,f,g,m,p,v;const b=n.getChildByName("image");if(!b)return;const C=typeof b.attribute.image!="string"&&b.attribute.image||((s=b.resources)===null||s===void 0?void 0:s.get(b.attribute.image).data);if(!C)return;const y=o._getCellStyle(t,e),w=(a=pt("textAlign",y,t,e,o))!==null&&a!==void 0?a:"left",_=(l=pt("textBaseline",y,t,e,o))!==null&&l!==void 0?l:"middle";let A;A=!((u=o.options.customConfig)===null||u===void 0)&&u.imageMargin?me((h=o.options.customConfig)===null||h===void 0?void 0:h.imageMargin):(d=me(pt("padding",y,t,e,o)))!==null&&d!==void 0?d:[0,0,0,0];const{width:T,height:S,isMerge:x}=Ru(n,o),E=(c=n.mergeStartCol)!==null&&c!==void 0?c:n.col,M=(f=n.mergeStartRow)!==null&&f!==void 0?f:n.row,L=(g=n.mergeEndCol)!==null&&g!==void 0?g:n.col,I=(m=n.mergeEndCol)!==null&&m!==void 0?m:n.row,D=(p=n._cellLeftIconWidth)!==null&&p!==void 0?p:0,H=(v=n._cellRightIconWidth)!==null&&v!==void 0?v:0;if(b.keepAspectRatio){const{width:O,height:N}=s0(C.width||C.videoWidth,C.height||C.videoHeight,T-(A[1]+A[3]),S-(A[0]+A[2])),U=Jw(0,0,T,S,O,N,w,_,A);for(let W=E;W<=L;W++)for(let j=M;j<=I;j++){const Y=o.scenegraph.getCell(W,j).getChildByName("image");Y==null||Y.setAttributes({x:U.x,y:U.y,width:O,height:N})}}else for(let O=E;O<=L;O++)for(let N=M;N<=I;N++){const U=o.scenegraph.getCell(O,N).getChildByName("image");U==null||U.setAttributes({x:D+A[3],y:A[0],width:T-A[1]-A[3]-H-D,height:S-A[0]-A[2]})}if(n.getChildByName("play-icon")){const{width:U,height:W}=Ru(n,o),j=Math.floor(Math.min(U-A[1]-A[3],W-A[2]-A[0])/2),Y=0+(U>b.attribute.width?b.attribute.x-0+b.attribute.width/2:U/2),Z=0+(W>b.attribute.height?b.attribute.y-0+b.attribute.height/2:W/2);for(let rt=E;rt<=L;rt++)for(let J=M;J<=I;J++)o.scenegraph.getCell(rt,J).getChildByName("play-icon").setAttributes({x:Y-j/2,y:Z-j/2,width:j,height:j})}n.forEachChildren(O=>{O.role==="icon-left"||(O.role==="icon-right"||O.role==="icon-absolute-right")&&O.setAttribute("x",O.attribute.x+i)}),n.forEachChildren(O=>{(O.type==="rect"||O.role&&O.role.startsWith("icon"))&&(_==="middle"?O.setAttribute("y",A[0]+(S-A[0]-A[2]-O.AABBBounds.height())/2):_==="bottom"?O.setAttribute("y",A[0]+S-A[0]-A[2]-O.AABBBounds.height()):O.setAttribute("y",A[0]))}),x&&t1(n.mergeStartCol,n.mergeEndCol,n.mergeStartRow,n.mergeEndRow,o)}function Ru(n,t){return n.role==="cell"&&et(n.mergeStartCol)&&et(n.mergeEndCol)&&et(n.mergeStartRow)&&et(n.mergeEndRow)?{width:t.getColsWidth(n.mergeStartCol,n.mergeEndCol),height:t.getRowsHeight(n.mergeStartRow,n.mergeEndRow),isMerge:!0}:{width:n.attribute.width,height:n.attribute.height,isMerge:!1}}function t1(n,t,e,i,r){for(let o=n;o<=t;o++)for(let s=e;s<=i;s++){const a=r.scenegraph.getCell(o,s);if(a){const l=a.getChildByName("image");l&&l.setAttributes({dx:-r.getColsWidth(a.mergeStartCol,o-1),dy:-r.getRowsHeight(a.mergeStartRow,s-1)});const u=a.getChildByName("play-icon");u&&u.setAttributes({dx:-r.getColsWidth(a.mergeStartCol,o-1),dy:-r.getRowsHeight(a.mergeStartRow,s-1)})}}}function mE(n,t,e,i,r,o,s,a){const l=o.resources.get(o.attribute.image).data,{col:u,row:h}=s;if(n&&!vE(o)&&wI(u,h,l.width,l.height,a.scenegraph,e,s),t||vE(o)){const{width:d,height:c,isMerge:f}=Ru(s,a),{width:g,height:m}=s0(l.width,l.height,d-e[1]-e[3],c-e[0]-e[2]),p=Jw(0,0,d,c,g,m,i,r,e);o.setAttributes({x:p.x,y:p.y,width:g,height:m}),f&&t1(s.mergeStartCol,s.mergeEndCol,s.mergeStartRow,s.mergeEndRow,a)}}function vE(n){const t=Fn();return n.attribute.image===t.damage_pic.svg}function SI(n,t,e){n.then(()=>{e(),t.scenegraph.updateNextFrame()}).catch(i=>{})}function mJ(n,t){var e,i;const r=this;if(r.shadowRoot&&r.shadowRoot.childrenCount&&(et(n.width)||et(n.height))){const o=r.shadowRoot.findChildrenByName("shadow-rect")[0];o&&o.setAttributes({width:(e=n.width)!==null&&e!==void 0?e:o.attribute.width,height:(i=n.height)!==null&&i!==void 0?i:o.attribute.height})}}function e1(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v){var b,C;let y,w=!1;if(ao(t)){if(i.scenegraph.highPerformanceGetCell(r,o).role!=="cell")return y;t=i.getCellValue(r,o),w=!0}if(n==="checkbox"&&e.tree)y=Gt.getFunction("createCheckboxCellGroup")(null,u,0,h,r,o,s,a,l,d,c,f,g,i,m,e,p,w,!0);else if(n==="text"||n==="link"||v){if(n==="link"){const S=t,x=i.getCellOriginValue(r,o),E=i._getCellStyle(r,o);n==="link"&&("templateLink"in e&&e.templateLink||!("linkDetect"in e)||!Me(e.linkDetect,{col:r,row:o,table:i,value:S,dataValue:x,cellHeaderPaths:void 0})||Xw.test(S))&&(m?(m.text.fill=pt("linkColor",E,r,o,i),m.group.cursor="pointer"):m={text:{fill:pt("linkColor",E,r,o,i)},group:{cursor:"pointer"}})}const{customElementsGroup:_,renderDefault:A}=bE(i,e,r,o,a,l,d,p,v);y=Gt.getFunction("createTextCellGroup")(i,t,u,0,h,r,o,s,a,l,d,c,f,g,_,A,m,p,w);const T=i.internalProps.layoutMap.getAxisConfigInPivotChart(r,o);if(T){const S=new(Gt.getComponent("axis"))(T,y.attribute.width,y.attribute.height,(b=T.__vtablePadding)!==null&&b!==void 0?b:d,i);y.clear(),y.appendChild(S.component),S.overlap()}else i.internalProps.layoutMap.isEmpty(r,o)?(y.setAttributes({fill:!1,stroke:!1}),y.clear()):i.internalProps.layoutMap.isAxisCell(r,o)&&y.clear()}else if(n==="image")y=Gt.getFunction("createImageCellGroup")(u,0,h,r,o,a,l,e.keepAspectRatio,e.imageAutoSizing,d,c,f,g,i,m,p,w);else if(n==="video")y=Gt.getFunction("createVideoCellGroup")(u,0,h,r,o,a,l,e.keepAspectRatio,e.imageAutoSizing,d,c,f,g,i,m,p,w);else if(n==="chart"){const _=i.internalProps.layoutMap.getChartInstance(r,o);y=Gt.getFunction("createChartCellGroup")(null,u,0,h,r,o,a,l,d,t,e.chartModule,i.internalProps.layoutMap.getChartSpec(r,o),_,(C=i.internalProps.layoutMap.getChartDataId(r,o))!==null&&C!==void 0?C:"data",i,m,i.internalProps.layoutMap.isShareChartSpec(r,o),w,i.internalProps.layoutMap.isNoChartDataRenderNothing(r,o))}else if(n==="progressbar"){const{customElementsGroup:_,renderDefault:A}=bE(i,e,r,o,a,l,d,p,v),T=i._getCellStyle(r,o),S=i.getCellOriginValue(r,o);y=Gt.getFunction("createTextCellGroup")(i,t,u,0,h,r,o,s,a,l,d,c,f,g,_,A,m,p,w);const x=Gt.getFunction("createProgressBarCell")(e,T,s,t,S,r,o,d,i,p);y.firstChild?y.insertBefore(x,y.firstChild):y.appendChild(x)}else if(n==="sparkline")y=Gt.getFunction("createSparkLineCellGroup")(null,u,0,h,r,o,a,l,d,i,m,w);else if(n==="checkbox"){const _="isAggregation"in i.internalProps.layoutMap&&i.internalProps.layoutMap.isAggregation(r,o),A=i.internalProps.layoutMap.isSeriesNumber(r,o);_&&A?y=Gt.getFunction("createTextCellGroup")(i,t,u,0,h,r,o,s,a,l,d,c,f,!1,void 0,!0,m,p,w):y=Gt.getFunction("createCheckboxCellGroup")(null,u,0,h,r,o,s,a,l,d,c,f,g,i,m,e,p,w,!1)}else n==="radio"?y=Gt.getFunction("createRadioCellGroup")(null,u,0,h,r,o,s,a,l,d,c,f,i,m,e,p):n==="switch"?y=Gt.getFunction("createSwitchCellGroup")(null,u,0,h,r,o,s,a,l,d,c,f,g,i,m,e,p,w):n==="button"&&(y=Gt.getFunction("createButtonCellGroup")(null,u,0,h,r,o,s,a,l,d,c,f,g,i,m,e,p,w));return y.onBeforeAttributeUpdate=mJ,y}function bE(n,t,e,i,r,o,s,a,l){let u,h=!0;if(l)u=l.elementsGroup,h=l.renderDefault;else if(!(a!=null&&a.isCustom&&!n.isCornerHeader(e,i))){let d,c;if(n.getCellLocation(e,i)!=="body"?(d=t==null?void 0:t.headerCustomRender,c=t==null?void 0:t.headerCustomLayout):(d=(t==null?void 0:t.customRender)||n.customRender,c=t==null?void 0:t.customLayout),c||d){const f=Xs(c,d,e,i,r,o,!1,n.isAutoRowHeight(i),s,a,n);u=f.elementsGroup,h=f.renderDefault}}return{customElementsGroup:u,renderDefault:h}}function Mn(n,t,e,i,r,o){var s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A;const T=e.scenegraph.highPerformanceGetCell(n,t,!0);if(T.role!=="cell"&&!i)return;const S=e.getCellLocation(n,t);let x,E,M,L,I=e.getCellValue(n,t),D=!1;if(e.internalProps.customMergeCell){const vt=e.getCustomMerge(n,t);if(vt){const{range:yt,text:mt,style:ft,customLayout:Ft,customRender:St}=vt;E=yt,x=E.start.col!==E.end.col||E.start.row!==E.end.row,I=mt,M=ft,(Ft||St)&&(L=Xs(Ft,St,yt.start.col,yt.start.row,e.getColsWidth(yt.start.col,yt.end.col),e.getRowsHeight(yt.start.row,yt.end.row),!1,e.isAutoRowHeight(t),[0,0,0,0],E,e)),D=!0}}let H=n,O=t;E&&(H=E.start.col,O=E.start.row);const N=S!=="body"?e.getHeaderDefine(H,O):e.getBodyColumnDefine(H,O);let U=S!=="body"||(N==null?void 0:N.dragOrder)||!!(N!=null&&N.icon)||!!(N!=null&&N.tree);E||!e.internalProps.enableTreeNodeMerge&&S==="body"&&!(N!=null&&N.mergeCell)||(E=e.getCellRange(n,t),x=E.start.col!==E.end.col||E.start.row!==E.end.row);let W=!1;if(e.internalProps.enableTreeNodeMerge&&x){const vt=e.getCellRawRecord(E.start.col,E.start.row),{vtableMergeName:yt,vtableMerge:mt}=vt??{};W=mt,mt&&(U=!0,e.options.groupTitleCustomLayout&&(L=Xs(e.options.groupTitleCustomLayout,void 0,E.start.col,E.start.row,e.getColsWidth(E.start.col,E.end.col),e.getRowsHeight(E.start.row,E.end.row),!1,e.isAutoRowHeight(t),[0,0,0,0],E,e)),e.options.groupTitleFieldFormat?I=e.options.groupTitleFieldFormat(vt,n,t,e):yt!==void 0&&(I=yt))}const j=M||e._getCellStyle(E?E.start.col:n,E?E.start.row:t),Y=(s=j.autoWrapText)!==null&&s!==void 0?s:e.internalProps.autoWrapText,Z=Qs(j,e,x?E.start.col:n,x?E.start.row:t,pt).theme;if(Z.group.cornerRadius=n0(n,t,e),!i&&!x&&!(N!=null&&N.customLayout||N!=null&&N.customRender||N!=null&&N.headerCustomLayout||N!=null&&N.headerCustomRender)&&(o||vJ(n,t,T,Y,U,e))){const vt=e.getColWidth(n),yt=e.getRowHeight(t),mt=Oo(n,t,Z,e);T.setAttributes({width:vt,height:yt,lineWidth:(l=(a=Z==null?void 0:Z.group)===null||a===void 0?void 0:a.lineWidth)!==null&&l!==void 0?l:void 0,fill:(h=(u=Z==null?void 0:Z.group)===null||u===void 0?void 0:u.fill)!==null&&h!==void 0?h:void 0,stroke:(c=(d=Z==null?void 0:Z.group)===null||d===void 0?void 0:d.stroke)!==null&&c!==void 0?c:void 0,strokeArrayWidth:mt??void 0,strokeArrayColor:(g=(f=Z==null?void 0:Z.group)===null||f===void 0?void 0:f.strokeArrayColor)!==null&&g!==void 0?g:void 0,cursor:(p=(m=Z==null?void 0:Z.group)===null||m===void 0?void 0:m.cursor)!==null&&p!==void 0?p:void 0,cornerRadius:(b=(v=Z==null?void 0:Z.group)===null||v===void 0?void 0:v.cornerRadius)!==null&&b!==void 0?b:0,lineDash:(y=(C=Z==null?void 0:Z.group)===null||C===void 0?void 0:C.lineDash)!==null&&y!==void 0?y:void 0,y:e.scenegraph.getCellGroupY(t)}),T.forEachChildren(Ft=>{Ft.setAttributes({dx:0,dy:0})});const ft=T.getChildByName("text");if(o&&ft){const Ft={textBaseline:"top"};ft.setAttributes(Z.text?Object.assign({},Z.text,Ft):Ft)}else if(ft){const Ft=e.getCellValue(n,t),{text:St,moreThanMaxCharacters:Kt}=kd(Ft,e),At=dn(n,t,e),Pt=j.lineClamp,Bt=(w=me(pt("padding",j,n,t,e)))!==null&&w!==void 0?w:[0,0,0,0],It=Z.text.textAlign;let Ot=0;Ot=It==="center"?Bt[3]+(vt-(Bt[1]+Bt[3]))/2:It==="right"?Bt[3]+vt-(Bt[1]+Bt[3]):Bt[3];const qt={text:St.length!==1||Y?St:St[0],moreThanMaxCharacters:Kt,maxLineWidth:vt-(Bt[1]+Bt[3]+At),textBaseline:"top",autoWrapText:Y,lineClamp:Pt,wordBreak:"break-word",heightLimit:yt-Math.floor(Bt[0]+Bt[2]),pickable:!1,dx:It==="left"?At:0,x:Ot};if(ft.setAttributes(Z.text?Object.assign({},Z.text,qt):qt),ft.attribute.text){const gt=Z.text.textBaseline,Ht=yt-(Bt[0]+Bt[2]);let bt=0;bt=gt==="middle"?Bt[0]+(Ht-ft.AABBBounds.height())/2:gt==="bottom"?Bt[0]+Ht-ft.AABBBounds.height():Bt[0],ft.setAttributes({y:bt})}}return T}if(!i&&T.role==="empty")return;const rt=W||D?"text":e.isHeader(n,t)?(_=e._getHeaderLayoutMap(n,t).headerType)!==null&&_!==void 0?_:"text":(A=e.getBodyColumnType(n,t))!==null&&A!==void 0?A:"text",J=Z._vtable.padding,st=Z.text.textAlign,ht=Z.text.textBaseline;let at,lt,_t;if(E?(lt=e.getColsWidth(E.start.col,E.end.col),_t=e.getRowsHeight(E.start.row,E.end.row)):(lt=e.getColWidth(n),_t=e.getRowHeight(t)),ao(I)?(T.removeAllChild(),SI(I,e,bJ.bind(null,{type:rt,value:I,define:N,table:e,col:n,row:t,cellWidth:lt,cellHeight:_t,oldCellGroup:T,padding:J,textAlign:st,textBaseline:ht,mayHaveIcon:U,addNew:i,range:E,customResult:L,customStyle:M}))):at=xI(rt,I,N,e,n,t,lt,_t,T,J,st,ht,U,i,Z,E,L),x){const{width:vt}=at.attribute,{height:yt}=at.attribute;at.contentWidth=vt,at.contentHeight=yt,r?_J(E,lt,_t,J,st,ht,e,at):TI(E,lt,_t,J,st,ht,e)}return at}function xI(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p){var v,b;if(ao(t)&&(t=i.getCellValue(r,o)),!f&&(l.row!==o||l.col!==r))return null;if(!f&&l.parent&&i.reactCustomLayout){const y=l.getChildByName("custom-container");if(y){const{col:w,row:_}=y;wt(w)&&wt(_)&&i.reactCustomLayout.removeCustomCell(w,_)}}const C=e1(n,t,e,i,r,o,i.getColWidth(r),s,a,f?i.scenegraph.getColGroup(r):l.parent,f?0:i.scenegraph.getCellGroupY(o),u,h,d,c,g,m,p);return!f&&l.parent&&(l.parent.insertAfter(C,l),l.parent.removeChild(l),l.release(!0),!((v=i.scenegraph)===null||v===void 0)&&v.proxy.cellCache.get(r)&&((b=i.scenegraph)===null||b===void 0||b.proxy.cellCache.set(r,C))),C}function vJ(n,t,e,i,r,o){var s;const a=o.getBodyColumnType(n,t),l=o.isAutoRowHeight(t),u=o.getCellValue(n,t);return!(o.isHeader(n,t)||e.role!=="cell"||a!=="text"||i||l||r||((s=e.firstChild)===null||s===void 0?void 0:s.type)!=="text"||ao(u))}function bJ(n){const{type:t,value:e,define:i,table:r,col:o,row:s,cellWidth:a,cellHeight:l,oldCellGroup:u,padding:h,textAlign:d,textBaseline:c,mayHaveIcon:f,addNew:g,range:m,customResult:p,customStyle:v}=n,b=v||r._getCellStyle(m?m.start.col:o,m?m.start.row:s),C=Qs(b,r,m?m.start.col:o,m?m.start.row:s,pt).theme;C.group.cornerRadius=n0(o,s,r),xI(t,e,i,r,o,s,a,l,u,h,d,c,f,g,C,m,p)}function TI(n,t,e,i,r,o,s){for(let a=n.start.col;a<=n.end.col;a++)for(let l=n.start.row;l<=n.end.row;l++){const u=s.scenegraph.highPerformanceGetCell(a,l,!0);if(u.role!=="cell")continue;n.start.row!==n.end.row&&u.contentHeight!==e&&wp(u,e,e,s.isAutoRowHeight(l),i,r,o,s),n.start.col!==n.end.col&&u.contentWidth!==t&&yp(u,t,e,0,s.isAutoRowHeight(l),i,r,o,s.scenegraph),u.contentWidth=t,u.contentHeight=e;const h=s.getRowHeight(l);tc(u,s.getColWidth(a),h,n,s)}}function _J(n,t,e,i,r,o,s,a){const{col:l,row:u}=a;n.start.row!==n.end.row&&a.contentHeight!==e&&wp(a,e,e,s.isAutoRowHeight(u),i,r,o,s),n.start.col!==n.end.col&&a.contentWidth!==t&&yp(a,t,e,0,s.isAutoRowHeight(u),i,r,o,s.scenegraph),a.contentWidth=t,a.contentHeight=e;const h=s.getRowHeight(u);tc(a,s.getColWidth(l),h,n,s)}function tc(n,t,e,i,r){var o,s;const{col:a,row:l}=n,u=-r.getColsWidth(i.start.col,a-1);let h=0;if(!((o=r.options.customConfig)===null||o===void 0)&&o._disableColumnAndRowSizeRound)for(let p=i.start.row;p<=l-1;p++)h-=r.getRowHeight(p);else h=-r.getRowsHeight(i.start.row,l-1);n.forEachChildren(p=>{var v,b,C,y,w,_;typeof p._dx=="number"?(p.skipMergeUpdate=!0,p.setAttributes({dx:((v=p._dx)!==null&&v!==void 0?v:0)+u}),p.skipMergeUpdate=!1):(p._dx=(b=p.attribute.dx)!==null&&b!==void 0?b:0,p.skipMergeUpdate=!0,p.setAttributes({dx:((C=p.attribute.dx)!==null&&C!==void 0?C:0)+u}),p.skipMergeUpdate=!1),typeof p._dy=="number"?(p.skipMergeUpdate=!0,p.setAttributes({dy:((y=p._dy)!==null&&y!==void 0?y:0)+h}),p.skipMergeUpdate=!1):(p._dy=(w=p.attribute.dy)!==null&&w!==void 0?w:0,p.skipMergeUpdate=!0,p.setAttributes({dy:((_=p.attribute.dy)!==null&&_!==void 0?_:0)+h}),p.skipMergeUpdate=!1)});const d=(s=n.attribute.strokeArrayWidth)!==null&&s!==void 0?s:n.attribute.lineWidth,c=Wt(d),f=[0,0,0,0];a===i.start.col&&(f[3]=c?d[3]:d),l===i.start.row&&(f[0]=c?d[0]:d),a===i.end.col&&(f[1]=c?d[1]:d),l===i.end.row&&(f[2]=c?d[2]:d);const g=t!==n.attribute.width,m=e!==n.attribute.height;return n.skipMergeUpdate=!0,n.setAttributes({width:t,height:e,strokeArrayWidth:f}),n.skipMergeUpdate=!1,n.mergeStartCol=i.start.col,n.mergeStartRow=i.start.row,n.mergeEndCol=i.end.col,n.mergeEndRow=i.end.row,{widthChange:g,heightChange:m}}function Sp(n,t,e,i){if(i.internalProps.customMergeCell){const r=i.getCustomMerge(n,t);if(r){const{range:o,text:s,style:a,customLayout:l,customRender:u}=r;if(l||u){const h=Xs(l,u,o.start.col,o.start.row,i.getColsWidth(o.start.col,o.end.col),i.getRowsHeight(o.start.row,o.end.row),!1,i.isAutoRowHeight(t),[0,0,0,0],o,i).elementsGroup;e.childrenCount>0&&h?e.insertBefore(h,e.firstChild):h&&e.appendChild(h);const d=i.getRowHeight(t),c=i.getColWidth(n),{width:f}=e.attribute,{height:g}=e.attribute;return e.contentWidth=f,e.contentHeight=g,tc(e,c,d,o,i),o}}}}function Ws(n){return!!(n.role==="cell"&&wt(n.mergeStartCol)&&wt(n.mergeStartRow)&&wt(n.mergeEndCol)&&wt(n.mergeEndRow))}const xb=new $s({}),qh=new Au({}),CJ=new Gs({});function yJ(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){const m=Li(n)?n.text:n,p=Qm(m).split(`
`)||[],v=g.getColsWidth(t,i),b=pt("size",r,t,e,g);let C=0;if(o){const y=pt("spaceBetweenTextAndIcon",r,t,e,g),w=v-(f[1]+f[3])-s-b-y;xb.setAttributes({text:{maxLineWidth:w,text:p,fontSize:a,fontStyle:l,fontWeight:u,fontFamily:h,lineHeight:d,wordBreak:"break-word",lineClamp:c},icon:{width:Math.floor(b/1.4),height:Math.floor(b/1.4)},box:{width:b,height:b},spaceBetweenTextAndIcon:y}),xb.render(),C=xb.AABBBounds.height()}else C=Math.max(b,p.length*d);return C}function wJ(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){var m;if(Wt(n)){let p=0;const v=g.getBodyColumnDefine(t,e),b=pt("spaceBetweenRadio",r,t,e,g),C=(m=v==null?void 0:v.radioDirectionInCell)!==null&&m!==void 0?m:"vertical";return C==="vertical"?n.forEach((y,w)=>{const _=Tb(y,t,e,i,r,o,s,a,l,u,h,d,c,f,g);p+=_,w!==n.length-1&&(p+=b)}):C==="horizontal"&&n.forEach(y=>{const w=Tb(y,t,e,i,r,o,s,a,l,u,h,d,c,f,g);p=Math.max(w,p)}),p}return Tb(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g)}function Tb(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){const m=Li(n)?n.text:n,p=Qm(m).split(`
`)||[],v=g.getColsWidth(t,i),b=pt("size",r,t,e,g);let C=pt("outerRadius",r,t,e,g);const y=wt(C)?2*C:b;let w=0;if(o){const _=pt("spaceBetweenTextAndIcon",r,t,e,g),A=v-(f[1]+f[3])-s-y-_;wt(C)||(C=Math.round(b/2)),qh.setAttributes({text:{maxLineWidth:A,text:p,fontSize:a,fontStyle:l,fontWeight:u,fontFamily:h,lineHeight:d,wordBreak:"break-word",lineClamp:c},circle:{outerRadius:C},spaceBetweenTextAndIcon:_}),qh.render(),w=qh.AABBBounds.height()}else w=Math.max(b,p.length*d);return w}function SJ(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){return pt("boxWidth",r,t,e,g)}function xJ(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){const m=Li(n)?n.text:n,p=Qm(m).split(`
`)||[],v=g.getColsWidth(t,i),b=pt("buttonPadding",r,t,e,g),C=pt("buttonLineWidth",r,t,e,g);let y=0;if(o){const w=v-(f[1]+f[3]);CJ.setAttributes({text:p,textStyle:{maxLineWidth:w,fontSize:a,fontStyle:l,fontWeight:u,fontFamily:h,lineHeight:d,wordBreak:"break-word",lineClamp:c},padding:b,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:C}}),qh.render(),y=qh.AABBBounds.height()}else y=p.length*d+2*b;return y}let TJ="",ty="quick";const AJ=new ie((n,t,e,i)=>{e(as)?i(as).to(CE).inSingletonScope():n(as).to(CE).inSingletonScope()});new ie((n,t,e,i)=>{e(as)?i(as).to(vu).inSingletonScope():n(as).to(vu).inSingletonScope()});const _E=new Map;function ey(n,t,e,i="normal"){const r=`${n}-${t}-${e}-${i}`,o=_E.get(r);if(o)return o;const s=(a={fontSize:n,fontFamily:e,fontWeight:t,fontStyle:i},new sn(Object.assign({defaultFontParams:{fontFamily:Gr.fontFamily,fontSize:Gr.fontSize},getTextBounds:zm,specialCharSet:`{}()//&-/: .,@%'"~…=——${sn.ALPHABET_CHAR_SET}${sn.ALPHABET_CHAR_SET.toUpperCase()}0123456789${TJ}`},{}),a));var a;return _E.set(r,s),s}class CE extends vu{_fastMeasure(t,e){const{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=e,a=ey(i,o,r,s).measure(t,ty);if(!et(a.fontBoundingBoxAscent)&&!et(a.fontBoundingBoxDescent)){const{ascent:l,descent:u}=this.measureTextBoundADscentEstimate(e);a.fontBoundingBoxAscent=l,a.fontBoundingBoxDescent=u}return a}measureTextWidth(t,e){return this._fastMeasure(t,e).width}measureText(t,e){return this._fastMeasure(t,e)}_measureTextWithoutAlignBaseline(t,e,i){return this._fastMeasure(t,e)}_measureTextWithAlignBaseline(t,e,i){return this._fastMeasure(t,e)}}class RJ{measureText(t,e){const{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=e;return ey(i,o,r,s).measure(t,ty)}measureTextWidth(t,e){const{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=e;return ey(i,o,r,s).measure(t,ty).width}clipText(t,e,i){if(t.length===0)return{str:"",width:0};let r=this.measureTextWidth(t,e);return r<=i?{str:t,width:r}:(r=this.measureTextWidth(t[0],e),r>i?{str:"",width:0}:this._clipText(t,e,i,0,t.length-1))}_clipText(t,e,i,r,o){const s=Math.floor((r+o)/2),a=t.substring(0,s+1),l=this.measureTextWidth(a,e);let u;if(l>i){if(a.length<=1)return{str:"",width:0};const h=t.substring(0,s);return u=this.measureTextWidth(h,e),u<=i?{str:h,width:u}:this._clipText(t,e,i,r,s)}if(l<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};const h=t.substring(0,s+2);return u=this.measureTextWidth(h,e),u>=i?{str:a,width:l}:this._clipText(t,e,i,s,o)}return{str:a,width:l}}clipTextWithSuffix(t,e,i,r){if(r==="")return this.clipText(t,e,i);if(t.length===0)return{str:"",width:0};const o=this.measureTextWidth(t,e);if(o<=i)return{str:t,width:o};const s=this.measureTextWidth(r,e);if(s>i)return{str:"",width:0};i-=s;const a=this._clipText(t,e,i,0,t.length-1);return a.str+=r,a.width+=s,a}}const AI=new RJ,yE=new ji({ignoreBuf:!0});function RI(n){return yE.initAttributes(Object.assign(Object.assign({},n),{ignoreBuf:!0})),yE.AABBBounds}const wE=new li({width:0,height:0,textConfig:[]});function Bn(n,t,e,i=!0,r){var o,s,a,l,u,h,d,c,f,g,m;typeof window<"u"&&window.performance.now();const p=[],v=[];if(r)for(let _=t;_<=e;_++)p[_]=n.getRowHeight(_);const b=n.internalProps.layoutMap;n.isPivotTable()&&(b.enableUseGetBodyCache(),b.enableUseHeaderPathCache()),n.defaultHeaderRowHeight,n.defaultHeaderColWidth;const C=n.defaultHeaderRowHeight==="auto"||Wt(n.defaultHeaderRowHeight)&&n.defaultHeaderRowHeight.some(_=>_==="auto"),y=n.isAutoRowHeight(t)||n.heightMode==="adaptive"&&n.options.autoHeightInAdaptiveMode!==!1,w=n.options.defaultRowHeight==="auto";if(y||C||w){t=t??0,e=e??n.rowCount-1,(t===0&&e===n.rowCount-1||i)&&n._clearRowRangeHeightsMap();for(let _=t;_<n.columnHeaderLevelCount;_++){let A=0,T=n.colCount-1;if((n.isPivotTable()&&!n.isPivotChart()||n.isPivotChart()&&!n.internalProps.layoutMap.indicatorsAsCol)&&BJ(n,_)&&!vi(n,n.rowHeaderLevelCount,_)&&(A=0,T=n.rowHeaderLevelCount),y||n.getDefaultRowHeight(_)==="auto"){const S=An(_,A,T,n);v[_]=Math.round(S),n.heightAdaptiveMode!=="only-body"&&r||n._setRowHeight(_,S)}}for(let _=n.rowCount-n.bottomFrozenRowCount;_<=e;_++)if(y||n.getDefaultRowHeight(_)==="auto"){const A=An(_,0,n.colCount-1,n);r?v[_]=Math.round(A):n._setRowHeight(_,A)}if(!(e<n.columnHeaderLevelCount||!y&&!w))if(n.internalProps.transpose||n.isPivotTable()&&!n.internalProps.layoutMap.indicatorsAsCol||n.options.customComputeRowHeight||!EJ(n,t))if(n.internalProps.transpose||n.isPivotTable()&&!n.internalProps.layoutMap.indicatorsAsCol)for(let _=Math.max(t,n.columnHeaderLevelCount);_<=e;_++){let A;A=MJ(n,_)?An(_,0,n.rowHeaderLevelCount,n):An(_,0,n.colCount-1,n),r?v[_]=Math.round(A):n._setRowHeight(_,A)}else for(let _=Math.max(t,n.columnHeaderLevelCount);_<=e;_++){const A=An(_,0,n.colCount-1,n);r?v[_]=Math.round(A):n._setRowHeight(_,A)}else{PJ(An(n.columnHeaderLevelCount,0,n.colCount-1,n),n.columnHeaderLevelCount,n.rowCount-1-n.bottomFrozenRowCount,n,r?v:void 0);for(let _=n.rowCount-n.bottomFrozenRowCount;_<=e;_++){const A=An(_,0,n.colCount-1,n);r?v[_]=Math.round(A):n._setRowHeight(_,A)}}}else if((n.heightMode==="adaptive"||n.autoFillHeight)&&n.clearRowHeightCache(),r)for(let _=t;_<=e;_++)v[_]=n.getRowHeight(_);if((t===0&&e===n.rowCount-1||i)&&n._clearRowRangeHeightsMap(),n.heightMode==="adaptive"){n._clearRowRangeHeightsMap();let _=n.tableNoFrameHeight,A=0,T=n.rowCount;if(n.heightAdaptiveMode==="only-body"){const E=n.getRowsHeight(0,n.columnHeaderLevelCount-1),M=n.isPivotChart()?n.getBottomFrozenRowsHeight():0;_=n.tableNoFrameHeight-E-M,A=n.columnHeaderLevelCount,T=n.isPivotChart()?n.rowCount-n.bottomFrozenRowCount:n.rowCount}let S=0;for(let E=A;E<T;E++)S+=r&&(o=v[E])!==null&&o!==void 0?o:n.getRowHeight(E);const x=_/S;for(let E=A;E<T;E++){let M;M=E===T-1?_-(r?v.reduce((L,I,D)=>D>=A&&D<=T-2?L+I:L,0):n.getRowsHeight(A,T-2)):Math.round((r&&(s=v[E])!==null&&s!==void 0?s:n.getRowHeight(E))*x),r?v[E]=M:n._setRowHeight(E,M,!1)}}else if(n.autoFillHeight){n._clearRowRangeHeightsMap();const _=n.tableNoFrameHeight;let A=0,T=0;for(let S=0;S<n.rowCount;S++){const x=r&&(a=v[S])!==null&&a!==void 0?a:n.getRowHeight(S);(S<n.columnHeaderLevelCount||n.isPivotChart()&&S>=n.rowCount-n.bottomFrozenRowCount)&&(T+=x),A+=x}if(n.scenegraph._dealAutoFillHeightOriginRowsHeight=A,A<_&&A-T>0){const S=n.columnHeaderLevelCount,x=n.isPivotChart()?n.rowCount-n.bottomFrozenRowCount:n.rowCount,E=(_-T)/(A-T);for(let M=S;M<x;M++){let L;L=M===x-1?_-T-(r?v.reduce((I,D,H)=>H>=S&&H<=x-2?I+D:I,0):n.getRowsHeight(S,x-2)):Math.round((r&&(l=v[M])!==null&&l!==void 0?l:n.getRowHeight(M))*E),r?v[M]=L:n._setRowHeight(M,L,!1)}}}if(r){for(let _=t;_<=e;_++){const A=(u=v[_])!==null&&u!==void 0?u:n.getRowHeight(_);et(A)&&n._setRowHeight(_,A)}for(let _=0;_<=n.frozenRowCount-1;_++){const A=n.getRowHeight(_);A!==((h=p[_])!==null&&h!==void 0?h:n.getRowHeight(_))&&n.scenegraph.updateRowHeight(_,A-((d=p[_])!==null&&d!==void 0?d:n.getRowHeight(_)),!0)}for(let _=n.rowCount-n.bottomFrozenRowCount;_<=n.rowCount-1;_++){const A=n.getRowHeight(_);A!==((c=p[_])!==null&&c!==void 0?c:n.getRowHeight(_))&&n.scenegraph.updateRowHeight(_,A-((f=p[_])!==null&&f!==void 0?f:n.getRowHeight(_)),!0)}for(let _=n.scenegraph.proxy.rowStart;_<=n.scenegraph.proxy.rowEnd;_++){const A=n.getRowHeight(_);A!==((g=p[_])!==null&&g!==void 0?g:n.getRowHeight(_))&&n.scenegraph.updateRowHeight(_,A-((m=p[_])!==null&&m!==void 0?m:n.getRowHeight(_)),!0)}}n.isPivotTable()&&(b.disableUseGetBodyCache(),b.disableUseHeaderPathCache())}function An(n,t,e,i){var r;if(!(i.isAutoRowHeight(n)||i.heightMode==="adaptive"&&i.options.autoHeightInAdaptiveMode!==!1)&&i.getDefaultRowHeight(n)!=="auto")return i.getDefaultRowHeight(n);let o;if(i.options.customComputeRowHeight){const a=i.options.customComputeRowHeight({row:n,table:i});if(typeof a=="number")return a;if(a!=="auto")return i.getDefaultRowHeight(n)}if(i.isPivotChart()&&n>=i.columnHeaderLevelCount&&n<i.rowCount-i.bottomFrozenRowCount)if(i.internalProps.layoutMap.indicatorsAsCol){const a=i.internalProps.layoutMap.getOptimunHeightForChart(n);if(a>0)return a}else{const a=i.getDefaultRowHeight(n);if(wt(a))return a}for(let a=t;a<=e;a++){const l=kJ(a,n,i);if(l&&(o=et(o)?Math.max(l.height,o):l.height,!l.renderDefault))continue;if(i.isPivotChart()){const h=i.internalProps.layoutMap.getAxisConfigInPivotChart(a,n);if(h){const d=Gt.getFunction("computeAxisComponentHeight")(h,i);if(typeof d=="number"){o=et(o)?Math.max(d,o):d;continue}}}if(i.isPivotChart()&&(i.isLeftFrozenColumn(a)&&i.isBottomFrozenRow(n)||i.isRightFrozenColumn(a)&&i.isBottomFrozenRow(n)))continue;const u=LJ(a,n,i.isHeader(a,n)?(r=i._getHeaderLayoutMap(a,n))===null||r===void 0?void 0:r.headerType:i.getBodyColumnType(a,n),i);o=et(o)?Math.max(u,o):u}if(et(o))return o;const s=i.getDefaultRowHeight(n);return wt(s)?s:i.defaultRowHeight}function EJ(n,t){var e,i,r;const{layoutMap:o}=n.internalProps,s=n.columnHeaderLevelCount;if((n.internalProps.autoWrapText||n.internalProps.enableLineBreak||n.isPivotChart())&&(n.isAutoRowHeight(t)||n.options.heightMode==="adaptive"))return!1;for(let a=0;a<n.colCount;a++){const l=o.getBody(a,s);if(l.cellType==="radio"||typeof l.style=="function"||typeof l.icon=="function"||!((e=l.define)===null||e===void 0)&&e.customRender||!((i=l.define)===null||i===void 0)&&i.customLayout||typeof((r=l.define)===null||r===void 0?void 0:r.icon)=="function")return!1;const u=n._getCellStyle(a,s);if(typeof u.padding=="function"||typeof u.fontSize=="function"||typeof u.lineHeight=="function"||u.autoWrapText===!0)return!1}return!0}function MJ(n,t){var e,i,r;const{layoutMap:o}=n.internalProps;if((n.internalProps.autoWrapText||n.internalProps.enableLineBreak)&&(n.isAutoRowHeight(t)||n.options.heightMode==="adaptive"))return!1;const s=o.getBody(n.rowHeaderLevelCount,t);if(typeof s.style=="function"||typeof s.icon=="function"||!((e=s.define)===null||e===void 0)&&e.customRender||!((i=s.define)===null||i===void 0)&&i.customLayout||typeof((r=s.define)===null||r===void 0?void 0:r.icon)=="function")return!1;const a=n._getCellStyle(n.rowHeaderLevelCount,t);return typeof a.padding!="function"&&typeof a.fontSize!="function"&&typeof a.lineHeight!="function"&&a.autoWrapText!==!0}function BJ(n,t){var e,i,r;const{layoutMap:o}=n.internalProps;if(n.internalProps.autoWrapText&&(n.isAutoRowHeight(t)||n.options.heightMode==="adaptive"))return!1;const s=o.getHeader(n.rowHeaderLevelCount,t);if(typeof s.style=="function"||typeof s.icons=="function"||!((e=s.define)===null||e===void 0)&&e.headerCustomRender||!((i=s.define)===null||i===void 0)&&i.headerCustomLayout||typeof((r=s.define)===null||r===void 0?void 0:r.icon)=="function")return!1;const a=n._getCellStyle(n.rowHeaderLevelCount,t);return typeof a.padding!="function"&&typeof a.fontSize!="function"&&typeof a.lineHeight!="function"&&a.autoWrapText!==!0}function PJ(n,t,e,i,r){if(!i.internalProps.useOneRowHeightFillAll){for(let o=t;o<=e;o++)r?r[o]=n:i._setRowHeight(o,n);i.internalProps.useOneRowHeightFillAll=!0}}function kJ(n,t,e){var i,r,o,s,a,l,u;const h=e.getCustomRender(n,t);let d=e.getCustomLayout(n,t);if(h||d){let c,f=1,g=0,m=!1,p=!1;(e.isHeader(n,t)||!((i=e.getBodyColumnDefine(n,t))===null||i===void 0)&&i.mergeCell||e.hasCustomMerge())&&(c=e.getCellRange(n,t),f=c.end.row-c.start.row+1);const v={col:(r=c==null?void 0:c.start.col)!==null&&r!==void 0?r:n,row:(o=c==null?void 0:c.start.row)!==null&&o!==void 0?o:t,dataValue:e.getCellOriginValue(n,t),value:e.getCellValue(n,t)||"",rect:DJ(n,t,e),table:e,originCol:n,originRow:t,forComputation:!0};if(d==="react-custom-layout"&&(d=((s=e.reactCustomLayout)===null||s===void 0?void 0:s.getCustomLayoutFunc(n,t))||Bd),pn(d)){const b=d(v);b.rootContainer?(b.rootContainer=Pd(b.rootContainer),o0(b.rootContainer,e.getColWidth(n),0),b.rootContainer.setStage(e.scenegraph.stage),g=(a=b.rootContainer.AABBBounds.height())!==null&&a!==void 0?a:0,m=b.renderDefault,p=b.enableCellPadding):(g=0,m=b.renderDefault,p=b.enableCellPadding)}else if(typeof h=="function"){const b=h(v);g=(l=b==null?void 0:b.expectedHeight)!==null&&l!==void 0?l:0,m=b==null?void 0:b.renderDefault}else g=(u=h==null?void 0:h.expectedHeight)!==null&&u!==void 0?u:0,m=h==null?void 0:h.renderDefault;if(p){const b=e._getCellStyle(n,t),C=me(pt("padding",b,n,t,e));g+=C[0]+C[2]}return{height:g/f,renderDefault:m}}}function LJ(n,t,e,i){var r,o,s,a;let l=0;const u=i.getCellValue(n,t),h=i._getCellStyle(n,t);let d=0,c=0;const f=[];let g=0;const m=[];let p=0,v=!1;if(i.getCellLocation(n,t)!=="body")v=!0;else{const D=i.getBodyColumnDefine(n,t);v=!!(D!=null&&D.icon)||!!(D!=null&&D.tree)||(D==null?void 0:D.dragOrder)}if(v){const D=i.getCellIcons(n,t);D==null||D.forEach(H=>{var O,N,U,W,j,Y,Z,rt,J,st;H.positionType!==Be.absoluteRight&&H.positionType!==Be.inlineFront&&H.positionType!==Be.inlineEnd?(c+=((O=H.width)!==null&&O!==void 0?O:0)+((N=H.marginLeft)!==null&&N!==void 0?N:0)+((U=H.marginRight)!==null&&U!==void 0?U:0),d=Math.max(d,(W=H.height)!==null&&W!==void 0?W:0)):H.positionType===Be.inlineFront?(f.push(H),g=Math.max(g,((j=H.height)!==null&&j!==void 0?j:0)+((Y=H.marginLeft)!==null&&Y!==void 0?Y:0)+((Z=H.marginRight)!==null&&Z!==void 0?Z:0))):H.positionType===Be.inlineEnd&&(m.push(H),p=Math.max(p,((rt=H.height)!==null&&rt!==void 0?rt:0)+((J=H.marginLeft)!==null&&J!==void 0?J:0)+((st=H.marginRight)!==null&&st!==void 0?st:0)))})}let b=1,C=n;if(i.isHeader(n,t)||!((r=i.getBodyColumnDefine(n,t))===null||r===void 0)&&r.mergeCell||i.hasCustomMerge()){const D=i.getCellRange(n,t);b=D.end.row-D.start.row+1,n=D.start.col,C=D.end.col}const y=me(pt("padding",h,n,t,i)),w=pt("fontSize",h,n,t,i),_=pt("fontStyle",h,n,t,i),A=pt("fontWeight",h,n,t,i),T=(o=pt("lineHeight",h,n,t,i))!==null&&o!==void 0?o:w,S=pt("fontFamily",h,n,t,i),x=pt("autoWrapText",h,n,t,i),E=pt("lineClamp",h,n,t,i),M=pt("underline",h,n,t,i),L=(s=pt("underlineOffset",h,n,t,i))!==null&&s!==void 0?s:0;let I;if(e!=="text"&&e!=="link"&&e!=="progressbar"&&e!=="checkbox"&&e!=="radio"&&e!=="switch"&&e!=="button")l=T;else if(e==="checkbox")l=yJ(u,n,t,C,h,x,c,w,_,A,S,T,E,y,i);else if(e==="radio")l=wJ(u,n,t,C,h,x,c,w,_,A,S,T,E,y,i);else if(e==="switch")l=SJ(u,n,t,C,h,x,c,w,_,A,S,T,E,y,i);else if(e==="button")l=xJ(u,n,t,C,h,x,c,w,_,A,S,T,E,y,i);else{I=u;const D=kd(I,i).text,H=i.getColsWidth(n,C);if(f.length||m.length)if(x){const O=Object.assign({text:u==null?void 0:u.toString(),fontFamily:S,fontSize:w,fontStyle:_,fontWeight:A,lineHeight:T});O.textBaseline="middle";const N=[...f.map(U=>Cp(U)),O,...m.map(U=>Cp(U))];wE.setAttributes({width:H-(y[1]+y[3])-c,height:0,textConfig:N}),l=wE.AABBBounds.height()}else l=0,D.forEach((O,N)=>{var U;!((U=i.options.customConfig)===null||U===void 0)&&U.multilinesForXTable&&N!==0||(N===0&&f.length?l+=Math.max(T,g):N===D.length-1&&m.length?l+=Math.max(T,p):l+=T)});else if(x){const O=dn(n,t,i),N=H-(y[1]+y[3])-c-O;l=(RI({maxLineWidth:N,text:D,fontSize:w,fontStyle:_,fontWeight:A,fontFamily:S,lineHeight:T,wordBreak:"break-word",whiteSpace:D.length!==1||x?"normal":"no-wrap",lineClamp:E}).height()||(typeof T=="number"?T:w))+(M?L:0)}else l=!((a=i.options.customConfig)===null||a===void 0)&&a.multilinesForXTable?T:D.length*T}return(Math.max(l,d)+y[0]+y[2])/b}function DJ(n,t,e){return{left:0,top:0,right:e.getColWidth(n),bottom:e.getRowHeight(t),width:e.getColWidth(n),height:0}}function Js(n,t){if(!t||!t.proxy)return{colStart:0,colEnd:0,rowStart:0,rowEnd:0};const{mergeStartCol:e,mergeEndCol:i,mergeStartRow:r,mergeEndRow:o,col:s,row:a}=n;return{colStart:e,colEnd:i,rowStart:r,rowEnd:o}}function IJ(n,t){const e=n.start.col,i=n.end.col,r=n.start.row,o=n.end.row;let s=e,a=i,l=r,u=o;for(let h=e;h<=i;h++)for(let d=r;d<=o;d++){const c=t.getCellRange(h,d);c&&(s=Math.min(s,c.start.col),a=Math.max(a,c.end.col),l=Math.min(l,c.start.row),u=Math.max(u,c.end.row))}return n.start.col=s,n.end.col=a,n.start.row=l,n.end.row=u,n}function SE(n,t,e,i){i||n.table._setRowHeight(t,n.table.getRowHeight(t)+e,!0);for(let s=0;s<n.table.colCount;s++){const a=n.getCell(s,t);if(a.role==="empty")continue;const l=vi(n.table,s,t);l&&l.start.col!==s||(EI(n,a,s,t,a.attribute.height+e,e,n.table.isHeader(s,t)),n.updateCellContentWhileResize(s,t))}let r=0,o=0;t<n.table.frozenRowCount?(r=t+1,o=n.table.frozenRowCount-1):t>=n.table.rowCount-n.table.bottomFrozenRowCount?(r=t+1,o=n.table.rowCount-1):(r=t+1,o=Math.min(n.proxy.rowEnd,n.table.rowCount-n.table.bottomFrozenRowCount-1));for(let s=0;s<n.table.colCount;s++)for(let a=r;a<=o;a++){const l=n.highPerformanceGetCell(s,a);l.role==="cell"&&l.setAttribute("y",l.attribute.y+e)}}function EI(n,t,e,i,r,o,s){t&&FJ(n,t,e,i,r,o)}function FJ(n,t,e,i,r,o,s){var a,l,u,h,d;if(t.attribute.height===r&&!t.needUpdateHeight)return;t.needUpdateHeight=!1,t.setAttribute("height",r);const c=(a=n.table.getCellRawRecord(e,i))===null||a===void 0?void 0:a.vtableMerge,f=!!n.table.getCustomMerge(e,i),g=c||f?"text":n.table.isHeader(e,i)?(l=n.table._getHeaderLayoutMap(e,i).headerType)!==null&&l!==void 0?l:"text":(u=n.table.getBodyColumnType(e,i))!==null&&u!==void 0?u:"text";if(g==="progressbar"){const m=n.table.getBodyColumnDefine(e,i),p=n.table._getCellStyle(e,i),v=n.table.getCellValue(e,i),b=n.table.getCellOriginValue(e,i),C=me(pt("padding",p,e,i,n.table));let y;m!=null&&m.mergeCell&&(y=n.table.getCellRange(e,i));const w=Gt.getFunction("createProgressBarCell")(m,p,t.attribute.width,v,b,e,i,C,n.table,y),_=t.getChildByName("progress-bar");t.insertBefore(w,_),t.removeChild(_),_.removeAllChild(),_.release(),xE(t,r,o,n.table.isAutoRowHeight(i),!0,n.table)}else if(g==="sparkline"){t.removeAllChild();const m=n.table._getCellStyle(e,i),p=me(pt("padding",m,e,i,n.table));Gt.getFunction("createSparkLineCellGroup")(t,t.parent,t.attribute.x,t.attribute.y,e,i,t.attribute.width,t.attribute.height,p,n.table,Qs(m,n.table,e,i,pt).theme,!1)}else if(g==="image"||g==="video")Ld(t,e,i,0,o,n.table);else if(((h=t.firstChild)===null||h===void 0?void 0:h.name)==="axis")(d=t.firstChild)===null||d===void 0||d.originAxis.resize(t.attribute.width,t.attribute.height);else{let m=!0;const p=t.getChildByName(ro)||t.getChildByName(_p);if(p){let v;t.removeChild(p);const b=Sp(e,i,t,n.table);if(b)for(let C=b.start.row;C<=b.end.row;C++){if(C===i)continue;const y=n.getCell(e,C),w=y.getChildByName(ro)||y.getChildByName(_p);w.removeAllChild(),y.removeChild(w),Sp(e,C,y,n.table)}else{let C,y;const w=n.table.getCellLocation(e,i),{vtableMerge:_}=n.table.getCellRawRecord(e,i)||{};if(_&&n.table.options.groupTitleCustomLayout)y=n.table.options.groupTitleCustomLayout;else if(w!=="body"){const A=n.table.getHeaderDefine(e,i);C=A==null?void 0:A.headerCustomRender,y=A==null?void 0:A.headerCustomLayout}else{const A=n.table.getBodyColumnDefine(e,i);C=(A==null?void 0:A.customRender)||n.table.customRender,y=A==null?void 0:A.customLayout}if((C||y)&&Ws(t))for(let A=t.mergeStartCol;A<=t.mergeEndCol;A++)for(let T=t.mergeStartRow;T<=t.mergeEndRow;T++)T!==i&&n.updateCellContent(A,T);if(y||C){const A=n.table._getCellStyle(e,i),T=me(pt("padding",A,e,i,n.table));let S=t.attribute.width,x=t.attribute.height;Ws(t)&&(S=n.table.getColsWidth(t.mergeStartCol,t.mergeEndCol),x=n.table.getRowsHeight(t.mergeStartRow,t.mergeEndRow));const E=Xs(y,C,e,i,S,x,!1,n.table.isAutoRowHeight(i),T,Ws(t)?{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}}:void 0,n.table);v=E.elementsGroup,m=E.renderDefault}t.childrenCount>0&&v?t.insertBefore(v,t.firstChild):v&&t.appendChild(v)}}xE(t,r,o,n.table.isAutoRowHeight(i),m,n.table)}}function xE(n,t,e,i,r,o){if(Ws(n)){t=0;for(let h=n.mergeStartRow;h<=n.mergeEndRow;h++)t+=o.getRowHeight(h);const{colStart:s,colEnd:a,rowStart:l,rowEnd:u}=Js(n,o.scenegraph);for(let h=s;h<=a;h++)for(let d=l;d<=u;d++){const c=o.scenegraph.getCell(h,d);if(c.role!=="cell")continue;if(c.forEachChildren(p=>{p.setAttributes({dx:0,dy:0})}),r){const p=o._getCellStyle(s,l),v=me(pt("padding",p,h,d,o));wp(c,t,e,i,v,p.textAlign,p.textBaseline,o)}const f=o.getRowHeight(d),g=o.getColWidth(h);c.contentHeight=t;const{widthChange:m}=tc(c,g,f,{start:{col:n.mergeStartCol,row:n.mergeStartRow},end:{col:n.mergeEndCol,row:n.mergeEndRow}},o);m&&(c.needUpdateWidth=!0)}}else{const s=o._getCellStyle(n.col,n.row),a=me(pt("padding",s,n.col,n.row,o));wp(n,t,e,i,a,s.textAlign,s.textBaseline,o)}}function OJ(n,t,e,i){i||n.table._setColWidth(t,n.table.getColWidth(t)+e,!0);const r=n.getColGroup(t,!0),o=n.getColGroupInRightTopCorner(t);r&&!o&&Sl(r,e,"col-corner",n),o&&Sl(o,e,"right-top",n);const s=n.getColGroup(t);s&&Sl(s,e,"row-body",n);const a=n.getColGroupInLeftBottomCorner(t);a&&Sl(a,e,"left-bottom",n);const l=n.getColGroupInBottom(t);l&&Sl(l,e,"bottom",n);const u=n.getColGroupInRightBottomCorner(t);u&&Sl(u,e,"right-bottom",n),t<n.frozenColCount?(n.cornerHeaderGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)}),n.rowHeaderGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)})):(n.colHeaderGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)}),n.bodyGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)})),a&&n.leftBottomCornerGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)}),l&&n.bottomFrozenGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)}),u&&n.rightBottomCornerGroup.forEachChildrenSkipChild((h,d)=>{h.col>t&&h.setAttribute("x",h.attribute.x+e)})}function Sl(n,t,e,i){var r,o,s,a,l,u,h;let d=!1;const c=(r=n==null?void 0:n.attribute.width)!==null&&r!==void 0?r:0;if(n==null||n.setAttribute("width",c+t),n==null||n.forEachChildren((f,g)=>{if(HJ(i,f,f.col,f.row,c,c+t,t,e!=="row-body"||f.col<i.table.rowHeaderLevelCount,i.table.internalProps.autoWrapText)){const m=vi(i.table,f.col,f.row);if(m&&m.end.row-m.start.row)for(let p=m.start.row;p<=m.end.row;p++)AE(i,p);else AE(i,f.row);d=!0}}),d){let f,g,m,p=0;for(let v=0;v<i.table.colCount;v++){if(e==="col-corner"?(m=0,f=i.getColGroup(v,!0),g=(o=i.colHeaderGroup.attribute.height)!==null&&o!==void 0?o:0):e==="row-body"?(m=i.table.frozenRowCount,f=i.getColGroup(v,!1),g=(s=i.bodyGroup.attribute.height)!==null&&s!==void 0?s:0):e==="bottom"?(m=i.table.rowCount-i.table.bottomFrozenRowCount,f=i.getColGroupInBottom(v),g=(a=i.bottomFrozenGroup.attribute.height)!==null&&a!==void 0?a:0):e==="left-bottom"?(m=i.table.rowCount-i.table.bottomFrozenRowCount,f=i.getColGroupInLeftBottomCorner(v),g=(l=i.leftBottomCornerGroup.attribute.height)!==null&&l!==void 0?l:0):e==="right-top"?(m=0,f=i.getColGroupInRightTopCorner(v),g=(u=i.rightTopCornerGroup.attribute.height)!==null&&u!==void 0?u:0):e==="right-bottom"&&(m=i.table.rowCount-i.table.bottomFrozenRowCount,f=i.getColGroupInRightBottomCorner(v),g=(h=i.rightBottomCornerGroup.attribute.height)!==null&&h!==void 0?h:0),!f)continue;let b=0;f.forEachChildren(C=>{var y;C.setAttribute("y",b),b+=(y=i.table.getRowHeight(C.row))!==null&&y!==void 0?y:0}),p=b}i.updateContainerHeight(m,p-g);for(let v=0;v<i.table.frozenColCount;v++){const b=i.getColGroupInLeftBottomCorner(v);let C=0;b==null||b.forEachChildren(y=>{y.setAttribute("y",C),C+=i.table.getRowHeight(y.row)})}for(let v=i.table.colCount-i.table.rightFrozenColCount;v<i.table.colCount;v++){const b=i.getColGroupInRightBottomCorner(v);let C=0;b==null||b.forEachChildren(y=>{y.setAttribute("y",C),C+=i.table.getRowHeight(y.row)})}for(let v=i.table.frozenColCount;v<i.table.colCount-i.table.rightFrozenColCount;v++){const b=i.getColGroupInBottom(v);let C=0;b==null||b.forEachChildren(y=>{y.setAttribute("y",C),C+=i.table.getRowHeight(y.row)})}}}function HJ(n,t,e,i,r,o,s,a,l){var u,h,d,c,f,g,m;if(t.attribute.width===o&&!t.needUpdateWidth)return!1;t.needUpdateWidth=!1,t.setAttribute("width",o);const p=t;if(!p)return!1;const v=n.table.isAutoRowHeight(i),b=(u=n.table.getCellRawRecord(e,i))===null||u===void 0?void 0:u.vtableMerge,C=!!n.table.getCustomMerge(e,i),y=b||C?"text":n.table.isHeader(e,i)?(h=n.table._getHeaderLayoutMap(e,i).headerType)!==null&&h!==void 0?h:"text":(d=n.table.getBodyColumnType(e,i))!==null&&d!==void 0?d:"text";let w=!1;if(y==="progressbar"){const _=n.table.getBodyColumnDefine(e,i),A=n.table._getCellStyle(e,i),T=n.table.getCellValue(e,i),S=n.table.getCellOriginValue(e,i),x=me(pt("padding",A,e,i,n.table));let E;_!=null&&_.mergeCell&&(E=n.table.getCellRange(e,i));const M=Gt.getFunction("createProgressBarCell")(_,A,p.attribute.width,T,S,e,i,x,n.table,E),L=p.getChildByName("progress-bar");p.insertBefore(M,L),p.removeChild(L),L.removeAllChild(),L.release();const I=TE(p,o,s,v,!0,n.table);w=w||I}else if(y==="sparkline"){p.removeAllChild();const _=n.table._getCellStyle(e,i),A=me(pt("padding",_,e,i,n.table));Gt.getFunction("createSparkLineCellGroup")(p,p.parent,p.attribute.x,p.attribute.y,e,i,p.attribute.width,p.attribute.height,A,n.table,Qs(_,n.table,e,i,pt).theme,!1)}else if(y==="image"||y==="video")Ld(p,e,i,s,0,n.table);else if(((c=p.firstChild)===null||c===void 0?void 0:c.name)==="axis"){const _=n.table.internalProps.layoutMap.getAxisConfigInPivotChart(e,i),A=n.table._getCellStyle(e,i),T=me(pt("padding",A,e,i,n.table));if(_){const S=new(Gt.getComponent("axis"))(_,p.attribute.width,p.attribute.height,(f=_.__vtablePadding)!==null&&f!==void 0?f:T,n.table);p.clear(),p.appendChild(S.component),S.overlap()}}else if(((g=t.firstChild)===null||g===void 0?void 0:g.name)==="axis")(m=t.firstChild)===null||m===void 0||m.originAxis.resize(t.attribute.width,t.attribute.height);else{let _=!0;const A=t.getChildByName(ro)||t.getChildByName(_p);if(A){let S;t.removeChild(A);const x=Sp(e,i,t,n.table);if(x)for(let E=x.start.col;E<=x.end.col;E++){if(E===e)continue;const M=n.getCell(E,i),L=M.getChildByName(ro)||M.getChildByName(_p);L.removeAllChild(),M.removeChild(L),Sp(E,i,M,n.table)}else{let E,M;const L=n.table.getCellLocation(e,i),{vtableMerge:I}=n.table.getCellRawRecord(e,i)||{};if(I&&n.table.options.groupTitleCustomLayout)M=n.table.options.groupTitleCustomLayout;else if(L!=="body"){const D=n.table.getHeaderDefine(e,i);E=D==null?void 0:D.headerCustomRender,M=D==null?void 0:D.headerCustomLayout}else{const D=n.table.getBodyColumnDefine(e,i);E=(D==null?void 0:D.customRender)||n.table.customRender,M=D==null?void 0:D.customLayout}if((E||M)&&Ws(p)){for(let D=p.mergeStartCol;D<=p.mergeEndCol;D++)if(D!==e)for(let H=p.mergeStartRow;H<=p.mergeEndRow;H++)n.updateCellContent(D,H)}if(M||E){const D=n.table._getCellStyle(e,i),H=me(pt("padding",D,e,i,n.table));let O=p.attribute.width,N=p.attribute.height;Ws(p)&&(O=n.table.getColsWidth(p.mergeStartCol,p.mergeEndCol),N=n.table.getRowsHeight(p.mergeStartRow,p.mergeEndRow));const U=Xs(M,E,e,i,O,N,!1,n.table.isAutoRowHeight(i),H,Ws(p)?{start:{col:p.mergeStartCol,row:p.mergeStartRow},end:{col:p.mergeEndCol,row:p.mergeEndRow}}:void 0,n.table);S=U.elementsGroup,_=U.renderDefault,w=!0}t.childrenCount>0&&S?t.insertBefore(S,t.firstChild):S&&t.appendChild(S)}}const T=TE(p,o,s,v,_,n.table);w=w||T}return l||(l=n.table._getCellStyle(e,i).autoWrapText),!(!v||!l)&&w}function TE(n,t,e,i,r,o){if(Ws(n)){t=0;let h=!1;for(let p=n.mergeStartCol;p<=n.mergeEndCol;p++)t+=o.getColWidth(p);let d=0;for(let p=n.mergeStartRow;p<=n.mergeEndRow;p++)d+=o.getRowHeight(p);const{colStart:c,colEnd:f,rowStart:g,rowEnd:m}=Js(n,o.scenegraph);for(let p=c;p<=f;p++)for(let v=g;v<=m;v++){if(p===n.col&&v!==n.row)continue;const b=o.scenegraph.getCell(p,v);if(b.role!=="cell")continue;b.forEachChildren(A=>{A.setAttributes({dx:0,dy:0})});let C=!1;if(r){const A=o._getCellStyle(c,g),T=me(pt("padding",A,p,v,o)),S=A.textAlign,x=A.textBaseline;C=yp(b,t,d,e,i,T,S,x,o.scenegraph);const E=dn(b.col,b.row,o);if(E){const M=b.getChildByName("text"),L=b.getChildByName("expand")||b.getChildByName("collapse");(L==null?void 0:L.role)!=="icon-left"&&M&&M.setAttribute("dx",E)}}const y=o.getRowHeight(v),w=o.getColWidth(p);b.contentWidth=t;const{heightChange:_}=tc(b,w,y,{start:{col:n.mergeStartCol,row:n.mergeStartRow},end:{col:n.mergeEndCol,row:n.mergeEndRow}},o);_&&(b.needUpdateHeight=!0),h=h||C}return h}const s=o._getCellStyle(n.col,n.row),a=me(pt("padding",s,n.col,n.row,o)),l=s.textAlign,u=s.textBaseline;return yp(n,t,o.getRowHeight(n.row),e,i,a,l,u,o.scenegraph)}function AE(n,t){const e=Math.round(An(t,0,n.table.colCount-1,n.table));n.table._setRowHeight(t,e,!0);for(let i=0;i<n.table.colCount;i++){const r=e,o=n.highPerformanceGetCell(i,t);o.role!=="empty"&&EI(n,o,i,t,r,r-o.attribute.height,n.table.isHeader(i,t))}}var rn;(function(n){n.dropDown="dropDown",n.contextmenu="contextmenu",n.custom="custom"})(rn||(rn={}));const Je={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};let zJ=class{constructor(t){this._table=t,this._menuInstance=new de({x:0,y:0,fill:Je.bgColor,stroke:Je.borderColor,cornerRadius:Je.cornerRadius,lineWidth:Je.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:rn.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(t){t.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(t,e,i,r,o,s){if(o===rn.dropDown&&this.checkDropDownMenuChange(i,r)){const a=this.getMenuInfo(i,r,o);if(!a)return;const{menuInfo:l,highlightIndex:u}=a;this.updateMenuInfo(i,r,o,l,u),this.updateMenuInstance(l,u)}else if(o===rn.contextmenu&&this.checkContextMenuChange(t,e)){const a=this.getMenuInfo(i,r,o);if(!a)return;const{menuInfo:l,highlightIndex:u}=a;this.updateMenuInfo(i,r,o,l,u),this.updateMenuInstance(l,u)}this.updatePosition(t-this._table.scenegraph.x,e-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(t,e,i,r,o){this._menuInfo.col=t,this._menuInfo.row=e,this._menuInfo.type=i,this._menuInfo.menuInfo=r,this._menuInfo.highlightIndex=o}checkDropDownMenuChange(t,e){const{type:i,col:r,row:o}=this._menuInfo;return i!==rn.dropDown||t!==r||e!==o}checkContextMenuChange(t,e){var i;const{type:r,menuInfo:o}=this._menuInfo;return r!==rn.contextmenu||o!==((i=this._table.internalProps.menu)===null||i===void 0?void 0:i.contextMenuItems)}updateMenuInstance(t,e){this._menuInstance.removeAllChild();let i=Je.menuPadding;const r=Je.menuPadding;let o=0;t.forEach((s,a)=>{var l,u;const h=e===a;let d,c;typeof s=="string"?c=s:typeof s=="object"&&(c=s.text,d=h?s.selectedIcon:s.icon);const f=new de({y:i,x:r,height:Je.lineHeight,fill:Je.bgColor});f.role="menu-item",this._menuInstance.appendChild(f),f.stateProxy=m=>m==="hover"?{fill:Je.hoverBgColor}:{fill:Je.bgColor},f.addEventListener("pointerenter",m=>{f.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),f.addEventListener("pointerleave",m=>{f.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});const g=new ji({x:Je.menuItemPadding,y:Je.menuItemPadding,fill:h?Je.highlightColor:Je.color,text:c,textBaseline:"top",fontSize:Je.fontSize,fontFamily:Je.fontFamily,pickable:!1,maxLineWidth:Je.maxLineWidth,ellipsis:"…"});if(f.addChild(g),d){g.AABBBounds.height();const m=(l=d.width)!==null&&l!==void 0?l:16,p=(u=d.height)!==null&&u!==void 0?u:16,v=new tl({x:Je.menuItemPadding,y:(Je.lineHeight-p)/2,width:m,height:p,image:d.svg,pickable:!1});v.role="menu-icon",f.insertBefore(v,g),g.setAttribute("x",m+Je.menuItemPadding)}o=Math.max(f.AABBBounds.width(),o),i+=Je.lineHeight}),this._menuInstance.setAttributes({width:o+2*Je.menuItemPadding+2*Je.menuPadding,height:i+Je.menuPadding}),this._menuInstance.forEachChildren(s=>{s.setAttribute("width",o+2*Je.menuItemPadding)})}updatePosition(t,e){this._menuInstance.setAttributes({x:this._menuInfo.type===rn.dropDown?t-this._menuInstance.attribute.width:t,y:e}),this._menuInfo.x=rn.dropDown?t-this._menuInstance.attribute.width:t,this._menuInfo.y=e}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(t,e,i){var r;if(i===rn.dropDown){let o=this._table.globalDropDownMenu;o=this._table._getHeaderLayoutMap(t,e).dropDownMenu,typeof o=="function"&&(o=o({row:e,col:t,table:this._table}));let s=-1;if(Array.isArray(o)){for(let a=0;a<o.length;a++)if(this._table._dropDownMenuIsHighlight(t,e,a)){s=a;break}}return{menuInfo:o,highlightIndex:s}}if(i===rn.contextmenu){const o=(r=this._table.internalProps.menu)===null||r===void 0?void 0:r.contextMenuItems;let s;if(Array.isArray(o))s=o;else if(typeof o=="function"){const{field:a}=this._table.isHeader(t,e)?this._table.getHeaderDefine(t,e):this._table.getBodyColumnDefine(t,e);s=o(a,e,t)}return{menuInfo:s,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",t=>{const{target:e}=t;if(e&&e.role==="menu-item"){const i=this.getEventInfo(e),r=this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type),o=Object.assign(i,r);o.event=t.nativeEvent,this._table.fireListeners(ut.DROPDOWN_MENU_CLICK,o)}})}getEventInfo(t){const e=t.parent;let i=0;e.forEachChildren((s,a)=>s===t&&(i=a-1,!0));const r=typeof this._menuInfo.menuInfo[i]=="string"?this._menuInfo.menuInfo[i]:this._menuInfo.menuInfo[i].text,o=typeof this._menuInfo.menuInfo[i]=="string"?r:this._menuInfo.menuInfo[i].menuKey||r;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:i,highlight:i===this._menuInfo.highlightIndex,text:r,menuKey:o}}get bounds(){return this._menuInstance.globalAABBBounds}};const Ab=Fn();class NJ{constructor(){const t=Ab.drillDown;this.icon=new tl({x:-1e3,y:-1e3,image:t.svg,width:t.width,height:t.height,dx:-t.width/2,dy:-t.height/2,visible:!1,funcType:t.funcType,cursor:t.cursor}),this.icon.role="icon-drill"}appand(t){t.appendChild(this.icon)}update(t,e,i,r,o,s){if(!t||r&&o)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void s.updateNextFrame();const a=Ab.drillDown,l=Ab.drillUp;this.icon.setAttributes({x:e,y:i,image:r?a.svg:l.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),s.updateNextFrame()}}class WJ{constructor(t){const e=t.theme.dragHeaderSplitLine.lineWidth,i=t.theme.dragHeaderSplitLine.lineColor,r=t.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=yu({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:i}),this.columnMoverLine=ln({visible:!1,pickable:!1,stroke:i,lineWidth:e,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=Ge({visible:!1,pickable:!1,fill:r,x:0,y:0,width:0,height:0}),this.table=t}appand(t){t.appendChild(this.columnMoverLabel),t.appendChild(this.columnMoverLine),t.appendChild(this.columnMoverBack)}show(t,e,i){const r=this.table.getCellLocation(t,e),o=vi(this.table,t,e);o&&(t=o.start.col,e=o.start.row);let s=0,a=0,l=0,u=0,h=0,d=0,c=0,f=0,g=Math.PI;const m=[];return r==="columnHeader"?(s=this.table.getColsWidth(0,t-1)-this.table.stateManager.scroll.horizontalBarPos,a=this.table.getRowsHeight(0,this.table.frozenRowCount-1),u=this.table.tableNoFrameHeight,l=o?this.table.getColsWidth(o.start.col,o.end.col):this.table.getColWidth(t),h=s-i,c=s+l,f=2,m.push({x:0,y:0}),m.push({x:0,y:this.table.tableNoFrameHeight})):(r==="rowHeader"||this.table.internalProps.layoutMap.isSeriesNumberInBody(t,e))&&(a=this.table.getRowsHeight(0,e-1)-this.table.stateManager.scroll.verticalBarPos,s=this.table.getColsWidth(0,this.table.frozenColCount-1),l=this.table.tableNoFrameWidth,u=o?this.table.getRowsHeight(o.start.row,o.end.row):this.table.getRowHeight(e),d=a-i,c=2,f=a+u,g=Math.PI/2,m.push({x:0,y:0}),m.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:s-h,y:a-d,width:l,height:u,dx:h,dy:d}),this.columnMoverLine.setAttributes({x:c,y:f,visible:!0,points:m}),this.columnMoverLabel.setAttributes({visible:!0,x:c,y:f,angle:g}),{backX:s-h,lineX:c,backY:a-d,lineY:f}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(t,e,i,r){typeof t=="number"&&typeof e=="number"?(this.columnMoverLabel.setAttribute("x",e),this.columnMoverLine.setAttribute("x",e),this.columnMoverBack.setAttribute("x",t)):typeof i=="number"&&typeof r=="number"&&(this.columnMoverLabel.setAttribute("y",r),this.columnMoverLine.setAttribute("y",r),this.columnMoverBack.setAttribute("y",i))}updateStyle(){const t=this.table.theme.dragHeaderSplitLine.lineWidth,e=this.table.theme.dragHeaderSplitLine.lineColor,i=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:e}),this.columnMoverLine.setAttributes({stroke:e,lineWidth:t}),this.columnMoverBack.setAttributes({fill:i})}}function gf(n,t,e){if(e)return Math.min(t.tableNoFrameWidth,t.getAllColsWidth())-t.getColsWidth(n,t.colCount-1);let i=t.getColsWidth(0,n);return n>=t.frozenColCount&&(i-=t.scrollLeft),i}function RE(n,t,e){if(e)return Math.min(t.tableNoFrameWidth,t.getAllRowsHeight())-t.getRowsHeight(n,t.rowCount-1);let i=t.getRowsHeight(0,n);return n>=t.frozenRowCount&&(i-=t.scrollTop),i}class UJ{constructor(t){var e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y;this.table=t;const w=this.table.theme;this.createScrollBar();const _=(e=w.columnResize)===null||e===void 0?void 0:e.lineColor,A=(i=w.columnResize)===null||i===void 0?void 0:i.lineWidth,T=(r=w.columnResize)===null||r===void 0?void 0:r.bgColor,S=(o=w.columnResize)===null||o===void 0?void 0:o.width,x=(a=(s=w.columnResize)===null||s===void 0?void 0:s.labelVisible)===null||a===void 0||a,E=(l=w.columnResize)===null||l===void 0?void 0:l.labelColor,M=(u=w.columnResize)===null||u===void 0?void 0:u.labelFontSize,L=(h=w.columnResize)===null||h===void 0?void 0:h.labelFontFamily,I=(d=w.columnResize)===null||d===void 0?void 0:d.labelBackgroundFill,D=(c=w.columnResize)===null||c===void 0?void 0:c.labelBackgroundCornerRadius;this.labelVisible=x,this.columnResizeLine=ln({visible:!1,pickable:!1,stroke:_,lineWidth:A,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=ln({visible:!1,pickable:!1,stroke:T,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});const H=q_({visible:!1,pickable:!1,x:0,y:0,fontSize:M,fill:E,fontFamily:L,text:"",textBaseline:"top",dx:16,dy:-M/2}),O=Ge({visible:!1,pickable:!1,fill:I,x:0,y:0,width:5*M*.8,height:M+8,cornerRadius:D,dx:12,dy:-M/2-4});this.columnResizeLabel=mg({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(O),this.columnResizeLabel.appendChild(H),this.rowResizeLine=ln({visible:!1,pickable:!1,stroke:_,lineWidth:A,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=ln({visible:!1,pickable:!1,stroke:T,lineWidth:S,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});const N=q_({visible:!1,pickable:!1,x:0,y:0,fontSize:M,fill:E,fontFamily:L,text:"",textBaseline:"top",dx:16,dy:-M/2}),U=Ge({visible:!1,pickable:!1,fill:I,x:0,y:0,width:5*M*.8,height:M+8,cornerRadius:D,dx:12,dy:-M/2-4});this.rowResizeLabel=mg({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(U),this.rowResizeLabel.appendChild(N),this.cellMover=new WJ(this.table);const W=(g=(f=w.frozenColumnLine)===null||f===void 0?void 0:f.shadow)===null||g===void 0?void 0:g.width,j=(p=(m=w.frozenColumnLine)===null||m===void 0?void 0:m.shadow)===null||p===void 0?void 0:p.startColor,Y=(b=(v=w.frozenColumnLine)===null||v===void 0?void 0:v.shadow)===null||b===void 0?void 0:b.endColor,Z=(y=(C=w.frozenColumnLine)===null||C===void 0?void 0:C.shadow)===null||y===void 0?void 0:y.visible;this.frozenShadowLine=Ge({visible:Z==="always",pickable:!1,x:0,y:0,width:W,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:j,offset:0},{color:Y,offset:1}]}}),this.rightFrozenShadowLine=Ge({visible:Z==="always",pickable:!1,x:0,y:0,width:W,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:Y,offset:0},{color:j,offset:1}]}}),this.menu=new zJ(this.table),this.drillIcon=new NJ}addToGroup(t){t.addChild(this.frozenShadowLine),t.addChild(this.rightFrozenShadowLine),t.addChild(this.columnResizeBgLine),t.addChild(this.columnResizeLine),t.addChild(this.columnResizeLabel),t.addChild(this.rowResizeBgLine),t.addChild(this.rowResizeLine),t.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(t.addChild(this.hScrollBar),t.addChild(this.vScrollBar)):(t.stage.defaultLayer.addChild(this.hScrollBar),t.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(t),this.drillIcon.appand(t),this.cellMover.appand(t)}createScrollBar(){var t,e,i,r,o,s;const a=this.table.theme,l=(t=a.scrollStyle)===null||t===void 0?void 0:t.scrollRailColor,u=(e=a.scrollStyle)===null||e===void 0?void 0:e.scrollSliderColor,h=(i=a.scrollStyle)===null||i===void 0?void 0:i.scrollSliderCornerRadius,d=(r=a.scrollStyle)===null||r===void 0?void 0:r.width,c=(o=a.scrollStyle)===null||o===void 0?void 0:o.horizontalPadding,f=(s=a.scrollStyle)===null||s===void 0?void 0:s.verticalPadding;let g;g=et(h)?{cornerRadius:h,fill:u}:{fill:u},this.hScrollBar=new Qa({direction:"horizontal",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:this.table.tableNoFrameWidth,height:d,padding:c,railStyle:{fill:l},sliderStyle:g,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new Qa({direction:"vertical",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:d,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:f,railStyle:{fill:l},sliderStyle:g,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var t,e,i,r,o,s,a;const l=this.table.stateManager.scroll.horizontalBarPos,u=this.table.stateManager.scroll.verticalBarPos,h=this.table.theme,d=(t=h.scrollStyle)===null||t===void 0?void 0:t.width,c=(e=h.scrollStyle)===null||e===void 0?void 0:e.visible,f=(r=(i=h.scrollStyle)===null||i===void 0?void 0:i.horizontalVisible)!==null&&r!==void 0?r:c,g=(s=(o=h.scrollStyle)===null||o===void 0?void 0:o.verticalVisible)!==null&&s!==void 0?s:c,m=Math.ceil(this.table.scenegraph.tableGroup.attribute.width),p=Math.ceil(this.table.scenegraph.tableGroup.attribute.height),v=this.table.getAllRowsHeight(),b=this.table.getAllColsWidth(),C=this.table.getFrozenRowsHeight(),y=this.table.getFrozenColsWidth(),w=this.table.getBottomFrozenRowsHeight(),_=this.table.getRightFrozenColsWidth(),A=!((a=this.table.options.customConfig)===null||a===void 0)&&a._disableColumnAndRowSizeRound?1:0;if(b>m+A){const T=Math.min(p,v),S=Math.max(.05,(m-y)/(b-y)),x=this.table.theme.scrollStyle.hoverOn;let E=0;E=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(x?d:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:T-(x?d:-this.table.scenegraph.tableGroup.attribute.y),this.hScrollBar.setAttributes({x:y+(x?0:this.table.scenegraph.tableGroup.attribute.x),y:E,width:m-y-_,range:[0,S],visible:f==="always"});const M=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:M.x1,y:M.y1},f==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:0,visible:!1});if(v>p+A){const T=Math.min(m,b),S=Math.max(.05,(p-C)/(v-C));let x=0;const E=this.table.theme.scrollStyle.hoverOn;x=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(E?d:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:T-(E?d:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x,y:C+(E?0:this.table.scenegraph.tableGroup.attribute.y),height:p-C-w,range:[0,S],visible:g==="always"});const M=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:M.x1,y:M.y1},g==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,height:0,visible:!1});this.table.stateManager.setScrollLeft(l),this.table.stateManager.setScrollTop(u)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(t,e,i){const r=gf(t,this.table,i);this.columnResizeLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(t)}px`))}updateResizeCol(t,e,i){const r=gf(t,this.table,i);this.columnResizeLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(t))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(t,e,i){const r=RE(t,this.table,i);this.rowResizeLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(t)}px`))}updateResizeRow(t,e,i){const r=RE(t,this.table,i);this.rowResizeLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(t))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(t,e,i){return this.cellMover.show(t,e,i)}updateMoveCol(t,e,i,r){this.cellMover.update(t,e,i,r)}setFrozenColumnShadow(t,e){var i,r;const o=gf(t,this.table,e);t<0||((r=(i=this.table.theme.frozenColumnLine)===null||i===void 0?void 0:i.shadow)===null||r===void 0?void 0:r.visible)!=="always"?this.frozenShadowLine.setAttributes({visible:!1,x:o,height:this.table.getDrawRange().height}):this.frozenShadowLine.setAttributes({visible:!0,x:o,height:this.table.getDrawRange().height})}setRightFrozenColumnShadow(t){var e,i;const r=gf(t,this.table,!0);t>=this.table.colCount||((i=(e=this.table.theme.frozenColumnLine)===null||e===void 0?void 0:e.shadow)===null||i===void 0?void 0:i.visible)!=="always"?this.rightFrozenShadowLine.setAttributes({visible:!1,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}):this.rightFrozenShadowLine.setAttributes({visible:!0,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}hideFrozenColumnShadow(){var t,e,i,r,o;const s=(e=(t=this.table.theme.frozenColumnLine)===null||t===void 0?void 0:t.shadow)===null||e===void 0?void 0:e.visible;((o=(r=(i=this.table.theme.frozenColumnLine)===null||i===void 0?void 0:i.shadow)===null||r===void 0?void 0:r.visible)!==null&&o!==void 0?o:s)==="scrolling"&&(this.frozenShadowLine.setAttribute("visible",!1),this.rightFrozenShadowLine.setAttribute("visible",!1),this.table.scenegraph.updateNextFrame())}showFrozenColumnShadow(){var t,e,i,r,o;const s=(e=(t=this.table.theme.frozenColumnLine)===null||t===void 0?void 0:t.shadow)===null||e===void 0?void 0:e.visible;((o=(r=(i=this.table.theme.frozenColumnLine)===null||i===void 0?void 0:i.shadow)===null||r===void 0?void 0:r.visible)!==null&&o!==void 0?o:s)==="scrolling"&&(this.frozenShadowLine.setAttribute("visible",!0),this.rightFrozenShadowLine.setAttribute("visible",!0),this.table.scenegraph.updateNextFrame())}hideVerticalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.verticalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.verticalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.horizontalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.horizontalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(t){const e=this.vScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.vScrollBar.setAttribute("range",[r,r+i]);const o=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:o.x1,y:o.y1}}updateHorizontalScrollBarPos(t){const e=this.hScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.hScrollBar.setAttribute("range",[r,r+i]);const o=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:o.x1,y:o.y1}}updateStyle(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A;const T=this.table.theme,S=(t=T.scrollStyle)===null||t===void 0?void 0:t.scrollRailColor,x=(e=T.scrollStyle)===null||e===void 0?void 0:e.scrollSliderColor,E=(i=T.scrollStyle)===null||i===void 0?void 0:i.scrollSliderCornerRadius,M=(r=T.scrollStyle)===null||r===void 0?void 0:r.width,L=(o=T.scrollStyle)===null||o===void 0?void 0:o.horizontalPadding,I=(s=T.scrollStyle)===null||s===void 0?void 0:s.verticalPadding;let D;D=et(E)?{cornerRadius:E,fill:x}:{fill:x},this.hScrollBar.setAttributes({height:M,padding:L,railStyle:{fill:S},sliderStyle:D}),this.vScrollBar.setAttributes({width:M,padding:I,railStyle:{fill:S},sliderStyle:D});const H=(a=T.columnResize)===null||a===void 0?void 0:a.lineColor,O=(l=T.columnResize)===null||l===void 0?void 0:l.lineWidth,N=(u=T.columnResize)===null||u===void 0?void 0:u.bgColor,U=(h=T.columnResize)===null||h===void 0?void 0:h.width;this.columnResizeLine.setAttributes({stroke:H,lineWidth:O}),this.columnResizeBgLine=ln({stroke:N,lineWidth:U});const W=(d=T.columnResize)===null||d===void 0?void 0:d.labelColor,j=(c=T.columnResize)===null||c===void 0?void 0:c.labelFontSize,Y=(f=T.columnResize)===null||f===void 0?void 0:f.labelFontFamily,Z=(g=T.columnResize)===null||g===void 0?void 0:g.labelBackgroundFill,rt=(m=T.columnResize)===null||m===void 0?void 0:m.labelBackgroundCornerRadius,J=(v=(p=T.columnResize)===null||p===void 0?void 0:p.labelVisible)===null||v===void 0||v;this.labelVisible=J,this.columnResizeLabel.lastChild.setAttributes({fontSize:j,fill:W,fontFamily:Y,dy:-j/2}),this.columnResizeLabel.firstChild.setAttributes({fill:Z,width:5*j*.8,height:j+8,cornerRadius:rt,dy:-j/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:j,fill:W,fontFamily:Y,dy:-j/2}),this.rowResizeLabel.firstChild.setAttributes({fill:Z,width:5*j*.8,height:j+8,cornerRadius:rt,dy:-j/2-4});const st=(C=(b=T.frozenColumnLine)===null||b===void 0?void 0:b.shadow)===null||C===void 0?void 0:C.width,ht=(w=(y=T.frozenColumnLine)===null||y===void 0?void 0:y.shadow)===null||w===void 0?void 0:w.startColor,at=(A=(_=T.frozenColumnLine)===null||_===void 0?void 0:_.shadow)===null||A===void 0?void 0:A.endColor;this.frozenShadowLine.setAttributes({width:st,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:ht,offset:0},{color:at,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:st,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:at,offset:0},{color:ht,offset:1}]}}),this.cellMover.updateStyle()}}function Nn(n,t,e,i,r){var o,s,a,l,u,h;if(!t)return;const d=e==="table",{shadowBlur:c,shadowOffsetX:f,shadowOffsetY:g,shadowColor:m,cornerRadius:p,borderColor:v,borderLineWidth:b,borderLineDash:C}=t;let y=!1;const w={},_={pickable:!1};c&&d&&(_.shadowBlur=c,_.shadowOffsetX=f,_.shadowOffsetY=g,_.shadowColor=m,_.stroke=!0,_.stroke=m,_.lineWidth=1,y=!0),b&&(_.stroke=!0,_.fill=!1,_.stroke=i1(v??"#E1E4E8",i,b),_.lineWidth=b,C&&(_.lineDash=C),_.lineCap="butt"),Array.isArray(v)&&(_.strokeArrayColor=me(v)),Array.isArray(b)&&(_.strokeArrayWidth=me(b),_.lineWidth=1),p&&(_.cornerRadius=p,w.cornerRadius=p);const A=_.strokeArrayWidth?_.strokeArrayWidth[0]:(o=_.lineWidth)!==null&&o!==void 0?o:0,T=_.strokeArrayWidth?_.strokeArrayWidth[1]:(s=_.lineWidth)!==null&&s!==void 0?s:0,S=_.strokeArrayWidth?_.strokeArrayWidth[2]:(a=_.lineWidth)!==null&&a!==void 0?a:0,x=_.strokeArrayWidth?_.strokeArrayWidth[3]:(l=_.lineWidth)!==null&&l!==void 0?l:0;if(n.setAttributes(w),!r)if(_.stroke)if(_.x=x/2,_.y=A/2,_.pickable=!1,d){if(p)if(Array.isArray(p)){const L=me(p);_.cornerRadius=L,w.cornerRadius=L,L[0]&&(L[0]=L[0]+Math.min(x,A)/2),L[1]&&(L[1]=L[1]+Math.min(A,T)/2),L[2]&&(L[2]=L[2]+Math.min(T,S)/2),L[3]&&(L[3]=L[3]+Math.min(S,x)/2)}else if(Wt(b)){const L=[];_.cornerRadius=L,w.cornerRadius=L,L[0]=p+Math.min(x,A)/2,L[1]=p+Math.min(A,T)/2,L[2]=p+Math.min(T,S)/2,L[3]=p+Math.min(S,x)/2}else _.cornerRadius=p+((u=_.lineWidth)!==null&&u!==void 0?u:0)/2,w.cornerRadius=p+((h=_.lineWidth)!==null&&h!==void 0?h:0)/2;let E,M;if(t.innerBorder?(_.x=n.attribute.x+x/2,_.y=n.attribute.y+A/2,_.width=n.attribute.width-x/2-T/2,_.height=n.attribute.height-A/2-S/2):(_.x=n.attribute.x-x/2,_.y=n.attribute.y-A/2,_.width=n.attribute.width+x/2+T/2,_.height=n.attribute.height+A/2+S/2),y){_.fill="white",_.notAdjustPos=!0,M=mg(_),M.name="table-border-rect",E=Ge({x:x/2,y:A/2,width:n.attribute.width,height:n.attribute.height,fill:"red",cornerRadius:n.attribute.cornerRadius,globalCompositeOperation:"destination-out"}),M.addChild(E);const L=Ge({x:x/2,y:A/2,width:n.attribute.width,height:n.attribute.height,fill:"transparent",pickable:!1,globalCompositeOperation:"source-over"});M.addChild(L)}else M=Ge(_),M.name="table-border-rect";t.innerBorder&&!y?n.parent.insertAfter(M,n):n.parent.insertBefore(M,n),n.border=M}else{_.width=n.attribute.width-x/2-T/2,_.height=n.attribute.height-A/2-S/2;const E=Ge(_);E.name="border-rect",n.addChild(E),n.border=E}else{const E=Ge({fill:!1,stroke:!1,pickable:!1,lineWidth:0});E.name="border-rect",n.addChild(E),n.border=E}}function EE(n,t,e){var i;if(!t)return;const{borderColor:r}=t;(i=n.border)===null||i===void 0||i.setAttribute("stroke",i1(r,e))}function i1(n,t,e){let i=!0;return!t&&!Wt(e)||Wt(n)?t?i=t:t||Wt(n)?Wt(n)&&(i=!0):i=n:i=(t??e).map(r=>!!r&&n),i}function qo(n){var t,e,i,r;if(!n.border)return;const o=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[0]:(t=n.border.attribute.lineWidth)!==null&&t!==void 0?t:0,s=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[1]:(e=n.border.attribute.lineWidth)!==null&&e!==void 0?e:0,a=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[2]:(i=n.border.attribute.lineWidth)!==null&&i!==void 0?i:0,l=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[3]:(r=n.border.attribute.lineWidth)!==null&&r!==void 0?r:0;n.border.setAttributes({borderLeft:l,borderTop:o,borderRight:s,borderBottom:a,width:n.attribute.width-l/2-s/2,height:n.attribute.height-o/2-a/2}),n.border.type==="group"&&n.border.firstChild.setAttributes({width:n.attribute.width,height:n.attribute.height})}function VJ(n){if(!n.theme.frameStyle.cornerRadius)return;const t=n.theme.frameStyle.cornerRadius,{cornerHeaderGroup:e,colHeaderGroup:i,rowHeaderGroup:r,bodyGroup:o,rightTopCornerGroup:s,leftBottomCornerGroup:a,rightBottomCornerGroup:l,rightFrozenGroup:u,bottomFrozenGroup:h}=n.scenegraph;e.setAttribute("cornerRadius",0),i.setAttribute("cornerRadius",0),r.setAttribute("cornerRadius",0),o.setAttribute("cornerRadius",0),s.setAttribute("cornerRadius",0),a.setAttribute("cornerRadius",0),l.setAttribute("cornerRadius",0),u.setAttribute("cornerRadius",0),h.setAttribute("cornerRadius",0);const d=jD(t);e.attribute.width>0&&e.attribute.height>0?dr(e,[d[0],0,0,0]):i.attribute.height>0?dr(i,[d[0],0,0,0]):r.attribute.width>0?dr(r,[d[0],0,0,0]):dr(o,[d[0],0,0,0]),a.attribute.width>0&&a.attribute.height>0?dr(a,[0,0,0,d[3]]):h.attribute.height>0?dr(h,[0,0,0,d[3]]):r.attribute.width>0?dr(r,[0,0,0,d[3]]):dr(o,[0,0,0,d[3]]),s.attribute.width>0&&s.attribute.height>0?dr(s,[0,d[1],0,0]):i.attribute.height>0?dr(i,[0,d[1],0,0]):u.attribute.width>0?dr(u,[0,d[1],0,0]):dr(o,[0,d[1],0,0]),l.attribute.width>0&&l.attribute.height>0?dr(l,[0,0,d[2],0]):u.attribute.width>0?dr(u,[0,0,d[2],0]):h.attribute.height>0?dr(h,[0,0,d[2],0]):dr(o,[0,0,d[2],0])}function dr(n,t){n.setAttribute("cornerRadius",t),n.border&&n.border.setAttribute("cornerRadius",t)}const r1=Ki();class tu extends Kd{constructor(t,e){if(super(e),this.type="chart",this.numberType=r1,this.isShareChartSpec=t,e.chartInstance)this.chartInstance=e.chartInstance;else{const i=this.chartInstance=new e.ClassType(e.spec,Ie({},this.attribute.tableChartOption,{renderCanvas:e.canvas,mode:this.attribute.mode==="node"?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:e.dpr,interactive:!1,animation:!1,autoFit:!1}));i.renderSync(),i.getStage().enableDirtyBounds(),e.chartInstance=this.chartInstance=i}}activate(t){var e,i,r,o,s;this.active=!0;const{col:a,row:l}=this.parent,{x1:u,y1:h,x2:d,y2:c}=this.getViewBox(),f=jJ(a,l,t).intersect({x1:u-t.scrollLeft,x2:d-t.scrollLeft,y1:h-t.scrollTop,y2:c-t.scrollTop});(e=this.activeChartInstance)===null||e===void 0||e.release(),this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,Ie({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:d-u,y1:0,y2:c-h},dpr:t.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:v=>{const b=this.stage,C=v.window.getContext(),y=b.window.getViewBoxTransform(),w=b.window.getViewBox();C.inuse=!0,C.clearMatrix(),C.setTransform(y.a,y.b,y.c,y.d,y.e,y.f,!0),C.translate(w.x1,w.y1),C.setTransformForCurrent(!0),C.beginPath(),C.rect(f.x1,f.y1,f.x2-f.x1,f.y2-f.y1),C.clip(),C.clearMatrix(),t.options.canvas&&!v.needRender&&(v.pauseRender(),t.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),t.scenegraph.updateNextFrame())},afterRender(v){v.window.getContext().inuse=!1,v.needRender=!1,g.resumeRender()}}));const g=this.activeChartInstance.getStage(),m=this.globalTransMatrix.clone(),p=this.stage.window.getViewBoxTransform();m.multiply(p.a,p.b,p.c,p.d,p.e,p.f),g.window.setViewBoxTransform&&g.window.setViewBoxTransform(m.a,m.b,m.c,m.d,m.e,m.f),this.activeChartInstance.renderSync(),(r=(i=t.internalProps.layoutMap)===null||i===void 0?void 0:i.updateDataStateToActiveChartInstance)===null||r===void 0||r.call(i,this.activeChartInstance),this.activeChartInstance.on("click",v=>{var b;((b=this.attribute.spec.select)===null||b===void 0?void 0:b.enable)===!1?t.scenegraph.updateChartState(null):tu.temp&&t.scenegraph.updateChartState(v==null?void 0:v.datum)}),this.activeChartInstance.on("brushEnd",v=>{var b;t.scenegraph.updateChartState((b=v==null?void 0:v.value)===null||b===void 0?void 0:b.inBrushData),tu.temp=0,setTimeout(()=>{tu.temp=1},0)}),(s=(o=t)._bindChartEvent)===null||s===void 0||s.call(o,this.activeChartInstance)}deactivate(){var t,e;this.active=!1,(t=this.activeChartInstance)===null||t===void 0||t.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),(e=this.activeChartInstance)===null||e===void 0||e.release(),this.activeChartInstance=null}updateData(t){this.attribute.data=t}getViewBox(){var t,e,i,r,o,s,a,l;const u=this.parent,h=this.attribute.cellPadding,d=this.stage.table,{x1:c,y1:f,x2:g,y2:m}=u.globalAABBBounds;return{x1:Math.ceil(c+h[3]+d.scrollLeft+((e=(t=d.options.viewBox)===null||t===void 0?void 0:t.x1)!==null&&e!==void 0?e:0)),x2:Math.ceil(c+u.attribute.width-h[1]+d.scrollLeft+((r=(i=d.options.viewBox)===null||i===void 0?void 0:i.x1)!==null&&r!==void 0?r:0)),y1:Math.ceil(f+h[0]+d.scrollTop+((s=(o=d.options.viewBox)===null||o===void 0?void 0:o.y1)!==null&&s!==void 0?s:0)),y2:Math.ceil(f+u.attribute.height-h[2]+d.scrollTop+((l=(a=d.options.viewBox)===null||a===void 0?void 0:a.y1)!==null&&l!==void 0?l:0))}}}function jJ(n,t,e){var i,r,o,s,a,l,u,h;const{layoutMap:d}=e.internalProps,c=new qs,f=e.scenegraph.tableGroup.globalAABBBounds;return c.x1=f.x1,c.x2=f.x2,c.y1=f.y1,c.y2=f.y2,d.isLeftBottomCorner(n,t)||d.isRightTopCorner(n,t)||d.isLeftTopCorner(n,t)||d.isRightBottomCorner(n,t)||(d.isFrozenColumn(n,t)?(c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight()):d.isFrozenRow(n,t)?(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth()):d.isRightFrozenColumn(n,t)?(c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight()):d.isBottomFrozenRow(n,t)?(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth()):d.isFrozenColumn(n,t)||d.isRightFrozenColumn(n,t)||(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth(),c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight())),c.x1=c.x1+((r=(i=e.options.viewBox)===null||i===void 0?void 0:i.x1)!==null&&r!==void 0?r:0),c.x2=c.x2+((s=(o=e.options.viewBox)===null||o===void 0?void 0:o.x1)!==null&&s!==void 0?s:0),c.y1=c.y1+((l=(a=e.options.viewBox)===null||a===void 0?void 0:a.y1)!==null&&l!==void 0?l:0),c.y2=c.y2+((h=(u=e.options.viewBox)===null||u===void 0?void 0:u.y1)!==null&&h!==void 0?h:0),c}tu.temp=1;let xp=[],Tp=[],MI,iy=5,Ap=!1;function ME(n){et(n)&&(iy=n)}function ry(){xp=[],Tp=[],Ap=!1,cancelAnimationFrame(MI)}function GJ(){return Ap}function BI(n){var t,e,i,r,o,s,a;const{axes:l,dataId:u,data:h,spec:d,ClassType:c,canvas:f,mode:g,modeParams:m,dpr:p}=n.attribute;let{chartInstance:v}=n;v||(v=new c(d,{renderCanvas:f,mode:g==="node"?"node":"desktop-browser",modeParams:m,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:p,interactive:!1,animation:!1,autoFit:!1}),v.renderSync(),n.chartInstance=v);const b=n.getViewBox();b.x2<=b.x1&&(b.x2=b.x1+1),b.y2<=b.y1&&(b.y2=b.y1+1),v.updateViewBox({x1:0,x2:b.x2-b.x1,y1:0,y2:b.y2-b.y1},!1,!1);const C=v.getStage(),y=n.globalTransMatrix,w=n.stage.window.getViewBoxTransform().clone();w.multiply(y.a,y.b,y.c,y.d,y.e,y.f),C.window.setViewBoxTransform&&C.window.setViewBoxTransform(w.a,w.b,w.c,w.d,w.e,w.f);const{table:_}=n.getRootNode();let A=!1;if(_.options.specFormat){const T=_.options.specFormat(n.attribute.spec,v,n);if(T.needFormatSpec&&T.spec){const S=T.spec;v.updateSpecSync(S),A=(t=T.updateSpec)===null||t===void 0||t}}if(!A)if(l==null||l.forEach((T,S)=>{var x,E,M,L,I;T.type==="band"?v.updateModelSpec({type:"axes",index:S},{domain:T.domain.slice(0)},!0):v.updateModelSpecSync({type:"axes",index:S},{min:(E=(x=T.range)===null||x===void 0?void 0:x.min)!==null&&E!==void 0?E:0,max:(L=(M=T.range)===null||M===void 0?void 0:M.max)!==null&&L!==void 0?L:0,tick:{tickMode:(I=T.tick)===null||I===void 0?void 0:I.tickMode}},!0)}),(i=(e=_.internalProps.layoutMap)===null||e===void 0?void 0:e.updateDataStateToActiveChartInstance)===null||i===void 0||i.call(e,v),typeof u=="string")v.updateDataSync(u,h??[]);else{const T=[];for(const S in u){const x=u[S],E=d.series.find(M=>{var L;return((L=M==null?void 0:M.data)===null||L===void 0?void 0:L.id)===S});T.push({id:S,values:x?(r=h==null?void 0:h.filter(M=>M.hasOwnProperty(x)))!==null&&r!==void 0?r:[]:h??[],fields:(o=E==null?void 0:E.data)===null||o===void 0?void 0:o.fields}),v.updateFullDataSync||v.updateDataSync(S,x?(s=h==null?void 0:h.filter(M=>M.hasOwnProperty(x)))!==null&&s!==void 0?s:[]:h??[])}(a=v.updateFullDataSync)===null||a===void 0||a.call(v,T)}_.fireListeners("before_cache_chart_image",{chartInstance:v}),$J(v.getStage(),n)}function PI(n){Ap=!0,Tp.length>0?MI=requestAnimationFrame(()=>{const t=Tp.splice(0,iy);xp.splice(0,iy),t.forEach(e=>{BI(e),e.addUpdateBoundTag()}),n.render(),PI(n)}):Ap=!1}const po=2e3;function $J(n,t){var e;const{viewWidth:i,viewHeight:r}=n;if(i<po&&r<po)return t.cacheCanvas=BE(n),void(t.isShareChartSpec||((e=t.chartInstance)===null||e===void 0||e.release(),t.chartInstance=null,t.setAttribute("chartInstance",null)));const o=Math.ceil(r/po),s=Math.ceil(i/po),a=[];for(let l=0;l<o;l++)for(let u=0;u<s;u++){const h=u*po,d=l*po,c=h+po>i?i:h+po,f=d+po>r?r:d+po,g=c-h,m=f-d,p=new qs;p.setValue(h,d,c,f);const v=BE(n,!1,p);a.push({canvas:v,x:h,y:d,width:g,height:m})}t.cacheCanvas=a}function BE(n,t=!0,e){if(n.releaseStatus==="released")return null;const i=qJ(n,t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}function qJ(n,t=!0,e){const i=n.window.getViewBoxTransform(),r=te.get(fd),o=e?-e.x1:0,s=e?-e.y1:0,a=e?e.x2:n.viewWidth,l=e?e.y2:n.viewHeight,u=e?e.width():n.viewWidth,h=e?e.height():n.viewHeight;return r.create({viewBox:{x1:o,y1:s,x2:a,y2:l},width:u*i.a,height:h*i.d,dpr:n.window.dpr,canvasControled:!0,offscreen:!0,title:""}),r.setViewBoxTransform(i.a,i.b,i.c,i.d,0,0),n.renderTo(r),r}var XJ=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};const YJ=Symbol.for("ChartRender");let Xh=class extends Xr{constructor(){super(...arguments),this.numberType=r1}drawShape(n,t,e,i,r,o,s,a){var l,u,h,d;const c=ae(n,o==null?void 0:o.theme).group,{dataId:f,data:g,spec:m}=n.attribute,{width:p=c.width,height:v=c.height}=(n.getViewBox(),n.attribute),{table:b}=n.getRootNode(),{active:C,cacheCanvas:y,activeChartInstance:w}=n;if(!C&&y)Wt(y)?y.forEach(_=>{const{x:A,y:T,width:S,height:x,canvas:E}=_;t.drawImage(E,A,T,S,x)}):t.drawImage(y,e,i,p,v);else if(w){if(b.options.specFormat){const x=b.options.specFormat(n.attribute.spec,w,n);if(x.needFormatSpec&&x.spec){const E=x.spec;w.updateSpecSync(E)}}const _=n.getViewBox();w.updateViewBox({x1:0,x2:_.x2-_.x1,y1:0,y2:_.y2-_.y1},!1,!1);const A=w.getStage();A.needRender=!0;const T=n.globalTransMatrix.clone(),S=n.stage.window.getViewBoxTransform().clone();if(S.multiply(T.a,T.b,T.c,T.d,T.e,T.f),A.window.setViewBoxTransform(S.a,S.b,S.c,S.d,S.e,S.f),typeof f=="string")w.updateDataSync(f,g??[]);else{const x=[];for(const E in f){const M=f[E],L=m.series.find(I=>{var D;return((D=I==null?void 0:I.data)===null||D===void 0?void 0:D.id)===E});x.push({id:E,values:M?(l=g==null?void 0:g.filter(I=>I.hasOwnProperty(M)))!==null&&l!==void 0?l:[]:g??[],fields:(u=L==null?void 0:L.data)===null||u===void 0?void 0:u.fields}),w.updateFullDataSync||w.updateDataSync(E,M?(h=g==null?void 0:g.filter(I=>I.hasOwnProperty(M)))!==null&&h!==void 0?h:[]:g??[])}(d=w.updateFullDataSync)===null||d===void 0||d.call(w,x)}}else b.internalProps.renderChartAsync?(xp.indexOf(`${n.parent.col}+${n.parent.row}`)===-1&&(xp.push(`${n.parent.col}+${n.parent.row}`),Tp.push(n)),GJ()||PI(b)):BI(n)}draw(n,t,e,i){this._draw(n,{},!1,e,i)}};Xh=XJ([Tt()],Xh);var l0=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Rp=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{shape:f}=n.attribute;if(f==="circle"){const{width:g=l.width,height:m=l.height}=n.attribute;t.beginPath(),t.arc(e+g/2,i+m/2,Math.min(g,m)/2,0,2*Math.PI),t.closePath(),t.save(),t.clip()}}};Rp=l0([Tt()],Rp);let Ep=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{shape:f}=n.attribute;f==="circle"&&t.restore()}};Ep=l0([Tt()],Ep);let Mp=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{isGif:f}=n.attribute;f&&n.playing&&(n.attribute.opacity=0)}};Mp=l0([Tt()],Mp);let Bp=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{isGif:f}=n.attribute;f&&n.playing&&(n.attribute.opacity=1,t.globalAlpha=n.attribute.opacity,n.renderFrame(t,e,i))}};Bp=l0([Tt()],Bp);function KJ(n,t){var e,i,r,o,s,a,l,u,h,d,c;let f,g;if(n.role==="cell"&&et(n.mergeStartCol)&&et(n.mergeStartRow)&&et(n.mergeEndCol)&&et(n.mergeEndRow)){const{colStart:p,colEnd:v,rowStart:b,rowEnd:C}=Js(n,t.scenegraph);for(let y=p;y<=v;y++)for(let w=b;w<=C;w++){const _=PE(t.stateManager,y,w,n);!_||f&&_!=="cellBgColor"||(f=_)}}else n.role==="cell"&&(f=PE(t.stateManager,n.col,n.row,n));if(!f)return;const m=t.internalProps.layoutMap;return m.isCornerHeader(n.col,n.row)?g=((e=t.theme.cornerHeaderStyle)===null||e===void 0?void 0:e.hover)||((i=t.theme.headerStyle)===null||i===void 0?void 0:i.hover):m.isColumnHeader(n.col,n.row)?g=(r=t.theme.headerStyle)===null||r===void 0?void 0:r.hover:m.isRowHeader(n.col,n.row)?g=(o=t.theme.rowHeaderStyle)===null||o===void 0?void 0:o.hover:m.isBottomFrozenRow(n.col,n.row)?g=((s=t.theme.bottomFrozenStyle)===null||s===void 0?void 0:s.hover)||(t.isListTable()?(a=t.theme.bodyStyle)===null||a===void 0?void 0:a.hover:(l=t.theme.headerStyle)===null||l===void 0?void 0:l.hover):m.isRightFrozenColumn(n.col,n.row)?g=((u=t.theme.rightFrozenStyle)===null||u===void 0?void 0:u.hover)||(t.isListTable()?(h=t.theme.bodyStyle)===null||h===void 0?void 0:h.hover:(d=t.theme.rowHeaderStyle)===null||d===void 0?void 0:d.hover):t.isHeader(n.col,n.row)||(g=(c=t.theme.bodyStyle)===null||c===void 0?void 0:c.hover),pt(f,g,n.col,n.row,t)}function PE(n,t,e,i){var r;const{highlightScope:o,disableHeader:s,cellPos:a}=n.hover,l=n.table,u=l.isHeader(t,e);if(u&&s)return;let h;if(o===ye.single&&a.col===t&&a.row===e?h="cellBgColor":o===ye.column&&a.col===t?h=a.col===t&&a.row===e?"cellBgColor":"inlineColumnBgColor":o===ye.row&&a.row===e?h=a.col===t&&a.row===e?"cellBgColor":"inlineRowBgColor":o===ye.cross&&(a.col===t&&a.row===e?h="cellBgColor":a.col===t?h="inlineColumnBgColor":a.row===e&&(h="inlineRowBgColor")),h){let d;if(u){const c=l.getHeaderDefine(t,e);d=c==null?void 0:c.disableHeaderHover,i.firstChild&&i.firstChild.name==="axis"&&(!((r=l.options.hover)===null||r===void 0)&&r.disableAxisHover)&&(d=!0)}else{const c=l.getBodyColumnDefine(t,e);d=c==null?void 0:c.disableHover}d&&(h=void 0)}return h}function ZJ(n,t){var e,i,r,o,s,a,l,u,h,d,c;let f,g;if(n.role==="cell"&&et(n.mergeStartCol)&&et(n.mergeStartRow)&&et(n.mergeEndCol)&&et(n.mergeEndRow)){const{colStart:p,colEnd:v,rowStart:b,rowEnd:C}=Js(n,t.scenegraph);for(let y=p;y<=v;y++)for(let w=b;w<=C;w++){const _=kE(t.stateManager,y,w);!_||f&&_!=="cellBgColor"||(f=_)}}else n.role==="cell"&&(f=kE(t.stateManager,n.col,n.row));if(!f)return;const m=t.internalProps.layoutMap;return m.isCornerHeader(n.col,n.row)?g=((e=t.theme.cornerHeaderStyle)===null||e===void 0?void 0:e.select)||((i=t.theme.headerStyle)===null||i===void 0?void 0:i.select):m.isColumnHeader(n.col,n.row)?g=(r=t.theme.headerStyle)===null||r===void 0?void 0:r.select:m.isRowHeader(n.col,n.row)?g=(o=t.theme.rowHeaderStyle)===null||o===void 0?void 0:o.select:m.isBottomFrozenRow(n.col,n.row)?g=((s=t.theme.bottomFrozenStyle)===null||s===void 0?void 0:s.select)||(t.isListTable()?(a=t.theme.bodyStyle)===null||a===void 0?void 0:a.select:(l=t.theme.headerStyle)===null||l===void 0?void 0:l.select):m.isRightFrozenColumn(n.col,n.row)?g=((u=t.theme.rightFrozenStyle)===null||u===void 0?void 0:u.select)||(t.isListTable()?(h=t.theme.bodyStyle)===null||h===void 0?void 0:h.select:(d=t.theme.rowHeaderStyle)===null||d===void 0?void 0:d.select):t.isHeader(n.col,n.row)||(g=(c=t.theme.bodyStyle)===null||c===void 0?void 0:c.select),pt(f,g,n.col,n.row,t)}function QJ(n){return n.start.col!==n.end.col||n.start.row!==n.end.row}function JJ(n,t,e){let i;const{highlightScope:r,cellPos:o,ranges:s}=n.select,a=s[0],l=Math.min(a.start.col,a.end.col),u=Math.max(a.start.col,a.end.col),h=Math.min(a.start.row,a.end.row),d=Math.max(a.start.row,a.end.row);return r===ye.single&&o.col===t&&o.row===e?i="cellBgColor":r===ye.column&&t>=l&&t<=u?i=Ln(s[0],t,e)?"cellBgColor":"inlineColumnBgColor":r===ye.row&&e>=h&&e<=d?i=Ln(s[0],t,e)?"cellBgColor":"inlineRowBgColor":r===ye.cross&&(Ln(s[0],t,e)?i="cellBgColor":t>=l&&t<=u?i="inlineColumnBgColor":e>=h&&e<=d&&(i="inlineRowBgColor")),i}function ttt(n,t,e){let i;const{highlightScope:r,cellPos:o}=n.select;return r===ye.single&&o.col===t&&o.row===e?i="cellBgColor":r===ye.column&&o.col===t?i=o.col===t&&o.row===e?"cellBgColor":"inlineColumnBgColor":r===ye.row&&o.row===e?i=o.col===t&&o.row===e?"cellBgColor":"inlineRowBgColor":r===ye.cross&&(o.col===t&&o.row===e?i="cellBgColor":o.col===t?i="inlineColumnBgColor":o.row===e&&(i="inlineRowBgColor")),i}function kE(n,t,e,i){const{highlightInRange:r,disableHeader:o,ranges:s}=n.select;let a;const l=s.length===1&&QJ(s==null?void 0:s[0])&&r;if(l?(s==null?void 0:s.length)===1&&s[0].start&&s[0].end:(s==null?void 0:s.length)===1&&s[0].end.col===s[0].start.col&&s[0].end.row===s[0].start.row){if(n.table.isHeader(t,e)&&o)return;a=l?JJ(n,t,e):ttt(n,t,e),a&&Hs(n.table,t,e)&&(a=void 0)}else if(n.table.theme.selectionStyle.selectionFillMode==="replace")for(let u=0;u<s.length;u++){const h=s[u],d=Math.min(h.start.col,h.end.col),c=Math.max(h.start.col,h.end.col),f=Math.min(h.start.row,h.end.row),g=Math.max(h.start.row,h.end.row);if(d<=t&&f<=e&&c>=t&&g>=e){a="cellBgColor";break}}return a}function Hs(n,t,e){var i,r;const o=(i=n.options.select)===null||i===void 0?void 0:i.disableSelect;if(typeof o=="function"?o(t,e,n):o)return!0;if(n.isHeader(t,e)){let s=(r=n.options.select)===null||r===void 0?void 0:r.disableHeaderSelect;if(s)return!0;const a=n.getHeaderDefine(t,e);if(s=a==null?void 0:a.disableHeaderSelect,s)return!0}else{const s=n.getBodyColumnDefine(t,e),a=s==null?void 0:s.disableSelect;if(typeof a=="function"?a(t,e,n):a)return!0}return!1}var _s=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Pp=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{stroke:f=l.stroke,strokeArrayWidth:g=l.strokeArrayWidth,strokeArrayColor:m=l.strokeArrayColor}=n.attribute;f&&(Array.isArray(g)||Array.isArray(m))&&(c.doStroke=!1)}};Pp=_s([Tt()],Pp);let kp=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d){var c,f;const{stroke:g=l.stroke,strokeArrayColor:m=l.strokeArrayColor,strokeArrayWidth:p=l.strokeArrayWidth,lineWidth:v=l.lineWidth,strokeColor:b=l.stroke,cornerRadius:C=l.cornerRadius}=n.attribute;let y,w,{width:_=l.width,height:A=l.height}=n.attribute;if(g&&(Array.isArray(p)||v!==0)&&(Array.isArray(m)||Array.isArray(p))){if(typeof v=="number"&&1&v||Array.isArray(p)&&p.some(T=>1&T)){const T=n.stage.table;if(!T)return;const S=((c=T==null?void 0:T.theme)===null||c===void 0?void 0:c.cellBorderClipDirection)==="bottom-right";if(S){if(e=Math.floor(e)-.5,i=Math.floor(i)-.5,n.role==="cell"){const M=n.col,L=n.row;M===0&&(e+=1),L===0&&(i+=1)}}else e=Math.floor(e)+.5,i=Math.floor(i)+.5;!((f=T.options.customConfig)===null||f===void 0)&&f._disableColumnAndRowSizeRound&&(_=Math.round(_),A=Math.round(A));const{width:x,height:E}=n1(n,Math.ceil(_),Math.ceil(A),S);y=x,w=E}else y=Math.ceil(_),w=Math.ceil(A);C===0||Wt(C)&&C.every(T=>T===0)?LI(n,t,e,i,l,g,p||v,m||b,y,w):(t.beginPath(),Lo(t,e,i,y,w,C,!0,new Array(4).fill(0).map((T,S)=>(x,E,M,L)=>{II(S,x,E,M,L,n,t,e,i,l,g,p||v,m||b,y,w)})),t.stroke())}}};kp=_s([Tt()],kp);function kI(n){if(!Array.isArray(n))return{isSplitDraw:!1,width:n};let t;for(let e=0;e<n.length;e++){const i=n[e];if(i)if(t){if(i!==t)return{isSplitDraw:!0}}else t=i}return{isSplitDraw:!1,width:t}}function LI(n,t,e,i,r,o,s,a,l,u,h,d){var c,f,g,m;const p=kI(s),v=!Array.isArray(s),b=!Array.isArray(o),C=Array.isArray(d),y=Array.isArray(a)||p.isSplitDraw;t.setStrokeStyle(n,n.attribute,e,i,r);const{lineDash:w=r.lineDash}=n.attribute;let _=!1;w.length&&w.some(E=>Array.isArray(E))&&(_=!0),t.beginPath(),t.moveTo(e,i);const A=(b||o[0])&&(v||s[0]),T=(b||o[1])&&(v||s[1]),S=(b||o[2])&&(v||s[2]),x=(b||o[3])&&(v||s[3]);if(A){const E=(v?p.width:s[0])/2,M=(v?p.width:s[0])/2;C&&Array.isArray(d[0])?(t.moveTo(e-E+(l+E+M)*d[0][0],i),t.lineTo(e-E+(l+E+M)*(d[0][1]-d[0][0]),i),t.moveTo(e+l+M,i)):(t.moveTo(e-E,i),t.lineTo(e+l+M,i)),(y||_)&&(a&&a[0]?t.strokeStyle=a[0]:a&&!a[0]&&(t.strokeStyle="transparent"),v||(t.lineWidth=s[0]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,_&&t.setLineDash((c=w[0])!==null&&c!==void 0?c:[]),t.stroke(),t.beginPath(),t.moveTo(e+l,i))}else t.moveTo(e+l,i);if(T){const E=(v?p.width:s[1])/2,M=(v?p.width:s[1])/2;C&&Array.isArray(d[1])?(t.moveTo(e+l,i-E+u*d[1][0]),t.lineTo(e+l,i-E+(u+E+M)*(d[1][1]-d[1][0])),t.moveTo(e+l,i+u+M)):(t.moveTo(e+l,i-E),t.lineTo(e+l,i+u+M)),(y||_)&&(a&&a[1]?t.strokeStyle=a[1]:a&&!a[1]&&(t.strokeStyle="transparent"),v||(t.lineWidth=s[1]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,_&&t.setLineDash((f=w[1])!==null&&f!==void 0?f:[]),t.stroke(),t.beginPath(),t.moveTo(e+l,i+u))}else t.moveTo(e+l,i+u);if(S){const E=(v?p.width:s[2])/2,M=(v?p.width:s[2])/2;C&&Array.isArray(d[2])?(t.moveTo(e-E+(l+E+M)*d[2][0],i+u),t.lineTo(e-E+(l+E+M)*(d[2][1]-d[2][0]),i+u),t.moveTo(e-E,i+u)):(t.moveTo(e-E,i+u),t.lineTo(e+l+M,i+u)),(y||_)&&(a&&a[2]?t.strokeStyle=a[2]:a&&!a[2]&&(t.strokeStyle="transparent"),v||(t.lineWidth=s[2]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,_&&t.setLineDash((g=w[2])!==null&&g!==void 0?g:[]),t.stroke(),t.beginPath(),t.moveTo(e,i+u))}else t.moveTo(e,i+u);if(x){const E=(v?p.width:s[3])/2,M=(v?p.width:s[3])/2;C&&Array.isArray(d[3])?(t.moveTo(e,i-E+(u+E+M)*d[3][0]),t.lineTo(e,i-E+(u+E+M)*(d[3][1]-d[3][0])),t.moveTo(e,i-E)):(t.moveTo(e,i-E),t.lineTo(e,i+u+M)),(y||_)&&(a&&a[3]?t.strokeStyle=a[3]:a&&!a[3]&&(t.strokeStyle="transparent"),v||(t.lineWidth=s[3]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,_&&t.setLineDash((m=w[3])!==null&&m!==void 0?m:[]),t.stroke(),t.beginPath(),t.moveTo(e,i))}else t.moveTo(e,i);y||_||(!v&&p.width&&(t.lineWidth=p.width),t.stroke()),t.lineDashOffset=0,t.setLineDash([])}let Lp=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){var f;const{lineDash:g=l.lineDash,stroke:m=l.stroke,strokeArrayColor:p=l.strokeArrayColor,strokeArrayWidth:v=l.strokeArrayWidth}=n.attribute;m&&Array.isArray(g)&&g.length&&(!((f=g[0])===null||f===void 0)&&f.length)&&!Array.isArray(p)&&!Array.isArray(v)&&(c.doStroke=!1)}};Lp=_s([Tt()],Lp);let Dp=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d){var c,f,g,m,p,v;const{lineDash:b=l.lineDash,stroke:C=l.stroke,strokeArrayColor:y=l.strokeArrayColor,strokeArrayWidth:w=l.strokeArrayWidth,lineWidth:_=l.lineWidth}=n.attribute;if(!C||!(Array.isArray(b)&&b.length&&(!((c=b[0])===null||c===void 0)&&c.length))||Array.isArray(y)||Array.isArray(w))return;const A=n.stage.table;if(!A)return;const T=Wt(b[0])?ett(b):[b,b,b,b];let S,x,{width:E=l.width,height:M=l.height}=n.attribute;if(!((f=A.options.customConfig)===null||f===void 0)&&f._disableColumnAndRowSizeRound?(E=Math.round(E),M=Math.round(M)):(E=Math.ceil(E),M=Math.ceil(M)),1&_){const L=A.theme.cellBorderClipDirection==="bottom-right",I=0,D=0;L?(e=Math.floor(e)-.5,i=Math.floor(i)-.5,n.role==="cell"&&(n.col===0&&(e+=1),n.row===0&&(i+=1))):(e=Math.floor(e)+.5,i=Math.floor(i)+.5);const{width:H,height:O}=n1(n,Math.ceil(E+I),Math.ceil(M+D),L);S=H,x=O}else S=Math.ceil(E),x=Math.ceil(M);t.setStrokeStyle(n,n.attribute,e,i,l),t.beginPath(),t.moveTo(e,i),t.lineTo(e+S,i),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash((g=T[0])!==null&&g!==void 0?g:[]),t.stroke(),t.beginPath(),t.moveTo(e+S,i),t.lineTo(e+S,i+x),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash((m=T[1])!==null&&m!==void 0?m:[]),t.stroke(),t.beginPath(),t.moveTo(e,i+x),t.lineTo(e+S,i+x),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash((p=T[2])!==null&&p!==void 0?p:[]),t.stroke(),t.beginPath(),t.moveTo(e,i),t.lineTo(e,i+x),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash((v=T[3])!==null&&v!==void 0?v:[]),t.stroke(),t.lineDashOffset=0,t.setLineDash([])}};Dp=_s([Tt()],Dp);let Ip=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{lineWidth:f=l.lineWidth,stroke:g=l.stroke,lineDash:m=l.lineDash,strokeArrayWidth:p=l.strokeArrayWidth,strokeArrayColor:v=l.strokeArrayColor,notAdjustPos:b}=n.attribute;b!==!0&&g&&Array.isArray(m)&&!m.length&&!Array.isArray(v)&&!Array.isArray(p)&&1&f&&(c.doStroke=!1)}};Ip=_s([Tt()],Ip);let Fp=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d){var c,f;const{lineWidth:g=l.lineWidth,stroke:m=l.stroke,lineDash:p=l.lineDash,strokeArrayWidth:v=l.strokeArrayWidth,strokeArrayColor:b=l.strokeArrayColor,notAdjustPos:C,cornerRadius:y=l.cornerRadius}=n.attribute;let{width:w=l.width,height:_=l.height}=n.attribute;if(C!==!0&&m&&Array.isArray(p)&&!p.length&&!Array.isArray(b)&&!Array.isArray(v)&&1&g){const A=n.stage.table;if(!A)return;!((c=A.options.customConfig)===null||c===void 0)&&c._disableColumnAndRowSizeRound&&(w=Math.round(w),_=Math.round(_)),t.beginPath();const T=((f=A==null?void 0:A.theme)===null||f===void 0?void 0:f.cellBorderClipDirection)==="bottom-right",S=0,x=0;T?(e=Math.floor(e)-.5,i=Math.floor(i)-.5,n.role==="cell"&&(n.col===0&&(e+=1),n.row===0&&(i+=1))):(e=Math.floor(e)+.5,i=Math.floor(i)+.5);const{width:E,height:M}=n1(n,Math.ceil(w),Math.ceil(_),T);y?Lo(t,e,i,E+S,M+x,y):t.rect(e,i,E,M),t.setStrokeStyle(n,n.attribute,e,i,l),t.stroke()}}};Fp=_s([Tt()],Fp);let Op=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){if(n.role==="cell"){const f=n.stage.table;if(f){const g=ZJ(n,f);if(g)n.attribute._vtableHightLightFill=g;else if(f.stateManager.interactionState!==Qt.scrolling){const m=KJ(n,f);m&&(n.attribute._vtableHightLightFill=m)}}}}};Op=_s([Tt()],Op);let Hp=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d){if(n.attribute._vtableHightLightFill&&!h){if(s){const c=n.attribute.fill;n.attribute.fill=n.attribute._vtableHightLightFill,t.setCommonStyle(n,n.attribute,e,i,l),t.fill(),n.attribute.fill=c,n.attribute._vtableHightLightFill=void 0}}}};Hp=_s([Tt()],Hp);let zp=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){var f,g,m,p,v,b;const C=n.stage.table;C&&(n.role==="body"?Xo(t,-((f=n.attribute.x)!==null&&f!==void 0?f:0)+C.getFrozenColsWidth(),-((g=n.attribute.y)!==null&&g!==void 0?g:0)+C.getFrozenRowsHeight(),n.parent.attribute.width-C.getFrozenColsWidth()-C.getRightFrozenColsWidth(),n.parent.attribute.height-C.getFrozenRowsHeight()-C.getBottomFrozenRowsHeight()):n.role==="row-header"?Xo(t,0,-((m=n.attribute.y)!==null&&m!==void 0?m:0)+C.getFrozenRowsHeight(),C.getFrozenColsWidth(),n.parent.attribute.height-C.getFrozenRowsHeight()-C.getBottomFrozenRowsHeight()):n.role==="col-header"?Xo(t,-((p=n.attribute.x)!==null&&p!==void 0?p:0)+C.getFrozenColsWidth(),0,n.parent.attribute.width-C.getFrozenColsWidth()-C.getRightFrozenColsWidth(),C.getFrozenRowsHeight()):n.role==="right-frozen"?Xo(t,0,-((v=n.attribute.y)!==null&&v!==void 0?v:0)+C.getFrozenRowsHeight(),C.getRightFrozenColsWidth(),n.parent.attribute.height-C.getFrozenRowsHeight()-C.getBottomFrozenRowsHeight()):n.role==="bottom-frozen"?Xo(t,-((b=n.attribute.x)!==null&&b!==void 0?b:0)+C.getFrozenColsWidth(),0,n.parent.attribute.width-C.getFrozenColsWidth()-C.getRightFrozenColsWidth(),C.getBottomFrozenRowsHeight()):n.role==="corner-header"?Xo(t,0,0,C.getFrozenColsWidth(),C.getFrozenRowsHeight()):n.role==="corner-right-top-header"?Xo(t,0,0,C.getRightFrozenColsWidth(),C.getFrozenRowsHeight()):n.role==="corner-right-bottom-header"?Xo(t,0,0,C.getRightFrozenColsWidth(),C.getBottomFrozenRowsHeight()):n.role==="corner-left-bottom-header"&&Xo(t,0,0,C.getFrozenColsWidth(),C.getBottomFrozenRowsHeight()))}};zp=_s([Tt()],zp);const xl=Math.pow(2,24);function Xo(n,t,e,i,r){n.beginPath();const o=n.applyedMatrix;Math.abs(o.f)>xl||Math.abs(o.g)>xl?n.rect(t-xl,e-xl,i+2*xl,r+2*xl):n.rect(t,e,i,r)}function n1(n,t,e,i){var r,o;const s=n.stage.table;if(!s)return{width:t,height:e};if(n.role==="cell"){let a=n.col,l=n.row;const u=vi(s,a,l);u&&(a=u.end.col,l=u.end.row),i?(a===0&&(t-=1),l===0&&(e-=1)):((a===s.colCount-1||a===s.frozenColCount-1&&s.scrollLeft||!((r=s.containerFit)===null||r===void 0)&&r.width&&s.rightFrozenColCount&&a===s.colCount-s.rightFrozenColCount-1)&&(t-=1),(l===s.rowCount-1||l===s.frozenRowCount-1&&s.scrollTop||!((o=s.containerFit)===null||o===void 0)&&o.height&&s.bottomFrozenRowCount&&l===s.rowCount-s.bottomFrozenRowCount-1)&&(e-=1))}else n.role==="corner-frozen"&&(s.scrollLeft&&!i&&(t-=1),s.scrollTop&&!i&&(e-=1));return{width:t,height:e}}function ett(n){return n.length===1?[n[0],n[0],n[0],n[0]]:n.length===2?[n[0],n[1],n[0],n[1]]:n}var DI=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Yh=class{constructor(){this.time=we.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){const{stroke:f=l.stroke,strokeArrayWidth:g=l.strokeArrayWidth,strokeArrayColor:m=l.strokeArrayColor}=n.attribute;f&&(Array.isArray(f)||Array.isArray(g)||Array.isArray(m))&&(c.doStroke=!1)}};Yh=DI([Tt()],Yh);let Kh=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d){const{width:c=l.width,height:f=l.height,stroke:g=l.stroke,strokeArrayColor:m=l.strokeArrayColor,strokeArrayWidth:p=l.strokeArrayWidth,lineWidth:v=l.lineWidth,strokeColor:b=l.stroke,cornerRadius:C=l.cornerRadius}=n.attribute;g&&(Array.isArray(p)||v!==0)&&(Array.isArray(g)||Array.isArray(m)||Array.isArray(p))&&(n.name!=="border-rect"&&n.name!=="table-border-rect"&&(typeof v=="number"&&1&v||Array.isArray(p)&&p.some(_=>1&_))&&(e=Math.floor(e)+.5,i=Math.floor(i)+.5),C===0||Wt(C)&&C.every(_=>_===0)?LI(n,t,e,i,l,g,p||v,m||b,n.name!=="table-border-rect"?Math.ceil(c+0):c+0,n.name!=="table-border-rect"?Math.ceil(f+0):f+0):(t.beginPath(),Lo(t,e,i,c,f,C,!0,new Array(4).fill(0).map((_,A)=>(T,S,x,E)=>{II(A,T,S,x,E,n,t,e,i,l,g,p||v,m||b,Math.ceil(c+0),Math.ceil(f+0))})),t.stroke()))}};Kh=DI([Tt()],Kh);function II(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g){var m,p,v,b;const C=o,y=u,w=kI(d),_=!Array.isArray(d),A=!Array.isArray(h),T=Array.isArray(c)||w.isSplitDraw;s.stroke(),s.setStrokeStyle(o,o.attribute,a,l,u);const{lineDash:S=y.lineDash}=C.attribute;let x=!1;S.length&&S.some(D=>Array.isArray(D))&&(x=!0),s.beginPath(),s.moveTo(a,l);const E=(A||h[0])&&(_||d[0]),M=(A||h[1])&&(_||d[1]),L=(A||h[2])&&(_||d[2]),I=(A||h[3])&&(_||d[3]);E&&n===0?(_?w.width:d[0],_?w.width:d[0],s.moveTo(t,e),s.lineTo(i,r),(T||x)&&(c&&c[0]?s.strokeStyle=c[0]:c&&!c[0]&&(s.strokeStyle="transparent"),_||(s.lineWidth=d[0]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,x&&s.setLineDash((m=S[0])!==null&&m!==void 0?m:[]),s.stroke(),s.beginPath())):n===0&&s.moveTo(a+f,l),M&&n===1?(_?w.width:d[1],_?w.width:d[1],s.moveTo(t,e),s.lineTo(i,r),(T||x)&&(c&&c[1]?s.strokeStyle=c[1]:c&&!c[1]&&(s.strokeStyle="transparent"),_||(s.lineWidth=d[1]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,x&&s.setLineDash((p=S[1])!==null&&p!==void 0?p:[]),s.stroke(),s.beginPath(),s.moveTo(a+f,l+g))):n===1&&s.moveTo(a+f,l+g),L&&n===2?(_?w.width:d[2],_?w.width:d[2],s.moveTo(t,e),s.lineTo(i,r),(T||x)&&(c&&c[2]?s.strokeStyle=c[2]:c&&!c[2]&&(s.strokeStyle="transparent"),_||(s.lineWidth=d[2]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,x&&s.setLineDash((v=S[2])!==null&&v!==void 0?v:[]),s.stroke(),s.beginPath(),s.moveTo(a,l+g))):n===2&&s.moveTo(a,l+g),I&&n===3?(_?w.width:d[3],_?w.width:d[3],s.moveTo(t,e),s.lineTo(i,r),(T||x)&&(c&&c[3]?s.strokeStyle=c[3]:c&&!c[3]&&(s.strokeStyle="transparent"),_||(s.lineWidth=d[3]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,x&&s.setLineDash((b=S[3])!==null&&b!==void 0?b:[]),s.stroke(),s.beginPath(),s.moveTo(a,l))):n===3&&s.moveTo(a,l),s.closePath(),T||x||(!_&&w.width&&(s.lineWidth=w.width),s.stroke()),s.lineDashOffset=0,s.setLineDash([]),s.beginPath()}var itt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let bh,Np=class{constructor(){this.order=1,this.interceptors=[new rtt]}afterDrawItem(n,t,e,i,r){for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].afterDrawItem&&this.interceptors[o].afterDrawItem(n,t,e,i,r))return!0;return!1}beforeDrawItem(n,t,e,i,r){if((!n.in3dMode||e.in3dInterceptor)&&!n.shadowRoot&&!(n.baseGraphic||n.attribute.globalZIndex||n.interactiveGraphic))return!1;for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].beforeDrawItem&&this.interceptors[o].beforeDrawItem(n,t,e,i,r))return!0;return!1}};Np=itt([Tt()],Np);class rtt{constructor(){this.order=1}afterDrawItem(t,e,i,r,o){return t.type==="image"&&this.drawItem(t,e,i,r,o),!1}drawItem(t,e,i,r,o){const{image:s,gif:a}=t.attribute;if(a&&t.playing||!s||!t.resources)return!1;const l=t.resources.get(s);if(!l||l.state!=="loading")return!1;if(!bh){const m=Fn(),p=m.loading_pic.svg,v=m.loading_pic.width,b=m.loading_pic.height;bh=Hm({width:v,height:b,image:p})}const{image:u}=bh.attribute;if(!s||!bh.resources)return!1;const h=bh.resources.get(u);if(h.state!=="success")return!1;const{context:d}=i;d.highPerformanceSave(),t.parent&&d.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&d.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);const c=t.AABBBounds,{width:f,height:g}=s0(h.data.width,h.data.height,c.width(),c.height());return d.drawImage(h.data,c.x1+(c.width()-f)/2,c.y1+(c.height()-g)/2,f,g),d.highPerformanceRestore(),!0}}var ntt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Wp=class{constructor(){this.time=we.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,u,h,d,c){var f,g;const{text:m,underline:p=l.underline,lineThrough:v=l.lineThrough,direction:b=l.direction,whiteSpace:C=l.whiteSpace,fontSize:y=l.fontSize,verticalMode:w=l.verticalMode,ellipsis:_=l.ellipsis,textAlign:A=l.textAlign,textBaseline:T=l.textBaseline,x:S=l.x,y:x=l.y}=n.attribute;let E=!1;if(Array.isArray(n)){const D=(f=n.cache)===null||f===void 0?void 0:f.layoutData;_&&D&&D.lines.every(H=>H.str==="")&&(E=!0)}else{const{cache:D}=n;_&&D&&D.clipedText===""&&D.clipedWidth===0&&(E=!0)}if(!E)return;const M=ei(_)?_:"...",L=(g=$d(n.attribute.lineHeight,y))!==null&&g!==void 0?g:y;let I=0;L!==y&&(T==="top"?I=(L-y)/2:T==="middle"||T==="bottom"&&(I=-(L-y)/2)),o&&(d?d(t,n.attribute,l):a&&(t.setStrokeStyle(n,n.attribute,S-e,x-i,l),t.strokeText(M,S,x+I))),r&&(h?h(t,n.attribute,l):s&&(t.setCommonStyle(n,n.attribute,S-e,x-i,l),t.fillText(M,S,x+I),this.drawUnderLine(p,v,n,S,x+I,0,l,t,M)))}drawUnderLine(n,t,e,i,r,o,s,a,l){if(t+n<=0)return;const{textAlign:u=s.textAlign,textBaseline:h=s.textBaseline,fontSize:d=s.fontSize,fontFamily:c=s.fontFamily,fontWeight:f=s.fontWeight,fontStyle:g=s.fontStyle,fill:m=s.fill,opacity:p=s.opacity,underlineOffset:v=s.underlineOffset,underlineDash:b=s.underlineDash,fillOpacity:C=s.fillOpacity}=e.attribute;if(!n&&!t)return;const y=AI.measureTextWidth(l,{fontSize:d,fontFamily:c,fontWeight:f,fontStyle:g}),w=_u(u,y),_=md(h,d,d),A={lineWidth:0,stroke:m,opacity:p,strokeOpacity:C};if(n){A.lineWidth=n,a.setStrokeStyle(e,A,i,r,s),a.setLineDash(b),a.beginPath();const T=r+_+d+v;a.moveTo(i+w,T,o),a.lineTo(i+w+y,T,o),a.stroke()}if(t){A.lineWidth=t,a.setStrokeStyle(e,A,i,r,s),a.beginPath();const T=r+_+d/2;a.moveTo(i+w,T,o),a.lineTo(i+w+y,T,o),a.stroke()}}};Wp=ntt([Tt()],Wp);var ott=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Up=class{constructor(){this.type="chart",this.numberType=r1}contains(n,t,e){return!!n.AABBBounds.containsPoint(t)}};Up=ott([Tt()],Up);const stt=new ie((n,t,e,i)=>{e(Su)?i(Su).to(Yh).inSingletonScope():(n(Yh).toSelf().inSingletonScope(),n(Da).toService(Yh)),e(xu)?i(xu).to(Kh).inSingletonScope():(n(Kh).toSelf().inSingletonScope(),n(Da).toService(Kh)),n(Xh).toSelf().inSingletonScope(),n(YJ).to(Xh),n(zr).to(Xh),n(Up).toSelf().inSingletonScope(),n(qr).toService(Up),n(Rp).toSelf().inSingletonScope(),n(La).toService(Rp),n(Ep).toSelf().inSingletonScope(),n(La).toService(Ep),n(Mp).toSelf().inSingletonScope(),n(La).toService(Mp),n(Bp).toSelf().inSingletonScope(),n(La).toService(Bp),n(Op).toSelf().inSingletonScope(),n(Un).toService(Op),n(Hp).toSelf().inSingletonScope(),n(Un).toService(Hp),n(kp).toSelf().inSingletonScope(),n(Un).toService(kp),n(Pp).toSelf().inSingletonScope(),n(Un).toService(Pp),n(Lp).toSelf().inSingletonScope(),n(Un).toService(Lp),n(Dp).toSelf().inSingletonScope(),n(Un).toService(Dp),n(Ip).toSelf().inSingletonScope(),n(Un).toService(Ip),n(Fp).toSelf().inSingletonScope(),n(Un).toService(Fp),n(zp).toSelf().inSingletonScope(),n(Un).toService(zp),n(Np).toSelf().inSingletonScope(),n(Cd).toService(Np),n(Wp).toSelf().inSingletonScope(),n(vg).toService(Wp)});function Pn(n,t,e,i){var r,o,s,a,l,u,h,d;n.internalProps.columnWidthConfig&&n._parseColumnWidthConfig(n.internalProps.columnWidthConfig),n.isPivotTable()&&n.internalProps.columnWidthConfigForRowHeader&&n._parseColumnWidthConfigForRowHeader(n.internalProps.columnWidthConfigForRowHeader),t=t??0,e=e??n.colCount-1,t===0&&e===n.colCount-1&&n._clearColRangeWidthsMap();const c=n.internalProps.layoutMap;n.isPivotTable()&&(c.enableUseGetBodyCache(),c.enableUseHeaderPathCache());const f=[],g=[];if(i)for(let m=0;m<n.colCount;m++)f[m]=n.getColWidth(m);for(let m=t;m<=e;m++){let p;if(n.internalProps.transpose||((o=(r=n.internalProps.layoutMap.columnObjects)===null||r===void 0?void 0:r[m])===null||o===void 0?void 0:o.columnWidthComputeMode)!=="only-header"&&n.columnWidthComputeMode!=="only-header"||!("showHeader"in n.internalProps.layoutMap))p=n.internalProps.transpose||((a=(s=n.internalProps.layoutMap.columnObjects)===null||s===void 0?void 0:s[m])===null||a===void 0?void 0:a.columnWidthComputeMode)!=="only-body"&&n.columnWidthComputeMode!=="only-body"?eu(m,0,n.rowCount-1,n):eu(m,n.internalProps.layoutMap.getBodyRange().start.row,n.internalProps.layoutMap.getBodyRange().end.row,n);else{const v=n.internalProps.layoutMap.showHeader;n.internalProps.layoutMap.showHeader=!0,p=eu(m,0,n.internalProps.layoutMap.headerLevelCount-1,n),n.internalProps.layoutMap.showHeader=v}n._setColContentWidth(m,p),n.getColWidth(m)!==p&&n._clearColRangeWidthsMap(m),i?g[m]=Math.round(n._adjustColWidth(m,p)):n._setColWidth(m,n._adjustColWidth(m,p),!1,!0)}if(n.widthMode==="adaptive"){n._clearColRangeWidthsMap();const m=n.tableNoFrameWidth;let p=0,v=0,b=n.colCount;if(n.widthAdaptiveMode==="only-body"){for(let C=0;C<n.colCount;C++){const y=i&&(l=g[C])!==null&&l!==void 0?l:n.getColWidth(C);(C<n.rowHeaderLevelCount||n.isPivotChart()&&C>=n.colCount-n.rightFrozenColCount)&&(p+=y)}v=n.rowHeaderLevelCount,b=n.isPivotChart()?n.colCount-n.rightFrozenColCount:n.colCount}Vp(m-p,v,b,i,g,n)}else if(n.autoFillWidth){n._clearColRangeWidthsMap();const m=n.tableNoFrameWidth;let p=0,v=0;for(let b=0;b<n.colCount;b++){const C=i&&(u=g[b])!==null&&u!==void 0?u:n.getColWidth(b);(b<n.rowHeaderLevelCount+n.leftRowSeriesNumberCount||n.isPivotChart()&&b>=n.colCount-n.rightFrozenColCount)&&(p+=C),v+=C}v<m&&v>p&&Vp(m-p,n.rowHeaderLevelCount+n.leftRowSeriesNumberCount,n.isPivotChart()?n.colCount-n.rightFrozenColCount:n.colCount,i,g,n)}if(i){for(let m=0;m<n.colCount;m++){const p=(d=(h=g[m])!==null&&h!==void 0?h:n.getColWidth(m))!==null&&d!==void 0?d:n.getColWidth(m);p!==f[m]&&n._setColWidth(m,p,!1,!0)}n.stateManager.checkFrozen();for(let m=0;m<n.colCount;m++){const p=n.getColWidth(m);p!==f[m]&&n.scenegraph.updateColWidth(m,p-f[m],!0,!0)}n.scenegraph.updateContainer(!0)}n.isPivotTable()&&(c.disableUseGetBodyCache(),c.disableUseHeaderPathCache())}function eu(n,t,e,i,r=!1){let o=htt(n,i);return i.internalProps.transpose&&o==="auto"&&(i.columnWidthComputeMode==="only-header"&&n>=i.rowHeaderLevelCount||i.columnWidthComputeMode==="only-body"&&n<i.rowHeaderLevelCount)&&(o=i.getDefaultColumnWidth(n)),r&&!i.internalProps.transpose?LE(o,n,t,e,r,i):typeof o=="number"?o:o!=="auto"&&typeof o=="string"?i._adjustColWidth(n,i._colWidthDefineToPxWidth(o)):LE(o,n,t,e,r,i)}function LE(n,t,e,i,r,o){var s,a,l,u,h;let d=0,c=1,f=1;if(i-e>5e3&&(f=Math.ceil((i-e)/5e3)),o.isPivotChart()&&t>=o.rowHeaderLevelCount&&t<o.colCount-o.rightFrozenColCount){if(o.internalProps.layoutMap.indicatorsAsCol)return o.defaultColWidth;{const p=o.internalProps.layoutMap.getOptimunWidthForChart(t);if(p>0)return p}}for(let p=e;p<=i;p+=c){if(o.isPivotChart()){const A=o.internalProps.layoutMap,T=A.getAxisConfigInPivotChart(t,p);if(T){const S=Gt.getFunction("computeAxisComponentWidth")(T,o);if(typeof S=="number"){d=Math.max(S,d);continue}}else if(A.isLeftBottomCorner(t,p)||A.isRightTopCorner(t,p)||A.isRightBottomCorner(t,p))continue}const v=att(t,p,o);if(v&&(d=Math.max(v.width,d),!v.renderDefault))continue;const b=n;if(typeof b=="number"&&o.widthMode==="standard"&&!r){d=Math.max(b,d);continue}const C=o.isHeader(t,p)?(s=o._getHeaderLayoutMap(t,p))===null||s===void 0?void 0:s.headerType:o.getBodyColumnType(t,p);if(et(C)&&C!=="text"&&C!=="link"&&C!=="progressbar"&&C!=="checkbox"&&C!=="radio"&&C!=="switch"&&C!=="button"){d=Math.max(d,o.getColWidthDefinedNumber(t)||0);continue}let y=0;const w=o.internalProps.layoutMap;if(w.isHeader(t,p)){const A=w.getHeader(t,p);if(((a=A==null?void 0:A.define)===null||a===void 0?void 0:a.columnWidthComputeMode)==="only-body")continue;et(A==null?void 0:A.hierarchyLevel)&&(y=((l=A.hierarchyLevel)!==null&&l!==void 0?l:0)*(w.rowHierarchyType==="tree"&&(u=w.rowHierarchyIndent)!==null&&u!==void 0?u:0),w.rowHierarchyTextStartAlignment&&!o.internalProps.headerHelper.getHierarchyIcon(t,p)&&(y+=o.internalProps.headerHelper.getHierarchyIconWidth()))}else if(o.isListTable()){c=f;const A=o.getBodyColumnDefine(t,p);if(A!=null&&A.tree){const T=o.dataSource.getIndexKey(o.getRecordShowIndexByCell(t,p));y=Array.isArray(T)&&o.getHierarchyState(t,p)!==Yt.none?(T.length-1)*((h=w.hierarchyIndent)!==null&&h!==void 0?h:0):0,w.hierarchyTextStartAlignment&&!o.internalProps.bodyHelper.getHierarchyIcon(t,p)&&(y+=o.internalProps.headerHelper.getHierarchyIconWidth())}}const _=ltt(t,p,C,o);d=Math.max(_+y,d),c>1&&o.bottomFrozenRowCount>0&&p<o.rowCount-o.bottomFrozenRowCount&&p+c>=o.rowCount-o.bottomFrozenRowCount&&(p=o.rowCount-o.bottomFrozenRowCount-c,c=1,f=1)}const g=o.getMinColWidth(t),m=o.getMaxColWidth(t);return d<g?g:d>m?m:(d<=0&&(d=o.defaultColWidth),d)}function att(n,t,e){var i,r,o,s,a,l,u;const h=e.getCustomRender(n,t);let d=e.getCustomLayout(n,t);if(h||d){let c,f=1,g=0,m=!1,p=!1;(e.isHeader(n,t)||!((i=e.getBodyColumnDefine(n,t))===null||i===void 0)&&i.mergeCell||e.hasCustomMerge())&&(c=e.getCellRange(n,t),f=c.end.col-c.start.col+1);const v={col:(r=c==null?void 0:c.start.col)!==null&&r!==void 0?r:n,row:(o=c==null?void 0:c.start.row)!==null&&o!==void 0?o:t,dataValue:e.getCellOriginValue(n,t),value:e.getCellValue(n,t)||"",rect:utt(n,t,e),table:e,originCol:n,originRow:t,forComputation:!0};if(d==="react-custom-layout"&&(d=((s=e.reactCustomLayout)===null||s===void 0?void 0:s.getCustomLayoutFunc(n,t))||Bd),pn(d)){const b=d(v);if(b.rootContainer){b.rootContainer=Pd(b.rootContainer),o0(b.rootContainer,0,e.getRowHeight(t));const C=b.rootContainer.attribute.width;b.rootContainer.setStage(e.scenegraph.stage),g=C>0?C:(a=b.rootContainer.AABBBounds.width())!==null&&a!==void 0?a:0,m=b.renderDefault,p=b.enableCellPadding}else g=0,m=b.renderDefault,p=b.enableCellPadding}else if(typeof h=="function"){const b=h(v);g=(l=b==null?void 0:b.expectedWidth)!==null&&l!==void 0?l:0,m=b==null?void 0:b.renderDefault}else g=(u=h==null?void 0:h.expectedWidth)!==null&&u!==void 0?u:0,m=h==null?void 0:h.renderDefault;if(g=Math.ceil(g),p){const b=e._getCellStyle(n,t),C=me(pt("padding",b,n,t,e));g+=C[1]+C[3]}return{width:g/f,renderDefault:m}}}function ltt(n,t,e,i){var r,o,s,a;let l=0;const u=i.getCellValue(n,t),h=i._getCellStyle(n,t);let d=0,c=!1;if(i.getCellLocation(n,t)!=="body")c=!0;else{const w=i.getBodyColumnDefine(n,t);c=!!(w!=null&&w.icon)||!!(w!=null&&w.tree)||(w==null?void 0:w.dragOrder)}if(c){const w=i.getCellIcons(n,t);w==null||w.forEach(_=>{var A,T,S;_.positionType!==Be.absoluteRight&&(d+=((A=_.width)!==null&&A!==void 0?A:0)+((T=_.marginLeft)!==null&&T!==void 0?T:0)+((S=_.marginRight)!==null&&S!==void 0?S:0))})}let f=1;if(i.isHeader(n,t)||!((r=i.getBodyColumnDefine(n,t))===null||r===void 0)&&r.mergeCell||i.hasCustomMerge()){const w=i.getCellRange(n,t);f=w.end.col-w.start.col+1}const g=me(pt("padding",h,n,t,i)),m=g[1]+g[3],p=pt("fontSize",h,n,t,i),v=pt("fontFamily",h,n,t,i),b=pt("fontWeight",h,n,t,i);let C;if(e==="checkbox")C=Li(u)?u.text:u;else if(e==="radio")if(Wt(u)){C="";const w=i.getBodyColumnDefine(n,t),_=(o=w==null?void 0:w.radioDirectionInCell)!==null&&o!==void 0?o:"vertical";_==="vertical"?u.forEach(A=>{C+=(Li(A)?A.text:A).toString()+`
`}):_==="horizontal"&&u.forEach(A=>{C+=(Li(A)?A.text:A).toString()})}else C=Li(u)?u.text:u;else if(e==="button"){const w=i.getBodyColumnDefine(n,t),_=Me(w.text,{col:n,row:t,table:i,context:null,value:u,dataValue:i.getCellOriginValue(n,t)});C=(s=_??u)!==null&&s!==void 0?s:""}else C=u;const y=kd(C,i).text;if(y.length>=1&&(y.length!==1||y[0]!=="")?y.forEach(w=>{const _=i.measureText(w,{fontSize:p,fontFamily:v,fontWeight:b}).width;l=Math.max((_+m+4+d)/f,l)}):l=Math.max((m+4+d)/f,l),i.internalProps.limitMaxAutoWidth!==!1&&(l=Math.min(typeof i.internalProps.limitMaxAutoWidth=="number"?i.internalProps.limitMaxAutoWidth:450,l)),e==="checkbox"){const w=pt("size",h,n,t,i);if(l+=w,C){const _=pt("spaceBetweenTextAndIcon",h,n,t,i);l+=_}}else if(e==="radio"){const w=pt("size",h,n,t,i),_=pt("outerRadius",h,n,t,i),A=wt(_)?2*_:w,T=pt("spaceBetweenTextAndIcon",h,n,t,i);if(Wt(u)){const S=i.getBodyColumnDefine(n,t),x=pt("spaceBetweenRadio",h,n,t,i),E=(a=S==null?void 0:S.radioDirectionInCell)!==null&&a!==void 0?a:"vertical";E==="vertical"?(l+=A,l+=T):E==="horizontal"&&(l+=(A+T)*u.length,l+=x*(u.length-1))}else l+=A,C&&(l+=T)}else if(e==="switch")l=pt("boxWidth",h,n,t,i);else if(e==="button"){const w=pt("buttonPadding",h,n,t,i);l+=2*w}return l}function utt(n,t,e){return{left:0,top:0,right:e.getColWidth(n),bottom:e.getRowHeight(t),width:null,height:null}}function htt(n,t){const e=t.getColWidthDefined(n);return t.internalProps._widthResizedColMap.has(n)?t.getColWidth(n):e}function Vp(n,t,e,i,r,o,s){var a,l,u,h;let d=0;const c=[],f=[];let g=0;const m=new Map,p=new Map;for(let b=t;b<e;b++){const C=i&&(a=r[b])!==null&&a!==void 0?a:o.getColWidth(b),y=o.getMaxColWidth(b),w=o.getMinColWidth(b);d+=C,c.push(b),y===C?m.set(b,C):w===C&&p.set(b,C),!((l=o.options.customConfig)===null||l===void 0)&&l.shrinkSparklineFirst&&o.getBodyColumnType(b,0)==="sparkline"&&(f.push({col:b,width:C}),g+=C-o.defaultColWidth)}if(d>n)for(const[b,C]of p){n-=C,d-=C;const y=c.indexOf(b);y!==-1&&c.splice(y,1)}else if(d<n)for(const[b,C]of m){n-=C,d-=C;const y=c.indexOf(b);y!==-1&&c.splice(y,1)}const v=n/d;if(!((u=o.options.customConfig)===null||u===void 0)&&u.shrinkSparklineFirst&&v<1&&d-n<g)for(let b=0;b<f.length;b++){const{col:C,width:y}=f[b],w=(d-n)/f.length,_=Math.floor(y-w);i?r[C]=o._adjustColWidth(C,_):s?o.scenegraph.setColWidth(C,o._adjustColWidth(C,_)):o._setColWidth(C,o._adjustColWidth(C,_),!1,!0)}else for(let b=0;b<c.length;b++){const C=c[b];let y;y=b===c.length-1?n-c.reduce((w,_,A)=>{var T;return _!==C?w+(i?(T=r[_])!==null&&T!==void 0?T:o.getColWidth(C):o.getColWidth(_)):w},0):Math.round((i&&(h=r[C])!==null&&h!==void 0?h:o.getColWidth(C))*v),i?r[C]=o._adjustColWidth(C,y):s?o.scenegraph.setColWidth(C,o._adjustColWidth(C,y)):o._setColWidth(C,o._adjustColWidth(C,y),!1,!0)}}const jp=new de({});jp.role="empty";function If(n,t,e,i,r,o,s,a,l){var u,h;let d,c,f,g=0;n.lastChild&&n.lastChild.row===i-1?g=n.lastChild.attribute.y+n.lastChild.attribute.height:n.colHeight&&(g=n.colHeight);for(let m=i;m<=r;m++){const p=m;let v,b,C,y,w=a.getCellLocation(t,p),_=a.getCellValue(t,p),A=e,T=a.getRowHeight(p),S=!1;if(a.internalProps.customMergeCell){const N=a.getCustomMerge(t,p);if(N){const{range:U,text:W,style:j,customLayout:Y,customRender:Z}=N;if(v=U,b=v.start.col!==v.end.col||v.start.row!==v.end.row,b){const rt=DE(v,o,a,i>v.start.row);A=rt.cellWidth,T=rt.cellHeight}_=W,C=j,(Y||Z)&&(y=Xs(Y,Z,U.start.col,U.start.row,a.getColsWidth(U.start.col,U.end.col),a.getRowsHeight(U.start.row,U.end.row),!1,a.isAutoRowHeight(p),[0,0,0,0],v,a)),S=!0}}let x,E=t,M=p;v&&(E=v.start.col,M=v.start.row),!a.isPivotTable()&&(w==="columnHeader"||w==="cornerHeader")&&p>=a.columnHeaderLevelCount&&(w="body"),x=!a.isPivotTable()&&a.isSeriesNumberInBody(t,p)?a.getBodyColumnDefine(E,M):w!=="body"?a.getHeaderDefine(E,M):a.getBodyColumnDefine(E,M);const L="isAggregation"in a.internalProps.layoutMap&&a.internalProps.layoutMap.isAggregation(t,p),I=a.internalProps.layoutMap.isSeriesNumber(t,p);let D=w!=="body"||((x==null?void 0:x.dragOrder)||!!(x!=null&&x.icon)||!!(x!=null&&x.tree))&&!(L&&I);if(!v&&(a.internalProps.enableTreeNodeMerge||w!=="body"||x!=null&&x.mergeCell)&&(v=a.getCellRange(t,p),b=v.start.col!==v.end.col||v.start.row!==v.end.row,b)){const N=DE(v,o,a,i>v.start.row);A=N.cellWidth,T=N.cellHeight}let H=!1;if(a.internalProps.enableTreeNodeMerge&&b){const N=a.getCellRawRecord(v.start.col,v.start.row),{vtableMergeName:U,vtableMerge:W}=N??{};H=W,W&&(D=!0,a.options.groupTitleCustomLayout&&(y=Xs(a.options.groupTitleCustomLayout,void 0,v.start.col,v.start.row,a.getColsWidth(v.start.col,v.end.col),a.getRowsHeight(v.start.row,v.end.row),!1,a.isAutoRowHeight(p),[0,0,0,0],v,a)),a.options.groupTitleFieldFormat?_=a.options.groupTitleFieldFormat(N,t,p,a):U!==void 0&&(_=U))}const O=H||S?"text":(h=a.isHeader(t,p)?(u=a._getHeaderLayoutMap(t,p).headerType)!==null&&u!==void 0?u:"text":a.getBodyColumnType(t,p))!==null&&h!==void 0?h:"text";if(ao(_)){ctt(t,p,0,g,A,T,n),SI(_,a,dtt.bind(null,{type:O,value:_,define:x,table:a,col:t,row:p,colWidth:e,cellWidth:A,cellHeight:T,columnGroup:n,y:g,customStyle:C,mayHaveIcon:D,cellLocation:w,range:v,customResult:y,defaultRowHeight:s})),n.updateColumnRowNumber(p);const N=a.getRowHeight(p);n.updateColumnHeight(N),g+=N}else{const N=C||a._getCellStyle(v?v.start.col:t,v?v.start.row:p),U=Qs(N,a,v?v.start.col:t,v?v.start.row:p,pt).theme;U.group.cornerRadius=n0(t,p,a),U.group.width=e,U.group.height=Array.isArray(s)?s[p]:s,U._vtable.padding&&(d=U._vtable.padding),U.text.textAlign&&(c=U.text.textAlign),U.text.textBaseline&&(f=U.text.textBaseline),w==="body"||U.group.fill||(U.group.fill="#fff");const W=e1(O,_,x,a,t,p,e,A,T,n,g,d,c,f,D,U,v,y);if(n.updateColumnRowNumber(p),b){const j=a.getRowHeight(p),{width:Y}=(a.getColWidth(t),W.attribute),{height:Z}=W.attribute;W.contentWidth=Y,W.contentHeight=Z,TI(v,Y,Z,d,c,f,a),n.updateColumnHeight(j),g+=j}else n.updateColumnHeight(T),g+=T}}return n.setAttribute("width",e),{width:e,height:g}}function dtt(n){let t,e,i;const{type:r,value:o,define:s,table:a,col:l,row:u,colWidth:h,cellWidth:d,cellHeight:c,columnGroup:f,y:g,cellLocation:m,mayHaveIcon:p,customStyle:v,range:b,customResult:C,defaultRowHeight:y}=n,w=v||a._getCellStyle(b?b.start.col:l,b?b.start.row:u),_=Qs(w,a,b?b.start.col:l,b?b.start.row:u,pt).theme;_.group.cornerRadius=n0(l,u,a),_.group.width=h,_.group.height=Array.isArray(y)?y[u]:y,_._vtable.padding&&(t=_._vtable.padding),_.text.textAlign&&(e=_.text.textAlign),_.text.textBaseline&&(i=_.text.textBaseline),m==="body"||_.group.fill||(_.group.fill="#fff"),e1(r,o,s,a,l,u,h,d,c,f,g,t,e,i,p,_,b,C)}function DE(n,t,e,i){let r=0,o=0;const s=t.get(`${n.start.col},${n.start.row};${n.end.col},${n.end.row}`);if(!s||i){for(let a=n.start.col;a<=n.end.col;a++)r+=e.getColWidth(a);for(let a=n.start.row;a<=n.end.row;a++)o+=e.getRowHeight(a);t.set(`${n.start.col},${n.start.row};${n.end.col},${n.end.row}`,{cellWidth:r,cellHeight:o})}else r=s.cellWidth,o=s.cellHeight;return{cellWidth:r,cellHeight:o}}function ctt(n,t,e,i,r,o,s){const a=new de({x:e,y:i,width:r,height:o});a.role="cell",a.col=n,a.row=t,s.addChild(a)}function Wi(n,t,e,i,r,o,s,a,l,u){if(i>r||o>s)return;const{layoutMap:h,defaultHeaderRowHeight:d,defaultColWidth:c}=l.internalProps,f=l.defaultRowHeight;let g=0,m=0;for(let p=i;p<=r;p++){const v=p,b=l.getColWidth(v),C=new de({x:t+g,y:e,width:b,height:0,clip:!1,pickable:!1});C.role="column",C.col=p,n.addChild(C);const{width:y,height:w}=If(C,v,b,o,s,l.scenegraph.mergeMap,a==="columnHeader"&&wt(d)?d:f,l);g+=y,m=Math.max(m,w)}n.setAttribute("width",g),n.setAttribute("height",m)}function ftt(n,t,e,i,r,o,s,a,l){var u,h,d,c,f,g,m,p,v,b,C,y,w;const{table:_}=l,{leftBottomCornerGroup:A,rightTopCornerGroup:T,rightBottomCornerGroup:S}=_.scenegraph;let x,E,M,L;l.setParamsForRow(),l.setParamsForColumn(),(_.widthMode==="adaptive"||_.options.autoWrapText&&(_.heightMode==="adaptive"||_.isAutoRowHeight(_.columnHeaderLevelCount)))&&(M=_.colCount-1),x=Math.min(l.firstScreenColLimit-1,_.colCount-1),_.heightMode==="adaptive"&&(L=_.rowCount-1),E=Math.min(l.firstScreenRowLimit-1,_.rowCount-1),_.internalProps._widthResizedColMap.size===0&&Pn(_,0,M??x),_.internalProps._heightResizedRowMap.size===0&&Bn(_,0,_.options.canvasHeight==="auto"||!((u=_.options.customConfig)===null||u===void 0)&&u.forceComputeAllRowHeight?_.rowCount-1:L??E),x<_.colCount-_.rightFrozenColCount&&_.colCount-_.rightFrozenColCount<=_.colCount-1&&Pn(_,_.colCount-_.rightFrozenColCount,_.colCount-1),E<_.rowCount-_.bottomFrozenRowCount&&_.rowCount-_.bottomFrozenRowCount<=_.rowCount-1&&Bn(_,_.rowCount-_.bottomFrozenRowCount,_.rowCount-1),_.scenegraph.colHeaderGroup.setAttribute("x",_.getFrozenColsWidth()),_.scenegraph.rowHeaderGroup.setAttribute("y",_.getFrozenRowsHeight()),_.scenegraph.bottomFrozenGroup.setAttribute("x",_.getFrozenColsWidth()),_.scenegraph.rightFrozenGroup.setAttribute("y",_.getFrozenRowsHeight()),_.scenegraph.bodyGroup.setAttributes({x:_.getFrozenColsWidth(),y:_.getFrozenRowsHeight()}),Wi(n,s,a,0,_.frozenColCount-1,0,_.frozenRowCount-1,_.isListTable()?"columnHeader":"cornerHeader",_),x-_.rightFrozenColCount>=_.frozenColCount&&Wi(t,s,a,_.frozenColCount,x-_.rightFrozenColCount,0,_.frozenRowCount-1,"columnHeader",_),_.frozenColCount>0&&(_.leftRowSeriesNumberCount>0&&Wi(e,s,a,0,_.leftRowSeriesNumberCount-1,_.frozenRowCount,E-_.bottomFrozenRowCount,"rowHeader",_),_.frozenColCount>_.leftRowSeriesNumberCount&&Wi(e,s,a,_.leftRowSeriesNumberCount,Math.min(_.frozenColCount-1,_.rowHeaderLevelCount+_.leftRowSeriesNumberCount-1),_.frozenRowCount,E-_.bottomFrozenRowCount,"rowHeader",_),_.frozenColCount>_.rowHeaderLevelCount+_.leftRowSeriesNumberCount&&Wi(e,s,a,_.rowHeaderLevelCount+_.leftRowSeriesNumberCount,_.frozenColCount-1,_.frozenRowCount,E-_.bottomFrozenRowCount,"body",_)),_.bottomFrozenRowCount>0&&(_.frozenColCount>0&&(_.leftRowSeriesNumberCount>0&&Wi(A,s,a,0,_.leftRowSeriesNumberCount-1,_.rowCount-1-_.bottomFrozenRowCount+1,_.rowCount-1,"rowHeader",_),_.rowHeaderLevelCount>0&&Wi(A,s,a,_.leftRowSeriesNumberCount,_.leftRowSeriesNumberCount+_.rowHeaderLevelCount-1,_.rowCount-1-_.bottomFrozenRowCount+1,_.rowCount-1,"rowHeader",_),_.frozenColCount>_.rowHeaderLevelCount+_.leftRowSeriesNumberCount&&Wi(A,s,a,_.rowHeaderLevelCount+_.leftRowSeriesNumberCount,_.frozenColCount-1,_.rowCount-1-_.bottomFrozenRowCount+1,_.rowCount-1,"body",_)),x-_.rightFrozenColCount>=_.frozenColCount&&Wi(r,s,a,_.frozenColCount,x-_.rightFrozenColCount,_.rowCount-1-_.bottomFrozenRowCount+1,_.rowCount-1,_.isPivotChart()?"rowHeader":"body",_)),_.rightFrozenColCount>0&&(Wi(T,s,a,_.colCount-1-_.rightFrozenColCount+1,_.colCount-1,0,_.frozenRowCount-1,"columnHeader",_),Wi(i,s,a,_.colCount-1-_.rightFrozenColCount+1,_.colCount-1,_.frozenRowCount,E-_.bottomFrozenRowCount,_.isPivotChart()?"rowHeader":"body",_)),_.bottomFrozenRowCount>0&&_.rightFrozenColCount>0&&Wi(S,s,a,_.colCount-1-_.rightFrozenColCount+1,_.colCount-1,_.rowCount-1-_.bottomFrozenRowCount+1,_.rowCount-1,"body",_),x-_.rightFrozenColCount>=_.frozenColCount&&Wi(o,s,a,_.frozenColCount,x-_.rightFrozenColCount,_.frozenRowCount,E-_.bottomFrozenRowCount,"body",_),o.firstChild||t.firstChild||n.firstChild||e.firstChild?(l.currentRow=(f=(d=(h=o.firstChild)===null||h===void 0?void 0:h.rowNumber)!==null&&d!==void 0?d:(c=e.firstChild)===null||c===void 0?void 0:c.rowNumber)!==null&&f!==void 0?f:l.totalRow,l.rowEnd=l.currentRow,l.rowUpdatePos=l.rowEnd+1,l.referenceRow=l.rowStart+Math.floor((l.rowEnd-l.rowStart)/2),l.currentCol=(w=(C=(v=(m=(g=o.lastChild)===null||g===void 0?void 0:g.col)!==null&&m!==void 0?m:(p=t.lastChild)===null||p===void 0?void 0:p.col)!==null&&v!==void 0?v:(b=e.lastChild)===null||b===void 0?void 0:b.col)!==null&&C!==void 0?C:(y=n.lastChild)===null||y===void 0?void 0:y.col)!==null&&w!==void 0?w:l.totalCol,l.colEnd=l.currentCol,l.colUpdatePos=l.colEnd+1,l.referenceCol=l.colStart+Math.floor((l.colEnd-l.colStart)/2),l.progress()):(l.currentRow=l.totalRow,l.rowEnd=l.currentRow,l.rowUpdatePos=l.rowEnd+1,l.referenceRow=l.rowStart+Math.floor((l.rowEnd-l.rowStart)/2),l.currentCol=l.totalCol,l.colEnd=l.currentCol,l.colUpdatePos=l.colEnd+1,l.referenceCol=l.colStart+Math.floor((l.colEnd-l.colStart)/2))}function IE(n){let t=n.firstChild;for(;t&&t.type!=="group";)t=t._next;return t}function Dd(n){let t=n.lastChild;for(;t&&t.type!=="group";)t=t._prev;return t}function gtt(n){let t=n._prev;for(;t&&t.type!=="group";)t=t._prev;return t}function ptt(n){let t=n._next;for(;t&&t.type!=="group";)t=t._next;return t}function ny(n,t,e,i="left"){for(let a=n;a<=t;a++){const l=e.scenegraph.getColGroup(a);l&&Rb(l,e,i);const u=e.scenegraph.getColGroup(a,!0);u&&Rb(u,e,i);const h=e.scenegraph.getColGroupInBottom(a);h&&Rb(h,e,i)}const r=Math.min(e.scenegraph.proxy.colLimit,e.scenegraph.proxy.bodyRightCol-e.scenegraph.proxy.bodyLeftCol+1),o=e.getColsWidth(e.frozenColCount,e.frozenColCount+r),s=e.getColsWidth(e.frozenColCount,e.colCount-1);e.scenegraph.proxy.xLimitLeft=o/2,e.scenegraph.proxy.xLimitRight=s-o/2}function Rb(n,t,e="left"){if(e==="left"){let i;const r=gtt(n);i=r?r.attribute.x+t.getColWidth(n._prev.col):t.getColsWidth(t.frozenColCount,n.col-1),n.setAttribute("x",i)}else{let i;const r=ptt(n);i=r?r.attribute.x-t.getColWidth(n.col):t.getColsWidth(t.frozenColCount,n.col-1),n.setAttribute("x",i)}}var FI=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function mtt(n,t,e,i){return FI(this,void 0,void 0,function*(){if(!t)return;const r=t.col,o=t.left;let s;if(s=e?i.bodyRightCol-i.colEnd:i.screenLeftCol-i.referenceCol,vtt(s,r,o,n,i),e){const a=i.table.scenegraph.getColGroup(i.colEnd);if(a){const l=a.attribute.x+a.attribute.width-(i.table.tableNoFrameWidth-i.table.getFrozenColsWidth()-i.table.getRightFrozenColsWidth())-n;i.deltaX=-l,i.table.scenegraph.setBodyAndColHeaderX(-n+i.deltaX)}}i.table.scenegraph.updateNextFrame()})}function vtt(n,t,e,i,r){n>0?(FE(n,"left",r.screenLeftCol,e,i,r),r.updateDeltaX(i,e,t),r.table.scenegraph.setBodyAndColHeaderX(-i+r.deltaX)):n<0?(FE(-n,"right",r.screenLeftCol,e,i,r),r.updateDeltaX(i,e,t),r.table.scenegraph.setBodyAndColHeaderX(-i+r.deltaX)):(r.updateDeltaX(i,e,t),r.table.scenegraph.setBodyAndColHeaderX(-i+r.deltaX))}function FE(n,t,e,i,r,o){return FI(this,void 0,void 0,function*(){if(t==="left"&&o.colEnd+n>o.bodyRightCol?n=o.bodyRightCol-o.colEnd:t==="right"&&o.colStart-n<o.bodyLeftCol&&(n=o.colStart-o.bodyLeftCol),n!==0)if(n<0&&(t=t==="left"?"right":"left",n=-n),n<o.colEnd-o.colStart){const s=t==="left"?o.colStart:o.colEnd-n+1,a=t==="left"?o.colStart+n-1:o.colEnd,l=t==="left"?o.colEnd+1:o.colStart-n,u=t==="left"?o.colEnd+n:o.colStart-1;Pn(o.table,l,u),_tt(s,a,t,o);const h=l,d=u;o.colStart=t==="left"?o.colStart+n:o.colStart-n,o.colEnd=t==="left"?o.colEnd+n:o.colEnd-n,Id(h,d,o),ny(h,d,o.table,t);const c=o.table.scenegraph.getColGroup(e)||o.table.scenegraph.getColGroup(e,!0),f=i-(c.attribute.x+o.table.getFrozenColsWidth()+o.table.scenegraph.proxy.deltaX);o.table.scenegraph.proxy.deltaX+=f,o.currentCol=t==="left"?o.currentCol+n:o.currentCol-n,o.totalCol=Math.max(0,Math.min(o.table.colCount-1,t==="left"?o.totalCol+n:o.totalCol-n)),o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2),o.colUpdatePos=l,o.colUpdateDirection=t,o.table.scenegraph.updateNextFrame()}else{const s=t==="left"?o.colStart+n:o.colStart-n,a=t==="left"?o.colEnd+n:o.colEnd-n;Pn(o.table,s,a),Ctt(o.table.getColsWidth(o.bodyLeftCol,s-1),n,t,o);const l=s,u=a;o.colStart=s,o.colEnd=a,Id(l,u,o),ny(l,u,o.table,a>o.bodyRightCol-(o.colEnd-o.colStart+1)?"right":"left"),o.currentCol=t==="left"?o.currentCol+n:o.currentCol-n,o.totalCol=Math.max(0,Math.min(o.table.colCount-1,t==="left"?o.totalCol+n:o.totalCol-n)),o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2),o.colUpdatePos=o.colStart,o.colUpdateDirection=a>o.bodyRightCol-(o.colEnd-o.colStart+1)?"right":"left",o.table.scenegraph.updateNextFrame()}})}function Zh(n,t,e){n.col=t,n.forEachChildren(i=>{i.col=t,i.needUpdate=!0}),n.setAttribute("x",e),n.needUpdate=!0}function pf(n,t){if(!n)return;let e=n.firstChild;for(;e;)e=t.updateCellGroupContent(e)._next;n.needUpdate=!1,n.setAttribute("width",t.table.getColWidth(n.col))}function btt(n,t){if(!n)return;const e=t.screenTopRow,i=Math.max(t.bodyTopRow,e-1*t.screenRowCount),r=Math.min(t.bodyBottomRow,e+2*t.screenRowCount,t.table.rowCount-1);for(let o=i;o<=r;o++){const s=t.highPerformanceGetCell(n.col,o,!0);t.updateCellGroupContent(s)}t.rowUpdatePos=t.rowStart,n.needUpdate=!1,n.setAttribute("width",t.table.getColWidth(n.col))}function _tt(n,t,e,i){for(let r=n;r<=t;r++)i.table.scenegraph.bodyGroup.childrenCount>0&&i.table.scenegraph.bodyGroup.firstChild.type==="group"&&Eb(i.table.scenegraph.bodyGroup,e,i),i.table.scenegraph.colHeaderGroup.childrenCount>0&&i.table.scenegraph.colHeaderGroup.firstChild.type==="group"&&Eb(i.table.scenegraph.colHeaderGroup,e,i),i.table.scenegraph.bottomFrozenGroup.childrenCount>0&&i.table.scenegraph.bottomFrozenGroup.firstChild.type==="group"&&Eb(i.table.scenegraph.bottomFrozenGroup,e,i)}function Eb(n,t,e){if(t==="left"){const i=IE(n),r=Dd(n);Zh(i,r.col+1,r.attribute.x+e.table.getColWidth(r.col)),n.appendChild(i),n.border&&n.appendChild(n.border)}else{const i=Dd(n),r=IE(n);Zh(i,r.col-1,r.attribute.x-e.table.getColWidth(r.col-1)),n.insertBefore(i,n.firstChild)}}function Id(n,t,e){for(let i=n;i<=t;i++){const r=e.table.scenegraph.getColGroup(i,!0);r&&pf(r,e);const o=e.table.scenegraph.getColGroupInBottom(i);o&&pf(o,e);const s=e.table.scenegraph.getColGroupInRightTopCorner(i);s&&pf(s,e);const a=e.table.scenegraph.getColGroupInRightBottomCorner(i);a&&pf(a,e);const l=e.table.scenegraph.getColGroup(i);l&&btt(l,e)}Mb(e.table.scenegraph.colHeaderGroup),Mb(e.table.scenegraph.bottomFrozenGroup),Mb(e.table.scenegraph.bodyGroup),e.progress()}function Ctt(n,t,e,i){i.table.scenegraph.colHeaderGroup.forEachChildren((r,o)=>{r.type==="group"&&Zh(r,e==="left"?r.col+t:r.col-t,o===0?n:r._prev.attribute.x+i.table.getColWidth(r._prev.col))}),i.table.scenegraph.bottomFrozenGroup.forEachChildren((r,o)=>{r.type==="group"&&Zh(r,e==="left"?r.col+t:r.col-t,o===0?n:r._prev.attribute.x+i.table.getColWidth(r._prev.col))}),i.table.scenegraph.bodyGroup.forEachChildren((r,o)=>{r.type==="group"&&Zh(r,e==="left"?r.col+t:r.col-t,o===0?n:r._prev.attribute.x+i.table.getColWidth(r._prev.col))})}function Mb(n){var t,e;const i=Dd(n);if(i&&(n.setAttribute("width",i.attribute.x+i.attribute.width),n.border)){const r=n.border;r.setAttribute("width",i.attribute.x+i.attribute.width-((t=r.attribute.borderLeft)!==null&&t!==void 0?t:0)/2-((e=r.attribute.borderRight)!==null&&e!==void 0?e:0)/2)}}function an(n,t,e,i,r,o="up",s){var a,l;if(o==="up")for(let c=n;c<=t;c++)for(let f=e;f<=i;f++){const g=r.scenegraph.highPerformanceGetCell(c,f,!0);if(g.role!=="cell"||!g.row)continue;let m;if(g._prev)m=((a=g._prev)===null||a===void 0?void 0:a.attribute.y)+r.getRowHeight(g._prev.row);else if(s){const p=i===r.rowCount-r.bottomFrozenRowCount-1?i:i+1;if(m=r.scenegraph.highPerformanceGetCell(c,p,!0).attribute.y,et(m))for(let v=f;v<p;v++)m-=r.getRowHeight(v)}else m=OE(g.row,r);et(m)&&g.setAttribute("y",m)}else for(let c=n;c<=t;c++)for(let f=i;f>=e;f--){const g=r.scenegraph.highPerformanceGetCell(c,f,!0);if(g.role!=="cell"||!g.row)continue;let m;if(g._next)m=((l=g._next)===null||l===void 0?void 0:l.attribute.y)-r.getRowHeight(g.row);else if(s){const p=e<=r.frozenRowCount?r.frozenRowCount:e-1;e<=r.frozenRowCount?m=0:m=r.scenegraph.highPerformanceGetCell(c,p,!0).attribute.y;for(let v=p;v<f;v++)m+=r.getRowHeight(v)}else m=OE(g.row,r);et(m)&&g.setAttribute("y",m)}const u=Math.min(r.scenegraph.proxy.rowLimit,r.scenegraph.proxy.bodyBottomRow-r.scenegraph.proxy.bodyTopRow+1),h=r.getRowsHeight(r.frozenRowCount,r.frozenRowCount+u),d=r.getRowsHeight(r.frozenRowCount,r.rowCount-1);r.scenegraph.proxy.yLimitTop=h/2,r.scenegraph.proxy.yLimitBottom=d-h/2}function OE(n,t){let e;return e=n<t.frozenRowCount?t.getRowsHeight(0,n-1):n>=t.rowCount-t.bottomFrozenRowCount?t.getRowsHeight(t.rowCount-t.bottomFrozenRowCount,n-1):t.getRowsHeight(t.frozenRowCount,n-1),e}var OI=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function ytt(n,t,e,i){return OI(this,void 0,void 0,function*(){if(!t)return;const r=t.row,o=t.top;let s;if(s=e?i.bodyBottomRow-i.rowEnd:r-i.referenceRow,wtt(s,r,o,n,i),e){const a=i.table.scenegraph.highPerformanceGetCell(i.colStart,i.rowEnd,!0);if(a.role==="cell"){const l=a.attribute.y+a.attribute.height-(i.table.tableNoFrameHeight-i.table.getFrozenRowsHeight()-i.table.getBottomFrozenRowsHeight())-n;i.deltaY=-l,i.updateBody(n-i.deltaY)}}})}function wtt(n,t,e,i,r){n>0?(HE(n,"up",t,e,i,r),r.updateDeltaY(i,e,t),r.updateBody(i-r.deltaY)):n<0?(HE(-n,"down",t,e,i,r),r.updateDeltaY(i,e,t),r.updateBody(i-r.deltaY)):(r.updateDeltaY(i,e,t),r.updateBody(i-r.deltaY))}function HE(n,t,e,i,r,o){return OI(this,void 0,void 0,function*(){if(t==="up"&&o.rowEnd+n>o.bodyBottomRow?n=o.bodyBottomRow-o.rowEnd:t==="down"&&o.rowStart-n<o.bodyTopRow&&(n=o.rowStart-o.bodyTopRow),n!==0)if(n<0&&(t=t==="up"?"down":"up",n=-n),n<o.rowEnd-o.rowStart){const s=t==="up"?o.rowStart:o.rowEnd-n+1,a=t==="up"?o.rowStart+n-1:o.rowEnd,l=t==="up"?o.rowEnd+1:o.rowStart-n,u=t==="up"?o.rowEnd+n:o.rowStart-1;let h,d;o.table.isAutoRowHeight(s)?(h=l,d=u):(h=Math.max(o.bodyTopRow,e-1*o.screenRowCount),d=Math.min(o.bodyBottomRow,e+2*o.screenRowCount,o.table.rowCount-1)),Bn(o.table,h,d,!1),Stt(s,a,t,o),o.rowStart=t==="up"?o.rowStart+n:o.rowStart-n,o.rowEnd=t==="up"?o.rowEnd+n:o.rowEnd-n;const c=Fd(h,d,o,!0);o.table.isAutoRowHeight(s)&&(an(o.bodyLeftCol,o.bodyRightCol,h,d,o.table,u>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",!0),an(0,o.table.frozenColCount-1,h,d,o.table,u>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",!0),an(o.table.colCount-o.table.rightFrozenColCount,o.table.colCount-1,h,d,o.table,u>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",!0)),o.currentRow=t==="up"?o.currentRow+n:o.currentRow-n,o.totalRow=Math.max(0,Math.min(o.bodyBottomRow,t==="up"?o.totalRow+n:o.totalRow-n,o.table.rowCount-1)),o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.table.isAutoRowHeight(s)&&c?o.rowUpdatePos=Math.min(o.rowUpdatePos,o.rowEnd+1):o.rowUpdatePos=Math.min(o.rowUpdatePos,l),o.rowUpdateDirection=t,o.table.scenegraph.updateNextFrame(),yield o.progress()}else{const s=t==="up"?o.rowStart+n:o.rowStart-n,a=Math.min(o.table.rowCount-1,t==="up"?o.rowEnd+n:o.rowEnd-n),l=o.table.getRowsHeight(o.bodyTopRow,s-1);let u,h;o.table.isAutoRowHeight(s)?(u=s,h=a):(u=Math.max(o.bodyTopRow,e-1*o.screenRowCount),h=Math.min(o.bodyBottomRow,e+2*o.screenRowCount,o.table.rowCount-1)),Bn(o.table,u,h,!1),xtt(l,n,t,o),o.rowStart=s,o.rowEnd=a;const d=Fd(u,h,o,!0);o.table.isAutoRowHeight(s)&&(an(o.bodyLeftCol,o.bodyRightCol,u,h,o.table,a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up"),an(0,o.table.frozenColCount-1,u,h,o.table,a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up"),an(o.table.colCount-o.table.rightFrozenColCount,o.table.colCount-1,u,h,o.table,a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up")),o.currentRow=t==="up"?o.currentRow+n:o.currentRow-n,o.totalRow=Math.max(0,Math.min(o.bodyBottomRow,t==="up"?o.totalRow+n:o.totalRow-n,o.table.rowCount-1)),o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.table.isAutoRowHeight(s)&&d?o.rowUpdatePos=o.rowEnd+1:o.rowUpdatePos=o.rowStart,o.rowUpdateDirection=a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",o.table.scenegraph.updateNextFrame(),yield o.progress()}})}function Stt(n,t,e,i){for(let r=0;r<i.table.frozenColCount;r++){const o=i.table.scenegraph.getColGroup(r);if(o)for(let s=n;s<=t;s++)Bb(o,e,i)}for(let r=i.table.colCount-i.table.rightFrozenColCount;r<i.table.colCount;r++){const o=i.table.scenegraph.getColGroup(r);if(o)for(let s=n;s<=t;s++)Bb(o,e,i)}for(let r=i.bodyLeftCol;r<=i.bodyRightCol;r++){const o=i.table.scenegraph.getColGroup(r);if(o)for(let s=n;s<=t;s++)Bb(o,e,i)}}function Bb(n,t,e){if(n.childrenCount>=1)if(t==="up"){const i=n.firstChild;e.updateCellGroupPosition(i,n.lastChild.row+1,n.lastChild.attribute.y+e.table.getRowHeight(n.lastChild.row)),n.appendChild(i)}else{const i=n.lastChild;e.updateCellGroupPosition(i,n.firstChild.row-1,n.firstChild.attribute.y-e.table.getRowHeight(i.row)),n.insertBefore(i,n.firstChild)}}function xtt(n,t,e,i){for(let r=0;r<i.table.frozenColCount;r++){const o=i.table.scenegraph.getColGroup(r);o==null||o.forEachChildren((s,a)=>{i.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,a===0?n:s._prev.attribute.y+i.table.getRowHeight(s._prev.row))})}for(let r=i.table.colCount-i.table.rightFrozenColCount;r<i.table.colCount;r++){const o=i.table.scenegraph.getColGroup(r);o==null||o.forEachChildren((s,a)=>{i.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,a===0?n:s._prev.attribute.y+i.table.getRowHeight(s._prev.row))})}for(let r=i.bodyLeftCol;r<=i.bodyRightCol;r++){const o=i.table.scenegraph.getColGroup(r);o==null||o.forEachChildren((s,a)=>{i.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,a===0?n:s._prev.attribute.y+i.table.getRowHeight(s._prev.row))})}}function Fd(n,t,e,i=!1){for(let a=0;a<e.table.frozenColCount;a++)for(let l=n;l<=t;l++){const u=e.highPerformanceGetCell(a,l,!0);e.updateCellGroupContent(u)}for(let a=e.table.colCount-e.table.rightFrozenColCount;a<e.table.colCount;a++)for(let l=n;l<=t;l++){const u=e.highPerformanceGetCell(a,l);e.updateCellGroupContent(u)}let r=e.bodyLeftCol,o=e.bodyRightCol,s=!0;if(i){const a=e.screenLeftCol;r=Math.max(e.bodyLeftCol,a-1*e.screenColCount),o=Math.min(e.bodyRightCol,a+2*e.screenColCount),r===e.bodyLeftCol&&o===e.bodyRightCol||(s=!1)}for(let a=r;a<=o;a++)for(let l=n;l<=t;l++){const u=e.highPerformanceGetCell(a,l);e.updateCellGroupContent(u)}return Pb(e.table.scenegraph.rowHeaderGroup),Pb(e.table.scenegraph.rightFrozenGroup),Pb(e.table.scenegraph.bodyGroup),e.table.scenegraph.updateNextFrame(),s}function Pb(n){var t,e;const i=Dd(n);if(!i)return;const r=Dd(i);if(r&&(n.setAttribute("height",r.attribute.y+r.attribute.height),n.border)){const o=n.border;o.setAttribute("height",r.attribute.y+r.attribute.height-((t=o.attribute.borderTop)!==null&&t!==void 0?t:0)/2-((e=o.attribute.borderBottom)!==null&&e!==void 0?e:0)/2)}}var Ttt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function Att(n){var t;return Ttt(this,void 0,void 0,function*(){let e,i;n.table.scenegraph.bodyGroup.forEachChildren((s,a)=>{s.type==="group"&&(s.needUpdate=!0,s==null||s.forEachChildren(l=>{l.needUpdate=!0}))}),n.table.isAutoRowHeight(n.rowStart)?(e=n.rowStart,i=n.rowEnd):(e=Math.max(n.bodyTopRow,n.screenTopRow-1*n.screenRowCount),i=Math.min(n.bodyBottomRow,n.screenTopRow+2*n.screenRowCount,n.table.rowCount-1));const r=n.table.getAllRowsHeight();Bn(n.table,e,i);const o=n.table.getAllRowsHeight();r!==o&&n.table.scenegraph.updateContainerHeight(n.table.frozenRowCount,o-r);for(let s=0;s<((t=n.table.frozenColCount)!==null&&t!==void 0?t:0);s++){const a=n.table.scenegraph.getColGroup(s);a==null||a.setAttribute("chartInstance",void 0);for(let l=n.rowStart;l<=n.rowEnd;l++)n.table.scenegraph.updateCellContent(s,l);for(let l=n.table.rowCount-n.table.bottomFrozenRowCount;l<n.table.rowCount;l++)n.table.scenegraph.updateCellContent(s,l)}for(let s=n.colStart;s<=n.colEnd;s++){const a=n.table.scenegraph.getColGroup(s);a==null||a.setAttribute("chartInstance",void 0);for(let l=n.table.rowCount-n.table.bottomFrozenRowCount;l<n.table.rowCount;l++)n.table.scenegraph.updateCellContent(s,l)}for(let s=n.table.colCount-n.table.rightFrozenColCount;s<n.table.colCount;s++){const a=n.table.scenegraph.getColGroup(s);a==null||a.setAttribute("chartInstance",void 0);for(let l=n.rowStart;l<=n.rowEnd;l++)n.table.scenegraph.updateCellContent(s,l);for(let l=n.table.rowCount-n.table.bottomFrozenRowCount;l<n.table.rowCount;l++)n.table.scenegraph.updateCellContent(s,l)}Fd(e,i,n),n.table.isAutoRowHeight(e)&&an(n.bodyLeftCol,n.bodyRightCol,e,i,n.table,n.rowEnd>n.bodyBottomRow-(n.rowEnd-n.rowStart+1)?"down":"up"),n.rowUpdatePos=n.rowStart,n.rowUpdateDirection=n.rowEnd>n.bodyBottomRow-(n.rowEnd-n.rowStart+1)?"down":"up",n.table.scenegraph.updateNextFrame(),n.table.isAutoRowHeight(n.rowStart)||(yield n.progress())})}var Rtt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function Ett(n){return Rtt(this,void 0,void 0,function*(){n.table.scenegraph.bodyGroup.forEachChildren((i,r)=>{i.type==="group"&&(i.needUpdate=!0,i==null||i.forEachChildren(o=>{o.needUpdate=!0}))});const t=Math.max(n.bodyLeftCol,n.screenLeftCol-1*n.screenColCount),e=Math.min(n.bodyRightCol,n.screenLeftCol+2*n.screenColCount);Pn(n.table,t,e);for(let i=n.colStart;i<=n.colEnd;i++){const r=n.table.scenegraph.getColGroup(i);r==null||r.setAttribute("chartInstance",void 0);for(let o=n.table.rowCount-n.table.bottomFrozenRowCount;o<n.table.rowCount;o++)n.table.scenegraph.updateCellContent(i,o)}for(let i=n.table.colCount-n.table.rightFrozenColCount;i<n.table.colCount;i++){const r=n.table.scenegraph.getColGroup(i);r==null||r.setAttribute("chartInstance",void 0);for(let o=n.rowStart;o<=n.rowEnd;o++)n.table.scenegraph.updateCellContent(i,o);for(let o=n.table.rowCount-n.table.bottomFrozenRowCount;o<n.table.rowCount;o++)n.table.scenegraph.updateCellContent(i,o)}Id(t,e,n),n.colUpdatePos=n.colStart,n.colUpdateDirection=n.colEnd>n.bodyRightCol-(n.colEnd-n.colStart+1)?"right":"left",n.table.scenegraph.updateNextFrame(),yield n.progress()})}function o1(n){const{changedCells:t}=n.internalProps.stick;return t.forEach(e=>{n.scenegraph.getCell(e.col,e.row).forEachChildren(i=>{i.setAttributes({dx:e.dx,dy:e.dy})})}),t.clear(),t}function Qh(n){const t=o1(n),{scrollTop:e,scrollLeft:i,frozenRowCount:r,frozenColCount:o}=n,s=n.getFrozenRowsHeight(),a=n.getFrozenColsWidth(),{row:l}=n.getRowAt(e+s+1),{col:u}=n.getColAt(i+a+1),h=Math.max(l,n.frozenRowCount),d=Math.max(u,n.frozenColCount),c=n.getAllRowsHeight()>n.tableNoFrameHeight?n.getRowAt(e+n.tableNoFrameHeight-n.getBottomFrozenRowsHeight()-1).row:n.rowCount-n.bottomFrozenRowCount-1,f=n.getAllColsWidth()>n.tableNoFrameWidth?n.getColAt(i+n.tableNoFrameWidth-n.getRightFrozenColsWidth()-1).col:n.colCount-n.rightFrozenColCount-1;if(!(f<0||c<0)){for(let g=0;g<r&&!(f<d);g++)[d,f].forEach(m=>{const p=n._getCellStyle(m,g);p!=null&&p.textStick&&(p==null?void 0:p.textStick)!=="vertical"&&WE(n.scenegraph.getCell(m,g),a+n.tableX,n.tableNoFrameWidth-n.getRightFrozenColsWidth()+n.tableX,t,p==null?void 0:p.textStickBaseOnAlign,n)});for(let g=0;g<o&&!(c<h);g++)[h,c].forEach(m=>{const p=n._getCellStyle(g,m);p!=null&&p.textStick&&(p==null?void 0:p.textStick)!=="horizontal"&&zE(n.scenegraph.getCell(g,m),s+n.tableY,n.tableNoFrameHeight-n.getBottomFrozenRowsHeight()+n.tableY,t,p==null?void 0:p.textStickBaseOnAlign,n)});for(let g=d;g<=f&&!(c<h);g++)[h,c].forEach(m=>{const p=n._getCellStyle(g,m);p!=null&&p.textStick&&(p==null?void 0:p.textStick)!=="horizontal"&&zE(n.scenegraph.getCell(g,m),s+n.tableY,n.tableNoFrameHeight-n.getBottomFrozenRowsHeight()+n.tableY,t,p==null?void 0:p.textStickBaseOnAlign,n)});for(let g=h;g<=c&&!(f<d);g++)[d,f].forEach(m=>{const p=n._getCellStyle(m,g);p!=null&&p.textStick&&(p==null?void 0:p.textStick)!=="vertical"&&WE(n.scenegraph.getCell(m,g),a+n.tableX,n.tableNoFrameWidth-n.getRightFrozenColsWidth()+n.tableX,t,p==null?void 0:p.textStickBaseOnAlign,n)})}}function zE(n,t,e,i,r,o){if(wt(n.mergeStartCol)&&wt(n.mergeStartRow)&&wt(n.mergeEndCol)&&wt(n.mergeEndRow)){const{colStart:s,colEnd:a,rowStart:l,rowEnd:u}=Js(n,o.scenegraph);for(let h=s;h<=a;h++)for(let d=l;d<=u;d++){const c=o.scenegraph.getCell(h,d);c.role==="cell"&&NE(c,t,e,i,r)}}else NE(n,t,e,i,r)}function NE(n,t,e,i,r){var o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w;const _=n.getChildByName("text",!0)||n.getChildByName("image",!0);if(!_)return;if(_.type==="image"){const{image:x}=_.attribute;if(!x||!_.resources||_.resources.get(x).state!=="success")return}const A=(o=_.textBaseline)!==null&&o!==void 0?o:"top";_.AABBBounds.width();const T=_.globalAABBBounds.y1,S=_.globalAABBBounds.y2;if(A==="middle"&&r){const x=n.globalAABBBounds.y1+((a=(s=n.firstChild)===null||s===void 0?void 0:s.attribute.dy)!==null&&a!==void 0?a:0),E=x+((u=(l=n.contentHeight)!==null&&l!==void 0?l:n.attribute.height)!==null&&u!==void 0?u:0);if(x<t||E>e){const M=Math.max(x,t),L=Math.min(E,e),I=_.globalTransMatrix.f-(L+M)/2+_.AABBBounds.height()/2;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(d=(h=n.firstChild)===null||h===void 0?void 0:h.attribute.dx)!==null&&d!==void 0?d:0,dy:(f=(c=n.firstChild)===null||c===void 0?void 0:c.attribute.dy)!==null&&f!==void 0?f:0}),n.forEachChildren(D=>{var H;D.setAttribute("dy",((H=D.attribute.dy)!==null&&H!==void 0?H:0)-I+2)})}}else if(T<t){const x=T-t;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(m=(g=n.firstChild)===null||g===void 0?void 0:g.attribute.dx)!==null&&m!==void 0?m:0,dy:(v=(p=n.firstChild)===null||p===void 0?void 0:p.attribute.dy)!==null&&v!==void 0?v:0}),n.forEachChildren(E=>{var M;E.setAttribute("dy",((M=E.attribute.dy)!==null&&M!==void 0?M:0)-x+2)})}else if(S>e){const x=S-e;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(C=(b=n.firstChild)===null||b===void 0?void 0:b.attribute.dx)!==null&&C!==void 0?C:0,dy:(w=(y=n.firstChild)===null||y===void 0?void 0:y.attribute.dy)!==null&&w!==void 0?w:0}),n.forEachChildren(E=>{var M;E.setAttribute("dy",((M=E.attribute.dy)!==null&&M!==void 0?M:0)-x)})}}function WE(n,t,e,i,r,o){if(wt(n.mergeStartCol)&&wt(n.mergeStartRow)&&wt(n.mergeEndCol)&&wt(n.mergeEndRow)){const{colStart:s,colEnd:a,rowStart:l,rowEnd:u}=Js(n,o.scenegraph);for(let h=s;h<=a;h++)for(let d=l;d<=u;d++){const c=o.scenegraph.getCell(h,d);c.role==="cell"&&UE(c,t,e,i,r)}}else UE(n,t,e,i,r)}function UE(n,t,e,i,r){var o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_;const A=n.getChildByName("text",!0)||n.getChildByName("image",!0);if(!A)return;if(A.type==="image"){const{image:E}=A.attribute;if(!E||!A.resources||A.resources.get(E).state!=="success")return}const T=(s=(o=A.attribute.textAlign)!==null&&o!==void 0?o:A.textAlign)!==null&&s!==void 0?s:"left";A.AABBBounds.width();const S=A.globalAABBBounds.x1,x=A.globalAABBBounds.x2;if(T==="center"&&r){const E=n.globalAABBBounds.x1+((l=(a=n.firstChild)===null||a===void 0?void 0:a.attribute.dx)!==null&&l!==void 0?l:0),M=E+((h=(u=n.contentWidth)!==null&&u!==void 0?u:n.attribute.width)!==null&&h!==void 0?h:0);if(E<t||M>e){const L=Math.max(E,t),I=Math.min(M,e),D=A.globalTransMatrix.e-(I+L)/2;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(c=(d=n.firstChild)===null||d===void 0?void 0:d.attribute.dx)!==null&&c!==void 0?c:0,dy:(g=(f=n.firstChild)===null||f===void 0?void 0:f.attribute.dy)!==null&&g!==void 0?g:0}),n.forEachChildren(H=>{var O;H.setAttribute("dx",((O=H.attribute.dx)!==null&&O!==void 0?O:0)-D+2)})}}else if(S<t){const E=S-t;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(p=(m=n.firstChild)===null||m===void 0?void 0:m.attribute.dx)!==null&&p!==void 0?p:0,dy:(b=(v=n.firstChild)===null||v===void 0?void 0:v.attribute.dy)!==null&&b!==void 0?b:0}),n.forEachChildren(M=>{var L;M.setAttribute("dx",((L=M.attribute.dx)!==null&&L!==void 0?L:0)-E+2)})}else if(x>e){const E=x-e;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(y=(C=n.firstChild)===null||C===void 0?void 0:C.attribute.dx)!==null&&y!==void 0?y:0,dy:(_=(w=n.firstChild)===null||w===void 0?void 0:w.attribute.dy)!==null&&_!==void 0?_:0}),n.forEachChildren(M=>{var L;M.setAttribute("dx",((L=M.attribute.dx)!==null&&L!==void 0?L:0)-E)})}}function Gp(n){var t,e;const i=n.internalProps.layoutMap.headerObjects,r=n.internalProps.layoutMap.columnObjects;for(let o=0;o<i.length;o++){const s=i[o];if(s&&(!((t=s.style)===null||t===void 0)&&t.textStick))return!0}for(let o=0;o<r.length;o++){const s=r[o];if(s&&(!((e=s.style)===null||e===void 0)&&e.textStick))return!0}return!!(n.theme.headerStyle.textStick||n.theme.rowHeaderStyle.textStick||n.theme.bodyStyle.textStick)}var yn=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};class Mtt{constructor(t){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=t,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))):this.table.isAutoRowHeight(t.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)):(this.table.widthMode==="autoWidth"||(this.rowLimit=Math.max(200,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount),this.table.heightMode==="adaptive"&&(this.rowLimit=this.table.rowCount),this.table.widthMode==="adaptive"&&(this.colLimit=this.table.colCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;const t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;const e=this.table.defaultColWidth;this.taskColCount=1*Math.ceil(this.table.tableNoFrameWidth/e);const i=e*t,r=e*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=i/2,this.xLimitRight=r-i/2;const o=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(o/e))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;const t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.bodyTopRow+t-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;const e=this.table.defaultRowHeight;this.taskRowCount=1*Math.ceil(this.table.tableNoFrameHeight/e);const i=e*t,r=e*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=i/2,this.yLimitBottom=r-i/2;const o=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/e),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(o/e))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;const t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.rowStart+t-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;const t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){const t=this.table.defaultColWidth;this.taskColCount=1*Math.ceil(this.table.tableNoFrameWidth/t);const e=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(e/t));const i=this.table.defaultRowHeight;this.taskRowCount=1*Math.ceil(this.table.tableNoFrameHeight/i);const r=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/i),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(r/i))}createGroupForFirstScreen(t,e,i,r,o,s,a,l){ftt(t,e,i,r,o,s,a,l,this)}progress(){return yn(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((t,e)=>{setTimeout(()=>yn(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),Qh(this.table),this.table.scenegraph.updateNextFrame(),t())}),16)})})}createRow(){return yn(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return yn(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(t){const e=Math.min(this.totalRow,this.currentRow+t);if(this.table.heightMode!=="adaptive"&&Bn(this.table,this.currentRow+1,e,!1),this.rowEnd=e,this.table.frozenColCount){let r=0;for(let o=0;o<this.table.frozenColCount;o++){const s=this.table.scenegraph.getColGroup(o),{height:a}=(this.table.isListTable(),If(s,o,s.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));r=Math.max(r,a),this.table.scenegraph.rowHeaderGroup.setAttribute("height",r)}}if(this.table.rightFrozenColCount){let r=0;for(let o=this.table.colCount-this.table.rightFrozenColCount;o<this.table.colCount;o++){const s=this.table.scenegraph.getColGroup(o),{height:a}=(this.table.isPivotChart(),If(s,o,s.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));r=Math.max(r,a),this.table.scenegraph.rightFrozenGroup.setAttribute("height",r)}}let i=0;for(let r=this.bodyLeftCol;r<=this.bodyRightCol;r++){const o=this.table.scenegraph.getColGroup(r);if(!o)continue;this.table.rowHeaderLevelCount;const{height:s}=If(o,r,o.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);i=Math.max(i,s)}this.table.scenegraph.bodyGroup.setAttribute("height",i),this.currentRow=e,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(t){const e=Math.min(this.totalCol,this.currentCol+t);this.table.widthMode!=="adaptive"&&Pn(this.table,this.currentCol+1,e),this.colEnd=e;for(let s=0;s<this.table.rowCount;s++){const a=this.highPerformanceGetCell(this.currentCol,s);a.role==="cell"&&wt(a.mergeStartCol)&&a.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(a.col,a.row)}if(this.table.frozenRowCount){const s=this.table.scenegraph.colHeaderGroup.lastChild instanceof de?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,a=s.attribute.x+s.attribute.width,l=s.attribute.y;Wi(this.table.scenegraph.colHeaderGroup,a,l,this.currentCol+1,e,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){const s=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof de?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,a=s.attribute.x+s.attribute.width,l=s.attribute.y;Wi(this.table.scenegraph.bottomFrozenGroup,a,l,this.currentCol+1,e,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let i=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof de?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);i||(i=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof de?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));const r=i.attribute.x+i.attribute.width,o=i.attribute.y;Wi(this.table.scenegraph.bodyGroup,r,o,this.currentCol+1,e,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=e,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(t,e=!1){return yn(this,void 0,void 0,function*(){const i=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,r=this.table.getAllRowsHeight()-i,o=this.table.getTargetRowAt(t+this.table.scenegraph.colHeaderGroup.attribute.height);o&&(this.screenTopRow=o.row),t<i&&this.rowStart===this.bodyTopRow||t>r&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(t),this.updateBody(t-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&this.table.scenegraph.bodyGroup.firstChild.type==="group"&&this.table.scenegraph.bodyGroup.firstChild.childrenCount!==0||this.table.scenegraph.rowHeaderGroup.firstChild&&this.table.scenegraph.rowHeaderGroup.firstChild.type==="group"&&this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount!==0?this.dynamicSetY(t,o,e):(this.updateDeltaY(t),this.updateBody(t-this.deltaY))})}setX(t,e=!1){return yn(this,void 0,void 0,function*(){const i=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,r=this.table.getAllColsWidth()-i,o=this.table.getTargetColAt(t+this.table.scenegraph.rowHeaderGroup.attribute.width);o&&(this.screenLeftCol=o.col),t<i&&this.colStart===this.bodyLeftCol||t>r&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&this.table.scenegraph.bodyGroup.firstChild.type==="group"&&this.table.scenegraph.bodyGroup.firstChild.childrenCount===0?(this.updateDeltaX(t),this.table.scenegraph.setBodyAndColHeaderX(-t+this.deltaX)):this.dynamicSetX(t,o,e)})}dynamicSetY(t,e,i=!1){return yn(this,void 0,void 0,function*(){ytt(t,e,i,this)})}dynamicSetX(t,e,i=!1){return yn(this,void 0,void 0,function*(){mtt(t,e,i,this)})}updateBody(t){this.table.scenegraph.setBodyAndRowHeaderY(-t)}updateRowCellGroupsAsync(){return yn(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(t){const e=Math.min(this.bodyBottomRow,this.rowUpdatePos+t);this.table.isAutoRowHeight(this.rowUpdatePos)&&Bn(this.table,this.rowUpdatePos,e,!1),Fd(this.rowUpdatePos,e,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(an(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),an(0,this.table.frozenColCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),an(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=e+1}updateBottomFrozenCellGroups(){const t=this.table.rowCount-this.table.bottomFrozenRowCount,e=this.table.rowCount-1;this.table.isAutoRowHeight(t)&&Bn(this.table,t,e,!1),Fd(t,e,this),this.table.isAutoRowHeight(t)&&(an(this.bodyLeftCol,this.bodyRightCol,t,e,this.table,this.rowUpdateDirection),an(0,this.table.frozenColCount-1,t,e,this.table,this.rowUpdateDirection),an(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,t,e,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){const t=this.table.colCount-this.table.rightFrozenColCount,e=this.table.colCount-1;this.table.widthMode==="autoWidth"&&Pn(this.table,t,e,!1),Id(t,e,this),this.table.isAutoRowHeight(this.rowStart)&&ny(t,e,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return yn(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(t){const e=Math.min(this.bodyRightCol,this.colUpdatePos+t);this.table.widthMode==="autoWidth"&&Pn(this.table,this.colUpdatePos,e),Id(this.colUpdatePos,e,this),this.colUpdatePos=e+1}updateCellGroupPosition(t,e,i){t.row=e,t.mergeStartCol=void 0,t.mergeStartRow=void 0,t.mergeEndCol=void 0,t.mergeEndRow=void 0,t.setAttribute("y",i),t.needUpdate=!0,t.needUpdateForAutoRowHeight=!0}updateCellGroupContent(t){if(!t.needUpdate||t.role!=="cell")return t;const e=this.table.scenegraph.updateCellContent(t.col,t.row);return t.needUpdate=!1,e||t}sortCellVertical(){return yn(this,void 0,void 0,function*(){yield Att(this)})}sortCellHorizontal(){return yn(this,void 0,void 0,function*(){yield Ett(this)})}highPerformanceGetCell(t,e,i){if(e>=this.table.frozenRowCount&&e<this.table.rowCount-this.table.bottomFrozenRowCount&&(e<this.rowStart||e>this.rowEnd)||t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return jp;if(this.cellCache.get(t)){const o=this.cellCache.get(t);if((o._next||o._prev)&&Math.abs(o.row-e)<e){let a=oy(o,e);return a&&(i||a.role!=="shadow-cell")||(a=this.table.scenegraph.getCell(t,e,i)),a.row&&this.cellCache.set(t,a),a}const s=this.table.scenegraph.getCell(t,e,i);return s.col===t&&s.row&&this.cellCache.set(t,s),s}const r=this.table.scenegraph.getCell(t,e,i);return r.col===t&&r.row&&this.cellCache.set(t,r),r}updateDeltaY(t,e,i){if(this.rowStart===this.bodyTopRow){const r=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if(r.role==="cell"){const o=r.attribute.y;this.deltaY=-o}}else if(this.rowEnd===this.bodyBottomRow){const r=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if(r.role==="cell"){const o=r.attribute.y+r.attribute.height-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-o}}else if(et(e)&&et(i)){let r=this.table.scenegraph.highPerformanceGetCell(this.colStart,i,!0);r.role!=="cell"&&(r=this.table.scenegraph.highPerformanceGetCell(0,i,!0));const o=t-this.deltaY,s=e-o,a=r.attribute.y-o+this.table.getFrozenRowsHeight();this.deltaY=s-a}}updateDeltaX(t,e,i){if(this.colStart===this.bodyLeftCol){const r=this.table.scenegraph.getColGroup(this.colStart);if(r){const o=r.attribute.x;this.deltaX=-o}}else if(this.colEnd===this.bodyRightCol){const r=this.table.scenegraph.getColGroup(this.colEnd);if(r){const o=r.attribute.x+r.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-o}}else if(et(e)&&et(i)){const r=this.table.scenegraph.getColGroup(i)||this.table.scenegraph.getColGroup(i,!0),o=t-this.deltaX,s=e-o,a=r.attribute.x-o+this.table.getFrozenColsWidth();this.deltaX=s-a}}release(){this.isRelease=!0}}function oy(n,t){if(!n)return null;if(n.row===t)return n;const e=n._prev,i=n._next;return n.row>t&&e&&e.row===n.row-1?oy(e,t):n.row<t&&i&&i.row===n.row+1?oy(i,t):null}function Btt(n,t,e,i,r,o){const s=o.scenegraph;for(let a=n;a<=t;a++){const l=o.getColWidth(a),u=o.scenegraph.getColGroup(a,!0),h=o.scenegraph.getColGroup(a),d=o.scenegraph.getColGroupInBottom(a),c=o.scenegraph.getColGroupInLeftBottomCorner(a),f=o.scenegraph.getColGroupInRightBottomCorner(a);u&&(u.setAttribute("width",l),u.forEachChildren(g=>{g.setAttribute("width",l)})),h&&(h.setAttribute("width",l),h.forEachChildren(g=>{g.setAttribute("width",l)})),d&&(d.setAttribute("width",l),d.forEachChildren(g=>{g.setAttribute("width",l)})),f&&(f.setAttribute("width",l),f.forEachChildren(g=>{g.setAttribute("width",l)})),c&&(c.setAttribute("width",l),c.forEachChildren(g=>{g.setAttribute("width",l)}))}if(s.updateContainer(),r==="column")for(let a=n;a<=t;a++){const l=o.scenegraph.getColGroup(a);l==null||l.setAttribute("chartInstance",void 0);for(let u=0;u<=o.frozenRowCount-1;u++)s.updateCellContent(a,u);for(let u=s.bodyRowStart;u<=s.bodyRowEnd;u++)s.updateCellContent(a,u);for(let u=o.rowCount-o.bottomFrozenRowCount;u<=o.rowCount-1;u++)s.updateCellContent(a,u)}else{for(let a=0;a<=o.frozenColCount-1;a++){const l=o.scenegraph.getColGroup(a);l==null||l.setAttribute("chartInstance",void 0);for(let u=e;u<=i;u++)s.updateCellContent(a,u)}for(let a=s.bodyColStart;a<=s.bodyColEnd;a++){const l=o.scenegraph.getColGroup(a);l==null||l.setAttribute("chartInstance",void 0);for(let u=e;u<=i;u++)s.updateCellContent(a,u)}for(let a=o.colCount-o.rightFrozenColCount;a<=o.colCount-1;a++){const l=o.scenegraph.getColGroup(a);l==null||l.setAttribute("chartInstance",void 0);for(let u=e;u<=i;u++)s.updateCellContent(a,u)}}}function HI(n){n.customSelectedRangeComponents.forEach((t,e)=>{kb(t,e,n)}),n.selectingRangeComponents.forEach((t,e)=>{kb(t,e,n)}),n.selectedRangeComponents.forEach((t,e)=>{kb(t,e,n)})}function kb(n,t,e){var i,r,o,s,a,l,u,h,d,c;const f=e.table,[g,m,p,v]=t.split("-"),b=parseInt(g,10),C=parseInt(m,10),y=parseInt(p,10),w=parseInt(v,10);let _,A=b,T=C,S=y,x=w;switch(n.role){case"rowHeader":_=f.getBodyVisibleRowRange(),_&&(T=Math.max(C,_.rowStart-1),x=Math.min(w,_.rowEnd+1));break;case"columnHeader":case"bottomFrozen":_=f.getBodyVisibleCellRange(),_&&(A=Math.max(b,_.colStart-1),S=Math.min(y,_.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":_=f.getBodyVisibleCellRange(),_&&(T=Math.max(C,_.rowStart-1),x=Math.min(w,_.rowEnd+1));break;default:_=f.getBodyVisibleCellRange(),_&&(T=Math.max(C,_.rowStart-1),x=Math.min(w,_.rowEnd+1),A=Math.max(b,_.colStart-1),S=Math.min(y,_.colEnd+1))}const E=f.getColsWidth(A,S),M=f.getRowsHeight(T,x),L=e.highPerformanceGetCell(A,T).globalAABBBounds;if(n.rect.setAttributes({x:L.x1-e.tableGroup.attribute.x,y:L.y1-e.tableGroup.attribute.y,width:E,height:M,visible:!0}),n.fillhandle){const W=(i=e.table.options.excelOptions)===null||i===void 0?void 0:i.fillHandle;let j,Y=!0;typeof W=="function"&&(Y=W({selectRanges:e.table.stateManager.select.ranges,table:e.table})),j=S<f.colCount-1?e.highPerformanceGetCell(S,x).globalAABBBounds:e.highPerformanceGetCell(A-1,x).globalAABBBounds;const Z=j.x2-e.tableGroup.attribute.x-3;j=x<f.rowCount-1?e.highPerformanceGetCell(S,x).globalAABBBounds:e.highPerformanceGetCell(S,T-1).globalAABBBounds;const rt=j.y2-e.tableGroup.attribute.y-3;(r=n.fillhandle)===null||r===void 0||r.setAttributes({x:Z,y:rt,width:6,height:6,visible:Y})}let I=!!f.frozenColCount&&b===f.frozenColCount;!I&&f.frozenColCount&&f.scrollLeft>0&&b>=f.frozenColCount&&f.getColsWidth(0,b-1)-f.scrollLeft<f.getFrozenColsWidth()&&(I=!0);let D=!!f.rightFrozenColCount&&f.rightFrozenColCount>0&&y===f.colCount-f.rightFrozenColCount-1;!D&&f.rightFrozenColCount&&y<f.colCount-f.rightFrozenColCount&&f.getColsWidth(0,y)-f.scrollLeft>f.tableNoFrameWidth-f.getRightFrozenColsWidth()&&(D=!0);let H=!f.frozenRowCount||C===f.frozenRowCount;!H&&f.frozenRowCount&&f.scrollTop>0&&C>=f.frozenRowCount&&f.getRowsHeight(0,C-1)-f.scrollTop<f.getFrozenRowsHeight()&&(H=!0);let O=!!f.bottomFrozenRowCount&&w===f.rowCount-f.bottomFrozenRowCount-1;!O&&f.bottomFrozenRowCount&&w<f.rowCount-f.bottomFrozenRowCount&&f.getRowsHeight(0,w)-f.scrollTop>f.tableNoFrameHeight-f.getBottomFrozenRowsHeight()&&(O=!0);const{dynamicUpdateSelectionSize:N}=f.theme.selectionStyle;if(I&&(n.rect.attribute.stroke[3]||N)||D&&(n.rect.attribute.stroke[1]||N)||H&&(n.rect.attribute.stroke[0]||N)||O&&(n.rect.attribute.stroke[2]||N)){if(I&&n.rect.attribute.stroke[3]&&e.tableGroup.insertAfter(n.rect,n.role==="columnHeader"?e.cornerHeaderGroup:n.role==="bottomFrozen"?e.leftBottomCornerGroup:e.rowHeaderGroup),O&&n.rect.attribute.stroke[2]&&e.tableGroup.insertAfter(n.rect,n.role==="rowHeader"?e.leftBottomCornerGroup:n.role==="rightFrozen"?e.rightBottomCornerGroup:e.bottomFrozenGroup),H&&n.rect.attribute.stroke[0]&&e.tableGroup.insertAfter(n.rect,n.role==="rowHeader"?e.cornerHeaderGroup:n.role==="rightFrozen"?e.rightTopCornerGroup:e.colHeaderGroup),D&&n.rect.attribute.stroke[1]&&e.tableGroup.insertAfter(n.rect,n.role==="columnHeader"?e.rightTopCornerGroup:n.role==="bottomFrozen"?e.rightBottomCornerGroup:e.rightFrozenGroup),n.rect.attribute.x<f.getFrozenColsWidth()&&f.scrollLeft>0&&(n.role==="body"||n.role==="columnHeader"||n.role==="bottomFrozen")){const W=n.rect.attribute.width-(f.getFrozenColsWidth()-n.rect.attribute.x);n.rect.setAttributes({x:n.rect.attribute.x+(f.getFrozenColsWidth()-n.rect.attribute.x),width:W>0?W:0}),(o=n.fillhandle)===null||o===void 0||o.setAttributes({visible:W>0})}if(f.getRightFrozenColsWidth()>0&&e.rightFrozenGroup.attribute.height>0&&n.rect.attribute.x+n.rect.attribute.width>e.rightFrozenGroup.attribute.x&&(n.role==="body"||n.role==="columnHeader"||n.role==="bottomFrozen")){const W=e.rightFrozenGroup.attribute.x-n.rect.attribute.x;n.rect.setAttributes({x:n.rect.attribute.x,width:W>0?W:0}),(s=n.fillhandle)===null||s===void 0||s.setAttributes({visible:W-E>0})}if(n.rect.attribute.y<e.colHeaderGroup.attribute.height&&f.scrollTop>0&&(n.role==="body"||n.role==="rowHeader"||n.role==="rightFrozen")){const W=n.rect.attribute.height-(e.colHeaderGroup.attribute.height-n.rect.attribute.y);n.rect.setAttributes({y:n.rect.attribute.y+(e.colHeaderGroup.attribute.height-n.rect.attribute.y),height:W>0?W:0}),(a=n.fillhandle)===null||a===void 0||a.setAttributes({visible:W>0})}if(e.bottomFrozenGroup.attribute.width>0&&e.bottomFrozenGroup.attribute.height>0&&n.rect.attribute.y+n.rect.attribute.height>e.bottomFrozenGroup.attribute.y&&(n.role==="body"||n.role==="rowHeader"||n.role==="rightFrozen")){const W=e.bottomFrozenGroup.attribute.y-n.rect.attribute.y;n.rect.setAttributes({y:n.rect.attribute.y,height:W>0?W:0}),(l=n.fillhandle)===null||l===void 0||l.setAttributes({visible:W-M>0})}}else e.tableGroup.insertAfter(n.rect,n.role==="body"?e.bodyGroup:n.role==="columnHeader"?e.colHeaderGroup:n.role==="rowHeader"?e.rowHeaderGroup:n.role==="cornerHeader"?e.cornerHeaderGroup:n.role==="rightTopCorner"?e.rightTopCornerGroup:n.role==="rightFrozen"?e.rightFrozenGroup:n.role==="leftBottomCorner"?e.leftBottomCornerGroup:n.role==="bottomFrozen"?e.bottomFrozenGroup:e.rightBottomCornerGroup);let U=0;typeof n.rect.attribute.lineWidth=="number"&&(U=Math.ceil(n.rect.attribute.lineWidth/2)),y===f.colCount-1&&(Array.isArray(n.rect.attribute.lineWidth)&&(U=Math.ceil(((u=n.rect.attribute.lineWidth[1])!==null&&u!==void 0?u:0)/2)),n.rect.setAttributes({width:n.rect.attribute.width-U})),b===0&&(Array.isArray(n.rect.attribute.lineWidth)&&(U=Math.ceil(((h=n.rect.attribute.lineWidth[3])!==null&&h!==void 0?h:0)/2)),n.rect.setAttributes({x:n.rect.attribute.x+U,width:n.rect.attribute.width-U})),w===f.rowCount-1&&(Array.isArray(n.rect.attribute.lineWidth)&&(U=Math.ceil(((d=n.rect.attribute.lineWidth[2])!==null&&d!==void 0?d:0)/2)),n.rect.setAttributes({height:n.rect.attribute.height-U})),C===0&&(Array.isArray(n.rect.attribute.lineWidth)&&(U=Math.ceil(((c=n.rect.attribute.lineWidth[0])!==null&&c!==void 0?c:0)/2)),n.rect.setAttributes({y:n.rect.attribute.y+U,height:n.rect.attribute.height-U}))}function VE(n,t,e=!0){const i=n.table,r=t.start.col,o=t.start.row,s=t.end.col,a=t.end.row,l=t.skipBodyMerge;let u=Math.max(Math.min(s,r),0),h=Math.max(Math.min(a,o),0),d=Math.min(Math.max(s,r),i.colCount-1),c=Math.min(Math.max(a,o),i.rowCount-1);const f=()=>{let A=!1;for(let T=u;T<=d;T++){if(T===u)for(let S=h;S<=c;S++){if(!i.isHeader(T,S)&&l)continue;const x=vi(i,T,S);if(x&&x.start.col<u){u=x.start.col,A=!0;break}}if(!A&&T===d)for(let S=h;S<=c;S++){if(!i.isHeader(T,S)&&l)continue;const x=vi(i,T,S);if(x&&Math.min(x.end.col,i.colCount-1)>d){d=x.end.col,A=!0;break}}if(A)break}if(!A)for(let T=h;T<=c;T++){if(T===h)for(let S=u;S<=d;S++){if(!i.isHeader(S,T)&&l)continue;const x=vi(i,S,T);if(x&&x.start.row<h){h=x.start.row,A=!0;break}}if(!A&&T===c)for(let S=u;S<=d;S++){if(!i.isHeader(S,T)&&l)continue;const x=vi(i,S,T);if(x&&Math.min(x.end.row,i.rowCount-1)>c){c=x.end.row,A=!0;break}}if(A)break}A&&f()};e&&(f(),t.start.col>t.end.col?(t.start.col=Math.max(u,d),t.end.col=Math.min(u,d)):(t.start.col=Math.min(u,d),t.end.col=Math.max(u,d)),t.start.row>t.end.row?(t.start.row=Math.max(h,c),t.end.row=Math.min(h,c)):(t.start.row=Math.min(h,c),t.end.row=Math.max(h,c))),n.selectingRangeComponents.forEach((A,T)=>{var S;A.rect.delete(),(S=A.fillhandle)===null||S===void 0||S.delete()}),n.selectingRangeComponents=new Map;let g=!1,m=!1,p=!1,v=!1,b=!1,C=!1,y=!1,w=!1,_=!1;if(u<=i.frozenColCount-1&&h<=i.frozenRowCount-1&&(C=!0),d>=i.colCount-i.rightFrozenColCount&&h<=i.frozenRowCount-1&&(y=!0),u<=i.frozenColCount-1&&c>=i.rowCount-i.bottomFrozenRowCount&&(_=!0),d>=i.colCount-i.rightFrozenColCount&&c>=i.rowCount-i.bottomFrozenRowCount&&(w=!0),u<=i.frozenColCount-1&&c>=i.frozenRowCount&&h<=i.rowCount-i.bottomFrozenRowCount-1&&(g=!0),d>=i.colCount-i.rightFrozenColCount&&c>=i.frozenRowCount&&h<=i.rowCount-i.bottomFrozenRowCount-1&&(m=!0),h<=i.frozenRowCount-1&&d>=i.frozenColCount&&u<=i.colCount-i.rightFrozenColCount-1&&(p=!0),c>=i.rowCount-i.bottomFrozenRowCount&&d>=i.frozenColCount&&u<=i.colCount-i.rightFrozenColCount-1&&(v=!0),u<=i.colCount-i.rightFrozenColCount-1&&d>=i.frozenColCount&&h<=i.rowCount-i.bottomFrozenRowCount-1&&c>=i.frozenRowCount&&(b=!0),C){const A=Math.min(d,i.frozenColCount-1),T=Math.min(c,i.frozenRowCount-1),S=[!0,!p,!g,!0];n.createCellSelectBorder(u,h,A,T,"cornerHeader",`${u}${h}${d}${c}`,S)}if(y){const A=Math.max(u,i.colCount-i.rightFrozenColCount),T=Math.min(c,i.frozenRowCount-1),S=[!0,!0,!m,!p];n.createCellSelectBorder(A,h,d,T,"rightTopCorner",`${u}${h}${d}${c}`,S)}if(_){const A=Math.min(d,i.frozenColCount-1),T=Math.max(h,i.rowCount-i.bottomFrozenRowCount),S=[!g,!v,!0,!0];n.createCellSelectBorder(u,T,A,c,"leftBottomCorner",`${u}${h}${d}${c}`,S)}if(w){const A=Math.max(u,i.colCount-i.rightFrozenColCount),T=Math.max(h,i.rowCount-i.bottomFrozenRowCount),S=[!m,!0,!0,!v];n.createCellSelectBorder(A,T,d,c,"rightBottomCorner",`${u}${h}${d}${c}`,S)}if(p){const A=Math.max(u,i.frozenColCount),T=Math.min(d,i.colCount-i.rightFrozenColCount-1),S=Math.min(c,i.frozenRowCount-1),x=[!0,!y,!b,!C];n.createCellSelectBorder(A,h,T,S,"columnHeader",`${u}${h}${d}${c}`,x)}if(v){const A=Math.max(u,i.frozenColCount),T=Math.min(d,i.colCount-i.rightFrozenColCount-1),S=Math.max(h,i.rowCount-i.bottomFrozenRowCount),x=[!b,!w,!0,!_];n.createCellSelectBorder(A,S,T,c,"bottomFrozen",`${u}${h}${d}${c}`,x)}if(g){const A=Math.max(h,i.frozenRowCount),T=Math.min(c,i.rowCount-i.bottomFrozenRowCount-1),S=Math.min(d,i.frozenColCount-1),x=[!C,!b,!_,!0];n.createCellSelectBorder(u,A,S,T,"rowHeader",`${u}${h}${d}${c}`,x)}if(m){const A=Math.max(h,i.frozenRowCount),T=Math.min(c,i.rowCount-i.bottomFrozenRowCount-1),S=Math.max(u,i.colCount-i.rightFrozenColCount),x=[!y,!0,!w,!b];n.createCellSelectBorder(S,A,d,T,"rightFrozen",`${u}${h}${d}${c}`,x)}if(b){const A=Math.max(u,i.frozenColCount),T=Math.max(h,i.frozenRowCount),S=Math.min(d,i.colCount-i.rightFrozenColCount-1),x=Math.min(c,i.rowCount-i.bottomFrozenRowCount-1),E=[!p,!m,!v,!g];n.createCellSelectBorder(A,T,S,x,"body",`${u}${h}${d}${c}`,E)}}function jE(n){n.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)}),n.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)})}function GE(n){n.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)}),n.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)})}function Ptt(n,t,e,i,r,o,s,a){var l,u,h,d,c,f,g,m,p;let v=!!(!((l=n.table.options.excelOptions)===null||l===void 0)&&l.fillHandle);if(((u=n.table.stateManager.select.ranges)===null||u===void 0?void 0:u.length)>1)v=!1,n.removeFillHandleFromSelectComponents();else if(((h=n.table.stateManager.select.ranges)===null||h===void 0?void 0:h.length)===1){const L=Math.max(n.table.stateManager.select.ranges[0].start.row,n.table.stateManager.select.ranges[0].end.row),I=Math.max(n.table.stateManager.select.ranges[0].start.col,n.table.stateManager.select.ranges[0].end.col);n.table.isHeader(I,L)&&(v=!1)}!Array.isArray(a)||a[1]!==!1&&a[2]!==!1||(v=!1);const b=Math.min(t,i),C=Math.min(e,r),y=Math.max(t,i),w=Math.max(e,r),_=n.highPerformanceGetCell(b,C).globalAABBBounds,A=n.highPerformanceGetCell(y,w).globalAABBBounds,T=n.table.theme,S=(d=T.selectionStyle)===null||d===void 0?void 0:d.cellBorderColor,x=(c=T.selectionStyle)===null||c===void 0?void 0:c.cellBorderLineWidth,E=Ge({pickable:!1,fill:((f=T.selectionStyle)===null||f===void 0?void 0:f.selectionFillMode)!=="replace"&&((m=(g=T.selectionStyle)===null||g===void 0?void 0:g.cellBgColor)!==null&&m!==void 0?m:"rgba(0, 0, 255,0.1)"),lineWidth:x,stroke:a.map(L=>!!L&&S),x:_.x1-n.tableGroup.attribute.x,y:_.y1-n.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:ktt(o,(p=n.table.theme.frameStyle)===null||p===void 0?void 0:p.cornerRadius,t,e,i,r,n.table)});let M;v&&(M=Ge({pickable:!1,fill:S,stroke:S,x:A.x2-3,y:A.y2-3,width:6,height:6,visible:!0})),n.lastSelectId=s,n.selectingRangeComponents.set(`${b}-${C}-${y}-${w}-${s}`,{rect:E,fillhandle:M,role:o}),n.tableGroup.insertAfter(E,o==="body"?n.bodyGroup:o==="columnHeader"?n.colHeaderGroup:o==="rowHeader"?n.rowHeaderGroup:o==="cornerHeader"?n.cornerHeaderGroup:o==="rightTopCorner"?n.rightTopCornerGroup:o==="rightFrozen"?n.rightFrozenGroup:o==="leftBottomCorner"?n.leftBottomCornerGroup:o==="bottomFrozen"?n.bottomFrozenGroup:n.rightBottomCornerGroup),v&&n.tableGroup.insertAfter(M,o==="body"?n.bodyGroup:o==="columnHeader"?n.colHeaderGroup:o==="rowHeader"?n.rowHeaderGroup:o==="cornerHeader"?n.cornerHeaderGroup:o==="rightTopCorner"?n.rightTopCornerGroup:o==="rightFrozen"?n.rightFrozenGroup:o==="leftBottomCorner"?n.leftBottomCornerGroup:o==="bottomFrozen"?n.bottomFrozenGroup:n.rightBottomCornerGroup)}function ktt(n,t,e,i,r,o,s){if(!t)return;const a=Array.isArray(t)?t:[t,t,t,t],l=s.colCount-1,u=s.rowCount-1,h=[0,0,0,0];let d=!1;return e===0&&i===0?(h[0]=a[0],d=!0):r===l&&o===u?(h[2]=a[2],d=!0):e===0&&o===u?(h[3]=a[3],d=!0):r===l&&i===0&&(h[1]=a[1],d=!0),d?h:void 0}function $E(n){n.selectingRangeComponents.forEach((t,e)=>{var i;n.selectedRangeComponents.get(e)&&(n.selectingRangeComponents.get(e).rect.delete(),(i=n.selectingRangeComponents.get(e).fillhandle)===null||i===void 0||i.delete()),n.selectedRangeComponents.set(e,t)}),n.selectingRangeComponents=new Map,n.updateNextFrame()}function Ltt(n){n.selectedRangeComponents.forEach((t,e)=>{var i;e.split("-")[4]===n.lastSelectId&&(t.rect.delete(),(i=t.fillhandle)===null||i===void 0||i.delete(),n.selectedRangeComponents.delete(e))})}function qE(n){n.selectedRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),(i=t.fillhandle)===null||i===void 0||i.delete()}),n.selectedRangeComponents=new Map}function zI(n){n.selectingRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),(i=t.fillhandle)===null||i===void 0||i.delete()}),n.selectingRangeComponents=new Map}function Dtt(n){n.selectedRangeComponents.forEach((t,e)=>{var i;(i=t.fillhandle)===null||i===void 0||i.delete(),t.fillhandle=void 0})}function Itt(n,t,e,i,r){var o,s;Gp(i)&&o1(i);const a=i.scenegraph,l=Gh(n.map(p=>p.row)).sort((p,v)=>v-p),u=Gh(t.map(p=>p.row)).sort((p,v)=>p-v),h=Gh(e.map(p=>p.row)).sort((p,v)=>p-v);let d;if(h.length&&(d=Db(h[0]-1,h[h.length-1]+1,a)),u.length){const p=Db(u[0]-1,u[u.length-1]+1,a);d=et(d)?et(p)?Math.min(d,p):d:p}if(l.length){const p=Db(l[0]-1,l[l.length-1]+1,a);d=et(d)?et(p)?Math.min(d,p):d:p}l.forEach(p=>{Ftt(p,a,r)});const c=i.rowHeightsMap;if(l.forEach(p=>{c.delete(p)}),l.length){Htt(a);const p=Lb(l[l.length-1]-1,l[0]-l.length+1,a);d=et(d)?et(p)?Math.min(d,p):d:p}let f;if(a.table._clearRowRangeHeightsMap(),u.forEach(p=>{const v=Ott(p,a,r);f=f??v,c.insert(p)}),ztt(a),u.length){const p=Lb(u[0]-1,u[u.length-1]+1,a);d=et(d)?et(p)?Math.min(d,p):d:p}for(let p=0;p<i.colCount;p++)h.forEach(v=>{if(v<i.frozenRowCount){const b=vi(a.table,p,v);if(b)for(let C=b.start.col;C<=b.end.col;C++)for(let y=b.start.row;y<=b.end.row;y++)Mn(C,y,a.table,!1);else Mn(p,v,a.table,!1)}else if(v>i.rowCount-1||v<a.table.rowCount-a.table.bottomFrozenRowCount&&(v<a.proxy.rowStart||v>a.proxy.rowEnd))NI(v,a);else{const b=vi(a.table,p,v);if(b)for(let C=b.start.col;C<=b.end.col;C++)for(let y=b.start.row;y<=b.end.row;y++)Mn(C,y,a.table,!1);else Mn(p,v,a.table,!1)}});if(h.length){const p=Lb(h[0]-1,h[h.length-1]+1,a);d=et(d)?et(p)?Math.min(d,p):d:p}if(wt(f)){for(let p=0;p<Math.max(i.colCount,(o=i.internalProps._oldColCount)!==null&&o!==void 0?o:i.colCount);p++)for(let v=f;v<Math.max(i.rowCount,(s=i.internalProps._oldRowCount)!==null&&s!==void 0?s:i.rowCount);v++){const b=a.highPerformanceGetCell(p,v,!0);b&&(b.needUpdate=!0)}d=et(d)?et(f)?Math.min(d,f):d:f}if(wt(d)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,d)),u.length){if(!wt(f)){const p=Math.min(...u);a.proxy.rowUpdatePos=Math.min(p,a.proxy.rowUpdatePos)}a.proxy.rowUpdateDirection="up",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),m()}else l.length&&(Ntt(l[l.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),m());a.proxy.progress();const g=i.getRowsHeight(i.frozenRowCount,i.rowCount-1-i.bottomFrozenRowCount);function m(){if((u==null?void 0:u[(u==null?void 0:u.length)-1])>=i.rowCount-i.bottomFrozenRowCount||(h==null?void 0:h[(h==null?void 0:h.length)-1])>=i.rowCount-i.bottomFrozenRowCount||(l==null?void 0:l[0])>=i.rowCount-i.bottomFrozenRowCount){for(let p=0;p<i.colCount;p++)for(let v=i.rowCount-i.bottomFrozenRowCount;v<i.rowCount;v++){const b=a.highPerformanceGetCell(p,v,!0);b&&(b.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,g-a.bodyGroup.attribute.height)}function Ftt(n,t,e){const i=t.proxy;if(n>=i.rowStart&&n<=i.rowEnd&&(NI(n,t),i.rowEnd--,i.currentRow--),!e){i.bodyBottomRow--;const r=Math.min(i.rowLimit,i.bodyBottomRow-i.bodyTopRow+1);i.totalActualBodyRowCount=r,i.totalRow=Math.min(i.table.rowCount-1,i.rowStart+r-1)}}function Ott(n,t,e){const i=t.proxy;if(!e){i.bodyBottomRow++;const r=Math.min(i.rowLimit,i.bodyBottomRow-i.bodyTopRow+1);i.totalActualBodyRowCount=r,i.totalRow=i.rowStart+r-1}if(!(n<i.rowStart))return n>i.rowEnd?i.rowEnd-i.rowStart+1<i.rowLimit?(i.rowEnd++,i.currentRow++,XE(n,t),n):void 0:(i.rowEnd-i.rowStart+1<i.rowLimit&&(i.rowEnd++,i.currentRow++,XE(n,t)),n)}function Htt(n){function t(e,i){e.row=i;const r=vi(n.table,e.col,e.row);r?(e.mergeStartCol=r.start.col,e.mergeEndCol=r.end.col,e.mergeStartRow=r.start.row,e.mergeEndRow=r.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}n.bodyGroup.forEachChildren(e=>{let i=n.bodyRowStart;e==null||e.forEachChildren(r=>{t(r,i),i++})}),n.rowHeaderGroup.forEachChildren(e=>{let i=n.bodyRowStart;e==null||e.forEachChildren(r=>{t(r,i),i++})}),n.rightFrozenGroup.forEachChildren(e=>{let i=n.bodyRowStart;e==null||e.forEachChildren(r=>{t(r,i),i++})}),n.bottomFrozenGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount;e==null||e.forEachChildren(r=>{t(r,i),i++})}),n.leftBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount;e==null||e.forEachChildren(r=>{t(r,i),i++})}),n.rightBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount;e==null||e.forEachChildren(r=>{t(r,i),i++})})}function ztt(n){function t(e,i,r){e.row=i,e.setAttribute("y",r);const o=vi(n.table,e.col,e.row);o?(e.mergeStartCol=o.start.col,e.mergeEndCol=o.end.col,e.mergeStartRow=o.start.row,e.mergeEndRow=o.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}n.bodyGroup.forEachChildren(e=>{let i=n.bodyRowStart,r=n.getCellGroupY(i);e==null||e.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.rowHeaderGroup.forEachChildren(e=>{let i=n.bodyRowStart,r=n.getCellGroupY(i);e==null||e.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.rightFrozenGroup.forEachChildren(e=>{let i=n.bodyRowStart,r=n.getCellGroupY(i);e==null||e.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.bottomFrozenGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount,r=0;e==null||e.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.leftBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount,r=0;e==null||e.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.rightBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount,r=0;e==null||e.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})})}function XE(n,t){for(let e=0;e<t.table.colCount;e++){const i=new de({x:0,y:0,width:t.table.getColWidth(e),height:t.table.getRowHeight(n)});if(i.role="cell",i.col=e,i.row=n,i.needUpdate=!0,!i)continue;const r=t.getColGroup(e);if(r)if(r.firstChild&&n<r.firstChild.row)r.insertBefore(i,r.firstChild),r.firstChild.row=r.firstChild.row+1;else if(r.lastChild&&n>r.lastChild.row)r.appendChild(i);else{const o=t.highPerformanceGetCell(e,n,!0);o!==i&&(r.insertBefore(i,o),o&&(o.row=o.row+1),o!==r.lastChild&&r.lastChild&&(r.lastChild.row=r.lastChild.row+1))}}}function NI(n,t){for(let e=0;e<t.table.colCount;e++){const i=t.getColGroup(e,!1);if(!i)continue;let r;i.forEachChildren(o=>o.row===n&&(r=o,!0)),r&&(i.updateColumnHeight(-r.attribute.height),i.removeChild(r))}}function Lb(n,t,e){let i;for(let r=0;r<e.table.colCount;r++){const o=e.table.getCellRange(r,n);let s;o.start.row<=n+1&&o.end.row>=n+1&&($p(o,e),s=o.start.row);const a=e.table.getCellRange(r,t);a.start.row<=t+1&&a.end.row>=t+1&&($p(a,e),s=a.start.row),et(s)&&(i=et(i)?Math.min(i,s):s)}return i}function Db(n,t,e){let i;for(let r=0;r<e.table.colCount;r++){let o;const s=e.highPerformanceGetCell(r,n);s.mergeStartRow&&s.mergeEndRow&&s.mergeEndRow>n&&($p({start:{row:s.mergeStartRow,col:e.table.isAutoRowHeight(t)?0:s.mergeStartCol},end:{row:s.mergeEndRow,col:e.table.isAutoRowHeight(t)?e.table.colCount-1:s.mergeEndCol}},e),o=s.mergeStartRow);const a=e.highPerformanceGetCell(r,t);a.mergeStartRow&&a.mergeEndRow&&a.mergeStartRow<t&&($p({start:{row:a.mergeStartRow,col:e.table.isAutoRowHeight(t)?0:a.mergeStartCol},end:{row:a.mergeEndRow,col:e.table.isAutoRowHeight(t)?e.table.colCount-1:a.mergeEndCol}},e),o=a.mergeStartRow),et(o)&&(i=et(i)?Math.min(i,o):o)}return i}function $p(n,t){const{start:e,end:i}=n;for(let r=e.col;r<=i.col;r++)for(let o=e.row;o<=i.row;o++){const s=t.highPerformanceGetCell(r,o,!0);s&&(s.needUpdate=!0)}}function Ntt(n,t){if(t.table.isHasSeriesNumber())for(let e=n;e<=t.table.rowCount-1;e++)Mn(0,e,t.table,!1)}function Wtt(n){const{internalProps:t}=n;t.bodyDomContainer=document.createElement("div"),t.bodyDomContainer.id="vtable-body-dom-container",t.bodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bodyDomContainer),t.headerDomContainer=document.createElement("div"),t.headerDomContainer.id="vtable-header-dom-container",t.headerDomContainer.classList.add("table-component-container"),t.element.appendChild(t.headerDomContainer),t.frozenBodyDomContainer=document.createElement("div"),t.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",t.frozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBodyDomContainer),t.frozenHeaderDomContainer=document.createElement("div"),t.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",t.frozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenHeaderDomContainer),t.rightFrozenBodyDomContainer=document.createElement("div"),t.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",t.rightFrozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBodyDomContainer),t.rightFrozenHeaderDomContainer=document.createElement("div"),t.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",t.rightFrozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenHeaderDomContainer),t.frozenBottomDomContainer=document.createElement("div"),t.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",t.frozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBottomDomContainer),t.bottomDomContainer=document.createElement("div"),t.bottomDomContainer.id="vtable-bottom-dom-container",t.bottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bottomDomContainer),t.rightFrozenBottomDomContainer=document.createElement("div"),t.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",t.rightFrozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBottomDomContainer)}function Utt(n){const{headerDomContainer:t,bodyDomContainer:e,frozenBodyDomContainer:i,frozenHeaderDomContainer:r,rightFrozenBodyDomContainer:o,rightFrozenHeaderDomContainer:s,bottomDomContainer:a,frozenBottomDomContainer:l,rightFrozenBottomDomContainer:u}=n.internalProps;if(!(t||e||i||r||o||s||a||l||u))return;const h=n.getAllColsWidth(),d=Math.min(h,n.tableNoFrameWidth),c=n.getFrozenColsWidth(),f=n.getRightFrozenColsWidth(),g=c+f,m=Math.min(h-g,d-g),p=n.getAllRowsHeight(),v=Math.min(p,n.tableNoFrameHeight),b=n.getFrozenRowsHeight(),C=n.getBottomFrozenRowsHeight(),y=b+C,w=Math.min(p-y,v-y);n.frozenColCount>0?(t.style.left=`${n.tableX+c}px`,e.style.left=`${n.tableX+c}px`,a.style.left=`${n.tableX+c}px`):n.frozenColCount===0&&(t.style.left=`${n.tableX}px`,e.style.left=`${n.tableX}px`,a.style.left=`${n.tableX}px`),i.style.left=`${n.tableX}px`,r.style.left=`${n.tableX}px`,t.style.width=`${m}px`,t.style.height=`${b}px`,e.style.top=`${n.tableY}px`,e.style.width=`${m}px`,e.style.height=`${w}px`,e.style.top=`${n.tableY+b}px`,i.style.width=`${c}px`,i.style.height=`${w}px`,i.style.top=`${n.tableY+b}px`,r.style.width=`${c}px`,r.style.height=`${b}px`,r.style.top=`${n.tableY}px`,o.style.width=`${f}px`,o.style.height=`${w}px`,o.style.top=`${n.tableY+b}px`,o.style.left=n.tableX+d-f+"px",s.style.width=`${f}px`,s.style.height=`${b}px`,s.style.top=`${n.tableY}px`,s.style.left=n.tableX+d-f+"px",a.style.width=`${m}px`,a.style.height=`${C}px`,a.style.top=n.tableY+v-C+"px",l.style.width=`${c}px`,l.style.height=`${C}px`,l.style.top=n.tableY+v-C+"px",u.style.width=`${f}px`,u.style.height=`${C}px`,u.style.top=n.tableY+v-C+"px",u.style.left=n.tableX+d-f+"px"}function WI(n){if(!n.table.reactCustomLayout)return;const{table:t,stage:e}=n,i=e.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:r,renderId:o}=i;for(const s in r){const a=r[s],{graphic:l,wrapContainer:u,renderId:h}=a;if(h!==o)continue;let d;if(n.frozenColCount>t.frozenColCount){const c=el(l);if(!c)continue;const{col:f,row:g}=c;g>=t.rowCount-t.bottomFrozenRowCount&&f<n.frozenColCount&&f>=t.frozenColCount&&l.attribute.react.container===t.frozenBottomDomContainer?d=t.bottomDomContainer:g>=t.frozenRowCount&&f<n.frozenColCount&&f>=t.frozenColCount&&l.attribute.react.container===t.frozenBodyDomContainer?d=t.bodyDomContainer:g<t.frozenRowCount&&f<n.frozenColCount&&f>=t.frozenColCount&&l.attribute.react.container===t.frozenHeaderDomContainer&&(d=t.headerDomContainer)}else if(n.frozenColCount<t.frozenColCount){const c=el(l);if(!c)continue;const{col:f,row:g}=c;g>=t.rowCount-t.bottomFrozenRowCount&&f<t.frozenColCount&&f>=n.frozenColCount&&l.attribute.react.container===t.bottomDomContainer?d=t.frozenBottomDomContainer:g>=t.frozenRowCount&&f<t.frozenColCount&&f>=n.frozenColCount&&l.attribute.react.container===t.bodyDomContainer?d=t.frozenBodyDomContainer:g<t.frozenRowCount&&f<t.frozenColCount&&f>=n.frozenColCount&&l.attribute.react.container===t.headerDomContainer&&(d=t.frozenHeaderDomContainer)}d&&(d.appendChild(u),a.nativeContainer=d,a.container=d,l.attribute.react.container=d,i.updateStyleOfWrapContainer(l,e,u,d,l.attribute.react))}}function Vtt(n){var t,e,i,r;if(n.table.frozenColCount>n.table.rowHeaderLevelCount){n.rowHeaderGroup.setAttribute("height",n.bodyGroup.attribute.height),n.rowHeaderGroup.setAttribute("y",n.bodyGroup.attribute.y),n.cornerHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height);for(let o=0;o<n.table.frozenColCount-n.table.rowHeaderLevelCount;o++)UI(n),VI(n),$I(n)}else if(n.table.frozenColCount<n.table.rowHeaderLevelCount){n.bodyGroup.setAttribute("height",n.rowHeaderGroup.attribute.height),n.bodyGroup.setAttribute("y",n.rowHeaderGroup.attribute.y),n.colHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height);for(let o=0;o<n.table.rowHeaderLevelCount-n.table.frozenColCount;o++)jI(n),GI(n),qI(n)}n.bodyGroup.setAttribute("x",n.rowHeaderGroup.attribute.width),n.colHeaderGroup.setAttribute("x",n.cornerHeaderGroup.attribute.width),n.updateContainer(),n.updateBorderSizeAndPosition(),n.isPivot||n.table.transpose?n.table.options.frozenColCount?n.component.setFrozenColumnShadow(n.table.frozenColCount-1):n.table.options.frozenColCount&&n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount):(n.component.setFrozenColumnShadow(n.table.frozenColCount-1),n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount)),n.hasFrozen=!0,n.frozenColCount=n.table.frozenColCount,n.frozenRowCount=(r=(e=(t=n.colHeaderGroup.firstChild)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:(i=n.cornerHeaderGroup.firstChild)===null||i===void 0?void 0:i.childrenCount)!==null&&r!==void 0?r:n.table.frozenRowCount}function jtt(n){var t,e,i,r,o,s;if(n.frozenColCount>n.table.frozenColCount){n.bodyGroup.setAttribute("height",n.rowHeaderGroup.attribute.height),n.bodyGroup.setAttribute("y",n.rowHeaderGroup.attribute.y),n.colHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height);for(let a=0;a<n.frozenColCount-n.table.frozenColCount;a++)jI(n),GI(n),qI(n)}else if(n.frozenColCount<n.table.frozenColCount){n.rowHeaderGroup.setAttribute("height",n.bodyGroup.attribute.height),n.rowHeaderGroup.setAttribute("y",n.bodyGroup.attribute.y),n.cornerHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height);for(let a=0;a<n.table.frozenColCount-n.frozenColCount;a++)UI(n),VI(n),$I(n)}WI(n),n.recreateAllSelectRangeComponents(),n.frozenColCount=n.table.frozenColCount,n.frozenRowCount=(r=(e=(t=n.colHeaderGroup.firstChild)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:(i=n.cornerHeaderGroup.firstChild)===null||i===void 0?void 0:i.childrenCount)!==null&&r!==void 0?r:n.table.frozenRowCount,n.proxy.colStart=(s=(o=n.bodyGroup.firstChild)===null||o===void 0?void 0:o.col)!==null&&s!==void 0?s:n.table.frozenColCount,n.bodyGroup.setAttribute("x",n.rowHeaderGroup.attribute.width),n.colHeaderGroup.setAttribute("x",n.cornerHeaderGroup.attribute.width),n.updateContainer(),n.updateBorderSizeAndPosition(),n.isPivot||n.table.transpose?n.table.options.frozenColCount?n.component.setFrozenColumnShadow(n.table.frozenColCount-1):n.table.options.rightFrozenColCount&&n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount):(n.component.setFrozenColumnShadow(n.table.frozenColCount-1),n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount)),n.hasFrozen=!0}function UI(n){const t=n.bodyGroup.firstChild instanceof de?n.bodyGroup.firstChild:null;t&&(n.rowHeaderGroup.appendChild(t),n.rowHeaderGroup.setAttribute("width",n.rowHeaderGroup.attribute.width+t.attribute.width),n.bodyGroup.setAttribute("width",n.bodyGroup.attribute.width-t.attribute.width))}function VI(n){const t=n.colHeaderGroup.firstChild instanceof de?n.colHeaderGroup.firstChild:null;t&&(n.cornerHeaderGroup.appendChild(t),n.cornerHeaderGroup.setAttribute("width",n.cornerHeaderGroup.attribute.width+t.attribute.width),n.colHeaderGroup.setAttribute("width",n.colHeaderGroup.attribute.width-t.attribute.width))}function jI(n){var t;const e=n.rowHeaderGroup.lastChild instanceof de?n.rowHeaderGroup.lastChild:(t=n.rowHeaderGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(Dn(n.bodyGroup,e,n.bodyGroup.firstChild),n.bodyGroup.setAttribute("width",n.bodyGroup.attribute.width+e.attribute.width),n.rowHeaderGroup.setAttribute("width",n.rowHeaderGroup.attribute.width-e.attribute.width))}function GI(n){var t;const e=n.cornerHeaderGroup.lastChild instanceof de?n.cornerHeaderGroup.lastChild:(t=n.cornerHeaderGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(Dn(n.colHeaderGroup,e,n.colHeaderGroup.firstChild),n.colHeaderGroup.setAttribute("width",n.colHeaderGroup.attribute.width+e.attribute.width),n.cornerHeaderGroup.setAttribute("width",n.cornerHeaderGroup.attribute.width-e.attribute.width))}function $I(n){const t=n.bottomFrozenGroup.firstChild instanceof de?n.bottomFrozenGroup.firstChild:null;t&&(n.leftBottomCornerGroup.appendChild(t),n.leftBottomCornerGroup.setAttribute("width",n.leftBottomCornerGroup.attribute.width+t.attribute.width),n.bottomFrozenGroup.setAttribute("width",n.bottomFrozenGroup.attribute.width-t.attribute.width),n.table.isPivotChart()&&t.forEachChildren(e=>{e.setAttributes({stroke:!1,fill:!1})}))}function qI(n){var t;const e=n.leftBottomCornerGroup.lastChild instanceof de?n.leftBottomCornerGroup.lastChild:(t=n.leftBottomCornerGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(Dn(n.bottomFrozenGroup,e,n.bottomFrozenGroup.firstChild),n.bottomFrozenGroup.setAttribute("width",n.bottomFrozenGroup.attribute.width+e.attribute.width),n.leftBottomCornerGroup.setAttribute("width",n.leftBottomCornerGroup.attribute.width-e.attribute.width),n.table.isPivotChart()&&e.forEachChildren(i=>{var r,o,s,a;const l=n.table._getCellStyle(i.col,i.row),u=n.table.getCellRange(i.col,i.row),h=Qs(l,n.table,u?u.start.col:i.col,u?u.start.row:i.row,pt).theme;i.setAttributes({fill:(o=(r=h==null?void 0:h.group)===null||r===void 0?void 0:r.fill)!==null&&o!==void 0?o:void 0,stroke:(a=(s=h==null?void 0:h.group)===null||s===void 0?void 0:s.stroke)!==null&&a!==void 0?a:void 0})}))}function Gtt(n,t){const{table:e,proxy:i,rightTopCornerGroup:r,rightFrozenGroup:o,rightBottomCornerGroup:s,bottomFrozenGroup:a,bodyGroup:l,colHeaderGroup:u}=t,h=t.table.rightFrozenColCount;if(n>h){for(let c=e.colCount-h-1;c>=e.colCount-n;c--)Dn(o,t.getColGroup(c),o.firstChild),Dn(r,t.getColGroup(c,!0),r.firstChild),Dn(s,t.getColGroupInBottom(c),s.firstChild);let d=0;o.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,r.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,s.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width})}else if(n<h){for(let c=e.colCount-h;c<e.colCount-n;c++){const f=t.getColGroup(c);f.setAttribute("x",l.lastChild.attribute.x+e.getColWidth(l.lastChild.col)),l.appendChild(f);const g=t.getColGroupInRightTopCorner(c);g.setAttribute("x",u.lastChild.attribute.x+e.getColWidth(u.lastChild.col)),u.appendChild(g);const m=t.getColGroupInRightBottomCorner(c);m.setAttribute("x",a.lastChild.attribute.x+e.getColWidth(a.lastChild.col)),a.appendChild(m)}let d=0;o.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,r.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,s.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width})}o.setAttribute("width",e.getColsWidth(e.colCount-n,e.colCount-1)),r.setAttribute("width",e.getColsWidth(e.colCount-n,e.colCount-1)),s.setAttribute("width",e.getColsWidth(e.colCount-n,e.colCount-1)),e.internalProps.rightFrozenColCount=n,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}function $tt(n,t){const{table:e,proxy:i,bottomFrozenGroup:r,leftBottomCornerGroup:o,rightBottomCornerGroup:s}=t;r.childrenCount||(i.table.isPivotChart()||(Wi(o,0,0,0,e.frozenColCount-1,0,-1,"rowHeader",e),Wi(s,0,0,e.colCount-e.rightFrozenColCount,e.colCount-1,0,-1,"body",e)),Wi(r,0,0,i.colStart,i.colEnd,0,-1,"body",e));const a=t.table.bottomFrozenRowCount;if(n>a){for(let l=0;l<e.frozenColCount;l++){const u=t.getColGroupInLeftBottomCorner(l);for(let d=e.rowCount-a-1;d>=e.rowCount-n;d--)Dn(u,t.getCell(l,d,!0),u.firstChild);let h=0;u.forEachChildren(d=>{d.setAttribute("y",h),h+=e.getRowHeight(d.row)})}for(let l=i.colStart;l<=i.colEnd;l++){const u=t.getColGroupInBottom(l);for(let d=e.rowCount-a-1;d>=e.rowCount-n;d--)Dn(u,t.getCell(l,d,!0),u.firstChild);let h=0;u.forEachChildren(d=>{d.setAttribute("y",h),h+=e.getRowHeight(d.row)})}if(e.rightFrozenColCount>0)for(let l=e.colCount-e.rightFrozenColCount;l<e.colCount;l++){const u=t.getColGroupInRightBottomCorner(l);for(let d=e.rowCount-a-1;d>=e.rowCount-n;d--)Dn(u,t.getCell(l,d,!0),u.firstChild);let h=0;u.forEachChildren(d=>{d.setAttribute("y",h),h+=e.getRowHeight(d.row)})}}else if(n<a){for(let l=0;l<e.rowHeaderLevelCount;l++){const u=t.getColGroup(l);for(let c=e.rowCount-a;c<e.rowCount-n;c++){const f=t.getCell(l,c,!0);f.setAttribute("y",u.lastChild.attribute.y+e.getRowHeight(u.lastChild.row)),u.appendChild(f)}const h=t.getColGroupInLeftBottomCorner(l);let d=0;h.forEachChildren(c=>{c.setAttribute("y",d),d+=e.getRowHeight(c.row)})}for(let l=i.colStart;l<=i.colEnd;l++){const u=t.getColGroup(l);for(let c=e.rowCount-a;c<e.rowCount-n;c++){const f=t.getCell(l,c,!0);f.setAttribute("y",u.lastChild.attribute.y+e.getRowHeight(u.lastChild.row)),u.appendChild(f)}const h=t.getColGroupInBottom(l);let d=0;h.forEachChildren(c=>{c.setAttribute("y",d),d+=e.getRowHeight(c.row)})}if(e.rightFrozenColCount>0)for(let l=e.colCount-e.rightFrozenColCount;l<e.colCount;l++){const u=t.getColGroup(l);for(let c=e.rowCount-a;c<e.rowCount-n;c++){const f=t.getCell(l,c,!0);f.setAttribute("y",u.lastChild.attribute.y+e.getRowHeight(u.lastChild.row)),u.appendChild(f)}const h=t.getColGroupInRightBottomCorner(l);let d=0;h.forEachChildren(c=>{c.setAttribute("y",d),d+=e.getRowHeight(c.row)})}}r.setAttribute("height",e.getRowsHeight(e.rowCount-n,e.rowCount-1)),o.setAttribute("height",e.getRowsHeight(e.rowCount-n,e.rowCount-1)),s.setAttribute("height",e.getRowsHeight(e.rowCount-n,e.rowCount-1)),e.internalProps.bottomFrozenRowCount=n,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}function Dn(n,t,e){t&&n&&(e?n.insertBefore(t,e):n.appendChild(t))}function qtt(n){var t,e,i,r,o;if(n.frozenRowCount>n.table.frozenRowCount){n.bodyGroup.setAttribute("width",n.colHeaderGroup.attribute.width),n.bodyGroup.setAttribute("x",n.colHeaderGroup.attribute.x),n.rowHeaderGroup.setAttribute("width",n.cornerHeaderGroup.attribute.width);for(let s=0;s<n.frozenRowCount-n.table.frozenRowCount;s++)Ztt(n),Qtt(n),Jtt(n)}else if(n.frozenRowCount<n.table.frozenRowCount){n.colHeaderGroup.setAttribute("width",n.bodyGroup.attribute.width),n.colHeaderGroup.setAttribute("x",n.bodyGroup.attribute.x),n.cornerHeaderGroup.setAttribute("width",n.rowHeaderGroup.attribute.width);for(let s=0;s<n.table.frozenRowCount-n.frozenRowCount;s++)Xtt(n),Ytt(n),Ktt(n)}WI(n),n.recreateAllSelectRangeComponents(),n.frozenRowCount=n.table.frozenRowCount,n.frozenColCount=(e=(t=n.rowHeaderGroup)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:0,n.proxy.rowStart=(o=(r=(i=n.bodyGroup.firstChild)===null||i===void 0?void 0:i.firstChild)===null||r===void 0?void 0:r.row)!==null&&o!==void 0?o:n.table.frozenRowCount,n.bodyGroup.setAttribute("y",n.colHeaderGroup.attribute.height),n.rowHeaderGroup.setAttribute("y",n.cornerHeaderGroup.attribute.height),n.updateContainer(),n.updateBorderSizeAndPosition(),n.hasFrozen=!0}function Xtt(n){var t;let e=!1;for(let i=0;i<n.bodyGroup.childrenCount;i++){const r=n.bodyGroup.children[i];if(!Gu(r))continue;const o=r.firstChild;(t=n.colHeaderGroup.children[i])===null||t===void 0||t.appendChild(o),e||(n.colHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height+o.attribute.height),n.bodyGroup.setAttribute("height",n.bodyGroup.attribute.height-o.attribute.height),e=!0)}}function Ytt(n){var t;let e=!1;for(let i=0;i<n.rowHeaderGroup.childrenCount;i++){const r=n.rowHeaderGroup.children[i];if(!Gu(r))continue;const o=r.firstChild;(t=n.cornerHeaderGroup.children[i])===null||t===void 0||t.appendChild(o),e||(n.cornerHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height+o.attribute.height),n.rowHeaderGroup.setAttribute("height",n.rowHeaderGroup.attribute.height-o.attribute.height),e=!0)}}function Ktt(n){var t;let e=!1;for(let i=0;i<n.rightFrozenGroup.childrenCount;i++){const r=n.rightFrozenGroup.children[i];if(!Gu(r))continue;const o=r.firstChild;(t=n.rightTopCornerGroup.children[i])===null||t===void 0||t.appendChild(o),e||(n.rightTopCornerGroup.setAttribute("height",n.rightTopCornerGroup.attribute.height+o.attribute.height),n.rightFrozenGroup.setAttribute("height",n.rightFrozenGroup.attribute.height-o.attribute.height),e=!0)}}function Ztt(n){let t=!1;for(let e=0;e<n.colHeaderGroup.childrenCount;e++){const i=n.colHeaderGroup.children[e];if(!Gu(i))continue;const r=n.bodyGroup.children[e];if(!r)continue;const o=i.lastChild;Dn(r,o,r.firstChild),t||(n.colHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height-o.attribute.height),n.bodyGroup.setAttribute("height",n.bodyGroup.attribute.height+o.attribute.height),t=!0)}}function Qtt(n){let t=!1;for(let e=0;e<n.cornerHeaderGroup.childrenCount;e++){const i=n.cornerHeaderGroup.children[e];if(!Gu(i))continue;const r=n.rowHeaderGroup.children[e];if(!r)continue;const o=i.lastChild;Dn(r,o,r.firstChild),t||(n.cornerHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height-o.attribute.height),n.rowHeaderGroup.setAttribute("height",n.rowHeaderGroup.attribute.height+o.attribute.height),t=!0)}}function Jtt(n){let t=!1;for(let e=0;e<n.rightTopCornerGroup.childrenCount;e++){const i=n.rightTopCornerGroup.children[e];if(!Gu(i))continue;const r=n.rightFrozenGroup.children[e];if(!r)continue;const o=i.lastChild;Dn(r,o,r.firstChild),t||(n.rightTopCornerGroup.setAttribute("height",n.rightTopCornerGroup.attribute.height-o.attribute.height),n.rightFrozenGroup.setAttribute("height",n.rightFrozenGroup.attribute.height+o.attribute.height),t=!0)}}function Gu(n){return n instanceof de&&(n==null?void 0:n.name)!=="table-border-rect"}function tet(n,t){const{table:e}=n,i=e.internalProps.layoutMap,r=t===-1?"all":e.internalProps.columnResizeType;if(r==="column"){const o=n.getColGroup(t),s=n.getColGroup(t,!0),a=n.getColGroupInBottom(t,!0);if(o==null||o.forEachChildren(l=>{wn(l,e.getColWidth(l.col),e.getRowHeight(l.row))}),s==null||s.forEachChildren(l=>{wn(l,e.getColWidth(l.col),e.getRowHeight(l.row))}),a==null||a.forEachChildren(l=>{wn(l,e.getColWidth(l.col),e.getRowHeight(l.row))}),e.widthMode==="adaptive"&&t<e.colCount-1){const l=n.getColGroup(t+1),u=n.getColGroup(t+1,!0),h=n.getColGroupInBottom(t+1,!0);l==null||l.forEachChildren(d=>{wn(d,e.getColWidth(d.col),e.getRowHeight(d.row))}),u==null||u.forEachChildren(d=>{wn(d,e.getColWidth(d.col),e.getRowHeight(d.row))}),h==null||h.forEachChildren(d=>{wn(d,e.getColWidth(d.col),e.getRowHeight(d.row))})}}else{let o,s,a,l=e.rowHeaderLevelCount,u=e.colCount-1;if(r==="indicator")if(i.indicatorsAsCol)o=i.getIndicatorKey(t,e.columnHeaderLevelCount);else{const h=i.getCellHeaderPaths(t,e.columnHeaderLevelCount-1),d=h.colHeaderPaths[h.colHeaderPaths.length-1];s=d.dimensionKey,a=d.value}else if(r==="indicatorGroup"){const h=e.internalProps.layoutMap,d=h.getCellHeaderPaths(e.stateManager.columnResize.col,e.columnHeaderLevelCount),c=h.getHeadNodeByRowOrColDimensions(d.colHeaderPaths.slice(0,d.colHeaderPaths.length-1));l=c.startInTotal+e.frozenColCount,u=c.startInTotal+e.frozenColCount+c.size-1}for(let h=l;h<=u;h++){const d=n.getColGroup(h),c=n.getColGroup(h,!0),f=n.getColGroupInBottom(h,!0);if(d){if(r==="indicator"){const g=i.getIndicatorKey(h,e.columnHeaderLevelCount);if(i.indicatorsAsCol&&g!==o)continue;if(!i.indicatorsAsCol){const m=i.getCellHeaderPaths(h,e.columnHeaderLevelCount-1),p=m==null?void 0:m.colHeaderPaths[m.colHeaderPaths.length-1];if(!p||s!==p.dimensionKey||a!==p.value)continue}}d.forEachChildren(g=>{wn(g,e.getColWidth(g.col),e.getRowHeight(g.row))}),c==null||c.forEachChildren(g=>{wn(g,e.getColWidth(g.col),e.getRowHeight(g.row))}),f==null||f.forEachChildren(g=>{wn(g,e.getColWidth(g.col),e.getRowHeight(g.row))})}}}}function eet(n,t){var e;const{table:i}=n,r=i.internalProps.layoutMap,o=i.stateManager,s=t===-1?"all":i.internalProps.rowResizeType;let a,l,u,h=i.columnHeaderLevelCount,d=i.rowCount-1;if(s==="indicator")if(r.indicatorsAsCol){const f=r.getCellHeaderPaths(i.rowHeaderLevelCount-1,t),g=(e=f.rowHeaderPaths)===null||e===void 0?void 0:e[f.rowHeaderPaths.length-1];l=g==null?void 0:g.dimensionKey,u=g==null?void 0:g.value}else a=r.getIndicatorKey(i.rowHeaderLevelCount,t);else if(s==="indicatorGroup"){const f=i.internalProps.layoutMap,g=f.getCellHeaderPaths(i.rowHeaderLevelCount,t),m=f.getHeadNodeByRowOrColDimensions(g.rowHeaderPaths.slice(0,g.rowHeaderPaths.length-1));h=m.startInTotal+i.frozenRowCount,d=m.startInTotal+i.frozenRowCount+m.size-1}const c=[{startCol:n.proxy.colStart,endCol:n.proxy.colEnd}];i.frozenColCount&&c.push({startCol:0,endCol:i.frozenColCount-1}),i.rightFrozenColCount&&c.push({startCol:i.colCount-i.rightFrozenColCount,endCol:i.colCount-1}),c.forEach(({startCol:f,endCol:g})=>{for(let m=f;m<=g;m++)if(s==="row"){const p=n.highPerformanceGetCell(m,t);if(p.role!=="cell")continue;if(wn(p,i.getColWidth(p.col),i.getRowHeight(p.row)),i.heightMode==="adaptive"&&t<i.rowCount-1){const v=n.highPerformanceGetCell(m,t+1);wn(v,i.getColWidth(v.col),i.getRowHeight(v.row))}}else for(let p=h;p<=d;p++){if(s==="indicator"){const b=r.getIndicatorKey(o.table.rowHeaderLevelCount,p);if(!r.indicatorsAsCol&&b!==a)continue;if(r.indicatorsAsCol){const C=r.getCellHeaderPaths(o.table.rowHeaderLevelCount-1,p),y=C==null?void 0:C.rowHeaderPaths[C.rowHeaderPaths.length-1];if(!y||l!==y.dimensionKey||u!==y.value)continue}}const v=n.highPerformanceGetCell(m,p);v.role==="cell"&&wn(v,i.getColWidth(v.col),i.getRowHeight(v.row))}})}function sy(n){var t;for(let e=n.proxy.colStart;e<=n.proxy.colEnd;e++){const i=n.getColGroup(e);(t=i==null?void 0:i.getChildren())===null||t===void 0||t.forEach(r=>{r.children.forEach(o=>{o.type==="chart"&&(o.cacheCanvas=null,o.addUpdateBoundTag())})})}}function iet(n,t){const e=n.table;if(e.isPivotChart()){const i=e._selectedDataItemsInChart.length;if((t===null||(t==null?void 0:t.length)===0||Object.keys(t).length===0)&&i===0)return;const r=[];if(Array.isArray(t))t.forEach(o=>{if(o&&o.key!==0&&Object.keys(o).length>0){const s={};for(const a in o)a.startsWith("VGRAMMAR_")||a.startsWith("__VCHART")||(s[a]=o[a]);r.push(s)}});else if(t&&t.key!==0&&Object.keys(t).length>0){const o={};for(const s in t)s.startsWith("VGRAMMAR_")||s.startsWith("__VCHART")||(o[s]=t[s]);r.push(o)}Ed(e._selectedDataItemsInChart,r)||(e._selectedDataItemsInChart=r,e.internalProps.layoutMap.updateDataStateToChartInstance(),sy(n),e.scenegraph.updateNextFrame())}}function wn(n,t,e){n.forEachChildren(i=>{i.type==="chart"&&(i.cacheCanvas=null,i.setAttributes({width:Math.ceil(t-i.attribute.cellPadding[3]-i.attribute.cellPadding[1]),height:Math.ceil(e-i.attribute.cellPadding[0]-i.attribute.cellPadding[2])}))})}function ret(n){const t=n.table.tableNoFrameWidth,e=n.table.tableNoFrameHeight;n.tableGroup=new de({x:0,y:0,width:t,height:e,clip:!0,pickable:!1}),n.tableGroup.role="table";const i=mo(0,0,!n.table.options.enableTreeStickCell);i.role="col-header",n.colHeaderGroup=i;const r=mo(0,0,!n.table.options.enableTreeStickCell);r.role="corner-header",n.cornerHeaderGroup=r;const o=mo(0,0,!0);o.role="row-header",n.rowHeaderGroup=o;const s=mo(t,0,!0);s.role="body",n.bodyGroup=s;const a=mo(0,0,!0);a.role="right-frozen",n.rightFrozenGroup=a;const l=mo(0,0,!0);l.role="bottom-frozen",n.bottomFrozenGroup=l;const u=mo(0,0);u.role="component",n.componentGroup=u;const h=mo(0,0,!0);h.role="corner-right-top-header",n.rightTopCornerGroup=h;const d=mo(0,0,!0);d.role="corner-right-bottom-header",n.rightBottomCornerGroup=d;const c=mo(0,0,!0);c.role="corner-left-bottom-header",n.leftBottomCornerGroup=c,n.tableGroup.addChild(s),n.tableGroup.addChild(o),n.tableGroup.addChild(l),n.tableGroup.addChild(i),n.tableGroup.addChild(a),n.tableGroup.addChild(d),n.tableGroup.addChild(h),n.tableGroup.addChild(c),n.tableGroup.addChild(r),n.tableGroup.addChild(u)}function mo(n,t,e){return new de({x:0,y:0,width:n,height:t,clip:e!=null&&e,pickable:!1})}function Yo(n,t){return n.forEachChildrenSkipChild((e,i)=>{e.setAttribute("x",t),t+=e.attribute.width}),t}function net(n,t,e){n!==-1&&t!==-1&&(lo(n,t,i=>i.attribute.visibleTime==="mouseenter_cell",i=>{i.setAttribute("opacity",0);const r=i.parent.getChildByName("icon-back");r&&r.setAttribute("visible",!1)},e),e.updateNextFrame())}function oet(n,t,e){n!==-1&&t!==-1&&(lo(n,t,i=>i.attribute.visibleTime==="mouseenter_cell",i=>{i.setAttribute("opacity",1)},e),e.updateNextFrame())}function set(n,t,e){n!==-1&&t!==-1&&(lo(n,t,i=>i.attribute.visibleTime==="click_cell",i=>{i.setAttribute("opacity",0)},e),e.updateNextFrame())}function aet(n,t,e){n!==-1&&t!==-1&&(lo(n,t,i=>i.attribute.visibleTime==="click_cell",i=>{i.setAttribute("opacity",1)},e),e.updateNextFrame())}function uet(n,t,e,i,r){let o;return r.getCell(n,t).forEachChildren(s=>{s.role&&s.role.startsWith("icon")&&s.containsPoint(e,i,ud.GLOBAL)&&(o=s)}),o}function het(n,t,e,i,r){var o,s;if((n.attribute.backgroundColor||n.attribute.hoverImage)&&lo(t,e,a=>a.name===n.name,a=>{var l,u,h,d,c,f,g,m;if(a.attribute.backgroundColor){let p=a.parent.getChildByName("icon-back");p?p.setAttributes({x:((l=a.attribute.x)!==null&&l!==void 0?l:0)+(a.AABBBounds.width()-a.backgroundWidth)/2,y:((u=a.attribute.y)!==null&&u!==void 0?u:0)+(a.AABBBounds.height()-a.backgroundHeight)/2,dx:(h=a.attribute.dx)!==null&&h!==void 0?h:0,dy:(d=a.attribute.dy)!==null&&d!==void 0?d:0,width:a.backgroundWidth,height:a.backgroundHeight,fill:a.attribute.backgroundColor,cornerRadius:5,visible:!0}):(p=Ge({x:((c=a.attribute.x)!==null&&c!==void 0?c:0)+(a.AABBBounds.width()-a.backgroundWidth)/2,y:((f=a.attribute.y)!==null&&f!==void 0?f:0)+(a.AABBBounds.height()-a.backgroundHeight)/2,dx:(g=a.attribute.dx)!==null&&g!==void 0?g:0,dy:(m=a.attribute.dy)!==null&&m!==void 0?m:0,width:a.backgroundWidth,height:a.backgroundHeight,fill:a.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0}),p.name="icon-back"),a.parent.insertBefore(p,a)}a.attribute.hoverImage&&a.attribute.image!==a.attribute.hoverImage&&(a.image=a.attribute.hoverImage)},r),n.tooltip){const{x1:a,x2:l,y1:u,y2:h}=n.globalAABBBounds,d={content:n.tooltip.title,referencePosition:{rect:{left:a,right:l,top:u,bottom:h,width:n.globalAABBBounds.width(),height:n.globalAABBBounds.height()},placement:n.tooltip.placement},disappearDelay:n.tooltip.disappearDelay,style:Object.assign({},(o=r.table.internalProps.theme)===null||o===void 0?void 0:o.tooltipStyle,(s=n.tooltip)===null||s===void 0?void 0:s.style)};r.table.internalProps.tooltipHandler.isBinded(d)||r.table.showTooltip(t,e,d)}}function det(n,t,e,i){(n.attribute.backgroundColor||n.attribute.hoverImage)&&lo(t,e,r=>r.name===n.name,r=>{const o=r.parent.getChildByName("icon-back");o&&o.setAttribute("visible",!1),r.attribute.hoverImage&&r.attribute.image!==r.attribute.originImage&&(r.image=r.attribute.originImage)},i)}function YE(n,t,e,i,r){const o=n.name;lo(e,i,s=>s.name===o,s=>{cn(t,s),s.name=t.name},r),r.updateNextFrame()}function cet(n,t,e,i){const r=i.getCell(n,t);if(et(r.mergeStartCol)&&et(r.mergeStartRow)&&et(r.mergeEndCol)&&et(r.mergeEndRow))for(let o=r.mergeStartCol;o<=r.mergeEndCol;o++)for(let s=r.mergeStartRow;s<=r.mergeEndRow;s++){let a;i.getCell(o,s).forEachChildren(l=>l.attribute.funcType==="sort"&&(a=l,!0)),a&&(cn(e,a),a.name=e.name)}else{let o;qw(r,"children",s=>s.attribute.funcType==="sort"&&(o=s,!0)),o&&(cn(e,o),o.name=e.name)}}function fet(n,t,e,i,r){const o=r.getCellRange(n,t),s=r.getCellRange(e,i);return o.start.col===s.start.col&&o.start.row===s.start.row&&o.end.col===s.end.col&&o.end.row===s.end.row}function get(n){const{col:t,row:e,iconMark:i,order:r,oldSortCol:o,oldSortRow:s,oldIconMark:a,scene:l}=n,u=l.table.internalProps.headerHelper.getSortIcon(r,l.table,t,e);if(i&&YE(i,u,t,e,l),!fet(t,e,o,s,l.table)){const h=l.table.internalProps.headerHelper.getSortIcon("normal",l.table,o,s);a?YE(a,h,o,s,l):cet(o,s,h,l)}}function pet(n){for(let t=0;t<n.table.colCount;t++)for(let e=0;e<n.table.columnHeaderLevelCount;e++)lo(t,e,i=>i.attribute.funcType==="frozen",i=>{const r=n.table.internalProps.headerHelper.getFrozenIcon(t,e);cn(r,i),i.name=r.name},n)}function met(n,t,e){let i;i=e.table.isHeader(n,t)?e.table.internalProps.headerHelper.getHierarchyIcon(n,t):e.table.internalProps.bodyHelper.getHierarchyIcon(n,t),lo(n,t,r=>r.attribute.funcType===Pe.collapse||r.attribute.funcType===Pe.expand,r=>{cn(i,r),r.name=i.name},e)}function ay(n,t,e){n&&n.role!=="empty"&&n.forEachChildren(i=>{i.type==="group"?ay(i,t,e):t(i)&&e(i)})}function lo(n,t,e,i,r){const o=r.getCell(n,t);if(o.role==="cell"&&et(o.mergeStartCol)&&et(o.mergeStartRow)&&et(o.mergeEndCol)&&et(o.mergeEndRow)){const{colStart:s,colEnd:a,rowStart:l,rowEnd:u}=Js(o,r);for(let h=s;h<=a;h++)for(let d=l;d<=u;d++)ay(r.highPerformanceGetCell(h,d),e,i)}else ay(o,e,i)}function vet(n,t,e){lo(n,t,i=>i.attribute.funcType===Pe.dropDown,i=>{i.oldVisibleTime=i.attribute.visibleTime,i.setAttribute("visibleTime","always"),i.setAttribute("opacity",1)},e)}function bet(n,t,e){lo(n,t,i=>i.attribute.funcType===Pe.dropDown,i=>{i.oldVisibleTime&&i.setAttribute("visibleTime",i.oldVisibleTime),i.setAttribute("opacity",i.attribute.visibleTime==="always"?1:0)},e)}function Ib(n,t){const{bgColor:e,borderColor:i,borderLineWidth:r,borderLineDash:o}=t,s={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:e};return s.stroke=i1(i,void 0),s.lineWidth=r,o&&(s.lineDash=o),s.lineCap="butt",Array.isArray(i)&&(s.strokeArrayColor=me(i)),Array.isArray(r)&&(s.strokeArrayWidth=me(r),s.lineWidth=1),n.setAttributes(s),n.role="corner-frozen",n}function _et(n,t,e,i){var r,o;Gp(i)&&o1(i);const s=i.scenegraph,a=Fb(n.map(g=>g.col)).sort((g,m)=>m-g),l=Fb(t.map(g=>g.col)).sort((g,m)=>g-m),u=Fb(e.map(g=>g.col)).sort((g,m)=>g-m);a.forEach(g=>{Cet(g,s)});const h=i.colWidthsMap;let d;if(a.forEach(g=>{h.delAndReorder(g)}),a.length&&KE(s),s.table._clearColRangeWidthsMap(),l.forEach(g=>{const m=yet(g,s);KE(s),d=d??m,h.addAndReorder(g)}),wet(s),u.forEach(g=>{for(let m=0;m<i.rowCount;m++){const p=vi(s.table,g,m);if(p)for(let v=p.start.col;v<=p.end.col;v++)for(let b=p.start.col;b<=p.end.col;b++)Mn(b,m,s.table,!1);else Mn(g,m,s.table,!1)}}),wt(d)){for(let g=d;g<Math.max(i.colCount,(r=i.internalProps._oldColCount)!==null&&r!==void 0?r:i.colCount);g++)for(let m=0;m<Math.max(i.rowCount,(o=i.internalProps._oldRowCount)!==null&&o!==void 0?o:i.rowCount);m++){const p=s.highPerformanceGetCell(g,m,!0);p&&(p.needUpdate=!0)}s.proxy.colUpdatePos=d}if(l.length){if(!wt(d)){const g=Math.min(...l);s.proxy.colUpdatePos=g}s.proxy.colUpdateDirection="left",s.proxy.updateColGroups(2*s.proxy.screenColCount),f(),s.proxy.progress()}else a.length&&(s.proxy.updateColGroups(2*s.proxy.screenColCount),f(),s.proxy.progress());const c=i.getColsWidth(i.frozenColCount,i.colCount-1);function f(){if((l==null?void 0:l[(l==null?void 0:l.length)-1])>=i.colCount-i.rightFrozenColCount||(u==null?void 0:u[(u==null?void 0:u.length)-1])>=i.colCount-i.rightFrozenColCount||(a==null?void 0:a[0])>=i.colCount-i.rightFrozenColCount){for(let g=i.colCount-i.rightFrozenColCount;g<i.colCount;g++)for(let m=0;m<i.rowCount;m++){const p=s.highPerformanceGetCell(g,m,!0);p&&(p.needUpdate=!0)}s.proxy.updateRightFrozenCellGroups()}}s.updateContainerWidth(s.table.frozenColCount,c-s.bodyGroup.attribute.width)}function Cet(n,t){const e=t.proxy;if(n>=t.table.rowHeaderLevelCount&&!(n>=t.table.colCount-t.table.rightFrozenColCount)){const r=t.getColGroup(n,!1);r&&r.parent===t.bodyGroup&&t.bodyGroup.removeChild(r);const o=t.getColGroupInBottom(n);o&&o.parent===t.bottomFrozenGroup&&t.bottomFrozenGroup.removeChild(o);const s=t.getColGroup(n,!0);s&&s.parent===t.colHeaderGroup&&t.colHeaderGroup.removeChild(s)}n>=e.colStart&&n<=e.colEnd&&(e.colEnd--,e.currentCol--),e.bodyRightCol--;const i=Math.min(e.colLimit,e.bodyRightCol-e.bodyLeftCol+1);e.totalActualBodyColCount=i,e.totalCol=e.colStart+i-1}function yet(n,t){const e=t.proxy;e.bodyRightCol++;const i=Math.min(e.colLimit,e.bodyRightCol-e.bodyLeftCol+1);if(e.totalActualBodyColCount=i,e.totalCol=e.colStart+i-1,!(n<e.colStart))return n>e.colEnd?e.colEnd-e.colStart+1<e.colLimit?(e.colEnd++,e.currentCol++,ZE(n,t),n):void 0:(e.colEnd-e.colStart+1<e.colLimit&&(e.colEnd++,e.currentCol++,ZE(n,t)),n)}function Fb(n){const t=[];for(let e=0;e<n.length;e++)t.indexOf(n[e])===-1&&t.push(n[e]);return t}function KE(n){let t=n.bodyColStart;function e(i){i.col=t;const r=vi(n.table,i.col,i.row);r&&(i.mergeStartCol=r.start.col,i.mergeStartCol=r.start.col,i.mergeEndCol=r.end.col,i.mergeEndCol=r.end.col),i.role}n.bodyGroup.forEachChildren(i=>{i.col=t,i==null||i.forEachChildren(r=>{e(r)}),t++}),t=n.bodyColStart,n.colHeaderGroup.forEachChildren(i=>{i.col=t,i==null||i.forEachChildren(r=>{e(r)}),t++}),t=n.bodyColStart,n.bottomFrozenGroup.forEachChildren(i=>{i.col=t,i==null||i.forEachChildren(r=>{e(r)}),t++})}function wet(n){let t=n.bodyColStart,e=n.getCellGroupX(t);function i(r){r.col=t;const o=vi(n.table,r.col,r.row);o&&(r.mergeStartCol=o.start.col,r.mergeStartCol=o.start.col,r.mergeEndCol=o.end.col,r.mergeEndCol=o.end.col),r.role}n.bodyGroup.forEachChildren(r=>{r.col=t,r==null||r.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.bodyColStart,e=n.getCellGroupX(t),n.colHeaderGroup.forEachChildren(r=>{r.col=t,r==null||r.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.bodyColStart,e=n.getCellGroupX(t),n.bottomFrozenGroup.forEachChildren(r=>{r.col=t,r==null||r.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.table.colCount-n.table.rightFrozenColCount,e=0,n.rightFrozenGroup.forEachChildren(r=>{r.col=t,r==null||r.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.table.colCount-n.table.rightFrozenColCount,e=0,n.rightTopCornerGroup.forEachChildren(r=>{r.col=t,r==null||r.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.table.colCount-n.table.rightFrozenColCount,e=0,n.rightBottomCornerGroup.forEachChildren(r=>{r.col=t,r==null||r.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++})}function ZE(n,t){if(t.colHeaderGroup&&t.table.columnHeaderLevelCount>0){const i=new de({x:0,y:0,width:t.table.getColWidth(n),height:0,clip:!1,pickable:!1});i.role="column",i.col=n;const r=t.getColGroup(n,!0);r?t.colHeaderGroup.insertBefore(i,r):t.colHeaderGroup.appendChild(i),e(i,n,0,t.table.columnHeaderLevelCount-1)}if(t.bodyGroup){const i=new de({x:0,y:0,width:t.table.getColWidth(n),height:0,clip:!1,pickable:!1});i.role="column",i.col=n;const r=t.getColGroup(n,!1);r?t.bodyGroup.insertBefore(i,r):t.bodyGroup.appendChild(i),e(i,n,t.bodyRowStart,t.bodyRowEnd)}if(t.bottomFrozenGroup&&t.table.bottomFrozenRowCount>0){const i=new de({x:0,y:0,width:t.table.getColWidth(n),height:0,clip:!1,pickable:!1});i.role="column",i.col=n;const r=t.getColGroupInBottom(n);r?t.bottomFrozenGroup.insertBefore(i,r):t.bottomFrozenGroup.appendChild(i),e(i,n,t.table.rowCount-t.table.bottomFrozenRowCount,t.table.rowCount-1)}function e(i,r,o,s){for(let a=o;a<=s;a++){const l=new de({x:0,y:0,width:t.table.getColWidth(r),height:t.table.getRowHeight(a)});l.role="cell",l.col=r,l.row=a,l.needUpdate=!0,i.appendChild(l)}}}function xet(n){var t,e,i,r;if(!n.options.animationAppear)return;let o,s,a,l;n.options.animationAppear===!0?(o=500,s=0,a="one-by-one",l="column"):(o=(t=n.options.animationAppear.duration)!==null&&t!==void 0?t:500,s=(e=n.options.animationAppear.delay)!==null&&e!==void 0?e:0,a=(i=n.options.animationAppear.type)!==null&&i!==void 0?i:"one-by-one",l=(r=n.options.animationAppear.direction)!==null&&r!==void 0?r:"row");const{scenegraph:u,frozenColCount:h,frozenRowCount:d}=n,{colStart:c,colEnd:f,rowStart:g,rowEnd:m}=u.proxy;for(let p=0;p<=f;p++)for(let v=0;v<=m;v++){const b=u.highPerformanceGetCell(p,v);b&&b.role==="cell"&&b.forEachChildren(C=>{C.setAttribute("opacity",0),C.animate().wait(a==="one-by-one"?(l==="row"?v:p)*(o-s):s).to({opacity:1},o,"linear")})}}function Tet(n,t){const{selectedRangeComponents:e}=t;e.forEach((i,r)=>{i.rect.setAttributes(n)}),t.updateNextFrame()}JY(),te.load(stt),te.load(AJ);class Aet{constructor(t){let e,i;this._needUpdateContainer=!1,this.table=t,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,Y$(this.table.theme.textPopTipStyle),be.mode==="node"?(De.setEnv("node",t.options.modeParams),e=t.canvasWidth,i=t.canvasHeight):t.options.canvas&&t.options.viewBox?(De.setEnv("browser"),e=t.options.viewBox.x2-t.options.viewBox.x1,i=t.options.viewBox.y2-t.options.viewBox.y1):(De.setEnv("browser"),e=t.canvas.width,i=t.canvas.height),this.stage=QV(Object.assign({canvas:t.canvas,width:e,height:i,disableDirtyBounds:!1,background:t.theme.underlayBackgroundColor,dpr:t.internalProps.pixelRatio,enableLayout:!0,beforeRender:r=>{this.table.options.beforeRender&&this.table.options.beforeRender(r),this.table.animationManager.ticker.start()},afterRender:r=>{this.table.options.afterRender&&this.table.options.afterRender(r),this.table.fireListeners("after_render",null)},canvasControled:!t.options.canvas,viewBox:t.options.viewBox},t.options.renderOption)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.width)!==null&&e!==void 0?e:0}get height(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.height)!==null&&e!==void 0?e:0}get x(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.x)!==null&&e!==void 0?e:0}get y(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.y)!==null&&e!==void 0?e:0}get bodyRowStart(){var t;return(t=this.proxy.rowStart)!==null&&t!==void 0?t:0}get bodyRowEnd(){var t;return(t=this.proxy.rowEnd)!==null&&t!==void 0?t:this.table.rowCount-1}get bodyColStart(){var t;return(t=this.proxy.colStart)!==null&&t!==void 0?t:0}get bodyColEnd(){var t;return(t=this.proxy.colEnd)!==null&&t!==void 0?t:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),ret(this)}clearCells(){var t,e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(i=>{i.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),(t=this.proxy)===null||t===void 0||t.release(),(e=this.table.reactCustomLayout)===null||e===void 0||e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new UJ(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(t=!1){t||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(e=>{e.name==="poptipForText"&&this.stage.pluginService.register(e)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new Mtt(this.table),Nn(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(Ib(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),Ib(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),Ib(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(t,e,i){var r,o,s,a,l,u;let h;if(h=this.table.rightFrozenColCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e<this.table.frozenRowCount?(r=this.rightTopCornerGroup.getColGroup(t))===null||r===void 0?void 0:r.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<this.table.frozenColCount?(o=this.leftBottomCornerGroup.getColGroup(t))===null||o===void 0?void 0:o.getRowGroup(e):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e>=this.table.rowCount-this.table.bottomFrozenRowCount?(s=this.rightBottomCornerGroup.getColGroup(t))===null||s===void 0?void 0:s.getRowGroup(e):this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?(a=this.rightFrozenGroup.getColGroup(t))===null||a===void 0?void 0:a.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>this.table.rowCount-1-this.table.bottomFrozenRowCount?(l=this.bottomFrozenGroup.getColGroup(t))===null||l===void 0?void 0:l.getRowGroup(e):(u=this.getColGroup(t,e<this.frozenRowCount))===null||u===void 0?void 0:u.getRowGroup(e),h&&h.role==="shadow-cell"&&!i){const d=this.table.getCellRange(t,e);d.start.col===t&&d.start.row===e||(h=this.getCell(d.start.col,d.start.row))}return h||jp}highPerformanceGetCell(t,e,i){return this.proxy.highPerformanceGetCell(t,e,i)}getColGroup(t,e=!1){let i;return i=t<this.frozenColCount&&e?this.cornerHeaderGroup.getColGroup(t):t<this.frozenColCount?this.rowHeaderGroup.getColGroup(t):e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(t):!e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(t):e?this.colHeaderGroup.getColGroup(t):this.bodyGroup.getColGroup(t),i||void 0}getColGroupInBottom(t,e=!1){var i;if(e){const r=(i=this.getColGroupInLeftBottomCorner(t))!==null&&i!==void 0?i:this.getColGroupInRightBottomCorner(t);if(r)return r}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(t)}getColGroupInLeftBottomCorner(t){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(t)}getColGroupInRightTopCorner(t){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(t)}getColGroupInRightBottomCorner(t){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(t)}getCellSize(t,e){const i=this.getCell(t,e),r=vi(this.table,t,e);let o=i.attribute.width,s=i.attribute.height;return r&&(o/=r.end.col-r.start.col+1,s/=r.end.row-r.start.row+1),{width:o,height:s}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var t,e,i,r;(((e=(t=this.table.stateManager.select)===null||t===void 0?void 0:t.ranges)===null||e===void 0?void 0:e.length)>0||((r=(i=this.table.stateManager.select)===null||i===void 0?void 0:i.customSelectRanges)===null||r===void 0?void 0:r.length)>0)&&HI(this)}hideHoverIcon(t,e){net(t,e,this)}showHoverIcon(t,e){oet(t,e,this)}hideClickIcon(t,e){set(t,e,this)}showClickIcon(t,e){aet(t,e,this)}getIcon(t,e,i,r){return uet(t,e,i,r,this)}setIconHoverStyle(t,e,i,r){het(t,e,i,r,this)}updateSortIcon(t){const{col:e,row:i,iconMark:r,order:o,oldSortCol:s,oldSortRow:a,oldIconMark:l}=t;get({col:e,row:i,iconMark:r,order:o,oldSortCol:s,oldSortRow:a,oldIconMark:l,scene:this})}updateFrozenIcon(t,e){pet(this)}updateHierarchyIcon(t,e){met(t,e,this)}setIconNormalStyle(t,e,i){det(t,e,i,this)}residentHoverIcon(t,e){vet(t,e,this)}resetResidentHoverIcon(t,e){bet(t,e,this)}deactivateChart(t,e){var i,r;if(t===-1||e===-1)return;const o=this.getCell(t,e);(r=(i=o==null?void 0:o.firstChild)===null||i===void 0?void 0:i.deactivate)===null||r===void 0||r.call(i)}activateChart(t,e){var i,r,o;if(t===-1||e===-1)return;const s=this.getCell(t,e);return(r=(i=s==null?void 0:s.firstChild)===null||i===void 0?void 0:i.activate)===null||r===void 0||r.call(i,this.table),(o=s==null?void 0:s.firstChild)===null||o===void 0?void 0:o.activeChartInstance}removeInteractionBorder(t,e){const i=this.getCell(t,e);i.setAttribute("highlightStroke",void 0),i.setAttribute("highlightStrokeArrayWidth",void 0),i.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(t,e,i,r,o,s,a){Ptt(this,t,e,i,r,o,s,a)}moveSelectingRangeComponentsToSelectedRangeComponents(){$E(this)}deleteLastSelectedRangeComponents(){Ltt(this)}deleteAllSelectBorder(){qE(this),zI(this)}updateCellSelectBorder(t,e=!0){VE(this,t,e)}removeFillHandleFromSelectComponents(){Dtt(this)}recreateAllSelectRangeComponents(){qE(this),this.table.stateManager.select.ranges.forEach(t=>{VE(this,t),$E(this)})}updateColWidth(t,e,i,r){OJ(this,t,Math.round(e),r),i||this.updateContainer(!0)}updateChartSizeForResizeColWidth(t){tet(this,t)}updateChartSizeForResizeRowHeight(t){eet(this,t)}updateChartState(t){this.table.isPivotChart()&&iet(this,t)}updateCheckboxCellState(t,e,i){var r,o;if(this.table.transpose)(r=this.bodyGroup.children)===null||r===void 0||r.forEach(s=>{var a;(a=s.getChildAt(e))===null||a===void 0||a.getChildren().forEach(l=>{l.name==="checkbox"&&(i==="indeterminate"?(l.setAttribute("indeterminate",!0),l.setAttribute("checked",void 0)):(l.setAttribute("indeterminate",void 0),l.setAttribute("checked",i))),l.name==="checkbox-content"&&(i==="indeterminate"?(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})});else{const s=this.getColGroup(t);(o=s==null?void 0:s.children)===null||o===void 0||o.forEach(a=>{a.getChildren().find(l=>{l.name==="checkbox"&&(i==="indeterminate"?(l.setAttribute("indeterminate",!0),l.setAttribute("checked",void 0)):(l.setAttribute("indeterminate",void 0),l.setAttribute("checked",i))),l.name==="checkbox-content"&&(i==="indeterminate"?(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}}updateHeaderCheckboxCellState(t,e,i){var r,o;this.table.transpose?(r=this.rowHeaderGroup.children)===null||r===void 0||r.forEach(s=>{s.getChildAt(e).getChildren().forEach(a=>{a.name==="checkbox"&&(i==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i))),a.name==="checkbox-content"&&(i==="indeterminate"?(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})}):(o=this.getColGroup(t,!0).children)===null||o===void 0||o.forEach(s=>{s.getChildren().find(a=>{a.name==="checkbox"&&(i==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i))),a.name==="checkbox-content"&&(i==="indeterminate"?(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}updateAutoColWidth(t){this.table.internalProps._widthResizedColMap.delete(t);const e=this.table.getColWidth(t),i=eu(t,0,this.table.rowCount-1,this.table,!0);i!==e&&this.updateColWidth(t,i-e)}recalculateColWidths(){const t=this.table;t.widthMode==="adaptive"||t.autoFillWidth||t.internalProps.transpose?Pn(this.table,0,this.table.colCount-1,!0):(t._clearColRangeWidthsMap(),t.frozenColCount>0&&Pn(this.table,0,t.frozenColCount-1,!0),t.rightFrozenColCount>0&&Pn(this.table,t.rightFrozenColCount,t.colCount-1,!0),Pn(t,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){const t=this.table;t.internalProps.useOneRowHeightFillAll=!1,t.heightMode==="adaptive"||t.autoFillHeight?Bn(this.table,0,this.table.rowCount-1,!0,!0):(t.frozenRowCount>0&&Bn(this.table,0,t.frozenRowCount-1,!0,!0),t.bottomFrozenRowCount>0&&Bn(this.table,t.bottomFrozenRowCount,t.rowCount-1,!0,!0),Bn(t,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){var t,e;this.proxy.resize(),(this.table.widthMode==="adaptive"||this.table.autoFillWidth)&&(this.table.internalProps._widthResizedColMap.size===0?this.recalculateColWidths():this.dealWidthMode()),this.table.heightMode==="adaptive"?this.table.internalProps._heightResizedRowMap.size===0?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),(this.table.widthMode==="adaptive"||this.table.heightMode==="adaptive"||this.table.autoFillWidth||this.table.autoFillHeight||!((t=this.table.containerFit)===null||t===void 0)&&t.width||!((e=this.table.containerFit)===null||e===void 0)&&e.height)&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m;const p=Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0),v=Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0);let b=p,C=v;if(b=!((t=this.table.containerFit)===null||t===void 0)&&t.width?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,p),C=!((e=this.table.containerFit)===null||e===void 0)&&e.height?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,v),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:b,height:C}),this.tableGroup.border){const y=(i=this.tableGroup.border)===null||i===void 0?void 0:i.attribute;let w,_,A,T;y!=null&&y.strokeArrayWidth?(w=y.strokeArrayWidth?y.strokeArrayWidth[0]:(r=y.lineWidth)!==null&&r!==void 0?r:0,_=y.strokeArrayWidth?y.strokeArrayWidth[1]:(o=y.lineWidth)!==null&&o!==void 0?o:0,A=y.strokeArrayWidth?y.strokeArrayWidth[2]:(s=y.lineWidth)!==null&&s!==void 0?s:0,T=y.strokeArrayWidth?y.strokeArrayWidth[3]:(a=y.lineWidth)!==null&&a!==void 0?a:0):(w=(l=y==null?void 0:y.lineWidth)!==null&&l!==void 0?l:0,_=(u=y==null?void 0:y.lineWidth)!==null&&u!==void 0?u:0,A=(h=y==null?void 0:y.lineWidth)!==null&&h!==void 0?h:0,T=(d=y==null?void 0:y.lineWidth)!==null&&d!==void 0?d:0),this.tableGroup.border.type==="rect"?!((c=this.table.theme.frameStyle)===null||c===void 0)&&c.innerBorder?this.tableGroup.border.setAttributes({x:this.table.tableX+T/2,y:this.table.tableY+w/2,width:this.tableGroup.attribute.width-T/2-_/2,height:this.tableGroup.attribute.height-w/2-A/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-T/2,y:this.table.tableY-w/2,width:this.tableGroup.attribute.width+T/2+_/2,height:this.tableGroup.attribute.height+w/2+A/2}):this.tableGroup.border.type==="group"&&(!((f=this.table.theme.frameStyle)===null||f===void 0)&&f.innerBorder?(this.tableGroup.border.setAttributes({x:this.table.tableX+T/2,y:this.table.tableY+w/2,width:this.tableGroup.attribute.width-T/2-_/2,height:this.tableGroup.attribute.height-w/2-A/2}),(g=this.tableGroup.border.firstChild)===null||g===void 0||g.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-T/2-_/2,height:this.tableGroup.attribute.height-w/2-A/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-T/2,y:this.table.tableY-w/2,width:this.tableGroup.attribute.width+T/2+_/2,height:this.tableGroup.attribute.height+w/2+A/2}),(m=this.tableGroup.border.firstChild)===null||m===void 0||m.setAttributes({x:T/2,y:w/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(t,e,i){e=Math.round(e),SE(this,t,e,i),this.updateContainerHeight(t,e)}updateRowsHeight(t,e,i){for(let r=0;r<t.length;r++){const o=t[r];if(o>=this.proxy.rowStart&&o<=this.proxy.rowEnd){const s=e[r];SE(this,o,Math.round(s),i),this._updateContainerHeight(o,s)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(t,e){t<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(e),this.cornerHeaderGroup.setDeltaWidth(e),this.colHeaderGroup.setDeltaX(e),this.bodyGroup.setDeltaX(e)):(this.colHeaderGroup.setDeltaWidth(e),this.bodyGroup.setDeltaWidth(e)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(t,e){t<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(e),this.cornerHeaderGroup.setDeltaHeight(e),this.rowHeaderGroup.setDeltaY(e),this.bodyGroup.setDeltaY(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(e)):t>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(e),this.bottomFrozenGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(e)):(this.rowHeaderGroup.setDeltaHeight(e),this.bodyGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(e))}updateContainerHeight(t,e){this._updateContainerHeight(t,e),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(t,e){const i=this.table.getColWidth(t);i!==e&&(this.updateColWidth(t,e-i),this.table._clearColRangeWidthsMap(t))}setRowHeight(t,e){const i=this.table.getRowHeight(t);i!==e&&((t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1||t<this.table.frozenRowCount)&&this.updateRowHeight(t,e-i),this.table._clearRowRangeHeightsMap(t))}setX(t,e=!1){this.table.scenegraph.proxy.setX(-t,e)}setY(t,e=!1){this.table.scenegraph.proxy.setY(-t,e)}setBodyAndRowHeaderY(t){var e,i,r,o,s,a;const l=(i=(e=this.bodyGroup.firstChild)===null||e===void 0?void 0:e.firstChild)!==null&&i!==void 0?i:(r=this.rowHeaderGroup.firstChild)===null||r===void 0?void 0:r.firstChild,u=(s=(o=this.bodyGroup.firstChild)===null||o===void 0?void 0:o.lastChild)!==null&&s!==void 0?s:(a=this.rowHeaderGroup.firstChild)===null||a===void 0?void 0:a.lastChild;t===0&&l&&l.row===this.table.frozenRowCount&&l.attribute.y+t<0?t=-l.attribute.y:u&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&u.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&u.attribute.y+u.attribute.height+t<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(t=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-u.attribute.y-u.attribute.height),this.colHeaderGroup.attribute.height+t!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+t),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+t),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+t),this.updateNextFrame())}setBodyAndColHeaderX(t){const e=this.bodyGroup.firstChild,i=this.bodyGroup.lastChild;t===0&&e&&e.col===this.table.frozenColCount&&e.attribute.x+t<0?t=-e.attribute.x:i&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&i.col===this.table.colCount-this.table.rightFrozenColCount-1&&i.attribute.x+i.attribute.width+t<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(t=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-i.attribute.x-i.attribute.width),this.table.getFrozenColsWidth()+t!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.updateNextFrame())}afterScenegraphCreated(){this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),Qh(this.table),this.table.options.animationAppear&&xet(this.table),this.updateNextFrame()}dealWidthMode(){const t=this.table;if(t.widthMode==="adaptive"){t._clearColRangeWidthsMap();const s=t.tableNoFrameWidth;let a=0,l=0,u=t.colCount;if(t.widthAdaptiveMode==="only-body"){for(let h=0;h<t.colCount;h++)(h<t.rowHeaderLevelCount||t.isPivotChart()&&h>=t.colCount-t.rightFrozenColCount)&&(a+=t.getColWidth(h));l=t.rowHeaderLevelCount,u=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}Vp(s-a,l,u,!1,[],t,!0)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();const s=t.tableNoFrameWidth;let a=0,l=0;for(let u=0;u<t.colCount;u++){const h=t.getColWidth(u);(u<t.rowHeaderLevelCount||t.isPivotChart()&&u>=t.colCount-t.rightFrozenColCount)&&(a+=h),l+=h}if(l<s&&l>a){const u=t.rowHeaderLevelCount,h=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount;Vp(s-a,u,h,!1,[],t,!0)}}let e=0;this.bodyGroup.forEachChildrenSkipChild(s=>{e+=s.attribute.width}),this.bodyGroup.setAttribute("width",e);let i=0;this.colHeaderGroup.forEachChildrenSkipChild(s=>{i+=s.attribute.width}),this.colHeaderGroup.setAttribute("width",i);let r=0;this.rowHeaderGroup.forEachChildrenSkipChild(s=>{r+=s.attribute.width}),this.rowHeaderGroup.setAttribute("width",r);let o=0;this.cornerHeaderGroup.forEachChildrenSkipChild(s=>{o+=s.attribute.width}),this.cornerHeaderGroup.setAttribute("width",o),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var t;const e=this.table;if(e.heightMode==="adaptive"){e._clearRowRangeHeightsMap();const i=e.getRowsHeight(0,e.columnHeaderLevelCount-1),r=e.isPivotChart()?e.getBottomFrozenRowsHeight():0,o=e.tableNoFrameHeight-i-r,s=e.columnHeaderLevelCount,a=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount;let l=0;for(let h=s;h<a;h++)l+=e.getRowHeight(h);const u=o/l;for(let h=s;h<a;h++){let d;d=h===a-1?o-e.getRowsHeight(s,a-2):Math.round(e.getRowHeight(h)*u),this.setRowHeight(h,d)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();const i=e.tableNoFrameHeight;let r=0,o=0;for(let s=0;s<e.rowCount;s++){const a=e.getRowHeight(s);(s<e.columnHeaderLevelCount||e.isPivotChart()&&s>=e.rowCount-e.bottomFrozenRowCount)&&(o+=a),r+=a}if(((t=this._dealAutoFillHeightOriginRowsHeight)!==null&&t!==void 0?t:r)<i&&r-o>0){const s=e.columnHeaderLevelCount,a=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,l=(i-o)/(r-o);for(let u=s;u<a;u++){let h;h=u===a-1?i-o-e.getRowsHeight(s,a-2):Math.round(e.getRowHeight(u)*l),this.setRowHeight(u,h)}}}}dealFrozen(){Vtt(this)}resetFrozen(){jtt(this)}resetRowFrozen(){qtt(this)}updateCellLayoutWidthCertainWidth(t,e,i){const r=t.attribute.width;let o=!1;return t.forEachChildren((s,a)=>{a+=e;const l=vi(this.table,i,a);l?s=this.getCell(l.start.col,l.start.row):s.setAttribute("width",r);const u=this.table._getCellStyle(i,a),h=me(pt("padding",u,i,a,this.table)),d=s.getChildByName("text");let c=0,f=0;if(d)c=d.AABBBounds.height()+(h[0]+h[2]),d.setAttribute("maxLineWidth",r-(h[1]+h[3])),f=d.AABBBounds.height()+(h[0]+h[2]);else{const m=s.getChildAt(1);c=m.AABBBounds.height()+(h[0]+h[2]),m._cellWidth=r-(h[1]+h[3]),m.layout(),f=m.AABBBounds.height()+(h[0]+h[2])}const g=this.table.getRowHeight(a);s.attribute.height!==f&&(s.setAttribute("height",f),(g===c||f>g)&&(o=!0))}),o}updateHeaderPosition(t,e,i,r,o){Btt(t,e,i,r,o,this.table)}updateContainerAttrWidthAndX(){var t,e,i;const r=Yo(this.cornerHeaderGroup,0),o=Yo(this.rowHeaderGroup,0),s=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?Yo(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth((t=this.table.frozenColCount)!==null&&t!==void 0?t:0,this.colHeaderGroup.firstChild.col-1):0):0,a=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?Yo(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth((e=this.table.frozenColCount)!==null&&e!==void 0?e:0,this.bodyGroup.firstChild.col-1):0):0,l=Yo(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&Yo(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth((i=this.table.frozenColCount)!==null&&i!==void 0?i:0,this.bottomFrozenGroup.firstChild.col-1):0),Yo(this.leftBottomCornerGroup,0),Yo(this.rightTopCornerGroup,0),Yo(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(r-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(r-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(s-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(o-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(s-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(l-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(l-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(l-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(a-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainer(t=!1){t?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{this.updateContainerSync()},0)):(this._needUpdateContainer=!0,this.updateContainerSync())}updateContainerSync(){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(t,e){var i;const r=!((i=this.table.getCellRawRecord(t,e))===null||i===void 0)&&i.vtableMerge?"text":this.table.isHeader(t,e)?this.table._getHeaderLayoutMap(t,e).headerType:this.table.getBodyColumnType(t,e),o=this.getCell(t,e);r!=="image"&&r!=="video"||Ld(o,t,e,0,0,this.table)}createFrameBorder(){var t,e,i,r,o;this.updateTableSize();const s=!this.isPivot&&!this.table.internalProps.transpose;Nn(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,s?[!0,!0,!0,!1]:void 0),Nn(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),Nn(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,s?[!0,!0,!0,!1]:void 0),Nn(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),!((t=this.table.theme.cornerLeftBottomCellStyle)===null||t===void 0)&&t.frameStyle&&Nn(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,s?[!0,!1,!0,!0]:void 0),!((e=this.table.theme.bottomFrozenStyle)===null||e===void 0)&&e.frameStyle&&Nn(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,s?[!0,!0,!0,!1]:void 0),!((i=this.table.theme.rightFrozenStyle)===null||i===void 0)&&i.frameStyle&&Nn(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),!((r=this.table.theme.cornerRightTopCellStyle)===null||r===void 0)&&r.frameStyle&&Nn(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),!((o=this.table.theme.cornerRightBottomCellStyle)===null||o===void 0)&&o.frameStyle&&Nn(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),Nn(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(t,e,i){const r=this.table.theme.columnResize.resizeHotSpotSize/2;let o;if(!i){const s=this.table.getDrawRange();return e>=s.top&&e<=s.bottom&&(o=this.table.getCellAtRelativePosition(t-r,e),o.col===this.table.colCount-1)?o:{col:-1,row:-1}}return i.stage?(t<i.globalAABBBounds.x1+r?o={col:i.col-1,row:i.row,x:i.globalAABBBounds.x1}:i.globalAABBBounds.x2-r<t&&(o={col:i.col,row:i.row,x:i.globalAABBBounds.x2}),o&&this.table.rightFrozenColCount>0&&o.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(o.col=o.col+1,o.rightFrozen=!0),o||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(t,e,i){const r=this.table.theme.columnResize.resizeHotSpotSize/2;if(i){let o;if(e<i.globalAABBBounds.y1+r?o={col:i.col,row:i.row-1,y:i.globalAABBBounds.y1}:i.globalAABBBounds.y2-r<e&&(o={col:i.col,row:i.row,y:i.globalAABBBounds.y2}),o&&this.table.bottomFrozenRowCount>0&&o.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(o.row=o.row+1,o.bottomFrozen=!0),o)return o}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(t){this.clear?this.table.internalProps.rightFrozenColCount=t:Gtt(t,this)}dealWidthBottomFrozen(t){this.clear?this.table.internalProps.bottomFrozenRowCount=t:$tt(t,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),qo(this.bodyGroup),this.rowHeaderGroup.attribute.width,EE(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),qo(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,EE(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),qo(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),qo(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),qo(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),qo(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),qo(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),qo(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),qo(this.rightBottomCornerGroup)),VJ(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(t,e){const i=this.getCell(t,e).getChildByName("text",!0);if(i&&i.type==="text"){if(i.attribute.moreThanMaxCharacters)return this.table.getCellValue(t,e);if(i.cliped)return this.table.getCellValue(t,e)}else if(i&&i.type==="richtext"){const r=i;if(r.attribute.ellipsis&&r._frameCache&&r.attribute.height<r._frameCache.actualHeight)return r.attribute.textConfig.find(o=>o.text),this.table.getCellValue(t,e)}return null}updateDrill(t,e,i,r,o){this.component.drillIcon.update(t,e,i,r,o,this)}updateCellContent(t,e,i=!1){if(!this.clear)return Mn(t,e,this.table,void 0,void 0,i)}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(t,e,i=[],r=!0,o){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;const s=Gh(e.map(u=>u.row)).sort((u,h)=>u-h),a=Gh(i.map(u=>u.row)).sort((u,h)=>u-h),l=this.table.getAllRowsHeight()-[...s,...a].reduce((u,h)=>u+this.table.getRowHeight(h),0)<=this.table.tableNoFrameHeight;if(Itt(t,e,i,this.table,o),r&&this.recalculateColWidths(),this.table.heightMode==="adaptive"||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||l))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let u=0;u<a.length;u++){const h=a[u],d=this.table.getRowHeight(h),c=An(h,0,this.table.colCount-1,this.table);(h>=this.proxy.rowStart&&h<=this.proxy.rowEnd||h>=this.table.rowCount-this.table.bottomFrozenRowCount&&h<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(h,c-d)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(t,e,i=[]){_et(t,e,i,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)Mn(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)Mn(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)Mn(e,t,this.table,!1)}getColumnGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupY(t){return t<this.table.frozenRowCount?this.table.getRowsHeight(0,t-1):t<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.frozenRowCount,t-1):t<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,t-1):0}updateDomContainer(){Utt(this.table)}setLoadingHierarchyState(t,e){const i=this.getCell(t,e),r=i.getChildByName("collapse",!0)||i.getChildByName("expand",!0);if(r){const o=Fn()[ir.loadingIconName];o&&cn(o,r,t,e)}}temporarilyUpdateSelectRectStyle(t){Tet(t,this)}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}}function Ret(n,t,e){for(let i=0;i<e.length;i++){const r=e[i];if(Ln(r,n,t))return!0}return!1}function Eet(n,t,e,i){for(let r=0;r<e.length;r++){const o=e[r];if(YK(o,{start:n,end:t}))return!0}return!1}function $u(n,t,e){const i=n.highPerformanceGetCell(t,e);if(i.role==="cell"&&et(i.mergeStartCol)&&et(i.mergeStartRow)&&et(i.mergeEndCol)&&et(i.mergeEndRow)){const{colStart:r,colEnd:o,rowStart:s,rowEnd:a}=Js(i,n);for(let l=r;l<=o;l++)for(let u=s;u<=a;u++){const h=n.highPerformanceGetCell(l,u);h.role==="cell"&&h.addUpdateBoundTag()}}else i.addUpdateBoundTag()}function QE(n,t,e,i,r){const o=n.table;for(let a=0;a<o.columnHeaderLevelCount;a++)$u(n,t,a);const s=n.getColGroup(t);return s==null||s.addUpdateBoundTag(),!0}function JE(n,t,e,i,r,o){const s=n.table;for(let l=0;l<s.columnHeaderLevelCount;l++)$u(n,t,l);const a=n.getColGroup(t);return a==null||a.addUpdateBoundTag(),!0}function tM(n,t,e,i,r){const o=n.table;for(let s=0;s<o.colCount;s++)$u(n,s,e);return!0}function eM(n,t,e,i,r,o){const s=n.table;for(let a=0;a<s.colCount;a++)$u(n,a,e);return!0}function Met(n,t,e,i,r){return $u(n,t,e),!0}function Bet(n,t,e,i,r){return $u(n,t,e),!0}function Pet(n,t,e){var i;const{table:r}=n,{scenegraph:o}=r,{highlightScope:s,singleStyle:a,disableHeader:l,cellPos:u,cellPosContainHeader:h}=n.hover,d=u.col,c=u.row;if(s===ye.none||l&&(h.col!==t||h.row!==e)){const p=h.col,v=h.row;o.hideHoverIcon(p,v),o.showHoverIcon(t,e),h.col=t,h.row=e}if((l&&r.isHeader(t,e)||s===ye.none)&&(t=-1,e=-1),d===t&&c===e)return;!((i=n.table.options.customConfig)===null||i===void 0)&&i.disableBuildInChartActive||(o.deactivateChart(d,c),o.activateChart(t,e));let f=!1;const{ranges:g,highlightScope:m}=n.select;if(d!==-1&&c!==-1&&(f=ket(o,d,c,g,a,s),l||o.hideHoverIcon(d,c)),t===-1||e===-1)return u.col=-1,u.row=-1,void(!f||d===t&&c===e||n.table.scenegraph.updateNextFrame());s===ye.single?f=!!Bet(o,t,e):s===ye.row?f=!!eM(o,t,e):s===ye.column?f=!!JE(o,t):s===ye.cross&&(f=!!eM(o,t,e),f=!!JE(o,t)),s===ye.none||l||o.showHoverIcon(t,e),u.col=t,u.row=e,f&&n.table.scenegraph.updateNextFrame()}function ket(n,t,e,i,r,o,s){let a=!1;return o===ye.single?a=!!Met(n,t,e):o===ye.row?a=!!tM(n,t,e):o===ye.column?a=!!QE(n,t):o===ye.cross&&(a=!!tM(n,t,e),a=!!QE(n,t)),a}function Let(n,t,e){e.frozenColCount>0?n!==e.frozenColCount-1?e.setFrozenColCount(n+1):e.setFrozenColCount(0):e.setFrozenColCount(n+1)}function Det(n,t,e,i){var r;let o,s=null,a=!1;if(Array.isArray(e.sortState))for(let c=0;c<e.sortState.length&&(o=e.sortState[c],o&&(s=e._getHeaderCellBySortState(o)),s&&(a=iM(n,t,s.col,s.row,e)),!a);c++);else o=e.sortState,o&&(s=e._getHeaderCellBySortState(o)),s&&(a=iM(n,t,s.col,s.row,e));const l=e.getHeaderDefine(n,t);if(o&&a&&(l!=null&&l.sort)?o.order=o.order==="asc"?"desc":o.order==="desc"?"normal":"asc":l!=null&&l.sort?o={field:e.getHeaderField(n,t),order:"asc"}:a&&(l!=null&&l.showSort)||(o={field:e.getHeaderField(n,t),order:"normal"}),o.event=i,e.fireListeners(ut.SORT_CLICK,o).includes(!1))return;let u=!1,h=e.internalProps.sortState?Array.isArray(e.internalProps.sortState)&&(u=!0)?e.internalProps.sortState:[e.internalProps.sortState]:[];if(Array.isArray(h)){const c=h.findIndex(f=>f.field===o.field);c>=0?h[c]=o:h.push(o)}h=h.filter(c=>c.order!=="normal"),h=e.internalProps.multipleSort&&(u=!0)?h:h.splice(-1),h=u&&h.length?h:h[0],e.internalProps.sortState=h,e.stateManager.setSortState(h),l!=null&&l.sort&&Iet(h,e),e.internalProps.useOneRowHeightFillAll=!1,e.internalProps.layoutMap.clearCellRangeMap(),e.scenegraph.sortCell();const d=!!(!((r=e.stateManager.select.ranges)===null||r===void 0)&&r.length);e.stateManager.updateSelectPos(-1,-1),e.stateManager.endSelectCells(!0,d)}function Iet(n,t,e){n=Array.isArray(n)||!n?n:[n],t.dataSource.sort((n||[]).map(i=>{var r,o;const s=t.internalProps.layoutMap.headerObjects.find(a=>a&&a.field===i.field);return{field:i.field,order:i.order||"asc",orderFn:typeof((r=s==null?void 0:s.define)===null||r===void 0?void 0:r.sort)=="function"?(o=s==null?void 0:s.define)===null||o===void 0?void 0:o.sort:pp}}))}function iM(n,t,e,i,r){return r._getLayoutCellId(n,t)===r._getLayoutCellId(e,i)}function Fet(n,t,e,i,r,o,s=!0,a=!1){var l,u;const{table:h,interactionState:d}=n,{scenegraph:c}=h,{highlightScope:f,disableHeader:g,cellPos:m,disableCtrlMultiSelect:p}=n.select;if(t!==-1&&e!==-1&&s&&h._makeVisibleCell(t,e),t!==-1&&e!==-1&&s)if(d===Qt.grabing&&n.select.ranges.length>0){const v=n.select.ranges[n.select.ranges.length-1];t>v.start.col&&t>v.end.col&&h._makeVisibleCell(t+1,e),e>v.start.row&&e>v.end.row&&h._makeVisibleCell(t,e+1),t<v.start.col&&t<v.end.col&&h._makeVisibleCell(t-1,e),e<v.start.row&&e<v.end.row&&h._makeVisibleCell(t,e-1)}else h._makeVisibleCell(t,e);if(o){n.select.ranges=[],c.deleteAllSelectBorder();let v=0,b=0;const{disableHeaderSelect:C,disableRowSeriesNumberSelect:y}=((l=h.options.keyboardOptions)===null||l===void 0?void 0:l.selectAllOnCtrlA)||{};C&&(v=h.rowHeaderLevelCount,b=h.columnHeaderLevelCount),(y||C&&h.transpose)&&h.options.rowSeriesNumber&&(v+=1),n.select.ranges.push({start:{col:v,row:b},end:{col:h.colCount-1,row:h.rowCount-1}});const w=n.select.ranges[n.select.ranges.length-1];c.updateCellSelectBorder(w,!1)}else if(m.col===-1||m.row===-1||t!==-1&&e!==-1)if(d!==Qt.default||h.eventManager.isDraging||h.stateManager.isResizeCol()){if((d===Qt.grabing||h.eventManager.isDraging)&&!h.stateManager.isResizeCol()){let v=!0;m.col===-1&&(m.col=t),m.row===-1&&(m.row=e),m.col=t,m.row=e;const b=n.select.ranges[n.select.ranges.length-1];if(b){if(h.internalProps.layoutMap.isSeriesNumberInBody(b.start.col,b.start.row))v=!1,b.end={col:h.colCount-1,row:e};else if(n.fillHandle.isFilling){if(n.fillHandle.direction==="top")if(e===n.fillHandle.beforeFillMinRow&&e===n.fillHandle.beforeFillMaxRow)b.start.row=b.end.row=e;else if(e<=n.fillHandle.beforeFillMinRow){if(b.start.row<b.end.row){const C=b.start.row;b.start.row=b.end.row,b.end.row=C}b.end.row=e}else e===n.fillHandle.beforeFillMaxRow&&(b.start.row>b.end.row?b.start.row=e:b.end.row=e);else if(n.fillHandle.direction==="bottom"){if(e>=n.fillHandle.beforeFillMaxRow){if(b.start.row>b.end.row){const C=b.start.row;b.start.row=b.end.row,b.end.row=C}b.end.row=e}}else if(n.fillHandle.direction==="left")if(t===n.fillHandle.beforeFillMinCol&&t===n.fillHandle.beforeFillMaxCol)b.start.col=b.end.col=t;else if(t<=n.fillHandle.beforeFillMinCol){if(b.start.col<b.end.col){const C=b.start.col;b.start.col=b.end.col,b.end.col=C}b.end.col=t}else t===n.fillHandle.beforeFillMaxCol&&(b.start.col>b.end.col?b.start.col=t:b.end.col=t);else if(n.fillHandle.direction==="right"&&t>=n.fillHandle.beforeFillMaxCol){if(b.start.col>b.end.col){const C=b.start.col;b.start.col=b.end.col,b.end.col=C}b.end.col=t}}else{b.end={col:t,row:e};const C=a?{start:{col:t,row:e},end:{col:t,row:e}}:h.getCellRange(t,e);b.start.col<C.end.col?b.end.col=C.end.col:b.start.col>C.start.col&&(b.end.col=C.start.col),b.start.row<C.end.row?b.end.row=C.end.row:b.start.row>C.start.row&&(b.end.row=C.start.row),n.select.headerSelectMode==="body"&&(h.isRowHeader(t,e)?(b.start.col=h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,b.end.col=h.colCount-1):h.isColumnHeader(t,e)?(b.start.row=h.columnHeaderLevelCount,b.end.row=h.rowCount-1):h.internalProps.layoutMap.isSeriesNumberInBody(t,e)?(b.start.col=h.leftRowSeriesNumberCount,b.end.col=h.colCount-1):h.isCornerHeader(t,e)?(b.start.col=h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,b.start.row=h.columnHeaderLevelCount,b.end.col=h.colCount-1,b.end.row=h.rowCount-1):h.isSeriesNumber(t,e)&&(b.start.col=h.leftRowSeriesNumberCount,b.start.row=h.columnHeaderLevelCount,b.end.col=h.colCount-1,b.end.row=h.rowCount-1)),a&&(b.skipBodyMerge=!0)}b&&b.start.row<=h.rowCount-1&&b.end.row<=h.rowCount-1&&b.start.col<=h.colCount-1&&b.end.col<=h.colCount-1&&c.updateCellSelectBorder(b,v)}}}else{const v=n.select.ranges[n.select.ranges.length-1];if(i&&v){if(r&&!p||(m.col=t,m.row=e),n.select.headerSelectMode!=="cell"&&h.isColumnHeader(t,e)){const b=Math.min(v.start.col,v.end.col,t),C=Math.max(v.start.col,v.end.col,t),y=Math.min(v.start.row,v.end.row,e),w=h.rowCount-1;n.select.headerSelectMode==="body"?(v.start={col:b,row:h.columnHeaderLevelCount},v.end={col:C,row:h.rowCount-1}):(v.start={col:b,row:y},v.end={col:C,row:w})}else if(n.select.headerSelectMode!=="cell"&&h.isRowHeader(t,e)){const b=Math.min(v.start.col,v.end.col,t),C=h.colCount-1,y=Math.min(v.start.row,v.end.row,e),w=Math.max(v.start.row,v.end.row,e);n.select.headerSelectMode==="body"?(v.start={col:h.leftRowSeriesNumberCount+h.rowHeaderLevelCount,row:y},v.end={col:h.colCount-1,row:w}):(v.start={col:b,row:y},v.end={col:C,row:w})}else if(n.select.headerSelectMode!=="cell"&&h.isSeriesNumberInBody(t,e)){const b=Math.min(v.start.col,v.end.col,t),C=h.colCount-1,y=Math.min(v.start.row,v.end.row,e),w=Math.max(v.start.row,v.end.row,e);n.select.headerSelectMode==="body"?(v.start={col:h.leftRowSeriesNumberCount,row:y},v.end={col:h.colCount-1,row:w}):(v.start={col:b,row:y},v.end={col:C,row:w})}else v.end={col:t,row:e};c.deleteLastSelectedRangeComponents(),c.updateCellSelectBorder(v)}else{let b=!0;if(m.col===-1||m.row===-1||r&&!p||(n.select.ranges=[],c.deleteAllSelectBorder()),n.select.headerSelectMode!=="cell"&&h.isColumnHeader(t,e)){const y=h.getCellRange(t,e);n.select.headerSelectMode==="body"?n.select.ranges.push({start:{col:y.start.col,row:h.columnHeaderLevelCount},end:{col:y.end.col,row:h.rowCount-1},skipBodyMerge:!0}):n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:y.end.col,row:h.rowCount-1},skipBodyMerge:!0})}else if(n.select.headerSelectMode!=="cell"&&h.isRowHeader(t,e)){const y=h.getCellRange(t,e);n.select.headerSelectMode==="body"?n.select.ranges.push({start:{col:h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,row:y.start.row},end:{col:h.colCount-1,row:y.end.row},skipBodyMerge:!0}):n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:h.colCount-1,row:y.end.row},skipBodyMerge:!0})}else if(h.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){b=!1;const{cornerHeaderSelectMode:y}=n.select;if(y==="body")n.select.ranges.push({start:{col:h.leftRowSeriesNumberCount,row:h.columnHeaderLevelCount},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0});else if(y==="inline"){const w=a?{start:{col:t,row:e},end:{col:t}}:h.getCellRange(t,e);n.select.ranges.push({start:{col:w.start.col,row:w.start.row},end:{col:w.end.col,row:h.rowCount-1},skipBodyMerge:!0})}else if(y==="cell"){const w=a?{start:{col:t,row:e},end:{col:t,row:e}}:h.getCellRange(t,e);n.select.ranges.push({start:{col:w.start.col,row:w.start.row},end:{col:w.end.col,row:w.end.row},skipBodyMerge:a||void 0})}else n.select.ranges.push({start:{col:0,row:0},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0})}else if(h.internalProps.layoutMap.isSeriesNumberInBody(t,e))b=!1,n.select.headerSelectMode==="body"?n.select.ranges.push({start:{col:h.leftRowSeriesNumberCount,row:e},end:{col:h.colCount-1,row:e},skipBodyMerge:!0}):n.select.ranges.push({start:{col:t,row:e},end:{col:h.colCount-1,row:e},skipBodyMerge:!0});else if(h.internalProps.layoutMap.isCornerHeader(t,e)){b=!1;const{cornerHeaderSelectMode:y}=n.select;if(y==="body")n.select.ranges.push({start:{col:h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,row:h.columnHeaderLevelCount},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0});else if(y==="cell"){const w=a?{start:{col:t,row:e},end:{col:t,row:e}}:h.getCellRange(t,e);n.select.ranges.push({start:{col:w.start.col,row:w.start.row},end:{col:w.end.col,row:w.end.row},skipBodyMerge:a||void 0})}else if(y==="inline"){const w=a?{start:{col:t,row:e},end:{col:t}}:h.getCellRange(t,e);n.select.ranges.push({start:{col:w.start.col,row:w.start.row},end:{col:w.end.col,row:h.rowCount-1},skipBodyMerge:!0})}else n.select.ranges.push({start:{col:h.leftRowSeriesNumberCount,row:0},end:{col:h.colCount-1,row:h.rowCount-1},skipBodyMerge:!0})}else if(t>=0&&e>=0){const y=a?{start:{col:t,row:e},end:{col:t,row:e}}:h.getCellRange(t,e);n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:y.end.col,row:y.end.row},skipBodyMerge:a||void 0})}m.col=t,m.row=e;const C=(u=n.select.ranges)===null||u===void 0?void 0:u[n.select.ranges.length-1];C&&C.start.row<=h.rowCount-1&&C.end.row<=h.rowCount-1&&C.start.col<=h.colCount-1&&C.end.col<=h.colCount-1&&c.updateCellSelectBorder(C,b)}}else m.col=-1,m.row=-1,n.select.ranges=[],c.deleteAllSelectBorder();c.updateNextFrame()}function Oet(n){n.moveSelectingRangeComponentsToSelectedRangeComponents()}const Ph=Jd(ut,{PIVOT_SORT_CLICK:"pivot_sort_click",DRILLMENU_CLICK:"drillmenu_click"});Jd(ut,{VCHART_EVENT_TYPE:"vchart_event_type"});function Het(n,t,e,i,r){const o=r.getCellLocation(n,t);let s=0,a=0,l=!1;o==="columnHeader"?(s=r.getColsWidth(0,r.rowHeaderLevelCount-1)-(r.frozenColCount===0?r.scrollLeft:0),a=r.getRowsHeight(0,t-1)+r.getRowHeight(t)/2,l=!0):o==="rowHeader"&&(a=r.getRowsHeight(0,r.columnHeaderLevelCount-1),s=r.getColsWidth(0,n-1)+r.getColWidth(n)/2,l=!0),r.scenegraph.updateDrill(l,s,a,e,i)}function zet(n,t,e){const i=e.scenegraph.getCell(n,t).getChildByName("sparkline"),r=i==null?void 0:i.getChildByName("highlight-line"),o=i==null?void 0:i.getChildByName("highlight-symbol");r&&r.setAttributes({visible:!1,pickable:!1}),o&&o.setAttributes({visible:!1,pickable:!1}),e.scenegraph.updateNextFrame()}function Net(n,t,e,i,r){var o,s;const a=r.scenegraph.getCell(n,t).getChildByName("sparkline"),l=a==null?void 0:a.getChildByName("sparkline-line"),u=a==null?void 0:a.getChildByName("sparkline-symbol-group");if(!l)return!1;const h=l.bandwidth,d=l.min,c=l.max,f=l.attribute.points;let g;e-=a.globalAABBBounds.x1,a.globalAABBBounds.y1;for(let m=0;m<f.length;m++){const{x:p,y:v,defined:b,rawData:C}=f[m];if(Math.abs(e-p)<h/2&&(g={point:f[m],points:f,pointsBandWidth:h,pointData:C},b)){const y=a.getChildByName("highlight-line");if(y)y.setAttributes({points:[{x:p,y:c},{x:p,y:d}],visible:!0,pickable:!0});else{const _=ln({points:[{x:p,y:c},{x:p,y:d}],lineWidth:(o=l.hover)===null||o===void 0?void 0:o.strokeWidth,stroke:(s=l.hover)===null||s===void 0?void 0:s.stroke});_.name="highlight-line",a.addChild(_)}const w=a.getChildByName("highlight-symbol");if(w)w.setAttributes({x:p,y:v,visible:!0,pickable:!0});else{const _=yu({x:p,y:v,stroke:u.hover.stroke,lineWidth:u.hover.strokeWidth,fill:u.hover.fill,size:2*u.hover.size,symbolType:"circle"});_.name="highlight-symbol",a.addChild(_)}break}}if(r.scenegraph.updateNextFrame(),g){const m={col:n,row:t,field:r.getHeaderField(n,t),value:r.getCellValue(n,t),dataValue:r.getCellOriginValue(n,t),cellHeaderPaths:r.internalProps.layoutMap.getCellHeaderPaths(n,t),title:r.getBodyColumnDefine(n,t).title,cellRange:r.getCellRelativeRect(n,t),sparkline:{pointData:g.pointData},scaleRatio:r.canvas.getBoundingClientRect().width/r.canvas.offsetWidth};r.fireListeners(ut.MOUSEOVER_CHART_SYMBOL,m)}return!0}function Wet(n,t,e){const i=e.getCellRange(n.col,n.row);if(e.isColumnHeader(n.col,n.row)){const r=e.getCellRange(t.col,i.start.row);t.row>=e.columnHeaderLevelCount&&(t.row=e.columnHeaderLevelCount-1),t.col>=n.col?t.col=r.end.col:t.col=r.start.col}else if(e.isRowHeader(n.col,n.row)){const r=e.internalProps.layoutMap,o=e.getCellRange(i.start.col,t.row);if(t.col>=e.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount&&(t.col=e.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount-1),r.rowHierarchyType==="tree"){const s=r.getCellHeaderPathsWithTreeNode(n.col,n.row).rowHeaderPaths,a=r.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths;if(s.length<=a.length){const l=a[s.length-1];l&&(t.row>=n.row?t.row=l.startInTotal+l.size-1+e.columnHeaderLevelCount:t.row=l.startInTotal+e.columnHeaderLevelCount)}}else t.row>=n.row?t.row=o.end.row:t.row=o.start.row}return t}function Uet(n,t,e,i,r,o){var s;if(!("canMoveHeaderPosition"in r.table.internalProps.layoutMap))return;r.columnMove.moving=!0,r.columnMove.colSource=n,r.columnMove.rowSource=t,r.columnMove.x=e-r.table.tableX,r.columnMove.y=i-r.table.tableY;const a=r.table.getCellLocation(n,t),l=a==="columnHeader"?r.columnMove.x:a==="rowHeader"||r.table.internalProps.layoutMap.isSeriesNumberInBody(n,t)?r.columnMove.y:0,{backX:u,lineX:h,backY:d,lineY:c}=r.table.scenegraph.component.showMoveCol(n,t,l);r.table.fireListeners(ut.CHANGE_HEADER_POSITION_START,{col:n,row:t,x:e,y:i,backX:u,lineX:h,backY:d,lineY:c,event:o});const f=!!(!((s=r.select.ranges)===null||s===void 0)&&s.length);r.table.stateManager.updateSelectPos(-1,-1),r.table.stateManager.endSelectCells(!0,f),r.table.scenegraph.updateNextFrame()}function Vet(n,t,e,i,r,o){if(!("canMoveHeaderPosition"in r.table.internalProps.layoutMap))return;const s=Wet({col:r.columnMove.colSource,row:r.columnMove.rowSource},{col:n,row:t},r.table);if(r.table.internalProps.layoutMap.canMoveHeaderPosition({col:r.columnMove.colSource,row:r.columnMove.rowSource},{col:s.col,row:s.row})){let a,l,u,h;r.columnMove.x=e-r.table.tableX,r.columnMove.y=i-r.table.tableY,r.columnMove.colTarget=s.col,r.columnMove.rowTarget=s.row,r.updateCursor("grabbing");const d=r.table.getCellLocation(r.columnMove.colSource,r.columnMove.rowSource);d==="columnHeader"?(l=r.columnMove.x,a=r.table.isLeftFrozenColumn(n)?r.columnMove.colTarget>=r.columnMove.colSource?r.table.getColsWidth(0,r.columnMove.colTarget):r.table.getColsWidth(0,r.columnMove.colTarget-1):r.table.isRightFrozenColumn(n)?r.table.tableNoFrameWidth-r.table.getColsWidth(s.col+1,r.table.colCount-1):(r.columnMove.colTarget>=r.columnMove.colSource?r.table.getColsWidth(0,r.columnMove.colTarget):r.table.getColsWidth(0,r.columnMove.colTarget-1))-r.table.stateManager.scroll.horizontalBarPos):(d==="rowHeader"||r.table.internalProps.layoutMap.isSeriesNumberInBody(n,t))&&(h=r.columnMove.y,u=r.table.isFrozenRow(t)?r.columnMove.rowTarget>=r.columnMove.rowSource?r.table.getRowsHeight(0,r.columnMove.rowTarget):r.table.getRowsHeight(0,r.columnMove.rowTarget-1):r.table.isBottomFrozenRow(t)?r.table.tableNoFrameHeight-r.table.getRowsHeight(s.row+1,r.table.rowCount-1):(r.columnMove.rowTarget>=r.columnMove.rowSource?r.table.getRowsHeight(0,r.columnMove.rowTarget):r.table.getRowsHeight(0,r.columnMove.rowTarget-1))-r.table.stateManager.scroll.verticalBarPos),r.table.scenegraph.component.updateMoveCol(l,a,h,u),r.table.fireListeners(ut.CHANGING_HEADER_POSITION,{col:n,row:t,x:e,y:i,backX:l,lineX:a,backY:h,lineY:u,event:o}),r.table.scenegraph.updateNextFrame()}else r.updateCursor("not-allowed"),r.columnMove.colTarget=r.columnMove.colSource,r.columnMove.rowTarget=r.columnMove.rowSource}function jet(n){var t,e;let i=!1;if("canMoveHeaderPosition"in n.table.internalProps.layoutMap&&n.columnMove.moving&&n.columnMove.colSource>=0&&n.columnMove.rowSource>=0&&n.columnMove.colTarget>=0&&n.columnMove.rowTarget>=0&&((t=n.table.options.customConfig)===null||t===void 0?void 0:t.notUpdateInColumnRowMove)!==!0){const r=n.table.getCellRange(n.columnMove.colSource,n.columnMove.rowSource),o=n.table.getCellRange(n.columnMove.colTarget,n.columnMove.rowTarget),s=n.table._moveHeaderPosition({col:n.columnMove.colSource,row:n.columnMove.rowSource},{col:n.columnMove.colTarget,row:n.columnMove.rowTarget});if(!s||s.targetIndex===s.sourceIndex)return n.updateCursor(),n.columnMove.moving=!1,delete n.columnMove.colSource,delete n.columnMove.rowSource,delete n.columnMove.colTarget,delete n.columnMove.rowTarget,n.table.scenegraph.component.hideMoveCol(),n.table.scenegraph.updateNextFrame(),!1;{n.table.internalProps.useOneRowHeightFillAll=!1,n.table.internalProps.layoutMap.clearCellRangeMap();const a=n.table.getCellRange(n.columnMove.colSource,n.columnMove.rowSource),l=n.table.getCellRange(n.columnMove.colTarget,n.columnMove.rowTarget),u=Math.min(a.start.col,l.start.col,r.start.col,o.start.col),h=Math.max(a.end.col,l.end.col,r.end.col,o.end.col),d=Math.min(a.start.row,l.start.row,r.start.row,o.start.row);let c=Math.max(a.end.row,l.end.row,r.end.row,o.end.row);s.moveType==="row"&&n.table.internalProps.layoutMap.rowHierarchyType==="tree"&&(c=s.targetIndex>s.sourceIndex?c+s.targetSize-1:c+s.sourceSize-1),!n.table.transpose&&n.table.internalProps.layoutMap.isSeriesNumberInBody(n.columnMove.colSource,n.columnMove.rowSource)&&(n.table.changeRecordOrder(s.sourceIndex,s.targetIndex),n.changeCheckboxAndRadioOrder(s.sourceIndex,s.targetIndex)),s.moveType==="column"?rM(u,h,0,-1,n.table):rM(0,-1,d,c,n.table),n.table.clearCellStyleCache(),n.table.internalProps.layoutMap.isSeriesNumberInBody(n.columnMove.colSource,n.columnMove.rowSource)?n.table.scenegraph.updateHeaderPosition(n.table.scenegraph.proxy.colStart,n.table.scenegraph.proxy.colEnd,n.table.scenegraph.proxy.rowStart,n.table.scenegraph.proxy.rowEnd,s.moveType):s.moveType==="column"?n.table.scenegraph.updateHeaderPosition(u,h,0,-1,s.moveType):n.table.scenegraph.updateHeaderPosition(0,-1,d,c,s.moveType),n.table.internalProps.frozenColDragHeaderMode==="adjustFrozenCount"&&n.table.isListTable()&&(n.table.isLeftFrozenColumn(n.columnMove.colTarget)&&!n.table.isLeftFrozenColumn(n.columnMove.colSource)?n.table.frozenColCount+=a.end.col-a.start.col+1:n.table.isLeftFrozenColumn(n.columnMove.colSource)&&!n.table.isLeftFrozenColumn(n.columnMove.colTarget)&&(n.table.frozenColCount-=a.end.col-a.start.col+1),n.table.isRightFrozenColumn(n.columnMove.colTarget)&&!n.table.isRightFrozenColumn(n.columnMove.colSource)?n.table.rightFrozenColCount+=a.end.col-a.start.col+1:n.table.isRightFrozenColumn(n.columnMove.colSource)&&!n.table.isRightFrozenColumn(n.columnMove.colTarget)&&(n.table.rightFrozenColCount-=a.end.col-a.start.col+1)),i=!0}}return n.columnMove.moving=!1,setTimeout(()=>{delete n.columnMove.colSource,delete n.columnMove.rowSource,delete n.columnMove.colTarget,delete n.columnMove.rowTarget},0),n.table.scenegraph.component.hideMoveCol(),n.columnResize.col<n.table.frozenColCount&&!n.table.isPivotTable()&&!n.table.transpose?(n.table.scenegraph.component.setFrozenColumnShadow(n.table.frozenColCount-1,n.columnResize.isRightFrozen),n.table.scenegraph.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount)):n.columnResize.col>=n.table.colCount-n.table.rightFrozenColCount&&!n.table.isPivotTable()&&!n.table.transpose?n.table.scenegraph.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount):n.table.options.frozenColCount?n.table.scenegraph.component.setFrozenColumnShadow(n.table.frozenColCount-1):n.table.options.rightFrozenColCount&&n.table.scenegraph.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount),n.table.scenegraph.updateNextFrame(),((e=n.table.options.customConfig)===null||e===void 0?void 0:e.notUpdateInColumnRowMove)===!0||i}function rM(n,t,e,i,r){for(let o=n;o<=t;o++)r._clearColRangeWidthsMap(o);for(let o=e;o<=i;o++)r._clearRowRangeHeightsMap(o)}function Jh(n){var t;if(!n)return;const e=!((t=n.role)===null||t===void 0)&&t.startsWith("icon")?n:n.type==="richtext"?n._currentHoverIcon:void 0;return e?n.type==="richtext"?{icon:e,position:{left:n.globalAABBBounds.x1+e.globalAABBBounds.x1,right:n.globalAABBBounds.x1+e.globalAABBBounds.x2,top:n.globalAABBBounds.y1+e.globalAABBBounds.y1,bottom:n.globalAABBBounds.y1+e.globalAABBBounds.y2,width:e.globalAABBBounds.x2-e.globalAABBBounds.x1,height:e.globalAABBBounds.y2-e.globalAABBBounds.y1},type:"richtext-icon"}:{icon:e,position:{left:e.globalAABBBounds.x1,right:e.globalAABBBounds.x2,top:e.globalAABBBounds.y1,bottom:e.globalAABBBounds.y2,width:e.globalAABBBounds.x2-e.globalAABBBounds.x1,height:e.globalAABBBounds.y2-e.globalAABBBounds.y1},type:"icon"}:void 0}function Get(n,t,e){n=Math.ceil(n),t=Math.ceil(t);let i=e.columnResize.isRightFrozen?e.columnResize.x-n:n-e.columnResize.x;if(Math.abs(i)<1)return;const r=e.table.getColWidth(e.columnResize.col);let o=r;o+=i;const s=e.table.getMinColWidth(e.columnResize.col),a=e.table.getMaxColWidth(e.columnResize.col);if(o<s||o>a){if(r===s||r===a)return;i=r-s>a-r?a-r:s-r}let l=e.table.getColWidth(e.columnResize.col)+i;if(l<e.table.internalProps.limitMinWidth&&(l=e.table.internalProps.limitMinWidth,i=l-e.table.getColWidth(e.columnResize.col)),e.table.widthMode==="adaptive"&&e.columnResize.col<e.table.colCount-1){const u=e.table.getColWidth(e.columnResize.col+1),h=e.table.getMinColWidth(e.columnResize.col+1),d=e.table.getMaxColWidth(e.columnResize.col+1);let c=u;if(c-=i,c<h||c>d){if(u===h||u===d)return;i=u-h>d-u?d-u:h-u}c-i<e.table.internalProps.limitMinWidth&&(i=c-e.table.internalProps.limitMinWidth)}i=Math.ceil(i),e.columnResize.col<e.table.rowHeaderLevelCount||e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount?nM(i,e):e.table.internalProps.columnResizeType==="indicator"?qet(i,e):e.table.internalProps.columnResizeType==="indicatorGroup"?Xet(i,e):e.table.internalProps.columnResizeType==="all"?$et(i,e):nM(i,e),e.columnResize.x=n,e.table.scenegraph.component.updateResizeCol(e.columnResize.col,t,e.columnResize.isRightFrozen),e.columnResize.col<e.table.frozenColCount&&!e.table.isPivotTable()&&!e.table.transpose?e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen):e.table.options.frozenColCount&&e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1),(e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount&&!e.table.isPivotTable()&&!e.table.transpose||e.table.options.rightFrozenColCount)&&e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount),e.table.scenegraph.updateNextFrame()}function nM(n,t){t.table.widthMode==="adaptive"&&t.columnResize.col<t.table.colCount-1?(t.table.scenegraph.updateColWidth(t.columnResize.col,n),t.table.scenegraph.updateColWidth(t.columnResize.col+1,-n),t.table.internalProps._widthResizedColMap.add(t.columnResize.col),t.table.internalProps._widthResizedColMap.add(t.columnResize.col+1)):(t.table.scenegraph.updateColWidth(t.columnResize.col,n),t.table.internalProps._widthResizedColMap.add(t.columnResize.col))}function $et(n,t){const e=t.table.internalProps.layoutMap;for(let i=t.table.frozenColCount;i<t.table.colCount-t.table.rightFrozenColCount;i++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!e.indicatorsAsCol)){const r=e.getBody(i,t.table.columnHeaderLevelCount);if(r!=null&&r.disableColumnResize)continue}t.table.scenegraph.updateColWidth(i,n),t.table.internalProps._widthResizedColMap.add(i)}}function qet(n,t){const e=t.table.internalProps.layoutMap;let i,r,o;if(e.indicatorsAsCol)i=e.getIndicatorKey(t.columnResize.col,t.table.columnHeaderLevelCount);else{const s=e.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount-1),a=s.colHeaderPaths[s.colHeaderPaths.length-1];r=a.dimensionKey,o=a.value}for(let s=t.table.rowHeaderLevelCount;s<t.table.colCount-t.table.rightFrozenColCount;s++){const a=e.getIndicatorKey(s,t.table.columnHeaderLevelCount);if(e.indicatorsAsCol&&a===i)t.table.scenegraph.updateColWidth(s,n),t.table.internalProps._widthResizedColMap.add(s);else if(!e.indicatorsAsCol){const l=e.getCellHeaderPaths(s,t.table.columnHeaderLevelCount-1),u=l==null?void 0:l.colHeaderPaths[l.colHeaderPaths.length-1];u&&r===u.dimensionKey&&o===u.value&&(t.table.scenegraph.updateColWidth(s,n),t.table.internalProps._widthResizedColMap.add(s))}}}function Xet(n,t){const e=t.table.internalProps.layoutMap,i=e.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount),r=e.getHeadNodeByRowOrColDimensions(i.colHeaderPaths.slice(0,i.colHeaderPaths.length-1)),o=r.startInTotal+t.table.frozenColCount,s=r.startInTotal+t.table.frozenColCount+r.size-1,a=t.table.getColsWidth(o,s),l=n;for(let u=o;u<=s;u++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!e.indicatorsAsCol)){const d=e.getBody(u,t.table.columnHeaderLevelCount);if(d!=null&&d.disableColumnResize)continue}let h=t.table.getColWidth(u)/a*l;h>0&&h<.5?h=.5:h<0&&h>=-.5&&(h=-.5),t.table.scenegraph.updateColWidth(u,h),t.table.internalProps._widthResizedColMap.add(u)}}function Yet(n,t,e,i,r,o){const s=o.table.getRecordShowIndexByCell(n,t);if(s>=0){const a=o.table.dataSource.getIndexKey(s);i==="column"?wt(r)?(o.radioState[e]={},o.radioState[e][a]=r):o.radioState[e]=a:(o.radioState[e]||(o.radioState[e]={}),wt(r)?o.radioState[e][a]=r:o.radioState[e][a]=!0)}}function Ket(n,t,e){var i;const r=e.getBodyColumnDefine(n,t),o=r==null?void 0:r.field,s=e.getCellType(n,t);if(et(o)&&s==="radio"){const a=e.dataSource.getIndexKey(e.getRecordShowIndexByCell(n,t)),l=(i=e.stateManager.radioState)===null||i===void 0?void 0:i[o];if(wt(l)){if(l===a)return!0}else if(Li(l)){const u=l[a];if(wt(u))return u}}return!1}function Zet(n,t,e,i,r,o,s){var a,l,u,h,d;const c=s.table.getRecordShowIndexByCell(n,t);if(c>=0){const f=s.table.dataSource.getIndexKey(c);if(i==="column"){if(!et(s.radioState[e])&&o)return wt(r)?(s.radioState[e]={},s.radioState[e][f]=r):s.radioState[e]=f,!0;if(wt(s.radioState[e])&&!wt(r))return s.radioState[e]===f;if(wt(s.radioState[e])&&wt(r)||Li(s.radioState[e])&&!wt(r))return!1;if(Li(s.radioState[e])&&wt(r))return s.radioState[e][f]===r}else if(i==="cell"){if(!et(s.radioState[e])&&o)return s.radioState[e]={},wt(r)?s.radioState[e][f]=r:s.radioState[e][f]=!0,!0;if(!et((a=s.radioState[e])===null||a===void 0?void 0:a[f])&&o)return wt(r)?s.radioState[e][f]=r:s.radioState[e][f]=!0,!0;if(Eo((l=s.radioState[e])===null||l===void 0?void 0:l[f])&&!wt(r))return s.radioState[e][f];if(Eo((u=s.radioState[e])===null||u===void 0?void 0:u[f])&&wt(r)||wt((h=s.radioState[e])===null||h===void 0?void 0:h[f])&&!wt(r))return!1;if(wt((d=s.radioState[e])===null||d===void 0?void 0:d[f])&&wt(r))return s.radioState[e][f]===r}}return o}function Qet(n,t,e,i){const r=i.scenegraph.getCell(n,t);if(r)if(wt(e)){const o=r.getChildAt(e);o==null||o._handlePointerUp()}else{const o=r.getChildByName("radio");o==null||o._handlePointerUp()}}function Jet(n,t,e){const{radioState:i,table:r}=e;if(r.internalProps.transpose?(n=r.getRecordShowIndexByCell(n,0),t=r.getRecordShowIndexByCell(t,0)):(n=r.getRecordShowIndexByCell(0,n),t=r.getRecordShowIndexByCell(0,t)),n>t){const o=i[n];for(let s=n;s>t;s--)i[s]=i[s-1];i[t]=o}else if(n<t){const o=i[n];for(let s=n;s<t;s++)i[s]=i[s+1];i[t]=o}}function tit(n,t,e,i,r){const o=r.table.getCellRange(n,t);if(o.start.col!==o.end.col||o.start.row!==o.end.row)for(let s=o.start.col;s<=o.end.col;s++)for(let a=o.start.row;a<=o.end.row;a++)oM(s,a,e,i,r);else oM(n,t,e,i,r)}function oM(n,t,e,i,r){const o=r.table.getRecordShowIndexByCell(n,t);if(o>=0){const s=r.table.dataSource.getIndexKey(o).toString();r.checkedState.get(s)?r.checkedState.get(s)[e]=i:r.checkedState.set(s,{[e]:i})}}function eit(n,t,e){var i;e.headerCheckedState[n]=t,(i=e.checkedState)===null||i===void 0||i.forEach(r=>{r[n]=t})}function iit(n,t,e,i,r){var o,s;if(r.table.isHeader(n,t)){if(et(r.headerCheckedState[e]))return r.headerCheckedState[e];if(typeof i=="function")return;if(et(i))r.headerCheckedState[e]=i;else if(((o=r.checkedState)===null||o===void 0?void 0:o.size)>0)return r.updateHeaderCheckedState(e,n,t);return r.headerCheckedState[e]}const a=r.table.getRecordShowIndexByCell(n,t);if(a>=0){const l=r.table.dataSource.getIndexKey(a).toString();if(et((s=r.checkedState.get(l))===null||s===void 0?void 0:s[e]))return r.checkedState.get(l)[e];if(r.checkedState.get(l))r.checkedState.get(l)[e]=i;else if(l.includes(",")){const u=l.split(",").slice(0,-1).join(",");r.checkedState.has(u)&&r.checkedState.get(u)[e]===!0?r.checkedState.set(l,{[e]:!0}):r.checkedState.set(l,{[e]:i})}else r.checkedState.set(l,{[e]:i})}return i}function rit(n,t){t.checkedState.clear(),t.headerCheckedState={},t.radioState={};let e=!1;if(t._checkboxCellTypeFields=[],t._headerCheckFuncs={},t.table.internalProps.layoutMap.headerObjects.forEach((i,r)=>{if(i.headerType==="checkbox"){const o=i.define.checked;o==null||typeof o=="function"?(e=!0,typeof o=="function"&&(t._headerCheckFuncs[i.field]=o)):t.headerCheckedState[i.field]=o,i.define.cellType!=="checkbox"&&!pn(i.define.cellType)||i.fieldFormat||t._checkboxCellTypeFields.push(i.field)}}),t.table.leftRowSeriesNumberCount===1)t.headerCheckedState._vtable_rowSeries_number=!1,t._checkboxCellTypeFields.push("_vtable_rowSeries_number"),e=!0;else if(t.table.leftRowSeriesNumberCount>1){for(let i=0;i<t.table.leftRowSeriesNumberCount;i++)t.headerCheckedState[`_vtable_rowSeries_number_${i}`]=!1,t._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${i}`);e=!0}e&&uit(n,t)}function nit(n,t,e,i){let r=!0,o=!0,s=!1;return t.checkedState.forEach((a,l)=>{var u,h;l=l.includes(",")?l.split(",").map(g=>Number(g)):Number(l);const d=t.table.getTableIndexByRecordIndex(l),c=t.table.transpose?t.table.getCustomMerge(d,i):t.table.getCustomMerge(e,d),f=(u=t.table.dataSource)===null||u===void 0?void 0:u.get(l);c||!(!((h=t.table.internalProps.rowSeriesNumber)===null||h===void 0)&&h.enableTreeCheckbox)&&(f!=null&&f.vtableMerge)||((a==null?void 0:a[n])!==!0?r=!1:(o=!1,s=!0))}),r?(t.headerCheckedState[n]=!0,r):o?(t.headerCheckedState[n]=!1,!1):!!s&&(t.headerCheckedState[n]="indeterminate","indeterminate")}function oit(n,t){for(let e=t.checkedState.size;e<n.length;e++){const i=n[e];t._checkboxCellTypeFields.forEach(r=>{const o=i[r];let s;Li(o)?s=o.checked:typeof o=="boolean"&&(s=o);const a=e.toString();t.checkedState.get(a)||t.checkedState.set(a,{}),t.checkedState.get(a)[r]=s})}}function sit(n,t,e,i){const r=i.scenegraph.getCell(n,t),o=r==null?void 0:r.getChildByName("checkbox");if(!o){const l=i.getHeaderField(n,t);if(i.isHeader(n,t))i.stateManager.setHeaderCheckedState(l,e),i.getCellType(n,t)==="checkbox"&&i.scenegraph.updateCheckboxCellState(n,t,e);else if(i.stateManager.setCheckedState(n,t,l,e),i.getCellType(n,t)==="checkbox"){const u=i.stateManager.headerCheckedState[l],h=i.stateManager.updateHeaderCheckedState(l,n,t);u!==h&&i.scenegraph.updateHeaderCheckboxCellState(n,t,h)}return}const{checked:s,indeterminate:a}=o.attribute;a?(e||o._handlePointerUp(),o._handlePointerUp()):s?e||o._handlePointerUp():e&&o._handlePointerUp()}function Ff(n,t,e,i){var r,o;const s=i.scenegraph.getCell(n,t),a=(s==null?void 0:s.getChildByName("checkbox"))||((o=(r=s==null?void 0:s.getChildByName("checkbox-content"))===null||r===void 0?void 0:r._checkboxGroup)===null||o===void 0?void 0:o.getChildByName("checkbox"));a&&(e==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",e)))}function ait(n,t,e){const{checkedState:i,table:r}=e;let o,s;if(r.internalProps.transpose?(n=r.getRecordShowIndexByCell(n,0),t=r.getRecordShowIndexByCell(t,0)):(o=r.isPivotTable()?void 0:r.getRecordIndexByCell(0,n),s=r.isPivotTable()?void 0:r.getRecordIndexByCell(0,t)),wt(o)&&wt(s)){if((n=o)>(t=s)){const a=i.get(n.toString());for(let l=n;l>t;l--)i.set(l.toString(),i.get((l-1).toString()));i.set(t.toString(),a)}else if(n<t){const a=i.get(n.toString());for(let l=n;l<t;l++)i.set(l.toString(),i.get((l+1).toString()));i.set(t.toString(),a)}}else if(Wt(o)&&Wt(s)){if((n=o[o.length-1])>(t=s[s.length-1])){const a=i.get(o.toString());for(let l=n;l>t;l--){const u=[...o];u[u.length-1]=l;const h=[...o];h[h.length-1]=l-1,i.set(u.toString(),i.get(h.toString()))}i.set(s.toString(),a)}else if(n<t){const a=i.get(o.toString());for(let l=n;l<t;l++){const u=[...o];u[u.length-1]=l;const h=[...o];h[h.length-1]=l+1,i.set(u.toString(),i.get(h.toString()))}i.set(s.toString(),a)}}}function lit(n){const t=[],e=n.dataSource,i=e.dataConfig.groupByRules.length+1;return e.currentIndexedData.forEach((r,o)=>{if(Wt(r)&&r.length===i){const s=e.getOriginRecordIndexForGroup(r);t[s]=n.stateManager.checkedState.get(r.toString())}}),t}function uit(n,t){const e=t.table,i=e.isPivotTable()?0:e.internalProps.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,r=e.isPivotTable()?Wt(n)?n.length:0:e.internalProps.transpose?e.colCount:e.rowCount;for(let o=0;o+i<r;o++){const s=e.isPivotTable()?n[o]:e.dataSource.get(o);t._checkboxCellTypeFields.forEach(a=>{const l=s&&s[a];let u;if(Li(l)?u=l.checked:typeof l=="boolean"&&(u=l),u==null){const d=t._headerCheckFuncs[a];if(d){const c=t.table.getCellAddrByFieldRecord(a,o);u=Me(d,{col:c.col,row:c.row,table:t.table,context:null,value:l})}}const h=e.isPivotTable()?o.toString():t.table.dataSource.getIndexKey(o).toString();t.checkedState.get(h)||t.checkedState.set(h,{}),t.checkedState.get(h)[a]=u})}}function hit(n,t,e){n=Math.ceil(n),t=Math.ceil(t);let i=e.rowResize.isBottomFrozen?e.rowResize.y-t:t-e.rowResize.y;if(Math.abs(i)<1)return;e.table.getRowHeight(e.rowResize.row);let r=e.table.getRowHeight(e.rowResize.row)+i;if(r<e.table.internalProps.limitMinHeight&&(r=e.table.internalProps.limitMinHeight,i=r-e.table.getRowHeight(e.rowResize.row)),e.table.heightMode==="adaptive"&&e.rowResize.row<e.table.rowCount-1){let o=e.table.getRowHeight(e.rowResize.row+1);o-=i,o-i<e.table.internalProps.limitMinHeight&&(i=o-e.table.internalProps.limitMinHeight)}i=Math.ceil(i),e.rowResize.row<e.table.columnHeaderLevelCount||e.rowResize.row>=e.table.rowCount-e.table.bottomFrozenRowCount?sM(i,e):e.table.internalProps.rowResizeType==="indicator"?cit(i,e):e.table.internalProps.rowResizeType==="indicatorGroup"?fit(i,e):e.table.internalProps.rowResizeType==="all"?dit(i,e):sM(i,e),e.rowResize.y=t,e.table.scenegraph.component.updateResizeRow(e.rowResize.row,n,e.rowResize.isBottomFrozen),e.table.scenegraph.updateNextFrame()}function sM(n,t){t.table.heightMode==="adaptive"&&t.rowResize.row<t.table.rowCount-1?(t.table.scenegraph.updateRowHeight(t.rowResize.row,n),t.table.scenegraph.updateRowHeight(t.rowResize.row+1,-n),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row+1)):(t.table.scenegraph.updateRowHeight(t.rowResize.row,n),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row))}function dit(n,t){for(let e=t.table.frozenRowCount;e<t.table.rowCount-t.table.bottomFrozenRowCount;e++)t.table.scenegraph.updateRowHeight(e,n),t.table.internalProps._heightResizedRowMap.add(e)}function cit(n,t){var e,i;const r=t.table.internalProps.layoutMap;let o,s,a;if(r.indicatorsAsCol){const l=r.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,t.rowResize.row),u=(e=l.rowHeaderPaths)===null||e===void 0?void 0:e[l.rowHeaderPaths.length-1];s=u==null?void 0:u.dimensionKey,a=u==null?void 0:u.value}else o=r.getIndicatorKey(t.table.rowHeaderLevelCount,t.rowResize.row);for(let l=t.table.columnHeaderLevelCount;l<t.table.rowCount-t.table.bottomFrozenRowCount;l++){const u=r.getIndicatorKey(t.table.rowHeaderLevelCount,l);if(r.indicatorsAsCol||u!==o){if(r.indicatorsAsCol){const h=r.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,l),d=(i=h==null?void 0:h.rowHeaderPaths)===null||i===void 0?void 0:i[h.rowHeaderPaths.length-1];d&&s===d.dimensionKey&&a===d.value&&(t.table.scenegraph.updateRowHeight(l,n),t.table.internalProps._heightResizedRowMap.add(l))}}else t.table.scenegraph.updateRowHeight(l,n),t.table.internalProps._heightResizedRowMap.add(l)}}function fit(n,t){const e=t.table.internalProps.layoutMap,i=e.getCellHeaderPaths(t.table.rowHeaderLevelCount,t.rowResize.row),r=e.getHeadNodeByRowOrColDimensions(i.rowHeaderPaths.slice(0,i.rowHeaderPaths.length-1)),o=r.startInTotal+t.table.frozenRowCount,s=r.startInTotal+t.table.frozenRowCount+r.size-1,a=t.table.getRowsHeight(o,s),l=n;for(let u=o;u<=s;u++){let h=t.table.getRowHeight(u)/a*l;h>0&&h<.5?h=.5:h<0&&h>=-.5&&(h=-.51),t.table.scenegraph.updateRowHeight(u,h),t.table.internalProps._heightResizedRowMap.add(u)}}function git(n){const{customSelectedRangeComponents:t}=n.table.scenegraph;t.forEach((e,i)=>{e.rect.delete()}),t.clear(),n.select.customSelectRanges=[]}function pit(n,t){const{customSelectedRangeComponents:e}=t.table.scenegraph;n.forEach(i=>{var r,o,s,a;const{range:l,style:u}=i,h=Ge({fill:(r=u.cellBgColor)!==null&&r!==void 0&&r,stroke:(o=u.cellBorderColor)!==null&&o!==void 0&&o,lineWidth:(s=u.cellBorderLineWidth)!==null&&s!==void 0?s:0,lineDash:(a=u.cellBorderLineDash)!==null&&a!==void 0?a:[],pickable:!1});e.set(`${l.start.col}-${l.start.row}-${l.end.col}-${l.end.row}`,{rect:h,role:"body"})}),t.select.customSelectRanges=n,HI(t.table.scenegraph),t.table.scenegraph.updateNextFrame()}class mit{constructor(t){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=$D(e=>{this.updateInteractionState(e??Qt.default)},100),this.table=t,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=Qt.default,this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new qs,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=Qt.default,this.select={highlightScope:ye.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:ye.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new qs,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var t;const{highlightMode:e,disableHover:i,disableHeaderHover:r}=(t=this.table.options.hover)!==null&&t!==void 0?t:{highlightMode:"cell"};i?this.hover.highlightScope=ye.none:e==="cross"?this.hover.highlightScope=ye.cross:e==="row"?this.hover.highlightScope=ye.row:e==="column"?this.hover.highlightScope=ye.column:e==="cell"&&(this.hover.highlightScope=ye.single),this.hover.singleStyle=!i,this.hover.disableHeader=r,(this.hover.highlightScope===ye.none||r)&&(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var t,e,i,r,o;const{headerSelectMode:s,disableSelect:a,disableHeaderSelect:l,highlightMode:u,highlightInRange:h}=Object.assign({},{headerSelectMode:"inline",disableSelect:!1,disableHeaderSelect:!1,highlightMode:"cell",highlightInRange:!1},this.table.options.select),d=!((t=this.table.options.select)===null||t===void 0)&&t.cornerHeaderSelectMode?(e=this.table.options.select)===null||e===void 0?void 0:e.cornerHeaderSelectMode:((i=this.table.options.select)===null||i===void 0?void 0:i.headerSelectMode)==="body"?(r=this.table.options.select)===null||r===void 0?void 0:r.headerSelectMode:"all";this.select.highlightScope=a===!0?ye.none:u==="cross"?ye.cross:u==="row"?ye.row:u==="column"?ye.column:ye.single,this.select.singleStyle=!a,this.select.disableHeader=l,this.select.headerSelectMode=s,this.select.cornerHeaderSelectMode=d,this.select.highlightInRange=h,this.select.disableCtrlMultiSelect=((o=this.table.options.keyboardOptions)===null||o===void 0?void 0:o.ctrlMultiSelect)===!1}isSelected(t,e){let i=!1;return this.select.ranges.forEach(r=>{Ln(r,t,e)&&(i=!0)}),i}setSortState(t){const e=this,i=(t=!t||Array.isArray(t)?t:[t])&&t.reduce((r,o)=>{var s,a,l;const u=(s=function(h){const d=[];return function c(f,g=0){f.forEach(m=>{var p;const v=m.startInTotal?(p=m.startInTotal+e.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&p!==void 0?p:0:g;m.columns?c(m.columns,v):d.push(Object.assign(Object.assign({},m),{startIndex:v}))})}(h),d}(this.table.internalProps.columns))===null||s===void 0?void 0:s.find(h=>(h==null?void 0:h.field)===(o==null?void 0:o.field));return this.table.internalProps.transpose?r.push({field:o.field,order:o.order,row:(a=(u==null?void 0:u.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&a!==void 0?a:0,col:u==null?void 0:u.level}):r.push({field:o.field,order:o.order,col:(l=(u==null?void 0:u.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&l!==void 0?l:0,row:u==null?void 0:u.level}),r},[]);this.sort=i||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(t){if(this.interactionState===t)return;t===Qt.scrolling&&(this.interactionStateBeforeScroll=this.interactionState);const e=this.interactionState;this.interactionState=t,e===Qt.scrolling&&Qt.default}updateHoverhighlightScope(t){this.hover.highlightScope!==t&&(this.hover.highlightScope=t)}updateHoverPos(t,e){Pet(this,t,e)}updateSelectPos(t,e,i=!1,r=!1,o=!1,s=!0,a=!1){e!==-1&&e!==-1&&(this.select.selecting=!0),t<0&&(t=-1),e<0&&(e=-1),t>this.table.colCount-1&&(t=this.table.colCount-1),e>this.table.rowCount-1&&(e=this.table.rowCount-1),Fet(this,t,e,i,r,o,s,a)}checkCellRangeInSelect(t,e){return Eet(t,e,this.select.ranges,this.select.highlightScope)}updateHoverIcon(t,e,i,r){var o,s,a,l,u,h,d,c,f;if(!((o=this.residentHoverIcon)===null||o===void 0)&&o.icon&&i===((s=this.residentHoverIcon)===null||s===void 0?void 0:s.icon))return;const g=Jh(i);if(g)if(g.type==="richtext-icon"){const m=g.icon;if(this.hoverIcon.icon&&this.hoverIcon.icon!==((l=this.residentHoverIcon)===null||l===void 0?void 0:l.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),m.attribute.tooltip){const p={content:m.attribute.tooltip.title,referencePosition:{rect:g.position,placement:m.attribute.tooltip.placement},style:Object.assign({},(u=this.table.internalProps.theme)===null||u===void 0?void 0:u.tooltipStyle,(h=m.tooltip)===null||h===void 0?void 0:h.style,(c=(d=m.attribute)===null||d===void 0?void 0:d.tooltip)===null||c===void 0?void 0:c.style),disappearDelay:m.attribute.tooltip.disappearDelay};this.table.internalProps.tooltipHandler.isBinded(p)||this.table.showTooltip(t,e,p)}}else{const m=g.icon;m!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==((f=this.residentHoverIcon)===null||f===void 0?void 0:f.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=t,this.hoverIcon.row=e,this.hoverIcon.icon=m,this.table.scenegraph.setIconHoverStyle(m,t,e,r),this.table.scenegraph.updateNextFrame())}else this.hoverIcon.icon&&this.hoverIcon.icon!==((a=this.residentHoverIcon)===null||a===void 0?void 0:a.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame())}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(t=!0,e=!0){if(this.select.selecting){if(this.select.selecting=!1,this.select.ranges.length===0)return;const i=this.select.ranges[this.select.ranges.length-1];this.table.isSeriesNumber(this.select.cellPos.col,this.select.cellPos.row)||this.table.isHeader(this.select.cellPos.col,this.select.cellPos.row)||IJ(i,this.table);let r=!1;for(let a=0;a<this.select.ranges.length-1;a++){const l=this.select.ranges[a];if(l&&l.start.col===i.start.col&&l.start.row===i.start.row&&l.end.col===i.end.col&&l.end.row===i.end.row){r=!0;break}}r?(this.select.ranges.pop(),zI(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):Oet(this.table.scenegraph);const o=this.select.ranges[this.select.ranges.length-1].end.col,s=this.select.ranges[this.select.ranges.length-1].end.row;t&&this.table.fireListeners(ut.SELECTED_CELL,{ranges:this.select.ranges,col:o,row:s})}else e&&this.select.ranges.length===0&&this.table.fireListeners(ut.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(t,e,i,r){this.columnResize.resizing=!0,this.columnResize.col=t,this.columnResize.x=e,this.columnResize.isRightFrozen=r,this.table.scenegraph.component.showResizeCol(t,i,r),this.table.scenegraph.updateNextFrame()}updateResizeCol(t,e){Get(t,e,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(t,e,i,r){this.rowResize.resizing=!0,this.rowResize.row=t,this.rowResize.y=i,this.rowResize.isBottomFrozen=r,this.table.scenegraph.component.showResizeRow(t,e,r),this.table.scenegraph.updateNextFrame()}updateResizeRow(t,e){hit(t,e,this)}startFillSelect(t,e){this.fillHandle.isFilling=!0,this.fillHandle.startX=t,this.fillHandle.startY=e;const i=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(i.start.col,i.end.col),this.fillHandle.beforeFillMinRow=Math.min(i.start.row,i.end.row),this.fillHandle.beforeFillMaxCol=Math.max(i.start.col,i.end.col),this.fillHandle.beforeFillMaxRow=Math.max(i.start.row,i.end.row),this.table.fireListeners(ut.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;const t=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),e=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),i=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),r=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===t&&this.fillHandle.beforeFillMinRow===e&&this.fillHandle.beforeFillMaxCol===i&&this.fillHandle.beforeFillMaxRow===r||this.table.eventManager.isDraging&&this.table.fireListeners(ut.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(t,e,i,r,o){Uet(t,e,i,r,this,o)}updateMoveCol(t,e,i,r,o){Vet(t,e,i,r,this,o)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return jet(this)}checkFrozen(){var t;let e=this.table.options.frozenColCount?this.table.options.frozenColCount:this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?((t=this.table.rowHeaderLevelCount)!==null&&t!==void 0?t:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0;if(e){e=Math.min(e,this.table.colCount);const i=this.table.getContainer();if(i&&i.clientWidth===0)return this._frozenObserver?void 0:(this._frozenObserver=new ResizeObserver(r=>{for(const o of r)if(o.contentRect.width>0)return this.clearFrozenObserver(),this.table.resize(),void setTimeout(()=>{this.checkFrozen()},0)}),void this._frozenObserver.observe(i));if(this.table.getColsWidth(0,e-1)>this.table._getMaxFrozenWidth())if(this.table.internalProps.unfreezeAllOnExceedsMaxWidth)this.table._setFrozenColCount(0),this.setFrozenCol(-1);else{const r=this.table._getComputedFrozenColCount(e);this.table._setFrozenColCount(r),this.setFrozenCol(r)}else this.table.frozenColCount!==e&&(this.table._setFrozenColCount(e),this.setFrozenCol(e))}else this.clearFrozenObserver()}clearFrozenObserver(){this._frozenObserver&&(this._frozenObserver.disconnect(),this._frozenObserver=null)}setFrozenCol(t){t!==this.frozen.col?(this.frozen.col=t,this.table.scenegraph.updateFrozen(),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)):this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(t){t!==this.frozen.row&&(this.frozen.row=t,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var t,e;const i=this.table.getAllRowsHeight(),r=this.scroll.verticalBarPos,o=this.table.tableNoFrameHeight;r+o>=i&&this.table.fireListeners(ut.SCROLL_VERTICAL_END,{scrollTop:r,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(t=this.table.theme.scrollStyle)===null||t===void 0?void 0:t.width,scrollWidth:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,viewHeight:o,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var t,e;const i=this.table.getAllColsWidth(),r=this.scroll.horizontalBarPos,o=this.table.tableNoFrameWidth;r+o>=i&&this.table.fireListeners(ut.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:r,scrollHeight:(t=this.table.theme.scrollStyle)===null||t===void 0?void 0:t.width,scrollWidth:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:o})}updateVerticalScrollBar(t){var e,i,r,o;const s=this.table.getAllRowsHeight(),a=this.scroll.verticalBarPos;let l=Math.ceil(t*(s-this.table.scenegraph.height));et(l)&&!isNaN(l)||(l=0);const u=l-this.table.scenegraph.proxy.deltaY-a;if(this.table.fireListeners(ut.CAN_SCROLL,{event:void 0,scrollTop:l-this.table.scenegraph.proxy.deltaY,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,scrollWidth:(i=this.table.theme.scrollStyle)===null||i===void 0?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:u}).some(h=>h===!1)){const h=this.scroll.verticalBarPos/(s-this.table.scenegraph.height);this.table.scenegraph.component.updateVerticalScrollBarPos(h)}else this.scroll.verticalBarPos=l,this.table.scenegraph.setY(-this.scroll.verticalBarPos,t===1),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(ut.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(r=this.table.theme.scrollStyle)===null||r===void 0?void 0:r.width,scrollWidth:(o=this.table.theme.scrollStyle)===null||o===void 0?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:u}),a!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd()}updateHorizontalScrollBar(t){var e,i,r,o;const s=this.table.getAllColsWidth(),a=this.scroll.horizontalBarPos;let l=Math.ceil(t*(s-this.table.scenegraph.width));et(l)&&!isNaN(l)||(l=0);const u=l-this.table.scenegraph.proxy.deltaX-a;if(this.table.fireListeners(ut.CAN_SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:l-this.table.scenegraph.proxy.deltaX,scrollHeight:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,scrollWidth:(i=this.table.theme.scrollStyle)===null||i===void 0?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:u}).some(h=>h===!1)){const h=this.scroll.horizontalBarPos/(s-this.table.scenegraph.width);this.table.scenegraph.component.updateHorizontalScrollBarPos(h)}else this.scroll.horizontalBarPos=l,this.table.scenegraph.setX(-this.scroll.horizontalBarPos,t===1),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(ut.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(r=this.table.theme.scrollStyle)===null||r===void 0?void 0:r.width,scrollWidth:(o=this.table.theme.scrollStyle)===null||o===void 0?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:u}),a!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd()}setScrollTop(t,e,i=!0){var r,o,s,a,l,u,h;const d=this.table.getAllRowsHeight(),c=!((r=this.table.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound?1:0;t=Math.max(0,Math.min(t,d-this.table.scenegraph.height-c)),t=Math.ceil(t);const f=this.scroll.verticalBarPos,g=t/(d-this.table.scenegraph.height);if((f!==t||((s=(o=this.table.options)===null||o===void 0?void 0:o.customConfig)===null||s===void 0?void 0:s.scrollEventAlwaysTrigger)===!0)&&i){let p=t;et(p)&&!isNaN(p)||(p=0);const v=p-f;if(this.table.fireListeners(ut.CAN_SCROLL,{event:e==null?void 0:e.nativeEvent,scrollTop:p,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(a=this.table.theme.scrollStyle)===null||a===void 0?void 0:a.width,scrollWidth:(l=this.table.theme.scrollStyle)===null||l===void 0?void 0:l.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:g,dy:v}).some(b=>b===!1)){const b=this.scroll.verticalBarPos/(d-this.table.scenegraph.height);return void this.table.scenegraph.component.updateVerticalScrollBarPos(b)}}(t!==this.scroll.verticalBarPos||this.table.isPivotChart())&&this.updateHoverPos(-1,-1),this.scroll.verticalBarPos=t,et(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-t),this.table.scenegraph.component.updateVerticalScrollBarPos(g);const m=this.scroll.verticalBarPos-f;this.table.fireListeners(ut.SCROLL,{event:e==null?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(u=this.table.theme.scrollStyle)===null||u===void 0?void 0:u.width,scrollWidth:(h=this.table.theme.scrollStyle)===null||h===void 0?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:g,dy:m}),f!==t&&i&&this.checkVerticalScrollBarEnd()}setScrollLeft(t,e,i=!0){var r,o,s,a,l,u,h;this.table.scrollLeft;const d=this.table.getAllColsWidth(),c=(this.table.getFrozenColsWidth(),!((r=this.table.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound?1:0);t=Math.max(0,Math.min(t,d-this.table.scenegraph.width-c)),t=Math.ceil(t);const f=this.scroll.horizontalBarPos,g=t/(d-this.table.scenegraph.width);if((f!==t||((s=(o=this.table.options)===null||o===void 0?void 0:o.customConfig)===null||s===void 0?void 0:s.scrollEventAlwaysTrigger)===!0)&&i){let p=t;et(p)&&!isNaN(p)||(p=0);const v=p-f;if(this.table.fireListeners(ut.CAN_SCROLL,{event:e==null?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:p,scrollHeight:(a=this.table.theme.scrollStyle)===null||a===void 0?void 0:a.width,scrollWidth:(l=this.table.theme.scrollStyle)===null||l===void 0?void 0:l.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:g,dx:v}).some(b=>b===!1)){const b=this.scroll.horizontalBarPos/(d-this.table.scenegraph.width);return void this.table.scenegraph.component.updateHorizontalScrollBarPos(b)}}t!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1),this.scroll.horizontalBarPos=t,et(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-t),this.table.scenegraph.component.updateHorizontalScrollBarPos(g);const m=this.scroll.horizontalBarPos-f;this.table.fireListeners(ut.SCROLL,{event:e==null?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(u=this.table.theme.scrollStyle)===null||u===void 0?void 0:u.width,scrollWidth:(h=this.table.theme.scrollStyle)===null||h===void 0?void 0:h.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:g,dx:m}),f!==t&&i&&this.checkHorizontalScrollBarEnd()}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(t){this.table.scenegraph.component.showVerticalScrollBar(),t&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var e;(e=this.table.scenegraph)===null||e===void 0||e.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(t){var e;this.table.scenegraph.component.showHorizontalScrollBar(),(e=this.table.scenegraph)===null||e===void 0||e.component.showFrozenColumnShadow(),t&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var i,r;(i=this.table.scenegraph)===null||i===void 0||i.component.hideFrozenColumnShadow(),(r=this.table.scenegraph)===null||r===void 0||r.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(t,e,i,r){this.menu.isShow&&this.menu.x===i&&this.menu.y===r?this.hideMenu():this.showContextMenu(t,e,i,r)}showContextMenu(t,e,i,r){var o;!((o=this.table.internalProps.menu)===null||o===void 0)&&o.contextMenuItems&&(this.table.internalProps.menu.renderMode==="html"?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=i,this.menu.y=r,this.table.scenegraph.component.menu.attach(i,r,t,e,rn.contextmenu)),this.table.fireListeners(ut.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"contextmenu"}))}triggerDropDownMenu(t,e,i,r,o){this.table.fireListeners(ut.DROPDOWN_ICON_CLICK,{col:t,row:e,event:o}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(t,e,i,r)}showDropDownMenu(t,e,i,r){this.table.internalProps.menu.renderMode==="html"?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(i,r,t,e,rn.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(ut.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"dropDown"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);const o=this.table.scenegraph.getCell(t,e);let s;o.forEachChildren(a=>a.attribute.funcType===Pe.dropDown&&(s=a,!0)),s&&(this.residentHoverIcon={col:t,row:e,icon:s},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,o),this.table.scenegraph.residentHoverIcon(t,e))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(ut.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(ut.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null))}setDropDownMenuHighlight(t){this.menu.dropDownMenuHighlight=t;for(let e=0;e<t.length;e++){const{col:i,row:r}=t[e],o=this.table.getCellRange(i,r);if(o)for(let s=o.start.col;s<=o.end.col;s++)for(let a=o.start.row;a<=o.end.row;a++)this.table.scenegraph.updateCellContent(s,a)}}dropDownMenuIsHighlight(t,e,i){const r=this.menu.dropDownMenuHighlight;if(Array.isArray(r))for(let o=0;o<r.length;o++){const s=r[o];let{col:a,row:l}=s;const{field:u,menuKey:h}=s;if(typeof a!="number"||typeof l!="number")if(this.table.isPivotTable()){const d=this.table.internalProps.layoutMap.getPivotCellAdress(u);if(!d)continue;a=d.col,l=d.row}else{const d=this.table.internalProps.layoutMap.getHeaderCellAddressByField(u);if(!d)continue;a=d.col,l=d.row}if(et(a)&&et(l)&&this.table.isCellRangeEqual(t,e,a,l)){let d=this.table._getHeaderLayoutMap(a??t,l??e).dropDownMenu||this.table.globalDropDownMenu;if(typeof d=="function"&&(d=d({row:l,col:a,table:this.table})),d)for(let c=0;c<d.length;c++){const f=d[c];if(Li(f)&&(f.menuKey||f.text)===(h||"")&&c===i||ei(f)&&f===h&&c===i)return!0}}}return!1}triggerSort(t,e,i,r){if(this.table.isPivotTable()){const c=this.table.getPivotSortState(t,e),f=c?c.toUpperCase():"NORMAL",g=f==="ASC"?"DESC":f==="DESC"?"NORMAL":"ASC";return this.table.sort(t,e,g),void this.table.fireListeners(Ph.PIVOT_SORT_CLICK,{col:t,row:e,order:f||"normal",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(t,e),cellLocation:this.table.getCellLocation(t,e),event:r})}const o=[...this.sort],s=this.table.internalProps.multipleSort||!o.length?null:this.sort[this.sort.length-1];Det(t,e,this.table,r);const a=this.table.getCellRange(t,e),l=this.sort.find(c=>c.col===a.start.col&&c.row===a.start.row),u=this.table.internalProps.multipleSort||!s?null:s.col,h=this.table.internalProps.multipleSort||!s?null:s.row,d=o.findIndex(c=>c.col===t&&c.row===e);d>=0&&o.splice(d,1),this.table.scenegraph.updateSortIcon({col:t,row:e,iconMark:i,order:l==null?void 0:l.order,oldSortCol:u,oldSortRow:h,oldIconMark:s==null?void 0:s.icon}),l&&(l.icon=i),this.table.internalProps.multipleSort||o.forEach(c=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:"normal",oldSortCol:c.col,oldSortRow:c.row,oldIconMark:null})}),this.table.fireListeners(Ph.AFTER_SORT,{order:l==null?void 0:l.order,field:this.table.getHeaderField(t,e),event:r})}updateSortState(t){var e,i,r,o,s,a,l,u;t=Array.isArray(t)?t:[t];for(let d=0;d<t.length;d++){if(t[d].field===((e=this.sort[d])===null||e===void 0?void 0:e.field)&&t[t.length-1].order===((i=this.sort[d])===null||i===void 0?void 0:i.order))return;const c=this.table.internalProps.multipleSort?null:((r=this.sort[d])===null||r===void 0?void 0:r.col)||null,f=this.table.internalProps.multipleSort?null:((o=this.sort[d])===null||o===void 0?void 0:o.row)||null;((s=this.sort[d])===null||s===void 0?void 0:s.order)==="asc"||(a=this.sort[d])===null||a===void 0||a.order,this.setSortState(t.slice(0,d+1));const g=this.table.internalProps.layoutMap.getHeaderCellAddressByField(t[d].field);this.sort[d].col=g.col,this.sort[d].row=g.row;const m=this.table.scenegraph.getCell(this.sort[d].col,this.sort[d].row);let p;qw(m,"children",v=>v.attribute.funcType==="sort"&&(p=v,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[d].col,row:this.sort[d].row,iconMark:p,order:this.sort[d].order,oldSortCol:c,oldSortRow:f,oldIconMark:(l=this.sort[d])===null||l===void 0?void 0:l.icon})}const h=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(d=>{t.some(c=>c.field===d.field)||h.push(d)});for(let d=0;d<h.length;d++){const c=h[d];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:(u=c.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&u!==void 0?u:0,oldSortRow:c.level,oldIconMark:null})}}triggerFreeze(t,e,i){if(!this.table.isPivotTable()&&!this.table.transpose){if(Let(t,e,this.table),this.table.hasListeners(Ph.FREEZE_CLICK)){const r=this.table.internalProps.layoutMap.columnObjects.slice(0,t+1);this.table.fireListeners(Ph.FREEZE_CLICK,{col:t,row:e,fields:r.reduce((o,s)=>o.concat(s.field),[]),colCount:this.table.frozenColCount})}this.frozen.icon=i}}updateCursor(t="default"){this.table.getElement().style.cursor=t}updateDrillState(t,e,i,r,o,s){this.drill.dimensionKey=t,this.drill.title=e,this.drill.drillDown=i,this.drill.drillUp=r,this.drill.col=o,this.drill.row=s,Het(o,s,i,r,this.table)}updateSparklineHoverPose(t,e,i,r){this.sparkLine.col!==-1&&this.sparkLine.row!==-1&&zet(this.sparkLine.col,this.sparkLine.row,this.table);let o=!1;t!==-1&&e!==-1&&(o=Net(t,e,i,r,this.table)),o?(this.sparkLine.col=t,this.sparkLine.row=e):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(t,e,i,r){return tit(t,e,i,r,this)}setHeaderCheckedState(t,e){return eit(t,e,this)}syncCheckedState(t,e,i,r){return iit(t,e,i,r,this)}initCheckedState(t){return rit(t,this)}updateHeaderCheckedState(t,e,i){return nit(t,this,e,i)}initLeftRecordsCheckState(t){return oit(t,this)}setRadioState(t,e,i,r,o){Yet(t,e,i,r,o,this)}syncRadioState(t,e,i,r,o,s){return Zet(t,e,i,r,o,s,this)}changeCheckboxAndRadioOrder(t,e){this.checkedState.size&&ait(t,e,this),this.radioState.length&&Jet(t,e,this)}setCustomSelectRanges(t){git(this),pit(t,this)}}function vit(n){be.mode==="browser"&&n.on(ut.CLICK_CELL,t=>{const{col:e,row:i}=t;if(t.target.type==="image"&&t.target.role&&t.target.role.startsWith("icon"))return;let r;r=n.internalProps.layoutMap.isHeader(e,i)?n.isPivotTable()?n._getHeaderLayoutMap(e,i).headerType:n.getHeaderDefine(e,i).headerType:n.getBodyColumnType(e,i);const o=n.isHeader(e,i)?n.getHeaderDefine(e,i):n.getBodyColumnDefine(e,i),s=n.getCellValue(e,i),a=n.getCellOriginValue(e,i);if(r==="link"){let l=Me(o.linkJump,{col:e,row:i,table:n,value:s,dataValue:a,cellHeaderPaths:void 0});if(l=l!==!1,!l)return;const u=o.templateLink;let h,d=Me(o.linkDetect,{col:e,row:i,table:n,value:s,dataValue:a,cellHeaderPaths:void 0});if(d=d!==!1,u){const g=n.getCellOriginRecord(e,i);if(g&&g.vtableMerge)return;const m=Object.assign({__value:s,__dataValue:a},g);if(pn(u))h=u(m,e,i,n);else{const p=/\{\s*(\S+?)\s*\}/g;h=u.replace(p,(v,b)=>m[b])}}else if(d){if(!Xw.test(s))return;h=s}else h=s;if(!h)return;const c=o.linkTarget,f=o.linkWindowFeatures;window.open(h,c,f)}else if(r==="image"){const{clickToPreview:l}=o;if(l===!1)return;const u=document.createElement("div");u.style.width="100%",u.style.height="100%",u.style.position="absolute",u.style.top="0",u.style.left="0",u.style.backgroundColor="rgba(30, 30, 30, 0.4)",u.style.display="flex",u.style.justifyContent="center",u.style.alignItems="center",u.style.overflow="hidden",u.style.zIndex="9999",u.addEventListener("click",d=>{d.target===u&&document.body.removeChild(u)});const h=new Image;h.src=s,h.style.maxWidth="80%",h.style.maxHeight="80%",u.appendChild(h),document.body.appendChild(u)}else if(r==="video"){const{clickToPreview:l}=o;if(l===!1)return;const u=document.createElement("div");u.style.width="100%",u.style.height="100%",u.style.position="absolute",u.style.top="0",u.style.left="0",u.style.backgroundColor="rgba(30, 30, 30, 0.4)",u.style.display="flex",u.style.justifyContent="center",u.style.alignItems="center",u.style.overflow="hidden",u.style.zIndex="9999",u.addEventListener("click",d=>{d.target===u&&document.body.removeChild(u)});const h=document.createElement("video");h.src=s,h.style.maxWidth="80%",h.style.maxHeight="80%",h.setAttribute("preload","auto"),h.setAttribute("controls","true"),u.appendChild(h),document.body.appendChild(u)}})}function bit(n){n.on(ut.MOUSEENTER_CELL,t=>{const{col:e,row:i}=t;if(e===-1||i===-1)return;const r=n.internalProps.layoutMap.getHeaderDimension(e,i);r!=null&&r.drillDown||r!=null&&r.drillUp?n.stateManager.updateDrillState(r.dimensionKey,r.title,r.drillDown,r.drillUp,e,i):n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),n.on(ut.MOUSELEAVE_TABLE,t=>{n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})}function _it(n){n.fireListeners(Ph.DRILLMENU_CLICK,n.stateManager.drill)}function Cit(n){const t=n.internalProps.layoutMap.rowsDefine,e=n.internalProps.layoutMap.columnsDefine;for(let i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&(r.drillDown||r.drillUp))return!0}for(let i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&(r.drillDown||r.drillUp))return!0}return!1}function aM(n){if(n.eventManager.bindSparklineHoverEvent)return;let t=!1;n.isPivotTable()?t=n.internalProps.layoutMap.indicatorsDefine.some(e=>typeof e!="string"&&e.cellType==="sparkline"):t=n.internalProps.layoutMap.columnObjects.some(e=>e.cellType==="sparkline"||typeof e.cellType=="function"),t&&(n.eventManager.bindSparklineHoverEvent=!0,n.on(ut.MOUSEMOVE_CELL,e=>{const{col:i,row:r,x:o,y:s}=e;n.getBodyColumnType(i,r)!=="sparkline"&&n.stateManager.updateSparklineHoverPose(-1,-1,0,0),n.stateManager.updateSparklineHoverPose(i,r,o,s)}),n.on(ut.MOUSELEAVE_TABLE,e=>{n.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}function qp(n,t,e=!0){var i,r,o;let{deltaX:s,deltaY:a}=n;n.shiftKey&&n.deltaY&&(s=a,a=0);const[l,u]=yit(s,a,{horizontal:1,vertical:1});(l||u)&&t.interactionState!==Qt.scrolling&&t.updateInteractionState(Qt.scrolling);const h=((r=(i=t.table.options.theme)===null||i===void 0?void 0:i.scrollStyle)===null||r===void 0?void 0:r.visible)==="scrolling";l&&(t.setScrollLeft(t.scroll.horizontalBarPos+l,n),t.showHorizontalScrollBar(h)),u&&(t.setScrollTop(t.scroll.verticalBarPos+u,n),t.showVerticalScrollBar(h)),e&&t.resetInteractionState(t.interactionStateBeforeScroll),!((o=n.nativeEvent)===null||o===void 0)&&o.cancelable&&(t.table.internalProps.overscrollBehavior==="none"||Math.abs(a)>=Math.abs(s)&&a!==0&&XI(a,t)||Math.abs(a)<=Math.abs(s)&&s!==0&&YI(s,t))&&n.nativeEvent.preventDefault()}function yit(n,t,e){var i,r;const o=Math.abs(n/t),s=o<=.5?0:n,a=o>2?0:t;return[Math.ceil(s*((i=e.horizontal)!==null&&i!==void 0?i:0)),Math.ceil(a*((r=e.vertical)!==null&&r!==void 0?r:0))]}function XI(n,t){return t.table.getAllRowsHeight()-t.table.scenegraph.height!=0&&!wit(n,t)&&!Sit(n,t)}function YI(n,t){return t.table.getAllColsWidth()-t.table.scenegraph.width!=0&&!xit(n,t)&&!Tit(n,t)}function wit(n,t){return t.table.getAllRowsHeight()-t.table.scenegraph.height!==0&&n<=0&&t.scroll.verticalBarPos<1}function Sit(n,t){var e;const i=!((e=t.table.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound?1:0,r=t.table.getAllRowsHeight()-t.table.scenegraph.height;return r!==0&&n>=0&&Math.abs(t.scroll.verticalBarPos-r)<1+i}function xit(n,t){return t.table.getAllColsWidth()-t.table.scenegraph.width!==0&&n<=0&&t.scroll.horizontalBarPos<1}function Tit(n,t){var e;const i=!((e=t.table.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound?1:0,r=t.table.getAllColsWidth()-t.table.scenegraph.width;return r!==0&&n>=0&&Math.abs(t.scroll.horizontalBarPos-r)<1+i}class Ait{constructor(t){this.stateManager=t}setScrollHandle(t){this.scrollHandle=t}startInertia(t,e,i){this.lastTime=Date.now(),this.speedX=t,this.speedY=e,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var t;const e=Date.now(),i=e-this.lastTime;let r=!0;const o=Math.pow(this.friction,i/16),s=o*this.speedX,a=o*this.speedY;let l=0,u=0;Math.abs(s)>.05&&(r=!1,l=(this.speedX+s)/2*i),Math.abs(a)>.05&&(r=!1,u=(this.speedY+a)/2*i),(t=this.scrollHandle)===null||t===void 0||t.call(this,l,u),r?this.runingId=null:(this.lastTime=e,this.speedX=s,this.speedY=a,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function ly(n,t,e){var i,r,o,s;t&&((i=n.stateManager.columnMove)===null||i===void 0?void 0:i.colSource)!==-1&&((r=n.stateManager.columnMove)===null||r===void 0?void 0:r.rowSource)!==-1&&((o=n.stateManager.columnMove)===null||o===void 0?void 0:o.colTarget)!==-1&&((s=n.stateManager.columnMove)===null||s===void 0?void 0:s.rowTarget)!==-1?n.hasListeners(ut.CHANGE_HEADER_POSITION)&&n.fireListeners(ut.CHANGE_HEADER_POSITION,{target:{col:n.stateManager.columnMove.colTarget,row:n.stateManager.columnMove.rowTarget},source:{col:n.stateManager.columnMove.colSource,row:n.stateManager.columnMove.rowSource},event:e}):t||n.hasListeners(ut.CHANGE_HEADER_POSITION_FAIL)&&n.fireListeners(ut.CHANGE_HEADER_POSITION_FAIL,{target:{col:n.stateManager.columnMove.colTarget,row:n.stateManager.columnMove.rowTarget},source:{col:n.stateManager.columnMove.colSource,row:n.stateManager.columnMove.rowSource},event:e})}function Rit(n){const t=n.table,e=t.stateManager;t.scenegraph.tableGroup.addEventListener("pointermove",i=>{var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_;const A=(o=(r=t.eventManager.LastPointerXY)===null||r===void 0?void 0:r.x)!==null&&o!==void 0?o:i.x,T=(a=(s=t.eventManager.LastPointerXY)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:i.y;t.eventManager.LastPointerXY={x:i.x,y:i.y},n.touchSetTimeout&&(clearTimeout(n.touchSetTimeout),n.touchSetTimeout=void 0);const S=Ii(i);if(S.eventArgs&&t.hasListeners(ut.MOUSEMOVE_TABLE)&&t.fireListeners(ut.MOUSEMOVE_TABLE,{col:S.eventArgs.col,row:S.eventArgs.row,x:S.abstractPos.x,y:S.abstractPos.y,event:i.nativeEvent,target:(l=S==null?void 0:S.eventArgs)===null||l===void 0?void 0:l.target,mergeCellInfo:(u=S.eventArgs)===null||u===void 0?void 0:u.mergeInfo}),e.interactionState===Qt.grabing&&!(!((h=t.editorManager)===null||h===void 0)&&h.editingEditor))return void(Math.abs(A-i.x)+Math.abs(T-i.y)>=1&&(e.isResizeCol()||e.isResizeRow()||(e.isMoveCol()?n.dealColumnMover(S):e.isFillHandle()?n.dealFillSelect(S,!0):((d=t.options.select)===null||d===void 0?void 0:d.disableDragSelect)||n.dealTableSelect(S,!0))));!(!((c=t.options.select)===null||c===void 0)&&c.disableDragSelect)&&t.eventManager.isDraging&&e.isSelecting()&&!(!((f=t.editorManager)===null||f===void 0)&&f.editingEditor)&&n.dealTableSelect(S,!0);const x=i.path.find(E=>E.role==="cell");if(t.hasListeners(ut.MOUSELEAVE_CELL)&&(t.stateManager.hover.cellPos.col===-1||t.stateManager.hover.cellPos.row===-1||(x==null?void 0:x.col)===t.stateManager.hover.cellPos.col&&(x==null?void 0:x.row)===t.stateManager.hover.cellPos.row||t.fireListeners(ut.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:(g=S==null?void 0:S.eventArgs)===null||g===void 0?void 0:g.target})),t.hasListeners(ut.MOUSEENTER_CELL)&&((x==null?void 0:x.role)!=="cell"||!et(x.col)||!et(x.row)||x.col===t.stateManager.hover.cellPos.col&&x.row===t.stateManager.hover.cellPos.row||x.col===((m=t.stateManager.hover.cellPosContainHeader)===null||m===void 0?void 0:m.col)&&x.row===((p=t.stateManager.hover.cellPosContainHeader)===null||p===void 0?void 0:p.row)||t.fireListeners(ut.MOUSEENTER_CELL,{col:x.col,row:x.row,cellRange:t.getCellRangeRelativeRect({col:x.col,row:x.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:(v=S==null?void 0:S.eventArgs)===null||v===void 0?void 0:v.target,mergeCellInfo:(b=S.eventArgs)===null||b===void 0?void 0:b.mergeInfo})),n.dealIconHover(S),n.dealTableHover(S),t.theme.columnResize.visibleOnHover&&n.checkColumnResize(S,!0),S.eventArgs&&t.hasListeners(ut.MOUSEMOVE_CELL)){let E,M;if(!((C=S.eventArgs)===null||C===void 0)&&C.target){const L=Jh((y=S.eventArgs)===null||y===void 0?void 0:y.target);L&&(E=L.icon,M=L.position)}t.fireListeners(ut.MOUSEMOVE_CELL,{col:S.eventArgs.col,row:S.eventArgs.row,x:S.abstractPos.x,y:S.abstractPos.y,event:i.nativeEvent,targetIcon:E?{name:E.name,position:M,funcType:E.attribute.funcType}:void 0,target:(w=S==null?void 0:S.eventArgs)===null||w===void 0?void 0:w.target,mergeCellInfo:(_=S.eventArgs)===null||_===void 0?void 0:_.mergeInfo})}}),t.scenegraph.tableGroup.addEventListener("pointerout",i=>{var r;const o=Ii(i),s=(r=o==null?void 0:o.eventArgs)===null||r===void 0?void 0:r.target;(s==null?void 0:s.role)==="table"&&n.dealTableHover()}),t.scenegraph.tableGroup.addEventListener("pointerover",i=>{var r,o;const s=Ii(i),a=(r=s==null?void 0:s.eventArgs)===null||r===void 0?void 0:r.target;if(a&&t.hasListeners(ut.MOUSEOVER_CHART_SYMBOL)&&a.type==="symbol"){const l=i.composedPath().find(u=>u.roll==="cell");if(l){const{col:u,row:h}=l,d={col:u,row:h,field:t.getHeaderField(u,h),value:t.getCellValue(u,h),dataValue:t.getCellOriginValue(u,h),cellHeaderPaths:t.internalProps.layoutMap.getCellHeaderPaths(u,h),title:t.getBodyColumnDefine(u,h).title,cellRange:t.getCellRelativeRect(u,h),event:i.nativeEvent,sparkline:{pointData:void 0},scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:(o=s==null?void 0:s.eventArgs)===null||o===void 0?void 0:o.target};t.fireListeners(ut.MOUSEOVER_CHART_SYMBOL,d)}}}),t.scenegraph.tableGroup.addEventListener("pointerenter",i=>{(t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.horizontalVisible==="focus"||!t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.visible==="focus")&&e.showHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.verticalVisible==="focus"||!t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.visible==="focus")&&e.showVerticalScrollBar(),t.hasListeners(ut.MOUSEENTER_TABLE)&&t.fireListeners(ut.MOUSEENTER_TABLE,{event:i.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerleave",i=>{e.isResizeCol()||e.isResizeRow()||e.isMoveCol()||e.isSelecting()||(e.updateInteractionState(Qt.default),e.updateCursor()),(t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.horizontalVisible==="focus"||!t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.visible==="focus")&&e.hideHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.verticalVisible==="focus"||!t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.visible==="focus")&&e.hideVerticalScrollBar(),t.hasListeners(ut.MOUSELEAVE_CELL)&&t.stateManager.hover.cellPos.col!==-1&&t.stateManager.hover.cellPos.row!==-1&&t.fireListeners(ut.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:void 0}),n.dealTableHover();const r=i.target;r&&!r.isDescendantsOf(t.scenegraph.tableGroup)&&t.fireListeners(ut.MOUSELEAVE_TABLE,{event:i.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerdown",i=>{var r,o,s,a,l;if(t.hasListeners(ut.MOUSEDOWN_TABLE)&&t.fireListeners(ut.MOUSEDOWN_TABLE,{event:i.nativeEvent}),EK(),t.eventManager.isDown=!0,t.eventManager.LastBodyPointerXY={x:i.x,y:i.y},t.eventManager.LastPointerXY={x:i.x,y:i.y},i.button!==0)return;const u=Ii(i);if(n.downIcon=void 0,e.interactionState!==Qt.default||(t.isPivotChart()&&((r=u==null?void 0:u.eventArgs)===null||r===void 0?void 0:r.target.type)!=="chart"&&t.scenegraph.updateChartState(null),((o=u.eventArgs)===null||o===void 0?void 0:o.target)!==((s=e.residentHoverIcon)===null||s===void 0?void 0:s.icon)&&e.hideMenu(),((a=u==null?void 0:u.eventArgs)===null||a===void 0?void 0:a.target.type)==="chart"))return;const h=(l=t.editorManager)===null||l===void 0?void 0:l.completeEdit(i.nativeEvent);mp(h,d=>{var c,f,g,m,p,v,b,C,y,w,_;if(d===!1)return;const A=!((g=(f=(c=u==null?void 0:u.eventArgs)===null||c===void 0?void 0:c.target)===null||f===void 0?void 0:f.role)===null||g===void 0)&&g.startsWith("icon")?u.eventArgs.target:!((m=i.target.role)===null||m===void 0)&&m.startsWith("icon")?i.target:void 0;if(n.downIcon=A,A&&A.attribute.interactive!==!1)A.attribute.funcType===Pe.dragReorder&&(e.startMoveCol(u.eventArgs.col,u.eventArgs.row,u.abstractPos.x,u.abstractPos.y,(w=(y=u.eventArgs)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.nativeEvent),e.updateInteractionState(Qt.grabing));else{if(n.cellIsHeaderCheck(u))return;if(i.pointerType==="touch"){if(n.touchEnd=!1,n.touchSetTimeout=setTimeout(()=>{n.isTouchdown=!1,n.isLongTouch=!0,(n.touchEnd||!n.checkColumnResize(u,!0)&&!n.checkRowResize(u,!0))&&(n.touchEnd||!n.checkColumnMover(u))?n.dealTableSelect(u)&&!n.touchEnd&&e.updateInteractionState(Qt.grabing):e.updateInteractionState(Qt.grabing)},500),t.hasListeners(ut.MOUSEENTER_CELL)){const T=i.path.find(S=>S.role==="cell");(T==null?void 0:T.role)!=="cell"||!et(T.col)||!et(T.row)||T.col===t.stateManager.hover.cellPos.col&&T.row===t.stateManager.hover.cellPos.row||T.col===((p=t.stateManager.hover.cellPosContainHeader)===null||p===void 0?void 0:p.col)&&T.row===((v=t.stateManager.hover.cellPosContainHeader)===null||v===void 0?void 0:v.row)||t.fireListeners(ut.MOUSEENTER_CELL,{col:T.col,row:T.row,cellRange:t.getCellRangeRelativeRect({col:T.col,row:T.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:(b=u==null?void 0:u.eventArgs)===null||b===void 0?void 0:b.target,mergeCellInfo:(C=u.eventArgs)===null||C===void 0?void 0:C.mergeInfo})}n.dealTableHover(u)}else{if(!n.checkCellFillhandle(u)&&(n.checkColumnResize(u,!0)||n.checkRowResize(u,!0)))return t.scenegraph.updateChartState(null),void e.updateInteractionState(Qt.grabing);if(n.checkColumnMover(u)||n.checkCellFillhandle(u,!0)&&n.dealFillSelect(u))return void e.updateInteractionState(Qt.grabing);n.dealTableSelect(u)&&e.updateInteractionState(Qt.grabing)}}if(t.hasListeners(ut.MOUSEDOWN_CELL)){const T=Ii(i);T.eventArgs&&t.fireListeners(ut.MOUSEDOWN_CELL,{col:T.eventArgs.col,row:T.eventArgs.row,event:i.nativeEvent,target:(_=T==null?void 0:T.eventArgs)===null||_===void 0?void 0:_.target,mergeCellInfo:T.eventArgs.mergeInfo})}})}),t.scenegraph.tableGroup.addEventListener("pointerup",i=>{var r,o,s,a,l,u,h,d;if(i.button===0){if(e.interactionState==="grabing"){if(e.updateInteractionState(Qt.default),e.isResizeCol())Xp(t);else if(e.isResizeRow())Yp(t);else if(e.isMoveCol()){const c=t.stateManager.endMoveCol();ly(t,c,i.nativeEvent)}else if(e.isSelecting()){t.stateManager.endSelectCells(),t.stateManager.isFillHandle()&&t.stateManager.endFillSelect();const c=Ii(i);if(t.eventManager.isDraging&&c.eventArgs&&t.hasListeners(ut.DRAG_SELECT_END)){const f={event:i.nativeEvent,cells:[],col:c.eventArgs.target.col,row:c.eventArgs.target.row,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:(r=c==null?void 0:c.eventArgs)===null||r===void 0?void 0:r.target,mergeCellInfo:(o=c.eventArgs)===null||o===void 0?void 0:o.mergeInfo};f.cells=t.getSelectedCellInfos(),t.fireListeners(ut.DRAG_SELECT_END,f)}}}else e.interactionState===Qt.scrolling&&e.updateInteractionState(Qt.default);if(!t.eventManager.isDraging){const c=Ii(i);if(!n.isTouchMove&&i.button===0&&c.eventArgs&&t.hasListeners(ut.CLICK_CELL)){const{col:f,row:g}=c.eventArgs,m=t.getCellInfo(f,g);let p,v;if(!((s=c.eventArgs)===null||s===void 0)&&s.target){const C=Jh((a=c.eventArgs)===null||a===void 0?void 0:a.target);C&&(p=C.icon,v=C.position)}const b=Object.assign(Object.assign({},m),{event:i.nativeEvent,federatedEvent:i,cells:[],targetIcon:p?{name:p.name,position:v,funcType:p.attribute.funcType}:void 0,target:(l=c==null?void 0:c.eventArgs)===null||l===void 0?void 0:l.target,mergeCellInfo:(u=c.eventArgs)===null||u===void 0?void 0:u.mergeInfo});t.fireListeners(ut.CLICK_CELL,b)}}if(t.hasListeners(ut.MOUSEUP_CELL)){const c=Ii(i);c.eventArgs&&t.fireListeners(ut.MOUSEUP_CELL,{col:c.eventArgs.col,row:c.eventArgs.row,event:i.nativeEvent,target:(h=c==null?void 0:c.eventArgs)===null||h===void 0?void 0:h.target,mergeCellInfo:(d=c.eventArgs)===null||d===void 0?void 0:d.mergeInfo})}setTimeout(()=>{n.isDown=!1,n.isTouchdown=!1,n.isTouchMove=!1,n.isDraging=!1,n.touchMovePoints=[]},0)}}),t.scenegraph.tableGroup.addEventListener("rightdown",i=>{var r,o,s,a,l,u;const h=Ii(i);if(h.eventArgs){e.triggerContextMenu(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y);const{col:d,row:c}=h.eventArgs;if(t.hasListeners(ut.CONTEXTMENU_CELL)){const f=t.getCellInfo(d,c);let g,m;if(!((r=h.eventArgs)===null||r===void 0)&&r.target){const v=Jh((o=h.eventArgs)===null||o===void 0?void 0:o.target);v&&(g=v.icon,m=v.position)}const p=Object.assign(Object.assign({},f),{event:i.nativeEvent,cells:[],targetIcon:g?{name:g.name,position:m,funcType:g.attribute.funcType}:void 0,target:(s=h==null?void 0:h.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(a=h.eventArgs)===null||a===void 0?void 0:a.mergeInfo});((u=(l=t.options.eventOptions)===null||l===void 0?void 0:l.contextmenuReturnAllSelectedCells)===null||u===void 0||u)&&(XK(t.stateManager.select.ranges,d,c)?p.cells=t.getSelectedCellInfos():p.cells=[[f]]),t.fireListeners(ut.CONTEXTMENU_CELL,p)}}}),t.scenegraph.tableGroup.addEventListener("pointertap",i=>{var r;if(t.stateManager.columnResize.resizing)return;const o=Ii(i);if(!t.stateManager.columnResize.resizing&&!t.stateManager.columnMove.moving&&(n.dealIconClick(i,o),(o==null?void 0:o.eventArgs)&&n.touchSetTimeout&&i.pointerType==="touch")){const s=Ii(i);if(n.touchSetTimeout){clearTimeout(n.touchSetTimeout);const a=!!(!((r=e.select.ranges)===null||r===void 0)&&r.length);n.dealTableSelect(s),e.endSelectCells(!0,a),n.touchSetTimeout=void 0}}}),t.scenegraph.stage.addEventListener("pointerdown",i=>{var r,o,s,a;const l=Ii(i);!((r=l.eventArgs)===null||r===void 0)&&r.target&&((o=l.eventArgs)===null||o===void 0?void 0:o.target)===((s=e.residentHoverIcon)===null||s===void 0?void 0:s.icon)||e.hideMenu();const u=(a=t.editorManager)===null||a===void 0?void 0:a.completeEdit(i.nativeEvent);mp(u,h=>{var d;if(h===!1)return;const c=!((d=i.target.role)===null||d===void 0)&&d.startsWith("icon")?i.target:void 0;if(n.downIcon=c,!(i.pointerType==="touch"||c||n.checkCellFillhandle(l)||e.columnResize.resizing||!n.checkColumnResize(l,!0))){t.scenegraph.updateChartState(null),e.updateInteractionState(Qt.grabing);const{eventArgs:f}=l;f!=null&&f.targetCell||t.getCellAt(l.abstractPos.x-t.theme.columnResize.resizeHotSpotSize/2,l.abstractPos.y)&&t.hasListeners(ut.MOUSEDOWN_TABLE)&&t.fireListeners(ut.MOUSEDOWN_TABLE,{event:i.nativeEvent})}})}),t.scenegraph.stage.addEventListener("pointerup",i=>{e.interactionState==="grabing"&&(e.updateInteractionState(Qt.default),e.isResizeCol()?Xp(t):e.isResizeRow()&&Yp(t))}),t.scenegraph.stage.addEventListener("pointertap",i=>{var r,o,s;const a=i.target;if(t.eventManager.isDraging||!a||!a.isDescendantsOf(t.scenegraph.stage)&&a.stage!==a||a.isDescendantsOf(t.scenegraph.tableGroup))t.eventManager.isDraging&&e.isSelecting()&&e.endSelectCells();else{e.updateInteractionState(Qt.default),n.dealTableHover();const l=!!(!((r=e.select.ranges)===null||r===void 0)&&r.length);((s=(o=t.options.select)===null||o===void 0?void 0:o.blankAreaClickDeselect)===null||s===void 0||s)&&n.dealTableSelect(),e.endSelectCells(!0,l),e.updateCursor(),t.scenegraph.updateChartState(null)}}),t.scenegraph.stage.addEventListener("pointermove",i=>{const r=Ii(i);e.isResizeCol()||n.checkColumnResize(r)?t.stateManager.select&&n.checkCellFillhandle(r)?e.updateCursor("crosshair"):e.updateCursor("col-resize"):e.isResizeRow()||n.checkRowResize(r)?t.stateManager.select&&n.checkCellFillhandle(r)?e.updateCursor("crosshair"):e.updateCursor("row-resize"):e.isMoveCol()||e.updateCursor()}),t.scenegraph.tableGroup.addEventListener("checkbox_state_change",i=>{var r,o;const s=Ii(i),{col:a,row:l}=s.eventArgs,u=t.getCellInfo(a,l),h=vi(t,a,l);if(h)for(let c=h.start.col;c<=h.end.col;c++)for(let f=h.start.row;f<=h.end.row;f++)t.scenegraph.getCell(c,f).forEachChildren(g=>{g.name==="checkbox"&&g.setAttributes({checked:i.target.attribute.checked,indeterminate:i.target.attribute.indeterminate})});const d=Object.assign(Object.assign({},u),{event:i.nativeEvent,target:(r=s==null?void 0:s.eventArgs)===null||r===void 0?void 0:r.target,mergeCellInfo:(o=s==null?void 0:s.eventArgs)===null||o===void 0?void 0:o.mergeInfo,checked:i.detail.checked});if(t.isHeader(a,l))t.stateManager.setHeaderCheckedState(u.field,i.detail.checked),t.getCellType(a,l)==="checkbox"&&t.scenegraph.updateCheckboxCellState(a,l,i.detail.checked);else if(t.stateManager.setCheckedState(a,l,u.field,i.detail.checked),t.getCellType(a,l)==="checkbox"){const c=t.stateManager.headerCheckedState[u.field],f=t.stateManager.updateHeaderCheckedState(u.field,a,l);c!==f&&t.scenegraph.updateHeaderCheckboxCellState(a,l,f)}t.fireListeners(ut.CHECKBOX_STATE_CHANGE,d),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("radio_checked",i=>{var r,o,s;const a=Ii(i),{col:l,row:u,target:h}=a.eventArgs,d=t.getCellInfo(l,u),c=(r=oJ.exec(h.id))===null||r===void 0?void 0:r[1],f=vi(t,l,u);if(f)for(let v=f.start.col;v<=f.end.col;v++)for(let b=f.start.row;b<=f.end.row;b++)t.scenegraph.getCell(v,b).forEachChildren(C=>{C.name==="radio"&&C.id===h.id&&C.setAttributes({checked:!0})});const g=t.getBodyColumnDefine(l,u).radioCheckType||"column";if(g==="cell")if(f)for(let v=f.start.col;v<=f.end.col;v++)for(let b=f.start.row;b<=f.end.row;b++)t.scenegraph.getCell(v,b).forEachChildren(C=>{C.name==="radio"&&C.id!==h.id&&C.setAttributes({checked:!1})});else t.scenegraph.getCell(l,u).forEachChildren(v=>{v.name==="radio"&&v.id!==h.id&&v.setAttributes({checked:!1})});else g==="column"&&t.scenegraph.getColGroup(l).forEachChildren(v=>{v.forEachChildren(b=>{b.name==="radio"&&b.id!==h.id&&b.setAttributes({checked:!1})})});const m=c?Number(c):void 0;t.stateManager.setRadioState(l,u,d.field,g,m);const p=Object.assign(Object.assign({},d),{event:i.nativeEvent,target:(o=a==null?void 0:a.eventArgs)===null||o===void 0?void 0:o.target,mergeCellInfo:(s=a==null?void 0:a.eventArgs)===null||s===void 0?void 0:s.mergeInfo,radioIndexInCell:m});t.fireListeners(ut.RADIO_STATE_CHANGE,p),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("switch_state_change",i=>{var r,o;const s=Ii(i),{col:a,row:l,target:u}=s.eventArgs,h=t.getCellInfo(a,l),d=vi(t,a,l);if(d)for(let f=d.start.col;f<=d.end.col;f++)for(let g=d.start.row;g<=d.end.row;g++)t.scenegraph.getCell(f,g).forEachChildren(m=>{m.name==="switch"&&m.setAttributes({checked:i.target.attribute.checked})});const c=Object.assign(Object.assign({},h),{event:i.nativeEvent,target:(r=s==null?void 0:s.eventArgs)===null||r===void 0?void 0:r.target,mergeCellInfo:(o=s==null?void 0:s.eventArgs)===null||o===void 0?void 0:o.mergeInfo,checked:i.detail.checked});t.stateManager.setCheckedState(a,l,h.field,i.detail.checked),t.fireListeners(ut.SWITCH_STATE_CHANGE,c),t.scenegraph.updateNextFrame()}),t.scenegraph.stage.addEventListener("wheel",i=>{var r;i.path.find(o=>o.name==="legend")||((r=t.editorManager)===null||r===void 0||r.completeEdit(),t.eventManager._enableTableScroll&&qp(i,e))})}function Eit(n){const t=n.table;n.gesture=new Ij(t.scenegraph.tableGroup,{tap:{interval:300}}),n.gesture.on("doubletap",e=>{Mit(e,t)})}function Xp(n){n.stateManager.endResizeCol();const t=[];for(let e=0;e<n.colCount;e++)t.push(n.getColWidth(e));n.fireListeners(ut.RESIZE_COLUMN_END,{col:n.stateManager.columnResize.col,colWidths:t})}function Yp(n){n.stateManager.endResizeRow(),n.fireListeners(ut.RESIZE_ROW_END,{row:n.stateManager.rowResize.row,rowHeight:n.getRowHeight(n.stateManager.rowResize.row)})}function Mit(n,t){var e,i,r,o,s,a;const l=Ii(n);let u=-1,h=-1;l.eventArgs&&(u=l.eventArgs.col,h=l.eventArgs.row);const d=t.getCellValue(u,h),c=(i=(e=l.eventArgs)===null||e===void 0?void 0:e.targetCell)===null||i===void 0?void 0:i.globalAABBBounds;if(c&&t.internalProps.focusControl.setFocusRect(new yo(c.x1+t.scrollLeft,c.y1+t.scrollTop,c.x2-c.x1,c.y2-c.y1),d),t.hasListeners(ut.DBLCLICK_CELL)){const f=t.getCellInfo(u,h);let g,m;if(!((r=l.eventArgs)===null||r===void 0)&&r.target){const v=Jh((o=l.eventArgs)===null||o===void 0?void 0:o.target);v&&(g=v.icon,m=v.position)}const p=Object.assign(Object.assign({},f),{event:n.nativeEvent,federatedEvent:n,cells:[],targetIcon:g?{name:g.name,position:m,funcType:g.attribute.funcType}:void 0,target:(s=l==null?void 0:l.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(a=l==null?void 0:l.eventArgs)===null||a===void 0?void 0:a.mergeInfo});t.fireListeners(ut.DBLCLICK_CELL,p)}}function Bit(n){const t=n.table,e=t.stateManager,i=t.scenegraph;i.component.vScrollBar.addEventListener("pointerover",s=>{e.showVerticalScrollBar()}),i.component.hScrollBar.addEventListener("pointerover",s=>{e.showHorizontalScrollBar()}),i.component.vScrollBar.addEventListener("pointerout",s=>{e.interactionState!==Qt.scrolling&&e.hideVerticalScrollBar()}),i.component.hScrollBar.addEventListener("pointerout",s=>{e.interactionState!==Qt.scrolling&&e.hideHorizontalScrollBar()}),i.component.vScrollBar.addEventListener("pointermove",s=>{i.table.stateManager.updateCursor("default"),s.stopPropagation()}),i.component.vScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation(),i.table.hasListeners(ut.MOUSEDOWN_TABLE)&&i.table.fireListeners(ut.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.vScrollBar.addEventListener("scrollDown",s=>{var a;i.table.eventManager.LastBodyPointerXY={x:s.x,y:s.y},i.table.eventManager.isDown=!0,e.interactionState!==Qt.scrolling&&e.updateInteractionState(Qt.scrolling),i.table.stateManager.hideMenu(),(a=i.table.editorManager)===null||a===void 0||a.completeEdit(),i.table.hasListeners(ut.MOUSEDOWN_TABLE)&&i.table.fireListeners(ut.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.vScrollBar.addEventListener("pointerup",()=>{e.fastScrolling=!1,i.table.eventManager.isDraging=!1,e.interactionState===Qt.scrolling&&e.updateInteractionState(Qt.default)}),i.component.vScrollBar.addEventListener("pointerupoutside",()=>{e.fastScrolling=!1,e.interactionState===Qt.scrolling&&e.updateInteractionState(Qt.default)}),i.component.vScrollBar.addEventListener("scrollUp",s=>{i.table.eventManager.isDraging=!1}),i.component.hScrollBar.addEventListener("pointermove",s=>{i.table.stateManager.updateCursor("default"),s.stopPropagation()}),i.component.hScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation(),i.table.hasListeners(ut.MOUSEDOWN_TABLE)&&i.table.fireListeners(ut.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.hScrollBar.addEventListener("scrollDown",s=>{var a;i.table.eventManager.LastBodyPointerXY={x:s.x,y:s.y},i.table.eventManager.isDown=!0,e.interactionState!==Qt.scrolling&&e.updateInteractionState(Qt.scrolling),i.table.stateManager.hideMenu(),(a=i.table.editorManager)===null||a===void 0||a.completeEdit(),i.table.hasListeners(ut.MOUSEDOWN_TABLE)&&i.table.fireListeners(ut.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.hScrollBar.addEventListener("pointerup",()=>{e.fastScrolling=!1,i.table.eventManager.isDraging=!1,e.interactionState===Qt.scrolling&&e.updateInteractionState(Qt.default)}),i.component.hScrollBar.addEventListener("pointerupoutside",()=>{e.fastScrolling=!1,e.interactionState===Qt.scrolling&&e.updateInteractionState(Qt.default)}),i.component.hScrollBar.addEventListener("scrollUp",s=>{i.table.eventManager.isDraging=!1});const r=eR(e.updateVerticalScrollBar,20),o=eR(e.updateHorizontalScrollBar,20);i.component.vScrollBar.addEventListener("scrollDrag",s=>{i.table.eventManager.isDown&&(i.table.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==Qt.scrolling&&e.updateInteractionState(Qt.scrolling);const a=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);r(a,s)}),i.component.hScrollBar.addEventListener("scrollDrag",s=>{i.table.eventManager.isDown&&(i.table.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==Qt.scrolling&&e.updateInteractionState(Qt.scrolling);const a=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);o(a)})}let xa=1;function KI(){return WD?xa=1:(xa=Math.ceil(window.devicePixelRatio||1),xa>1&&xa%2!=0&&(xa+=1)),xa}KI();var _h=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function Pit(n){const t=n.table,e=t.stateManager,i=t.internalProps.handler;function r(g){var m;if(t.hasListeners(ut.KEYDOWN)){const p={keyCode:(m=g.keyCode)!==null&&m!==void 0?m:g.which,code:g.code,event:g,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth};t.fireListeners(ut.KEYDOWN,p)}}i.on(t.getElement(),"blur",g=>{n.dealTableHover()}),i.on(t.getElement(),"keydown",g=>{var m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J,st;const ht={keyCode:(m=g.keyCode)!==null&&m!==void 0?m:g.which,code:g.code,event:g};if(t.fireListeners(ut.BEFORE_KEYDOWN,ht),g.key==="a"&&(g.ctrlKey||g.metaKey))!((p=t.keyboardOptions)===null||p===void 0)&&p.selectAllOnCtrlA&&(g.preventDefault(),n.deelTableSelectAll());else if(e.select.cellPos.col>=0&&e.select.cellPos.row>=0&&(g.key==="ArrowUp"||g.key==="ArrowDown"||g.key==="ArrowLeft"||g.key==="ArrowRight")){if(((b=(v=t.options.keyboardOptions)===null||v===void 0?void 0:v.moveEditCellOnArrowKeys)===null||b===void 0||!b)&&(!((C=t.editorManager)===null||C===void 0)&&C.editingEditor)||((y=t.options.keyboardOptions)===null||y===void 0?void 0:y.moveSelectedCellOnArrowKeys)===!1)return;let at,lt;if(g.preventDefault(),g.stopPropagation(),g.key==="ArrowUp"?g.ctrlKey||g.metaKey?(at=e.select.cellPos.col,lt=0):(g.shiftKey,at=e.select.cellPos.col,lt=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row-1))):g.key==="ArrowDown"?g.ctrlKey||g.metaKey?(at=e.select.cellPos.col,lt=t.rowCount-1):(g.shiftKey,at=e.select.cellPos.col,lt=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1))):g.key==="ArrowLeft"?g.ctrlKey||g.metaKey?(at=0,lt=e.select.cellPos.row):(g.shiftKey,lt=e.select.cellPos.row,at=Math.min(t.colCount-1,Math.max(0,e.select.cellPos.col-1))):g.key==="ArrowRight"&&(g.ctrlKey||g.metaKey?(at=t.colCount-1,lt=e.select.cellPos.row):(g.shiftKey,lt=e.select.cellPos.row,at=Math.min(t.colCount-1,Math.max(0,e.select.cellPos.col+1)))),Hs(t,at,lt))return;t.selectCell(at,lt,g.shiftKey),(_=(w=t.options.keyboardOptions)===null||w===void 0?void 0:w.moveEditCellOnArrowKeys)!==null&&_!==void 0&&_&&(!((A=t.editorManager)===null||A===void 0)&&A.editingEditor)&&((T=t.editorManager)===null||T===void 0||T.completeEdit(),t.getElement().focus(),t.getEditor(at,lt)&&((S=t.editorManager)===null||S===void 0||S.startEditCell(at,lt)))}else if(g.key==="Escape")(x=t.editorManager)===null||x===void 0||x.cancelEdit(),t.getElement().focus();else if(g.key==="Enter"){if(!((E=t.editorManager)===null||E===void 0)&&E.editingEditor){if(r(g),(M=t.editorManager)===null||M===void 0||M.completeEdit(),t.getElement().focus(),((L=t.options.keyboardOptions)===null||L===void 0?void 0:L.moveFocusCellOnEnter)===!0){const at=e.select.cellPos.col,lt=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1));if(Hs(t,at,lt))return;t.selectCell(at,lt,g.shiftKey)}return}if(((I=t.options.keyboardOptions)===null||I===void 0?void 0:I.moveFocusCellOnEnter)===!0){const at=e.select.cellPos.col,lt=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1));if(Hs(t,at,lt))return;t.selectCell(at,lt,g.shiftKey)}else if(((H=(D=t.options.keyboardOptions)===null||D===void 0?void 0:D.editCellOnEnter)===null||H===void 0||H)&&((N=(O=t.stateManager.select.ranges)===null||O===void 0?void 0:O.length)!==null&&N!==void 0?N:0)===1){const at=t.stateManager.select.ranges[0].start.col,lt=t.stateManager.select.ranges[0].start.row,_t=t.stateManager.select.ranges[0].end.col,vt=t.stateManager.select.ranges[0].end.row;at===_t&&lt===vt&&t.getEditor(at,lt)&&((U=t.editorManager)===null||U===void 0||U.startEditCell(at,lt))}}else if(g.key==="Tab"){if(((j=(W=t.options.keyboardOptions)===null||W===void 0?void 0:W.moveFocusCellOnTab)===null||j===void 0||j)&&e.select.cellPos.col>=0&&e.select.cellPos.row>=0){if(e.select.cellPos.col===t.colCount-1&&e.select.cellPos.row===t.rowCount-1)return;let at,lt;if(g.preventDefault(),e.select.cellPos.col===t.colCount-1?(lt=Math.min(t.rowCount-1,e.select.cellPos.row+1),at=t.rowHeaderLevelCount):(lt=e.select.cellPos.row,at=e.select.cellPos.col+1),Hs(t,at,lt))return;t.selectCell(at,lt),!((Y=t.editorManager)===null||Y===void 0)&&Y.editingEditor&&((Z=t.editorManager)===null||Z===void 0||Z.completeEdit(),t.getElement().focus(),t.getEditor(at,lt)&&((rt=t.editorManager)===null||rt===void 0||rt.startEditCell(at,lt)))}}else if(!g.ctrlKey&&!g.metaKey){const at=t.options.editCellTrigger;if((at==="keydown"||Array.isArray(at)&&at.includes("keydown"))&&!(!((J=t.editorManager)===null||J===void 0)&&J.editingEditor)){const lt=/^[a-zA-Z0-9+\-*\/%=.,\s]$/;g.key.match(lt)&&(t.editorManager&&(t.editorManager.beginTriggerEditCellMode="keydown"),(st=t.editorManager)===null||st===void 0||st.startEditCell(e.select.cellPos.col,e.select.cellPos.row,""))}}r(g)}),i.on(t.getElement(),"copy",g=>_h(this,void 0,void 0,function*(){var m,p;if(!((m=t.keyboardOptions)===null||m===void 0)&&m.copySelected){const v=t.getCopyValue();if(et(v)){g.preventDefault();const b=yield navigator.permissions.query({name:"clipboard-write"});if(!((p=navigator.clipboard)===null||p===void 0)&&p.write&&b.state==="granted"){const C=w=>{const _=["<table>"],A=['<meta name="author" content="Visactor"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),T=w.split(`\r
`);return T.forEach(function(S,x){const E=S.split("	"),M=[];x===0&&_.push("<tbody>"),E.forEach(function(L,I){const D=L?L.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,H=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(H.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";M.push(`<td>${D}</td>`)}),_.push("<tr>",...M,"</tr>"),x===T.length-1&&_.push("</tbody>")}),_.push("</table>"),[A,_.join("")].join("")},y=C(v);navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([y],{type:"text/html"}),"text/plain":new Blob([v],{type:"text/plain"})})])}else KK.IE?window.clipboardData.setData("Text",v):g.clipboardData.setData("text/plain",v);t.fireListeners(ut.COPY_DATA,{cellRange:t.stateManager.select.ranges,copyData:v})}}})),i.on(t.getElement(),"paste",g=>_h(this,void 0,void 0,function*(){var m,p,v,b;if(!((m=t.keyboardOptions)===null||m===void 0)&&m.pasteValueToCell&&t.changeCellValues){if(!((p=t.editorManager)===null||p===void 0)&&p.editingEditor)return;if(((v=t.stateManager.select.ranges)===null||v===void 0?void 0:v.length)>0)if(!((b=navigator.clipboard)===null||b===void 0)&&b.read)navigator.clipboard.read().then(C=>{for(const y of C)y.types.includes("text/html")?a(y):y.types.length===1&&y.types[0]==="text/plain"&&u(y)});else{const C=t.stateManager.select.ranges,y=Math.min(C[0].start.col,C[0].end.col),w=Math.min(C[0].start.row,C[0].end.row),_=(g.clipboardData||window.Clipboard).getData("text").split(`
`),A=[];_.forEach(function(S,x){const E=S.split("	"),M=[];A.push(M),E.forEach(function(L,I){I===E.length-1&&(L=L.trim()),M.push(L)})});const T=yield t.changeCellValues(y,w,A);t.hasListeners(ut.PASTED_DATA)&&t.fireListeners(ut.PASTED_DATA,{col:y,row:w,pasteData:A,changedCellResults:T})}}})),i.on(t.getElement(),"contextmenu",g=>{var m;((m=t.eventOptions)===null||m===void 0?void 0:m.preventDefaultContextMenu)!==!1?g.preventDefault():c(g)}),t.options.canvas||i.on(t.getContainer(),"resize",g=>{var m;t.isReleased||g.width===0&&g.height===0||((t.autoFillWidth||t.autoFillHeight)&&((m=t.editorManager)===null||m===void 0||m.completeEdit()),et(t.options.pixelRatio)||t.setPixelRatio(KI()),g.windowSizeNotChange||t.resize())});const o=/<tr[^>]*>([\s\S]*?)<\/tr>/g,s=/<td[^>]*>([\s\S]*?)<\/td>/g;function a(g){const m=t.stateManager.select.ranges,p=m.length,v=Math.min(m[p-1].start.col,m[p-1].end.col),b=Math.min(m[p-1].start.row,m[p-1].end.row),C=Math.max(m[p-1].start.col,m[p-1].end.col),y=Math.max(m[p-1].start.row,m[p-1].end.row);let w=0,_=0,A=[];g.getType("text/html").then(T=>{T.text().then(S=>_h(this,void 0,void 0,function*(){var x,E;if(S&&/(<table)|(<TABLE)/g.test(S)){const M=Array.from(S.matchAll(o));for(const I of M){const D=I[1],H=Array.from(D.matchAll(s)).map(O=>O[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,`
`).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));A.push(H),w=Math.max(w,(x=H==null?void 0:H.length)!==null&&x!==void 0?x:0)}_=(E=A.length)!==null&&E!==void 0?E:0,A=h(A,_,w,y-b+1,C-v+1);const L=yield t.changeCellValues(v,b,A,!0);t.hasListeners(ut.PASTED_DATA)&&t.fireListeners(ut.PASTED_DATA,{col:v,row:b,pasteData:A,changedCellResults:L})}else navigator.clipboard.read().then(M=>{for(const L of M)L.types.includes("text/plain")&&L.getType("text/plain").then(I=>{I.text().then(l)})})}))})}function l(g){var m;return _h(this,void 0,void 0,function*(){const p=t.stateManager.select.ranges,v=p.length,b=Math.min(p[v-1].start.col,p[v-1].end.col),C=Math.min(p[v-1].start.row,p[v-1].end.row),y=Math.max(p[v-1].start.col,p[v-1].end.col),w=Math.max(p[v-1].start.row,p[v-1].end.row);let _=0,A=0,T=[];g.split(`
`).forEach(function(x,E){var M;const L=x.split("	"),I=[];T.push(I),L.forEach(function(D,H){H===L.length-1&&(D=D.trim()),I.push(D)}),_=Math.max(_,(M=I==null?void 0:I.length)!==null&&M!==void 0?M:0)}),A=(m=T.length)!==null&&m!==void 0?m:0,T=h(T,A,_,w-C+1,y-b+1);const S=yield t.changeCellValues(b,C,T,!0);t.hasListeners(ut.PASTED_DATA)&&t.fireListeners(ut.PASTED_DATA,{col:b,row:C,pasteData:T,changedCellResults:S})})}function u(g){const m=t.stateManager.select.ranges,p=m.length,v=Math.min(m[p-1].start.col,m[p-1].end.col),b=Math.min(m[p-1].start.row,m[p-1].end.row),C=Math.max(m[p-1].start.col,m[p-1].end.col),y=Math.max(m[p-1].start.row,m[p-1].end.row);let w=0,_=0;g.getType("text/plain").then(A=>{A.text().then(T=>_h(this,void 0,void 0,function*(){var S;const x=T.replace(/\r(?!\n)/g,`\r
`).split(`\r
`);let E=[];x.length>1&&x[x.length-1]===""&&x.pop(),x.forEach(function(L,I){var D;const H=L.split("	"),O=[];E.push(O),H.forEach(function(N,U){N.includes(`
`)&&(N=N.replace(/^"(.*)"$/,"$1").replace(/["]*/g,W=>new Array(Math.floor(W.length/2)).fill('"').join(""))),O.push(N)}),w=Math.max(w,(D=O==null?void 0:O.length)!==null&&D!==void 0?D:0)}),_=(S=E.length)!==null&&S!==void 0?S:0,E=h(E,_,w,y-b+1,C-v+1);const M=yield t.changeCellValues(v,b,E,!0);t.hasListeners(ut.PASTED_DATA)&&t.fireListeners(ut.PASTED_DATA,{col:v,row:b,pasteData:E,changedCellResults:M})}))})}function h(g,m,p,v,b){if(b>p||v>m){if(b%p==0&&v%m==0){const C=[];for(let y=0;y<v;y++){const w=[];C.push(w);for(let _=0;_<b;_++){const A=y%m,T=_%p;w.push(g[A][T])}}return C}return g}return g}const d=g=>{var m;if(t.isReleased)return;t.eventManager.LastBodyPointerXY={x:g.x,y:g.y},t.eventManager.isDown=!0;const p=g.target;if(!t.getElement().contains(p)&&!t.internalProps.menuHandler.containElement(p)){const v=(m=t.editorManager)===null||m===void 0?void 0:m.completeEdit(g);mp(v,b=>{var C,y;if(b!==!1&&(!((C=t.options.select)===null||C===void 0)&&C.outsideClickDeselect)){const w=!!(!((y=e.select.ranges)===null||y===void 0)&&y.length);n.dealTableSelect(),e.endSelectCells(!0,w)}})}};n.globalEventListeners.push({name:"pointerdown",env:"vglobal",callback:d}),De.addEventListener("pointerdown",d);const c=g=>{var m,p;if(t.isReleased)return;const v=g.target;if(v!==t.canvas&&(b=>{var C,y;if(e.menu.isShow&&setTimeout(()=>{t.internalProps.menuHandler.pointInMenuElement(b.clientX,b.clientY)||e.menu.isShow&&e.hideMenu()},0),e.isResizeCol())Xp(t);else if(e.isResizeRow())Yp(t);else if(e.isMoveCol()){const w=t.stateManager.endMoveCol();ly(t,w,b)}else if(e.isSelecting()&&(!((y=(C=t.stateManager.select)===null||C===void 0?void 0:C.ranges)===null||y===void 0)&&y.length)){const w=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.col,_=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.row;if(t.stateManager.endSelectCells(),t.hasListeners(ut.DRAG_SELECT_END)){const A={event:b,cells:[],col:w,row:_,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:void 0};A.cells=t.getSelectedCellInfos(),t.fireListeners(ut.DRAG_SELECT_END,A)}}})(g),t.eventManager.LastBodyPointerXY=null,t.eventManager.isDown=!1,t.eventManager.isDraging=!1,t.eventManager.inertiaScroll.endInertia(),e.interactionState==="grabing"&&e.isResizeCol())Xp(t);else if(e.interactionState==="grabing"&&e.isResizeRow())Yp(t);else if(e.isMoveCol()){const b=t.stateManager.endMoveCol();ly(t,b,g)}else if(!((m=t.editorManager)===null||m===void 0)&&m.editingEditor&&!t.getElement().contains(v)){const b=(p=t.editorManager)===null||p===void 0?void 0:p.completeEdit(g);mp(b,C=>{C!==!1&&(e.updateInteractionState(Qt.default),n.dealTableHover())})}e.updateInteractionState(Qt.default)};n.globalEventListeners.push({name:"pointerup",env:"vglobal",callback:c}),De.addEventListener("pointerup",c);const f=g=>{var m,p,v,b,C;if(t.eventManager.isDown&&t.eventManager.LastBodyPointerXY){const A=(p=(m=t.eventManager.LastBodyPointerXY)===null||m===void 0?void 0:m.x)!==null&&p!==void 0?p:g.x,T=(b=(v=t.eventManager.LastBodyPointerXY)===null||v===void 0?void 0:v.y)!==null&&b!==void 0?b:g.y;(Math.abs(A-g.x)>1||Math.abs(T-g.y)>1)&&(t.eventManager.isDraging=!0)}const{x:y,y:w}=t._getMouseAbstractPoint(g);e.interactionState===Qt.grabing&&(e.isResizeCol()?(n.dealColumnResize(y,w),t.hasListeners(ut.RESIZE_COLUMN)&&t.fireListeners(ut.RESIZE_COLUMN,{col:t.stateManager.columnResize.col,colWidth:t.getColWidth(t.stateManager.columnResize.col)})):e.isResizeRow()&&(n.dealRowResize(y,w),t.hasListeners(ut.RESIZE_ROW)&&t.fireListeners(ut.RESIZE_ROW,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})));const _=t.stateManager.isSelecting();if(n._enableTableScroll&&n.isDraging&&_&&((C=t.stateManager.select.ranges)===null||C===void 0?void 0:C.length)>0){const A=t.getDrawRange(),T=t.getFrozenRowsHeight(),S=t.getBottomFrozenRowsHeight(),x=t.getFrozenColsWidth(),E=t.getRightFrozenColsWidth(),M=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].start;if(t.isSeriesNumber(M.col,M.row))return;const L=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end,I=(t.isFrozenRow(M.row)===!1||t.isFrozenRow(L.row)===!1)&&t.getAllRowsHeight()>t.tableNoFrameHeight,D=(t.isFrozenColumn(M.col)===!1||t.isFrozenColumn(L.col)===!1)&&t.getAllColsWidth()>t.tableNoFrameWidth;if((w>A.bottom-S||w<A.top+T)&&I||(y>A.right-E||y<A.left+x)&&D){t.eventManager.scrollXSpeed=0,t.eventManager.scrollYSpeed=0;let H=!1,O=!1,N=!1,U=!1;w>A.bottom-S&&I&&t.scrollTop+t.tableNoFrameHeight<t.getAllRowsHeight()?(H=!0,t.eventManager.scrollYSpeed=-(w-A.bottom+S)/50):w<A.top+T&&I&&t.scrollTop>0&&(O=!0,t.eventManager.scrollYSpeed=-(w-A.top-T)/50),y>A.right-E&&D&&t.scrollLeft+t.tableNoFrameWidth<t.getAllColsWidth()?(N=!0,t.eventManager.scrollXSpeed=-(y-A.right+E)/50):y<A.left+x&&D&&t.scrollLeft>0&&(U=!0,t.eventManager.scrollXSpeed=-(y-A.left-x)/50),t.eventManager.inertiaScroll.startInertia(t.eventManager.scrollXSpeed,t.eventManager.scrollYSpeed,1),t.eventManager.inertiaScroll.setScrollHandle((W,j)=>{var Y;let Z,rt;qp({deltaX:-W,deltaY:-j},t.stateManager,!1),H?rt=t.scrollTop+A.height-S-20:O&&(rt=t.scrollTop+T+20),N?Z=t.scrollLeft+A.width-E-20:U&&(Z=t.scrollLeft+x+20);let J=!1,st=!1;N||U||(y>t.tableNoFrameWidth-t.getRightFrozenColsWidth()&&y<t.tableNoFrameWidth||y>0&&y<t.getFrozenColsWidth()?(Z=y,st=!0):Z=t.scrollLeft+y),H||O||(w>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()&&w<t.tableNoFrameHeight||w>0&&w<t.getFrozenRowsHeight()?(rt=w,J=!0):rt=t.scrollTop+w),t.stateManager.updateInteractionState(Qt.grabing);const ht=t.getTargetColAtConsiderRightFrozen(Z,st),at=t.getTargetRowAtConsiderBottomFrozen(rt,J);!(!((Y=t.options.select)===null||Y===void 0)&&Y.disableDragSelect)&&et(ht)&&et(at)&&t.stateManager.updateSelectPos(ht.col,at.row,!1,!1,!1,!1)})}else t.eventManager.inertiaScroll.isInertiaScrolling()?t.eventManager.inertiaScroll.endInertia():t.eventManager.scrollYSpeed=0}};n.globalEventListeners.push({name:"pointermove",env:"vglobal",callback:f}),De.addEventListener("pointermove",f)}function kit(n){const t=n.table,e=t.stateManager,i=t.scenegraph;if(De.envContribution.supportsTouchEvents===!1)return;De.addEventListener("contextmenu",a=>{a.stopPropagation(),a.preventDefault()},{capture:!0}),n.touchMovePoints=[],t.scenegraph.tableGroup.addEventListener("touchstart",a=>{var l,u,h,d,c,f,g,m;if(a.target.isChildOf(i.component.vScrollBar)||a.target.isChildOf(i.component.vScrollBar))return;n.isTouchdown=!0;const p=a.nativeEvent;n.touchMovePoints.push({x:t.rotateDegree?(h=(u=(l=p.changedTouches)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u._canvasX)!==null&&h!==void 0?h:(d=a.canvas)===null||d===void 0?void 0:d.x:a.page.x,y:t.rotateDegree?(g=(f=(c=p.changedTouches)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f._canvasY)!==null&&g!==void 0?g:(m=a.canvas)===null||m===void 0?void 0:m.y:a.page.y,timestamp:Date.now()})});const r=a=>{var l,u;if(n.isLongTouch&&a.preventDefault(),n.isTouchdown&&lM(a)){if(n.isTouchMove=!0,((u=(l=n.downIcon)===null||l===void 0?void 0:l.attribute)===null||u===void 0?void 0:u.funcType)===Pe.dragReorder)a.preventDefault();else if(n.touchMovePoints.length>4&&n.touchMovePoints.shift(),n.touchMovePoints.push({x:t.rotateDegree?a.changedTouches[0]._canvasX:a.changedTouches[0].pageX,y:t.rotateDegree?a.changedTouches[0]._canvasY:a.changedTouches[0].pageY,timestamp:Date.now()}),n._enableTableScroll){const h=-n.touchMovePoints[n.touchMovePoints.length-1].x+n.touchMovePoints[n.touchMovePoints.length-2].x,d=-n.touchMovePoints[n.touchMovePoints.length-1].y+n.touchMovePoints[n.touchMovePoints.length-2].y;qp({deltaX:h,deltaY:d},e),a.cancelable&&(t.internalProps.overscrollBehavior==="none"||Math.abs(d)>=Math.abs(h)&&d!==0&&XI(d,e)||Math.abs(d)<=Math.abs(h)&&h!==0&&YI(h,e))&&a.preventDefault()}}};De.addEventListener("touchmove",r,{passive:!1}),n.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:r});const o=a=>{var l,u,h,d;if(n.touchEnd=!0,n.isLongTouch=!1,n.isTouchdown&&lM(a)){if(((u=(l=n.downIcon)===null||l===void 0?void 0:l.attribute)===null||u===void 0?void 0:u.funcType)===Pe.dragReorder)a.preventDefault();else if(!((h=n.touchMovePoints)===null||h===void 0)&&h.length&&(n.touchMovePoints.length>4&&n.touchMovePoints.shift(),n.touchMovePoints.push({x:t.rotateDegree?a.changedTouches[0]._canvasX:a.changedTouches[0].pageX,y:t.rotateDegree?a.changedTouches[0]._canvasY:a.changedTouches[0].pageY,timestamp:Date.now()}),n._enableTableScroll)){const c=n.touchMovePoints[0],f=n.touchMovePoints[((d=n.touchMovePoints)===null||d===void 0?void 0:d.length)-1],g=(f.x-c.x)/(f.timestamp-c.timestamp),m=(f.y-c.y)/(f.timestamp-c.timestamp);n.inertiaScroll.startInertia(g,m,.95),t.eventManager.inertiaScroll.setScrollHandle((p,v)=>{qp({deltaX:-p,deltaY:-v},t.stateManager)})}n.isTouchdown=!1,n.isTouchMove=!1,n.isDraging=!1,n.touchMovePoints=[]}};De.addEventListener("touchend",o),n.globalEventListeners.push({name:"touchend",env:"vglobal",callback:o});const s=a=>{n.touchEnd=!0,n.isLongTouch=!1,n.isTouchdown&&(n.isTouchdown=!1,n.isTouchMove=!1,n.touchMovePoints=[],n.isDraging=!1)};De.addEventListener("touchcancel",s),n.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:s})}function lM(n){return!!n.changedTouches}function Lit(n){n.isPivotChart()&&n.scenegraph.tableGroup.addEventListener("click",t=>{var e;if(!n.stateManager.columnMove.moving&&!n.stateManager.columnResize.resizing)if(t.target.name==="axis-label"){const i=Ii(t),{col:r,row:o}=i.eventArgs,s=n.internalProps.layoutMap;let a,l;s.indicatorsAsCol?(a=s.getDimensionKeyInChartSpec(s.rowHeaderLevelCount,o),l=s.getCellHeaderPaths(s.rowHeaderLevelCount-2,o).rowHeaderPaths):(a=s.getDimensionKeyInChartSpec(r,s.columnHeaderLevelCount),l=s.getCellHeaderPaths(r,s.columnHeaderLevelCount-1).colHeaderPaths);const u=l.map(h=>({key:h.dimensionKey,value:h.value})).filter(h=>h.key);if(u.push({key:a,value:t.target.attribute.text}),n._selectedDimensionInChart.length&&Dit(n._selectedDimensionInChart,u))return;n._selectedDimensionInChart=u,s.updateDataStateToChartInstance(),sy(n.scenegraph),n.scenegraph.updateNextFrame()}else!((e=n._selectedDimensionInChart)===null||e===void 0)&&e.length&&(n._selectedDimensionInChart.length=0,n.internalProps.layoutMap.updateDataStateToChartInstance(),sy(n.scenegraph),n.scenegraph.updateNextFrame())})}function Dit(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e].key!==t[e].key||n[e].value!==t[e].value)return!1;return!0}function Iit(n){n.isPivotChart()&&(n.on(ut.MOUSEENTER_CELL,t=>{n.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if(e.name==="axis"){const i=uM(t.col,t.row,n.internalProps.layoutMap);t.axisPosition=i,n.fireListeners(ut.MOUSEENTER_AXIS,t)}})}),n.on(ut.MOUSELEAVE_CELL,t=>{n.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if(e.name==="axis"){const i=uM(t.col,t.row,n.internalProps.layoutMap);t.axisPosition=i,n.fireListeners(ut.MOUSELEAVE_AXIS,t)}})}))}function uM(n,t,e){if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return"top";if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return"bottom";if(n===e.rowHeaderLevelCount-1&&t>=e.rowHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"left"}else{if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"left";if(n===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"right";if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return"bottom"}return"bottom"}function Fit(n){n.on("checkbox_state_change",t=>{var e,i;const{col:r,row:o,checked:s,field:a}=t;if(!n.internalProps.layoutMap.isSeriesNumber(r,o)||((e=n.internalProps.rowSeriesNumber)===null||e===void 0?void 0:e.enableTreeCheckbox)!==!0||n.isHeader(r,o))return;const l=n.getCellOriginRecord(r,o),u=n.dataSource.currentPagerIndexedData,h=n.getRecordShowIndexByCell(r,o);let d=u[h];if(wt(d)&&(d=[d]),l.vtableMerge||((i=l.children)===null||i===void 0?void 0:i.length))if(s)Qp(n,r,o)===Yt.collapse?Zp(!0,d,n,a):Kp(!0,h,d,u,n,r),iu(h,d,u,n,r);else{Qp(n,r,o)===Yt.collapse?Zp(!1,d,n,a):Kp(!1,h,d,u,n,r),iu(h,d,u,n,r);const c=n.stateManager.headerCheckedState._vtable_rowSeries_number,f=n.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",r,o);c!==f&&n.scenegraph.updateHeaderCheckboxCellState(r,o,f)}else iu(h,d,u,n,r)})}function Oit(n){n.on("checkbox_state_change",t=>{var e;const{col:i,row:r,checked:o,field:s}=t,a=n.internalProps.columns.some(c=>c.tree);if(n.internalProps.enableCheckboxCascade,!a||n.isHeader(i,r))return;const l=n.getCellOriginRecord(i,r),u=n.dataSource.currentPagerIndexedData,h=n.getRecordShowIndexByCell(i,r);let d=u[h];if(wt(d)&&(d=[d]),l.vtableMerge||((e=l.children)===null||e===void 0?void 0:e.length))if(o)Qp(n,i,r)===Yt.collapse?Zp(!0,d,n,s):Kp(!0,h,d,u,n,i,s),iu(h,d,u,n,i,s);else{Qp(n,i,r)===Yt.collapse?Zp(!1,d,n,s):Kp(!1,h,d,u,n,i,s),iu(h,d,u,n,i,s);const c=n.stateManager.headerCheckedState._vtable_rowSeries_number,f=n.stateManager.updateHeaderCheckedState(s,i,r);c!==f&&n.scenegraph.updateHeaderCheckboxCellState(i,r,f)}else iu(h,d,u,n,i,s)})}function Kp(n,t,e,i,r,o,s){var a;const l=s||"_vtable_rowSeries_number";let u=t+1;for(;Wt(i[u])&&((a=i[u])===null||a===void 0?void 0:a.length)>e.length;){const h=r.columnHeaderLevelCount+u;r.stateManager.setCheckedState(o,h,l,n),Ff(o,h,n,r),u++}}function iu(n,t,e,i,r,o){var s;let a=t.length-1;if(a>0){let l=n-1;for(;a>0&&l>=0;)(Wt(e[l])&&((s=e[l])===null||s===void 0?void 0:s.length)===a||a===1&&wt(e[l]))&&(Hit(r,i.columnHeaderLevelCount+l,e[l],i,o),a--),l--}}function Hit(n,t,e,i,r){const{checkedState:o}=i.stateManager,s=e.toString(),a=r||"_vtable_rowSeries_number";Wt(e)&&e.length;let l=!1;const u=[],h=Array.from(o.keys()).sort((m,p)=>{var v,b;const C=m.split(","),y=p.split(","),w=Math.max(C.length,y.length);for(let _=0;_<w;_++){const A=(v=Number(C[_]))!==null&&v!==void 0?v:0,T=(b=Number(y[_]))!==null&&b!==void 0?b:0;if(A!==T)return A-T}return 0}),d=h.map(m=>o.get(m)),c=h.filter(m=>m.startsWith(s+",")&&m!==s);if(d.forEach((m,p)=>{const v=h[p],b=m,C=c.includes(v);l&&(C?u.push(b[a]):l=!1),v===s&&(l=!0)}),u.length===0)return;const f=u.every(m=>!!m),g=u.every(m=>!m);f?(i.stateManager.setCheckedState(n,t,a,!0),Ff(n,t,!0,i)):g?(i.stateManager.setCheckedState(n,t,a,!1),Ff(n,t,!1,i)):(i.stateManager.setCheckedState(n,t,a,"indeterminate"),Ff(n,t,"indeterminate",i))}function Zp(n,t,e,i){const{checkedState:r}=e.stateManager,o=t.toString();Wt(t)&&t.length;let s=!1;const a=Array.from(r.keys()).sort((h,d)=>{var c,f;const g=h.split(","),m=d.split(","),p=Math.max(g.length,m.length);for(let v=0;v<p;v++){const b=(c=Number(g[v]))!==null&&c!==void 0?c:0,C=(f=Number(m[v]))!==null&&f!==void 0?f:0;if(b!==C)return b-C}return 0}),l=a.filter(h=>h.startsWith(o+",")&&h!==o);a.map(h=>r.get(h)).forEach((h,d)=>{const c=a[d],f=h,g=l.length!==0&&l.includes(c);s&&(g?f[i]=n:s=!1),c===o&&(s=!0)})}function zit(n){n.on("checkbox_state_change",t=>{const{col:e,row:i,checked:r,field:o}=t;if(n.isHeader(e,i))n.stateManager.setHeaderCheckedState(o,r),n.getCellType(e,i)==="checkbox"&&n.scenegraph.updateCheckboxCellState(e,i,r);else if(n.stateManager.setCheckedState(e,i,o,r),n.getCellType(e,i)==="checkbox"){const s=n.stateManager.headerCheckedState[o],a=n.stateManager.updateHeaderCheckedState(o,e,i);s!==a&&n.scenegraph.updateHeaderCheckboxCellState(e,i,a)}})}function Qp(n,t,e){const i=n.getRecordShowIndexByCell(t,e);return n.dataSource.getHierarchyState(i)}function Nit(n){n.on(ut.CLICK_CELL,t=>{const{col:e,row:i,target:r}=t;r.name!=="button"||r.attribute.disable||n.hasListeners(ut.BUTTON_CLICK)&&n.fireListeners(ut.BUTTON_CLICK,{col:e,row:i,event:t.event})})}function Wit(n){n.on(ut.ICON_CLICK,t=>{var e;const{col:i,row:r,x:o,y:s,funcType:a,icon:l,event:u}=t,{stateManager:h}=n;if(a===Pe.dropDown)h.triggerDropDownMenu(i,r,o,s,u);else if(a===Pe.sort)h.triggerSort(i,r,l,u);else if(a===Pe.frozen)h.triggerFreeze(i,r,l);else if(a===Pe.drillDown)_it(n);else if(a===Pe.collapse||a===Pe.expand){const d=!!(!((e=h.select.ranges)===null||e===void 0)&&e.length);h.updateSelectPos(-1,-1),h.endSelectCells(!0,d),n.toggleHierarchyState(i,r)}})}function Uit(n){n.on(ut.DROPDOWN_MENU_CLICK,()=>{n.stateManager.hideMenu()})}function Vit(n){n.on(ut.DBLCLICK_CELL,t=>{var e,i,r;if(t.federatedEvent){const o=Ii(t.federatedEvent),s=n.scenegraph.getResizeColAt(o.abstractPos.x,o.abstractPos.y,(e=o.eventArgs)===null||e===void 0?void 0:e.targetCell),a=(i=n.options.disableDblclickAutoResizeColWidth)!==null&&i!==void 0?i:(r=n.options.resize)===null||r===void 0?void 0:r.disableDblclickAutoResizeColWidth;if(n.eventManager.checkCellFillhandle(o))n.fireListeners(ut.DBLCLICK_FILL_HANDLE,{});else if(n._canResizeColumn(s.col,s.row)&&s.col>=0&&!a){n.scenegraph.updateAutoColWidth(s.col),n.internalProps._widthResizedColMap.add(s.col),n.scenegraph.updateChartSizeForResizeColWidth(s.col);const l=n.stateManager;l.columnResize.col<l.table.frozenColCount&&!l.table.isPivotTable()&&!l.table.transpose&&l.table.scenegraph.component.setFrozenColumnShadow(l.table.frozenColCount-1,l.columnResize.isRightFrozen);const u=[];for(let h=0;h<n.colCount;h++)u.push(n.getColWidth(h));n.fireListeners(ut.RESIZE_COLUMN_END,{col:s.col,colWidths:u})}}})}function jit(n){n.on(ut.CONTEXTMENU_CELL,t=>{const{col:e,row:i}=t,r=n.getSelectedCellRanges();let o=!1;if(r.length>0)for(let s=0;s<r.length;s++){const a=r[s],l=a.start.col,u=a.end.col,h=a.start.row,d=a.end.row;if(e>=l&&e<=u&&i>=h&&i<=d||e>=u&&e<=l&&i>=d&&i<=h||e>=l&&e<=u&&i>=d&&i<=h||e>=u&&e<=l&&i>=h&&i<=d){o=!0;break}}o||n.selectCell(e,i)})}class Git{constructor(t){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.table=t,this.handleTextStickBindId=[],this.inertiaScroll=new Ait(t.stateManager),be.mode==="node"||t.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){Rit(this),Pit(this),Bit(this),kit(this),Eit(this)}updateEventBinder(){setTimeout(()=>{var t;this.table.isReleased||(Gp(this.table)&&((t=this.handleTextStickBindId)===null||t===void 0?void 0:t.length)===0?(this.handleTextStickBindId.push(this.table.on(ut.SCROLL,e=>{Qh(this.table)})),this.handleTextStickBindId.push(this.table.on(ut.RESIZE_COLUMN_END,e=>{Qh(this.table)})),this.handleTextStickBindId.push(this.table.on(ut.RESIZE_ROW_END,e=>{Qh(this.table)}))):!Gp(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(e=>{this.table.off(e)}),this.handleTextStickBindId=[]),aM(this.table))},0)}bindSelfEvent(){this.table.isReleased||(Wit(this.table),Uit(this.table),this.updateEventBinder(),vit(this.table),Vit(this.table),this.table.isPivotTable()&&Cit(this.table)&&bit(this.table),aM(this.table),Lit(this.table),Iit(this.table),Fit(this.table),Oit(this.table),zit(this.table),Nit(this.table),jit(this.table))}dealTableHover(t){if(!t)return void this.table.stateManager.updateHoverPos(-1,-1);const{eventArgs:e}=t;e?this.table.stateManager.updateHoverPos(e.col,e.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(t){const{eventArgs:e}=t;e?this.table.stateManager.updateHoverIcon(e.col,e.row,e.target,e.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(t){}dealTableSelect(t,e){var i,r,o,s,a;if(!t)return this.table.stateManager.updateSelectPos(-1,-1),!1;const{eventArgs:l}=t;if(l){if(l.target.name==="checkbox"||l.target.name==="radio"||l.target.name==="switch"||l.target.name==="button")return!1;if(this.table.isHeader(l.col,l.row)&&Hs(this.table,l.col,l.row))return e||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(l.col,l.row)&&Hs(this.table,l.col,l.row)){if(!e){const u=!!(!((i=this.table.stateManager.select.ranges)===null||i===void 0)&&i.length);this.table.stateManager.updateSelectPos(-1,-1),u&&this.table.stateManager.endSelectCells(!0,u)}return!1}return!this.table.isPivotChart()||((r=t==null?void 0:t.eventArgs)===null||r===void 0?void 0:r.target.name)!=="axis-label"&&((o=t==null?void 0:t.eventArgs)===null||o===void 0?void 0:o.target.type)!=="chart"?(this.table.stateManager.updateSelectPos(l.col,l.row,l.event.shiftKey,l.event.ctrlKey||l.event.metaKey,!1,!e&&((a=(s=this.table.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||a===void 0||a)),!0):(this.table.stateManager.updateSelectPos(-1,-1),!1)}return!1}dealFillSelect(t,e){var i,r;const{eventArgs:o}=t;if(o){if(!((r=(i=this.table.stateManager.select)===null||i===void 0?void 0:i.ranges)===null||r===void 0)&&r.length&&this.table.stateManager.isFillHandle()){let s,a;const l=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];e&&(et(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.startY-t.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-t.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(s=o.row,a=l.end.col):(s=l.end.row,a=o.col)),this.table.stateManager.updateSelectPos(e?a:l.end.col,e?s:l.end.row,!0,o.event.ctrlKey||o.event.metaKey,!1,!e)}else this.table.stateManager.updateSelectPos(o.col,o.row,o.event.shiftKey,o.event.ctrlKey||o.event.metaKey,!1,!e);return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(ut.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(t){}checkColumnResize(t,e){const{eventArgs:i}=t;if(this.table.options.enableTreeStickCell&&!i)return!1;const r=this.table.scenegraph.getResizeColAt(t.abstractPos.x,t.abstractPos.y,i==null?void 0:i.targetCell);return this.table._canResizeColumn(r.col,r.row)&&r.col>=0?(e&&this.table.stateManager.startResizeCol(r.col,t.abstractPos.x,t.abstractPos.y,r.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(t,e){const{eventArgs:i}=t;if(i){const r=this.table.scenegraph.getResizeRowAt(t.abstractPos.x,t.abstractPos.y,i.targetCell);if(this.table._canResizeRow(r.col,r.row)&&r.row>=0)return e&&this.table.stateManager.startResizeRow(r.row,t.abstractPos.x,t.abstractPos.y,r.bottomFrozen),!0}return!1}cellIsHeaderCheck(t,e){const{eventArgs:i}=t,{col:r,row:o,target:s}=i;return this.table.isHeader(r,o)?this.table.getCellType(i.col,i.row)==="checkbox"&&s.name==="checkbox":!1}checkCellFillhandle(t,e){var i,r,o,s,a;let l=!1;if(l=typeof((i=this.table.options.excelOptions)===null||i===void 0?void 0:i.fillHandle)=="function"?this.table.options.excelOptions.fillHandle({selectRanges:this.table.stateManager.select.ranges,table:this.table}):(r=this.table.options.excelOptions)===null||r===void 0?void 0:r.fillHandle,l){const{eventArgs:u}=t;if(u&&(!((s=(o=this.table.stateManager.select)===null||o===void 0?void 0:o.ranges)===null||s===void 0)&&s.length)){const h=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),d=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),c=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),f=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row);let g;g=h<this.table.colCount-1?this.table.scenegraph.highPerformanceGetCell(h,d).globalAABBBounds:this.table.scenegraph.highPerformanceGetCell(c-1,d).globalAABBBounds;const m=Math.abs(t.abstractPos.x-g.x2);g=d<this.table.rowCount-1?this.table.scenegraph.highPerformanceGetCell(h,d).globalAABBBounds:this.table.scenegraph.highPerformanceGetCell(h,f-1).globalAABBBounds;const p=Math.abs(t.abstractPos.y-g.y2),v=18;if(!((a=this.table.stateManager.fillHandle)===null||a===void 0)&&a.isFilling||m<=v/2&&p<=v/2)return e&&this.table.stateManager.startFillSelect(t.abstractPos.x,t.abstractPos.y),!0}}return!1}dealColumnResize(t,e){this.table.stateManager.updateResizeCol(t,e)}dealRowResize(t,e){this.table.stateManager.updateResizeRow(t,e)}checkColumnMover(t){var e;const{eventArgs:i}=t;return!(!i||!this.table._canDragHeaderPosition(i.col,i.row))&&(this.table.stateManager.startMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,(e=i==null?void 0:i.event)===null||e===void 0?void 0:e.nativeEvent),!0)}dealColumnMover(t){var e;const{eventArgs:i}=t;et(i.col)&&et(i.row)&&this.table.stateManager.updateMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,(e=i==null?void 0:i.event)===null||e===void 0?void 0:e.nativeEvent)}startColumnResize(t){}dealIconClick(t,e){const{eventArgs:i}=e,{target:r,event:o,col:s,row:a}=i||{target:t.target,event:t,col:-1,row:-1},l=r;if(l.role&&l.role.startsWith("icon-"))return this.table.fireListeners(ut.ICON_CLICK,{name:l.name,x:(l.globalAABBBounds.x1+l.globalAABBBounds.x2)/2,y:l.globalAABBBounds.y2,col:s,row:a,funcType:l.attribute.funcType,icon:l,event:o}),!0;if(r instanceof li){const u=r.pickIcon(o.global);if(u)return this.table.fireListeners(ut.ICON_CLICK,{name:u.attribute.id,x:u.globalX+u.globalAABBBounds.width()/2,y:u.globalY+u.AABBBounds.height(),col:s,row:a,funcType:u.attribute.funcType,icon:u,event:o}),!0}return!1}release(){this.gesture.release(),this.globalEventListeners.forEach(t=>{t.env==="document"?document.removeEventListener(t.name,t.callback):t.env==="body"?document.body.removeEventListener(t.name,t.callback):t.env==="window"?window.removeEventListener(t.name,t.callback):t.env==="vglobal"&&De.removeEventListener(t.name,t.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}}let hM;const $it=n=>{const t=n.value;return Number(t)>80?"#20a8d8":Number(t)>50?"#4dbd74":Number(t)>20?"#ffc107":"#f86c6b"};class Jp extends io{static get DEFAULT(){return hM||(hM=new Jp)}constructor(t={},e={}){var i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b;super(t,e),this._showBar=(i=t.showBar)===null||i===void 0||i,this._barColor=(r=t.barColor)!==null&&r!==void 0?r:$it,this._barPositiveColor=(o=t.barPositiveColor)!==null&&o!==void 0?o:"#4dbd74",this._barNegativeColor=(s=t.barNegativeColor)!==null&&s!==void 0?s:"#f86c6b",this._barAxisColor=(a=t.barAxisColor)!==null&&a!==void 0?a:"black",this._barBgColor=t.barBgColor,this._barHeight=(l=t.barHeight)!==null&&l!==void 0?l:3,this._barHeight=(u=t.barHeight)!==null&&u!==void 0?u:3,this._barBottom=(h=t.barBottom)!==null&&h!==void 0?h:0,this._barPadding=(d=t.barPadding)!==null&&d!==void 0?d:[0,0,0,0],this._showBarMark=(c=t.showBarMark)!==null&&c!==void 0&&c,this._barMarkPositiveColor=(f=t.barMarkPositiveColor)!==null&&f!==void 0?f:"#4dbd74",this._barMarkNegativeColor=(g=t.barMarkNegativeColor)!==null&&g!==void 0?g:"#f86c6b",this._barMarkWidth=(m=t.barMarkWidth)!==null&&m!==void 0?m:2,this._barMarkPosition=(p=t.barMarkPosition)!==null&&p!==void 0?p:"right",this._barRightToLeft=(v=t.barRightToLeft)!==null&&v!==void 0&&v,this._barMarkInBar=(b=t.barMarkInBar)===null||b===void 0||b}get showBar(){return this._showBar}set showBar(t){this._showBar=t}get barColor(){return this._barColor}set barColor(t){this._barColor=t}get barBgColor(){return this._barBgColor}set barBgColor(t){this._barBgColor=t}get barHeight(){return this._barHeight}set barHeight(t){this._barHeight=t}get barBottom(){return this._barBottom}set barBottom(t){this._barBottom=t}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(t){this._barPositiveColor=t}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(t){this._barNegativeColor=t}get barAxisColor(){return this._barAxisColor}set barAxisColor(t){this._barAxisColor=t}get barPadding(){return this._barPadding}set barPadding(t){this._barPadding=t}get showBarMark(){return this._showBarMark}set showBarMark(t){this._showBarMark=t}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(t){this._barMarkPositiveColor=t}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(t){this._barMarkNegativeColor=t}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(t){this._barMarkWidth=t}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(t){this._barMarkPosition=t}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(t){this._barRightToLeft=t}get barMarkInBar(){return this._barMarkInBar}set barMarkInBar(t){this._barMarkInBar=t}clone(){return new Jp(this,null)}}const qit=["type","content","style","color","width","height","marginRight","marginLeft","src","svg","name","path","positionType","tooltip","hover","cursor","shape","interactive","isGif"],Xit=qit;class Yit{constructor(t){this._table=t;const e=Fn();this.expandIcon=e[ir.expandIconName],this.collapseIcon=e[ir.collapseIconName]}getIcons(t,e,i,r,o){const s=[],a=this.getHierarchyIcon(t,e);a&&s.push(a);const{icon:l}=this._table.getBodyColumnDefine(t,e);if(l){let u;typeof l=="function"?u=l({col:t,row:e,value:i,dataValue:r,table:this._table}):u=l;const h=Fn(),d=c=>{let f;f=typeof c=="string"?h[c]:c,f&&s.push(f)};Array.isArray(u)?u.forEach((c,f)=>{d(c)}):d(u)}return o&&s.forEach((u,h)=>{(u.content||u.src)&&(s[h]=this.getCellIconFromRecordValue(u,t,e))}),s}getStyleClass(t){switch(t){case"text":case"link":return Md;case"image":case"video":return AK;case"chart":case"sparkline":return io;case"progressbar":return Jp;case"checkbox":return WC;case"radio":return ja;case"switch":return Ga;case"button":return $a}return Md}getCellIconFromRecordValue(t,e,i){if(Array.isArray(t))return t.map(s=>this.getCellIconFromRecordValue(s,e,i));if(!GD.isObject(t)||typeof t=="function")return this._table.getFieldData(t,e,i);const r={},o=t;return Xit.forEach(s=>{var a,l;if(o[s]!==void 0){const u=this._table.getFieldData(o[s],e,i);et(u)?r[s]=u:!((l=(a=this._table)._hasField)===null||l===void 0)&&l.call(a,o[s],e,i)||(r[s]=o[s])}}),r}getHierarchyIcon(t,e){const i=this._table.getHierarchyState(t,e);return i===Yt.expand?this.expandIcon:i===Yt.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+((t=this.expandIcon.marginLeft)!==null&&t!==void 0?t:0)+((e=this.expandIcon.marginRight)!==null&&e!==void 0?e:0)}}function wo(n,t){const e=document.createElement(n);return t&&e.classList.add(...t),e}function Kit(){if(be.mode==="node")return;const n=document.createElement("style");n.id="vtable-menu-styleSheet",n.textContent=`
@keyframes vtable__menu-element--shown-animation {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}
.vtable__menu-element {
	position: absolute;
	box-sizing: border-box;
	border-radius: 4px;
	background-color: #fff;
	padding: 6px 0;
	/* pointer-events: none; */
	user-select: none;
	color: #000;
	max-width: 300px;
	z-index: 99999;
	border: #CCC 0.5px solid;
	cursor: default;
	width: max-content;
	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);
  max-height: 100%;
  overflow-y: auto;
}
.vtable__menu-element--hidden {
	opacity: 0;
	/* transform: translate(-50%, -50%); */
	transition: opacity 75ms linear;
	z-index: -9999;
}
.vtable__menu-element--shown {
	opacity: 1;
	/* transform: translate(-50%, -50%); */
	animation: vtable__menu-element--shown-animation 150ms ease-out;
}
.vtable__menu-element__content {
	font-family: Roboto;
	font-size: 12px;
	overflow: hidden;
	display: inline-block;
	/* height: 100%; */
	line-height: 30px;
}
.vtable__menu-element__item {
	height: 32px;
	padding: 0px 12px;
	cursor: pointer;
	position: relative;
	display: flex;
	align-items: center;
	justify-content: flex-start;
}
.vtable__menu-element__item:hover {
	background-color: rgba(27, 31, 35, 0.06);
}
.vtable__menu-element__icon{
	/* vertical-align: top; */
	display: flex;
	/* line-height: 30px; */
	margin-right: 6px;
}
.vtable__menu-element__no-event {
	pointer-events: none;
}
.vtable__menu-element--select {
	color: #2E68CF;
}
.vtable__menu-element--normal {
	color: rgba(20, 20, 20, 0.9);;
}
.vtable__menu-element__item-disabled {
    color: rgba(0, 0, 0, 0.25);
    cursor: not-allowed;
	  background-color: #fff;
}
.vtable__menu-element__item-disabled:hover {
	  background-color: #fff;
}
.vtable__menu-element__split {
	height: 0px;
	border: 1px solid rgb(209, 213, 218);
	margin: 5px 0;
}
.vtable__menu-element__title {
	color: rgb(149, 149, 149);
}
.vtable__menu-element__arrow {
	position: absolute;
	right: 3px;
	font-weight: bold;
	margin-top: 1px;
}
.vtable__menu-element__item-text {
	margin-right: 15px;
}
`,document.head.appendChild(n)}Kit();const Kr="vtable__menu-element",Zit=`${Kr}__item`,Ob=`${Kr}__content`,Nr=`${Kr}--hidden`,Ko=`${Kr}--shown`,Qit=`${Kr}--normal`,Jit=`${Kr}--select`,trt=`${Kr}__icon`,ert=`${Kr}__split`,irt=`${Kr}__title`,rrt=`${Kr}__arrow`,Ch=`${Kr}__no-event`,dM=`${Kr}__item-text`,Of=`${Kr}__item-disabled`;function cM(){return wo("div",[Kr,Nr])}function kh(n,t,e,i,r,o){const s=n.getCellRange(i,r);for(let a=0;a<t.length;a++){const l=t[a];let{col:u,row:h}=l;const{field:d,menuKey:c}=l;if(typeof u!="number"||typeof h!="number")if(n.isPivotTable()){const f=n.internalProps.layoutMap.getPivotCellAdress(d);if(!f)continue;u=f.col,h=f.row}else{const f=n.internalProps.layoutMap.getHeaderCellAddressByField(d);if(!f)continue;u=f.col,h=f.row}if(et(u)&&et(h)&&Ln(s,u,h)&&e===c)return!0}return!1}class nrt{constructor(t){var e,i,r,o,s,a,l,u,h,d,c;this._handler=new Jm,this._rootElement=cM(),this._secondElement=cM(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",f=>{f.stopPropagation()}),(e=this._rootElement)===null||e===void 0||e.addEventListener("mousedown",f=>{f.stopPropagation(),f.preventDefault()}),(i=this._rootElement)===null||i===void 0||i.addEventListener("contextmenu",f=>{f.stopPropagation(),f.preventDefault()}),(r=this._rootElement)===null||r===void 0||r.addEventListener("touchend",f=>{if(f.stopPropagation(),f.preventDefault(),f.target.classList.contains(Of)||this._rootElement.classList.contains(Nr))return;const{col:g,row:m,dropDownIndex:p,menuKey:v,text:b,hasChildren:C}=f.target;if(typeof p!="number"||C)return void f.stopPropagation();const y=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,m):t.getHeaderField(g,m),w=t._dropDownMenuIsHighlight(g,m,p);t.fireListeners(ut.DROPDOWN_MENU_CLICK,{col:g,row:m,field:y,menuKey:v,text:b,highlight:w,cellLocation:t.getCellLocation(g,m),event:f}),t.fireListeners(ut.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ut.HIDE_MENU,null),f.stopPropagation()}),(o=this._rootElement)===null||o===void 0||o.addEventListener("click",f=>{if(f.stopPropagation(),f.preventDefault(),f.target.classList.contains(Of)||this._rootElement.classList.contains(Nr))return;const{col:g,row:m,dropDownIndex:p,menuKey:v,text:b,hasChildren:C}=f.target;if(typeof p!="number"||C)return void f.stopPropagation();const y=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,m):t.getHeaderField(g,m),w=t._dropDownMenuIsHighlight(g,m,p);t.fireListeners(ut.DROPDOWN_MENU_CLICK,{col:g,row:m,field:y,menuKey:v,text:b,highlight:w,cellLocation:t.getCellLocation(g,m),event:f}),t.fireListeners(ut.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ut.HIDE_MENU,null),f.stopPropagation()}),(s=this._rootElement)===null||s===void 0||s.addEventListener("mousemove",f=>{var g,m;if(this._rootElement.classList.contains(Nr))return;f.stopPropagation();const{hasChildren:p,dropDownIndex:v,col:b,row:C,sub:y}=f.target;if(p){this._showChildrenIndex=v;const w=this._secondElement;w==null||w.classList.remove(Nr),w==null||w.classList.add(Ko),w.innerHTML="";const _=(g=this._menuInstanceInfo.content[v])===null||g===void 0?void 0:g.children;for(let T=0;T<_.length;T++){const S=_[T],x=fM(S,!!t.stateManager.menu.dropDownMenuHighlight&&kh(t,t.stateManager.menu.dropDownMenuHighlight,typeof S=="object"?(S==null?void 0:S.menuKey)||(S==null?void 0:S.text):S,b,C));x.col=b,x.row=C,x.dropDownIndex=T,typeof S=="string"?(x.text=S,x.menuKey=S):typeof S=="object"&&(x.text=S.text,x.menuKey=S.menuKey||S.text),x.sub=!0,x.sub=!0,w.appendChild(x)}const A=f.target.getBoundingClientRect();this._bindSecondElement(t,b,C,A.right,A.top)}else if(p&&this._showChildrenIndex===v){const w=this._secondElement;w==null||w.classList.remove(Nr),w==null||w.classList.add(Ko)}else!y&&(!((m=this._secondElement)===null||m===void 0)&&m.classList.contains(Ko))&&setTimeout(()=>{if(this._mouseEnterSecondElement!==!0){this._showChildrenIndex=-1;const w=this._secondElement;w==null||w.classList.remove(Ko),w==null||w.classList.add(Nr)}},300)}),(a=this._secondElement)===null||a===void 0||a.addEventListener("wheel",f=>{f.stopPropagation()}),(l=this._secondElement)===null||l===void 0||l.addEventListener("mousemove",f=>{this._rootElement.classList.contains(Nr)||f.stopPropagation()}),(u=this._secondElement)===null||u===void 0||u.addEventListener("mouseenter",f=>{this._mouseEnterSecondElement=!0}),(h=this._secondElement)===null||h===void 0||h.addEventListener("mouseleave",f=>{this._mouseEnterSecondElement=!1}),(d=this._secondElement)===null||d===void 0||d.addEventListener("mousedown",f=>{f.stopPropagation(),f.preventDefault()}),(c=this._secondElement)===null||c===void 0||c.addEventListener("click",f=>{if(f.stopPropagation(),f.preventDefault(),f.target.classList.contains(Of)||this._secondElement.classList.contains(Nr))return;const{col:g,row:m,dropDownIndex:p,menuKey:v,text:b,hasChildren:C}=f.target;if(typeof p!="number"||C)return void f.stopPropagation();const y=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,m):t.getHeaderField(g,m);let w=!1;this._menuInstanceInfo.content.forEach((_,A)=>{if(typeof _=="object"&&_.children&&_.children.length)for(let T=0;T<_.children.length;T++){const S=_.children[T];if(kh(t,t.stateManager.menu.dropDownMenuHighlight,typeof S=="object"?S==null?void 0:S.menuKey:S,g,m)&&v===(typeof S=="object"?S==null?void 0:S.menuKey:S))return void(w=!0)}}),t.fireListeners(ut.DROPDOWN_MENU_CLICK,{col:g,row:m,field:y,cellHeaderPaths:t.isPivotTable()?t.getCellHeaderPaths(g,m):void 0,menuKey:v,text:b,highlight:w,cellLocation:t.getCellLocation(g,m),event:f}),t.fireListeners(ut.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ut.HIDE_MENU,null),f.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();const t=this._rootElement;t!=null&&t.parentElement&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){var o,s;const a=this._rootElement,l=this._secondElement;if(this._menuInstanceInfo=r,a==null||a.classList.remove(Ko),a==null||a.classList.add(Nr),l==null||l.classList.remove(Ko),l==null||l.classList.add(Nr),this._canBindToCell(t,e,i)){if(a.innerHTML="",Array.isArray(r.content)){const u=r.content;for(let h=0;(o=h<(u==null?void 0:u.length))!==null&&o!==void 0&&o;h++){const d=u[h];let c=!!t.stateManager.menu.dropDownMenuHighlight&&kh(t,t.stateManager.menu.dropDownMenuHighlight,typeof d=="object"?(d==null?void 0:d.menuKey)||(d==null?void 0:d.text):d,e,i);if(t.stateManager.menu.dropDownMenuHighlight&&typeof d=="object"&&Array.isArray(d.children)&&d.children.length)for(let g=0;g<d.children.length;g++){const m=d.children[g];if(kh(t,t.stateManager.menu.dropDownMenuHighlight,typeof m=="object"?(m==null?void 0:m.menuKey)||(m==null?void 0:m.text):m,e,i)){c=!0;break}}const f=fM(d,c);f.col=e,f.row=i,f.dropDownIndex=h,typeof d=="string"?(f.text=d,f.menuKey=d):typeof d=="object"&&(f.text=d.text,f.menuKey=d.menuKey||d.text,!((s=d.children)===null||s===void 0)&&s.length&&(f.hasChildren=!0)),a.appendChild(f)}}if(this._bindToCell(t,e,i,r.position,r.referencePosition))return a==null||a.classList.add(Ko),a==null||a.classList.remove(Nr),!0}else this.unbindFromCell();return!1}unbindFromCell(){const t=this._rootElement,e=this._secondElement;this._menuInstanceInfo=void 0,t!=null&&t.parentElement&&(t.classList.remove(Ko),t.classList.add(Nr)),e!=null&&e.parentElement&&(e.classList.remove(Ko),e.classList.add(Nr))}_canBindToCell(t,e,i){var r;const o=t.getCellRangeRelativeRect({col:e,row:i}),s=(r=t.internalProps.menu.parentElement)!==null&&r!==void 0?r:t.getElement(),{top:a,bottom:l,left:u,right:h}=o;if(t.isFrozenCell(e,i))return!0;if(l<t.getFrozenRowsHeight()||h<t.getFrozenColsWidth()||u>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||a>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:d,offsetWidth:c}=s;return!(d<a)&&!(c<u)}_bindToCell(t,e,i,r,o){var s;const a=this._rootElement,l=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:u,height:h,left:d,top:c}=l.getBoundingClientRect();if(a){a.parentElement!==l&&l.appendChild(a),a.style.left="0px";const f=.8*u;a.style.maxWidth=`${f}px`;const g=a.offsetWidth,m=a.offsetHeight;let p,v;r?(p=r.x,v=r.y):o&&(p=o.rect.right-g,v=o.rect.bottom);const b=l.getBoundingClientRect(),C=b.width/l.offsetWidth,y=b.height/l.offsetHeight;v*y+m>h&&(v=(h-m)/y),v<0&&(v/=2);let w=0,_=0;if(t.getElement()!==l){const{left:A,top:T}=t.getElement().getBoundingClientRect();w=T-c,_=A-d}return a.style.top=`${v+w}px`,p<0?p=0:p*C+g>u&&(p=(u-g)/C),a.style.left=`${p+_}px`,!0}return!1}_bindSecondElement(t,e,i,r,o){var s;const a=this._secondElement,l=this._rootElement,u=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:h,height:d,left:c,top:f}=u.getBoundingClientRect(),{x:g,y:m,width:p,height:v}=l.getBoundingClientRect();if(a){a.parentElement!==u&&u.appendChild(a),a.style.left="0px";const b=.8*h;a.style.maxWidth=`${b}px`;const C=a.clientWidth,y=a.clientHeight,w=r-c;let _=o-4-f;_+y>d&&(_=_-y+a.firstElementChild.clientHeight+4),a.style.top=`${_}px`;let A=w;return A+C>h?A=A-C-p:A+=4,a.style.left=`${A}px`,!0}return!1}pointInMenuElement(t,e){const i=this._rootElement,{x:r,y:o,width:s,height:a}=i.getBoundingClientRect();if(t>r-5&&t<r+s+5&&e>o-5&&e<o+a+5)return!0;const l=this._secondElement;if(l){const{x:u,y:h,width:d,height:c}=l.getBoundingClientRect();if(t>u-5&&t<u+d+5&&e>h-5&&e<h+c+5)return!0}return!1}}function fM(n,t){var e,i,r;const o=wo("div",[Zit,t?Jit:Qit]);if(typeof n=="object"&&n.disabled&&o.classList.add(Of),typeof n=="string"){const s=wo("span",[Ob,Ch,dM]);s.innerHTML=n,o.appendChild(s)}else if(typeof n=="object"){const s=(e=n.type)!==null&&e!==void 0?e:"item";if(s==="split")return o==null||o.classList.add(ert),o;if(!((i=n==null?void 0:n.icon)===null||i===void 0)&&i.svg)if(Xw.test(n.icon.svg)){const l=new Image;n.icon.width?l.style.width=n.icon.width.toString()+"px":l.style.width="16px",n.icon.height?l.style.height=n.icon.height.toString()+"px":l.style.height="16px",l.src=n.icon.svg,o.appendChild(l)}else{const l=wo("span",[trt,Ch]);l.innerHTML=t&&n.selectedIcon&&n.selectedIcon.svg?n.selectedIcon.svg:n.icon.svg,n.icon.width&&l.children[0].setAttribute("width",n.icon.width.toString()),n.icon.height&&l.children[0].setAttribute("height",n.icon.height.toString()),o.appendChild(l)}const a=wo("span",[Ob,Ch,dM]);if(a.innerHTML=n.text,o.appendChild(a),s==="title")o==null||o.classList.add(Ch,irt);else if(!((r=n==null?void 0:n.children)===null||r===void 0)&&r.length){const l=wo("span",[Ob,Ch,rrt]);l.innerHTML=t?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',o.appendChild(l)}}return o}let gM;const ort={CHANGE_STYLE:"change_style"};class il extends Km{static get EVENT_TYPE(){return ort}static get DEFAULT(){return gM||(gM=new il)}constructor(t={},e={}){var i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N;super(),this._defaultPadding=[10,16,10,16],this._color=(i=t.color)!==null&&i!==void 0?i:e==null?void 0:e.color,this._strokeColor=(r=t==null?void 0:t.strokeColor)!==null&&r!==void 0?r:e==null?void 0:e.strokeColor,this._fontSize=(o=t.fontSize)!==null&&o!==void 0?o:e==null?void 0:e.fontSize,this._fontFamily=(s=t.fontFamily)!==null&&s!==void 0?s:e==null?void 0:e.fontFamily,this._fontWeight=(a=t.fontWeight)!==null&&a!==void 0?a:e==null?void 0:e.fontWeight,this._fontVariant=(l=t.fontVariant)!==null&&l!==void 0?l:e==null?void 0:e.fontVariant,this._fontStyle=(u=t.fontStyle)!==null&&u!==void 0?u:e==null?void 0:e.fontStyle,this._textOverflow=((h=t.textOverflow)!==null&&h!==void 0?h:e==null?void 0:e.textOverflow)||"ellipsis",this._textStick=(c=(d=t.textStick)!==null&&d!==void 0?d:e==null?void 0:e.textStick)!==null&&c!==void 0&&c,this._textStickBaseOnAlign=(g=(f=t.textStickBaseOnAlign)!==null&&f!==void 0?f:e==null?void 0:e.textStickBaseOnAlign)!==null&&g!==void 0&&g,this._marked=(p=(m=t.marked)!==null&&m!==void 0?m:e==null?void 0:e.marked)!==null&&p!==void 0&&p,this._textAlign=((v=t.textAlign)!==null&&v!==void 0?v:e==null?void 0:e.textAlign)||"left",this._textBaseline=((b=t.textBaseline)!==null&&b!==void 0?b:e==null?void 0:e.textBaseline)||"middle",this._bgColor=(C=t.bgColor)!==null&&C!==void 0?C:e==null?void 0:e.bgColor,this._padding=(w=(y=t.padding)!==null&&y!==void 0?y:e==null?void 0:e.padding)!==null&&w!==void 0?w:this._defaultPadding,this._borderColor=(_=t.borderColor)!==null&&_!==void 0?_:e==null?void 0:e.borderColor,this._lineHeight=(A=t.lineHeight)!==null&&A!==void 0?A:e==null?void 0:e.lineHeight,this._underline=(T=t.underline)!==null&&T!==void 0?T:e==null?void 0:e.underline,this._underlineColor=(S=t.underlineColor)!==null&&S!==void 0?S:e==null?void 0:e.underlineColor,this._underlineDash=(x=t.underlineDash)!==null&&x!==void 0?x:e==null?void 0:e.underlineDash,this._underlineOffset=(E=t.underlineOffset)!==null&&E!==void 0?E:e==null?void 0:e.underlineOffset,this._lineThrough=(M=t.lineThrough)!==null&&M!==void 0?M:e==null?void 0:e.lineThrough,this._lineThroughColor=(L=t.lineThroughColor)!==null&&L!==void 0?L:e==null?void 0:e.lineThroughColor,this._lineThroughDash=(I=t.lineThroughDash)!==null&&I!==void 0?I:e==null?void 0:e.lineThroughDash,this._linkColor=(D=t.linkColor)!==null&&D!==void 0?D:e==null?void 0:e.linkColor,this._cursor=(H=t.cursor)!==null&&H!==void 0?H:e==null?void 0:e.cursor,this._borderLineWidth=(O=t.borderLineWidth)!==null&&O!==void 0?O:e==null?void 0:e.borderLineWidth,this._borderLineDash=(N=t.borderLineDash)!==null&&N!==void 0?N:e==null?void 0:e.borderLineDash}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get padding(){var t;return(t=this._padding)!==null&&t!==void 0?t:this._defaultPadding}set padding(t){this._padding=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get marked(){return this._marked}set marked(t){this._marked=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}clone(){return new il(this)}}let pM;class tm extends il{static get DEFAULT(){return pM||(pM=new tm)}constructor(t={},e={}){var i;super(t,e),this.textAlign=((i=t.textAlign)!==null&&i!==void 0?i:e==null?void 0:e.textAlign)||"center"}clone(){return new tm(this)}}let mM;class em extends il{static get DEFAULT(){return mM||(mM=new em)}constructor(t={},e=null){var i,r;super(t,e),this._autoWrapText=(i=t==null?void 0:t.autoWrapText)!==null&&i!==void 0?i:e==null?void 0:e.autoWrapText,this._lineClamp=(r=t==null?void 0:t.lineClamp)!==null&&r!==void 0?r:e==null?void 0:e.lineClamp}clone(){return new em(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let vM;class qa extends il{static get DEFAULT(){return vM||(vM=new qa)}constructor(t={},e={},i={}){var r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S;super(t,e),this._size=((o=(r=t==null?void 0:t.size)!==null&&r!==void 0?r:e==null?void 0:e.size)!==null&&o!==void 0?o:i==null?void 0:i.size)||14,this._spaceBetweenTextAndIcon=((a=(s=t==null?void 0:t.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e==null?void 0:e.spaceBetweenTextAndIcon)!==null&&a!==void 0?a:i==null?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=(u=(l=t==null?void 0:t.checkboxStyle)===null||l===void 0?void 0:l.defaultFill)!==null&&u!==void 0?u:i==null?void 0:i.defaultFill,this._defaultStroke=(d=(h=t==null?void 0:t.checkboxStyle)===null||h===void 0?void 0:h.defaultStroke)!==null&&d!==void 0?d:i==null?void 0:i.defaultStroke,this._disableFill=(f=(c=t==null?void 0:t.checkboxStyle)===null||c===void 0?void 0:c.disableFill)!==null&&f!==void 0?f:i==null?void 0:i.disableFill,this._checkedFill=(m=(g=t==null?void 0:t.checkboxStyle)===null||g===void 0?void 0:g.checkedFill)!==null&&m!==void 0?m:i==null?void 0:i.checkedFill,this._checkedStroke=(v=(p=t==null?void 0:t.checkboxStyle)===null||p===void 0?void 0:p.checkedStroke)!==null&&v!==void 0?v:i==null?void 0:i.checkedStroke,this._disableCheckedFill=(C=(b=t==null?void 0:t.checkboxStyle)===null||b===void 0?void 0:b.disableCheckedFill)!==null&&C!==void 0?C:i==null?void 0:i.disableCheckedFill,this._disableCheckedStroke=(w=(y=t==null?void 0:t.checkboxStyle)===null||y===void 0?void 0:y.disableCheckedStroke)!==null&&w!==void 0?w:i==null?void 0:i.disableCheckedStroke,this._checkIconImage=(A=(_=t==null?void 0:t.checkboxStyle)===null||_===void 0?void 0:_.checkIconImage)!==null&&A!==void 0?A:i==null?void 0:i.checkIconImage,this._indeterminateIconImage=(S=(T=t==null?void 0:t.checkboxStyle)===null||T===void 0?void 0:T.indeterminateIconImage)!==null&&S!==void 0?S:i==null?void 0:i.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new qa(t,this)}clone(){return new qa(this)}}function Hf(n,t,e,i,r,o){var s;return n||t?n instanceof il?n:typeof n=="function"?Hf(n(e),t,e,i,r,o):(n||(n={}),r&&!et(n.autoWrapText)&&(n.autoWrapText=!0),i===qa?new qa(n??{},t??{},(s=o.checkboxStyle)!==null&&s!==void 0?s:{}):new i(n??{},t??{})):i.DEFAULT}class srt{constructor(t){this._table=t;const e=Fn();this.freezeIcon=e[ir.freezeIconName],this.frozenIcon=e[ir.frozenIconName],this.frozenCurrentIcon=e[ir.frozenCurrentIconName],this.normalIcon=e[ir.normalIconName],this.upIcon=e[ir.upwardIconName],this.downIcon=e[ir.downwardIconName],this.dropDownAbsoluteIcon=e[ir.dropdownIconName],this.expandIcon=e[ir.expandIconName],this.collapseIcon=e[ir.collapseIconName]}getIcons(t,e){const i=[];if(this._table.isPivotTable()){const{showSort:a,sort:l}=this._table.internalProps.layoutMap.getHeader(t,e);let u;if(u=typeof a=="function"?a({col:t,row:e,table:this._table}):a,u){let h=this._table.getPivotSortState(t,e);h&&(h=h.toUpperCase());const d=h==="ASC"?this.upIcon:h==="DESC"?this.downIcon:this.normalIcon;d&&i.push(d)}else if(l){const h=this.getSortIconForPivotTable(this._table.getPivotSortState(t,e),this._table,t,e);h&&i.push(h)}}else{const a=this._table.sortState;let l;l=void 0;const u=this._table.getCellRange(t,e);if(a)if(Array.isArray(a))for(let d=0;d<a.length;d++){const c=a[d],f=this._table._getHeaderCellBySortState(c);if(f&&Ln(u,f.col,f.row)){({order:l}=c);break}}else{const d=this._table._getHeaderCellBySortState(a);d&&Ln(u,d.col,d.row)&&({order:l}=a)}const h=this.getSortIcon(l,this._table,t,e);h&&i.push(h)}if(this._table.showFrozenIcon&&t<this._table.allowFrozenColCount){const a=this.getFrozenIcon(t,e);a&&i.push(a)}if(this.checkDropDownIcon(this._table,t,e)){const a=this.dropDownAbsoluteIcon;i.push(a)}const r=this.getDropDownStateIcons(this._table,t,e);r.length&&i.push(...r);const{headerIcon:o}=this._table._getHeaderLayoutMap(t,e),s=this.getHierarchyIcon(t,e);if(s&&i.push(s),o){let a;typeof o=="function"?a=o({col:t,row:e,value:this._table.getCellValue(t,e),dataValue:this._table.getCellOriginValue(t,e),table:this._table}):a=o;const l=Fn(),u=h=>{let d;d=typeof h=="string"?l[h]:h,d&&i.push(d)};Array.isArray(a)?a.forEach((h,d)=>{u(h)}):u(a)}return i}getFrozenIcon(t,e){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&t>=this._table.colCount-this._table.rightFrozenColCount)return null;const i=this._table.getHeaderDefine(t,e);if(i.columns&&i.columns.length>0)return null;let r=this.freezeIcon;return this._table.options.frozenColCount-1>t?r=this.frozenIcon:this._table.options.frozenColCount-1===t&&(r=this.frozenCurrentIcon),r}getSortIcon(t,e,i,r){const o=t==="asc"?this.upIcon:t==="desc"?this.downIcon:this.normalIcon,s=e.getHeaderDefine(i,r);let a;return s&&(a=typeof s.showSort=="function"?s.showSort({col:i,row:r,table:this._table}):s.showSort),!s||a===!1||!et(a)&&!s.sort||s.columns&&s.columns.length>0?null:o}getSortIconForPivotTable(t,e,i,r){const o=e.getHeaderDefine(i,r);let s;return o&&(s=typeof o.showSort=="function"?o.showSort({col:i,row:r,table:this._table}):o.showSort),!o||s===!1||!et(s)&&!o.sort||o.columns&&o.columns.length>0?null:(t==null?void 0:t.toUpperCase())==="ASC"?this.upIcon:(t==null?void 0:t.toUpperCase())==="DESC"?this.downIcon:this.normalIcon}getDropDownStateIcons(t,e,i){var r,o,s;const a=t.getHeaderDefine(e,i),l=t._getHeaderLayoutMap(e,i);let{dropDownMenu:u}=l;typeof u=="function"&&(u=u({row:i,col:e,table:t}));let h=t.globalDropDownMenu;typeof h=="function"&&(h=h({row:i,col:e,table:t}));const d=[];if(Array.isArray(u)&&u.length||Array.isArray(h)&&h.length&&!(!((r=a==null?void 0:a.columns)===null||r===void 0)&&r.length)){const c=u||h;let f=-1,g=-1;for(let m=0;m<c.length;m++){const p=c[m];if(typeof p=="object"&&p.children&&p.children.length)for(let v=0;v<p.children.length;v++){const b=p.children[v];if(!((o=t.stateManager.menu)===null||o===void 0)&&o.dropDownMenuHighlight&&kh(t,(s=t.stateManager.menu)===null||s===void 0?void 0:s.dropDownMenuHighlight,typeof b=="object"?b==null?void 0:b.menuKey:b,e,i)){f=m,g=v;break}}if(t._dropDownMenuIsHighlight(e,i,m)){f=m;break}}if(f!==-1){let m;m=g!==-1?c[f].children[g]:c[f],m.stateIcon&&(m.stateIcon.svg?d.push({type:"svg",name:m.stateIcon.src||m.stateIcon.svg,width:m.stateIcon.width||22,height:m.stateIcon.height||22,svg:m.stateIcon.svg,positionType:Be.right,marginRight:0,funcType:Pe.dropDownState,interactive:!1}):m.stateIcon.src&&d.push({type:"image",name:m.stateIcon.src||m.stateIcon.svg,width:m.stateIcon.width||22,height:m.stateIcon.height||22,src:m.stateIcon.src,positionType:Be.right,marginRight:0,funcType:Pe.dropDownState,interactive:!1}))}}return d}getDropDownIconRect(t,e,i){var r,o,s,a,l,u,h,d;const c=(a=(o=(r=this.downIcon.hover)===null||r===void 0?void 0:r.width)!==null&&o!==void 0?o:(s=this.downIcon)===null||s===void 0?void 0:s.width)!==null&&a!==void 0?a:0,f=(d=(u=(l=this.downIcon.hover)===null||l===void 0?void 0:l.height)!==null&&u!==void 0?u:(h=this.downIcon)===null||h===void 0?void 0:h.height)!==null&&d!==void 0?d:0,g=t.right-2-c,m=t.right-2;let p;return p=i==="middle"?t.top+t.height/2-c/2:i==="top"?t.top+e/2:i==="bottom"?t.bottom-2*e:t.top,{left:g,right:m,top:p,bottom:f+p,width:c,height:f}}getHierarchyIcon(t,e){const{hierarchyState:i}=this._table._getHeaderLayoutMap(t,e);if(i){if(i===Yt.expand)return this.expandIcon;if(i===Yt.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+((t=this.expandIcon.marginLeft)!==null&&t!==void 0?t:0)+((e=this.expandIcon.marginRight)!==null&&e!==void 0?e:0)}checkDropDownIcon(t,e,i){var r;if(t.isPivotTable()){let o=t._getHeaderLayoutMap(e,i).dropDownMenu;if(typeof o=="function"&&(o=o({row:i,col:e,table:t})),Array.isArray(o)&&o.length)return!0}else{const o=t.getHeaderDefine(e,i),s=o.dropDownMenu;let a=t.globalDropDownMenu;if(typeof a=="function"&&(a=a({row:i,col:e,table:t})),Array.isArray(s)&&s.length||(!Array.isArray(o.dropDownMenu)||o.dropDownMenu.length!==0)&&Array.isArray(a)&&a.length&&!(!((r=o==null?void 0:o.columns)===null||r===void 0)&&r.length))return!0}return!1}getStyleClass(t){switch(t){case"text":case"link":return em;case"image":case"video":return tm;case"checkbox":return qa}}setTableColumnsEditor(){const t=(e,i)=>{e==null||e.forEach((r,o)=>{r.editor&&(i[o].editor=r.editor),r.columns&&t(r.columns,i[o].columns)})};t(this._table.options.columns,this._table.internalProps.columns)}}class bM extends EventTarget{constructor(t,e){if(super(),this._table=t,be.mode==="node")return;const i=document.createElement("div");i.style.opacity="0",i.dataset.vtable="vtable",i.style.pointerEvents="none",i.classList.add("input-container");const r=this._input=document.createElement("input");i.appendChild(r),r.classList.add("table-focus-control"),r.dataset.vtable="vtable",r.readOnly=!0,e.appendChild(i),this._container=i}focus(){this._input.focus({preventScroll:!0})}setFocusRect(t,e){const i=this._input;i.value=e,i.select();const r=t.top-this._table.scrollTop,o=t.left-this._table.scrollLeft;i.style.top=`${r.toFixed()}px`,i.style.left=`${o.toFixed()}px`,i.style.width=`${t.width.toFixed()}px`,i.style.height=`${t.height.toFixed()}px`}get input(){return this._input}release(){var t;(t=this._container.parentElement)===null||t===void 0||t.removeChild(this._container)}}class _M{constructor(t){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=t}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}add(t,e){if(!et(e))return;const i=this.table.getRowHeight(t);this.data.has(t)||(this._keys.push(t),this._sorted=!1),this.data.set(t,e),this.totalSum+=e,this.updateDifference(t,e-i)}remove(t){if(this.data.has(t)){const e=this.data.get(t);this.data.delete(t);const i=this._keys.indexOf(t);i!==-1&&this._keys.splice(i,1),this.totalSum-=e;const r=this.table.getRowHeight(t);this.updateDifference(t,r-e)}}put(t,e){if(et(e))if(this.data.has(t)){const i=this.data.get(t);if(i===e)return;this.data.set(t,e);const r=e-i;this.totalSum+=r,this.updateDifference(t,r)}else this.add(t,e)}get(t){return this.data.get(t)}has(t){return this.data.has(t)}_sort(){const{_keys:t}=this;this._sorted||(t.sort((e,i)=>e<i?-1:e>i?1:0),this._sorted=!0)}updateDifference(t,e){var i;const r=(i=this.difference.get(t))!==null&&i!==void 0?i:0;this.difference.set(t,r+e),this.update()}getSumInRange(t,e){return this.calculatePrefixSum(e)-this.calculatePrefixSum(t-1)}updateCumulativeSum(t,e){for(const[i,r]of this.cumulativeSum)i>=t&&this.cumulativeSum.set(i,r+e)}calculatePrefixSum(t){if(t<0)return 0;if(this.cumulativeSum.has(t)){let e=this.cumulativeSum.get(t);for(const[i,r]of this.difference)i<=t&&(e+=r);return e}return this.dealDiffenence(),this.getCumulativeSum(t)}getCumulativeSum(t){var e,i;let r=0,o=0,s=!1;const a=this.table.rowCount>0&&this.table.bottomFrozenRowCount>0?this.table.rowCount-this.table.bottomFrozenRowCount:-1;for(let l=t;l>=0;l--){if(this.cumulativeSum.has(l)){r+=this.cumulativeSum.get(l);break}r+=(e=this.data.get(l))!==null&&e!==void 0?e:this.table.getRowHeight(l),l>=a&&a!==-1&&(o=r,s=l===a)}if(s&&(!((i=this.table.containerFit)===null||i===void 0)&&i.height)&&this.table.bottomFrozenRowCount){const l=this.table.tableNoFrameHeight||0;r<l&&(r=l-this.table.getBottomFrozenRowsHeight()+o)}return this.cumulativeSum.set(t,r),r}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(const[t]of this.cumulativeSum)for(const[e,i]of this.difference)if(t>=e){const r=this.cumulativeSum.get(t);this.cumulativeSum.set(t,r+i)}this.difference.clear()}insert(t,e){for(let r=t;r<=this.getLastIndex();r++)this.cumulativeSum.delete(r);const i=this.getLastIndex()+1;this.adjustOrder(t,t+1,i-t),et(e)&&this.put(t,e)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){const t=this.getLastIndex();this.remove(t)}delete(t){if(!this.has(t))return;for(let i=t;i<=this.getLastIndex();i++)this.cumulativeSum.delete(i);const e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}adjustOrder(t,e,i){this.clearRange(),this._sort();const{_keys:r}=this;if(t>e){const s=[];for(let a=Tl(r,t+i-1);a>=0;a--){const l=r[a];if(l>=t)s.push(this.get(l));else if(e<=l&&l<t)this.put(l+i,this.get(l));else if(l<e)break}for(let a=0;a<i;a++)this.put(e+a,s[i-1-a])}const{length:o}=r;if(t<e){const s=[];for(let a=Tl(r,t);a<o;a++){const l=r[a];if(l>=t&&l<t+i)s.push(this.get(l));else if(t+i<=l&&l<=e)this.put(l-i,this.get(l));else if(l>e)break}for(let a=0;a<i;a++)this.put(e+a,s[a])}}exchangeOrder(t,e,i,r,o){const{_keys:s}=this;if(this._sorted||(s.sort((a,l)=>a<l?-1:a>l?1:0),this._sorted=!0),t>i){const a=[],l=[];for(let u=Tl(s,i);u<Tl(s,t)+e;u++){const h=s[u];h>=t&&h<t+e?l.push(this.get(h)):a.push(this.get(h))}for(let u=0;u<e;u++)this.put(o+u,l[u]);for(let u=0;u<a.length;u++)this.put(o+e+u,a[u])}else{const a=[],l=[];for(let u=Tl(s,t);u<Tl(s,i)+r;u++){const h=s[u];h>=t&&h<t+e?l.push(this.get(h)):a.push(this.get(h))}for(let u=0;u<e;u++)this.put(o+u,l[u]);for(let u=0;u<a.length;u++)this.put(t+u,a[u])}}}function Tl(n,t){let e=0,i=n.length-1;for(;e<=i;){const r=Math.floor((e+i)/2);if(n[r]===t)return r;n[r]>t?i=r-1:e=r+1}return i<0?0:i}class art{constructor(t){this._table=t;const e=Fn();this.dragReorderIconName=e[ir.dragReorderIconName]}getIcons(t,e){return[this.dragReorderIconName]}}class lrt{constructor(t,e,i="grid",r=void 0){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:"",value:"",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new Os,this.dimensionKeysIncludeVirtual=new Os,this.cache=new Map,this.sizeIncludeParent=r!=null,this.setExpandLevel=r,this.hierarchyType=i,this.sharedVar=e,this.reset(t)}reset(t){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new Os,this.dimensionKeysIncludeVirtual=new Os,this.tree.children=t,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(t,e,i){var r,o,s,a;t.startIndex=e,t.startInTotal=((r=i.startInTotal)!==null&&r!==void 0?r:0)+t.startIndex,t.hide&&(this.hasHideNode=!0),((o=t.dimensionKey)!==null&&o!==void 0?o:t.indicatorKey)&&(t.virtual||this.dimensionKeys.contain(t.indicatorKey?uf:t.dimensionKey)||this.dimensionKeys.put(t.level,t.indicatorKey?uf:t.dimensionKey),this.dimensionKeysIncludeVirtual.contain(t.indicatorKey?uf:t.dimensionKey)||this.dimensionKeysIncludeVirtual.put(t.level,t.indicatorKey?uf:t.dimensionKey),t.id||(t.id=++this.sharedVar.seqId));let l=t.dimensionKey&&this.sizeIncludeParent?1:0;const u=t.children||t.columns;return this.hierarchyType==="grid"||this.hierarchyType===null?(u==null?void 0:u.length)>=1?u.forEach(h=>{var d,c,f;h.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.hierarchyType==="grid"&&(h.afterSpanLevel=((c=t.afterSpanLevel)!==null&&c!==void 0?c:0)+((f=t.levelSpan)!==null&&f!==void 0?f:1)),this.totalLevel=Math.max(this.totalLevel,h.level+1),l+=this.setTreeNode(h,l,t)}):l=t.level===-1?0:1:t.hierarchyState===Yt.expand&&(u==null?void 0:u.length)>=1?u.forEach(h=>{var d;h.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,h.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,h.level+1),l+=this.setTreeNode(h,l,t)}):t.hierarchyState===Yt.collapse&&(u==null?void 0:u.length)>=1?u.forEach(h=>{var d;h.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,h.level+1),this.setTreeNode(h,l,t)}):!t.hierarchyState&&t.level+1<this.setExpandLevel&&((u==null?void 0:u.length)>=1||u===!0)?(!((s=u[0])===null||s===void 0)&&s.indicatorKey&&this.hierarchyType==="grid-tree"||(t.hierarchyState=Yt.expand),(u==null?void 0:u.length)>=1&&u.forEach(h=>{var d;h.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,h.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,h.level+1),l+=this.setTreeNode(h,l,t)})):(u==null?void 0:u.length)>=1||u===!0?(!((a=u[0])===null||a===void 0)&&a.indicatorKey&&this.hierarchyType==="grid-tree"||(t.hierarchyState=Yt.collapse),(u==null?void 0:u.length)>=1&&u.forEach(h=>{var d;h.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,h.level+1),this.setTreeNode(h,l,t)})):(t.hierarchyState=Yt.none,l=t.level===-1?0:1),t.size=l,l}getTreePath(t,e=30){const i=[];return this.searchPath(t,this.tree,i,e),i.shift(),i}findNodeById(t,e){return t.find(i=>i.id===e)}searchPath(t,e,i,r){if(!e||t<e.startIndex||t>=e.startIndex+e.size||(i.push(e),!e.children||e.children.length===0||e.level>=r))return;const o=t-e.startIndex;if(this.cache.has(e.level+1)){const l=this.cache.get(e.level+1);if(o>=l.startIndex&&o<l.startIndex+l.size)return void this.searchPath(o,l,i,r)}let s=0,a=e.children.length-1;for(;s<=a;){const l=Math.floor((s+a)/2),u=e.children[l];if(o>=u.startIndex&&o<u.startIndex+u.size){this.cache.set(u.level,u);const h=[];this.cache.forEach((d,c)=>{c>u.level&&h.push(c)}),h.forEach(d=>{this.cache.delete(d)}),this.searchPath(o,u,i,r);break}o<u.startIndex?a=l-1:s=l+1}}movePosition(t,e,i){let r,o,s;const a=(h,d)=>{if(o!==void 0&&s!==void 0)return;h.level===t&&(h.startInTotal===e&&(o=d),h.startInTotal<=i&&i<=h.startInTotal+h.size-1&&(s=d));const c=h.children||h.columns;if(c&&h.level<t){r=h;for(let f=0;f<c.length;f++)(e>=c[f].startInTotal&&e<=c[f].startInTotal+c[f].size||i>=c[f].startInTotal&&i<=c[f].startInTotal+c[f].size)&&a(c[f],f)}};a(this.tree,0);const l=r.children||r.columns,u=l.splice(o,1);u.unshift(s,0),Array.prototype.splice.apply(l,u)}getCopiedTree(){const t=al(this.tree.children);return ZI(t),t}setAllNodesState(t){this._updateNodeHierarchyState(this.tree,t)}_updateNodeHierarchyState(t,e){t.children&&t.children.length>0&&t.children[0].dimensionKey?(t.level!==-1&&(t.hierarchyState=e),t.children.forEach(i=>{this._updateNodeHierarchyState(i,e)})):t.hierarchyState=Yt.none}}function ZI(n){for(let t=0;t<n.length;t++){const e=n[t];delete e.level,delete e.startIndex,delete e.id,delete e.levelSpan,delete e.size,delete e.startInTotal;const i=e.children||e.columns;i&&ZI(i)}}function urt(n){const t=n.columnObjects;for(let e=0;e<t.length;e++){const i=t[e];if(i!=null&&i.aggregation)return!0}return!1}function hrt(n){const t=n.columnObjects;let e=0;for(let i=0;i<t.length;i++){const r=t[i];r!=null&&r.aggregation&&(Array.isArray(r==null?void 0:r.aggregation)?e=Math.max(e,r.aggregation.filter(o=>o.showOnTop).length):r.aggregation.showOnTop&&(e=Math.max(e,1)))}return e}function drt(n){const t=n.columnObjects;let e=0;for(let i=0;i<t.length;i++){const r=t[i];r!=null&&r.aggregation&&(Array.isArray(r==null?void 0:r.aggregation)?e=Math.max(e,r.aggregation.filter(o=>!o.showOnTop).length):r.aggregation.showOnTop||(e=Math.max(e,1)))}return e}function crt(n){if(n._table.options.groupBy)return!0;const{columns:t}=n._table.options;if(Wt(t)&&t.length>0)for(let e=0;e<t.length;e++){const i=t[e];if(!ei(i)&&i.tree)return!0}return!1}function frt(n){const{columns:t,rows:e,indicators:i}=n.options;if(n.isPivotTable()){if(Wt(t)&&t.length>0)for(let r=0;r<t.length;r++){const o=t[r];if(!ei(o)&&(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing)return!0}if(Wt(e)&&e.length>0)for(let r=0;r<e.length;r++){const o=e[r];if(!ei(o)&&(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing)return!0}if(Wt(i)&&i.length>0)for(let r=0;r<i.length;r++){const o=i[r];if(!ei(o)&&((o.cellType==="image"||o.cellType==="video"||typeof o.cellType=="function")&&o.imageAutoSizing||(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing))return!0}}else if(Wt(t)&&t.length>0)for(let r=0;r<t.length;r++){const o=t[r];if((o.cellType==="image"||o.cellType==="video"||typeof o.cellType=="function")&&o.imageAutoSizing||(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing)return!0}return!1}function QI(n,t){var e;return XQ(t,n)||((e=a1(n,t))!==null&&e!==void 0?e:{top:-1,row:-1,bottom:-1,height:-1})}function JI(n,t){var e;return YQ(t,n)||((e=s1(n,t))!==null&&e!==void 0?e:{left:-1,col:-1,right:-1,width:1})}function grt(n,t,e){const i=QI(t,e),{row:r,top:o,bottom:s,height:a}=i,l=JI(n,e),{col:u,left:h,right:d,width:c}=l;return{row:r,col:u,rect:{left:h,right:d,top:o,bottom:s,width:c,height:a}}}function s1(n,t){if(n===0)return{left:0,col:0,right:0,width:0};const e=mrt(n,t),i=t.getColsWidth(0,e);return n>=i?((r,o)=>{let s=o-t.getColWidth(r);const{colCount:a}=t.internalProps;for(let l=r;l<a;l++){const u=t.getColWidth(l),h=s+u;if(Math.round(s)<=Math.round(n)&&Math.round(n)<Math.round(h))return{left:s,col:l,right:h,width:u};s=h}return null})(e,i):((r,o)=>{let s=o;for(let a=r;a>=0;a--){const l=t.getColWidth(a),u=s-l;if(Math.round(u)<=Math.round(n)&&Math.round(n)<Math.round(s))return{left:u,col:a,right:s,width:l};s=u}return null})(e,i)}function a1(n,t){var e;if(n===0)return{top:0,row:0,bottom:0,height:0};const i=((e=t.options.customConfig)===null||e===void 0?void 0:e._disableColumnAndRowSizeRound)===!0?Math.floor:Math.round,r=prt(n,t),o=t.getRowsHeight(0,r);return n>=o?((s,a)=>{let l=a-t.getRowHeight(s);const{rowCount:u}=t.internalProps;for(let h=s;h<u;h++){const d=t.getRowHeight(h),c=l+d;if(i(l)<=i(n)&&i(n)<i(c))return{top:l,row:h,bottom:c,height:d};l=c}return null})(r,o):((s,a)=>{let l=a;for(let u=s;u>=0;u--){const h=t.getRowHeight(u),d=l-h;if(i(d)<=i(n)&&i(n)<i(l))return{top:d,row:u,bottom:l,height:h};l=d}return null})(r,o)}function tF(n,t,e){if(n===0)return{left:0,col:0,right:0,width:0};if(n-=e.tableX,t&&n>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&n<e.tableNoFrameWidth&&n<=e.getAllColsWidth()){for(let i=0;i<e.rightFrozenColCount;i++)if(n>e.tableNoFrameWidth-e.getColsWidth(e.colCount-i-1,e.colCount-1))return{col:e.colCount-i-1,left:void 0,right:void 0,width:void 0}}return s1(n,e)}function eF(n,t,e){if(n===0)return{top:0,row:0,bottom:0,height:0};if(n-=e.tableY,t&&n>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&n<e.tableNoFrameHeight){for(let i=0;i<e.rightFrozenColCount;i++)if(n>e.tableNoFrameHeight-e.getRowsHeight(e.rowCount-i-1,e.rowCount-1))return{row:e.rowCount-i-1,top:void 0,bottom:void 0,height:void 0}}return a1(n,e)}function prt(n,t){let e=t.defaultRowHeight;return t._rowRangeHeightsMap.get("$0$"+(t.rowCount-1))&&(e=t._rowRangeHeightsMap.get("$0$"+(t.rowCount-1))/t.rowCount),Math.min(Math.ceil(n/e),t.rowCount-1)}function mrt(n,t){if(t._colRangeWidthsMap.get("$0$"+(t.colCount-1))){let e=0,i=t.colCount-1;for(;i-e>1;){const r=Math.floor((e+i)/2);if(n<t._colRangeWidthsMap.get(`$0$${r}`))i=r;else{if(!(n>t._colRangeWidthsMap.get(`$0$${r}`)))return r;e=r}}return i}return Math.min(Math.ceil(n/t.internalProps.defaultColWidth),t.colCount-1)}function vrt(n,t,e){n-=e.tableX;let i=!1;(t-=e.tableY)>0&&t<e.getFrozenRowsHeight()&&(i=!0);let r=!1;n>0&&n<e.getFrozenColsWidth()&&(r=!0);let o=!1;t>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&t<e.tableNoFrameHeight&&t<=e.getAllRowsHeight()&&(o=!0);let s=!1;n>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&n<e.tableNoFrameWidth&&n<=e.getAllColsWidth()&&(s=!0);const a=tF((r||s?n:n+e.scrollLeft)+e.tableX,s,e),l=eF((i||o?t:t+e.scrollTop)+e.tableY,o,e);if(a&&l){const{row:u,top:h,bottom:d,height:c}=l,{col:f,left:g,right:m,width:p}=a;return{row:u,col:f,rect:{left:g,right:m,top:h,bottom:d,width:p,height:c}}}return{col:-1,row:-1}}function CM(n){return n.length===2&&Oa(n[0])&&Oa(n[1])&&n[1]>=n[0]}function yM(n){const t=n[1]-n[0],e=n[1]*n[0]<0;let i=n[0]<=0?0-n[0]:0,r=n[1]>0?n[1]-0:0;return t===0?n[0]<0?(i=1,r=0):n[0]>0&&(i=0,r=1):(i/=t,r/=t),{total:t,negative:i,positive:r,includeZero:e,domain:n,extendable_min:!0,extendable_max:!0}}function wM(n,t){const{positive:e,negative:i,extendable_min:r,extendable_max:o,domain:s}=n,{positive:a,negative:l,extendable_min:u,extendable_max:h,domain:d}=t;if(a>0){if(!u)return!1;let c=i/e;o&&(c=i/Math.max(e,a),s[1]=-s[0]/c),d[0]=-d[1]*c}else if(l>0){if(!h)return!1;let c=e/i;r&&(c=e/Math.max(i,i),s[0]=-s[1]/c),d[1]=-d[0]*c}return!0}function SM(n,t){const{extendable_min:e,extendable_max:i,domain:r}=n,{positive:o,negative:s,domain:a}=t;return(o!==0||s!==0)&&!(o>0&&!i)&&!(s>0&&!e)&&(r[0]=a[0],r[1]=a[1],!0)}function xM(n,t){const{positive:e,negative:i,extendable_max:r,domain:o}=n,{positive:s,negative:a,extendable_min:l,domain:u}=t;if(r&&l){const h=Math.max(i,a)/Math.max(e,s);o[1]=-o[0]/h,u[0]=-u[1]*h}else if(l){const h=i/e;u[0]=-u[1]*h}else{if(!r)return!1;{const h=a/s;o[1]=-o[0]/h}}return!0}function TM(n,t){const{extendable_min:e,domain:i}=n,{extendable_max:r,domain:o}=t;return!(!e||!r)&&(i[0]=-i[1],o[1]=-o[0],!0)}function brt(n,t){const e=[n.min,n.max],i=[t.min,t.max];if(!CM(e)||!CM(i))return;const r=yM(e),o=yM(i),{positive:s,negative:a,extendable_max:l,includeZero:u}=r,{positive:h,negative:d,extendable_max:c,includeZero:f}=o;if(s===0&&a===0){if(!SM(r,o))return}else if(h===0&&d===0){if(!SM(o,r))return}else if(u||f)if(u&&!f){if(!wM(r,o))return}else if(f&&!u){if(!wM(o,r))return}else{if(a===d)return;if(a>d){if(!xM(r,o))return}else if(!xM(o,r))return}else{if(a===0&&h===0){if(!TM(r,o))return}else if(d===0&&s===0&&!TM(o,r))return;if(a===0&&d===0)if(e[0]===0&&i[0]>0)i[0]=0;else{if(!(i[0]===0&&e[0]>0))return;e[0]=0}if(s===0&&h===0)if(e[1]===0&&i[1]>0){if(!c)return;i[1]=0}else{if(!(i[1]===0&&e[1]>0)||!l)return;e[1]=0}}return{range1:e,range2:i}}function _rt(n,t,e,i,r,o){const s=Gt.getFunction("getAxisDomainRangeAndLabels"),{axisOption:a,isZeroAlign:l}=im(t,e,i===0?"right":"left",o),{ticks:u}=s(n.min,n.max,a,l,r==="bottom"||r==="top"?o._table.getColWidth(t)||o._table.tableNoFrameWidth:o._table.getRowHeight(e)||o._table.tableNoFrameHeight);return u}function mf(n,t,e,i){return i!==0&&n?()=>n.map(r=>{const o=(r-t.min)/(t.max-t.min),s=(e.max-e.min)*o+e.min;return Math.round(100*s)/100}):void 0}function Crt(n,t,e){var i,r,o,s,a,l,u;if(e._table.isPivotChart())if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount){const h=vf("top",n,t+1,n,e.columnHeaderLevelCount-1,n,t,1,e);if(!h)return;const d=e._table._getCellStyle(n,t+1),c=me(pt("padding",d,n,t+1,e._table)),{range:f,ticks:g,axisOption:m,targetTicks:p,targetRange:v,index:b,theme:C}=h;return wt(m==null?void 0:m.min)&&(f.min=m.min,f.min>0&&(m.zero=!1)),wt(m==null?void 0:m.max)&&(f.max=m.max,f.max<0&&(m.zero=!1)),Ie({range:f},m,{orient:"top",type:(m==null?void 0:m.type)||"linear",label:{flush:!0},tick:{tickMode:mf(p,v,f,b)},__ticksForVTable:g,__vtableChartTheme:C,__vtablePadding:c})}if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount){const h=e.getIndicatorKeyInChartSpec(n,t);let d=null;h==null||h.forEach(_=>{const A=e.getIndicatorInfo(_);A&&(d=A)});const c=vf("bottom",n,t-1,n,t,n,t,0,e);if(!c)return;const f=e._table._getCellStyle(n,t-1),g=me(pt("padding",f,n,t-1,e._table)),{range:m,ticks:p,axisOption:v,index:b,targetTicks:C,targetRange:y,theme:w}=c;return wt(v==null?void 0:v.min)&&(m.min=v.min,m.min>0&&(v.zero=!1)),wt(v==null?void 0:v.max)&&(m.max=v.max,m.max<0&&(v.zero=!1)),Ie({title:{visible:!0,text:d==null?void 0:d.title},range:m},v,{orient:"bottom",type:(v==null?void 0:v.type)||"linear",label:{flush:!0},tick:{tickMode:mf(C,y,m,b)},__ticksForVTable:p,__vtableChartTheme:w,__vtablePadding:g})}if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){let h=e.getDimensionKeyInChartSpec(e.rowHeaderLevelCount,t);Wt(h)&&(h=h[0]);const d=(i=e.dataset.collectedValues[h])!==null&&i!==void 0?i:[],c=e.getRowKeysPath(n,t),f=(r=d[c??""])!==null&&r!==void 0?r:[],{axisOption:g,theme:m,chartType:p}=im(n+1,t,"left",e);if((g==null?void 0:g.visible)===!1)return;const v=e._table._getCellStyle(n+1,t),b=me(pt("padding",v,n+1,t,e._table)),C=e.getRawChartSpec(n+1,t);return Ie({domain:(g==null?void 0:g.type)==="linear"?void 0:Array.from(f),range:(g==null?void 0:g.type)==="linear"?f:void 0,title:{autoRotate:!0}},g,{orient:"left",type:(o=g==null?void 0:g.type)!==null&&o!==void 0?o:"band",__vtableChartTheme:m,inverse:Srt(g,((s=C==null?void 0:C.direction)!==null&&s!==void 0?s:p==="scatter"?"vertical":"horizontal")==="horizontal"),__vtablePadding:b})}}else{if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){const h=e.getIndicatorKeyInChartSpec(n,t);let d=null;h==null||h.forEach(_=>{const A=e.getIndicatorInfo(_);A&&(d=A)});const c=vf("left",n+1,t,n,t,n,t,0,e);if(!c)return;const f=e._table._getCellStyle(n+1,t),g=me(pt("padding",f,n+1,t,e._table)),{range:m,ticks:p,axisOption:v,index:b,targetTicks:C,targetRange:y,theme:w}=c;return wt(v==null?void 0:v.min)&&(m.min=v.min,m.min>0&&(v.zero=!1)),wt(v==null?void 0:v.max)&&(m.max=v.max,m.max<0&&(v.zero=!1)),Ie({title:{visible:!0,text:d==null?void 0:d.title,autoRotate:!0},range:m},v,{orient:"left",type:(v==null?void 0:v.type)||"linear",label:{flush:!0},tick:{tickMode:mf(C,y,m,b)},__ticksForVTable:p,__vtableChartTheme:w,__vtablePadding:g})}if(n===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){const h=vf("right",n-1,t,e.rowHeaderLevelCount-1,t,n,t,1,e);if(!h)return;const d=e._table._getCellStyle(n-1,t),c=me(pt("padding",d,n-1,t,e._table)),{range:f,ticks:g,axisOption:m,index:p,targetTicks:v,targetRange:b,theme:C}=h;return wt(m==null?void 0:m.min)&&(f.min=m.min,f.min>0&&(m.zero=!1)),wt(m==null?void 0:m.max)&&(f.max=m.max,f.max<0&&(m.zero=!1)),Ie({range:f,title:{autoRotate:!0}},m,{orient:"right",type:(m==null?void 0:m.type)||"linear",label:{flush:!0},tick:{tickMode:mf(v,b,f,p)},__ticksForVTable:g,__vtableChartTheme:C,__vtablePadding:c})}if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount){let h=e.getDimensionKeyInChartSpec(n,e.columnHeaderLevelCount);Wt(h)&&(h=h[0]);const d=(a=e.dataset.collectedValues[h])!==null&&a!==void 0?a:[],c=e.getColKeysPath(n,t),f=(l=d==null?void 0:d[c??""])!==null&&l!==void 0?l:[],{axisOption:g,isPercent:m,theme:p,chartType:v}=im(n,t-1,"bottom",e);if((g==null?void 0:g.visible)===!1)return;const b=e._table._getCellStyle(n,t-1),C=me(pt("padding",b,n,t-1,e._table));return Ie({domain:(g==null?void 0:g.type)==="linear"?void 0:Array.from(f),range:(g==null?void 0:g.type)==="linear"?f:void 0},g,{orient:"bottom",type:(u=g==null?void 0:g.type)!==null&&u!==void 0?u:"band",__vtableChartTheme:p,__vtablePadding:C})}}}function im(n,t,e,i){var r,o;const s=i.getRawChartSpec(n,t),a=(r=s.axes)!==null&&r!==void 0?r:[];if(i._table.pivotChartAxes.forEach(d=>{a.findIndex(c=>d.orient===c.orient)===-1&&a.push(d)}),s&&Wt(a)){const d=a.find(c=>c.orient===e);if(d){const{seriesIndex:c,seriesId:f}=d;let g,m;et(f)&&Wt(s.series)?g=(Wt(f)?f:[f]).map(b=>{const C=s.series.findIndex(y=>y.id===b);return C>=0&&(m=s.series[C]),C}):et(c)&&Wt(s.series)&&(g=c);const{isZeroAlign:p,isTickAlign:v}=AM(s,e,i);return{axisOption:d,isPercent:s.percent,isZeroAlign:p,isTickAlign:v,seriesIndice:g,theme:s.theme,chartType:(o=m==null?void 0:m.type)!==null&&o!==void 0?o:s.type}}}const l=i._table.pivotChartAxes.find(d=>d.orient===e),{isZeroAlign:u,isTickAlign:h}=AM(s,e,i);return{axisOption:l,isPercent:!1,isZeroAlign:u,isTickAlign:h,theme:s.theme,chartType:s.type}}function AM(n,t,e){const i=[];let r;t==="left"||t==="right"?i.push("left","right"):t!=="top"&&t!=="bottom"||i.push("top","bottom"),r=n&&Wt(n.axes)?n.axes:e._table.pivotChartAxes;let o=!1,s=!1;if(Wt(r)){const a=[];r.forEach(l=>{i.includes(l.orient)&&a.push(l)});for(let l=0;l<a.length;l++){const u=a[l];u.sync&&u.sync.axisId&&a.find(h=>h.id===u.sync.axisId)&&(o=o||u.sync.zeroAlign,s=s||u.sync.tickAlign)}}return{isZeroAlign:o,isTickAlign:s}}function iF(n,t,e,i,r){var o;if(Wt(r)){const u={min:1/0,max:-1/0};for(let h=0;h<r.length;h++){const d=iF(n,t,e,i,r[h]);d&&(u.min=Math.min(u.min,d.min),u.max=Math.max(u.max,d.max))}return isFinite(u.min)&&isFinite(u.max)?u:null}let s=t==null?void 0:t[r];if(Wt(s)&&(s=s[0]),!s)return null;const a=n[s],l=Ie({},(o=a==null?void 0:a[i??""])!==null&&o!==void 0?o:{min:0,max:1});return l.positiveMax&&l.positiveMax>l.max&&(l.max=l.positiveMax),l.negativeMin&&l.negativeMin<l.min&&(l.min=l.negativeMin),l.min===l.max&&(l.min>0?l.min=0:l.max=0),l}function yrt(n,t,e){if(!e._table.isPivotChart())return!1;if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount||t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return!0}else if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return!0;return!1}function wrt(n,t,e){if(!e._table.isPivotChart())return!1;if(e.indicatorsAsCol){if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return!0}else if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount||n===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return!0;return!1}var RM;function Srt(n,t){let e=n==null?void 0:n.inverse;return t&&!xrt(n==null?void 0:n.orient)&&(e=!et(n==null?void 0:n.inverse)||!(n!=null&&n.inverse)),e}function xrt(n){return n==="bottom"||n==="top"}(function(n){n.vertical="vertical",n.horizontal="horizontal"})(RM||(RM={}));function vf(n,t,e,i,r,o,s,a,l){const u=l.getIndicatorKeyInChartSpec(i,r);let h;h=n==="top"||n==="bottom"?l.getColKeysPath(o,s):l.getRowKeysPath(o,s);const d=rF(t,e,a,n,u,h,l);if(!d)return;const c=n==="bottom"?"top":n==="top"?"bottom":n==="left"?"right":"left",{targetRange:f,targetTicks:g}=Trt(t,e,d.index,d.isZeroAlign,d.isTickAlign,d.range,u,c,h,l);if(d.index!==0&&g){const m=Gt.getFunction("getAxisDomainRangeAndLabels"),{range:p,ticks:v}=m(d.range.min,d.range.max,d.axisOption,d.isZeroAlign,n==="bottom"||n==="top"?l._table.getColWidth(o)||l._table.tableNoFrameWidth:l._table.getRowHeight(s)||l._table.tableNoFrameHeight,{targetTicks:g,targetRange:f});d.range.min=p[0],d.range.max=p[1],d.ticks=v}return d.targetRange=f,d.targetTicks=g,d}function rF(n,t,e,i,r,o,s){const{axisOption:a,isPercent:l,isZeroAlign:u,isTickAlign:h,seriesIndice:d,theme:c,chartType:f}=im(n,t,i,s),g=iF(s.dataset.collectedValues,r,u,o,d??e);if(!g)return;l&&(g.min=g.min<0?-1:0,g.max=g.max>0?1:0),(a!=null&&a.zero||g.min===g.max)&&(g.min=Math.min(g.min,0),g.max=Math.max(g.max,0));const m=Gt.getFunction("getAxisDomainRangeAndLabels"),{range:p,ticks:v}=m(g.min,g.max,a,u,i==="bottom"||i==="top"?s._table.getColWidth(n)||s._table.tableNoFrameWidth:s._table.getRowHeight(t)||s._table.tableNoFrameHeight);a!=null&&a.nice&&(g.min=p[0],g.max=p[1]);const b=v;return wt(a==null?void 0:a.min)&&(g.min=a.min),wt(a==null?void 0:a.max)&&(g.max=a.max),{index:d??e,range:g,ticks:b,isZeroAlign:u,isTickAlign:h,axisOption:a,theme:c,chartType:f}}function Trt(n,t,e,i,r,o,s,a,l,u){let h,d;if(!i&&!r)return{targetTicks:h,targetRange:d};const c=rF(n,t,s.length-1-e,a,s,l,u);if(c){const{range:f,ticks:g}=c;if(d=f,i){const m=brt(o,f);m&&(o.min=m.range1[0],o.max=m.range1[1],d.min=m.range2[0],d.max=m.range2[1])}r&&(h=i?_rt(d,n,t,e,a,u):g)}return{targetTicks:h,targetRange:d}}class Art{constructor(t,e,i){this.table=t,this.customCellStyle=e,this.customCellStyleArrangement=i}getCustomCellStyle(t,e){const i=this.getCustomCellStyleIds(t,e);if(i.length){const r=[];return i.forEach(o=>{const s=this.getCustomCellStyleOption(o);if(pn(s==null?void 0:s.style)){const a=s.style({col:t,row:e,table:this.table,value:this.table.getCellValue(t,e),dataValue:this.table.getCellOriginValue(t,e),cellHeaderPaths:this.table.getCellHeaderPaths(t,e)});r.push(a)}else s!=null&&s.style&&r.push(s.style)}),Ie({},...r)}}getCustomCellStyleIds(t,e){const i=[],r=this.table.getCellRange(t,e);for(let o=r.start.col;o<=r.end.col;o++)for(let s=r.start.row;s<=r.end.row;s++)this.customCellStyleArrangement.forEach(a=>{a.cellPosition.range?a.cellPosition.range.start.col<=o&&a.cellPosition.range.end.col>=o&&a.cellPosition.range.start.row<=s&&a.cellPosition.range.end.row>=s&&i.push(a.customStyleId):a.cellPosition.col===o&&a.cellPosition.row===s&&i.push(a.customStyleId)});return i}getCustomCellStyleOption(t){return this.customCellStyle.find(e=>e.id===t)}registerCustomCellStyle(t,e){const i=this.customCellStyle.findIndex(r=>r.id===t);i===-1?this.customCellStyle.push({id:t,style:e}):this.customCellStyle[i]={id:t,style:e},this.customCellStyleArrangement.forEach(r=>{const o=r.cellPosition;if(r.customStyleId===t)if(o.range)for(let s=Math.max(0,o.range.start.col);s<=Math.min(this.table.colCount-1,o.range.end.col);s++)for(let a=Math.max(0,o.range.start.row);a<=Math.min(this.table.rowCount-1,o.range.end.row);a++)this.table.scenegraph.updateCellContent(s,a);else this.table.scenegraph.updateCellContent(o.col,o.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(t,e,i){var r;const o=this.customCellStyleArrangement.findIndex(a=>a.cellPosition.range&&t.range?a.cellPosition.range.start.col===t.range.start.col&&a.cellPosition.range.start.row===t.range.start.row&&a.cellPosition.range.end.col===t.range.end.col&&a.cellPosition.range.end.row===t.range.end.row:a.cellPosition.col===t.col&&a.cellPosition.row===t.row);if(o===-1&&!e)return;if(o===-1&&e)this.customCellStyleArrangement.push({cellPosition:{col:t.col,row:t.row,range:t.range},customStyleId:e});else{if(this.customCellStyleArrangement[o].customStyleId===e)return;e?this.customCellStyleArrangement[o].customStyleId=e:this.customCellStyleArrangement.splice(o,1)}const s=(r=this.getCustomCellStyleOption(e))===null||r===void 0?void 0:r.style;if(s){i=!0;for(const a in s)if(tK.indexOf(a)===-1){i=!1;break}}if(t.range)for(let a=Math.max(0,t.range.start.col);a<=Math.min(this.table.colCount-1,t.range.end.col);a++)for(let l=Math.max(0,t.range.start.row);l<=Math.min(this.table.rowCount-1,t.range.end.row);l++){const u=this.table.getCellRange(a,l);for(let h=u.start.col;h<=u.end.col;h++)for(let d=u.start.row;d<=u.end.row;d++)this.table.scenegraph.updateCellContent(h,d,i)}else this.table.scenegraph.updateCellContent(t.col,t.row,i);this.table.scenegraph.updateNextFrame()}updateCustomCell(t,e){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,t.forEach(i=>{this.registerCustomCellStyle(i.id,i.style)}),e.forEach(i=>{this.arrangeCustomCellStyle(i.cellPosition,i.customStyleId)})}hasCustomCellStyle(t){return this.customCellStyle.some(e=>e.id===t)}}function yh(n,t){n=n.clone();for(const e in t){const i=t[e];et(i)&&(n[`_${e}`]=i)}return n}const Rrt=()=>{Gt.registerComponent("customCellStylePlugin",Art)},Ert={};function Mrt(n,t,e){var i,r,o,s,a,l,u,h,d,c;const f=(i=e.customCellStylePlugin)===null||i===void 0?void 0:i.getCustomCellStyle(n,t),{layoutMap:g}=e.internalProps;if(g.isHeader(n,t)){let A;if(!e.isPivotTable()||e.isBottomFrozenRow(t)||e.isRightFrozenColumn(n))A=`${n}-${t}`;else{const M=e.getHeaderDefine(n,t),L=e.isCornerHeader(n,t);A=M!=null&&M.dimensionKey?L?`dim-cor-${M.dimensionKey}`:`dim-${M.dimensionKey}`:M!=null&&M.indicatorKey?`ind-${M.indicatorKey}`:`${n}-${t}`}let T=e.headerStyleCache.get(A);if(T)return f?yh(T,f):T;const S=g.getHeader(n,t);let x;if(e.isPivotChart()&&yrt(n,t,g)&&g.isAxisCell(n,t)?x=(o=(r=g.getBody(n,e.rowHeaderLevelCount).style)===null||r===void 0?void 0:r.padding)!==null&&o!==void 0?o:e.theme.bodyStyle.padding:e.isPivotChart()&&wrt(n,t,g)&&g.isAxisCell(n,t)&&(x=(a=(s=g.getBody(e.columnHeaderLevelCount,t).style)===null||s===void 0?void 0:s.padding)!==null&&a!==void 0?a:e.theme.bodyStyle.padding),(!S||S.isEmpty)&&(g.isLeftBottomCorner(n,t)||g.isRightBottomCorner(n,t)||g.isCornerHeader(n,t)||g.isRightTopCorner(n,t)))return Ert;const E=e.internalProps.headerHelper.getStyleClass((S==null?void 0:S.headerType)||"text");if(g.isBottomFrozenRow(n,t)&&e.theme.bottomFrozenStyle)T=Hf(x?{padding:x}:{},e.theme.bottomFrozenStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},E,e.options.autoWrapText,e.theme);else if(g.isRightFrozenColumn(n,t)&&e.theme.rightFrozenStyle)T=Hf(x?{padding:x}:{},e.theme.rightFrozenStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},E,e.options.autoWrapText,e.theme);else{const M=(S==null?void 0:S.style)||{};x&&(M.padding=x),T=Hf(M,g.isColumnHeader(n,t)||g.isBottomFrozenRow(n,t)?e.theme.headerStyle:g.isRowHeader(n,t)||g.isRightFrozenColumn(n,t)?e.theme.rowHeaderStyle:e.theme.cornerHeaderStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},E,e.options.autoWrapText,e.theme)}return e.headerStyleCache.set(A,T),f?yh(T,f):T}let m,p;!((u=(l=e.internalProps)===null||l===void 0?void 0:l.dataConfig)===null||u===void 0)&&u.mappingRules&&!e.isHeader(n,t)&&((c=(d=(h=e.internalProps)===null||h===void 0?void 0:h.dataConfig)===null||d===void 0?void 0:d.mappingRules)===null||c===void 0||c.forEach((A,T)=>{A.bgColor&&e.internalProps.layoutMap.getIndicatorKey(n,t)===A.bgColor.indicatorKey&&(m=A.bgColor.mapping)}));const v=e.getCellType(n,t),b=e.getCellOriginRecord(n,t);let C;if(p=b!=null&&b.vtableMerge?"merge-title":e.isSeriesNumberInBody(n,t)?`${n}-series-`+v:e.isListTable()&&!e.transpose||e.isPivotTable()&&e.internalProps.layoutMap.indicatorsAsCol?n+v:t+v,C=b!=null&&b.vtableMerge?e.bodyMergeTitleCache.get(p):g.isBottomFrozenRow(t)?e.bodyBottomStyleCache.get(p):e.bodyStyleCache.get(p),C)return f?yh(C,f):C;const y=g.getBody(n,t),w=e.internalProps.bodyHelper.getStyleClass(e.getCellType(n,t)),_=y==null?void 0:y.style;return C=$w(_,b!=null&&b.vtableMerge&&e.theme.groupTitleStyle?e.theme.groupTitleStyle:g.isBottomFrozenRow(t)&&e.theme.bottomFrozenStyle?e.theme.bottomFrozenStyle:g.isRightFrozenColumn(n)&&e.theme.rightFrozenStyle?e.theme.rightFrozenStyle:e.theme.bodyStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},w,e.options.autoWrapText,e.theme),m&&(C=yh(C,{bgColor:m})),pn(_)||(g.isBottomFrozenRow(t)?e.bodyBottomStyleCache.set(p,C):e.bodyStyleCache.set(p,C)),f?yh(C,f):C}function EM(n){return Math.floor(n)===n}class Brt extends ve{onUpdate(t,e,i){if(this.from.x!==this.to.x){const r=t?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*e);this.params.table.scrollLeft=r}if(this.from.y!==this.to.y){const r=t?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*e);this.params.table.scrollTop=r}}}class Prt{constructor(t){this.table=t,this.timeline=new Iw,this.ticker=new gD(this.table.scenegraph.stage),this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=Ge({})}scrollTo(t,e){var i,r;const o={x:this.table.scrollLeft,y:this.table.scrollTop},{col:s,row:a}=t;let l,u,h=s,d=a;wt(s)&&!EM(s)&&(h=Math.floor(s),l=s-h),wt(a)&&!EM(a)&&(d=Math.floor(a),u=a-d);const c=this.table.getCellRect(h??0,d??0);let{left:f,top:g}=c;l&&(f+=l*c.width),u&&(g+=u*c.height);const m={x:wt(s)?f-this.table.getFrozenColsWidth():this.table.scrollLeft,y:wt(a)?g-this.table.getFrozenRowsHeight():this.table.scrollTop},p=Eo(e)?e?3e3:0:(i=e==null?void 0:e.duration)!==null&&i!==void 0?i:3e3,v=Eo(e)?e?"linear":"":(r=e==null?void 0:e.easing)!==null&&r!==void 0?r:"linear";new fD(bi.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new Brt(o,m,p,v,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}function MM(n){return pn(n)?n:Wt(n)?(t,e)=>n.find(i=>i.range.start.col<=t&&i.range.end.col>=t&&i.range.start.row<=e&&i.range.end.row>=e):void 0}class krt{constructor(t,e){var i;this.plugins=new Map,this.table=t,(i=e.plugins)===null||i===void 0||i.map(r=>{this.register(r),this._bindTableEventForPlugin(r)})}register(t){this.plugins.set(t.id,t)}registerAll(t){t.forEach(e=>this.register(e))}getPlugin(t){return this.plugins.get(t)}getPluginByName(t){return Array.from(this.plugins.values()).find(e=>e.name===t)}_bindTableEventForPlugin(t){var e;(e=t.runTime)===null||e===void 0||e.forEach(i=>{this.table.on(i,(...r)=>{var o;(o=t.run)===null||o===void 0||o.call(t,...r,i,this.table)})})}updatePlugins(t){Array.from(this.plugins.values()).filter(i=>!(t!=null&&t.some(r=>r.id===i.id))).forEach(i=>{this.release(),this.plugins.delete(i.id)}),this.plugins.forEach(i=>{i.update&&i.update()});const e=t==null?void 0:t.filter(i=>!this.plugins.has(i.id));e==null||e.forEach(i=>{this.register(i),this._bindTableEventForPlugin(i)})}release(){this.plugins.forEach(t=>{var e;(e=t.release)===null||e===void 0||e.call(t,this.table)})}}const{toBoxArray:xs}=QK,{isTouchEvent:Lrt}=ZK,Drt=/^\$(\d+)\$(\d+)$/;MK();class Irt extends Km{static get EVENT_TYPE(){return ut}constructor(t,e={}){var i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y;if(super(),this.showFrozenIcon=!0,this.version="1.19.3",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=HK(this.render.bind(this),200),be.mode==="node"?(e=t,t=null):t instanceof HTMLElement||(e=t,t=t.container?t.container:null),!t&&e.mode!=="node"&&!e.canvas)throw new Error("vtable's container is undefined");this.pluginManager=new krt(this,e),this.fireListeners(ut.BEFORE_INIT,{options:e,container:t}),t=e.container&&e.container instanceof HTMLElement?e.container:t,((i=e.customConfig)===null||i===void 0?void 0:i.imageAnonymous)===!1&&(De.isImageAnonymous=!1);const{frozenColCount:w=0,unfreezeAllOnExceedsMaxWidth:_,frozenRowCount:A,defaultRowHeight:T=40,defaultHeaderRowHeight:S,defaultColWidth:x=80,defaultHeaderColWidth:E,widthMode:M="standard",heightMode:L="standard",autoFillWidth:I=!1,autoFillHeight:D=!1,containerFit:H={width:!1,height:!1},widthAdaptiveMode:O="only-body",heightAdaptiveMode:N="only-body",keyboardOptions:U,eventOptions:W,rowSeriesNumber:j,enableCheckboxCascade:Y,columnResizeMode:Z,rowResizeMode:rt="none",resize:J,dragHeaderMode:st,dragOrder:ht,showFrozenIcon:at,allowFrozenColCount:lt,padding:_t,hover:vt,menu:yt,select:mt,customRender:ft,pixelRatio:Ft=xa,renderChartAsync:St,renderChartAsyncBatchCount:Kt,mode:At,modeParams:Pt,canvasWidth:Bt,canvasHeight:It,overscrollBehavior:Ot,limitMinWidth:qt,limitMinHeight:gt,clearDOM:Ht=!0}=e;this.container=t,this.options=e,this._widthMode=M,this._heightMode=L,this._widthAdaptiveMode=O,this._heightAdaptiveMode=N,this._autoFillWidth=I,this._autoFillHeight=D,H!==void 0&&(this._containerFit=typeof H=="boolean"?{width:H,height:H}:H&&typeof H=="object"?{width:(r=H.width)===null||r===void 0||r,height:(o=H.height)===null||o===void 0||o}:{width:!1,height:!1}),this.customRender=ft,this.padding={top:0,right:0,left:0,bottom:0},_t&&(typeof _t=="number"?(this.padding.top=_t,this.padding.left=_t,this.padding.bottom=_t,this.padding.right=_t):(_t.top&&(this.padding.top=_t.top),_t.bottom&&(this.padding.bottom=_t.bottom),_t.left&&(this.padding.left=_t.left),_t.right&&(this.padding.right=_t.right))),(et(It)||et(Bt))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.canvasWidth=wt(Bt)?Bt:void 0,this.canvasHeight=wt(It)?It:void 0,this.columnWidthComputeMode=(s=e.columnWidthComputeMode)!==null&&s!==void 0?s:"normal";const bt=this.internalProps={};at!==void 0&&(this.showFrozenIcon=at),typeof lt=="number"&&lt<=0&&(this.showFrozenIcon=!1),this.options.canvas?(be.mode!=="node"&&(bt.element=this.options.canvas.parentElement,bt.element.style.position="relative"),bt.focusControl=new bM(this,bt.element),bt.canvas=this.options.canvas,bt.context=bt.canvas.getContext("2d")):be.mode!=="node"&&(bt.element=GQ(this.padding),bt.focusControl=new bM(this,bt.element),bt.canvas=document.createElement("canvas"),bt.element.appendChild(bt.canvas),bt.context=bt.canvas.getContext("2d"),!((a=e.customConfig)===null||a===void 0)&&a.createReactContainer&&Wtt(this)),bt.handler=new Jm,wt(this.options.resizeTime)&&(bt.handler.resizeTime=this.options.resizeTime),bt.pixelRatio=Ft,bt.frozenColCount=w,bt.frozenRowCount=A,bt.unfreezeAllOnExceedsMaxWidth=_==null||_,bt.defaultRowHeight=T,bt.defaultHeaderRowHeight=S??T,bt.defaultColWidth=x,bt.defaultHeaderColWidth=E??x,bt.keyboardOptions=U,bt.eventOptions=W,bt.rowSeriesNumber=j,bt.enableCheckboxCascade=Y,bt.columnResizeMode=(l=J==null?void 0:J.columnResizeMode)!==null&&l!==void 0?l:Z,bt.rowResizeMode=(u=J==null?void 0:J.rowResizeMode)!==null&&u!==void 0?u:rt,bt.dragHeaderMode=(d=(h=ht==null?void 0:ht.dragHeaderMode)!==null&&h!==void 0?h:st)!==null&&d!==void 0?d:"none",bt.renderChartAsync=St,ME(Kt),bt.overscrollBehavior=Ot??"auto",bt._rowHeightsMap=new _M(this),bt._rowRangeHeightsMap=new Map,bt._colRangeWidthsMap=new Map,bt._widthResizedColMap=new Set,bt._heightResizedRowMap=new Set,this.colWidthsMap=new Os,this.colContentWidthsMap=new Os,this.colWidthsLimit={};const Fe=this;if(bt.calcWidthContext={_:bt,get full(){var le;return be.mode==="node"?Fe.canvasWidth/(Ft??1):this._.canvas.width/((le=this._.context.pixelRatio)!==null&&le!==void 0?le:window.devicePixelRatio)}},bt.cellTextOverflows={},bt.focusedTable=!1,bt.theme=Ss.of((c=e.theme)!==null&&c!==void 0?c:Ss.DEFAULT),bt.theme.isPivot=this.isPivotTable(),ff(bt.theme.functionalIconsStyle),t?(Ht&&(t.innerHTML=""),t.appendChild(bt.element),this._updateSize()):this._updateSize(),bt.bodyHelper=new Yit(this),bt.headerHelper=new srt(this),bt.rowSeriesNumberHelper=new art(this),bt.autoWrapText=e.autoWrapText,bt.enableLineBreak=e.enableLineBreak,bt.allowFrozenColCount=(f=e.allowFrozenColCount)!==null&&f!==void 0?f:0,bt.limitMaxAutoWidth=(g=e.limitMaxAutoWidth)!==null&&g!==void 0?g:450,bt.limitMinWidth=qt!=null?typeof qt=="number"?qt:qt?10:0:10,bt.limitMinHeight=gt!=null?typeof gt=="number"?gt:gt?10:0:10,this.scenegraph=new Aet(this),this.stateManager=new mit(this),this.eventManager=new Git(this),this.animationManager=new Prt(this),e.legends){bt.legends=[];const le=Gt.getFunction("createLegend");if(Array.isArray(e.legends)){for(let Ci=0;Ci<e.legends.length;Ci++)bt.legends.push(le(e.legends[Ci],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else bt.legends.push(le(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(bt.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:en.bottom},e.tooltip),bt.tooltip.renderMode==="html"){const le=Gt.getComponent("tooltipHandler");le&&(bt.tooltipHandler=new le(this,bt.tooltip.confine))}if(bt.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray((m=e.menu)===null||m===void 0?void 0:m.dropDownMenuHighlight)&&this.setDropDownMenuHighlight((p=e.menu)===null||p===void 0?void 0:p.dropDownMenuHighlight),(Array.isArray((v=e.menu)===null||v===void 0?void 0:v.defaultHeaderMenuItems)||typeof((b=e.menu)===null||b===void 0?void 0:b.defaultHeaderMenuItems)=="function")&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),bt.menu.renderMode==="html"){const le=Gt.getComponent("menuHandler");bt.menuHandler=new le(this)}this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,bt.stick={changedCells:new Map},bt.customMergeCell=MM(e.customMergeCell);const hi=Gt.getComponent("customCellStylePlugin");hi&&(this.customCellStylePlugin=new hi(this,(C=e.customCellStyle)!==null&&C!==void 0?C:[],(y=e.customCellStyleArrangement)!==null&&y!==void 0?y:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){this.options.canvasHeight!=="auto"&&this.options.canvasWidth!=="auto"||setTimeout(()=>{var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T;let S,x;if(this.options.canvasHeight==="auto"){let E=0;if(!((t=this.theme.frameStyle)===null||t===void 0)&&t.innerBorder)E+=(r=xs((i=(e=this.internalProps.theme.frameStyle)===null||e===void 0?void 0:e.shadowBlur)!==null&&i!==void 0?i:[0])[1])!==null&&r!==void 0?r:0;else if(this.theme.frameStyle){const M=xs((s=(o=this.internalProps.theme.frameStyle)===null||o===void 0?void 0:o.borderLineWidth)!==null&&s!==void 0?s:[null]),L=xs((l=(a=this.internalProps.theme.frameStyle)===null||a===void 0?void 0:a.shadowBlur)!==null&&l!==void 0?l:[0]);E+=((u=M[0])!==null&&u!==void 0?u:0)+((h=L[0])!==null&&h!==void 0?h:0)+(((d=M[2])!==null&&d!==void 0?d:0)+((c=L[2])!==null&&c!==void 0?c:0))}x=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-E:2e4,this.getAllRowsHeight())+E}else x=this.canvasHeight;if(this.options.canvasWidth==="auto"){let E=0;if(!((f=this.theme.frameStyle)===null||f===void 0)&&f.innerBorder)E+=(p=xs((m=(g=this.internalProps.theme.frameStyle)===null||g===void 0?void 0:g.shadowBlur)!==null&&m!==void 0?m:[0])[2])!==null&&p!==void 0?p:0;else if(this.theme.frameStyle){const M=xs((b=(v=this.internalProps.theme.frameStyle)===null||v===void 0?void 0:v.borderLineWidth)!==null&&b!==void 0?b:[null]),L=xs((y=(C=this.internalProps.theme.frameStyle)===null||C===void 0?void 0:C.shadowBlur)!==null&&y!==void 0?y:[0]);E+=((w=M[1])!==null&&w!==void 0?w:0)+((_=L[1])!==null&&_!==void 0?_:0)+(((A=M[3])!==null&&A!==void 0?A:0)+((T=L[3])!==null&&T!==void 0?T:0))}S=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-E:2e4,this.getAllColsWidth())+E}else S=this.canvasWidth;this.setCanvasSize(S,x)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(t,e){this.canvasWidth=t,this.canvasHeight=e,this.options.canvasHeight=e,this.options.canvasWidth=t,this.resize()}resize(){var t;this._updateSize(),(t=this.internalProps.legends)===null||t===void 0||t.forEach(e=>{e==null||e.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(t){this.internalProps.rowCount=t}get colCount(){var t;return(t=this.internalProps.colCount)!==null&&t!==void 0?t:0}set colCount(t){this.internalProps.colCount=t}get frozenColCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.frozenColCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.frozenColCount)!==null&&o!==void 0?o:0}set frozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;const e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{const i=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=i}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;const e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{const i=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=i}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.frozenRowCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.frozenRowCount)!==null&&o!==void 0?o:0}set frozenRowCount(t){this.internalProps.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.rightFrozenColCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.rightFrozenColCount)!==null&&o!==void 0?o:0}set rightFrozenColCount(t){this.scenegraph.dealWidthRightFrozen(t)}get bottomFrozenRowCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.bottomFrozenRowCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.bottomFrozenRowCount)!==null&&o!==void 0?o:0}set bottomFrozenRowCount(t){this.scenegraph.dealWidthBottomFrozen(t)}get defaultRowHeight(){return wt(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(t){this.internalProps.defaultRowHeight=t,this.options.defaultRowHeight=t}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(t){this.internalProps.defaultHeaderRowHeight=t,this.options.defaultHeaderRowHeight=t}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(t){this.internalProps.defaultColWidth=t,this.options.defaultColWidth=t}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(t){this.internalProps.defaultHeaderColWidth=t,this.options.defaultHeaderColWidth=t}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(t){this.internalProps._colWidthsMap=t}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(t){this.internalProps._colContentWidthsMap=t}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(t){this.internalProps._colRangeWidthsMap=t}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(t){this.internalProps._rowRangeHeightsMap=t}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(t){this.internalProps._rowHeightsMap=t}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(t){this.internalProps._colWidthsLimit=t}get keyboardOptions(){var t;return(t=this.internalProps.keyboardOptions)!==null&&t!==void 0?t:null}set keyboardOptions(t){this.internalProps.keyboardOptions=t??void 0}get eventOptions(){var t;return(t=this.internalProps.eventOptions)!==null&&t!==void 0?t:null}set eventOptions(t){this.internalProps.eventOptions=t??void 0}get widthMode(){return this._widthMode}set widthMode(t){t!==this._widthMode&&(this._widthMode=t,this.options.widthMode=t)}get heightMode(){return this._heightMode}set heightMode(t){t!==this._heightMode&&(this._heightMode=t,this.options.heightMode=t)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(t){t!==this._autoFillWidth&&(this._autoFillWidth=t)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(t){t!==this._autoFillHeight&&(this._autoFillHeight=t)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(t){t!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=t)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(t){t!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=t)}_colWidthDefineToPxWidth(t){return t==="auto"?0:wl(this,t)}_getMaxFrozenWidth(){var t;const e=(t=this.options.maxFrozenWidth)!==null&&t!==void 0?t:"80%";return wl(this,e)}_getComputedFrozenColCount(t){const e=this._getMaxFrozenWidth();let i=t;for(;this.getColsWidth(0,i-1)>e&&(i--,!(i<=0)););return i}_getColWidthLimits(t){const e=this.colWidthsLimit[t];if(!e)return null;const i={};return e.min&&(i.min=wl(this,e.min),i.minDef=e.min),e.max&&(i.max=wl(this,e.max),i.maxDef=e.max),i}_adjustColWidth(t,e){const i=this._getColWidthLimits(t);return Math.max(KQ(i,e),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(t){var e;if(t!==((e=this.internalProps)===null||e===void 0?void 0:e.pixelRatio)){this.internalProps.pixelRatio=t;const i=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var r;return be.mode==="node"?i/(t??1):this._.canvas.width/((r=this._.context.pixelRatio)!==null&&r!==void 0?r:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(t)}}_updateSize(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I;const{padding:D}=this;let H=0,O=0;if(this.tableX=0,this.tableY=0,this.options.canvas&&this.options.viewBox)H=this.options.viewBox.x2-this.options.viewBox.x1,O=this.options.viewBox.y2-this.options.viewBox.y1,!((t=this==null?void 0:this.scenegraph)===null||t===void 0)&&t.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(H,O));else if(be.mode==="browser"){const W=this.getElement();let j=0,Y=0;const Z=et(this.canvasWidth),rt=et(this.canvasHeight);if(this.canvasSizeSeted&&(Z&&(j=this.canvasWidth),rt&&(Y=this.canvasHeight)),(!Z||!rt)&&W.parentElement){const st=W.parentElement.style||window.getComputedStyle(W.parentElement);Z||(j=W.parentElement.offsetWidth-(parseInt(st.paddingLeft,10)||0)-(parseInt(st.paddingRight,10)||0)),rt||(Y=W.parentElement.offsetHeight-parseInt(st.paddingTop||"0px",10)-parseInt(st.paddingBottom||"0px",20)),j=(j??1)-(this.options.tableSizeAntiJitter?1:0),Y=(Y??1)-(this.options.tableSizeAntiJitter?1:0)}W.style.width=j&&j-D.left-D.right+"px"||"0px",W.style.height=Y&&Y-D.top-D.bottom+"px"||"0px";const{canvas:J}=this.internalProps;H=((i=(e=J.parentElement)===null||e===void 0?void 0:e.offsetWidth)!==null&&i!==void 0?i:1)-(this.options.tableSizeAntiJitter?1:0),O=((o=(r=J.parentElement)===null||r===void 0?void 0:r.offsetHeight)!==null&&o!==void 0?o:1)-(this.options.tableSizeAntiJitter?1:0),!((s=this==null?void 0:this.scenegraph)===null||s===void 0)&&s.stage?!((a=this.options)===null||a===void 0)&&a.viewBox&&!(!((l=this.options)===null||l===void 0)&&l.canvas)&&this.scenegraph.stage.resize(H,O):(J.style.width="",J.style.height="",J.width=H,J.height=O,J.style.width=`${H}px`,J.style.height=`${O}px`),!((u=this.options)===null||u===void 0)&&u.viewBox&&(H=this.options.viewBox.x2-this.options.viewBox.x1,O=this.options.viewBox.y2-this.options.viewBox.y1),!((h=this==null?void 0:this.scenegraph)===null||h===void 0)&&h.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(H,O))}else be.mode==="node"&&(H=this.canvasWidth-1,O=this.canvasHeight-1);const N=Math.floor(H-PK(this.getTheme().scrollStyle)),U=Math.floor(O-BK(this.getTheme().scrollStyle));if(!((d=this.internalProps.theme)===null||d===void 0)&&d.frameStyle){const W=xs((f=(c=this.internalProps.theme.frameStyle)===null||c===void 0?void 0:c.borderLineWidth)!==null&&f!==void 0?f:[null]),j=xs((m=(g=this.internalProps.theme.frameStyle)===null||g===void 0?void 0:g.shadowBlur)!==null&&m!==void 0?m:[0]);!((p=this.theme.frameStyle)===null||p===void 0)&&p.innerBorder?(this.tableX=0,this.tableY=0,this.tableNoFrameWidth=N-((v=j[1])!==null&&v!==void 0?v:0),this.tableNoFrameHeight=U-((b=j[2])!==null&&b!==void 0?b:0)):(this.tableX=((C=W[3])!==null&&C!==void 0?C:0)+((y=j[3])!==null&&y!==void 0?y:0),this.tableY=((w=W[0])!==null&&w!==void 0?w:0)+((_=j[0])!==null&&_!==void 0?_:0),this.tableNoFrameWidth=N-(((A=W[1])!==null&&A!==void 0?A:0)+((T=j[1])!==null&&T!==void 0?T:0))-(((S=W[3])!==null&&S!==void 0?S:0)+((x=j[3])!==null&&x!==void 0?x:0)),this.tableNoFrameHeight=U-(((E=W[0])!==null&&E!==void 0?E:0)+((M=j[0])!==null&&M!==void 0?M:0))-(((L=W[2])!==null&&L!==void 0?L:0)+((I=j[2])!==null&&I!==void 0?I:0)))}this._clearColRangeWidthsMap(),this._clearRowRangeHeightsMap()}updateViewBox(t){var e,i,r,o,s,a,l,u,h,d,c,f;const g=((r=(i=(e=this.options)===null||e===void 0?void 0:e.viewBox)===null||i===void 0?void 0:i.x2)!==null&&r!==void 0?r:0)-((a=(s=(o=this.options)===null||o===void 0?void 0:o.viewBox)===null||s===void 0?void 0:s.x1)!==null&&a!==void 0?a:0),m=((h=(u=(l=this.options)===null||l===void 0?void 0:l.viewBox)===null||u===void 0?void 0:u.y2)!==null&&h!==void 0?h:0)-((f=(c=(d=this.options)===null||d===void 0?void 0:d.viewBox)===null||c===void 0?void 0:c.y1)!==null&&f!==void 0?f:0),p=t.x2-t.x1,v=t.y2-t.y1;this.options.viewBox=t,g!==p||m!==v?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(t,e,i,r,o,s){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(t,e,i,r,o,s)}get rowHierarchyType(){return this.dataSource.rowHierarchyType}getColsWidth(t,e){var i;if(t>e)return 0;t=Math.max(t,0),e=Math.min(e,((i=this.colCount)!==null&&i!==void 0?i:1/0)-1);const r=this._colRangeWidthsMap.get(`$${t}$${e}`);if(r!=null)return r;const o=this._colRangeWidthsMap.get(`$${t}$${e-1}`);if(o!=null){let a=o+this.getColWidth(e);return this.rightFrozenColCount>0&&e===this.colCount-this.rightFrozenColCount&&(a=this._getRangeSizeForContainerFit(t,e,a,"col")),t>=0&&e>=0&&!Number.isNaN(a)&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(a)),Math.round(a)}let s=0;for(let a=t;a<=e;a++)s+=this.getColWidth(a);return s=this._getRangeSizeForContainerFit(t,e,s,"col"),t>=0&&e>=0&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(s)),Math.round(s)}getRowHeight(t){var e;if(et(this.rowHeightsMap.get(t))){if(!((e=this.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound){const r=this.rowHeightsMap.get(t);let o;return o=t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t),o=Number(o.toFixed(2)),Number.isInteger(o)?Math.ceil(r):Math.floor(r)}return this.rowHeightsMap.get(t)}const i=this.getDefaultRowHeight(t);return wt(i)?i:this.defaultRowHeight}getDefaultColumnWidth(t){var e,i;return this.isRowHeader(t,0)||this.isCornerHeader(t,0)?Array.isArray(this.defaultHeaderColWidth)?(e=this.defaultHeaderColWidth[t])!==null&&e!==void 0?e:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(t,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?(i=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])!==null&&i!==void 0?i:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(t){var e,i;return this.isColumnHeader(0,t)||this.isCornerHeader(0,t)||this.isSeriesNumberInHeader(0,t)?Array.isArray(this.defaultHeaderRowHeight)?(e=this.defaultHeaderRowHeight[t])!==null&&e!==void 0?e:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(t)?Array.isArray(this.defaultHeaderRowHeight)?(i=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])!==null&&i!==void 0?i:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(t,e,i){var r;this.rowHeightsMap.put(t,!((r=this.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound?e:Math.round(e)),i&&this._clearRowRangeHeightsMap(t)}setRowHeight(t,e){this.scenegraph.setRowHeight(t,e),this.scenegraph.updateChartSizeForResizeRowHeight(t),this.internalProps._heightResizedRowMap.add(t)}getRowsHeight(t,e){var i,r;if(t>e||this.rowCount===0)return 0;t=Math.max(t,0),e=Math.min(e,((i=this.rowCount)!==null&&i!==void 0?i:1/0)-1);let o=0;const s=this.options.defaultRowHeight==="auto";if(this.heightMode!=="standard"||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||s||this.internalProps._heightResizedRowMap.size!==0){if(!((r=this.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound){const a=this.rowHeightsMap.getSumInRange(t,e);let l;return l=e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e),l=Number(l.toFixed(2)),Number.isInteger(l)?Math.ceil(a):Math.floor(a)}o=this.rowHeightsMap.getSumInRange(t,e)}else{const a=this.rowCount-this.bottomFrozenRowCount;for(let u=t;u<Math.min(e+1,this.columnHeaderLevelCount);u++)o+=this.getRowHeight(u);e>=this.columnHeaderLevelCount&&(o+=this.defaultRowHeight*(Math.min(e,a-1)-Math.max(this.columnHeaderLevelCount,t)+1));let l=0;for(let u=a;u<e+1;u++)l+=this.getRowHeight(u);o=this._getRangeSizeForContainerFit(t,e,o+l,"row")}return Math.round(o)}_getRangeSizeForContainerFit(t,e,i,r="col"){var o;if(!isFinite(t)||!isFinite(e))return i;const s=r==="col"?{totalCount:"colCount",frozenCount:"rightFrozenColCount",fitType:"width",tableSize:"tableNoFrameWidth",getSize:"getColWidth"}:{totalCount:"rowCount",frozenCount:"bottomFrozenRowCount",fitType:"height",tableSize:"tableNoFrameHeight",getSize:"getRowHeight"},a=this[s.tableSize];if(i>=a)return i;const l=this[s.totalCount]-this[s.frozenCount];if(!isFinite(this[s.totalCount])||this[s.frozenCount]<=0||l<0||t>l||e<l||t===e||!(!((o=this.containerFit)===null||o===void 0)&&o[s.fitType]))return i;const u=this[s.totalCount]-1;let h=a;if(t>0){for(let d=0;d<t;d++)if(h-=this[s.getSize](d),h<=0)return i}if(e!==u){for(let d=e+1;d<=u;d++)if(h-=this[s.getSize](d),h<=0)return i}return h}getColWidthDefined(t){var e;const{layoutMap:i}=this.internalProps;if(this.widthMode==="autoWidth")return"auto";const{width:r}=(e=i==null?void 0:i.getColumnWidthDefined(t))!==null&&e!==void 0?e:{};return typeof r=="number"&&r<=0?0:r||this.getDefaultColumnWidth(t)}getColWidthDefinedNumber(t){const e=this.getColWidthDefined(t);return this._adjustColWidth(t,this._colWidthDefineToPxWidth(e))}isAutoRowHeight(t){return this.heightMode==="autoHeight"||!!this.options.customComputeRowHeight||(t>=0&&t<this.columnHeaderLevelCount?this.getDefaultRowHeight(t)==="auto":this.internalProps.defaultRowHeight==="auto")}getColWidth(t){var e;const i=(e=this.colWidthsMap.get(t))!==null&&e!==void 0?e:this.getDefaultColumnWidth(t);return this.widthMode==="adaptive"&&typeof i=="number"||this.transpose&&typeof i=="number"?this._colWidthDefineToPxWidth(i):this._adjustColWidth(t,this._colWidthDefineToPxWidth(i))}_setColWidth(t,e,i,r){this.colWidthsMap.put(t,typeof e=="number"?Math.round(e):e),i&&this._clearColRangeWidthsMap(t),r||this.stateManager.checkFrozen()}setColWidth(t,e){this.scenegraph.setColWidth(t,e),this.scenegraph.updateChartSizeForResizeColWidth(t),this.internalProps._widthResizedColMap.add(t)}_clearColRangeWidthsMap(t){if(typeof t!="number")this._colRangeWidthsMap.clear();else{const e=this._colRangeWidthsMap.keys();for(const i of e){const r=Drt.exec(i);if(r){const o=Number(r[1]),s=Number(r[2]);t>=o&&t<=s&&this._colRangeWidthsMap.delete(i)}}}}_clearRowRangeHeightsMap(t){this.rowHeightsMap.clearRange()}_getColContentWidth(t){return Number(this.colContentWidthsMap.get(t))}_setColContentWidth(t,e){this.colContentWidthsMap.put(t,e)}getAllRowsHeight(){return this.internalProps.rowCount<=0?0:this.getRowsHeight(0,this.internalProps.rowCount-1)}getAllColsWidth(){return this.internalProps.colCount<=0?0:this.getColsWidth(0,this.internalProps.colCount-1)}getColsWidths(){const t=this.colCount,e=[];for(let i=0;i<t;i++)e.push(this.getColWidth(i));return e}getMaxColWidth(t){var e;const i=this.colWidthsLimit[t];let r=(e=i&&i.max)!==null&&e!==void 0?e:1/0;return typeof r=="string"&&(r=wl(this,r)),r}setMaxColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).max=e}getMinColWidth(t){var e;const i=this.colWidthsLimit[t];let r=(e=i&&i.min)!==null&&e!==void 0?e:0;return typeof r=="string"&&(r=wl(this,r)),r}setMinColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).min=e}getCellRect(t,e){var i,r;const o=this.isFrozenCell(t,e);let s;const a=this.getColWidth(t);let l;s=o&&o.col&&this.isRightFrozenColumn(t,e)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,t-1)||0:this.tableNoFrameWidth-((i=this.getColsWidth(t,this.colCount-1))!==null&&i!==void 0?i:0):this.getColsWidth(0,t-1)||0;const u=this.getRowHeight(e);return l=o&&o.row&&this.isBottomFrozenRow(t,e)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,e-1):this.tableNoFrameHeight-((r=this.getRowsHeight(e,this.rowCount-1))!==null&&r!==void 0?r:0):this.getRowsHeight(0,e-1),new yo(Math.round(s),Math.round(l),Math.round(a),Math.round(u))}getMergeCellRect(t,e){const i=this.getCellRange(t,e),r=this.getColsWidth(0,i.start.col-1)||0,o=this.getColsWidth(i.start.col,i.end.col),s=this.getRowsHeight(0,i.start.row-1)||0,a=this.getRowsHeight(i.start.row,i.end.row);return new yo(Math.round(r),Math.round(s),Math.round(o),Math.round(a))}getCellRelativeRect(t,e){const i=this.isFrozenCell(t,e);let r=!0,o=!0;i!=null&&i.col&&(i!=null&&i.row)?(r=!1,o=!1):i!=null&&i.col?r=!1:i!=null&&i.row&&(o=!1);const s=this.getCellRect(t,e);return this._toRelativeRect(s,r,o)}getCellRangeRelativeRect(t){if(t.start){const s=this.isFrozenCell(t.start.col,t.start.row);let a=!0,l=!0;return s!=null&&s.col&&(s!=null&&s.row)?(a=!1,l=!1):s!=null&&s.col?a=!1:s!=null&&s.row&&(l=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),a,l)}const e=this.getCellRange(t.col,t.row),i=this.isFrozenCell(t.col,t.row);let r=!0,o=!0;return i!=null&&i.col&&(i!=null&&i.row)?(r=!1,o=!1):i!=null&&i.col?r=!1:i!=null&&i.row&&(o=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),r,o)}getVisibleCellRangeRelativeRect(t){let e;return e=t.start?t:this.getCellRange(t.col,t.row),this._getVisiableRect(this.getCellRangeRelativeRect(t),e)}_getVisiableRect(t,e){const i=e.start.col>=this.frozenColCount?Math.max(t.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):t.left,r=Math.min(t.right,this.tableNoFrameWidth),o=t.copy();o.left=i,o.right=r;const s=e.start.row>=this.frozenRowCount?Math.max(t.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):t.top,a=Math.min(t.bottom,this.tableNoFrameHeight);return o.top=s,o.bottom=a,o}getCellsRect(t,e,i,r){var o,s,a,l,u,h;let d=this.getColsWidth(0,t-1)||0,c=this.getColsWidth(t,i);const f=this.scrollLeft,g=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),m=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());this.isLeftFrozenColumn(t)&&this.isRightFrozenColumn(i)?c=this.tableNoFrameWidth-((o=this.getColsWidth(t+1,this.colCount-1))!==null&&o!==void 0?o:0)-d:this.isLeftFrozenColumn(t)&&!this.isLeftFrozenColumn(i)?c=Math.max(c-f,this.getColsWidth(t,this.frozenColCount-1)):!this.isRightFrozenColumn(t)&&this.isRightFrozenColumn(i)?(d=Math.min(d-f,g-this.getRightFrozenColsWidth()),c=g-((s=this.getColsWidth(t+1,this.colCount-1))!==null&&s!==void 0?s:0)-d):this.isRightFrozenColumn(t)&&(d=g-((a=this.getColsWidth(t,this.colCount-1))!==null&&a!==void 0?a:0));let p=this.getRowsHeight(0,e-1),v=this.getRowsHeight(e,r);const b=this.scrollTop;return this.isTopFrozenRow(e)&&this.isBottomFrozenRow(r)?v=this.tableNoFrameHeight-((l=this.getRowsHeight(e+1,this.rowCount-1))!==null&&l!==void 0?l:0)-p:this.isTopFrozenRow(e)&&!this.isTopFrozenRow(r)?v=Math.max(v-b,this.getRowsHeight(e,this.frozenRowCount-1)):!this.isBottomFrozenRow(e)&&this.isBottomFrozenRow(r)?(p=Math.min(p-b,m-this.getBottomFrozenRowsHeight()),v=m-((u=this.getRowsHeight(e+1,this.rowCount-1))!==null&&u!==void 0?u:0)-p):this.isBottomFrozenRow(e)&&(p=m-((h=this.getRowsHeight(e,this.rowCount-1))!==null&&h!==void 0?h:0)),new yo(Math.round(d),Math.round(p),Math.round(c),Math.round(v))}getCellsRectWidth(t,e,i,r){const o=this.isFrozenCell(t,e),s=this.isFrozenCell(i,r);let a=this.getColsWidth(t,i);if(o&&o.col){const l=this.scrollLeft;s&&s.col||(a-=l,a=Math.max(a,this.getColsWidth(t,this.frozenColCount-1)))}return a}getCellRangeRect(t){if(t.start)return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row);const e=this.getCellRange(t.col,t.row);return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row)}getCellRangeRectWidth(t){if(t.start)return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row);const e=this.getCellRange(t.col,t.row);return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row)}isFrozenCell(t,e){const i=this.isFrozenRow(e),r=this.isFrozenColumn(t);return i||r?{row:i,col:r}:null}getRowAt(t){return QI(t,this)}getColAt(t){return JI(t,this)}getCellAt(t,e){return grt(t,e,this)}getCellAtRelativePosition(t,e){return vrt(t,e,this)}_checkRowCol(t,e){return t>=0&&t<this.colCount&&e>=0&&e<this.rowCount}_makeVisibleCell(t,e){if(this._checkRowCol(t,e)){const i=this.isFrozenCell(t,e);if(i&&i.col&&i.row)return;const r=this.getCellRect(t,e),o=ZQ(this);if(o.contains(r))return;i&&i.col||this.getColsWidth(0,this.frozenColCount-1)+r.width>this.canvas.width||(r.left<o.left?this.scrollLeft-=o.left-r.left:o.right<r.right&&(this.scrollLeft-=o.right-r.right)),i&&i.row||this.getRowsHeight(0,this.frozenRowCount-1)+r.height>this.canvas.height||(r.top<o.top?this.scrollTop-=o.top-r.top:o.bottom<r.bottom&&(this.scrollTop-=o.bottom-r.bottom))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((t,e)=>{setTimeout(()=>{t()},0)})}_toRelativeRect(t,e=!0,i=!0){var r,o,s,a;const l=t.copy(),u=this.getVisibleRect();return l.offsetLeft(this.tableX-(e?u.left:0)),l.offsetTop(this.tableY-(i?u.top:0)),l.offsetLeft((o=(r=this.options.viewBox)===null||r===void 0?void 0:r.x1)!==null&&o!==void 0?o:0),l.offsetTop((a=(s=this.options.viewBox)===null||s===void 0?void 0:s.y1)!==null&&a!==void 0?a:0),l}getVisibleRect(){const{scrollTop:t,scrollLeft:e}=this,i=this.tableNoFrameWidth,r=this.tableNoFrameHeight;return new yo(e,t,i,r)}get visibleRowCount(){const{frozenRowCount:t}=this,e=this.getVisibleRect(),i=t>0?e.top+this.getRowsHeight(0,t-1):e.top,r=this.getTargetRowAt(i);if(!r)return 0;const o=Math.max(r.top>=i?r.row:r.row+1,t);let s=this.getRowsHeight(0,o-1),a=0;const{rowCount:l}=this;for(let u=o;u<l;u++){const h=s+this.getRowHeight(u);if(e.bottom<h)break;a++,s=h}return a}getBodyVisibleCellRange(){const{scrollTop:t,scrollLeft:e}=this,i=this.getFrozenRowsHeight(),r=this.getFrozenColsWidth(),o=this.getBottomFrozenRowsHeight(),s=this.getRightFrozenColsWidth(),{row:a}=this.getRowAt(t+i+1),{col:l}=this.getColAt(e+r+1),u=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-o).row:this.rowCount-1,h=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-s).col:this.colCount-1;return h<0||u<0?null:{rowStart:a,colStart:l,rowEnd:u,colEnd:h}}getBodyVisibleRowRange(){const{scrollTop:t}=this,e=this.getFrozenRowsHeight(),i=this.getBottomFrozenRowsHeight(),{row:r}=this.getRowAt(t+e+1),o=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-i).row:this.rowCount-1;return o<0?null:{rowStart:r,rowEnd:o}}getBodyVisibleColRange(){const{scrollLeft:t}=this,e=this.getFrozenColsWidth(),i=this.getRightFrozenColsWidth(),{col:r}=this.getColAt(t+e+1),o=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-i).col:this.colCount-1;return o<0?null:{colStart:r,colEnd:o}}get visibleColCount(){const{frozenColCount:t}=this,e=this.getVisibleRect(),i=t>0?e.left+this.getColsWidth(0,t-1):e.left,r=this.getTargetColAt(i);if(!r)return 0;const o=Math.max(r.left>=i?r.col:r.col+1,t);let s=this.getColsWidth(0,o-1),a=0;const{colCount:l}=this;for(let u=o;u<l;u++){const h=s+this.getColWidth(u);if(e.right<h)break;a++,s=h}return a}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(t){this.stateManager.setScrollTop(t)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(t){this.stateManager.setScrollLeft(t)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(t){this.scrollLeft=Math.ceil(t)}setScrollTop(t){this.scrollTop=Math.ceil(t)}getCellOverflowText(t,e){return this.scenegraph.getCellOverflowText(t,e)}addReleaseObj(t){if(!t||!t.release||typeof t.release!="function")throw new Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(t)}dispose(){this.release()}release(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p;const v=this.internalProps;if(this.isReleased)return;(e=(t=v.tooltipHandler)===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t),(r=(i=v.menuHandler)===null||i===void 0?void 0:i.release)===null||r===void 0||r.call(i),(o=super.release)===null||o===void 0||o.call(this),(a=(s=v.handler)===null||s===void 0?void 0:s.release)===null||a===void 0||a.call(s),this.eventManager.release(),(u=(l=v.focusControl)===null||l===void 0?void 0:l.release)===null||u===void 0||u.call(l),(h=v.legends)===null||h===void 0||h.forEach(C=>{C==null||C.release()}),(d=v.title)===null||d===void 0||d.release(),v.title=null,(c=v.emptyTip)===null||c===void 0||c.release(),v.emptyTip=null,v.layoutMap.release(),v.releaseList&&(v.releaseList.forEach(C=>{var y;return(y=C==null?void 0:C.release)===null||y===void 0?void 0:y.call(C)}),v.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release(),v.focusControl.release();const{parentElement:b}=v.element;b&&!this.options.canvas&&b.removeChild(v.element),(m=(g=(f=this.editorManager)===null||f===void 0?void 0:f.editingEditor)===null||g===void 0?void 0:g.onEnd)===null||m===void 0||m.call(g),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,(p=this.reactCustomLayout)===null||p===void 0||p.clearCache(),this.pluginManager.release(),ry()}fireListeners(t,e){return super.fireListeners(t,e)}updateOption(t){var e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_;(e=this.editorManager)===null||e===void 0||e.cancelEdit(),this.options=t,this._hasAutoImageColumn=void 0;const{frozenColCount:A=0,unfreezeAllOnExceedsMaxWidth:T,defaultRowHeight:S=40,defaultHeaderRowHeight:x,defaultColWidth:E=80,defaultHeaderColWidth:M=80,keyboardOptions:L,eventOptions:I,rowSeriesNumber:D,enableCheckboxCascade:H,columnResizeMode:O,rowResizeMode:N="none",resize:U,dragHeaderMode:W,dragOrder:j,showFrozenIcon:Y,allowFrozenColCount:Z,padding:rt,hover:J,menu:st,select:ht,pixelRatio:at,widthMode:lt,heightMode:_t,autoFillWidth:vt,autoFillHeight:yt,containerFit:mt,widthAdaptiveMode:ft,heightAdaptiveMode:Ft,customRender:St,renderChartAsync:Kt,renderChartAsyncBatchCount:At,canvasWidth:Pt,canvasHeight:Bt,overscrollBehavior:It,limitMinWidth:Ot,limitMinHeight:qt}=t;at&&at!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=at),rt&&(typeof rt=="number"?(this.padding.top=rt,this.padding.left=rt,this.padding.bottom=rt,this.padding.right=rt):(rt.top&&(this.padding.top=rt.top),rt.bottom&&(this.padding.bottom=rt.bottom),rt.left&&(this.padding.left=rt.left),rt.right&&(this.padding.right=rt.right))),this.showFrozenIcon=typeof Y!="boolean"||Y,typeof Z=="number"&&Z<=0&&(this.showFrozenIcon=!1),this.widthMode=lt??"standard",this.heightMode=_t??"standard",this._widthAdaptiveMode=ft??"only-body",this._heightAdaptiveMode=Ft??"only-body",this.autoFillWidth=vt!=null&&vt,this.autoFillHeight=yt!=null&&yt,mt!==void 0&&(this._containerFit=typeof mt=="boolean"?{width:mt,height:mt}:mt&&typeof mt=="object"?{width:(i=mt.width)===null||i===void 0||i,height:(r=mt.height)===null||r===void 0||r}:{width:!1,height:!1}),this.customRender=St,this.canvasWidth=wt(Pt)?Pt:void 0,this.canvasHeight=wt(Bt)?Bt:void 0;const gt=this.internalProps;if(be.mode==="node"||t.canvas||$Q(gt.element,this.padding),this.columnWidthComputeMode=(o=t.columnWidthComputeMode)!==null&&o!==void 0?o:"normal",gt.frozenColCount=A,gt.unfreezeAllOnExceedsMaxWidth=T==null||T,gt.defaultRowHeight=S,gt.defaultHeaderRowHeight=x??S,gt.defaultColWidth=E,gt.defaultHeaderColWidth=M??E,gt.keyboardOptions=L,gt.eventOptions=I,gt.rowSeriesNumber=D,gt.enableCheckboxCascade=H,gt.columnResizeMode=(s=U==null?void 0:U.columnResizeMode)!==null&&s!==void 0?s:O,gt.rowResizeMode=(a=U==null?void 0:U.rowResizeMode)!==null&&a!==void 0?a:N,gt.dragHeaderMode=(u=(l=j==null?void 0:j.dragHeaderMode)!==null&&l!==void 0?l:W)!==null&&u!==void 0?u:"none",gt.renderChartAsync=Kt,ME(At),gt.overscrollBehavior=It??"auto",gt.cellTextOverflows={},gt._rowHeightsMap=new _M(this),gt._rowRangeHeightsMap=new Map,gt._colRangeWidthsMap=new Map,gt._widthResizedColMap=new Set,gt._heightResizedRowMap=new Set,this.colWidthsMap=new Os,this.colContentWidthsMap=new Os,this.colWidthsLimit={},gt.stick.changedCells.clear(),gt.theme=Ss.of((h=t.theme)!==null&&h!==void 0?h:Ss.DEFAULT),gt.theme.isPivot=this.isPivotTable(),ff(gt.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),gt.autoWrapText=t.autoWrapText,gt.enableLineBreak=t.enableLineBreak,gt.allowFrozenColCount=(d=t.allowFrozenColCount)!==null&&d!==void 0?d:0,gt.limitMaxAutoWidth=(c=t.limitMaxAutoWidth)!==null&&c!==void 0?c:450,gt.limitMinWidth=Ot!=null?typeof Ot=="number"?Ot:Ot?10:0:10,gt.limitMinHeight=qt!=null?typeof qt=="number"?qt:qt?10:0:10,(f=gt.legends)===null||f===void 0||f.forEach(Ht=>{Ht==null||Ht.release()}),(g=gt.title)===null||g===void 0||g.release(),gt.title=null,(m=gt.emptyTip)===null||m===void 0||m.release(),gt.emptyTip=null,gt.layoutMap.release(),ry(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),t.legends){gt.legends=[];const Ht=Gt.getFunction("createLegend");if(Array.isArray(t.legends)){for(let bt=0;bt<t.legends.length;bt++)gt.legends.push(Ht(t.legends[bt],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else gt.legends.push(Ht(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(gt.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:en.bottom},t.tooltip),gt.tooltip.renderMode==="html"&&!gt.tooltipHandler){const Ht=Gt.getComponent("tooltipHandler");gt.tooltipHandler=new Ht(this,gt.tooltip.confine)}if(gt.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray((p=t.menu)===null||p===void 0?void 0:p.dropDownMenuHighlight)&&this.setDropDownMenuHighlight((v=t.menu)===null||v===void 0?void 0:v.dropDownMenuHighlight),(Array.isArray((b=t.menu)===null||b===void 0?void 0:b.defaultHeaderMenuItems)||typeof((C=t.menu)===null||C===void 0?void 0:C.defaultHeaderMenuItems)=="function")&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),gt.menu.renderMode==="html"&&!gt.menuHandler){const Ht=Gt.getComponent("menuHandler");gt.menuHandler=new Ht(this)}this.clearCellStyleCache(),this.clearColWidthCache(),this.clearRowHeightCache(),gt.customMergeCell=MM(t.customMergeCell),(y=this.customCellStylePlugin)===null||y===void 0||y.updateCustomCell((w=t.customCellStyle)!==null&&w!==void 0?w:[],(_=t.customCellStyleArrangement)!==null&&_!==void 0?_:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();const t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let t=0;for(let e=this.rowCount-this.bottomFrozenRowCount;e<=this.rowCount-1;e++)t+=this.getRowHeight(e);return t}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let t=0;for(let e=this.colCount-this.rightFrozenColCount;e<=this.colCount-1;e++)t+=this.getColWidth(e);return t}return 0}getDrawRange(){var t,e;const i=!((t=this.containerFit)===null||t===void 0)&&t.width?this.tableNoFrameWidth:Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),r=!((e=this.containerFit)===null||e===void 0)&&e.height?this.tableNoFrameHeight:Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new yo(this.tableX,this.tableY,i,r)}_getMouseAbstractPoint(t){var e,i,r,o,s,a,l,u;let h;if(!t)return{inTable:!1,x:void 0,y:void 0};h=Lrt(t)?t.changedTouches[0]:t;const d=h.clientX||h.pageX+window.scrollX,c=h.clientY||h.pageY+window.scrollY,f=this.internalProps.canvas.getBoundingClientRect();let g=!0;f.right<=d&&(g=!1),f.bottom<=c&&(g=!1);const m=f.width,p=m/((this.rotateDegree===90?this.canvas.offsetHeight:this.canvas.offsetWidth)||m),v=f.height,b=v/((this.rotateDegree===90?this.canvas.offsetWidth:this.canvas.offsetHeight)||v),C=this.pluginManager.getPluginByName("Rotate Table");if(C&&this.rotateDegree===90){const w={x:d/p-((i=(e=this.options.viewBox)===null||e===void 0?void 0:e.x1)!==null&&i!==void 0?i:0),y:c/b-((o=(r=this.options.viewBox)===null||r===void 0?void 0:r.y1)!==null&&o!==void 0?o:0),inTable:g};return C.matrix.transformPoint(w,w),w}const y={x:(d-f.left)/p-((a=(s=this.options.viewBox)===null||s===void 0?void 0:s.x1)!==null&&a!==void 0?a:0),y:(c-f.top)/b-((u=(l=this.options.viewBox)===null||l===void 0?void 0:l.y1)!==null&&u!==void 0?u:0),inTable:g};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(y,y),y}getTheme(){return this.internalProps.theme}getTargetColAt(t){return s1(t,this)}getTargetRowAt(t){const e=a1(t,this);return e&&(e.row=Math.min(e.row,this.rowCount-1)),e}getTargetColAtConsiderRightFrozen(t,e){return tF(t,e,this)}getTargetRowAtConsiderBottomFrozen(t,e){return eF(t,e,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(t,e,i,r,o,s=!1){var a,l,u;const h=!!(!((a=this.stateManager.select.ranges)===null||a===void 0)&&a.length);this.stateManager.updateSelectPos(t,e,i,r,!1,(u=o??((l=this.options.select)===null||l===void 0?void 0:l.makeSelectCellVisible))===null||u===void 0||u,s),this.stateManager.endSelectCells(!0,h)}selectCells(t){const{scrollLeft:e,scrollTop:i}=this;t.forEach((r,o)=>{var s,a,l,u,h,d;r.start.col===r.end.col&&r.start.row===r.end.row?this.stateManager.updateSelectPos(r.start.col,r.start.row,!1,o>=1,!1,(a=(s=this.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||a===void 0||a,!0):(this.stateManager.updateSelectPos(r.start.col,r.start.row,!1,o>=1,!1,(u=(l=this.options.select)===null||l===void 0?void 0:l.makeSelectCellVisible)===null||u===void 0||u,!0),this.stateManager.updateInteractionState(Qt.grabing),this.stateManager.updateSelectPos(r.end.col,r.end.row,!1,o>=1,!1,(d=(h=this.options.select)===null||h===void 0?void 0:h.makeSelectCellVisible)===null||d===void 0||d,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(Qt.default)}),this.setScrollTop(i),this.setScrollLeft(e)}get recordsCount(){var t;return(t=this.records)===null||t===void 0?void 0:t.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(t){this.scenegraph.clearCells(),qQ(this,t),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(t){this.internalProps.autoWrapText=t,this.options.autoWrapText=t}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(t){this.internalProps.enableLineBreak=t,this.options.enableLineBreak=t}updateAutoWrapText(t){this.internalProps.autoWrapText!==t&&(this.internalProps.autoWrapText=t,this.options.autoWrapText=t,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(t){this.internalProps.theme=Ss.of(t??Ss.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=t,ff(this.internalProps.theme.functionalIconsStyle)}updateTheme(t){const e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=Ss.of(t??Ss.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),ff(this.internalProps.theme.functionalIconsStyle),this.options.theme=t,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getBodyField(t,e){return this.internalProps.layoutMap.getBody(t,e).field}getBodyColumnDefine(t,e){const i=this.internalProps.layoutMap.getBody(t,e);return i==null?void 0:i.define}getBodyColumnType(t,e){var i,r;const o=(r=(i=this.internalProps.layoutMap.getBody(t,e))===null||i===void 0?void 0:i.cellType)!==null&&r!==void 0?r:"text";return pt("cellType",{cellType:o},t,e,this)}getCellType(t,e){let i;return this.isSeriesNumberInHeader(t,e)?this.internalProps.layoutMap.getSeriesNumberHeader(t,e).cellType:(i=this.isHeader(t,e)?this.internalProps.layoutMap.getHeader(t,e).headerType:this.internalProps.layoutMap.getBody(t,e).cellType,pt("cellType",{cellType:i},t,e,this))}getHeaderField(t,e){return this.internalProps.layoutMap.getHeaderField(t,e)}getHeaderDefine(t,e){const i=this.internalProps.layoutMap.getHeader(t,e);return i==null?void 0:i.define}getCellLocation(t,e){return this.internalProps.layoutMap.getCellLocation(t,e)}getCellHeaderPaths(t,e){return this.internalProps.layoutMap.getCellHeaderPaths(t,e)}getHeadersDefine(t,e){const i=[];for(;;){const r=this.getHeaderDefine(t,e);if(!r||!r.field&&!r.columns)break;i.push(r),e++}return i}_getHeaderLayoutMap(t,e){return this.internalProps.layoutMap.getHeader(t,e)}_getBodyLayoutMap(t,e){return this.internalProps.layoutMap.getBody(t,e)}getContext(){return this.internalProps.context}getRecordByCell(t,e){if(!this.internalProps.layoutMap.isHeader(t,e))return this.getCellOriginRecord(t,e)}getRecordByRowCol(t,e){return this.getRecordByCell(t,e)}getRecordStartRowByRecordIndex(t){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(t)}_getHeaderCellBySortState(t){const{layoutMap:e}=this.internalProps,i=e.headerObjects.find(r=>r&&r.field===t.field);if(i)return e.getHeaderCellAdressById(i.id)}getCellRange(t,e){var i;if(this.internalProps.customMergeCell){const r=this.internalProps.customMergeCell(t,e,this);if(r&&r.range&&(et(r.text)||r.customLayout||r.customRender))return{start:{col:Math.max(r.range.start.col,0),row:Math.max(r.range.start.row,0)},end:{col:Math.min(r.range.end.col,this.colCount-1),row:Math.min(r.range.end.row,this.rowCount-1)},isCustom:!0}}return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.getCellRange(t,e)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(t,e){if(this.internalProps.customMergeCell){const i=this.internalProps.customMergeCell(t,e,this);if(i&&i.range&&(et(i.text)||i.customLayout||this.customRender)){if(i.style){const r=this.internalProps.bodyHelper.getStyleClass("text"),o=i.style,s=$w(o,this.theme.bodyStyle,{col:t,row:e,table:this,value:i.text,dataValue:this.getCellOriginValue(t,e),cellHeaderPaths:this.getCellHeaderPaths(t,e)},r,this.options.autoWrapText,this.theme);i.style=s}return i.range={start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0},i}}}isCellRangeEqual(t,e,i,r){return this.internalProps.layoutMap.isCellRangeEqual(t,e,i,r)}_getLayoutCellId(t,e){return this.internalProps.layoutMap.getCellId(t,e)}getHeaderDescription(t,e){var i;const r=this._getHeaderLayoutMap(t,e),o=r==null?void 0:r.define,s=(i=o==null?void 0:o.description)!==null&&i!==void 0?i:r==null?void 0:r.description;return typeof s=="function"?s({col:t,row:e,value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e)}):s}setDropDownMenuHighlight(t){this.stateManager.setDropDownMenuHighlight(t)}_dropDownMenuIsHighlight(t,e,i){return this.stateManager.dropDownMenuIsHighlight(t,e,i)}isSeriesNumberInBody(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(t,e)}isSeriesNumberInHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)}isHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(t,e)}isColumnHeader(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isColumnHeader(t,e)}isRowHeader(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isRowHeader(t,e)}isCornerHeader(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isCornerHeader(t,e)}isFrozenColumn(t,e){return this.isLeftFrozenColumn(t,e)||this.isRightFrozenColumn(t,e)}isLeftFrozenColumn(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isFrozenColumn(t,e)}isRightFrozenColumn(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isRightFrozenColumn(t,e)}isFrozenRow(t,e){return this.isTopFrozenRow(t,e)||this.isBottomFrozenRow(t,e)}isTopFrozenRow(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isFrozenRow(t,e)}isBottomFrozenRow(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isBottomFrozenRow(t,e)}getCellInfo(t,e){if(t>=0&&e>=0){const i=this.isHeader(t,e)?this.getHeaderDefine(t,e):this.getBodyColumnDefine(t,e);return{col:t,row:e,field:this.getHeaderField(t,e),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(t,e),title:i==null?void 0:i.title,cellType:this.getCellType(t,e),originData:this.getCellOriginRecord(t,e),cellRange:this.getCellRangeRelativeRect({col:t,row:e}),value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e),cellLocation:this.getCellLocation(t,e),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(t,e,i){var r;if(t===null||this.internalProps.layoutMap.isHeader(e,i))return!1;const o=this.getRecordShowIndexByCell(e,i);return(r=this.internalProps.dataSource)===null||r===void 0?void 0:r.hasField(o,t)}_getCellStyle(t,e){return Mrt(t,e,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t+1,e)||this.internalProps.columnResizeMode==="none")return!1;if(this.internalProps.columnResizeMode==="header"){if(!this.isHeader(t,e))return!1}else if(this.internalProps.columnResizeMode==="body"&&this.isHeader(t,e))return!1;const i=this.colWidthsLimit[t];return!(i&&i.min&&i.max)||i.max!==i.min}_canResizeRow(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t,e+1)||this.internalProps.rowResizeMode==="none")return!1;if(this.internalProps.rowResizeMode==="header"){if(!this.isHeader(t,e))return!1}else if(this.internalProps.rowResizeMode==="body"&&this.isHeader(t,e))return!1;return!0}_canDragHeaderPosition(t,e){var i;if(this.isHeader(t,e)&&(this.stateManager.isSelected(t,e)||((i=this.options.select)===null||i===void 0?void 0:i.headerSelectMode)==="body"&&Ret(t,e,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||Hs(this,t,e))){if(this.internalProps.frozenColDragHeaderMode==="disabled"&&this.isFrozenColumn(t))return!1;if(this.stateManager.isSelected(t,e)){const o=this.stateManager.select.ranges[0];if(this.isColumnHeader(t,e)){if(o.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(t,e)||o.end.col!==this.colCount-1)return!1}const r=this.getHeaderDefine(t,e);if(!r)return!1;if(r.dragHeader===void 0){if(this.internalProps.dragHeaderMode==="all")return!0;if(this.internalProps.dragHeaderMode==="column"){if(this.isColumnHeader(t,e))return!0}else if(this.internalProps.dragHeaderMode==="row"&&this.isRowHeader(t,e))return!0;return!1}return r.dragHeader}return!1}getCellIcons(t,e){var i,r,o;let s;if(this.isHeader(t,e))s=this.internalProps.headerHelper.getIcons(t,e);else if(this.internalProps.layoutMap.isSeriesNumber(t,e)){(!this.options.groupBy||!(!((i=this.getCellRawRecord(t,e))===null||i===void 0)&&i.vtableMerge))&&!((o=(r=this.internalProps.layoutMap.getSeriesNumberBody(t,e))===null||r===void 0?void 0:r.define)===null||o===void 0)&&o.dragOrder&&(s=this.internalProps.rowSeriesNumberHelper.getIcons(t,e));const a=this.getCellValue(t,e),l=this.getCellOriginValue(t,e),u=this.internalProps.context,h=this.internalProps.bodyHelper.getIcons(t,e,a,l,u);(s==null?void 0:s.length)>0?s=s.concat(h):(h==null?void 0:h.length)>0&&(s=h)}else{const a=this.getCellValue(t,e),l=this.getCellOriginValue(t,e),u=this.internalProps.context;s=this.internalProps.bodyHelper.getIcons(t,e,a,l,u)}return s}showDropDownMenu(t,e,i){let r="dropdown-menu";i&&(r=Array.isArray(i.content)?"dropdown-menu":"container"),this.internalProps.menu.renderMode==="html"&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(t,e,r,i))}showTooltip(t,e,i){this.internalProps.tooltip.renderMode==="html"&&this.internalProps.tooltipHandler._bindToCell(t,e,i)}getCellStyle(t,e){const i=this._getCellStyle(t,e),r=Qs(i,this,t,e,pt).theme,{autoWrapText:o,lineClamp:s,textOverflow:a}=i;return{textAlign:r.text.textAlign,textBaseline:r.text.textBaseline,bgColor:Eo(r.group.fill)?pt("bgColor",i,t,e,this):r.group.fill,color:Eo(r.text.fill)?pt("color",i,t,e,this):r.text.fill,strokeColor:Eo(r.text.stroke)?pt("strokeColor",i,t,e,this):r.text.stroke,fontFamily:r.text.fontFamily,fontSize:r.text.fontSize,fontWeight:r.text.fontWeight,fontVariant:r.text.fontVariant,fontStyle:r.text.fontStyle,lineHeight:r.text.lineHeight,autoWrapText:o!=null&&o,lineClamp:s??"auto",textOverflow:a,borderColor:Eo(r.group.stroke)?pt("borderColor",i,t,e,this):r.group.stroke,borderLineWidth:r.group.lineWidth,borderLineDash:r.group.lineDash,underline:!!r.text.underline,underlineDash:r.text.underlineDash,underlineOffset:r.text.underlineOffset,lineThrough:!!r.text.lineThrough,padding:r._vtable.padding,underlineWidth:r.text.underline,lineThroughLineWidth:r.text.lineThrough,_strokeArrayWidth:r.group.strokeArrayWidth,_strokeArrayColor:r.group.strokeArrayColor,_linkColor:pt("linkColor",i,t,e,this)}}getAllBodyCells(t,e){const i=this.rowHeaderLevelCount,r=this.columnHeaderLevelCount,o=this.colCount-1,s=this.rowCount-1;return Array(Math.min(e??2e3,s-r+1,this.rowCount)).fill(0).map((a,l)=>Array(Math.min(t??2e3,o-i+1,this.colCount)).fill(0).map((u,h)=>this.getCellInfo(h+i,l+r)))}getAllCells(t,e){const o=this.colCount-1,s=this.rowCount-1;return Array(Math.min(e??2e3,s-0+1,this.rowCount)).fill(0).map((a,l)=>Array(Math.min(t??2e3,o-0+1,this.colCount)).fill(0).map((u,h)=>this.getCellInfo(h+0,l+0)))}getAllColumnHeaderCells(){const t=this.rowHeaderLevelCount,e=0,i=this.colCount-1,r=this.columnHeaderLevelCount-1;return Array(r-e+1).fill(0).map((o,s)=>Array(i-t+1).fill(0).map((a,l)=>this.getCellInfo(l+t,s+e)))}getAllRowHeaderCells(){const e=this.columnHeaderLevelCount,i=this.rowHeaderLevelCount-1,r=this.rowCount-1;return Array(r-e+1).fill(0).map((o,s)=>Array(i-0+1).fill(0).map((a,l)=>this.getCellInfo(l+0,s+e)))}getCopyValue(){var t,e,i;if(((e=(t=this.stateManager.select)===null||t===void 0?void 0:t.ranges)===null||e===void 0?void 0:e.length)>0){const r=this.stateManager.select.ranges;let o=Math.min(r[0].start.col,r[0].end.col),s=Math.max(r[0].start.col,r[0].end.col),a=Math.min(r[0].start.row,r[0].end.row),l=Math.max(r[0].start.row,r[0].end.row);r.forEach(g=>{o=Math.min(o,g.start.col,g.end.col),s=Math.max(s,g.start.col,g.end.col),a=Math.min(a,g.start.row,g.end.row),l=Math.max(l,g.start.row,g.end.row)});const u=g=>{let m=!1;return r.forEach(p=>{const v=Math.min(p.start.row,p.end.row),b=Math.max(p.start.row,p.end.row);v<=g&&b>=g&&(m=!0)}),m},h=g=>{let m=!1;return r.forEach(p=>{const v=Math.min(p.start.col,p.end.col),b=Math.max(p.start.col,p.end.col);v<=g&&b>=g&&(m=!0)}),m},d=(g,m)=>{let p;return r.forEach(v=>{const b=Math.min(v.start.row,v.end.row),C=Math.max(v.start.row,v.end.row),y=Math.min(v.start.col,v.end.col),w=Math.max(v.start.col,v.end.col);y<=g&&w>=g&&b<=m&&C>=m&&(p=v)}),p},c=(g,m,p)=>{const v=this.getCellRange(g,m);let b=v.start.col,C=v.start.row;if(p){const y=Math.min(p.start.col,p.end.col),w=Math.min(p.start.row,p.end.row);b=Math.max(y,v.start.col),C=Math.max(w,v.start.row)}return b!==g||C!==m?"":this.getCellValue(g,m)};let f="";for(let g=a;g<=l;g++)if(u(g)){for(let m=o;m<=s;m++)if(h(m)){const p=d(m,g);if(p){const v=c(m,g,p);if(!(typeof Promise<"u"&&v instanceof Promise)){const b=et(v)?`${v}`:"";/^\[object .*\]$/.exec(b)||(f+=b)}(m<p.end.col||m<s)&&(f+="	")}else f+="	"}g<l&&(f+=`\r
`)}return!((i=this.options)===null||i===void 0)&&i.formatCopyValue&&(f=this.options.formatCopyValue(f)),f}return""}getSelectedCellInfos(){var t;if(!(!((t=this.stateManager.select)===null||t===void 0)&&t.ranges))return null;const e=this.stateManager.select.ranges;if(!e.length)return[];let i=Math.min(e[0].start.col,e[0].end.col),r=Math.max(e[0].start.col,e[0].end.col),o=Math.min(e[0].start.row,e[0].end.row),s=Math.max(e[0].start.row,e[0].end.row);e.forEach(d=>{i=Math.min(i,d.start.col,d.end.col),r=Math.max(r,d.start.col,d.end.col),o=Math.min(o,d.start.row,d.end.row),s=Math.max(s,d.start.row,d.end.row)});const a=d=>{let c=!1;return e.forEach(f=>{const g=Math.min(f.start.row,f.end.row),m=Math.max(f.start.row,f.end.row);g<=d&&m>=d&&(c=!0)}),c},l=d=>{let c=!1;return e.forEach(f=>{const g=Math.min(f.start.col,f.end.col),m=Math.max(f.start.col,f.end.col);g<=d&&m>=d&&(c=!0)}),c},u=(d,c)=>{let f;return e.forEach(g=>{const m=Math.min(g.start.row,g.end.row),p=Math.max(g.start.row,g.end.row),v=Math.min(g.start.col,g.end.col),b=Math.max(g.start.col,g.end.col);v<=d&&b>=d&&m<=c&&p>=c&&(f=g)}),f},h=[];for(let d=o;d<=s;d++)if(a(d)){const c=[];for(let f=i;f<=r;f++)if(l(f)&&u(f,d)){const g=this.getCellInfo(f,d);c.push(g)}h.push(c)}return h}getSelectedCellRanges(){const t=this.stateManager.select.ranges;return t.length?al(t):[]}measureText(t,e){return AI.measureText(t,e)}measureTextBounds(t){return RI(t)}getCustomRender(t,e){let i;if(this.getCellLocation(t,e)!=="body"){const r=this.getHeaderDefine(t,e);i=r==null?void 0:r.headerCustomRender}else{const r=this.getBodyColumnDefine(t,e);i=(r==null?void 0:r.customRender)||this.customRender}return i}getCustomLayout(t,e){let i;if(this.getCellLocation(t,e)!=="body"){const r=this.getHeaderDefine(t,e);i=r==null?void 0:r.headerCustomLayout}else{const r=this.getBodyColumnDefine(t,e);i=r==null?void 0:r.customLayout}return i}hasAutoImageColumn(){return this._hasAutoImageColumn===void 0&&(this._hasAutoImageColumn=frt(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var t,e,i,r,o,s;const a=this.scenegraph.getCell((e=(t=this.stateManager.hover)===null||t===void 0?void 0:t.cellPos)===null||e===void 0?void 0:e.col,(r=(i=this.stateManager.hover)===null||i===void 0?void 0:i.cellPos)===null||r===void 0?void 0:r.row);return((s=(o=a==null?void 0:a.getChildren())===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.type)==="chart"?a.getChildren()[0].activeChartInstance:null}cellIsInVisualView(t,e){var i,r,o,s;const a=this.getDrawRange(),l=this.getCellRelativeRect(t,e);if(t<this.frozenColCount&&e<this.frozenRowCount)return!0;let u,h,d,c;return this.frozenRowCount>=1&&(u=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(d=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(c=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),!!(l.top>=a.top&&l.bottom<=a.bottom&&l.left>=a.left&&l.right<=a.right&&(this.isFrozenCell(t,e)||l.top>=((i=u==null?void 0:u.bottom)!==null&&i!==void 0?i:l.top)&&l.left>=((r=h==null?void 0:h.right)!==null&&r!==void 0?r:l.left)&&l.bottom<=((o=d==null?void 0:d.top)!==null&&o!==void 0?o:l.bottom)&&l.right<=((s=c==null?void 0:c.left)!==null&&s!==void 0?s:l.right)))}getCustomMergeValue(t,e){if(this.internalProps.customMergeCell){const i=this.getCustomMerge(t,e);if(i){const{text:r}=i;return r}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(t,e,i){var r,o,s,a;const l=this.cellIsInVisualView(t,e),{scrollTop:u,scrollLeft:h}=this;l||this.scrollToCell({col:t,row:e});const d=this.getCellRelativeRect(t,e);((o=(r=this.stateManager.select)===null||r===void 0?void 0:r.ranges)===null||o===void 0?void 0:o.length)>0&&jE(this.scenegraph);const{col:c,row:f}=this.stateManager.hover.cellPos;let g,m;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),i==null?void 0:i.disableBackground){const b=this.scenegraph.getCell(t,e);g=b.attribute.fill,b.setAttribute("fill","transparent")}if(i!=null&&i.disableBorder){const b=this.scenegraph.getCell(t,e);m=b.attribute.stroke,b.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let p=0;this.theme.cellBorderClipDirection==="bottom-right"&&(p=1);const v=this.scenegraph.stage.toCanvas(!1,new jh().set(d.left+this.tableX+1,d.top+this.tableY+1,d.right+this.tableX-p,d.bottom+this.tableY-p));return l||(this.setScrollTop(u),this.setScrollLeft(h)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),g&&this.scenegraph.getCell(t,e).setAttribute("fill",g),m&&this.scenegraph.getCell(t,e).setAttribute("stroke",m),((a=(s=this.stateManager.select)===null||s===void 0?void 0:s.ranges)===null||a===void 0?void 0:a.length)>0&&GE(this.scenegraph),this.stateManager.updateHoverPos(c,f),this.scenegraph.updateNextFrame(),v.toDataURL()}exportCellRangeImg(t){var e,i,r,o;const{scrollTop:s,scrollLeft:a}=this,l=Math.min(t.start.col,t.end.col),u=Math.min(t.start.row,t.end.row),h=Math.max(t.start.col,t.end.col),d=Math.max(t.start.row,t.end.row),c=this.cellIsInVisualView(l,u),f=this.cellIsInVisualView(h,d);c&&f||this.scrollToCell({col:l,row:u});const g=this.getCellRangeRelativeRect({start:{col:l,row:u},end:{col:h,row:d}});((i=(e=this.stateManager.select)===null||e===void 0?void 0:e.ranges)===null||i===void 0?void 0:i.length)>0&&jE(this.scenegraph);const{col:m,row:p}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();const v=this.scenegraph.stage.toCanvas(!1,new jh().set(g.left+this.tableX+1,g.top+this.tableY+1,g.right+this.tableX,g.bottom+this.tableY)).toDataURL();return c&&f||(this.setScrollTop(s),this.setScrollLeft(a)),((o=(r=this.stateManager.select)===null||r===void 0?void 0:r.ranges)===null||o===void 0?void 0:o.length)>0&&GE(this.scenegraph),this.stateManager.updateHoverPos(m,p),v}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(t="image/png"){if(this.options.mode!=="node")return;this.render();const e=this.scenegraph.stage;if(e){let i=this.tableX+this.getAllColsWidth(),r=this.tableY+this.getAllRowsHeight();return this.internalProps.legends&&this.internalProps.legends.forEach(o=>{o.orient==="right"?i=Math.max(i,o.legendComponent.globalAABBBounds.x2):o.orient==="bottom"&&(r=Math.max(r,o.legendComponent.globalAABBBounds.y2))}),this.internalProps.title&&(this.internalProps.title._titleOption.orient==="right"?i=Math.max(i,this.internalProps.title.getComponentGraphic().globalAABBBounds.x2):this.internalProps.title._titleOption.orient==="bottom"&&(r=Math.max(r,this.internalProps.title.getComponentGraphic().globalAABBBounds.y2))),i>=this.canvasWidth&&r>=this.canvasHeight?(e.render(),e.window.getImageBuffer(t)):this.scenegraph.stage.toCanvas(!1,new jh().set(0,0,Math.min(this.canvasWidth,i),Math.min(this.canvasHeight,r))).toBuffer(t)}return null}getBodyIndexByTableIndex(t,e){return{col:t-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:e-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(t,e){return{col:t+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:e+this.columnHeaderLevelCount}}onVChartEvent(t,e,i){this._chartEventMap[t]||(this._chartEventMap[t]=[]),typeof e=="function"?this._chartEventMap[t].push({callback:e}):this._chartEventMap[t].push({callback:i,query:e})}offVChartEvent(t,e){this._chartEventMap[t]&&(this._chartEventMap[t]=e?this._chartEventMap[t].filter(i=>i.callback!==e):[])}_bindChartEvent(t){if(t)for(const e in this._chartEventMap)(this._chartEventMap[e]||[]).forEach(i=>{i.query?t.on(e,i.query,i.callback):t.on(e,i.callback)})}changeRecordOrder(t,e){}hasCustomCellStyle(t){var e;return(e=this.customCellStylePlugin)===null||e===void 0?void 0:e.hasCustomCellStyle(t)}registerCustomCellStyle(t,e){var i;(i=this.customCellStylePlugin)===null||i===void 0||i.registerCustomCellStyle(t,e)}arrangeCustomCellStyle(t,e,i){var r;(r=this.customCellStylePlugin)===null||r===void 0||r.arrangeCustomCellStyle(t,e,i)}isSeriesNumber(t,e){return this.internalProps.layoutMap.isSeriesNumber(t,e)}isHasSeriesNumber(){var t;return((t=this.internalProps.layoutMap)===null||t===void 0?void 0:t.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var t,e;return(e=(t=this.internalProps.layoutMap)===null||t===void 0?void 0:t.leftRowSeriesNumberColumnCount)!==null&&e!==void 0?e:0}setMinMaxLimitWidth(t=!1){var e,i;const r=this.internalProps;for(let o=0;o<r.layoutMap.columnWidths.length;o++){if(this.internalProps._widthResizedColMap.has(o))continue;const{width:s,minWidth:a,maxWidth:l}=(i=(e=r.layoutMap.columnWidths)===null||e===void 0?void 0:e[o])!==null&&i!==void 0?i:{};t&&s&&(typeof s=="string"&&s!=="auto"||typeof s=="number"&&s>0)&&this._setColWidth(o,s),a&&(typeof a=="number"&&a>0||typeof a=="string")&&this.setMinColWidth(o,a),l&&(typeof l=="number"&&l>0||typeof l=="string")&&this.setMaxColWidth(o,l)}}setSortedIndexMap(t,e){var i;(i=this.dataSource)===null||i===void 0||i.setSortedIndexMap(t,e)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new eJ(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(t,e){this.scenegraph.component.showMoveCol(t,e,0),this.scenegraph.renderSceneGraph()}hideMoverLine(t,e){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(t,e){}scrollToRow(t,e){e?this.animationManager.scrollTo({row:t},e):this.scrollToCell({row:t})}scrollToCol(t,e){e?this.animationManager.scrollTo({col:t},e):this.scrollToCell({col:t})}scrollToCell(t,e){if(e)return void this.animationManager.scrollTo(t,e);const i=this.getDrawRange();if(et(t.col)&&t.col>=this.frozenColCount){const r=this.getFrozenColsWidth(),o=this.getColsWidth(0,t.col-1);this.scrollLeft=Math.min(o-r,this.getAllColsWidth()-i.width)}if(et(t.row)&&t.row>=this.frozenRowCount){const r=this.getFrozenRowsHeight(),o=this.getRowsHeight(0,t.row-1);this.scrollTop=Math.min(o-r,this.getAllRowsHeight()-i.height)}this.render()}checkHasColumnAutoWidth(){return QQ(this)}get containerFit(){return this._containerFit}set containerFit(t){var e,i;this._containerFit=typeof t=="boolean"?{width:t,height:t}:t&&typeof t=="object"?{width:(e=t.width)===null||e===void 0||e,height:(i=t.height)===null||i===void 0||i}:{width:!1,height:!1}}}const Frt={},Ort={};function Hrt(){return Jd(Ort,Frt)}const BM={};function zrt(n){if(BM[n])return BM[n]}const qu=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,nF=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||qu(n,"Boolean"),Nrt=n=>typeof n=="function",Vi=n=>n==null,ri=n=>n!=null,Wrt=n=>typeof n=="object"&&n!==null,Urt=function(n){if(!Wrt(n)||!qu(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},oF=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||qu(n,"String")},rl=n=>Array.isArray?Array.isArray(n):qu(n,"Array"),Vrt=function(n){return n!==null&&typeof n!="function"&&Number.isFinite(n.length)},sF=n=>qu(n,"Date"),Ar=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||qu(n,"Number")};function aF(n,t,e){let i;if(!ri(n)||typeof n!="object"||t)return n;const r=rl(n),o=n.length;i=r?new Array(o):typeof n=="object"?{}:nF(n)||Ar(n)||oF(n)?n:sF(n)?new Date(+n):void 0;const s=r?void 0:Object.keys(Object(n));let a=-1;if(i)for(;++a<(s||n).length;){const l=s?s[a]:a,u=n[l];i[l]=aF(u,t)}return i}function lF(n,t,e=!1,i=!1){if(t){if(n===t)return;if(ri(t)&&typeof t=="object"){const r=Object(t),o=[];for(const l in r)o.push(l);let{length:s}=o,a=-1;for(;s--;){const l=o[++a];!ri(r[l])||typeof r[l]!="object"||i&&rl(n[l])?uF(n,l,r[l]):jrt(n,t,l,e,i)}}}}function jrt(n,t,e,i=!1,r=!1){const o=n[e],s=t[e];let a=t[e],l=!0;if(rl(s)){if(i)a=[];else if(rl(o))a=o;else if(Vrt(o)){a=new Array(o.length);let u=-1;const h=o.length;for(;++u<h;)a[u]=o[u]}}else Urt(s)?(a=o??{},typeof o!="function"&&typeof o=="object"||(a={})):l=!1;l&&lF(a,s,i,r),uF(n,e,a)}function uF(n,t,e){(e!==void 0&&!Grt(n[t],e)||e===void 0&&!(t in n))&&(n[t]=e)}function Grt(n,t){return n===t||Number.isNaN(n)&&Number.isNaN(t)}function $rt(n,...t){let e=-1;const i=t.length;for(;++e<i;)lF(n,t[e],!0);return n}function qrt(n){if(!n)return[];if(Object.keys)return Object.keys(n);const t=[];for(const e in n)n.hasOwnProperty(e)&&t.push(e);return t}function Xrt(n,t,e){const i=qrt(t);for(let r=0;r<i.length;r++){const o=i[r];(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}return n}function hF(n,t,e=!0){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){const i=Object.getOwnPropertyNames(t);for(let r=0;r<i.length;r++){const o=i[r];o!=="constructor"&&(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}}else Xrt(n,t,e)}function Yrt(n,t,e){ri(t)||(t=n,n=0),ri(e)||(e=1);let i=-1;const r=0|Math.max(0,Math.ceil((t-n)/e)),o=new Array(r);for(;++i<r;)o[i]=n+i*e;return o}function Krt(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function Lh(n){return Number(n)}const Zrt=typeof console<"u";function bf(n,t,e){const i=[t].concat([].slice.call(e));Zrt&&console[n].apply(console,i)}var Vn;(function(n){n[n.None=0]="None",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug"})(Vn||(Vn={}));class xr{static getInstance(t,e){return xr._instance&&Ar(t)?xr._instance.level(t):xr._instance||(xr._instance=new xr(t,e)),xr._instance}static setInstance(t){return xr._instance=t}static setInstanceLevel(t){xr._instance?xr._instance.level(t):xr._instance=new xr(t)}static clearInstance(){xr._instance=null}constructor(t=Vn.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){const e=this._onErrorHandler.findIndex(i=>i===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=Vn.Info}canLogDebug(){return this._level>=Vn.Debug}canLogError(){return this._level>=Vn.Error}canLogWarn(){return this._level>=Vn.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=Vn.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):bf((e=this._method)!==null&&e!==void 0?e:"error","ERROR",t)),this}warn(...t){return this._level>=Vn.Warn&&bf(this._method||"warn","WARN",t),this}info(...t){return this._level>=Vn.Info&&bf(this._method||"log","INFO",t),this}debug(...t){return this._level>=Vn.Debug&&bf(this._method||"log","DEBUG",t),this}}xr._instance=null;function Qrt(n,t,e=0,i){for(Vi(i)&&(i=n.length);e<i;){const r=e+i>>>1;Krt(n[r],t)>0?i=r:e=r+1}return e}const Jrt=1e-10,tnt=1e-10;function dF(n,t,e=tnt,i=Jrt){const r=i,o=e*Math.max(n,t);return Math.abs(n-t)<=Math.max(r,o)}function PM(n,t,e,i){return n>t&&!dF(n,t,e,i)}function kM(n,t,e,i){return n<t&&!dF(n,t,e,i)}const ec=n=>{let t=null,e=null;return(...i)=>(t&&i.every((r,o)=>r===t[o])||(t=i,e=n(...i)),e)},cF=function(n,t,e){return n<t?t:n>e?e:n};function l1(n,t){let e;return n>t&&(e=n,n=t,t=e),i=>Math.max(n,Math.min(t,i))}function zf(n,t){return e=>n*(1-e)+t*e}function ent(n,t){return function(e){return Math.round(n*(1-e)+t*e)}}function int(n,t){const e=n.valueOf(),i=t.valueOf(),r=new Date;return o=>(r.setTime(e*(1-o)+i*o),r)}function uy(n,t,e){t/=100,e/=100;const i=(1-Math.abs(2*e-1))*t,r=i*(1-Math.abs(n/60%2-1)),o=e-i/2;let s=0,a=0,l=0;return 0<=n&&n<60?(s=i,a=r,l=0):60<=n&&n<120?(s=r,a=i,l=0):120<=n&&n<180?(s=0,a=i,l=r):180<=n&&n<240?(s=0,a=r,l=i):240<=n&&n<300?(s=r,a=0,l=i):300<=n&&n<360&&(s=i,a=0,l=r),s=Math.round(255*(s+o)),a=Math.round(255*(a+o)),l=Math.round(255*(l+o)),{r:s,g:a,b:l}}function u1(n,t,e){n/=255,t/=255,e/=255;const i=Math.min(n,t,e),r=Math.max(n,t,e),o=r-i;let s=0,a=0,l=0;return s=o===0?0:r===n?(t-e)/o%6:r===t?(e-n)/o+2:(n-t)/o+4,s=Math.round(60*s),s<0&&(s+=360),l=(r+i)/2,a=o===0?0:o/(1-Math.abs(2*l-1)),a=+(100*a).toFixed(1),l=+(100*l).toFixed(1),{h:s,s:a,l}}const rnt=/^#([0-9a-f]{3,8})$/,LM={transparent:4294967040},Nf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _f(n){return((n=Math.max(0,Math.min(255,Math.round(n)||0)))<16?"0":"")+n.toString(16)}function fF(n){return Ar(n)?new Or(n>>16,n>>8&255,255&n,1):rl(n)?new Or(n[0],n[1],n[2]):new Or(255,255,255)}function nnt(n){return Ar(n)?new Or(n>>>24,n>>>16&255,n>>>8&255,255&n):rl(n)?new Or(n[0],n[1],n[2],n[3]):new Or(255,255,255,1)}function Hb(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function zb(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const DM=(n,t)=>{const e=rnt.exec(n);if(t||e){const i=parseInt(e[1],16),r=e[1].length;return r===3?new Or((i>>8&15)+((i>>8&15)<<4),(i>>4&15)+((i>>4&15)<<4),(15&i)+((15&i)<<4),1):r===6?fF(i):r===8?new Or(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):null}};class $n{static Brighter(t,e=1){return e===1?t:new $n(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return e===1?t:new $n(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){const i=t instanceof $n?t:new $n(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3()}}static parseColorString(t){if(ri(LM[t]))return nnt(LM[t]);if(ri(Nf[t]))return fF(Nf[t]);const e=`${t}`.trim().toLowerCase(),i=DM(e);if(i!==void 0)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){const r=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Or(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseFloat(r[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){const r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),o=uy(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new Or(o.r,o.g,o.b,parseFloat(r[3]))}}constructor(t){const e=$n.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new Or(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){const{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){const r=this.color.opacity,o=u1(this.color.r,this.color.g,this.color.b),s=uy(Vi(t)?o.h:cF(t,0,360),Vi(e)?o.s:e>=0&&e<=1?100*e:e,Vi(i)?o.l:i<=1&&i>=0?100*i:i);return this.color=new Or(s.r,s.g,s.b,r),this}setRGB(t,e,i){return!Vi(t)&&(this.color.r=t),!Vi(e)&&(this.color.g=e),!Vi(i)&&(this.color.b=i),this}setHex(t){const e=`${t}`.trim().toLowerCase(),i=DM(e,!0);return i??this}setColorName(t){const e=Nf[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}clone(){return new $n(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=Hb(t.color.r),this.color.g=Hb(t.color.g),this.color.b=Hb(t.color.b),this}copyLinearToSRGB(t){return this.color.r=zb(t.color.r),this.color.g=zb(t.color.g),this.color.b=zb(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class Or{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),ri(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${_f(this.r)+_f(this.g)+_f(this.b)+(this.opacity===1?"":_f(255*this.opacity))}`}formatRgb(){const t=this.opacity;return`${t===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${t===1?")":`,${t})`}`}formatHsl(){const t=this.opacity,{h:e,s:i,l:r}=u1(this.r,this.g,this.b);return`${t===1?"hsl(":"hsla("}${e},${i}%,${r}%${t===1?")":`,${t})`}`}toString(){return this.formatHex()}}function ont(n){let t="",e="",i="";const r=n[0]==="#"?1:0;for(let o=r;o<n.length;o++)n[o]!=="#"&&(o<r+2?t+=n[o]:o<r+4?e+=n[o]:o<r+6&&(i+=n[o]));return[parseInt(t,16),parseInt(e,16),parseInt(i,16)]}function snt(n,t,e){return Number((1<<24)+(n<<16)+(t<<8)+e).toString(16).slice(1)}function ant(n,t){const e=n.r,i=t.r,r=n.g,o=t.g,s=n.b,a=t.b,l=n.opacity,u=t.opacity;return h=>{const d=Math.round(e*(1-h)+i*h),c=Math.round(r*(1-h)+o*h),f=Math.round(s*(1-h)+a*h);return new Or(d,c,f,l*(1-h)+u*h)}}const lnt=Object.freeze(Object.defineProperty({__proto__:null,Color:$n,DEFAULT_COLORS:Nf,RGB:Or,hexToRgb:ont,hslToRgb:uy,interpolateRgb:ant,rgbToHex:snt,rgbToHsl:u1},Symbol.toStringTag,{value:"Module"}));function unt(n){try{return n instanceof Element}catch{const e=["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"],i=Object.keys(n);return e.every(r=>i.includes(r))}}const hnt=(n,t)=>{var e,i;if(!(t!=null&&t.fields)||n.length===0)return n;const r=t.fields,o=n[0],s={},a=[];for(const l in r)if(Object.prototype.hasOwnProperty.call(r,l)){const u=r[l];if(!u.type){let d=o;l in o||(d=(e=n.find(c=>l in c))!==null&&e!==void 0?e:o),u.type=typeof d[l]=="number"?"linear":"ordinal"}let h;if(typeof u.sortIndex=="number"&&(h={key:l,type:u.type,index:u.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:u.sortReverse===!0},a.push(h)),((i=u.domain)===null||i===void 0?void 0:i.length)>0)if(u.type==="ordinal"){u._domainCache={},s[l]=u;const d={};u.domain.forEach((c,f)=>{d[c]=f,u._domainCache[c]=f}),h&&(h.sortIndex=d,h.sortIndexCount=u.domain.length)}else u.domain.length>=2&&(s[l]=u)}return Object.keys(s).length>0&&(n=n.filter(l=>{for(const u in s){const h=s[u];if(h.type==="ordinal"){if(!(l[u]in h._domainCache))return!1}else if(h.domain[0]>l[u]||h.domain[1]<l[u])return!1}return!0})),a.sort((l,u)=>l.index-u.index),n.sort((l,u)=>dnt(l,u,a)),n};function dnt(n,t,e){for(let i=0;i<e.length;i++){const r=e[i];let o=0;if(r.type==="ordinal"?(r.sortIndex[t[r.key]]===void 0&&(r.sortIndex[t[r.key]]=r.sortIndexCount++),r.sortIndex[n[r.key]]===void 0&&(r.sortIndex[n[r.key]]=r.sortIndexCount++),o=r.sortIndex[n[r.key]]-r.sortIndex[t[r.key]]):r.type==="linear"&&(o=n[r.key]-t[r.key]),r.sortReverse&&(o=-o),o!==0)return o}return 0}let Nb=0;const cnt=1e8;function gF(n="dataset"){return Nb>cnt&&(Nb=0),n+"_"+Nb++}class fnt{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new ol,i=t!=null&&t.name?t.name:gF("dataset"),this.name=i,this._logger=(e=t==null?void 0:t.logger)!==null&&e!==void 0?e:xr.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&((i=this._logger)===null||i===void 0||i.error(`Error: dataView ${t} 之前已存在，请重新命名`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&((i=this._logger)===null||i===void 0||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&((i=this._logger)===null||i===void 0||i.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let r=this._callMap.get(i);r||(r=()=>{t.some(o=>o.isRunning)||i()}),t.forEach(o=>{o.target.addListener(e,r)}),this._callMap.set(i,r)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){const r=this._callMap.get(i);r&&t.forEach(o=>{o.target.removeListener(e,r)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.markRunning()}),t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.parseNewData(e.data,e.options)})}multipleDataViewUpdateInRawData(t){t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.markRunning()}),t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.updateRawData(e.data,e.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}const Wb="_data-view-diff-rank";let pF=class mF{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new ol,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(r={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(o=>{this.executeTransform(o,{pushHistory:r.pushHistory,emitMessage:!1}),this.isLastTransform(o)&&this.diffLastData()}),this.isRunning=!1,r.emitMessage!==!1&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=e!=null&&e.name?e.name:gF("dataview"),this.name=i,e!=null&&e.history&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(e==null?void 0:e.fields)}parse(t,e,i=!1){var r;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);const o=this.cloneParseData(t,e);if(e!=null&&e.type){const s=((r=this.dataSet.getParser(e.type))!==null&&r!==void 0?r:this.dataSet.getParser("bytejson"))(o,e.options,this);this.rawData=o,this.parserData=s,this.history&&this.historyData.push(o,s),this.latestData=s}else this.parserData=o,this.rawData=o,this.history&&this.historyData.push(o),this.latestData=o;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if(t.type==="fields"){this._fields=t.options.fields;const r=this.transformsArr.findIndex(o=>o.type===t.type);r>=0&&(i=!1,this.transformsArr[r].options.fields=this._fields)}if(i&&this.transformsArr.push(t),e){const r=this.isLastTransform(t);this.executeTransform(t),r&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(t){return this.transformsArr[this.transformsArr.length-1]===t}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,r;return((i=t.level)!==null&&i!==void 0?i:0)-((r=e.level)!==null&&r!==void 0?r:0)})}executeTransform(t,e={pushHistory:!0,emitMessage:!0}){const{pushHistory:i,emitMessage:r}=e,o=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&i!==!1&&this.historyData.push(o),this.latestData=o,r!==!1&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var t;if(!this._diffData||!this.latestData.forEach||!(!((t=this._diffKeys)===null||t===void 0)&&t.length))return;const e=this._diffRank+1;if(this._diffRank===0)this.latestData.forEach(i=>{i[Wb]=e,this._diffMap.set(this._diffKeys.reduce((r,o)=>r+i[o],""),i)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let i;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(r=>{r[Wb]=e,i=this._diffKeys.reduce((o,s)=>o+r[s],""),this._diffMap.get(i)?this.latestDataAUD.update.push(r):this.latestDataAUD.add.push(r),this._diffMap.set(i,r)}),this._diffMap.forEach((r,o)=>{r[Wb]<e&&(this.latestDataAUD.del.push(r),this._diffMap.delete(o))})}this._diffRank=e}cloneParseData(t,e){let i=!1;return t instanceof mF||(e==null?void 0:e.clone)!==!0||(i=!0),i?aF(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){const i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:((t=this.parseOption)===null||t===void 0?void 0:t.type)==="dataview"&&this.rawData.length===1&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?$rt({},this._fields,t):t;const i=this.transformsArr.find(r=>r.type==="fields");!Vi(this._fields)&&Vi(i)?(this.dataSet.registerTransform("fields",hnt),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}};function gnt(n){return n instanceof pF}function Rl(n,t=["data"]){const e=n;let i;if(!ri(e)||typeof e!="object"||gnt(e)||unt(e))return e;const r=rl(e),o=e.length;i=r?new Array(o):typeof e=="object"?{}:nF(e)||Ar(e)||oF(e)?e:sF(e)?new Date(+e):void 0;const s=r?void 0:Object.keys(Object(e));let a=-1;if(i)for(;++a<(s||e).length;){const l=s?s[a]:a,u=e[l];t!=null&&t.includes(l.toString())?i[l]=u:i[l]=Rl(u,t)}return i}function vF(n){var t,e;const i=Object.assign({},n);return or(n.style)||(i.textStyle=mi(n.style)),or(n.textStyle)||Ie(i.textStyle,mi(n.textStyle)),!((t=n.shape)===null||t===void 0)&&t.style&&mi(i.shape.style),!((e=n.background)===null||e===void 0)&&e.style&&mi(i.background.style),i}function mi(n){return or(n)||n.angle&&(n.angle=gp(n.angle)),n}function qn(n={}){return or(n.style)||(n.style=mi(n.style)),or(n.state)||Object.keys(n.state).forEach(t=>{or(n.state[t])||(n.state[t]=mi(n.state[t]))}),n}function ca(n){return or(n)?null:(Object.keys(n).forEach(t=>{or(n[t])||(n[t]=mi(n[t]))}),n)}function pnt(n){return qn(n),qn(n.startSymbol),qn(n.endSymbol),n}const mnt={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},ru="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",nu=14,Dh={LABEL_FONT_SIZE:14,AXIS_TICK_SIZE:4},rm={domainLine:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:Dh.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:Dh.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:Dh.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:Dh.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function vnt(n){var t,e;return!((e=(t=n==null?void 0:n.colorScheme)===null||t===void 0?void 0:t.default)===null||e===void 0)&&e.palette?Ie({},rm,{tick:{style:{stroke:n.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:n.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:n.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:n.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):rm}function IM(n){var t,e,i,r,o,s,a,l,u,h,d,c,f;const g=Ie({},n);let m,p=(e=(t=g.title)===null||t===void 0?void 0:t.angle)!==null&&e!==void 0?e:0;g.orient!=="left"&&g.orient!=="right"||!((i=g.title)===null||i===void 0)&&i.autoRotate&&xe(g.title.angle)&&(p=g.orient==="left"?-90:90,m=mnt[g.orient]);const v=uK(g.label,["style","formatMethod","state"]);return{orient:g.orient,select:g.select,hover:g.hover,line:pnt(g.domainLine),label:Object.assign({style:mi(g.label.style),formatMethod:g.label.formatMethod?(b,C,y)=>g.label.formatMethod(C.rawValue,C):null,state:ca(g.label.state)},v),tick:{visible:g.tick.visible,length:g.tick.tickSize,inside:g.tick.inside,alignWithLabel:g.tick.alignWithLabel,style:mi(g.tick.style),state:ca(g.tick.state),dataFilter:g.tick.dataFilter},subTick:{visible:g.subTick.visible,length:g.subTick.tickSize,inside:g.subTick.inside,count:g.subTick.tickCount,style:mi(g.subTick.style),state:ca(g.subTick.state)},grid:{type:"line",visible:g.grid.visible,alternateColor:g.grid.alternateColor,alignWithLabel:g.grid.alignWithLabel,style:mi(g.grid.style)},subGrid:{type:"line",visible:g.subGrid.visible,alternateColor:g.subGrid.alternateColor,style:mi(g.subGrid.style)},title:{visible:g.title.visible,position:g.title.position,space:g.title.space,autoRotate:!1,angle:p?gp(p):null,textStyle:Ie({},m,mi(g.title.style)),padding:g.title.padding,shape:{visible:(r=g.title.shape)===null||r===void 0?void 0:r.visible,space:(o=g.title.shape)===null||o===void 0?void 0:o.space,style:mi((s=g.title.shape)===null||s===void 0?void 0:s.style)},background:{visible:(a=g.title.background)===null||a===void 0?void 0:a.visible,style:mi((l=g.title.background)===null||l===void 0?void 0:l.style)},state:{text:ca(g.title.state),shape:ca((u=g.title.shape)===null||u===void 0?void 0:u.state),background:ca((h=g.title.background)===null||h===void 0?void 0:h.state)}},panel:{visible:(d=g.background)===null||d===void 0?void 0:d.visible,style:mi((c=g.background)===null||c===void 0?void 0:c.style),state:ca((f=g.background)===null||f===void 0?void 0:f.state)}}}function bnt(n,t,e){var i;const r=e.getRawChartSpec(n,t);if(r!=null&&r.series){const o={};return!((i=r.data)===null||i===void 0)&&i.id&&(o[r.data.id]=void 0),r==null||r.series.forEach(s=>{var a,l,u,h,d,c,f,g,m,p,v;if(!(!((a=s.data)===null||a===void 0)&&a.fromDataId))if(!((l=s.data)===null||l===void 0)&&l.transforms)o[(v=(m=(g=s.data)===null||g===void 0?void 0:g.id)!==null&&m!==void 0?m:(p=r.data)===null||p===void 0?void 0:p.id)!==null&&v!==void 0?v:"data"]=void 0;else{const b=s.direction==="horizontal"?s.xField:s.yField;o[(c=(h=(u=s.data)===null||u===void 0?void 0:u.id)!==null&&h!==void 0?h:(d=r.data)===null||d===void 0?void 0:d.id)!==null&&c!==void 0?c:"data"]=!((f=s.data)===null||f===void 0)&&f.id?b:void 0}}),o}return r.data.id}function _nt(n){let t=!1;for(let e=0;e<n.columnObjects.length;e++)if(n.columnObjects[e].chartSpec){t=!0;break}return t}function Cnt(n,t,e){var i,r,o;if(n===-1||t===-1)return{start:{col:n,row:t},end:{col:n,row:t}};if(e._cellRangeMap.has(`$${n}$${t}`))return e._cellRangeMap.get(`$${n}$${t}`);let s={start:{col:n,row:t},end:{col:n,row:t}};if(e.transpose)s=wnt(n,t,e);else if(e.headerLevelCount<=t){if(e.headerLevelCount<=t&&(!((r=(i=e.columnObjects[n-e.leftRowSeriesNumberColumnCount])===null||i===void 0?void 0:i.define)===null||r===void 0)&&r.mergeCell)){const a=e._table.getCellValue(n,t);for(let l=t-1;l>=e.headerLevelCount;l--){const u=e._table.getCellValue(n,l);if(typeof e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell=="boolean"){if(a!==u)break}else if(!e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell(a,u,{source:{col:n,row:t},target:{col:n,row:l},table:e._table}))break;s.start.row=l}for(let l=t+1;l<e.rowCount;l++){const u=e._table.getCellValue(n,l);if(typeof e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell=="boolean"){if(a!==u)break}else if(!e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell(a,u,{source:{col:n,row:t},target:{col:n,row:l},table:e._table}))break;s.end.row=l}}ynt(n,t,s,e)}else{const a=e.getCellId(n,t);for(let l=n-1;l>=0&&a===e.getCellId(l,t);l--)s.start.col=l;for(let l=n+1;l<((o=e.colCount)!==null&&o!==void 0?o:0)&&a===e.getCellId(l,t);l++)s.end.col=l;for(let l=t-1;l>=0&&a===e.getCellId(n,l);l--)s.start.row=l;for(let l=t+1;l<e.headerLevelCount&&a===e.getCellId(n,l);l++)s.end.row=l}return e._cellRangeMap.set(`$${n}$${t}`,s),s}function ynt(n,t,e,i){var r;if(i.rowHierarchyType!=="tree")return;const o=i._table.getCellRawRecord(n,t);!((r=i._table.internalProps.rowSeriesNumber)===null||r===void 0)&&r.enableTreeCheckbox?o!=null&&o.vtableMerge&&n>=i.leftRowSeriesNumberColumnCount&&(e.start.col=i.rowHeaderLevelCount+i.leftRowSeriesNumberColumnCount,e.end.col=i.colCount-1,e.start.row=e.end.row=t):o!=null&&o.vtableMerge&&(e.start.col=i.rowHeaderLevelCount,e.end.col=i.colCount-1,e.start.row=e.end.row=t)}function wnt(n,t,e){var i,r,o,s;const a={start:{col:n,row:t},end:{col:n,row:t}};if(e.headerLevelCount+e.leftRowSeriesNumberColumnCount<=n||n===-1&&t===-1){if(e.headerLevelCount+e.leftRowSeriesNumberColumnCount<=n&&(!((r=(i=e.columnObjects[t])===null||i===void 0?void 0:i.define)===null||r===void 0)&&r.mergeCell)){const u=e._table.getCellValue(n,t);for(let h=n-1;h>=e.headerLevelCount+e.leftRowSeriesNumberColumnCount;h--){const d=e._table.getCellValue(h,t);if(typeof e.columnObjects[t].define.mergeCell=="boolean"){if(u!==d)break}else if(!e.columnObjects[t].define.mergeCell(u,d,{source:{col:n,row:t},target:{col:h,row:t},table:e._table}))break;a.start.col=h}for(let h=n+1;h<((o=e.colCount)!==null&&o!==void 0?o:0);h++){const d=e._table.getCellValue(h,t);if(typeof e.columnObjects[t].define.mergeCell=="boolean"){if(u!==d)break}else if(!e.columnObjects[t].define.mergeCell(u,d,{source:{col:n,row:t},target:{col:h,row:t},table:e._table}))break;a.end.col=h}}return a}const l=e.getCellId(n,t);for(let u=t-1;u>=0&&l===e.getCellId(n,u);u--)a.start.row=u;for(let u=t+1;u<((s=e.rowCount)!==null&&s!==void 0?s:0)&&l===e.getCellId(n,u);u++)a.end.row=u;for(let u=n-1;u>=0&&l===e.getCellId(u,t);u--)a.start.col=u;for(let u=n+1;u<e.headerLevelCount+e.leftRowSeriesNumberColumnCount&&l===e.getCellId(u,t);u++)a.end.col=u;return a}class Snt{constructor(t,e,i,r){var o,s;this.seqId=0,this._columnMaxDepth=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=i,this._table=t,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this._columnMaxDepth=this._calculateMaxDepth(e),this.hierarchyIndent=r??20,this.hierarchyTextStartAlignment=t.options.hierarchyTextStartAlignment,this.columnHierarchyType=t.options.headerHierarchyType,this.columnExpandLevel=(o=t.options.headerExpandLevel)!==null&&o!==void 0?o:1,this.columnTree=new lrt(e,{seqId:0},(s=this.columnHierarchyType)!==null&&s!==void 0?s:null,this.columnHierarchyType==="grid-tree"?this.columnExpandLevel:void 0),this._headerObjectsIncludeHided=this._addHeaders(0,e,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(a=>a.define.hide!==!0),this._headerObjectMap=this._headerObjects.reduce((a,l)=>(a[l.id]=l,a),{}),this.rowHierarchyType=crt(this)?"tree":"grid",this._hasAggregation=urt(this),this._hasAggregationOnBottomCount=drt(this),this._hasAggregationOnTopCount=hrt(this),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber)}handleRowSeriesNumber(t){var e,i;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map((r,o)=>{var s,a;return{id:this.seqId++,title:r.title,define:Ie({field:"_vtable_rowSeries_number_"+o},r),cellType:(s=r.cellType)!==null&&s!==void 0?s:"text",headerType:r.cellType==="checkbox"?"checkbox":"text",style:r.style,width:r.width,format:r.format,field:(a=r.field)!==null&&a!==void 0?a:"_vtable_rowSeries_number_"+o,icon:r.icon,headerIcon:r.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:t.title,define:Ie({field:"_vtable_rowSeries_number"},t),cellType:(e=t.cellType)!==null&&e!==void 0?e:"text",headerType:t.cellType==="checkbox"?"checkbox":"text",style:t.style,width:t.width,format:t.format,field:(i=t.field)!==null&&i!==void 0?i:"_vtable_rowSeries_number",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(r=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(r=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(t){this._transpose=t}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}isSeriesNumberInHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}if(this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(t,e){return!!(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)||this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount))}isSeriesNumber(t,e){return!!(et(t)&&et(e)&&(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(e<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount){if(this.transpose)return;if(e<this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}getSeriesNumberBody(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return this.leftRowSeriesNumberColumn[t];if(e>=this.headerLevelCount)return this.leftRowSeriesNumberColumn[t]}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)];if(e>=this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}isHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&e>=0&&e<this.headerLevelCount}isAggregation(t,e){if(this.hasAggregation){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}}return!1}isTopAggregation(t,e){if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isBottomAggregation(t,e){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(t,e){return this.getColumnDefine(t,e).vtable_aggregator}getAggregatorsByCellRange(t,e,i,r){let o=[];if(!this.transpose){for(let s=t;s<=i;s++){const a=this.getColumnDefine(s,e);a.vtable_aggregator&&(o=o.concat(Array.isArray(a.vtable_aggregator)?a.vtable_aggregator:[a.vtable_aggregator]))}return o}for(let s=e;s<=r;s++){const a=this.getColumnDefine(t,s);a.vtable_aggregator&&(o=o.concat(Array.isArray(a.vtable_aggregator)?a.vtable_aggregator:[a.vtable_aggregator]))}return[]}getAggregatorOnTop(t,e){const i=this.getColumnDefine(t,e),r=i.vtable_aggregator,o=i.aggregation;if(Array.isArray(o)){const s=o.reduce((a,l,u)=>(l.showOnTop&&a.push(u),a),[]).map(a=>r[a]);return this.transpose?s[t-this.rowHeaderLevelCount]:s[e-this.columnHeaderLevelCount]}return this.transpose&&t-this.rowHeaderLevelCount==0?o!=null&&o.showOnTop?r:null:this.transpose||e-this.columnHeaderLevelCount!=0?null:o!=null&&o.showOnTop?r:null}getAggregatorOnBottom(t,e){const i=this.getColumnDefine(t,e),r=i.vtable_aggregator,o=i.aggregation;if(Array.isArray(o)){const s=o.reduce((a,l,u)=>(l.showOnTop||a.push(u),a),[]).map(a=>r[a]);return this.transpose?s[t-(this.colCount-this.hasAggregationOnBottomCount)]:s[e-(this.rowCount-this.hasAggregationOnBottomCount)]}return this.transpose&&t-(this.colCount-this.hasAggregationOnBottomCount)==0?o!=null&&o.showOnTop?null:r:this.transpose||e-(this.rowCount-this.hasAggregationOnBottomCount)!=0||o!=null&&o.showOnTop?null:r}getAggregatorCellAddress(t,e,i,r){const o=[],s=this.hasAggregationOnTopCount,a=this.hasAggregationOnBottomCount;if(this.transpose){for(let l=e;l<=r;l++)if(this.getColumnDefine(t,l).vtable_aggregator){for(let u=0;u<s;u++)o.push({col:this.headerLevelCount+u,row:l});for(let u=0;u<a;u++)o.push({col:this.rowCount-a+u,row:l})}}else for(let l=t;l<=i;l++)if(this.getColumnDefine(l,e).vtable_aggregator){for(let u=0;u<s;u++)o.push({col:l,row:this.headerLevelCount+u});for(let u=0;u<a;u++)o.push({col:l,row:this.rowCount-a+u})}return o}getCellLocation(t,e){return this.isHeader(t,e)?this.transpose?"rowHeader":"columnHeader":"body"}isRowHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(t,e){return!this.transpose&&e>=0&&e<=this.headerLevelCount-1&&t>=this.leftRowSeriesNumberColumnCount&&t<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(t,e){if(et(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if(et(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if(et(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if(et(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(t,e){return!1}getColumnHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:((t=this.rowCount)!==null&&t!==void 0?t:0)-1}}:{start:{col:0,row:0},end:{col:((e=this.colCount)!==null&&e!==void 0?e:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:((t=this.rowCount)!==null&&t!==void 0?t:0)-1}}:{start:{col:0,row:0},end:{col:((e=this.colCount)!==null&&e!==void 0?e:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var t,e,i,r;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:((t=this.colCount)!==null&&t!==void 0?t:0)-1,row:((e=this.rowCount)!==null&&e!==void 0?e:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:((i=this.colCount)!==null&&i!==void 0?i:0)-1,row:((r=this.rowCount)!==null&&r!==void 0?r:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(t){this._recordsCount=t}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){if(this.leftRowSeriesNumberColumnCount){const t=this.leftRowSeriesNumberColumn.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}));return t.push(...this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))),t}return this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))}getColumnWidthDefined(t){var e;if(t>=0){if(t<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[t];if(this.transpose){let i,r,o=0;if(t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let s;return this.columnObjects.forEach((a,l)=>{typeof a.width=="number"?o=Math.max(a.width,o):a.width==="auto"&&(s=!0),typeof a.minWidth=="number"&&(r=Math.max(a.minWidth,r)),typeof a.maxWidth=="number"&&(i=Math.max(a.maxWidth,i))}),o=o>0?o:s?"auto":void 0,{width:o,minWidth:r,maxWidth:i}}if(this.isRowHeader(t,0)){const s=Array.isArray(this._table.defaultHeaderColWidth)?(e=this._table.defaultHeaderColWidth[t])!==null&&e!==void 0?e:this._table.defaultColWidth:this._table.defaultHeaderColWidth;return s==="auto"?{width:"auto"}:{width:s}}}return this._columns[t-this.leftRowSeriesNumberColumnCount]}}getCellId(t,e){var i,r,o,s;return this.transpose?t>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?(i=this._columns[e])===null||i===void 0?void 0:i.id:this.isSeriesNumber(t,e)?e+"_series_number":(r=this._headerCellIds[t-this.leftRowSeriesNumberColumnCount])===null||r===void 0?void 0:r[e]:this.isSeriesNumber(t,e)?this.rowSeriesNumberColumn[t].id:this.headerLevelCount<=e?(o=this._columns[t-this.leftRowSeriesNumberColumnCount])===null||o===void 0?void 0:o.id:(s=this._headerCellIds[e])===null||s===void 0?void 0:s[t-this.leftRowSeriesNumberColumnCount]}getHeader(t,e){if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);const i=this.getCellId(t,e);return this._headerObjectMap[i]}getHeaderField(t,e){var i,r,o;if(this.isSeriesNumberInHeader(t,e))return(i=this.getSeriesNumberHeader(t,e))===null||i===void 0?void 0:i.field;if(this.isSeriesNumberInBody(t,e))return(r=this.getSeriesNumberBody(t,e))===null||r===void 0?void 0:r.field;const s=this.getCellId(t,e);return((o=this._headerObjectMap[s])===null||o===void 0?void 0:o.field)||(this.transpose?this._columns[e]&&this._columns[e].field:this._columns[t-this.leftRowSeriesNumberColumnCount]&&this._columns[t-this.leftRowSeriesNumberColumnCount].field)}getHeaderCellAdressById(t){for(let e=0;e<this._headerCellIds.length;e++){const i=this._headerCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return this.transpose?{col:e,row:r}:{col:r+this.leftRowSeriesNumberColumnCount,row:e}}}getHeaderCellAddressByField(t){const e=this.headerObjects.find(i=>i&&i.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){return this.isSeriesNumber(t,e)?this.getSeriesNumberBody(t,e):this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(t){var e,i;if(this.transpose){for(let r=0;r<((e=this.rowCount)!==null&&e!==void 0?e:0);r++)if(t===this._columns[r].id)return{start:{col:0,row:r},end:{col:0,row:r}}}else for(let r=this.leftRowSeriesNumberColumnCount;r<((i=this.colCount)!==null&&i!==void 0?i:0);r++)if(t===this._columns[r-this.leftRowSeriesNumberColumnCount].id)return{start:{col:r,row:0},end:{col:r,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(t,e){return Cnt(t,e,this)}isCellRangeEqual(t,e,i,r){const o=this.getCellRange(t,e),s=this.getCellRange(i,r);return o.start.col===s.start.col&&o.end.col===s.end.col&&o.start.row===s.start.row&&o.end.row===s.end.row}getRecordShowIndexByCell(t,e){const i=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?t<i?-1:t-i:e<i?-1:e-i}getRecordStartRowByRecordIndex(t){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+t}_calculateMaxDepth(t,e=0){let i=e;return t.forEach(r=>{if(r.columns&&r.columns.length>0){const o=this._calculateMaxDepth(r.columns,e+1);o>i&&(i=o)}}),i}_addHeaders(t,e,i,r,o){const s=[],a=this._newRow(t,r);return e.forEach(l=>{var u,h,d,c;const f=this._columns.length,g=this.seqId++,m={id:g,title:(u=l.title)!==null&&u!==void 0?u:l.caption,headerIcon:l.headerIcon,field:l.field,style:l.headerStyle,headerType:(h=l.headerType)!==null&&h!==void 0?h:"text",dropDownMenu:l.dropDownMenu,define:l,hierarchyState:l.hierarchyState,columnWidthComputeMode:l.columnWidthComputeMode};s[g]=m;let p=t;if(l.levelSpan){p=Math.min(t+l.levelSpan-1,this._columnMaxDepth-1);for(let b=t;b<=p;b++)this._headerCellIds[b]||(this._headerCellIds[b]=[]),this._headerCellIds[b][f]===void 0&&(this._headerCellIds[b][f]=g)}if(o)for(let b=p-1;b>=0;b--)this._headerCellIds[b]&&this._headerCellIds[b][f]===void 0&&i[p-o]!==void 0&&(this._headerCellIds[b][f]=i[p-o]);else for(let b=p-1;b>=0;b--)this._headerCellIds[b]&&this._headerCellIds[b][f]===void 0&&i[b]!==void 0&&(this._headerCellIds[b][f]=i[b]);r?this._headerCellIds[t-1]&&this._headerCellIds[t-1][f]!==void 0&&(a[f]=this._headerCellIds[t-1][f]):a[f]=g;const v=!l.hierarchyState||l.hierarchyState===Yt.expand;if(l.columns&&v)!l.columns.every(b=>b.hide)&&this._addHeaders(p+1,l.columns,[...i,g],l.hideColumnsSubHeader||r,l.levelSpan).forEach(b=>s.push(b));else{const b={id:this.seqId++,field:l.field,fieldFormat:l.fieldFormat,width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth,icon:l.icon,cellType:(c=(d=l.cellType)!==null&&d!==void 0?d:l.columnType)!==null&&c!==void 0?c:"text",chartModule:"chartModule"in l?l.chartModule:null,chartSpec:"chartSpec"in l?l.chartSpec:null,sparklineSpec:"sparklineSpec"in l?l.sparklineSpec:_Z,style:l.style,define:l,columnWidthComputeMode:l.columnWidthComputeMode,disableColumnResize:l==null?void 0:l.disableColumnResize,aggregation:l.aggregation,isChildNode:t>=1};if(this._columnsIncludeHided.push(b),l.hide!==!0){this._columns.push(b);for(let C=t+1;C<this._headerCellIds.length;C++)this._headerCellIds[C][f]=g}}}),s}_newRow(t,e=!1){if(this._headerCellIds[t]){const o=this._headerCellIds[t-1];if(o.length>this._headerCellIds[t].length)for(let s=this._headerCellIds[t].length;s<o.length;s++)this._headerCellIds[t][s]=o[s];return this._headerCellIds[t]}if(e)return[];const i=this._headerCellIds[t]=[];if(!this._columns.length)return i;const r=this._headerCellIds[t-1];for(let o=0;o<r.length;o++)i[o]=r[o];return i}getCellHeaderPaths(t,e){if(this.isSeriesNumber(t,e))return;let i=[],r=[];return this.transpose?r=[{field:this._columns[e].field}]:i=[{field:this._columns[t-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:i,rowHeaderPaths:r,cellLocation:this.getCellLocation(t,e)}}getParentCellId(t,e){if(e!==0){if(this.isColumnHeader(t,e))return this.getCellId(t,e-1);if(this.isRowHeader(t,e))return this.isSeriesNumberInBody(t-1,e)?void 0:this.getCellId(t-1,e)}}canMoveHeaderPosition(t,e){if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row))return!1;if(!this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)){const r=this.getRecordShowIndexByCell(0,t.row),o=this.getRecordShowIndexByCell(0,e.row);return this._table.dataSource.canChangeOrder(r,o)}if(this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)&&(this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode&&this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode?(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(t.col=t.col+this.leftRowSeriesNumberColumnCount,e.col=e.col+this.leftRowSeriesNumberColumnCount)),t.col<0||t.row<0||e.col<0||e.row<0||this._table.internalProps.frozenColDragHeaderMode==="disabled"&&this._table.isFrozenColumn(e.col))return!1;const i=this.getCellRange(t.col,t.row);return this.isColumnHeader(t.col,t.row)?this.getParentCellId(t.col,i.start.row)===this.getParentCellId(e.col,i.start.row):this.isRowHeader(t.col,t.row)?this.getParentCellId(i.start.col,t.row)===this.getParentCellId(i.start.col,e.row):!1}moveHeaderPosition(t,e){var i,r;if((!(!((i=this._table.options.dragOrder)===null||i===void 0)&&i.validateDragOrderOnEnd)||!((r=this._table.options.dragOrder)===null||r===void 0)&&r.validateDragOrderOnEnd(t,e))&&this.canMoveHeaderPosition(t,e)){let o=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){const s=o.end.col-o.start.col+1;let a;const l=this.getCellRange(e.col,o.start.row);if(a=e.col>=t.col?l.end.col-s+1:l.start.col,a===o.start.col)return null;for(let h=0;h<this._headerCellIds.length;h++){const d=this._headerCellIds[h].splice(o.start.col-this.leftRowSeriesNumberColumnCount,s);d.unshift(a-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[h],d)}const u=this._columns.splice(o.start.col-this.leftRowSeriesNumberColumnCount,s);return u.unshift(a-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,u),this.columnTree.movePosition(o.start.row,o.start.col-this.leftRowSeriesNumberColumnCount,a-this.leftRowSeriesNumberColumnCount),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:o.start.col,targetIndex:a,sourceSize:s,targetSize:l.end.col-l.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)||this.isSeriesNumberInBody(t.col,t.row)&&this.transpose){this.isSeriesNumberInBody(t.col,t.row)&&(o=this.getCellRange(t.col+this.leftRowSeriesNumberColumnCount,t.row));const s=o.end.row-o.start.row+1;let a;const l=this.getCellRange(o.start.col,e.row);if(a=e.row>=t.row?l.end.row-s+1:l.start.row,a===o.start.row)return null;for(let h=0;h<this._headerCellIds.length;h++){const d=this._headerCellIds[h].splice(o.start.row,s);d.unshift(a,0),Array.prototype.splice.apply(this._headerCellIds[h],d)}const u=this._columns.splice(o.start.row,s);return u.unshift(a,0),Array.prototype.splice.apply(this._columns,u),this.columnTree.movePosition(o.start.col-this.leftRowSeriesNumberColumnCount,o.start.row,a+(e.row>t.row?o.end.row-o.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:o.start.row,targetIndex:a,sourceSize:s,targetSize:l.end.row-l.start.row+1,moveType:"row"}}if(this.isSeriesNumberInBody(t.col,t.row))return{sourceIndex:t.row,targetIndex:e.row,sourceSize:1,targetSize:1,moveType:"row"}}return null}toggleHierarchyState(t){return{addCellPositions:t.add.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e})),removeCellPositions:t.remove.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e}))}}setChartInstance(t,e,i){const r=this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount];typeof r.chartSpec!="function"&&(r.chartInstance=i)}getChartInstance(t,e){return(this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return _nt(this)}getAxisConfigInPivotChart(t,e){}isEmpty(t,e){return!1}isAxisCell(t,e){return!1}getChartAxes(t,e){return[]}isShareChartSpec(t,e){const i=this.getBody(t,e);return typeof(i==null?void 0:i.chartSpec)!="function"}isNoChartDataRenderNothing(t,e){const i=this.getBody(t,e);return(i==null?void 0:i.define).noDataRenderNothing}getChartSpec(t,e){return this.getRawChartSpec(t,e)}getRawChartSpec(t,e){const i=this.getBody(t,e),r=i==null?void 0:i.chartSpec;return typeof r=="function"?r({col:t,row:e,dataValue:this._table.getCellOriginValue(t,e)||"",value:this._table.getCellValue(t,e)||"",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(t,e)),table:this._table}):r}getChartDataId(t,e){return bnt(t,e,this)}release(){const t=this._table._getActiveChartInstance();t==null||t.release(),this.columnObjects.forEach(e=>{var i;(i=e.chartInstance)===null||i===void 0||i.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(t,e,i){const r=this._table.internalProps.layoutMap.getHeader(t,e);r.title=i,r.define.title=i}getColumnByField(t){var e;return(e=this.columnObjects)===null||e===void 0?void 0:e.reduce((i,r,o)=>(r.field===t&&i.push({col:o,columnDefine:r}),i),[])}getColumnByKey(t){var e;let i;return{columnDefine:(e=this.columnObjects)===null||e===void 0?void 0:e.find((r,o)=>{var s;return((s=r.define)===null||s===void 0?void 0:s.key)===t&&(i=o+this.leftRowSeriesNumberColumnCount,!0)}),col:i}}getColumnDefine(t,e){if(t>=0)return t<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[t].define:this.transpose?this._columns[e].define:this._columns[t-this.leftRowSeriesNumberColumnCount].define}}class xnt{constructor(t){this.isValidatingValue=!1,this.listenersId=[],this.table=t,this.bindEvent()}bindEvent(){const t=this.table,e=t.on(ut.DBLCLICK_CELL,r=>{var o,s,a;const{editCellTrigger:l="doubleclick"}=t.options;if(!l.includes("doubleclick"))return;const{col:u,row:h}=r,d=Ii(r.federatedEvent),c=t.scenegraph.getResizeColAt(d.abstractPos.x,d.abstractPos.y,(o=d.eventArgs)===null||o===void 0?void 0:o.targetCell);t._canResizeColumn(c.col,c.row)&&c.col>=0||!((a=(s=r.target)===null||s===void 0?void 0:s.attribute)===null||a===void 0)&&a.funcType||(this.beginTriggerEditCellMode="doubleclick",this.startEditCell(u,h))}),i=t.on(ut.CLICK_CELL,r=>{var o,s;const{editCellTrigger:a="doubleclick"}=t.options;if(a==="click"||Array.isArray(a)&&a.includes("click")){if(!((s=(o=r.target)===null||o===void 0?void 0:o.attribute)===null||s===void 0)&&s.funcType)return;this.beginTriggerEditCellMode="click";const{col:l,row:u}=r;this.startEditCell(l,u)}});this.listenersId.push(e,i)}startEditCell(t,e,i){var r,o,s,a,l,u,h,d,c;if(this.editingEditor)return;const f=this.table.getEditor(t,e);if(f){if(!((o=(r=this.table.internalProps.layoutMap)===null||r===void 0?void 0:r.isAggregation)===null||o===void 0)&&o.call(r,t,e)){const b=(a=(s=this.table).isPivotTable)===null||a===void 0?void 0:a.call(s),C=!!b&&((u=(l=this.table.internalProps)===null||l===void 0?void 0:l.dataConfig)===null||u===void 0?void 0:u.updateAggregationOnEditCell);if(!b||b&&C)return}const g=this.table.getCellRawRecord(t,e);if(g!=null&&g.vtableMerge)return;this.editingEditor||(this.editCell={col:t,row:e}),this.table._makeVisibleCell(t,e),this.editingEditor=f;const m=et(i)?i:this.table.getCellOriginValue(t,e),p=this.table.getCellRangeRelativeRect(this.table.getCellRange(t,e)),v={rect:{left:p.left,top:p.top,width:p.width,height:p.height}};t===this.table.colCount-1?v.rect.width=p.width-1:v.rect.width=p.width+1,e===this.table.rowCount-1?v.rect.height=p.height-1:v.rect.height=p.height+1,f.beginEditing,(h=f.beginEditing)===null||h===void 0||h.call(f,this.table.getElement(),v,m),f.bindSuccessCallback,(d=f.bindSuccessCallback)===null||d===void 0||d.call(f,()=>{this.completeEdit()}),(c=f.onStart)===null||c===void 0||c.call(f,{value:m,endEdit:()=>{this.completeEdit()},referencePosition:v,container:this.table.getElement(),col:t,row:e,table:this.table})}}completeEdit(t){var e,i;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;const r=t==null?void 0:t.target,{editingEditor:o}=this;if(r){if(o.targetIsOnEditor){if(o.targetIsOnEditor(r))return!1}else if(!o.isEditorElement||o.isEditorElement(r))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;const s=this.editingEditor.getValue(),a=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),l=(i=(e=this.editingEditor).validateValue)===null||i===void 0?void 0:i.call(e,s,a,this.editCell,this.table);return ao(l)?(this.isValidatingValue=!0,new Promise((u,h)=>{l.then(d=>{FM(d,this,a,u)}).catch(d=>{this.isValidatingValue=!1,h(d)})})):FM(l,this,a)}return this.doExit(),!0}doExit(){var t,e,i,r,o,s;const a=(e=(t=this.editingEditor).getValue)===null||e===void 0?void 0:e.call(t),l=this.table.getCellRange(this.editCell.col,this.editCell.row),u=[];for(let h=l.start.row;h<=l.end.row;h++){const d=[];for(let c=l.start.col;c<=l.end.col;c++)d.push(a);u.push(d)}this.table.changeCellValues(l.start.col,l.start.row,u),this.editingEditor.exit,(r=(i=this.editingEditor).exit)===null||r===void 0||r.call(i),(s=(o=this.editingEditor).onEnd)===null||s===void 0||s.call(o),this.editingEditor=null,this.isValidatingValue=!1,this.beginTriggerEditCellMode=null}cancelEdit(){var t,e,i,r;this.editingEditor&&((e=(t=this.editingEditor).exit)===null||e===void 0||e.call(t),(r=(i=this.editingEditor).onEnd)===null||r===void 0||r.call(i),this.editingEditor=null)}release(){this.listenersId.forEach(t=>{this.table.off(t)})}}function FM(n,t,e,i){return t.isValidatingValue=!1,n==="validate-exit"?(t.doExit(),i==null||i(!0),!0):n==="invalidate-exit"?(t.editingEditor.setValue(e),t.doExit(),i==null||i(!0),!0):n==="validate-not-exit"||n==="invalidate-not-exit"?(i==null||i(!1),!1):n===!0?(t.doExit(),i==null||i(!0),!0):(i==null||i(!1),!1)}function OM(n){return ei(n)?{groupByRules:[n]}:Wt(n)?{groupByRules:n.map(t=>ei(t)?t:t.key)}:{}}var Tnt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function Ant(n,t,e,i,r,o){if(i&&o.isHasEditorDefine(n,t)||i===!1){const s=o.getRecordShowIndexByCell(n,t),{field:a}=o.internalProps.layoutMap.getBody(n,t),l=o.getCellRawValue(n,t),u=o.getCellOriginValue(n,t);o.isHeader(n,t)?o.internalProps.layoutMap.updateColumnTitle(n,t,e):o.dataSource.changeFieldValue(e,s,a,n,t,o);const h=o.getCellRange(n,t),d=o.internalProps.layoutMap.getAggregatorsByCell(n,t);if(d){if(Array.isArray(d))for(let g=0;g<(d==null?void 0:d.length);g++)d[g].recalculate();else d.recalculate();const f=o.internalProps.layoutMap.getAggregatorCellAddress(h.start.col,h.start.row,h.end.col,h.end.row);for(let g=0;g<f.length;g++){const m=o.getCellRange(f[g].col,f[g].row);for(let p=m.start.col;p<=m.end.col;p++)for(let v=m.start.row;v<=m.end.row;v++)o.scenegraph.updateCellContent(p,v)}}for(let f=h.start.col;f<=h.end.col;f++)for(let g=h.start.row;g<=h.end.row;g++)o.scenegraph.updateCellContent(f,g);if(o.widthMode==="adaptive"||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)o.internalProps._widthResizedColMap.size===0&&o.scenegraph.recalculateColWidths();else if(!o.internalProps._widthResizedColMap.has(n)){const f=o.getColWidth(n),g=eu(n,0,o.rowCount-1,o,!1);g!==f&&o.scenegraph.updateColWidth(n,g-f)}if(o.heightMode==="adaptive"||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.internalProps._heightResizedRowMap.size===0&&o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight(t)&&!o.internalProps._heightResizedRowMap.has(t)){const f=o.getRowHeight(t),g=An(t,0,o.colCount-1,o);o.scenegraph.updateRowHeight(t,g-f)}const c=o.getCellOriginValue(n,t);u!==c&&r&&o.fireListeners(ut.CHANGE_CELL_VALUE,{col:n,row:t,rawValue:l,currentValue:u,changedValue:c}),o.scenegraph.updateNextFrame()}}function Rnt(n,t,e,i,r,o){var s,a;return Tnt(this,void 0,void 0,function*(){const l=[];let u=n,h=t;const d=[],c=[];let f;for(let v=0;v<e.length&&!(t+v>o.rowCount-1);v++){const b=e[v],C=[],y=[];d.push(C),c.push(y);for(let w=0;w<b.length&&!(n+w>o.colCount-1);w++){f=Ent(n+w,t+v,o,f);const _=o.getCellRawValue(n+w,t+v);C.push(_);const A=o.getCellOriginValue(n+w,t+v);y.push(A)}}for(let v=0;v<e.length&&!(t+v>o.rowCount-1);v++){l[v]=[],h=t+v;const b=e[v];let C=n;for(let y=0;y<b.length&&!(n+y>o.colCount-1);y++){C=n+y;let w=!1;if(i===!1)w=!0;else if(o.isHasEditorDefine(n+y,t+v)){const _=o.getEditor(n+y,t+v),A=c[v][y],T=b[y],S=(a=(s=_==null?void 0:_.validateValue)===null||s===void 0?void 0:s.call(_,T,A,{col:n+y,row:t+v},o))===null||a===void 0||a;if(ao(S)){const x=yield S;w=x===!0||x==="validate-exit"||x==="validate-not-exit"}else w=S===!0||S==="validate-exit"||S==="validate-not-exit"}if(w){l[v][y]=!0;const _=b[y],A=o.getRecordShowIndexByCell(n+y,t+v),{field:T}=o.internalProps.layoutMap.getBody(n+y,t+v),S=d[v][y],x=c[v][y];o.isHeader(n+y,t+v)?o.internalProps.layoutMap.updateColumnTitle(n+y,t+v,_):o.dataSource.changeFieldValue(_,A,T,n+y,t+v,o);const E=o.getCellOriginValue(n+y,t+v);x!==E&&r&&o.fireListeners(ut.CHANGE_CELL_VALUE,{col:n+y,row:t+v,rawValue:S,currentValue:x,changedValue:E})}else l[v][y]=!1}u=Math.max(u,C)}const g=o.getCellRange(n,t),m=o.getCellRange(u,h),p=o.internalProps.layoutMap.getAggregatorsByCellRange(g.start.col,g.start.row,m.end.col,m.end.row);if(p){for(let v=0;v<(p==null?void 0:p.length);v++)p[v].recalculate();if(f==="normal"){const v=o.internalProps.layoutMap.getAggregatorCellAddress(g.start.col,g.start.row,m.end.col,m.end.row);for(let b=0;b<v.length;b++){const C=o.getCellRange(v[b].col,v[b].row);for(let y=C.start.col;y<=C.end.col;y++)for(let w=C.start.row;w<=C.end.row;w++)o.scenegraph.updateCellContent(y,w)}}}if(f==="group"&&o.dataSource.updateRecordsForGroup([],[]),f==="sort"||f==="group")return o.dataSource.sortedIndexMap.clear(),$r(o),o.refreshRowColCount(),o.internalProps.layoutMap.clearCellRangeMap(),o.scenegraph.clearCells(),o.scenegraph.createSceneGraph(),l;for(let v=g.start.col;v<=m.end.col;v++)for(let b=g.start.row;b<=m.end.row;b++)o.scenegraph.updateCellContent(v,b);if(o.widthMode==="adaptive"||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)o.internalProps._widthResizedColMap.size===0&&o.scenegraph.recalculateColWidths();else for(let v=n;v<=m.end.col;v++)if(!o.internalProps._widthResizedColMap.has(v)){const b=o.getColWidth(v),C=eu(v,0,o.rowCount-1,o,!1);C!==b&&o.scenegraph.updateColWidth(v,C-b)}if(o.heightMode==="adaptive"||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight(t)){const v=[],b=[];for(let C=t;C<=m.end.row;C++)if(o.rowHeightsMap.get(C)){const y=o.getRowHeight(C),w=An(C,0,o.colCount-1,o);v.push(C),b.push(w-y)}o.scenegraph.updateRowsHeight(v,b)}return o.scenegraph.updateNextFrame(),l})}function Ent(n,t,e,i){if(i==="group"||i==="sort"&&!e.options.groupBy)return i;let r="normal";return e.options.groupBy?r="group":!e.isHeader(n,t)&&e.dataSource.lastOrderField&&e.getBodyField(n,t)===e.dataSource.lastOrderField&&(r="sort"),r}function $r(n){let t=n.sortState;t=!t||Array.isArray(t)?t:[t],t&&(t=t.map(e=>{var i;return e.orderFn=(i=n._getSortFuncFromHeaderOption(void 0,e.field))!==null&&i!==void 0?i:pp,e}),n.dataSource.sort(t))}function Mnt(n,t,e){var i,r,o,s;if(e.options.groupBy)(r=(i=e.dataSource).addRecordsForGroup)===null||r===void 0||r.call(i,[n],t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&$r(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(o=e.dataSource).addRecordsForTree)===null||s===void 0||s.call(o,[n],t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&$r(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.addRecordForSorted(n),$r(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{(t===void 0||t>e.dataSource.sourceLength)&&(t=e.dataSource.sourceLength);const a=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;e.dataSource.addRecord(n,t);const l=e.rowCount;if(e.refreshRowColCount(),e.scenegraph.proxy.totalActualBodyRowCount===0)return e.scenegraph.clearCells(),void e.scenegraph.createSceneGraph();const u=e.transpose?e.colCount:e.rowCount;if(e.pagination){const{perPageCount:h,currentPage:d}=e.pagination,c=h*(d||0)+h;if(t<c)if(t<c-h)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const f=t-(c-h)+a;if(l-a===e.pagination.perPageCount){const g=[];for(let m=f;m<u;m++)e.transpose?g.push({col:m,row:0}):g.push({col:0,row:m});e.transpose?e.scenegraph.updateCol([],[],g):e.scenegraph.updateRow([],[],g)}else{const g=[];for(let m=f;m<Math.min(u,f+1);m++)e.transpose?g.push({col:m,row:0}):g.push({col:0,row:m});e.transpose?e.scenegraph.updateCol([],g,[]):e.scenegraph.updateRow([],g,[])}}}else{const h=[];for(let g=t+a;g<t+a+1;g++)e.transpose?h.push({col:g,row:0}):h.push({col:0,row:g});const d=[],c=e.internalProps.layoutMap.hasAggregationOnTopCount,f=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let g=a;g<a+c;g++)e.transpose?d.push({col:g,row:0}):d.push({col:0,row:g});for(let g=(e.transpose?e.colCount:e.rowCount)-f;g<(e.transpose?e.colCount:e.rowCount);g++)e.transpose?d.push({col:g,row:0}):d.push({col:0,row:g});e.transpose?e.scenegraph.updateCol([],h,[]):e.scenegraph.updateRow([],h,[])}}}function Bnt(n,t,e){var i,r,o,s;if(e.options.groupBy)(r=(i=e.dataSource).addRecordsForGroup)===null||r===void 0||r.call(i,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&$r(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(o=e.dataSource).addRecordsForTree)===null||s===void 0||s.call(o,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&$r(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.addRecordsForSorted(n),$r(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{t===void 0||t>e.dataSource.sourceLength?t=e.dataSource.sourceLength:t<0&&(t=0);const a=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;e.dataSource.addRecords(n,t);const l=e.transpose?e.colCount:e.rowCount;if(e.refreshRowColCount(),e.scenegraph.proxy.totalActualBodyRowCount===0)return e.scenegraph.clearCells(),void e.scenegraph.createSceneGraph();const u=e.transpose?e.colCount:e.rowCount;if(e.pagination){const{perPageCount:h,currentPage:d}=e.pagination,c=h*(d||0)+h;if(t<c)if(t<c-h)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const f=t-(c-h)+a;if(l-a===e.pagination.perPageCount){const g=[];for(let m=f;m<u;m++)e.transpose?g.push({col:m,row:0}):g.push({col:0,row:m});e.transpose?e.scenegraph.updateCol([],[],g):e.scenegraph.updateRow([],[],g)}else{const g=[];for(let m=f;m<Math.min(u,f+(Array.isArray(n)?n.length:1));m++)e.transpose?g.push({col:m,row:0}):g.push({col:0,row:m});e.transpose?e.scenegraph.updateCol([],g,[]):e.scenegraph.updateRow([],g,[])}}}else{const h=[];for(let g=t+a;g<t+a+(Array.isArray(n)?n.length:1);g++)e.transpose?h.push({col:g,row:0}):h.push({col:0,row:g});const d=e.internalProps.layoutMap.hasAggregationOnTopCount,c=e.internalProps.layoutMap.hasAggregationOnBottomCount,f=[];for(let g=a;g<a+d;g++)e.transpose?f.push({col:g,row:0}):f.push({col:0,row:g});for(let g=(e.transpose?e.colCount:e.rowCount)-c;g<(e.transpose?e.colCount:e.rowCount);g++)e.transpose?f.push({col:g,row:0}):f.push({col:0,row:g});e.transpose?e.scenegraph.updateCol([],h,f):e.scenegraph.updateRow([],h,f)}}}function Pnt(n,t){var e,i,r,o,s,a,l,u;if((n==null?void 0:n.length)>0)if(t.options.groupBy)(i=(e=t.dataSource).deleteRecordsForGroup)===null||i===void 0||i.call(e,n),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&$r(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if(t.dataSource.rowHierarchyType==="tree")(o=(r=t.dataSource).deleteRecordsForTree)===null||o===void 0||o.call(r,n),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&$r(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if(t.sortState)t.dataSource.deleteRecordsForSorted(n),$r(t),t.refreshRowColCount(),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{const h=t.dataSource.deleteRecords(n);if(h.length===0)return;const d=t.transpose?t.colCount:t.rowCount;t.refreshRowColCount();const c=t.transpose?t.colCount:t.rowCount,f=h.sort((m,p)=>m-p),g=f[0];if(t.pagination){const{perPageCount:m,currentPage:p}=t.pagination,v=m*(p||0)+m;if(g<v)if(g<v-m)t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{const b=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,C=t.internalProps.layoutMap.hasAggregationOnTopCount,y=[],w=[];for(let _=g-(v-m)+(t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount)+C;_<c;_++)t.transpose?y.push({col:_,row:0}):y.push({col:0,row:_});for(let _=b;_<b+C;_++)t.transpose?y.push({col:_,row:0}):y.push({col:0,row:_});if(c<d)for(let _=c;_<d;_++)t.transpose?w.push({col:_,row:0}):w.push({col:0,row:_});(s=t.reactCustomLayout)===null||s===void 0||s.clearCache(),t.transpose?t.scenegraph.updateCol(w,[],y):t.scenegraph.updateRow(w,[],y),(a=t.reactCustomLayout)===null||a===void 0||a.updateAllCustomCell()}}else{const m=[],p=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,v=t.internalProps.layoutMap.hasAggregationOnTopCount,b=t.internalProps.layoutMap.hasAggregationOnBottomCount;for(let y=0;y<f.length;y++){const w=f[y]+p+v;t.transpose?m.push({col:w,row:0}):m.push({col:0,row:w})}const C=[];for(let y=p;y<p+v;y++)t.transpose?C.push({col:y,row:0}):C.push({col:0,row:y});for(let y=(t.transpose?t.colCount:t.rowCount)-b;y<(t.transpose?t.colCount:t.rowCount);y++)t.transpose?C.push({col:y,row:0}):C.push({col:0,row:y});(l=t.reactCustomLayout)===null||l===void 0||l.clearCache(),t.transpose?t.scenegraph.updateCol(m,[],C):t.scenegraph.updateRow(m,[],C),(u=t.reactCustomLayout)===null||u===void 0||u.updateAllCustomCell()}}}function knt(n,t,e){var i,r,o,s;if((t==null?void 0:t.length)>0)if(e.options.groupBy)(r=(i=e.dataSource).updateRecordsForGroup)===null||r===void 0||r.call(i,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&$r(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(o=e.dataSource).updateRecordsForTree)===null||s===void 0||s.call(o,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&$r(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.updateRecordsForSorted(n,t),$r(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const a=e.dataSource.updateRecords(n,t);if(a.length===0)return;const l=a.map(u=>e.getBodyRowIndexByRecordIndex(u)).sort((u,h)=>u-h);if(e.pagination){const{perPageCount:u,currentPage:h}=e.pagination,d=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,c=e.internalProps.layoutMap.hasAggregationOnTopCount,f=u*(h||0)+u,g=[];for(let m=0;m<l.length;m++){const p=l[m];if(p<f&&p>=f-u){const v=p-(f-u)+(e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount)+c;g.push(v)}}if(g.length>=1){const m=[];for(let p=0;p<g.length;p++){const v=g[p];e.transpose?m.push({col:v,row:0}):m.push({col:0,row:v})}for(let p=d;p<d+c;p++)e.transpose?m.push({col:p,row:0}):m.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],[],m):e.scenegraph.updateRow([],[],m)}}else{const u=[],h=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,d=e.internalProps.layoutMap.hasAggregationOnTopCount,c=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let f=0;f<l.length;f++){const g=l[f]+h+d;e.transpose?u.push({col:g,row:0}):u.push({col:0,row:g})}for(let f=h;f<h+d;f++)e.transpose?u.push({col:f,row:0}):u.push({col:0,row:f});for(let f=(e.transpose?e.colCount:e.rowCount)-c;f<(e.transpose?e.colCount:e.rowCount);f++)e.transpose?u.push({col:f,row:0}):u.push({col:0,row:f});e.transpose?e.scenegraph.updateCol([],[],u):e.scenegraph.updateRow([],[],u)}}}function Lnt(n,t,e,i){const r=[{col:t,row:e}],o=[],s=[],{addCellPositions:a,removeCellPositions:l}=n,u=i.scenegraph.proxy,{rowStart:h,rowLimit:d}=u;let{rowEnd:c}=u,f=1/0;for(let p=0;p<a.length;p++){const{row:v}=a[p];c-h+1===d?v>=h&&v<=c&&(f=Math.min(f,v)):(o.push({col:t,row:v}),c++)}const g=Math.min(h+d,i.rowCount-1-i.bottomFrozenRowCount),m=g<h+d;for(let p=0;p<l.length;p++){const{row:v}=l[l.length-p-1];v<h||v>c||(v>g||m?(s.push({col:t,row:v}),f--):f=Math.min(f,v))}if(f!==1/0)for(let p=f;p<=c;p++)r.push({col:t,row:p});return i.scenegraph.proxy.refreshRowCount(),{updateCells:r,addCells:o,removeCells:s}}class Dnt extends Irt{constructor(t,e){var i,r,o,s,a,l,u,h;super(t,e),this.showHeader=!0,e=this.options;const d=this.internalProps;if(d.frozenColDragHeaderMode=(r=(i=e.dragOrder)===null||i===void 0?void 0:i.frozenColDragHeaderMode)!==null&&r!==void 0?r:e.frozenColDragHeaderMode,this.pagination=e.pagination,d.sortState=e.sortState,d.multipleSort=!!e.multipleSort,d.dataConfig=e.groupBy?OM(e.groupBy):{},d.columns=e.columns?Rl(e.columns,["children"]):e.header?Rl(e.header,["children"]):[],cf(this),d.enableTreeNodeMerge=(s=(o=e.enableTreeNodeMerge)!==null&&o!==void 0?o:et(e.groupBy))!==null&&s!==void 0&&s,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=(a=e.showHeader)===null||a===void 0||a,this.internalProps.columnWidthConfig=e.columnWidthConfig,this.transpose=(l=e.transpose)!==null&&l!==void 0&&l,be.mode!=="node"&&(this.editorManager=new xnt(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:d.sortState}):this.setRecords([]),e.title){const c=Gt.getComponent("title");d.title=new c(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(u=this.internalProps.emptyTip)===null||u===void 0||u.resetVisible();else{const c=Gt.getComponent("emptyTip");this.internalProps.emptyTip=new c(this.options.emptyTip,this),(h=this.internalProps.emptyTip)===null||h===void 0||h.resetVisible()}if(e.enableTreeStickCell){const c=Gt.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new c(this)}setTimeout(()=>{this.fireListeners(ut.INITIALIZED,null)},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var t;return(t=this.dataSource)===null||t===void 0?void 0:t.records}get recordsCount(){return this.dataSource.records.length}updateColumns(t,e){var i,r,o,s;this.scenegraph.clearCells();const a={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=Rl(t,["children"]),cf(this),e!=null&&e.clearColWidthCache&&this.internalProps._widthResizedColMap.clear(),this.options.columns=t,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),(r=(i=this.dataSource).updateColumns)===null||r===void 0||r.call(i,this.internalProps.columns),this.records&&pE(this.internalProps.columns)&&this.dataSource.processRecords((s=(o=this.dataSource.dataSourceObj)===null||o===void 0?void 0:o.records)!==null&&s!==void 0?s:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(a.col,a.row),this.renderAsync(),this.eventManager.updateEventBinder()}_recreateSceneForStateChange(){var t,e;this.scenegraph.clearCells();const i={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this._hasAutoImageColumn=void 0,this.refreshHeader(),this.records&&pE(this.internalProps.columns)&&this.dataSource.processRecords((e=(t=this.dataSource.dataSourceObj)===null||t===void 0?void 0:t.records)!==null&&e!==void 0?e:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(i.col,i.row),this.renderAsync(),this.eventManager.updateEventBinder()}addColumn(t){const e=this.options.columns;e.push(t),this.updateColumns(e)}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(t){this.internalProps.columns=t,cf(this),this.options.header=t,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var t;return(t=this.internalProps.transpose)!==null&&t!==void 0&&t}set transpose(t){this.internalProps.transpose!==t&&(this.internalProps.transpose=t,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=t,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(t,e,i){if(t===-1||e===-1)return null;if(!i){const a=this.getCustomMergeValue(t,e);if(a)return a}const r=this;if(r.internalProps.layoutMap.isSeriesNumber(t,e)){if(r.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){const{title:u}=r.internalProps.layoutMap.getSeriesNumberHeader(t,e);return u}let a;if(this.options.groupBy){const u=r.getCellRawRecord(t,e);if(u!=null&&u.vtableMerge)return"";r.internalProps.layoutMap.isAggregation(t,e)||(a=this.dataSource.getGroupSeriesNumber(e-this.columnHeaderLevelCount))}else a=e-this.columnHeaderLevelCount+1;const{format:l}=r.internalProps.layoutMap.getSeriesNumberBody(t,e);return typeof l=="function"?l(t,e,this,a):a}if(r.internalProps.layoutMap.isHeader(t,e)){const{title:a}=r.internalProps.layoutMap.getHeader(t,e);return typeof a=="function"?a():a}if(r.internalProps.layoutMap.isAggregation(t,e)){if(r.internalProps.layoutMap.isTopAggregation(t,e)){const a=r.internalProps.layoutMap.getAggregatorOnTop(t,e);return a!=null&&a.formatValue?a.formatValue(t,e,this):""}if(r.internalProps.layoutMap.isBottomAggregation(t,e)){const a=r.internalProps.layoutMap.getAggregatorOnBottom(t,e);return a!=null&&a.formatValue?a.formatValue(t,e,this):""}}const{field:o,fieldFormat:s}=r.internalProps.layoutMap.getBody(t,e);return r.getFieldData(s||o,t,e)}getCellOriginValue(t,e){if(t===-1||e===-1)return null;const i=this;if(i.internalProps.layoutMap.isSeriesNumber(t,e)){if(i.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){const{title:s}=i.internalProps.layoutMap.getSeriesNumberHeader(t,e);return s}const{format:o}=i.internalProps.layoutMap.getSeriesNumberBody(t,e);return typeof o=="function"?o(t,e,this):e-this.columnHeaderLevelCount}if(i.internalProps.layoutMap.isHeader(t,e)){const{title:o}=i.internalProps.layoutMap.getHeader(t,e);return typeof o=="function"?o():o}if(i.internalProps.layoutMap.isAggregation(t,e)){if(i.internalProps.layoutMap.isTopAggregation(t,e)){const o=i.internalProps.layoutMap.getAggregatorOnTop(t,e);return o==null?void 0:o.value()}if(i.internalProps.layoutMap.isBottomAggregation(t,e)){const o=i.internalProps.layoutMap.getAggregatorOnBottom(t,e);return o==null?void 0:o.value()}}const{field:r}=i.internalProps.layoutMap.getBody(t,e);return i.getFieldData(r,t,e)}getCellRawValue(t,e){if(t===-1||e===-1)return null;const i=this;if(i.internalProps.layoutMap.isHeader(t,e)){const{title:o}=i.internalProps.layoutMap.getHeader(t,e);return typeof o=="function"?o():o}const{field:r}=i.internalProps.layoutMap.getBody(t,e);return i.getRawFieldData(r,t,e)}getRecordShowIndexByCell(t,e){const{layoutMap:i}=this.internalProps;return i.getRecordShowIndexByCell(t,e)}getRecordIndexByCell(t,e){const{layoutMap:i}=this.internalProps,r=i.getRecordShowIndexByCell(t,e);return this.dataSource.getRecordIndexPaths(r)}getTableIndexByRecordIndex(t){return this.transpose?this.dataSource.getTableIndex(t)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(t)+this.columnHeaderLevelCount}getTableIndexByField(t){const e=this.internalProps.layoutMap.columnObjects.find(r=>r.field===t);if(!e)return-1;const i=this.internalProps.layoutMap.getBodyLayoutRangeById(e.id);return this.transpose?i.start.row:i.start.col}getCellAddrByFieldRecord(t,e){return this.transpose?{col:this.getTableIndexByRecordIndex(e),row:this.getTableIndexByField(t)}:{col:this.getTableIndexByField(t),row:this.getTableIndexByRecordIndex(e)}}getCellOriginRecord(t,e){const i=this,r=i.getRecordShowIndexByCell(t,e);if(r>-1)return i.dataSource.get(r)}getCellRawRecord(t,e){const i=this,r=i.getRecordShowIndexByCell(t,e);if(r>-1)return i.dataSource.getRaw(r)}_canResizeColumn(t,e){const i=super._canResizeColumn(t,e);if(i&&!this.transpose){const r=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount),o=this.internalProps.layoutMap.isSeriesNumber(t,e);if(r!=null&&r.disableColumnResize||o&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1}return i}updateOption(t){var e,i,r,o,s,a,l,u,h;const d=this.internalProps;if(super.updateOption(t),d.frozenColDragHeaderMode=(i=(e=t.dragOrder)===null||e===void 0?void 0:e.frozenColDragHeaderMode)!==null&&i!==void 0?i:t.frozenColDragHeaderMode,this.pagination=t.pagination,d.sortState=t.sortState,d.dataConfig=t.groupBy?OM(t.groupBy):{},this.showHeader=(r=t.showHeader)===null||r===void 0||r,d.columns=t.columns?Rl(t.columns,["children"]):t.header?Rl(t.header,["children"]):[],cf(this),d.enableTreeNodeMerge=(s=(o=t.enableTreeNodeMerge)!==null&&o!==void 0?o:et(t.groupBy))!==null&&s!==void 0&&s,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=(a=t.transpose)!==null&&a!==void 0&&a,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=t.columnWidthConfig,d.releaseList)for(let c=d.releaseList.length-1;c>=0;c--){const f=d.releaseList[c];f instanceof us?f.updateColumns(this.internalProps.columns):((l=f==null?void 0:f.release)===null||l===void 0||l.call(f),d.releaseList.splice(c,1))}if(t.dataSource&&this.dataSource!==t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:t.sortState}):(this.refreshRowColCount(),this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),t.title){const c=Gt.getComponent("title");d.title=new c(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(u=this.internalProps.emptyTip)===null||u===void 0||u.resetVisible();else{const c=Gt.getComponent("emptyTip");this.internalProps.emptyTip=new c(this.options.emptyTip,this),(h=this.internalProps.emptyTip)===null||h===void 0||h.resetVisible()}return this.pluginManager.updatePlugins(t.plugins),new Promise(c=>{setTimeout(c,0)})}updatePagination(t){this.pagination&&(typeof t.currentPage=="number"&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var t;const e=this.internalProps,i=this.transpose,r=this.showHeader;(e.layoutMap=new Snt(this,(t=e.columns)!==null&&t!==void 0?t:[],r,this.options.hierarchyIndent)).transpose=i,i||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b;const C=this,{layoutMap:y}=C.internalProps;if(!y)return;const w=(e=(t=C.internalProps.dataSource)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0;y.recordsCount=w+(w>0||this.options.showAggregationWhenEmpty?y.hasAggregationOnTopCount+y.hasAggregationOnBottomCount:0),C.transpose?(C.rowCount=(i=y.rowCount)!==null&&i!==void 0?i:0,C.colCount=(r=y.colCount)!==null&&r!==void 0?r:0,this.internalProps.frozenColCount=Math.max(((o=y.headerLevelCount)!==null&&o!==void 0?o:0)+y.leftRowSeriesNumberColumnCount,(s=this.options.frozenColCount)!==null&&s!==void 0?s:0),this.internalProps.frozenRowCount=(a=this.options.frozenRowCount)!==null&&a!==void 0?a:0,C.bottomFrozenRowCount!==((l=this.options.bottomFrozenRowCount)!==null&&l!==void 0?l:0)&&(C.bottomFrozenRowCount=(u=this.options.bottomFrozenRowCount)!==null&&u!==void 0?u:0),C.rightFrozenColCount!==((h=this.options.rightFrozenColCount)!==null&&h!==void 0?h:0)&&(C.rightFrozenColCount=(d=this.options.rightFrozenColCount)!==null&&d!==void 0?d:0)):(C.colCount=(c=y.colCount)!==null&&c!==void 0?c:0,C.rowCount=y.recordsCount*y.bodyRowSpanCount+y.headerLevelCount,this.internalProps.frozenColCount=(f=this.options.frozenColCount)!==null&&f!==void 0?f:0,C.frozenRowCount=Math.max(y.headerLevelCount,(g=this.options.frozenRowCount)!==null&&g!==void 0?g:0),C.bottomFrozenRowCount!==((m=this.options.bottomFrozenRowCount)!==null&&m!==void 0?m:0)&&(C.bottomFrozenRowCount=(p=this.options.bottomFrozenRowCount)!==null&&p!==void 0?p:0),C.rightFrozenColCount!==((v=this.options.rightFrozenColCount)!==null&&v!==void 0?v:0)&&(C.rightFrozenColCount=(b=this.options.rightFrozenColCount)!==null&&b!==void 0?b:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(t,e,i){if(t===null||this.internalProps.layoutMap.isHeader(e,i))return null;const r=this.getRecordShowIndexByCell(this.transpose?e-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:e,i);return this.internalProps.dataSource.getField(r,t,e,i,this)}getRawFieldData(t,e,i){if(t===null||this.internalProps.layoutMap.isHeader(e,i))return null;const r=this.getRecordShowIndexByCell(e,i);return this.internalProps.dataSource.getRawField(r,t,e,i,this)}_moveHeaderPosition(t,e){const i=this.getCellRange(t.col,t.row),r=this.getCellRange(e.col,e.row),o=this.internalProps.layoutMap.moveHeaderPosition(t,e);return o?(o.moveType==="column"?(this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,o.targetIndex),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):o.targetIndex>o.sourceIndex?this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex+o.sourceSize-o.targetSize,o.targetSize,o.targetIndex):this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex,o.targetSize,o.targetIndex),o):null}changeRecordOrder(t,e){this.transpose?(t=this.getRecordShowIndexByCell(t,0),e=this.getRecordShowIndexByCell(e,0)):(t=this.getRecordShowIndexByCell(0,t),e=this.getRecordShowIndexByCell(0,e)),this.dataSource.changeOrder(t,e)}getCellAddress(t,e){let i;for(let o=0;o<this.internalProps.records.length;o++){const s=this.internalProps.records[o];if(typeof t=="function")t(s)&&(i=o);else{let a=!0;for(const l in t)if(s[l]!==t[l]){a=!1;break}a&&(i=o)}if(et(i))break}const r=this.getCellRangeByField(e,i);if(r)return{row:r.start.row,col:r.start.col}}getCellRangeByField(t,e){const{layoutMap:i}=this.internalProps,r=i.columnObjects.find(o=>o.field===t);if(r){const o=i.getBodyLayoutRangeById(r.id);let s;return et(e)&&(s=i.getRecordStartRowByRecordIndex(e)),this.transpose?{start:{row:o.start.row,col:et(s)?s+o.start.col:void 0},end:{row:o.end.row,col:et(s)?s+o.end.col:void 0}}:{start:{col:o.start.col,row:et(s)?s+o.start.row:void 0},end:{col:o.end.col,row:et(s)?s+o.end.row:void 0}}}return null}getHierarchyState(t,e){var i;if(this.isHeader(t,e))return(i=this._getHeaderLayoutMap(t,e))===null||i===void 0?void 0:i.hierarchyState;if((!this.options.groupBy||Wt(this.options.groupBy)&&this.options.groupBy.length===0)&&!this.getBodyColumnDefine(t,e).tree)return Yt.none;const r=this.getRecordShowIndexByCell(t,e);return this.dataSource.getHierarchyState(r)}toggleHierarchyState(t,e,i=!0){this.stateManager.updateHoverIcon(t,e,void 0,void 0);const r=this.getHierarchyState(t,e);if(this.isHeader(t,e)){const o=this.internalProps.layoutMap.getHeader(t,e),{hierarchyState:s,define:a}=o;if(![Yt.collapse,Yt.expand].includes(s)||!a)return;const l=a.columns;if(Array.isArray(l)&&l.length>0){const u=s===Yt.expand?Yt.collapse:Yt.expand;o.hierarchyState=u,o.define.hierarchyState=u,this.updateColumns(this.internalProps.columns)}this.fireListeners(ut.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:r,originData:o,cellLocation:this.getCellLocation(t,e)})}else if(r===Yt.expand)this._refreshHierarchyState(t,e,i),this.fireListeners(ut.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:Yt.collapse});else if(r===Yt.collapse){const o=this.getCellOriginRecord(t,e);Array.isArray(o.children)&&this._refreshHierarchyState(t,e,i),this.fireListeners(ut.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:Yt.expand,originData:o})}}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}_refreshHierarchyState(t,e,i=!0){var r,o;let s=!1,a=!1;const l=this.internalProps.layoutMap.checkHasChart();l&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight));const u=this.getRecordShowIndexByCell(t,e),h=this.dataSource.toggleHierarchyState(u,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),d=this.internalProps.layoutMap.toggleHierarchyState(h);this.refreshRowColCount();for(let m=this.rowCount-this.bottomFrozenRowCount;m<this.rowCount;m++){const p=An(m,0,this.colCount-1,this);this._setRowHeight(m,p)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;const{updateCells:c,addCells:f,removeCells:g}=Lnt(d,t,e,this);(r=this.reactCustomLayout)===null||r===void 0||r.clearCache(),this.scenegraph.updateRow(g,f,c,i,!0),(o=this.reactCustomLayout)===null||o===void 0||o.updateAllCustomCell(),l&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!a&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||s||this.heightMode==="adaptive"||a)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var t,e;return(e=(t=this.options.columns)!==null&&t!==void 0?t:this.options.header)===null||e===void 0?void 0:e.some((i,r)=>i.tree)}getMenuInfo(t,e,i){return{field:this.getHeaderField(t,e),value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),event:void 0}}_getSortFuncFromHeaderOption(t,e,i){if(t||(t=this.internalProps.columns),e&&t&&t.length>0)for(let r=0;r<t.length;r++){const o=t[r];if((i&&i===o.fieldKey||!i&&o.field===e)&&o.sort&&typeof o.sort=="function")return o.sort;if(o.columns){const s=this._getSortFuncFromHeaderOption(o.columns,e,i);if(s)return s}}}updateSortState(t,e=!0){var i;if(t)this.internalProps.sortState=t;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let r=0;r<this.internalProps.sortState.length;r++)(t=(i=this.internalProps.sortState)===null||i===void 0?void 0:i[r])&&(t.order="normal");else this.internalProps.sortState.order="normal",t=this.internalProps.sortState;(t=Array.isArray(t)?t:[t]).some(r=>r.field)&&e&&this.internalProps.layoutMap.headerObjects.some(r=>r.define.sort!==!1)&&(this.dataSource.sort(t.map(r=>{const o=this._getSortFuncFromHeaderOption(this.internalProps.columns,r.field);return this.internalProps.layoutMap.headerObjects.find(s=>s&&s.field===r.field),{field:r.field,order:r.order,orderFn:o??pp}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),t.length&&this.stateManager.updateSortState(t)}updateFilterRules(t){this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(t),$r(this)):this.dataSource.updateFilterRules(t),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph()}getCheckboxState(t){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),et(t)){let e=Array.from(this.stateManager.checkedState.keys()).sort((i,r)=>{var o,s;const a=i.split(","),l=r.split(","),u=Math.max(a.length,l.length);for(let h=0;h<u;h++){const d=(o=Number(a[h]))!==null&&o!==void 0?o:0,c=(s=Number(l[h]))!==null&&s!==void 0?s:0;if(d!==c)return d-c}return 0}).map(i=>this.stateManager.checkedState.get(i));return this.options.groupBy&&(e=lit(this)),Array.from(e,i=>i&&i[t])}return new Array(...this.stateManager.checkedState.values())}getCellCheckboxState(t,e){var i;const r=this.getBodyColumnDefine(t,e),o=r==null?void 0:r.field,s=this.getCellType(t,e);if(et(o)&&(s==="checkbox"||s==="switch")){const a=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)).toString();return(i=this.stateManager.checkedState.get(a))===null||i===void 0?void 0:i[o]}}getRadioState(t){return et(t)?this.stateManager.radioState[t]:this.stateManager.radioState}getCellRadioState(t,e){return Ket(t,e,this)}setCellCheckboxState(t,e,i){sit(t,e,i,this)}setCellRadioState(t,e,i){Qet(t,e,i,this)}getSwitchState(t){return this.getCheckboxState(t)}getCellSwitchState(t,e){return this.getCellCheckboxState(t,e)}setCellSwitchState(t,e,i){this.setCellCheckboxState(t,e,i)}setRecords(t,e){var i,r,o,s;let a;ry(),(i=this.internalProps.dataSource)===null||i===void 0||i.release(),this.internalProps.releaseList=(r=this.internalProps.releaseList)===null||r===void 0?void 0:r.filter(u=>!u.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(e)||e!=null&&e.order?a=e:e?a=e.sortState:e===null&&(a=null),typeof window<"u"&&window.performance.now();const l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),a!==void 0&&(a===null||!Array.isArray(a)&&et(a.field)||Array.isArray(a))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(a)?a:[a]:a,this.stateManager.setSortState(this.sortState)),t){if(gE(this,t),this.sortState){const u=Array.isArray(this.sortState)?this.sortState:[this.sortState];u.some(h=>h.order&&h.field&&h.order!=="normal")&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(h=>h.define.sort!==!1)&&this.dataSource.sort(u.map(h=>{const d=this._getSortFuncFromHeaderOption(void 0,h.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(c=>c&&c.field===h.field),{field:h.field,order:h.order||"asc",orderFn:d??pp}}))}this.refreshRowColCount()}else gE(this,t);if(this.stateManager.initCheckedState(t),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)(o=this.internalProps.emptyTip)===null||o===void 0||o.resetVisible();else{const u=Gt.getComponent("emptyTip");this.internalProps.emptyTip=new u(this.options.emptyTip,this),(s=this.internalProps.emptyTip)===null||s===void 0||s.resetVisible()}this.render(),et(l.col)&&et(l.row)&&l.col>=0&&l.row>=0&&setTimeout(()=>{var u;(u=this.internalProps)===null||u===void 0||u.tooltipHandler.showTooltip(l.col,l.row)},0)}setRecordChildren(t,e,i,r=!0){const o=this.getCellOriginRecord(e,i);o.children=t;const s=this.getRecordShowIndexByCell(e,i);this.dataSource.setRecord(o,s),this._refreshHierarchyState(e,i,r)}startEditCell(t,e,i){var r;if(et(t)&&et(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,i);else if(!((r=this.stateManager.select)===null||r===void 0)&&r.cellPos){const{col:o,row:s}=this.stateManager.select.cellPos;et(o)&&et(s)&&this.editorManager.startEditCell(o,s,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var i,r;const o=this.getBodyColumnDefine(t,e);let s=this.isHeader(t,e)?(i=o==null?void 0:o.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor:(r=o==null?void 0:o.editor)!==null&&r!==void 0?r:this.options.editor;return typeof s=="function"&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),typeof s=="string"?zrt(s):s}isHasEditorDefine(t,e){var i,r;const o=this.getBodyColumnDefine(t,e);let s=this.isHeader(t,e)?(i=o==null?void 0:o.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor:(r=o==null?void 0:o.editor)!==null&&r!==void 0?r:this.options.editor;return typeof s=="function"&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),et(s)}changeCellValue(t,e,i,r=!1,o=!0){return Ant(t,e,i,r,o,this)}changeCellValues(t,e,i,r=!1,o=!0){return Rnt(t,e,i,r,o,this)}addRecord(t,e){var i;Mnt(t,e,this),(i=this.internalProps.emptyTip)===null||i===void 0||i.resetVisible()}addRecords(t,e){var i;Bnt(t,e,this),(i=this.internalProps.emptyTip)===null||i===void 0||i.resetVisible()}deleteRecords(t){var e;Pnt(t,this),(e=this.internalProps.emptyTip)===null||e===void 0||e.resetVisible()}updateRecords(t,e){knt(t,e,this)}_hasCustomRenderOrLayout(){var t,e,i,r;const{headerObjects:o}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let s=0;s<o.length;s++){const a=o[s];if(!((t=a==null?void 0:a.define)===null||t===void 0)&&t.customLayout||!((e=a==null?void 0:a.define)===null||e===void 0)&&e.headerCustomLayout||!((i=a==null?void 0:a.define)===null||i===void 0)&&i.customRender||!((r=a==null?void 0:a.define)===null||r===void 0)&&r.headerCustomRender)return!0}return!1}getAggregateValuesByField(t){const e=this.internalProps.layoutMap.getColumnByField(t),i=[];for(let r=0;r<e.length;r++){const o=e[r].columnDefine.aggregator;if(delete e[r].columnDefine,o){const s={col:e[r].col,aggregateValue:null};if(s.aggregateValue=[],Array.isArray(o))for(let a=0;a<o.length;a++)s.aggregateValue.push({aggregationType:o[a].type,value:o[a].value()});else s.aggregateValue.push({aggregationType:o.type,value:o.value()});i.push(s)}}return i}isAggregation(t,e){return this.internalProps.layoutMap.isAggregation(t,e)}getGroupTitleLevel(t,e){var i;if(!this.options.groupBy)return;const r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)),o=(i=this.dataSource.getGroupLength())!==null&&i!==void 0?i:0;let s=Wt(r)?r.length-1:0;return o>0&&s===o&&(s=void 0),s}getBodyRowIndexByRecordIndex(t){return Array.isArray(t)&&t.length===1&&(t=t[0]),this.dataSource.getTableIndex(t)}_parseColumnWidthConfig(t){for(let e=0;e<(t==null?void 0:t.length);e++){const i=t[e],r=i.key,o=i.width,s=this.internalProps.layoutMap.getColumnByKey(r);if(s.columnDefine){const{col:a}=s;this.internalProps._widthResizedColMap.has(a)||(this._setColWidth(a,o),this.internalProps._widthResizedColMap.add(a))}}}release(){this.editorManager.release(),super.release()}expandAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&typeof this.dataSource.expandAllNodes=="function"&&(this.dataSource.expandAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(ut.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:Yt.expand,originData:{children:this.records}}))}collapseAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&typeof this.dataSource.collapseAllNodes=="function"&&(this.dataSource.collapseAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(ut.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:Yt.collapse,originData:{children:this.records}}))}}function hy(n){return n==="bottom"||n==="top"}function Int(n){return n==="left"||n==="right"}var gs;(function(n){n.Identity="identity",n.Linear="linear",n.Log="log",n.Pow="pow",n.Sqrt="sqrt",n.Symlog="symlog",n.Time="time",n.Quantile="quantile",n.Quantize="quantize",n.Threshold="threshold",n.Ordinal="ordinal",n.Point="point",n.Band="band"})(gs||(gs={}));Object.values(gs).forEach(n=>{});function El(n){return n}const Fnt=n=>-Math.log(-n),Ont=n=>-Math.exp(-n),Hnt=n=>isFinite(n)?Math.pow(10,n):n<0?0:n,HM=n=>n===10?Hnt:n===Math.E?Math.exp:t=>Math.pow(n,t),zM=n=>n===Math.E?Math.log:n===10?Math.log10:n===2?Math.log2:(n=Math.log(n),t=>Math.log(t)/n),NM=n=>t=>Math.sign(t)*Math.log1p(Math.abs(t/n)),WM=n=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*n;function dy(n,t){if(n=Number(n),t=Number(t),t-=n)return i=>(i-n)/t;const e=Number.isNaN(t)?NaN:.5;return()=>e}function UM(n,t,e){const i=n[0],r=n[1],o=t[0],s=t[1];let a,l;return r<i?(a=dy(r,i),l=e(s,o)):(a=dy(i,r),l=e(o,s)),u=>l(a(u))}function h1(n,t,e){let i;return i=n===1?n+2*e:n-t+2*e,n?i>0?i:1:0}function znt(n,t,e,i){return e===1&&(e=0),h1(n,e,i)*(t/(1-e))}function Nnt(n,t,e,i,r){const o=h1(n,e,i);let s=t/Math.max(1,o||1);r&&(s=Math.floor(s));let a=s*(1-e);return r&&(a=Math.round(a)),a}function bF(n,t){const e=(n[1]-n[0])/(t[1]-t[0]),i=n[0]-e*t[0];return[i,e+i]}function Wnt(n,t,e){const i=Math.min(n.length,t.length)-1,r=new Array(i),o=new Array(i);let s=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=dy(n[s],n[s+1]),o[s]=e(t[s],t[s+1]);return function(a){const l=Qrt(n,a,1,i)-1;return o[l](r[l](a))}}const Unt=(n,t)=>{const e=n.slice();let i=0,r=e.length-1,o=e[i],s=e[r];return s<o&&([i,r]=[r,i],[o,s]=[s,o]),e[i]=t.floor(o),e[r]=t.ceil(s),e},_F=(n,t=!1)=>{const e=Math.floor(Math.log10(n)),i=n/Math.pow(10,e);let r;return r=t?i<1.5?1:i<3?2:i<7?5:10:i<=1?1:i<=2?2:i<=5?5:10,r*Math.pow(10,e)},Vnt=(n,t)=>{let e,i;return t[0]<t[1]?(e=t[0],i=t[1]):(e=t[1],i=t[0]),Math.min(Math.max(n,e),i)};class CF{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)&&t.length===2?(this._wholeRange=bF(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(t.length===2&&t.every(r=>r>=0&&r<=1)&&(this._wholeRange=null,t[0]===0&&t[1]===1?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return Vi(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!Vi(this._rangeFactorEnd)&&this._rangeFactorEnd!==1?(this._rangeFactorStart=t,this._rangeFactorEnd=(i=this._rangeFactorEnd)!==null&&i!==void 0?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}rangeFactorEnd(t,e){var i;return Vi(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!Vi(this._rangeFactorStart)&&this._rangeFactorStart!==0?(this._rangeFactorEnd=t,this._rangeFactorStart=(i=this._rangeFactorStart)!==null&&i!==void 0?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);const{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,o=this.range(),s=o[0],a=o[o.length-1],l=Math.min(s,a),u=Math.max(s,a),h=cF((t=this._fishEyeOptions.focus)!==null&&t!==void 0?t:0,l,u),d=Vi(r)?(u-l)*i:r;let c=Math.exp(e);c=c/(c-1)*d;const f=e/d;this._fishEyeTransform=g=>{const m=Math.abs(g-h);if(m>=d)return g;if(m<=1e-6)return h;const p=c*(1-Math.exp(-m*f))/m*.75+.25;return h+(g-h)*p}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return(i=this==null?void 0:this[t])!==null&&i!==void 0?i:e}}const cy=Symbol("implicit");class d1 extends CF{specified(t){var e;return t?(this._specified=Object.assign((e=this._specified)!==null&&e!==void 0?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=gs.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=cy}clone(){const t=new d1().domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){const e=`${t}`,i=this._getSpecifiedValue(e);if(i!==void 0)return i;let r=this._index.get(e);if(!r){if(this._unknown!==cy)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}const o=this._ordinalRange[(r-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(o):o}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;for(const e of t){const i=`${e}`;this._index.has(i)||this._index.set(i,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();const e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&(e=this._index.get(`${t}`))!==null&&e!==void 0?e:-1}}function yF(n,t,e,i){const r=[];let o=n;for(;o<=t;)r.push(o),o+=e;return i&&r.reverse(),r}function VM(n,t,e,i){let r,o;if(t=Math.floor(+t),n=Math.floor(+n),!(e=Math.floor(+e)))return[];if(n===t)return[n];if(r=t<n){const a=n;n=t,t=a}let s=l1(1,t-n+1)(e);if(o=Math.floor((t-n+1)/s),!i)for(;Math.ceil((t-n+1)/o)>e&&s>1;)s-=1,o=Math.floor((t-n)/s);return yF(n,t,o,r)}function jnt(n,t,e){let i;if(t=Math.floor(+t),n=Math.floor(+n),e=l1(1,t-n+1)(Math.floor(+e)),i=t<n){const r=n;n=t,t=r}return yF(n,t,e,i)}class u0 extends d1{constructor(t){super(),this.type=gs.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;const i=this._calculateWholeRange(this._range,e),r=super.domain().length,o=i[1]<i[0];let s=i[Number(o)-0];const a=i[1-Number(o)],l=h1(r,this._paddingInner,this._paddingOuter);return this._step=(a-s)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),s+=(a-s-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(s=Math.round(s),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:o,start:o?s+this._step*(r-1):s,count:r},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;const e=`${t}`,i=this._getSpecifiedValue(e);if(i!==void 0)return i;let r=this._index.get(e);if(!r){if(this._unknown!==cy)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}const{count:o,start:s,reverse:a}=this._bandRangeState,l=s+(a?-1:1)*((r-1)%o)*this._step;return this._fishEyeTransform?this._fishEyeTransform(l):l}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){let i;if(ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)&&t.length===2){const o=bF(t,[this._rangeFactorStart,this._rangeFactorEnd]);i=Math.abs(o[1]-o[0])}else i=Math.abs(t[1]-t[0]);const r=Nnt(super.domain().length,i,this._paddingInner,this._paddingOuter,this._round);r<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):r>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=r,this._isFixed=!1)}if(this.isBandwidthFixed()){const i=znt(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),r=Math.min((t[1]-t[0])/i,1);if(ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)){if(i>0){const a=t[0]-i*this._rangeFactorStart,l=a+i;this._wholeRange=[a,l]}else{const a=t[1]+i*(1-this._rangeFactorEnd),l=a-i;this._wholeRange=[l,a]}const o=this._rangeFactorStart+r<=1,s=this._rangeFactorEnd-r>=0;e==="rangeFactorStart"&&o?this._rangeFactorEnd=this._rangeFactorStart+r:e==="rangeFactorEnd"&&s?this._rangeFactorStart=this._rangeFactorEnd-r:t[0]<=t[1]?o?this._rangeFactorEnd=this._rangeFactorStart+r:s?this._rangeFactorStart=this._rangeFactorEnd-r:(this._rangeFactorStart=0,this._rangeFactorEnd=r):s?this._rangeFactorStart=this._rangeFactorEnd-r:o?this._rangeFactorEnd=this._rangeFactorStart+r:(this._rangeFactorStart=1-r,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=r,this._wholeRange=[t[0],t[0]+i];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){const t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){const e=this._domain;if(ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)&&e.length){const i=this._getInvertIndex(t[0]),r=this._getInvertIndex(t[1]);return e.slice(Math.min(i,r),Math.max(i,r)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[Lh(t[0]),Lh(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[Lh(t[0]),Lh(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return t===-1?e:VM(0,e.length-1,t,!1).map(i=>e[i])}tickData(t=10){return this.ticks(t).map((e,i)=>({index:i,tick:e,value:(this.scale(e)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return VM(0,e.length-1,t,!0).filter(i=>i<e.length).map(i=>e[i])}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return jnt(0,e.length-1,t).map(i=>e[i])}_getInvertIndex(t){let e=0;const i=this.step()/2,r=this.bandwidth()/2,o=this._domain.length,s=this.range(),a=s[0]>s[s.length-1];for(e=0;e<o;e++){const l=this.scale(this._domain[e])+r;if(e===0&&(!a&&!PM(t,l+i)||a&&!kM(t,l-i))||e===o-1||!kM(t,l-i)&&!PM(t,l+i))break}return e>=0&&e<=o-1?e:o-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return t!==void 0?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return t!==void 0?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return t!==void 0?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return t!==void 0?(this._round=t,this.rescale(e)):this._round}align(t,e){return t!==void 0?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return Vi(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return Vi(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?(t==="auto"?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth=t==="auto"?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth=t==="auto"?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&Ar(this._userBandwidth)}clone(){var t,e,i;return new u0(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth((t=this._userBandwidth)!==null&&t!==void 0?t:"auto",!0).maxBandwidth((e=this._maxBandwidth)!==null&&e!==void 0?e:"auto",!0).minBandwidth((i=this._maxBandwidth)!==null&&i!==void 0?i:"auto")}}const{interpolateRgb:Ub}=lnt;function Gnt(n,t){const e=typeof t;let i;if(Vi(t)||e==="boolean")return()=>t;if(e==="number")return zf(n,t);if(e==="string"){if(i=$n.parseColorString(t)){const r=Ub($n.parseColorString(n),i);return o=>r(o).formatRgb()}return zf(Number(n),Number(t))}return t instanceof Or?Ub(n,t):t instanceof $n?Ub(n.color,t.color):t instanceof Date?int(n,t):zf(Number(n),Number(t))}class wF extends CF{constructor(t=El,e=El){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=El,this._piecewise=UM,this._interpolate=Gnt}calculateVisibleDomain(t){var e;return ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:(e=this._niceDomain)!==null&&e!==void 0?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),zf)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;const r=Array.from(t,Lh);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();const i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){const i=Array.from(t);return this._range=i,this._interpolate=ent,this.rescale(e)}rescale(t){var e;if(t)return this;const i=(e=this._niceDomain)!==null&&e!==void 0?e:this._domain,r=i.length,o=this._range.length;let s=Math.min(r,o);if(r&&r<o&&this._forceAlign){const a=o-r+1,l=i[r-1],u=r>=2?(l-i[r-2])/a:0;for(let h=1;h<=a;h++)i[r-2+h]=l-u*(a-h);s=o}return this._autoClamp&&(this._clamp=l1(i[0],i[s-1])),this._piecewise=s>2?Wnt:UM,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:El),this.rescale(i)):this._clamp!==El}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){const e=this.ticks(t);return(e??[]).map((i,r)=>({index:r,tick:i,value:(this.scale(i)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return Vi(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return Vi(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}const $nt=Math.sqrt(50),qnt=Math.sqrt(10),Xnt=Math.sqrt(2),Cf=[1,2,5,10],jM=(n,t,e)=>{let i=1,r=n;const o=Math.floor((t-1)/2),s=Math.abs(n);return n>=0&&n<=Number.MIN_VALUE?r=0:n<0&&n>=-Number.MIN_VALUE?r=-(t-1):!e&&s<1?i=SF(s).step:(e||s>1)&&(r=Math.floor(n)-o*i),i>0?(n>0?r=Math.max(r,0):n<0&&(r=Math.min(r,-(t-1)*i)),Yrt(0,t).map(a=>r+a*i)):n>0?nm(0,-(t-1)/i,i):nm((t-1)/i,0,i)},Ynt=ec((n,t,e,i)=>{let r,o,s,a,l=-1;if(e=+e,(n=+n)==(t=+t))return[n];if(Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return[n];if((r=t<n)&&(o=n,n=t,t=o),a=c1(n,t,e).step,!isFinite(a))return[];if(a>0){let u=Math.round(n/a),h=Math.round(t/a);for(u*a<n&&++u,h*a>t&&--h,s=new Array(o=h-u+1);++l<o;)s[l]=(u+l)*a}else if(a<0&&(i!=null&&i.noDecimals)){a=1;const u=Math.ceil(n),h=Math.floor(t);if(!(u<=h))return[];for(s=new Array(o=h-u+1);++l<o;)s[l]=u+l}else{a=-a;let u=Math.round(n*a),h=Math.round(t*a);for(u/a<n&&++u,h/a>t&&--h,s=new Array(o=h-u+1);++l<o;)s[l]=(u+l)/a}return r&&s.reverse(),s}),nm=(n,t,e)=>{let i,r,o=-1;if(e>0){let s=Math.floor(n/e),a=Math.ceil(t/e);for((s+1)*e<n&&++s,(a-1)*e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)*e}else{e=-e;let s=Math.floor(n*e),a=Math.ceil(t*e);for((s+1)/e<n&&++s,(a-1)/e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)/e}return r},Knt=(n,t,e)=>{let i;const r=n[0],o=n[n.length-1],s=t-n.length;if(o<=0){const u=[];for(i=s;i>=1;i--)u.push(r-i*e);return u.concat(n)}if(r>=0){for(i=1;i<=s;i++)n.push(o+i*e);return n}let a=[];const l=[];for(i=1;i<=s;i++)i%2==0?a=[r-Math.floor(i/2)*e].concat(a):l.push(o+Math.ceil(i/2)*e);return a.concat(n).concat(l)},om=ec((n,t,e,i)=>{let r,o,s;if(e=+e,(n=+n)==(t=+t)||Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return jM(n,e,i==null?void 0:i.noDecimals);(r=t<n)&&(s=n,n=t,t=s);const a=c1(n,t,e);let l=a.step;if(!isFinite(l))return[];if(l>0){let u=1;const{power:h,gap:d}=a,c=d===10?2*10**h:1*10**h;for(;u<=5&&(o=nm(n,t,l),o.length>e+1)&&e>2;)l+=c,u+=1;e>2&&o.length<e-1&&(o=Knt(o,e,l))}else i!=null&&i.noDecimals&&l<0&&(l=1),o=nm(n,t,l);return r&&o.reverse(),o}),SF=n=>{const t=Math.floor(Math.log(n)/Math.LN10),e=n/10**t;let i=Cf[0];return e>=$nt?i=Cf[3]:e>=qnt?i=Cf[2]:e>=Xnt&&(i=Cf[1]),t>=0?{step:i*10**t,gap:i,power:t}:{step:-(10**-t)/i,gap:i,power:t}};function c1(n,t,e){const i=(t-n)/Math.max(0,e);return SF(i)}function xF(n,t,e){let i;if(e=+e,(n=+n)==(t=+t)&&e>0)return[n];if(e<=0||(i=Znt(n,t,e))===0||!isFinite(i))return[];const r=new Array(e);for(let o=0;o<e;o++)r[o]=n+o*i;return r}function Znt(n,t,e){return(t-n)/Math.max(1,e-1)}function Qnt(n,t,e){let i,r,o=-1;if(e=+e,(r=(t=+t)<(n=+n))&&(i=n,n=t,t=i),!isFinite(e)||t-n<=e)return[n];const s=Math.floor((t-n)/e+1),a=new Array(s);for(;++o<s;)a[o]=n+o*e;return r&&a.reverse(),a}function Vb(n,t=10){let e,i,r=0,o=n.length-1,s=n[r],a=n[o],l=10;for(a<s&&(i=s,s=a,a=i,i=r,r=o,o=i);l-- >0;){if(i=c1(s,a,t).step,i===e)return n[r]=s,n[o]=a,n;if(i>0)s=Math.floor(s/i)*i,a=Math.ceil(a/i)*i;else{if(!(i<0))break;s=Math.ceil(s*i)/i,a=Math.floor(a*i)/i}e=i}}function TF(n,t){const e=Ar(t.forceMin),i=Ar(t.forceMax);let r=null;const o=[];let s=null;const a=e&&i?l=>l>=t.forceMin&&l<=t.forceMax:e?l=>l>=t.forceMin:i?l=>l<=t.forceMax:null;return e?o[0]=t.forceMin:Ar(t.min)&&t.min<=Math.min(n[0],n[n.length-1])&&(o[0]=t.min),i?o[1]=t.forceMax:Ar(t.max)&&t.max>=Math.max(n[0],n[n.length-1])&&(o[1]=t.max),Ar(o[0])&&Ar(o[1])?(s=n.slice(),s[0]=o[0],s[s.length-1]=o[1]):r=Ar(o[0])||Ar(o[1])?Ar(o[0])?"max":"min":"all",{niceType:r,niceDomain:s,niceMinMax:o,domainValidator:a}}const jb=(n,t,e)=>Math.abs(t-n)<1?+e.toFixed(1):Math.round(+e),AF=ec((n,t,e,i,r,o,s)=>{let a=n,l=t;const u=l<a;u&&([a,l]=[l,a]);let h,d,c=r(a),f=r(l),g=[];if(!(i%1)&&f-c<e){if(c=Math.floor(c),f=Math.ceil(f),a>0){for(;c<=f;++c)for(h=1;h<i;++h)if(d=c<0?h/o(-c):h*o(c),!(d<a)){if(d>l)break;g.push(d)}}else for(;c<=f;++c)for(h=i-1;h>=1;--h)if(d=c>0?h/o(-c):h*o(c),!(d<a)){if(d>l)break;g.push(d)}2*g.length<e&&(g=om(a,l,e))}else g=om(c,f,Math.min(f-c,e)).map(o);return g=g.filter(m=>m!==0),s!=null&&s.noDecimals&&(g=Array.from(new Set(g.map(m=>Math.floor(m))))),u?g.reverse():g}),RF=ec((n,t,e,i,r,o)=>{const s=[],a={},l=r(n),u=r(t);let h=[];if(Number.isInteger(i))h=om(l,u,e);else{const d=(u-l)/(e-1);for(let c=0;c<e;c++)h.push(l+c*d)}return h.forEach(d=>{const c=o(d),f=Number.isInteger(i)?jb(n,t,c):jb(n,t,_F(c)),g=jb(n,t,Vnt(f,[n,t]));!a[g]&&!isNaN(g)&&h.length>1&&(a[g]=1,s.push(g))}),s}),sm=ec((n,t,e,i,r)=>xF(i(n),i(t),e).map(o=>_F(r(o))));class Xu extends wF{constructor(){super(...arguments),this.type=gs.Linear}clone(){return new Xu().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(t=10,e){const i=this.calculateVisibleDomain(this._range);return Ynt(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(Nrt(e==null?void 0:e.customTicks))return e.customTicks(this,t);if(ri(this._rangeFactorStart)&&ri(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&this._range.length===2||!this._niceType)return this.d3Ticks(t,e);const r=(i=this._niceDomain)!==null&&i!==void 0?i:this._domain,o=this._domain,s=r[0],a=r[r.length-1];let l=om(o[0],o[o.length-1],t,e);if(!l.length)return l;if(this._domainValidator)l=l.filter(this._domainValidator);else if((l[0]!==s||l[l.length-1]!==a)&&this._niceType){const u=r.slice();if(this._niceType==="all"?(u[0]=l[0],u[u.length-1]=l[l.length-1],this._niceDomain=u,this.rescale()):this._niceType==="min"&&l[0]!==s?(u[0]=l[0],this._niceDomain=u,this.rescale()):this._niceType==="max"&&l[l.length-1]!==a&&(u[u.length-1]=l[l.length-1],this._niceDomain=u,this.rescale()),this._niceType!=="all"){const h=Math.min(u[0],u[u.length-1]),d=Math.max(u[0],u[u.length-1]);l=l.filter(c=>c>=h&&c<=d)}}return l}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return xF(e[0],e[e.length-1],t)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return Qnt(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;const o=this._domain;let s=[];if(e){const a=TF(o,e);if(s=a.niceMinMax,this._domainValidator=a.domainValidator,this._niceType=a.niceType,a.niceDomain)return this._niceDomain=a.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){const a=Vb(o.slice(),t);this._niceType==="min"?a[a.length-1]=(i=s[1])!==null&&i!==void 0?i:a[a.length-1]:this._niceType==="max"&&(a[0]=(r=s[0])!==null&&r!==void 0?r:a[0]),this._niceDomain=a,this.rescale()}return this}niceMin(t=10){this._niceType="min";const e=this._domain[this._domain.length-1],i=Vb(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";const e=this._domain[0],i=Vb(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}class EF{nice(t=10,e){var i,r,o,s;const a=this._domain;let l=[],u=null;if(e){const h=TF(a,e);if(l=h.niceMinMax,this._domainValidator=h.domainValidator,u=h.niceType,h.niceDomain)return this._niceDomain=h.niceDomain,this.rescale(),this}else u="all";if(u){const h=Unt(a.slice(),(r=(i=this.getNiceConfig)===null||i===void 0?void 0:i.call(this))!==null&&r!==void 0?r:{floor:d=>Math.floor(d),ceil:d=>Math.ceil(d)});return u==="min"?h[h.length-1]=(o=l[1])!==null&&o!==void 0?o:h[h.length-1]:u==="max"&&(h[0]=(s=l[0])!==null&&s!==void 0?s:h[0]),this._niceDomain=h,this.rescale(),this}return this}niceMin(){const t=this._domain[this._domain.length-1];this.nice();const e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){const t=this._domain[0];this.nice();const e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}function GM(n){return t=>-n(-t)}function $M(n=Number.EPSILON){return t=>Math.max(t,n)}function Jnt(n=Number.EPSILON){return t=>Math.min(t,-n)}class ic extends wF{constructor(){super(zM(10),HM(10)),this.type=gs.Log,this._limit=$M(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return new ic().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e;if(t)return this;super.rescale();const i=zM(this._base),r=HM(this._base);return((e=this._niceDomain)!==null&&e!==void 0?e:this._domain)[0]<0?(this._logs=GM(i),this._pows=GM(r),this._limit=Jnt(),this.transformer=Fnt,this.untransformer=Ont):(this._logs=i,this._pows=r,this._limit=$M(),this.transformer=this._logs,this.untransformer=r),this}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return El}d3Ticks(t=10,e){const i=this.domain(),r=this._limit(i[0]),o=this._limit(i[i.length-1]);return AF(r,o,t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return RF(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return sm(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return sm(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}hF(ic,EF);class tot extends u0{constructor(t){super(!1),this.type=gs.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}}class rc extends Xu{constructor(){super(NM(1),WM(1)),this.type=gs.Symlog,this._const=1}clone(){return new rc().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=NM(t),this.untransformer=WM(t),this.rescale(e)):this._const}d3Ticks(t=10,e){const i=this.domain(),r=i[0],o=i[i.length-1];return AF(r,o,t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return RF(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return sm(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return sm(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}hF(rc,EF);class eot{constructor(){this._scale=new u0,this._scales=[this._scale]}valueToPosition(t){return this._scale.scale(t)}getPosition(t){let e=0,i=this._scale;if(this._scales.length===1||t.length===1)e=this.valueToPosition(t[0]);else{const r=Math.min(t.length,this._scales.length);for(let o=0;o<r;o++)e+=this._scales[o].scale(t[o]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;const{bandPadding:o,paddingInner:s,paddingOuter:a}=this,l=Wt(o),u=Wt(s),h=Wt(a);for(let d=0;d<this._scales.length;d++){const c=l?o[d]:o,f=u?s[d]:s,g=h?a[d]:a;this._scales[d].paddingInner((i=f??c)!==null&&i!==void 0?i:t,!0).paddingOuter((r=g??c)!==null&&r!==void 0?r:e)}}dataToPosition(t,e={}){var i;if(t.length===0||this._scales.length===0)return 0;const{position:r,bandScale:o}=this.getPosition(t);return r+o.bandwidth()*((i=e.bandPosition)!==null&&i!==void 0?i:.5)}updateScaleDomain(t){for(let e=0;e<this._scales.length;e++)this._scales[e].domain(t)}updateRange(t){const[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}function iot(n,t,e){n.getTransform(t)||n.registerTransform(t,e)}function rot(n,t,e){n.getParser(t)||n.registerParser(t,e)}const not=Math.sqrt(50),oot=Math.sqrt(10),sot=Math.sqrt(2);class aot{constructor(t){this._extend={},this.type=t??"linear",this._scale=t==="log"?new ic:t==="symlog"?new rc:new Xu,this._scales=[this._scale]}setExtraAttrFromSpec(t,e,i,r,o,s){this.nice=!1,this.zero=e,this.zero&&(i.min=Math.min(i.min,0),i.max=Math.max(i.max,0)),this.domain=i,this.expand=r,this.type==="log"?this._scale.base(o??10):this.type==="symlog"&&this._scale.constant(s??10)}transformScaleDomain(){this.type==="symlog"||this.type==="log"||this.setScaleNice()}setScaleNice(){this.type==="log"?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var t,e,i,r,o,s;xe((t=this.domain)===null||t===void 0?void 0:t.min)&&xe((e=this.domain)===null||e===void 0?void 0:e.max)?this.nice&&this._scale.nice():et((i=this.domain)===null||i===void 0?void 0:i.min)&&xe((r=this.domain)===null||r===void 0?void 0:r.max)?this.nice&&this._scale.niceMax():xe((o=this.domain)===null||o===void 0?void 0:o.min)&&et((s=this.domain)===null||s===void 0?void 0:s.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var t,e,i,r,o,s,a,l;let u=(e=(t=this.forceTickCount)!==null&&t!==void 0?t:this.tickCount)!==null&&e!==void 0?e:10;this.niceType==="accurateFirst"&&(u=Math.max(10,u)),xe((i=this.domain)===null||i===void 0?void 0:i.min)&&xe((r=this.domain)===null||r===void 0?void 0:r.max)?this.nice&&this._scale.nice(u):et((o=this.domain)===null||o===void 0?void 0:o.min)&&xe((s=this.domain)===null||s===void 0?void 0:s.max)?this.nice&&this._scale.niceMax(u):xe((a=this.domain)===null||a===void 0?void 0:a.min)&&et((l=this.domain)===null||l===void 0?void 0:l.max)?this.nice&&this._scale.niceMin(u):this.nice&&this._scale.nice(u)}dataToPosition(t){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){const e=[];return t.forEach(i=>{const{min:r,max:o}=i;e[0]=e[0]===void 0?r:Math.min(e[0],r),e[1]=e[1]===void 0?o:Math.max(e[1],o)}),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this.expand)return;const e=t[0],i=t[t.length-1];et(this.expand.min)&&(t[0]=e-(i-e)*this.expand.min),et(this.expand.max)&&(t[t.length-1]=i+(i-e)*this.expand.max)}niceDomain(t){if(et(t[0])||et(t[1])||this.type!=="linear")return t;if(Math.abs(cK(t)-dK(t))<=1e-12){let e=t[0];const i=e>=0?1:-1;if(e=Math.abs(e),e<1)t[0]=0,t[1]=1;else{let r=e/5;const o=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,o);r=(s>=not?10:s>=oot?5:s>=sot?2:1)*Math.pow(10,o),t[0]=0,t[1]=10*r}i<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t}niceMinMax(){var t,e,i,r,o,s,a,l;if(this.nice){let u=(e=(t=this.forceTickCount)!==null&&t!==void 0?t:this.tickCount)!==null&&e!==void 0?e:10;this.niceType==="accurateFirst"&&(u=Math.max(10,u)),xe((i=this.domain)===null||i===void 0?void 0:i.min)&&xe((r=this.domain)===null||r===void 0?void 0:r.max)?this._scale.nice(u):et((o=this.domain)===null||o===void 0?void 0:o.min)&&xe((s=this.domain)===null||s===void 0?void 0:s.max)?this._scale.niceMax(u):xe((a=this.domain)===null||a===void 0?void 0:a.min)&&et((l=this.domain)===null||l===void 0?void 0:l.max)?this._scale.niceMin(u):this._scale.nice(u)}}includeZero(t){this.zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))}setExtendDomain(t,e){if(e===void 0)return void delete this._extend[t];this._extend[t]=e;const i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this.nice),this.niceMinMax()}extendDomain(t){let e;const i=t.length-1,r=t[0]-t[i]>0,o=r?i:0,s=r?0:i;for(const a in this._extend)e=this._extend[a],e>t[s]&&(t[s]=e),e<t[o]&&(t[o]=e)}setDomainMinMax(t){if(!this.domain)return;const{min:e,max:i}=this.domain;et(e)&&(t[0]=e),et(i)&&(t[1]=i)}setZero(t){this.zero!==t&&(this.zero=t,this.updateScaleDomain())}updateScaleDomain(){const t=this.computeDomain([this.domain]);this.updateScaleDomainByModel(t)}computeDomain(t){return this.computeLinearDomain(t)}updateScaleDomainByModel(t){t=t??this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this.nice),this.niceMinMax()}updateRange(t){const[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}function lot(n,t){const e=n.find(r=>r.name==="axis-label-container-layer-0",!0),i=n.find(r=>r.name==="axis-label-container-layer-1",!0);qM(e?e.getChildren():[],t),qM(i?i.getChildren():[],t)}function uot(n,t){const{width:e,height:i}=t.getLayoutRect(),r=hy(t.orient),o=t.option.inverse===!0,s=n[0],a=hK(n);if(r)if(o){const l=e,u=0,h=s.AABBBounds.x2,d=a.AABBBounds.x1;h>l&&s.setAttributes({x:l,textAlign:"right"}),d<u&&a.setAttributes({x:u,textAlign:"left"})}else{const u=e,h=s.AABBBounds.x1,d=a.AABBBounds.x2;h<0&&s.setAttributes({x:0,textAlign:"left"}),d>u&&a.setAttributes({x:u,textAlign:"right"})}else if(o){const l=s.AABBBounds.y1,u=a.AABBBounds.y2,h=0,d=i;l<h&&s.setAttributes({y:h,textBaseline:"top"}),u>d&&a.setAttributes({y:d,textBaseline:"bottom"})}else{const l=i,u=0,h=s.AABBBounds.y2,d=a.AABBBounds.y1;h>l&&s.setAttributes({y:l,textBaseline:"bottom"}),d<u&&a.setAttributes({y:u,textBaseline:"top"})}}function qM(n,t){var e;const i=t.option;or(n)||!((e=i==null?void 0:i.label)===null||e===void 0)&&e.flush&&uot(n,t)}const hot=n=>n;class dot{constructor(t,e,i,r,o){var s,a,l;this.x=0,this.y=0,this.padding=r,this.table=o,this.orient=(s=t.orient)!==null&&s!==void 0?s:"left",this.type=(a=t.type)!==null&&a!==void 0?a:"band",this.option=Ie({},vnt(t.__vtableChartTheme),cot(this.orient,o.theme),fot(this.orient,this.type,t.__vtableChartTheme),t),this.orient==="left"||this.orient==="right"?(this.width=e,this.height=i-r[0]-r[2]-0,this.y=r[0]+0):(this.orient==="top"||this.orient==="bottom")&&(this.width=e-r[1]-r[3]-0,this.height=i,this.x=r[3]+0),this.visible=(l=t.visible)===null||l===void 0||l,this.inverse="inverse"in t&&!!t.inverse,t.type==="band"&&(this.data=t.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){const t=this.option;this.type==="band"||this.type==="point"?(this.scale=new eot,this.scale.bandPadding=t.bandPadding,this.scale.paddingInner=t.paddingInner,this.scale.paddingOuter=t.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):this.type!=="linear"&&this.type!=="time"&&this.type!=="log"&&this.type!=="symlog"||(this.scale=new aot(this.type),this.scale.setExtraAttrFromSpec(t.nice,t.zero,t.range,t.expand,t.base,t.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){this.table._vDataSet||(this.table._vDataSet=new fnt),rot(this.table._vDataSet,"scale",hot),iot(this.table._vDataSet,"ticks",HY);const t=this.option.label||{},e=this.option.tick||{},i=new pF(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:this.option.sampling!==!1,tickCount:e.tickCount,forceTickCount:e.forceTickCount,tickStep:e.tickStep,tickMode:e.tickMode,noDecimals:e.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:t.style,labelFormatter:t.formatMethod,labelGap:t.minGap,labelLastVisible:t.lastVisible,labelFlush:t.flush}},!1);this.tickData=i,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){const t=IM(this.option),e=this.getUpdateAttribute();e.verticalFactor=this.orient==="top"||this.orient==="right"?-1:1,this.component=new Td(Ie({disableTriggerEvent:this.table.options.disableInteraction},t,e)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(t,e){this.width=t-(this.orient==="top"||this.orient==="bottom"?this.padding[1]+this.padding[3]:0),this.height=e-(this.orient==="left"||this.orient==="right"?this.padding[2]+this.padding[0]:0),this.updateScaleRange(),this.computeData();const i=IM(this.option),r=this.getUpdateAttribute();r.verticalFactor=this.orient==="top"||this.orient==="right"?-1:1,this.component.setAttributes(Ie({},i,r)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){lot(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;const{width:t,height:e}=this.getLayoutRect(),i=hy(this.orient),r=Int(this.orient);let o={x:0,y:0},s=0;i?(o={x:t,y:0},s=t):r&&(o={x:0,y:e},s=e);const a=this.orient==="top"||this.orient==="bottom"?e:t;return{start:{x:0,y:0},end:o,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(i)},items:this.getLabelItems(s),verticalLimitSize:a,verticalMinSize:a}}getLabelItems(t){return[this.tickData.latestData.map(e=>({id:e.value,label:e.value,value:t===0?0:this.scale.dataToPosition([e.value])/t,rawValue:e.value})).filter(e=>e.value>=0&&e.value<=1)]}updateScaleRange(){var t,e,i,r,o,s,a,l;const u=(e=(t=this.option.innerOffset)===null||t===void 0?void 0:t.right)!==null&&e!==void 0?e:0,h=(r=(i=this.option.innerOffset)===null||i===void 0?void 0:i.left)!==null&&r!==void 0?r:0,d=(s=(o=this.option.innerOffset)===null||o===void 0?void 0:o.top)!==null&&s!==void 0?s:0,c=(l=(a=this.option.innerOffset)===null||a===void 0?void 0:a.bottom)!==null&&l!==void 0?l:0,{width:f,height:g}=this.getLayoutRect(),m=this.option.inverse||!1;let p=[0,0];hy(this.orient)?Oa(f)&&(p=m?[f-u,h]:[h,f-u]):Oa(g)&&(p=m?[d,g-c]:[g-c,d]),this.scale.updateRange(p)}setLayoutStartPosition(t){let{x:e,y:i}=t;return Oa(e)&&(e+=+(this.orient==="left")*this.getLayoutRect().width),Oa(i)&&(i+=+(this.orient==="top")*this.getLayoutRect().height),{x:e,y:i}}_getTitleLimit(t){var e,i,r;if(this.option.title.visible&&xe((e=this.option.title.style)===null||e===void 0?void 0:e.maxLineWidth)){let o=((i=this.option.title.style)===null||i===void 0?void 0:i.angle)||0;if(!((r=this.option.title)===null||r===void 0)&&r.autoRotate&&xe(this.option.title.angle)&&(o=this.option.orient==="left"?-90:90),t){const l=this.getLayoutRect().width,u=Math.abs(Math.cos(gp(o)));return u<1e-6?1/0:l/u}const s=this.getLayoutRect().height,a=Math.abs(Math.sin(gp(o)));return a<1e-6?1/0:s/a}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}function cot(n,t){let e;return n==="left"?e=t.axisStyle.leftAxisStyle:n==="right"?e=t.axisStyle.rightAxisStyle:n==="top"?e=t.axisStyle.topAxisStyle:n==="bottom"&&(e=t.axisStyle.bottomAxisStyle),Ie({},t.axisStyle.defaultAxisStyle,e)}function fot(n,t,e){if(!e)return{};const i=e.axis;let r,o;return t==="linear"||t==="log"||t==="symlog"?r=e.axisLinear:t==="band"&&(r=e.axisBand),n==="top"||n==="bottom"?o=e.axisX:n!=="left"&&n!=="right"||(o=e.axisY),Ie({},i,r,o)}function got(n,t){var e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C;const y=Ie({},rm,n);let w=0;y.tick.visible!==!1&&(w=(e=y.tick.width)!==null&&e!==void 0?e:4);let _=0;if(y.label.visible){if(y.type==="band")y.domain.forEach(T=>{var S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt;y.label.formatMethod&&(T=y.label.formatMethod(T));const{width:J,height:st}=t.measureText(T,{fontSize:(E=(x=(S=y.label)===null||S===void 0?void 0:S.style)===null||x===void 0?void 0:x.fontSize)!==null&&E!==void 0?E:nu,fontWeight:(I=(L=(M=y.label)===null||M===void 0?void 0:M.style)===null||L===void 0?void 0:L.fontWeight)!==null&&I!==void 0?I:"normal",fontFamily:(O=(H=(D=y.label)===null||D===void 0?void 0:D.style)===null||H===void 0?void 0:H.fontFamily)!==null&&O!==void 0?O:ru}),ht=((U=(N=y.label)===null||N===void 0?void 0:N.style)===null||U===void 0?void 0:U.maxLineWidth)||1/0,at=((Y=(j=(W=y.label)===null||W===void 0?void 0:W.style)===null||j===void 0?void 0:j.angle)!==null&&Y!==void 0?Y:0)+(((rt=(Z=y.label)===null||Z===void 0?void 0:Z.style)===null||rt===void 0?void 0:rt.direction)==="vertical"?90:0);_=Math.max(_,ou(Math.min(J,ht),st,at).width)});else{let T;if(!((i=n.sync)===null||i===void 0)&&i.tickAlign&&pn((r=n.tick)===null||r===void 0?void 0:r.tickMode))T=n.tick.tickMode();else if(Wt(n.__ticksForVTable))T=n.__ticksForVTable;else{const S=y.range,x=Math.abs(S.min)>1?Math.round(S.min):S.min,E=Math.abs(S.max)>1?Math.round(S.max):S.max;T=[am(x),am(E)]}T.forEach(S=>{var x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J;y.label.formatMethod&&(S=y.label.formatMethod(S));const{width:st,height:ht}=t.measureText(S,{fontSize:(M=(E=(x=y.label)===null||x===void 0?void 0:x.style)===null||E===void 0?void 0:E.fontSize)!==null&&M!==void 0?M:nu,fontWeight:(D=(I=(L=y.label)===null||L===void 0?void 0:L.style)===null||I===void 0?void 0:I.fontWeight)!==null&&D!==void 0?D:"normal",fontFamily:(N=(O=(H=y.label)===null||H===void 0?void 0:H.style)===null||O===void 0?void 0:O.fontFamily)!==null&&N!==void 0?N:ru}),at=((W=(U=y.label)===null||U===void 0?void 0:U.style)===null||W===void 0?void 0:W.maxLineWidth)||1/0,lt=((Z=(Y=(j=y.label)===null||j===void 0?void 0:j.style)===null||Y===void 0?void 0:Y.angle)!==null&&Z!==void 0?Z:0)+(((J=(rt=y.label)===null||rt===void 0?void 0:rt.style)===null||J===void 0?void 0:J.direction)==="vertical"?90:0);_=Math.max(_,ou(Math.min(st,at),ht,lt).width)})}_+=(o=y.label.space)!==null&&o!==void 0?o:4}let A=0;if(y.title.visible&&ei(y.title.text)){const{width:T,height:S}=t.measureText(y.title.text,{fontSize:(l=(a=(s=y.title)===null||s===void 0?void 0:s.style)===null||a===void 0?void 0:a.fontSize)!==null&&l!==void 0?l:nu,fontWeight:(d=(h=(u=y.title)===null||u===void 0?void 0:u.style)===null||h===void 0?void 0:h.fontWeight)!==null&&d!==void 0?d:"normal",fontFamily:(g=(f=(c=y.title)===null||c===void 0?void 0:c.style)===null||f===void 0?void 0:f.fontFamily)!==null&&g!==void 0?g:ru}),x=((p=(m=y.label)===null||m===void 0?void 0:m.style)===null||p===void 0?void 0:p.maxLineWidth)||1/0,E=ou(Math.min(T,x),S,(b=(v=y.title)===null||v===void 0?void 0:v.style)===null||b===void 0?void 0:b.angle);A=n.orient!=="left"&&n.orient!=="right"||!y.title.autoRotate?E.width:E.height,A+=(C=y.title.space)!==null&&C!==void 0?C:4}return Math.ceil(w+_+A+1)}function pot(n,t){var e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b,C;const y=Ie({},rm,n);let w=0;y.tick.visible!==!1&&(w=(e=y.tick.width)!==null&&e!==void 0?e:4);let _=0;if(y.label.visible){if(y.type==="band")y.domain.forEach(T=>{var S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt;y.label.formatMethod&&(T=y.label.formatMethod(T));const{width:J,height:st}=t.measureText(T,{fontSize:(E=(x=(S=y.label)===null||S===void 0?void 0:S.style)===null||x===void 0?void 0:x.fontSize)!==null&&E!==void 0?E:nu,fontWeight:(I=(L=(M=y.label)===null||M===void 0?void 0:M.style)===null||L===void 0?void 0:L.fontWeight)!==null&&I!==void 0?I:"normal",fontFamily:(O=(H=(D=y.label)===null||D===void 0?void 0:D.style)===null||H===void 0?void 0:H.fontFamily)!==null&&O!==void 0?O:ru}),ht=((U=(N=y.label)===null||N===void 0?void 0:N.style)===null||U===void 0?void 0:U.maxLineWidth)||1/0,at=((Y=(j=(W=y.label)===null||W===void 0?void 0:W.style)===null||j===void 0?void 0:j.angle)!==null&&Y!==void 0?Y:0)+(((rt=(Z=y.label)===null||Z===void 0?void 0:Z.style)===null||rt===void 0?void 0:rt.direction)==="vertical"?90:0);_=Math.max(_,ou(Math.min(J,ht),st,at).height)});else{let T;if(!((i=n.sync)===null||i===void 0)&&i.tickAlign&&pn((r=n.tick)===null||r===void 0?void 0:r.tickMode))T=n.tick.tickMode();else if(Wt(n.__ticksForVTable))T=n.__ticksForVTable;else{const S=y.range,x=Math.abs(S.min)>1?Math.round(S.min):S.min,E=Math.abs(S.max)>1?Math.round(S.max):S.max;T=[am(x),am(E)]}T.forEach(S=>{var x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J;y.label.formatMethod&&(S=y.label.formatMethod(S));const{width:st,height:ht}=t.measureText(S,{fontSize:(M=(E=(x=y.label)===null||x===void 0?void 0:x.style)===null||E===void 0?void 0:E.fontSize)!==null&&M!==void 0?M:nu,fontWeight:(D=(I=(L=y.label)===null||L===void 0?void 0:L.style)===null||I===void 0?void 0:I.fontWeight)!==null&&D!==void 0?D:"normal",fontFamily:(N=(O=(H=y.label)===null||H===void 0?void 0:H.style)===null||O===void 0?void 0:O.fontFamily)!==null&&N!==void 0?N:ru}),at=((W=(U=y.label)===null||U===void 0?void 0:U.style)===null||W===void 0?void 0:W.maxLineWidth)||1/0,lt=((Z=(Y=(j=y.label)===null||j===void 0?void 0:j.style)===null||Y===void 0?void 0:Y.angle)!==null&&Z!==void 0?Z:0)+(((J=(rt=y.label)===null||rt===void 0?void 0:rt.style)===null||J===void 0?void 0:J.direction)==="vertical"?90:0);_=Math.max(_,ou(Math.min(st,at),ht,lt).height)})}_+=(o=y.label.space)!==null&&o!==void 0?o:4}let A=0;if(y.title.visible&&y.title.text){const{width:T,height:S}=t.measureText(y.title.text,{fontSize:(l=(a=(s=y.title)===null||s===void 0?void 0:s.style)===null||a===void 0?void 0:a.fontSize)!==null&&l!==void 0?l:nu,fontWeight:(d=(h=(u=y.title)===null||u===void 0?void 0:u.style)===null||h===void 0?void 0:h.fontWeight)!==null&&d!==void 0?d:"normal",fontFamily:(g=(f=(c=y.title)===null||c===void 0?void 0:c.style)===null||f===void 0?void 0:f.fontFamily)!==null&&g!==void 0?g:ru}),x=((p=(m=y.label)===null||m===void 0?void 0:m.style)===null||p===void 0?void 0:p.maxLineWidth)||1/0,E=ou(Math.min(T,x),S,(b=(v=y.title)===null||v===void 0?void 0:v.style)===null||b===void 0?void 0:b.angle);A=n.orient!=="bottom"&&n.orient!=="top"||!y.title.autoRotate?E.height:E.width,A+=(C=y.title.space)!==null&&C!==void 0?C:4}return w+_+A+1}function am(n){return typeof n!="number"&&(n=Number(n)),Number(n.toPrecision(1)).toString()}function ou(n,t,e=0){const i=e*Math.PI/180,r=-n/2,o=-t/2,s=n/2,a=-t/2,l=n/2,u=t/2,h=-n/2,d=t/2,c={x:r*Math.cos(i)-o*Math.sin(i),y:r*Math.sin(i)+o*Math.cos(i)},f={x:s*Math.cos(i)-a*Math.sin(i),y:s*Math.sin(i)+a*Math.cos(i)},g={x:l*Math.cos(i)-u*Math.sin(i),y:l*Math.sin(i)+u*Math.cos(i)},m={x:h*Math.cos(i)-d*Math.sin(i),y:h*Math.sin(i)+d*Math.cos(i)},p=Math.min(c.x,f.x,g.x,m.x),v=Math.max(c.x,f.x,g.x,m.x),b=Math.min(c.y,f.y,g.y,m.y);return{width:v-p,height:Math.max(c.y,f.y,g.y,m.y)-b}}const mot='<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>';class vot{constructor(t,e){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:mot,width:100,height:100}},this.isReleased=!1,this.table=e,this._emptyTipOption=Object.assign(this._emptyTipOption,t===!0?{}:t),et(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(t){if(this._emptyTipComponent)Ed(t,this._cacheAttrs)||this._emptyTipComponent.setAttributes(t);else{const e=new OD(t);e.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._emptyTipComponent=e,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",t=>{const e=new jh;this._emptyTipComponent.forEachChildren(i=>{e.union(i.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_click",t)}),this._emptyTipComponent.on("dblclick",t=>{const e=new jh;this._emptyTipComponent.forEachChildren(i=>{e.union(i.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_dblclick",t)})}resize(){var t;if(!this._emptyTipComponent)return;const{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:o}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:o,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:(t=this._emptyTipOption.textStyle)===null||t===void 0?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&this.table.recordsCount!==0||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){const t=this.table.transpose||this.table.options.indicatorsAsCol===!1?this.table.getFrozenColsWidth():0,e=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:t,topHeaderHeight:e,width:(this._emptyTipOption.displayMode!=="basedOnContainer"&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-t-this.table.getTheme().scrollStyle.width,height:(this._emptyTipOption.displayMode!=="basedOnContainer"&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-e-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var t;const{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:o}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:o,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:(t=this._emptyTipOption.textStyle)===null||t===void 0?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}var bot=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const _ot={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};function Cot(n,t){const e=Ie({},_ot,n),{title:i={},item:r={},pager:o={},background:s={},type:a,id:l,visible:u,orient:h,position:d,data:c,filter:f,regionId:g,regionIndex:m,seriesIndex:p,seriesId:v,padding:b}=e,C=bot(e,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(C.title=vF(i)),or(r.focusIconStyle)||mi(r.focusIconStyle),qn(r.shape),qn(r.label),qn(r.value),qn(r.background),Sb(r.maxWidth)&&(r.maxWidth=Number(r.maxWidth.substring(0,r.maxWidth.length-1))*t.width/100),Sb(r.width)&&(r.width=Number(r.width.substring(0,r.width.length-1))*t.width/100),Sb(r.height)&&(r.height=Number(r.height.substring(0,r.height.length-1))*t.width/100),C.item=r,or(o.textStyle)||mi(o.textStyle),qn(o.handler),C.pager=o,s.visible&&!or(s.style)&&(Ie(C,s.style),et(s.padding)&&(C.padding=s.padding)),C}class yot{constructor(t,e){var i,r,o,s;this.table=e,this.option=al(t),this.orient=(i=t.orient)!==null&&i!==void 0?i:"left",this.visible=(r=t.visible)===null||r===void 0||r,this.position=(o=t.position)!==null&&o!==void 0?o:"middle",this.selectedData=(s=t.defaultSelected)!==null&&s!==void 0?s:null,this.createComponent(),this.initEvent()}createComponent(){const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),e=new qm(Ie({},t,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));e.name="legend",this.legendComponent=e,this.visible===!1&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&this.visible!==!1&&(this.legendComponent.setAttributes({maxWidth:this.table.tableNoFrameWidth,maxHeight:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,i;if(!this.legendComponent||this.visible===!1)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,o=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||o<=0)return;const s=this.table.tableNoFrameWidth,a=this.table.tableNoFrameHeight,l=me((i=(e=t.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&i!==void 0?i:10);let u=0,h=0;this.orient==="left"?(u=l[3],h=0,r+=l[1]+l[3]):this.orient==="top"?(u=0,h=l[0],o+=l[0]+l[2]):this.orient==="right"?(u=s-r-l[1],h=0,r+=l[1]+l[3]):this.orient==="bottom"&&(u=0,h=a-o-l[2],o+=l[0]+l[2]);const d=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",c=this.position;let f=0,g=0;d==="horizontal"?f=c==="middle"?(s-r)/2:c==="end"?s-r-l[1]:l[3]:g=c==="middle"?(a-o)/2:c==="end"?a-o-l[2]:l[0],this.legendComponent.setAttributes({dx:f,dy:g,x:u,y:h}),this.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):this.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o),this.table.tableY+=Math.ceil(o)):this.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):this.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o))}getLegendAttributes(t){var e,i;const r=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",o=Cot(this.option,t),s=me((i=(e=o.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&i!==void 0?i:10);return Object.assign({layout:r,items:this.getLegendItems(),maxWidth:t.width-s[1]-s[3],maxHeight:t.height-s[0]-s[2]},o)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(Tn.legendItemClick,t=>{const e=kf(t,"detail.currentSelected");this.table.fireListeners(ut.LEGEND_ITEM_CLICK,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(Tn.legendItemHover,t=>{const e=kf(t,"detail");this.table.fireListeners(ut.LEGEND_ITEM_HOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(Tn.legendItemUnHover,t=>{const e=kf(t,"detail");this.table.fireListeners(ut.LEGEND_ITEM_UNHOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",t=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var wot=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const lm={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},Sot={horizontal:Object.assign(Object.assign({},lm),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},lm),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},xot={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},lm),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},lm)};function Tot(n,t){const e=Ie({},(n.type==="color"?Sot:xot)[n.orient==="bottom"||n.orient==="top"?"horizontal":"vertical"],n),{title:i={},handler:r={},rail:o={},track:s={},startText:a,endText:l,handlerText:u,sizeBackground:h,background:d={},type:c,id:f,visible:g,orient:m,position:p,data:v,defaultSelected:b,field:C,filter:y,regionId:w,regionIndex:_,seriesIndex:A,seriesId:T,padding:S}=e,x=wot(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(x.title=vF(i)),x.showHandler=r.visible!==!1,or(r.style)||(x.handlerStyle=mi(r.style)),et(o.width)&&(x.railWidth=o.width),et(o.height)&&(x.railHeight=o.height),or(o.style)||(x.railStyle=mi(o.style)),or(s.style)||(x.trackStyle=mi(s.style)),x.startText=qn(a),x.endText=qn(l),x.handlerText=qn(u),or(h)||(x.sizeBackground=mi(h)),d.visible&&!or(d.style)&&(Ie(x,d.style),et(d.padding)&&(x.padding=d.padding)),x}class Aot{constructor(t,e){var i,r,o,s;this.table=e,this.option=al(t),this.orient=(i=t.orient)!==null&&i!==void 0?i:"left",this.visible=(r=t.visible)===null||r===void 0||r,this.position=(o=t.position)!==null&&o!==void 0?o:"middle",this.selectedData=(s=t.defaultSelected)!==null&&s!==void 0?s:null,this.createComponent(),this.initEvent()}createComponent(){const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});let e;e=this.option.type==="color"?new Xm(Ie({},t,{slidable:!0})):new Ym(Ie({},t,{slidable:!0})),e.name="legend",this.legendComponent=e,this.visible===!1&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&this.visible!==!1&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,i;if(!this.legendComponent||this.visible===!1)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,o=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||o<=0)return;const s=this.table.tableNoFrameWidth,a=this.table.tableNoFrameHeight,l=me((i=(e=t.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&i!==void 0?i:10);let u=0,h=0;this.orient==="left"?(u=l[3],h=0,r+=l[1]+l[3]):this.orient==="top"?(u=0,h=l[0],o+=l[0]+l[2]):this.orient==="right"?(u=s-r-l[1],h=0,r+=l[1]+l[3]):this.orient==="bottom"&&(u=0,h=a-o-l[2],o+=l[0]+l[2]);const d=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",c=this.position;let f=0,g=0;d==="horizontal"?f=c==="middle"?(s-r)/2:c==="end"?s-r-l[1]:l[3]:g=c==="middle"?(a-o)/2:c==="end"?a-o-l[2]:l[0],this.legendComponent.setAttributes({dx:f,dy:g,x:u,y:h}),this.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):this.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o),this.table.tableY+=Math.ceil(o)):this.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):this.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o))}getLegendAttributes(t){const e=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",i=e==="horizontal"?"bottom":this.orient;return Object.assign(Object.assign({},Tot(this.option)),{layout:e,align:i,min:this.option.min,max:this.option.max,value:this.option.value,[this.option.type==="color"?"colors":"sizeRange"]:this.option.type==="color"?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",t=>{const e=kf(t,"detail.value");this.table.fireListeners(ut.LEGEND_CHANGE,{model:this,value:e,event:t}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}function Rot(n,t){return n.type==="color"||n.type==="size"?new Aot(n,t):new yot(n,t)}class MF{constructor(t){this._table=t}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(t,e,i){return this._getMenuElement().bindToCell(this._table,t,e,i)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(t,e){return this._getMenuElement().pointInMenuElement(t,e)}getRootElement(){return this._getMenuElement().rootElement}}const f1="vtable__menu-element",Ml=`${f1}--hidden`,Gb=`${f1}--shown`;function Eot(){return wo("div",[f1,Ml])}class Mot{constructor(t){var e,i,r;this._handler=new Jm,this._rootElement=Eot(),this._rootElement.addEventListener("wheel",o=>{o.stopPropagation()}),(e=this._rootElement)===null||e===void 0||e.addEventListener("mousedown",o=>{o.stopPropagation(),o.preventDefault()}),(i=this._rootElement)===null||i===void 0||i.addEventListener("click",o=>{if(o.stopPropagation(),o.preventDefault(),this._rootElement.classList.contains(Ml))return;const{col:s,row:a,dropDownIndex:l,menuKey:u,text:h,hasChildren:d}=o.target;if(typeof l!="number"||d)return void o.stopPropagation();const c=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(s,a):t.getHeaderField(s,a),f=t._dropDownMenuIsHighlight(s,a,l);t.fireListeners(ut.DROPDOWN_MENU_CLICK,{col:s,row:a,field:c,menuKey:u,text:h,highlight:f,cellLocation:t.getCellLocation(s,a),event:o}),t.fireListeners(ut.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ut.HIDE_MENU,null),o.stopPropagation()}),(r=this._rootElement)===null||r===void 0||r.addEventListener("mousemove",o=>{this._rootElement.classList.contains(Ml)||o.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();const t=this._rootElement;t!=null&&t.parentElement&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){const o=this._rootElement;if(this._menuInstanceInfo=r,o==null||o.classList.remove(Gb),o==null||o.classList.add(Ml),this._canBindToCell(t,e,i)){if(o.innerHTML="",o.appendChild(r.content),this._bindCell(t,e,i,r.position,r.referencePosition))return o==null||o.classList.add(Gb),o==null||o.classList.remove(Ml),!0}else this.unbindFromCell();return!1}unbindFromCell(){const t=this._rootElement;this._menuInstanceInfo=void 0,t!=null&&t.parentElement&&(t.classList.remove(Gb),t.classList.add(Ml))}_canBindToCell(t,e,i){var r;const o=t.getCellRangeRelativeRect({col:e,row:i}),s=(r=t.internalProps.menu.parentElement)!==null&&r!==void 0?r:t.getElement(),{top:a,bottom:l,left:u,right:h}=o;if(t.isFrozenCell(e,i))return!0;if(l<t.getFrozenRowsHeight()||h<t.getFrozenColsWidth()||u>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||a>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:d,offsetWidth:c}=s;return!(d<a)&&!(c<u)}_bindCell(t,e,i,r,o){var s;const a=this._rootElement,l=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:u,height:h,left:d,top:c}=l.getBoundingClientRect();if(a){a.parentElement!==l&&l.appendChild(a),a.style.left="0px";const f=.8*u;a.style.maxWidth=`${f}px`;const g=a.clientWidth,m=a.clientHeight;let p,v;r&&(p=r.x,v=r.y),o&&(p=o.rect.right-g,v=o.rect.bottom),v+m>h&&(v=h-m,p+=g-2),v<0&&(v/=2);let b=0,C=0;if(t.getElement()!==l){const{left:y,top:w}=t.getElement().getBoundingClientRect();b=w-c,C=y-d}return a.style.top=`${v+b}px`,p<0?p=0:p+g>u&&(p=u-g),a.style.left=`${p+C}px`,!0}return!1}pointInMenuElement(t,e){const i=this._rootElement,{x:r,y:o,width:s,height:a}=i.getBoundingClientRect();return t>r-5&&t<r+s+5&&e>o-5&&e<o+a+5}}class XM extends MF{createMenuElementInternal(){return new nrt(this._table)}}class Bot extends MF{createMenuElementInternal(){return new Mot(this._table)}}const Pot={"dropdown-menu":function(n){return new XM(n)},"context-menu":function(n){return new XM(n)},container:n=>new Bot(n)};function kot(n,t,e,i,r){var o,s;const{lineHeight:a,textBaseline:l,textStick:u}=n._getCellStyle(t,e);let h=n.getCellRangeRelativeRect(n.getCellRange(t,e));u&&(h=n.getVisibleCellRangeRelativeRect({col:t,row:e}));let{left:d,right:c,bottom:f,top:g,width:m,height:p}=h;if(n.isHeader(t,e)&&({left:d,right:c,bottom:f,top:g,width:m,height:p}=n.internalProps.headerHelper.getDropDownIconRect(h,a,l||"middle")),r==null?void 0:r.content)return{type:i,position:r.position,referencePosition:(o=r.referencePosition)!==null&&o!==void 0?o:{rect:{left:d,right:c,top:g,bottom:f,width:m,height:p}},content:r.content};if(i==="dropdown-menu"){let v=n.globalDropDownMenu;const b=n._getHeaderLayoutMap(t,e);v=(s=b.dropDownMenu)!==null&&s!==void 0?s:v;const C=b.pivotInfo;return typeof v=="function"&&(v=v({row:e,col:t,table:n})),{type:i,referencePosition:{rect:{left:d,right:c,top:g,bottom:f,width:m,height:p}},content:v,pivotInfo:C}}return null}class Lot{constructor(t){this._table=t,this._menuInstances={},this._bindTableEvent(t)}release(){const t=this._menuInstances;for(const e in t)t[e].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(t,e,i,r){var o;const s=this._attachInfo,a=this._getMenuInstanceInfo(t,e,i,r);if(!s||a&&s.instance===a.instance||((o=s.instance)===null||o===void 0||o.unbindMenuElement(),this._attachInfo=null),!a)return;const{instance:l,info:u}=a;if(l&&l.bindMenuElement(t,e,u)){const h=this._table.getCellRange(t,e);this._attachInfo={range:h,instance:l}}}_unbindFromCell(){const t=this._attachInfo;if(!t)return;const{instance:e}=t;e==null||e.unbindMenuElement(),this._attachInfo=null}_isBindToCell(t,e){const i=this._attachInfo;return!!i&&Ln(i.range,t,e)}pointInMenuElement(t,e){if(!this._attachInfo)return!1;const i=this._attachInfo,{instance:r}=i;return r.pointInMenuElement(t,e)}_bindTableEvent(t){t.on(ut.DROPDOWN_ICON_CLICK,e=>{this._attachInfo&&this._isBindToCell(e.col,e.row)?this._unbindFromCell():this._bindToCell(e.col,e.row,"dropdown-menu")}),t.on(ut.DROPDOWN_MENU_CLEAR,e=>{this._unbindFromCell()}),t.on(ut.CONTEXTMENU_CELL,e=>{var i,r,o,s;if(((i=t.internalProps.menu)===null||i===void 0?void 0:i.renderMode)==="html"){const a=t._getMouseAbstractPoint(e.event);let l=null;a.inTable&&typeof((r=t.internalProps.menu)===null||r===void 0?void 0:r.contextMenuItems)=="function"?l=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):a.inTable&&Array.isArray((o=t.internalProps.menu)===null||o===void 0?void 0:o.contextMenuItems)&&(l=(s=t.internalProps.menu)===null||s===void 0?void 0:s.contextMenuItems),this._bindToCell(e.col,e.row,"context-menu",{content:l,position:{x:a.x,y:a.y}})}})}_getMenuInstanceInfo(t,e,i,r){const o=this._table,s=this._menuInstances,a=kot(o,t,e,i,r);return a?{instance:s&&s[i]||s&&(s[i]=Pot[i](o)),type:i,info:a}:null}containElement(t){var e;for(const i in this._menuInstances)if(!((e=this._menuInstances[i].getRootElement())===null||e===void 0)&&e.contains(t))return!0;return!1}}class Dot{constructor(t,e){this.isReleased=!1,this.table=e,this._titleOption=Ie({orient:"top"},t),t.visible!==!1&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(t){if(this._titleComponent)Ed(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{const e=new ID(t);e.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._titleComponent=e}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var t,e,i,r,o;if(!this._titleComponent)return;const s=me((t=this._titleOption.padding)!==null&&t!==void 0?t:10),a=(e=this._titleOption.width)!==null&&e!==void 0?e:(this.table.widthMode==="adaptive"?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-s[1]-s[3],l=(i=this._titleOption.height)!==null&&i!==void 0?i:(this.table.heightMode==="adaptive"?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-s[0]-s[2];this._titleComponent.setAttributes({x:((r=this._titleOption.x)!==null&&r!==void 0?r:this._titleOption.orient==="right")?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:((o=this._titleOption.y)!==null&&o!==void 0?o:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:this._titleOption.orient==="top"||this._titleOption.orient==="bottom"?a:this._titleOption.width,height:this._titleOption.orient==="left"||this._titleOption.orient==="right"?l:this._titleOption.height,textStyle:Object.assign({width:a},this._titleOption.textStyle),subtextStyle:Object.assign({width:a},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(t){var e,i,r,o;const s=isFinite((e=this._titleComponent)===null||e===void 0?void 0:e.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,a=isFinite((i=this._titleComponent)===null||i===void 0?void 0:i.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;this._titleOption.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s),this.table.tableX+=Math.ceil(s)):this._titleOption.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(a),this.table.tableY+=Math.ceil(a)):this._titleOption.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s):this._titleOption.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(a)),this._cacheAttrs=t,this._titleOption.orient!=="right"&&this._titleOption.orient!=="bottom"||this._titleComponent.setAttributes({x:((r=this._titleOption.x)!==null&&r!==void 0?r:this._titleOption.orient==="right")?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:((o=this._titleOption.y)!==null&&o!==void 0?o:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var t,e,i,r,o,s,a,l,u,h,d;const c=this._titleOption.text||this._titleOption.subtext?10:0,f=me((t=this._titleOption.padding)!==null&&t!==void 0?t:c),g=(e=this._titleOption.width)!==null&&e!==void 0?e:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-f[1]-f[3],m=(i=this._titleOption.height)!==null&&i!==void 0?i:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-f[0]-f[2];return{text:(r=this._titleOption.text)!==null&&r!==void 0?r:"",subtext:(o=this._titleOption.subtext)!==null&&o!==void 0?o:"",x:((s=this._titleOption.x)!==null&&s!==void 0?s:this._titleOption.orient==="right")?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:((a=this._titleOption.y)!==null&&a!==void 0?a:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:this._titleOption.orient==="top"||this._titleOption.orient==="bottom"?g:this._titleOption.width,height:this._titleOption.orient==="left"||this._titleOption.orient==="right"?m:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:(l=this._titleOption.align)!==null&&l!==void 0?l:"left",verticalAlign:(u=this._titleOption.verticalAlign)!==null&&u!==void 0?u:"top",textStyle:Object.assign({width:g},this._titleOption.textStyle),subtextStyle:Object.assign({width:g},this._titleOption.subtextStyle),dx:(h=this._titleOption.dx)!==null&&h!==void 0?h:0,dy:(d=this._titleOption.dy)!==null&&d!==void 0?d:0}}getComponentGraphic(){return this._titleComponent}}class Iot{constructor(t){this._table=t}release(){var t,e;this.unbindTooltipElement(),this._tooltipElement&&((e=(t=this._tooltipElement).release)===null||e===void 0||e.call(t)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(t,e,i,r){return this._getTooltipElement().bindToCell(this._table,t,e,i,r)}moveTooltipElement(t,e,i,r){this._getTooltipElement().move(this._table,t,e,i,r)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(t,e,i,r,o){this._getTooltipElement()._locate(this._table,t,e,i,r,o)}}function Fot(){if(be.mode==="node")return;const n=document.createElement("style");n.id="vtable-tooltip-styleSheet",n.textContent=`
@keyframes vtable__bubble-tooltip-element--shown-animation {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}
.vtable__bubble-tooltip-element {
	position: absolute;
	
	// pointer-events: none;
	//user-select: none;
	max-width: 300px;
	z-index: 99999;

	background: #FFFFFF;
    border: 1px solid #E6E8ED;
    box-sizing: border-box;
    border-radius: 4px;
    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);
    color: #141414;
    font-size: 13px;
}
.vtable__bubble-tooltip-element--hidden {
	opacity: 0;
  pointer-events: none;
	user-select: none;
	/* transform: translate(-50%, -50%); */
	transition: opacity 75ms linear;
}
.vtable__bubble-tooltip-element--shown {
	opacity: 1;
	/* transform: translate(-50%, -50%); */
	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;
}
.vtable__bubble-tooltip-element__content {
	/* font-size: .75rem; */
	padding: 6px 8px;
	min-height: 1em;
	line-height: 1.5;
	width: 100%;
	display: block;
	white-space: pre-wrap;
	margin: 0;
	box-sizing: border-box;
	overflow: auto;
	word-wrap: break-word;
	position: relative;
	background-color: #FFF;
	z-index: 2;
	border-radius: 4px;
}
/*  WebKit Microsoft Edge（新版）： */
.vtable__bubble-tooltip-element__content::-webkit-scrollbar {
  width: 0;
  height: 0;
  background-color: transparent;
}
/*  Opera Firefox  */
.vtable__bubble-tooltip-element__content > scrollbar-track {
  width: 0;
  height: 0;
  background-color: transparent;
}
/* Internet Explorer 11 和 Microsoft Edge（旧版） */
.vtable__bubble-tooltip-element__content > scrollbar {
  width: 0;
  height: 0;
  background-color: transparent;
}
.vtable__bubble-tooltip-element__triangle {
	/* font-size: .75rem; */
	position: absolute;
	width: 10px;
	height: 10px;
	display: block;
	transform: rotate(45deg);
    transform-origin: 50% 50% 0;
	z-index: 1;
	background-color: #FFF;
	border: 1px solid #E6E8ED;
}
`,document.head.appendChild(n)}Fot();const nc="vtable__bubble-tooltip-element",YM=`${nc}__content`,KM=`${nc}__triangle`,Al=`${nc}--hidden`,wh=`${nc}--shown`;class Oot{constructor(){this._handler=new Jm;const t=this._rootElement=wo("div",[nc,Al]),e=wo("div",[YM]),i=wo("span",[KM]);t.appendChild(i),t.appendChild(e),this._messageElement=t.querySelector(`.${YM}`)||void 0,this._triangleElement=t.querySelector(`.${KM}`)||void 0,t.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),t.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),e.addEventListener("wheel",r=>{r.stopPropagation()}),e.addEventListener("copy",r=>{WK(e)&&r.stopPropagation()})}bindToCell(t,e,i,r,o){var s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T;this._disappearDelay=r==null?void 0:r.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);const S=this._rootElement,x=this._messageElement,E=this._triangleElement;if(S==null||S.classList.remove(wh),S==null||S.classList.add(Al),this._canBindToCell(t,e,i)){if(x.setAttribute("style",""),E.setAttribute("style",""),r!=null&&r.className&&S.classList.add(r.className),!((s=r==null?void 0:r.style)===null||s===void 0)&&s.bgColor&&(x.style.backgroundColor=(a=r==null?void 0:r.style)===null||a===void 0?void 0:a.bgColor),!((l=r==null?void 0:r.style)===null||l===void 0)&&l.bgColor&&(E.style.backgroundColor=(u=r==null?void 0:r.style)===null||u===void 0?void 0:u.bgColor),E.style.display=((h=r==null?void 0:r.style)===null||h===void 0?void 0:h.arrowMark)===!0?"block":"none",!((d=r==null?void 0:r.style)===null||d===void 0)&&d.fontSize&&(x.style.fontSize=((f=(c=r==null?void 0:r.style)===null||c===void 0?void 0:c.fontSize)!==null&&f!==void 0?f:12)+"px"),!((g=r==null?void 0:r.style)===null||g===void 0)&&g.fontFamily&&(x.style.fontFamily=(m=r==null?void 0:r.style)===null||m===void 0?void 0:m.fontFamily),!((p=r==null?void 0:r.style)===null||p===void 0)&&p.color&&(x.style.color=(v=r==null?void 0:r.style)===null||v===void 0?void 0:v.color),!((b=r==null?void 0:r.style)===null||b===void 0)&&b.padding&&(x.style.padding=`${(C=r==null?void 0:r.style)===null||C===void 0?void 0:C.padding.join("px ")}px`),!((y=r==null?void 0:r.style)===null||y===void 0)&&y.maxHeight&&(x.style.maxHeight=`${(w=r==null?void 0:r.style)===null||w===void 0?void 0:w.maxHeight}px`),!((_=r==null?void 0:r.style)===null||_===void 0)&&_.maxWidth&&(x.style.maxWidth=`${(A=r==null?void 0:r.style)===null||A===void 0?void 0:A.maxWidth}px`),x&&(x.textContent=r==null?void 0:r.content),this._bindToCell(t,e,i,r==null?void 0:r.position,r==null?void 0:r.referencePosition,o,(T=r==null?void 0:r.style)===null||T===void 0?void 0:T.arrowMark))return S==null||S.classList.add(wh),S==null||S.classList.remove(Al),!0}else this.unbindFromCell();return!1}release(){var t,e;this.unbindFromCell();const i=this._rootElement;i!=null&&i.parentElement&&i.parentElement.removeChild(i),(e=(t=this._handler)===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t),delete this._rootElement,delete this._messageElement}move(t,e,i,r,o){const s=this._rootElement;this._canBindToCell(t,e,i)?(this._bindToCell(t,e,i,r==null?void 0:r.position,r==null?void 0:r.referencePosition,o),s==null||s.classList.add(wh),s==null||s.classList.remove(Al)):this.unbindFromCell()}unbindFromCell(){var t;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{const e=this._rootElement;e!=null&&e.parentElement&&(e.classList.remove(wh),e.classList.add(Al))},(t=this._disappearDelay)!==null&&t!==void 0?t:0);else{const e=this._rootElement;e!=null&&e.parentElement&&(e.classList.remove(wh),e.classList.add(Al))}}_canBindToCell(t,e,i){const r=t.getCellRangeRelativeRect({col:e,row:i}),o=t.getElement(),{bottom:s,left:a,right:l,top:u}=r;if(t.isFrozenCell(e,i))return!0;if(s<t.getFrozenRowsHeight()||l<t.getFrozenColsWidth()||a>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||u>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:h,offsetWidth:d}=o;return!(u>h)&&!(a>d)}_bindToCell(t,e,i,r,o,s,a){const l=this._rootElement,u=t.getCellRangeRelativeRect({col:e,row:i}),h=t.internalProps.tooltip.parentElement,d=t.internalProps.element.offsetWidth,{width:c}=u;if(l){let f,g;l.parentElement!==h&&h.appendChild(l),l.style.left="0px";const m=Math.min(.8*d,4*c);l.style.maxWidth=`${m}px`;const p=l.clientWidth,v=l.clientHeight;if(!r&&!o)return!1;{const x=this.getComputedPosition(t,e,i,r,o,s,a);g=x.x,f=x.y}l.style.left=`${g}px`,l.style.top=`${f}px`,UC()&&(l.style.fontSize="11px");const{x1:b,x2:C,y1:y,y2:w}=t.stateManager.menu.bounds,_=g,A=_+p,T=f,S=_+v;return!(t.stateManager.menu.isShow&&b<A&&C>_&&w>T&&y<S)}return!1}getComputedPosition(t,e,i,r,o,s,a){var l;const u=this._rootElement,h=t.getCellRangeRelativeRect({col:e,row:i}),{x:d,y:c}=t.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:f,height:g,x:m,y:p}=t.internalProps.element.getBoundingClientRect(),{width:v}=h;let b,C;const y=Math.min(.8*f,4*v);u.style.maxWidth=`${y}px`;const w=u.clientWidth,_=u.clientHeight,A=a?6:0;if(r)C=r.x,b=r.y+A,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(o){let T=(l=o.placement)!==null&&l!==void 0?l:en.bottom;const S=o.rect.left+o.rect.width/2,x=o.rect.top+o.rect.height/2,E=o.rect.top,M=o.rect.bottom,L=o.rect.left,I=o.rect.right;let D=0;const H=()=>{D++,D>=4||(this.removeStyleFromTriangle(),T===en.top?(C=S-w/2,b=E-_-A,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",s&&b<0&&(T=en.right,H())):T===en.bottom?(C=S-w/2,b=M+A,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",s&&b+_>g&&(T=en.left,H())):T===en.left?(b=x-_/2,C=L-w-A,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",s&&C<0&&(T=en.top,H())):T===en.right&&(b=x-_/2,C=I+A,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",s&&C+w>f&&(T=en.bottom,H())))};H()}return s&&(C<0?C=0:C+u.offsetWidth>f&&(C=f-u.offsetWidth)),{x:C+m-d,y:b+p-c}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(t,e,i,r,o,s){const a=this.getComputedPosition(t,e,i,r,o,s),l=a.x,u=a.y;this._rootElement.style.left=`${l}px`,this._rootElement.style.top=`${u}px`}}class Hot extends Iot{createTooltipElementInternal(){return new Oot}}const zot={"bubble-tooltip":function(n){return new Hot(n)}};class Not{constructor(t,e){this._table=t,this._tooltipInstances={},this._bindTableEvent(t),this.confine=e}release(){var t,e;const i=this._tooltipInstances;for(const r in i)(e=(t=i[r])===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(t,e,i){var r;const o=this._attachInfo,s=this._getTooltipInstanceInfo(t,e);if(!o||s&&o.instance===s||((r=o.instance)===null||r===void 0||r.unbindTooltipElement(),this._attachInfo=null),!!s&&s&&s.bindTooltipElement(t,e,i,this.confine)){const a=this._table.getCellRange(t,e);this._attachInfo={range:a,instance:s,tooltipOptions:i}}}_move(t,e,i){const r=this._attachInfo;if(!r||!Ln(r.range,t,e))return;const{instance:o}=r;o==null||o.moveTooltipElement(t,e,i,this.confine)}moveToPosition(t,e,i,r){const o=this._attachInfo;if(!o||!Ln(o.range,t,e))return;const{instance:s}=o;this._attachInfo.tooltipOptions.position=i,this._attachInfo.tooltipOptions.referencePosition=r,s==null||s.locateTooltipElement(t,e,i,r,this.confine)}_unbindFromCell(){const t=this._attachInfo;if(!t)return;const{instance:e}=t;e==null||e.unbindTooltipElement(),this._attachInfo=null}_isBindCell(t,e){const i=this._attachInfo;return!!i&&Ln(i.range,t,e)}_bindTableEvent(t){t.on(ut.MOUSEENTER_CELL,e=>{if(UC())return;const{x1:i,x2:r,y1:o,y2:s}=t.stateManager.menu.bounds;if(t.stateManager.menu.isShow&&typeof e.x=="number"&&typeof e.y=="number"&&e.x>i&&e.x<r&&e.y>o&&e.y<s)return;const{col:a,row:l}=e;this.showTooltip(a,l)}),t.on(ut.MOUSEMOVE_CELL,e=>{var i,r;if(!UC()){if(!((r=(i=this._attachInfo)===null||i===void 0?void 0:i.tooltipOptions)===null||r===void 0)&&r.referencePosition){const o=this._attachInfo.tooltipOptions.referencePosition,{event:s}=e,{left:a,right:l,top:u,bottom:h}=o.rect,d=t._getMouseAbstractPoint(s);d.inTable&&d.x>=a-5&&d.x<=l+5&&d.y>=u-5&&d.y<=h+5||this._unbindFromCell()}this._attachInfo&&t.stateManager.menu.isShow&&this._bindToCell(e.col,e.row)}}),t.on(ut.MOUSELEAVE_CELL,e=>{this._unbindFromCell()}),t.on(ut.SELECTED_CELL,e=>{this._isBindCell(e.col,e.row)&&this._unbindFromCell()}),t.on(ut.MOUSELEAVE_TABLE,e=>{this._unbindFromCell()}),t.on(ut.SCROLL,e=>{this._unbindFromCell()})}showTooltip(t,e){var i,r,o;let s;const a=this._table,l=a.getHeaderDescription(t,e);if(l){const u=a.getCellRangeRelativeRect({col:t,row:e});s={content:l,referencePosition:{placement:a.internalProps.tooltip.position,rect:u},disappearDelay:(i=a.internalProps.tooltip.overflowTextTooltipDisappearDelay)!==null&&i!==void 0?i:0,style:a.theme.tooltipStyle}}else if(pn((r=a.internalProps.tooltip)===null||r===void 0?void 0:r.isShowOverflowTextTooltip)?a.internalProps.tooltip.isShowOverflowTextTooltip(t,e,a):a.internalProps.tooltip.isShowOverflowTextTooltip){const u=a.getCellOverflowText(t,e),h=a.getCellRangeRelativeRect({col:t,row:e});u&&(s={content:l?`${l}
  ${u}`:u,referencePosition:{placement:a.internalProps.tooltip.position,rect:h},disappearDelay:(o=a.internalProps.tooltip.overflowTextTooltipDisappearDelay)!==null&&o!==void 0?o:0,style:a.theme.tooltipStyle})}s?this._bindToCell(t,e,s):this._unbindFromCell()}_getTooltipInstanceInfo(t,e){const i=this._table,r=this._tooltipInstances;return r&&r["bubble-tooltip"]||r&&(r["bubble-tooltip"]=zot["bubble-tooltip"](i))}isBinded(t){var e;return JSON.stringify(t)===JSON.stringify((e=this._attachInfo)===null||e===void 0?void 0:e.tooltipOptions)}}const Wot=()=>{Gt.registerComponent("axis",dot),Gt.registerFunction("computeAxisComponentWidth",got),Gt.registerFunction("computeAxisComponentHeight",pot),Gt.registerFunction("getAxisConfigInPivotChart",Crt)},Uot=()=>{Gt.registerComponent("emptyTip",vot)},Vot=()=>{Gt.registerFunction("createLegend",Rot)},jot=()=>{Gt.registerComponent("menuHandler",Lot)},Got=()=>{Gt.registerComponent("title",Dot)},$ot=()=>{Gt.registerComponent("tooltipHandler",Not)},qot=()=>{lY(),Hq()};class Xot{constructor(t){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=t,this.table.on("scroll",e=>{e.scrollDirection==="vertical"&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",e=>{this.updateGroupTitle()}),this.table.on("resize_column",e=>{this.updateGroupTitle()})}updateGroupTitle(){this.table.scrollTop===0?(this.titleRows=[],this.showedTitleRows=[]):this.skipStartRow!==-1&&this.skipEndRow!==-1&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;const t=this.table.getRecordIndexByCell(0,this.rowNow),e=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(t,e)}getTitleRowsByRecordIndex(t,e){Wt(t)||(t=[t]),Wt(e)||(e=[e]);for(let a=0;a<t.length;a++){const l=t.slice(0,a+1);this.table.dataSource.getRaw(l)}const i=[],r=e.length===t.length+1;let o=t.slice(0,r?t.length:t.length-1);const s=this.table.dataSource.currentIndexedData;for(let a=this.rowNow-this.table.columnHeaderLevelCount;a>=0;a--){const l=s[a];if(Wt(l)&&o.length===l.length){let u=!0;for(let h=0;h<l.length;h++)if(l[h]!==o[h]){u=!1;break}u&&(i.push(a+this.table.columnHeaderLevelCount),o=o.slice(0,o.length-1))}else if(l===t[0]){i.push(a+this.table.columnHeaderLevelCount);break}}this.titleRows=i.reverse()}updateScenegraph(){const{table:t}=this,{shadowGroup:e,shadowGroupFrozen:i}=Kot(t);this.showedTitleRows.length=0;let r=0;for(let o=0;o<t.colCount;o++){let s;o<t.frozenColCount?(s=new de({x:t.getColsWidth(0,o-1),y:t.getFrozenRowsHeight()}),i.add(s)):(s=new de({x:t.getColsWidth(t.frozenColCount,o-1),y:t.getFrozenRowsHeight()}),e.add(s)),s.col=o;for(let a=0;a<this.titleRows.length;a++){const l=this.titleRows[a];if(Yot(l,this.rowNow,t.scenegraph.proxy.screenTopRow,this.titleRows)){o===0&&r++;continue}o===0&&this.showedTitleRows.push(l);const u=t.scenegraph.getCell(o,l);if(u.role==="cell"){const h=BF(u);h.setAttributes({y:40*a}),s.add(h)}else{const h=Mn(o,l,t,!0,!0);h.setAttributes({y:40*a}),s.add(h)}}}r>0&&this.skipStartRow===-1&&this.skipEndRow===-1&&(this.skipStartRow=t.scenegraph.proxy.screenTopRow-1,this.skipEndRow=t.scenegraph.proxy.screenTopRow+1)}}function Yot(n,t,e,i){return n===t&&n!==e+i.length-1?!0:n===e+i.indexOf(n)+1&&n<t}function BF(n){const t=n.clone();if(t.role=n.role,t.col=n.col,t.row=n.row,t.mergeStartCol=n.mergeStartCol,t.mergeStartRow=n.mergeStartRow,t.mergeEndCol=n.mergeEndCol,t.mergeEndRow=n.mergeEndRow,t.contentWidth=n.contentWidth,t.contentHeight=n.contentHeight,t.role==="cell"){const e=Ge({x:0,y:0,width:t.attribute.width,height:t.attribute.height});t.add(e)}if(n.type==="group"){const e=t;n.forEachChildren(i=>{const r=BF(i);e.add(r)})}return t}function Kot(n){const t=n.scenegraph.colHeaderGroup,e=n.scenegraph.cornerHeaderGroup;if(!t.border){const o=Ge({x:0,y:0,width:0,height:0,cursor:"pointer"});t.add(o),t.border=o,o.attachShadow(o.shadowRoot),o.name="border-rect",o.addEventListener("click",s=>{const a=n.listTreeStickCellPlugin.titleRows,{shadowTarget:l}=s.pickParams,u=el(l),{col:h,row:d}=u;ZM(d-a.indexOf(d),n)})}if(!e.border){const o=Ge({x:0,y:0,width:0,height:0,cursor:"pointer"});e.add(o),e.border=o,o.attachShadow(o.shadowRoot),o.name="border-rect",o.addEventListener("click",s=>{const a=n.listTreeStickCellPlugin.titleRows,{shadowTarget:l}=s.pickParams,u=el(l),{col:h,row:d}=u;ZM(d-a.indexOf(d),n)})}const i=t.border.shadowRoot,r=e.border.shadowRoot;return i.removeAllChild(),r.removeAllChild(),{shadowGroup:i,shadowGroupFrozen:r}}function ZM(n,t){const e=t.getDrawRange();if(et(n)&&n>=t.frozenRowCount){const i=t.getFrozenRowsHeight(),r=t.getRowsHeight(0,n-1);t.scrollTop=Math.min(r-i,t.getAllRowsHeight()-e.height)-1}t.scenegraph.updateNextFrame()}const Zot=()=>{Gt.registerComponent("listTreeStickCellPlugin",Xot)};function Qot(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b){var C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J,st,ht;const at=Hrt()[h],lt=g._getCellStyle(r,o),_t=a0("padding",lt,r,o,g);if(et(_t)&&(l=_t),!n){const vt=Oo(r,o,m,g);v&&(n=g.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:s,height:a,lineWidth:(y=(C=m==null?void 0:m.group)===null||C===void 0?void 0:C.lineWidth)!==null&&y!==void 0?y:void 0,fill:(_=(w=m==null?void 0:m.group)===null||w===void 0?void 0:w.fill)!==null&&_!==void 0?_:void 0,stroke:(T=(A=m==null?void 0:m.group)===null||A===void 0?void 0:A.stroke)!==null&&T!==void 0?T:void 0,strokeArrayWidth:vt,strokeArrayColor:(x=(S=m==null?void 0:m.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&x!==void 0?x:void 0,cursor:(M=(E=m==null?void 0:m.group)===null||E===void 0?void 0:E.cursor)!==null&&M!==void 0?M:void 0,lineDash:(I=(L=m==null?void 0:m.group)===null||L===void 0?void 0:L.lineDash)!==null&&I!==void 0?I:void 0,lineCap:"butt",clip:!0,cornerRadius:m.group.cornerRadius}),n&&n.role==="cell"||((n=new de({x:e,y:i,width:s,height:a,lineWidth:(H=(D=m==null?void 0:m.group)===null||D===void 0?void 0:D.lineWidth)!==null&&H!==void 0?H:void 0,fill:(N=(O=m==null?void 0:m.group)===null||O===void 0?void 0:O.fill)!==null&&N!==void 0?N:void 0,stroke:(W=(U=m==null?void 0:m.group)===null||U===void 0?void 0:U.stroke)!==null&&W!==void 0?W:void 0,strokeArrayWidth:vt,strokeArrayColor:(Y=(j=m==null?void 0:m.group)===null||j===void 0?void 0:j.strokeArrayColor)!==null&&Y!==void 0?Y:void 0,cursor:(rt=(Z=m==null?void 0:m.group)===null||Z===void 0?void 0:Z.cursor)!==null&&rt!==void 0?rt:void 0,lineDash:(st=(J=m==null?void 0:m.group)===null||J===void 0?void 0:J.lineDash)!==null&&st!==void 0?st:void 0,lineCap:"butt",clip:!0,cornerRadius:m.group.cornerRadius})).role="cell",n.col=r,n.row=o,t==null||t.addCellGroup(n))}if(n.AABBBounds.width(),b&&Array.isArray(g.getCellValue(r,o))||!b){const vt=new tu(p,{stroke:!1,x:l[3],y:l[0],canvas:(ht=g.canvas)!==null&&ht!==void 0?ht:g.scenegraph.stage.window.getContext().canvas,mode:g.options.mode,modeParams:g.options.modeParams,spec:g.options.specTransformInCell?g.options.specTransformInCell(d,r,o):d,ClassType:at,width:s-l[3]-l[1],height:a-l[2]-l[0],chartInstance:c,dataId:f,data:g.getCellValue(r,o)||[],cellPadding:l,dpr:g.internalProps.pixelRatio,axes:g.isPivotChart()?g.internalProps.layoutMap.getChartAxes(r,o):[],tableChartOption:g.options.chartOption,col:r,row:o});n.appendChild(vt),g.internalProps.layoutMap.setChartInstance(r,o,vt.chartInstance)}return n}class Jot extends de{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new de({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new de({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._checkboxGroup=new de({pickable:!1,fill:!1,stroke:!1}),this._checkboxGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._checkboxGroup)}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addCheckbox(t){this._checkboxGroup.appendChild(t)}setCheckboxContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){const s=this._checkboxGroup.width;this._cellWidth=t+e+s,this.setAttribute("width",this._cellWidth)}else{const s=this._cellWidth-t-e;this.updateCenterLayout(s);const a=this._checkboxGroup.width;this._cellWidth=t+e+a,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();const i=this._leftGroup.height,r=this._rightGroup.height,o=this._checkboxGroup.height;this._cellHeight=Math.max(i,r,o),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._checkboxGroup.forEachChildren(o=>{o instanceof $s&&(e-=o.AABBBounds.width())});const i=this._checkboxGroup.getChildByName("checkbox-content");i instanceof $s&&i.setAttribute("width",e);let r=0;this._checkboxGroup.forEachChildren(o=>{o.setAttribute("x",r),r+=o.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._checkboxGroup.setAttribute("x",4),this._align==="left"||this._align==="start"?this.setAttribute("dx",0):this._align==="center"?this.setAttribute("dx",-this.attribute.width/2):this._align!=="right"&&this._align!=="end"||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){this._baseline==="top"?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._checkboxGroup.setAttribute("y",0)):this._baseline==="middle"?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._checkboxGroup.setAttribute("y",this._cellHeight/2-this._checkboxGroup.height/2)):this._baseline==="bottom"&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._checkboxGroup.setAttribute("y",this._cellHeight-this._checkboxGroup.height))}}function tst(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b){var C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J,st;if(!n){const ft=Oo(r,o,g,f);v&&(n=f.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:a,height:l,lineWidth:(y=(C=g==null?void 0:g.group)===null||C===void 0?void 0:C.lineWidth)!==null&&y!==void 0?y:void 0,fill:(_=(w=g==null?void 0:g.group)===null||w===void 0?void 0:w.fill)!==null&&_!==void 0?_:void 0,stroke:(T=(A=g==null?void 0:g.group)===null||A===void 0?void 0:A.stroke)!==null&&T!==void 0?T:void 0,strokeArrayWidth:ft,strokeArrayColor:(x=(S=g==null?void 0:g.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&x!==void 0?x:void 0,cursor:(M=(E=g==null?void 0:g.group)===null||E===void 0?void 0:E.cursor)!==null&&M!==void 0?M:void 0,lineDash:(I=(L=g==null?void 0:g.group)===null||L===void 0?void 0:L.lineDash)!==null&&I!==void 0?I:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),n&&n.role==="cell"||((n=new de({x:e,y:i,width:a,height:l,lineWidth:(H=(D=g==null?void 0:g.group)===null||D===void 0?void 0:D.lineWidth)!==null&&H!==void 0?H:void 0,fill:(N=(O=g==null?void 0:g.group)===null||O===void 0?void 0:O.fill)!==null&&N!==void 0?N:void 0,stroke:(W=(U=g==null?void 0:g.group)===null||U===void 0?void 0:U.stroke)!==null&&W!==void 0?W:void 0,strokeArrayWidth:ft,strokeArrayColor:(Y=(j=g==null?void 0:g.group)===null||j===void 0?void 0:j.strokeArrayColor)!==null&&Y!==void 0?Y:void 0,cursor:(rt=(Z=g==null?void 0:g.group)===null||Z===void 0?void 0:Z.cursor)!==null&&rt!==void 0?rt:void 0,lineDash:(st=(J=g==null?void 0:g.group)===null||J===void 0?void 0:J.lineDash)!==null&&st!==void 0?st:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",n.col=r,n.row=o,t==null||t.addCellGroup(n))}let ht;if(c){let ft=r,Ft=o;p&&(ft=p.start.col,Ft=p.start.row),ht=f.getCellIcons(ft,Ft)}let at=0,lt=0,_t=0,vt=0,yt=[];if(Array.isArray(ht)&&ht.length!==0){const{leftIconWidth:ft,rightIconWidth:Ft,contentLeftIcons:St,absoluteRightIconWidth:Kt}=ju(ht,n,p,f);at=ft+Ft,lt=ft,_t=Ft,yt=St,vt=Kt,n.forEachChildren(At=>{At.role==="icon-left"?At.setAttribute("x",At.attribute.x+u[3]):At.role==="icon-right"?At.setAttribute("x",At.attribute.x+a-Ft-u[1]):At.role==="icon-absolute-right"&&At.setAttribute("x",At.attribute.x+a-Kt-u[1])}),n.forEachChildren(At=>{d==="middle"?At.setAttribute("y",(l-At.AABBBounds.height())/2):d==="bottom"?At.setAttribute("y",l-At.AABBBounds.height()-u[2]):At.setAttribute("y",u[0])})}const mt=est(r,o,s-at,a,l,u,g,m,f,b);if(yt.length!==1||yt[0].name!==ir.expandIconName&&yt[0].name!==ir.collapseIconName)mt&&n.appendChild(mt),mt.render();else{const ft=new Jot({x:0,y:0,fill:!1,stroke:!1,pickable:!1});ft.name="checkbox-content",ft.setCheckboxContentOption({autoWidth:!1,autoHeight:!1,cellWidth:a-(u[1]+u[3]),cellHeight:l-u[0]-u[2],align:h,baseline:d});const Ft={addedHierarchyOffset:0};yt.forEach(At=>{const Pt=cn(At,void 0,n.col,n.row,p,f,Ft);Pt.role="icon-content-left",Pt.name=At.name,ft.addLeftOccupyingIcon(Pt)}),mt&&ft.addCheckbox(mt),n.appendChild(ft),ft.layout(),ft.AABBBounds.width(),ft.AABBBounds.height();const St=a-(u[1]+u[3]),Kt=l-(u[0]+u[2]);n.forEachChildren(At=>{At.role==="icon-left"?At.setAttribute("x",At.attribute.x+u[3]):At.role==="icon-right"?At.setAttribute("x",At.attribute.x+St-_t+u[3]):At.role==="icon-absolute-right"?At.setAttribute("x",At.attribute.x+St-vt+u[3]+u[1]):At.name!=="content"&&At.name!=="checkbox-content"||(h==="center"&&At.type!=="richtext"?At.setAttribute("x",u[3]+lt+(St-lt-_t)/2):h==="right"&&At.type!=="richtext"?At.setAttribute("x",u[3]+St-_t):At.setAttribute("x",u[3]+lt))}),n.forEachChildren(At=>{At.name!==ro&&(d==="middle"?At!=null&&At._checkboxGroup&&At._leftGroup.setAttribute("y",u[0]+(Kt-At._checkboxGroup.AABBBounds.height())/2):d==="bottom"?At.setAttribute("y",u[0]+Kt-At.AABBBounds.height()):At.setAttribute("y",u[0]))})}return a-=u[1]+u[3]+at,l-=u[0]+u[2],h==="center"?mt.setAttribute("x",u[3]+lt+(a-mt.AABBBounds.width())/2):h==="right"?mt.setAttribute("x",u[3]+lt+a-mt.AABBBounds.width()):mt.setAttribute("x",u[3]+lt),d==="middle"?mt.setAttribute("y",u[0]+(l-mt.AABBBounds.height())/2):d==="bottom"?mt.setAttribute("y",u[0]+l-mt.AABBBounds.height()):mt.setAttribute("y",u[0]),n}function est(n,t,e,i,r,o,s,a,l,u){var h,d,c,f,g;const m=l._getCellStyle(n,t),p=pt("size",m,n,t,l),v=pt("spaceBetweenTextAndIcon",m,n,t,l),b=pt("defaultFill",m,n,t,l),C=pt("defaultStroke",m,n,t,l),y=pt("disableFill",m,n,t,l),w=pt("checkedFill",m,n,t,l),_=pt("checkedStroke",m,n,t,l),A=pt("disableCheckedFill",m,n,t,l),T=pt("disableCheckedStroke",m,n,t,l),S=pt("checkIconImage",m,n,t,l),x=pt("indeterminateIconImage",m,n,t,l),E=l.getCellValue(n,t),M=l.getCellOriginValue(n,t);let L,I,D=(h=E)!==null&&h!==void 0?h:"";if(Li(E)?(L=E.checked,I=E.disable,D=(d=E.text)!==null&&d!==void 0?d:""):typeof E=="boolean"&&(L=E,D=""),l.internalProps.layoutMap.isSeriesNumber(n,t)){const at=l.getFieldData(a.field,n,t);at&&(L=at.checked,I=at.disable,D=(c=at.text)!==null&&c!==void 0?c:"")}L=l.stateManager.syncCheckedState(n,t,a.field,L);const H=dn(n,t,l),O=l._getCellStyle(n,t),N=(f=O.autoWrapText)!==null&&f!==void 0?f:l.internalProps.autoWrapText,{lineClamp:U}=O,{checked:W,disable:j}=a;if(L==null||typeof L=="function"){const at=Me(W,{col:n,row:t,table:l,context:null,value:E,dataValue:M});L=l.stateManager.syncCheckedState(n,t,a.field,at)}const Y=Me(j,{col:n,row:t,table:l,context:null,value:E,dataValue:M}),Z=e==="auto",rt=l.isAutoRowHeight(t),J={text:D.length===1?D[0]:D,maxLineWidth:Z?1/0:i-(o[1]+o[3]+H)-p-v,textAlign:"left",textBaseline:"top",autoWrapText:N,lineClamp:U,wordBreak:"break-word",heightLimit:rt?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:u?0:H,whiteSpace:D.length!==1||N?"normal":"no-wrap"},st={x:0,y:0,text:s.text?Object.assign({},s.text,J):J,icon:{width:Math.floor(p/1.4),height:Math.floor(p/1.4)},box:{width:p,height:p},dx:u?H:0,spaceBetweenTextAndIcon:v,disabled:(g=I??Y)!==null&&g!==void 0&&g};L==="indeterminate"?(st.checked=void 0,st.indeterminate=!0):(st.checked=L,st.indeterminate=void 0),b&&(st.box.fill=b),C&&(st.box.stroke=C),y&&(st.box.disableFill=y),w&&(st.box.checkedFill=w),_&&(st.box.checkedStroke=_),A&&(st.box.disableCheckedFill=A),T&&(st.box.disableCheckedStroke=T),S&&(st.icon.checkIconImage=S),x&&(st.icon.indeterminateIconImage=x);const ht=new $s(st);return ht.name="checkbox",ht}function ist(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m){var p,v,b,C,y,w,_,A,T,S,x,E;if(!n){const I=Oo(r,o,f,c);(n=new de({x:e,y:i,width:a,height:l,lineWidth:(v=(p=f==null?void 0:f.group)===null||p===void 0?void 0:p.lineWidth)!==null&&v!==void 0?v:void 0,fill:(C=(b=f==null?void 0:f.group)===null||b===void 0?void 0:b.fill)!==null&&C!==void 0?C:void 0,stroke:(w=(y=f==null?void 0:f.group)===null||y===void 0?void 0:y.stroke)!==null&&w!==void 0?w:void 0,strokeArrayWidth:I,strokeArrayColor:(A=(_=f==null?void 0:f.group)===null||_===void 0?void 0:_.strokeArrayColor)!==null&&A!==void 0?A:void 0,cursor:(S=(T=f==null?void 0:f.group)===null||T===void 0?void 0:T.cursor)!==null&&S!==void 0?S:void 0,lineDash:(E=(x=f==null?void 0:f.group)===null||x===void 0?void 0:x.lineDash)!==null&&E!==void 0?E:void 0,lineCap:"butt",clip:!0,cornerRadius:f.group.cornerRadius})).role="cell",n.col=r,n.row=o,t==null||t.addCellGroup(n)}const{width:M,height:L}=rst(r,o,s,a,l,u,f,g,n,m,c);return a-=u[1]+u[3],l-=u[0]+u[2],n.forEachChildren(I=>{h==="center"?I.setAttribute("x",u[3]+I.attribute.x+(a-M)/2):h==="right"?I.setAttribute("x",u[3]+I.attribute.x+a-M):I.setAttribute("x",u[3]+I.attribute.x),d==="middle"?I.setAttribute("y",u[0]+I.attribute.y+(l-L)/2):d==="bottom"?I.setAttribute("y",u[0]+I.attribute.y+l-L):I.setAttribute("y",u[0]+I.attribute.y)}),n}function rst(n,t,e,i,r,o,s,a,l,u,h){var d,c,f,g;const m=h._getCellStyle(n,t);let p=pt("size",m,n,t,h),v=pt("innerRadius",m,n,t,h),b=pt("outerRadius",m,n,t,h);const C=pt("spaceBetweenTextAndIcon",m,n,t,h),y=pt("spaceBetweenRadio",m,n,t,h),w=pt("defaultFill",m,n,t,h),_=pt("defaultStroke",m,n,t,h),A=pt("disableFill",m,n,t,h),T=pt("checkedFill",m,n,t,h),S=pt("checkedStroke",m,n,t,h),x=pt("disableCheckedFill",m,n,t,h),E=pt("disableCheckedStroke",m,n,t,h);wt(b)?p=2*b:b=Math.round(p/2),(!wt(v)||v<0)&&(v=Math.round(b/7*3));const M=h.getCellValue(n,t),L=h.getCellOriginValue(n,t),I=dn(n,t,h),D=h._getCellStyle(n,t),H=(d=D.autoWrapText)!==null&&d!==void 0?d:h.internalProps.autoWrapText,{lineClamp:O}=D,N=e==="auto",U=h.isAutoRowHeight(t),W={maxLineWidth:N?1/0:i-(o[1]+o[3]+I)-p-C,textAlign:"left",textBaseline:"top",autoWrapText:H,lineClamp:O,wordBreak:"break-word",heightLimit:U?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:I},j={x:0,y:0,text:s.text?Object.assign({},s.text,W):W,circle:{innerRadius:v,outerRadius:b},spaceBetweenTextAndIcon:C};w&&(j.circle.fill=w),_&&(j.circle.stroke=_),A&&(j.circle.disableFill=A),T&&(j.circle.checkedFill=T),S&&(j.circle.checkedStroke=S),x&&(j.circle.disableCheckedFill=x),E&&(j.circle.disableCheckedStroke=E);let Y=0,Z=0;const rt=(c=a.radioDirectionInCell)!==null&&c!==void 0?c:"vertical";if(Wt(M))M.forEach((J,st)=>{var ht,at;const lt=QM(J,L,st,n,t,a,H,j,h);lt&&l.appendChild(lt),lt.id=`radio-${(ht=u==null?void 0:u.start.col)!==null&&ht!==void 0?ht:n}-${(at=u==null?void 0:u.start.row)!==null&&at!==void 0?at:t}-${st}`,lt.render();const _t=lt.AABBBounds;rt==="vertical"?(lt.setAttribute("y",Z),Z+=_t.height()+(st!==M.length-1?y:0),Y=Math.max(Y,_t.width())):rt==="horizontal"&&(lt.setAttribute("x",Y),Y+=_t.width()+(st!==M.length-1?y:0),Z=Math.max(Z,_t.height()))});else{const J=QM(M,L,void 0,n,t,a,H,j,h);J&&l.appendChild(J),J.id=`radio-${(f=u==null?void 0:u.start.col)!==null&&f!==void 0?f:n}-${(g=u==null?void 0:u.start.row)!==null&&g!==void 0?g:t}`,J.render();const st=J.AABBBounds;Y=st.width(),Z=st.height()}return{width:Y,height:Z}}function QM(n,t,e,i,r,o,s,a,l){const u=nst(n,t,e,i,r,o,l),h=ost(n,t,i,r,o,l),d=Li(n)?n.text:Eo(n)?"":n??"",c=Ie({},a,{checked:u,disabled:h,text:{text:d.length===1?d[0]:d,whiteSpace:d.length!==1||s?"normal":"no-wrap"},boundsPadding:0}),f=new Au(c);return f.name="radio",f}function nst(n,t,e,i,r,o,s){var a,l;const u=(a=o.radioCheckType)!==null&&a!==void 0?a:"column";let h,d;return Li(n)?h=n.checked:typeof n=="boolean"&&(h=n),h=s.stateManager.syncRadioState(i,r,o.field,u,e,h),h!=null&&typeof h!="function"||(d=Me(o.checked,{col:i,row:r,table:s,context:null,value:n,dataValue:t}),h=s.stateManager.syncRadioState(i,r,o.field,u,e,d)),(l=h??d)!==null&&l!==void 0&&l}function ost(n,t,e,i,r,o){var s;let a;Li(n)&&(a=n.disable);const l=Me(r.disable,{col:e,row:i,table:o,context:null,value:n,dataValue:t});return(s=a??l)!==null&&s!==void 0&&s}function sst(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v){var b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J;if(!n){const _t=Oo(r,o,g,f);v&&(n=f.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:a,height:l,lineWidth:(C=(b=g==null?void 0:g.group)===null||b===void 0?void 0:b.lineWidth)!==null&&C!==void 0?C:void 0,fill:(w=(y=g==null?void 0:g.group)===null||y===void 0?void 0:y.fill)!==null&&w!==void 0?w:void 0,stroke:(A=(_=g==null?void 0:g.group)===null||_===void 0?void 0:_.stroke)!==null&&A!==void 0?A:void 0,strokeArrayWidth:_t,strokeArrayColor:(S=(T=g==null?void 0:g.group)===null||T===void 0?void 0:T.strokeArrayColor)!==null&&S!==void 0?S:void 0,cursor:(E=(x=g==null?void 0:g.group)===null||x===void 0?void 0:x.cursor)!==null&&E!==void 0?E:void 0,lineDash:(L=(M=g==null?void 0:g.group)===null||M===void 0?void 0:M.lineDash)!==null&&L!==void 0?L:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),n&&n.role==="cell"||((n=new de({x:e,y:i,width:a,height:l,lineWidth:(D=(I=g==null?void 0:g.group)===null||I===void 0?void 0:I.lineWidth)!==null&&D!==void 0?D:void 0,fill:(O=(H=g==null?void 0:g.group)===null||H===void 0?void 0:H.fill)!==null&&O!==void 0?O:void 0,stroke:(U=(N=g==null?void 0:g.group)===null||N===void 0?void 0:N.stroke)!==null&&U!==void 0?U:void 0,strokeArrayWidth:_t,strokeArrayColor:(j=(W=g==null?void 0:g.group)===null||W===void 0?void 0:W.strokeArrayColor)!==null&&j!==void 0?j:void 0,cursor:(Z=(Y=g==null?void 0:g.group)===null||Y===void 0?void 0:Y.cursor)!==null&&Z!==void 0?Z:void 0,lineDash:(J=(rt=g==null?void 0:g.group)===null||rt===void 0?void 0:rt.lineDash)!==null&&J!==void 0?J:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",n.col=r,n.row=o,t==null||t.addCellGroup(n))}let st;if(c){let _t=r,vt=o;p&&(_t=p.start.col,vt=p.start.row),st=f.getCellIcons(_t,vt)}let ht=0,at=0;if(Array.isArray(st)&&st.length!==0){const{leftIconWidth:_t,rightIconWidth:vt,absoluteRightIconWidth:yt}=ju(st,n,p,f);ht=_t+vt,at=_t,n.forEachChildren(mt=>{mt.role==="icon-left"?mt.setAttribute("x",mt.attribute.x+u[3]):mt.role==="icon-right"?mt.setAttribute("x",mt.attribute.x+a-vt-u[1]):mt.role==="icon-absolute-right"&&mt.setAttribute("x",mt.attribute.x+a-yt-u[1])}),n.forEachChildren(mt=>{d==="middle"?mt.setAttribute("y",(l-mt.AABBBounds.height())/2):d==="bottom"?mt.setAttribute("y",l-mt.AABBBounds.height()-u[2]):mt.setAttribute("y",u[0])})}const lt=ast(r,o,s-ht,a,l,u,g,m,f);return lt&&n.appendChild(lt),lt.render(),a-=u[1]+u[3]+ht,l-=u[0]+u[2],h==="center"?lt.setAttribute("x",u[3]+at+(a-lt.AABBBounds.width())/2):h==="right"?lt.setAttribute("x",u[3]+at+a-lt.AABBBounds.width()):lt.setAttribute("x",u[3]+at),d==="middle"?lt.setAttribute("y",u[0]+(l-lt.AABBBounds.height())/2):d==="bottom"?lt.setAttribute("y",u[0]+l-lt.AABBBounds.height()):lt.setAttribute("y",u[0]),n}function ast(n,t,e,i,r,o,s,a,l){var u,h,d,c;const f=l._getCellStyle(n,t),g=pt("spaceBetweenTextAndCircle",f,n,t,l),m=pt("circleRadius",f,n,t,l),p=pt("boxWidth",f,n,t,l),v=pt("boxHeight",f,n,t,l),b=pt("checkedFill",f,n,t,l),C=pt("uncheckedFill",f,n,t,l),y=pt("disableCheckedFill",f,n,t,l),w=pt("disableUncheckedFill",f,n,t,l),_=pt("circleFill",f,n,t,l),A=l.getCellValue(n,t),T=l.getCellOriginValue(n,t);let S,x,E=(u=A)!==null&&u!==void 0?u:"";Li(A)?(S=A.checked,x=A.disable,E=(h=A.text)!==null&&h!==void 0?h:""):typeof A=="boolean"&&(S=A,E=""),S=l.stateManager.syncCheckedState(n,t,a.field,S);const M=dn(n,t,l),L=l._getCellStyle(n,t),I=(d=L.autoWrapText)!==null&&d!==void 0?d:l.internalProps.autoWrapText,{lineClamp:D}=L,{checked:H,disable:O,uncheckedText:N,checkedText:U}=a;if(S==null||typeof S=="function"){const at=Me(H,{col:n,row:t,table:l,context:null,value:A,dataValue:T});S=l.stateManager.syncCheckedState(n,t,a.field,at)}const W=Me(O,{col:n,row:t,table:l,context:null,value:A,dataValue:T}),j=Me(U,{col:n,row:t,table:l,context:null,value:A,dataValue:T}),Y=Me(N,{col:n,row:t,table:l,context:null,value:A,dataValue:T}),Z=e==="auto",rt=l.isAutoRowHeight(t),J={text:E.length===1?E[0]:E,maxLineWidth:Z?1/0:i-(o[1]+o[3]+M)-2*m-g,textAlign:"left",textBaseline:"top",autoWrapText:I,lineClamp:D,wordBreak:"break-word",heightLimit:rt?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:M,whiteSpace:E.length!==1||I?"normal":"no-wrap",checkedText:j,uncheckedText:Y},st={x:0,y:0,text:s.text?Object.assign({},s.text,J):J,circle:{radius:m},box:{width:p,height:v},spaceBetweenTextAndCircle:g,disabled:(c=x??W)!==null&&c!==void 0&&c};st.checked=S,C&&(st.box.uncheckedFill=C),w&&(st.box.disableUncheckedFill=w),b&&(st.box.checkedFill=b),y&&(st.box.disableCheckedFill=y),_&&(st.circle.fill=_);const ht=new Rd(st);return ht.name="switch",ht}const Ts=new tot,As=new Xu;function lst(n,t,e,i,r,o,s,a,l,u,h,d){var c,f,g,m,p,v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U;if(!n){const j=Oo(r,o,h,u);d&&(n=u.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:s,height:a,lineWidth:(f=(c=h==null?void 0:h.group)===null||c===void 0?void 0:c.lineWidth)!==null&&f!==void 0?f:void 0,fill:(m=(g=h==null?void 0:h.group)===null||g===void 0?void 0:g.fill)!==null&&m!==void 0?m:void 0,stroke:(v=(p=h==null?void 0:h.group)===null||p===void 0?void 0:p.stroke)!==null&&v!==void 0?v:void 0,strokeArrayWidth:j,strokeArrayColor:(C=(b=h==null?void 0:h.group)===null||b===void 0?void 0:b.strokeArrayColor)!==null&&C!==void 0?C:void 0,cursor:(w=(y=h==null?void 0:h.group)===null||y===void 0?void 0:y.cursor)!==null&&w!==void 0?w:void 0,lineDash:(A=(_=h==null?void 0:h.group)===null||_===void 0?void 0:_.lineDash)!==null&&A!==void 0?A:void 0,lineCap:"butt",clip:!0,cornerRadius:h.group.cornerRadius}),n&&n.role==="cell"||((n=new de({x:e,y:i,width:s,height:a,lineWidth:(S=(T=h==null?void 0:h.group)===null||T===void 0?void 0:T.lineWidth)!==null&&S!==void 0?S:void 0,fill:(E=(x=h==null?void 0:h.group)===null||x===void 0?void 0:x.fill)!==null&&E!==void 0?E:void 0,stroke:(L=(M=h==null?void 0:h.group)===null||M===void 0?void 0:M.stroke)!==null&&L!==void 0?L:void 0,strokeArrayWidth:j,strokeArrayColor:(D=(I=h==null?void 0:h.group)===null||I===void 0?void 0:I.strokeArrayColor)!==null&&D!==void 0?D:void 0,cursor:(O=(H=h==null?void 0:h.group)===null||H===void 0?void 0:H.cursor)!==null&&O!==void 0?O:void 0,lineDash:(U=(N=h==null?void 0:h.group)===null||N===void 0?void 0:N.lineDash)!==null&&U!==void 0?U:void 0,lineCap:"butt",clip:!0,cornerRadius:h.group.cornerRadius})).role="cell",n.col=r,n.row=o,t==null||t.addCellGroup(n))}const W=ust(r,o,s,a,l,u);return W&&n.appendChild(W),n}function ust(n,t,e,i,r,o){let s,a;const l=o.internalProps.layoutMap.getBody(n,t).sparklineSpec,u=o.getCellValue(n,t);if(!Array.isArray(u))return;const h=r[3],d=r[0];e-=r[1]+r[3];const c=i-=r[0]+r[2];if(typeof l=="function"){const C={col:n,row:t,dataValue:o.getCellOriginValue(n,t)||"",value:o.getCellValue(n,t)||"",rect:o.getCellRangeRelativeRect(o.getCellRange(n,t)),table:o};s=l(C),a=JM(s,h,d,e,i)}else s=l,a=JM(l,h,d,e,i);const f=[],g=[];let m,p;if(typeof s.xField=="object")Ts.domain(s.xField.domain),m=s.xField.field;else if(typeof s.xField=="string"){const C=u.map(y=>y[s.xField]);Ts.domain(C),m=s.xField}else Array.isArray(u)&&(Ts.domain(Array.from({length:u.length},(C,y)=>y)),m=s.xField);if(Ts.range([0,e]),typeof s.yField=="object")As.domain(s.yField.domain),p=s.yField.field;else if(typeof s.yField=="string"){const C=tB(u,s.yField);As.domain([Math.min(...C),Math.max(...C)]),p=s.yField}else if(Array.isArray(u)){const C=tB(u);As.domain([Math.min(...C),Math.max(...C)]),p=s.yField}if(As.range([0,i]),typeof s.xField=="object"&&Array.isArray(s.xField.domain)){const C=u.map(w=>w[s.xField.field]),y=s.xField.domain;for(let w=0;w<y.length;w++){let _=!1;for(let A=0;A<C.length;A++)if(y[w]===C[A]){const T=u[A];if(!et(T[m])||!et(T[p]))break;f.push({x:0+Ts.scale(T[m]),y:c-As.scale(T[p]),defined:et(T[p])}),g.push(T),_=!0;break}_||(f.push({x:0+Ts.scale(y[w]),y:0,defined:!1}),g.push({[m]:y[w],[p]:null}))}}else for(let C=0;C<u.length;C++){const y=u[C];f.push({x:0+Ts.scale(m?y[m]:C),y:c-As.scale(p?y[p]:y),defined:et(p?y[p]:y),rawData:y}),g.push(y)}const v=a.getChildByName("sparkline-line");v&&v.setAttribute("points",f),v.bandwidth=Ts.step(),v.min=As.range()[0],v.max=As.range()[1];const b=a.getChildByName("sparkline-symbol-group");if(b){const C=s.pointShowRule==="isolatedPoint";if(s.pointShowRule==="all")for(let y=0;y<f.length;y++){const{x:w,y:_,defined:A}=f[y];if(A){const T=yu({x:w,y:_});b.appendChild(T)}}else if(C)for(let y=0;y<f.length;y++){const{x:w,y:_,defined:A}=f[y];if(A&&(!f[y-1]||!f[y-1].defined)&&(!f[y+1]||!f[y+1].defined)){const T=yu({x:w,y:_});b.appendChild(T)}}}return a}function JM(n,t,e,i,r){var o,s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w,_,A,T,S,x;let E;E=typeof n=="function"?n(null):n;const M=new de({x:t,y:e,width:i,height:r,stroke:!1,fill:!1});if(M.name="sparkline",E.type==="line"){const L=ln({x:0,y:0,curveType:E.smooth?"monotoneX":"linear",stroke:(a=(s=(o=E.line)===null||o===void 0?void 0:o.style)===null||s===void 0?void 0:s.stroke)!==null&&a!==void 0?a:"blue",lineWidth:(h=(u=(l=E.line)===null||l===void 0?void 0:l.style)===null||u===void 0?void 0:u.strokeWidth)!==null&&h!==void 0?h:2});L.name="sparkline-line",M.addChild(L),E.crosshair&&(L.hover=(c=(d=E.crosshair)===null||d===void 0?void 0:d.style)!==null&&c!==void 0?c:{stroke:"#000",interpolate:"linear"});const I=new de({x:0,y:0,width:i,height:r,stroke:!1,fill:!1});I.name="sparkline-symbol-group",I.setTheme({symbol:{stroke:(m=(g=(f=E.point)===null||f===void 0?void 0:f.style)===null||g===void 0?void 0:g.stroke)!==null&&m!==void 0?m:"#000",lineWidth:(b=(v=(p=E.point)===null||p===void 0?void 0:p.style)===null||v===void 0?void 0:v.strokeWidth)!==null&&b!==void 0?b:1,fill:(w=(y=(C=E.point)===null||C===void 0?void 0:C.style)===null||y===void 0?void 0:y.fill)!==null&&w!==void 0?w:"#000",size:2*((T=(A=(_=E.point)===null||_===void 0?void 0:_.style)===null||A===void 0?void 0:A.size)!==null&&T!==void 0?T:3),symbolType:"circle"}}),M.addChild(I),I.hover=(x=(S=E.point)===null||S===void 0?void 0:S.hover)!==null&&x!==void 0&&x}return M}function tB(n,t){const e=[];for(let i=0;i<n.length;i++){const r=n[i];et(t)&&et(r[t])?e.push(r[t]):!et(t)&&et(r)&&e.push(r)}return e}const $b=Fn();function hst(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p){var v,b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J,st,ht,at,lt,_t;const vt=f._getCellStyle(i,r),yt=a0("padding",vt,i,r,f);!((v=f.options.customConfig)===null||v===void 0)&&v.imageMargin?u=me((b=f.options.customConfig)===null||b===void 0?void 0:b.imageMargin):et(yt)&&(u=yt),!((C=g==null?void 0:g.text)===null||C===void 0)&&C.textAlign&&(h=(y=g==null?void 0:g.text)===null||y===void 0?void 0:y.textAlign),!((w=g==null?void 0:g.text)===null||w===void 0)&&w.textBaseline&&(d=(_=g==null?void 0:g.text)===null||_===void 0?void 0:_.textBaseline);const mt=Oo(i,r,g,f);let ft,Ft;if(p&&(ft=f.scenegraph.highPerformanceGetCell(i,r,!0),ft&&ft.role==="cell"&&ft.setAttributes({x:t,y:e,width:o,height:s,lineWidth:(T=(A=g==null?void 0:g.group)===null||A===void 0?void 0:A.lineWidth)!==null&&T!==void 0?T:void 0,fill:(x=(S=g==null?void 0:g.group)===null||S===void 0?void 0:S.fill)!==null&&x!==void 0?x:void 0,stroke:(M=(E=g==null?void 0:g.group)===null||E===void 0?void 0:E.stroke)!==null&&M!==void 0?M:void 0,strokeArrayWidth:mt,strokeArrayColor:(I=(L=g==null?void 0:g.group)===null||L===void 0?void 0:L.strokeArrayColor)!==null&&I!==void 0?I:void 0,cursor:(H=(D=g==null?void 0:g.group)===null||D===void 0?void 0:D.cursor)!==null&&H!==void 0?H:void 0,lineDash:(N=(O=g==null?void 0:g.group)===null||O===void 0?void 0:O.lineDash)!==null&&N!==void 0?N:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})),ft&&ft.role==="cell"||(ft=new de({x:t,y:e,width:o,height:s,lineWidth:(W=(U=g==null?void 0:g.group)===null||U===void 0?void 0:U.lineWidth)!==null&&W!==void 0?W:void 0,fill:(Y=(j=g==null?void 0:g.group)===null||j===void 0?void 0:j.fill)!==null&&Y!==void 0?Y:void 0,stroke:(rt=(Z=g==null?void 0:g.group)===null||Z===void 0?void 0:Z.stroke)!==null&&rt!==void 0?rt:void 0,strokeArrayWidth:mt,strokeArrayColor:(st=(J=g==null?void 0:g.group)===null||J===void 0?void 0:J.strokeArrayColor)!==null&&st!==void 0?st:void 0,cursor:(at=(ht=g==null?void 0:g.group)===null||ht===void 0?void 0:ht.cursor)!==null&&at!==void 0?at:void 0,lineDash:(_t=(lt=g==null?void 0:g.group)===null||lt===void 0?void 0:lt.lineDash)!==null&&_t!==void 0?_t:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),ft.role="cell",ft.col=i,ft.row=r,n==null||n.addCellGroup(ft)),c){let It=i,Ot=r;m&&(It=m.start.col,Ot=m.start.row),Ft=f.getCellIcons(It,Ot)}let St=0,Kt=0;if(Array.isArray(Ft)&&Ft.length!==0){const{leftIconWidth:It,rightIconWidth:Ot,absoluteRightIconWidth:qt}=ju(Ft,ft,m,f);St=It,Kt=Ot,ft.forEachChildren(gt=>{gt.role==="icon-left"?gt.setAttribute("x",gt.attribute.x+u[3]):gt.role==="icon-right"?gt.setAttribute("x",gt.attribute.x+o-Ot-u[1]):gt.role==="icon-absolute-right"&&gt.setAttribute("x",gt.attribute.x+o-qt-u[1])}),ft.forEachChildren(gt=>{d==="middle"?gt.setAttribute("y",(s-gt.AABBBounds.height())/2):d==="bottom"?gt.setAttribute("y",s-gt.AABBBounds.height()-u[2]):gt.setAttribute("y",u[0])}),ft._cellLeftIconWidth=St,ft._cellRightIconWidth=Kt}const At=f.getCellValue(i,r),Pt=document.createElement("video");Pt.addEventListener("loadeddata",()=>{l&&wI(i,r,Pt.videoWidth,Pt.videoHeight,f.scenegraph,u,ft);const{width:It,height:Ot,isMerge:qt}=Ru(ft,f);if(a){const{width:Re,height:Ke}=s0(Pt.videoWidth,Pt.videoHeight,It-u[1]-u[3],Ot-u[0]-u[2]),yi=Jw(0,0,It,Ot,Re,Ke,h,d,u);Bt.setAttributes({width:Re,height:Ke,x:yi.x,y:yi.y,dx:0})}else Bt.setAttributes({x:u[3],y:u[0],width:It-u[1]-u[3],height:Ot-u[2]-u[0],dy:0});qt&&t1(ft.mergeStartCol,ft.mergeEndCol,ft.mergeStartRow,ft.mergeEndRow,f);const{width:gt,height:Ht}=Ru(ft,f),bt=Math.floor(Math.min(gt-u[1]-u[3],Ht-u[2]-u[0])/2),Fe=0+(gt>Bt.attribute.width?Bt.attribute.x-0+Bt.attribute.width/2:gt/2),hi=0+(Ht>Bt.attribute.height?Bt.attribute.y-0+Bt.attribute.height/2:Ht/2),le=ft.getChildByName("image",!0),{dx:Ci,dy:se}=le.attribute,vr=new tl({x:Fe-bt/2,y:hi-bt/2,width:bt,height:bt,image:$b.play.svg,cursor:$b.play.cursor,dx:Ci,dy:se});vr.name="play-icon",ft.appendChild(vr),f.scenegraph.updateNextFrame()}),Pt.onerror=()=>{Bt.image=$b.damage_pic.svg},Pt.src=At,Pt.setAttribute("preload","auto");const Bt=Hm({x:u[3],y:u[0],width:o-u[1]-u[3],height:s-u[2]-u[0],image:Pt,cursor:"pointer"});return Bt.name="image",Bt.keepAspectRatio=a,Bt.textAlign=h,Bt.textBaseline=d,ft.appendChild(Bt),ft}function dst(n,t,e){if(typeof n=="boolean"){const i=bg({x:t.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});i.name="mark",t.appendChild(i)}else{const{bgColor:i="#3073F2",shape:r="sector",position:o="right-top",size:s=10,offset:a=0}=n;let l,u,h,d,c,f;if(r==="sector")o==="right-top"?(l=t.attribute.width-a,u=a,h=Math.PI/2,d=Math.PI):o==="left-top"?(l=a,u=a,h=0,d=Math.PI/2):o==="right-bottom"?(l=t.attribute.width-a,u=t.attribute.height-a,h=Math.PI,d=Math.PI/2*3):o==="left-bottom"&&(l=a,u=t.attribute.height-a,h=Math.PI/2*3,d=2*Math.PI),c=i,f=bg({x:l,y:u,startAngle:h,endAngle:d,outerRadius:s,fill:c,pickable:!1});else if(r==="triangle"){let g,m,p,v;o==="right-top"?(l=t.attribute.width-a,u=a,g=l-s,m=u,p=l,v=u+s):o==="left-top"?(l=a,u=a,g=l+s,m=u,p=l,v=u+s):o==="right-bottom"?(l=t.attribute.width-a,u=t.attribute.height-a,g=l-s,m=u,p=l,v=u-s):o==="left-bottom"&&(l=a,u=t.attribute.height-a,g=l+s,m=u,p=l,v=u-s),c=i,f=PL({points:[{x:l,y:u},{x:g,y:m},{x:p,y:v}],fill:c,pickable:!1})}else r==="rect"&&(o==="right-top"?(l=t.attribute.width-s-a,u=a):o==="left-top"?(l=a,u=a):o==="right-bottom"?(l=t.attribute.width-s-a,u=t.attribute.height-s-a):o==="left-bottom"&&(l=a,u=t.attribute.height-s-a),c=i,f=Ge({x:l,y:u,width:s,height:s,fill:c,pickable:!1}));f.name="mark",t.appendChild(f)}}function cst(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v,b){var C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J,st,ht,at,lt,_t,vt,yt,mt,ft,Ft;const St=n._getCellStyle(o,s),Kt=a0("padding",St,o,s,n);et(Kt)&&(h=Kt),!((C=p==null?void 0:p.text)===null||C===void 0)&&C.textAlign&&(d=(y=p==null?void 0:p.text)===null||y===void 0?void 0:y.textAlign),!((w=p==null?void 0:p.text)===null||w===void 0)&&w.textBaseline&&(c=(_=p==null?void 0:p.text)===null||_===void 0?void 0:_.textBaseline);const At=n.isAutoRowHeight(s),Pt=a==="auto",Bt=(A=St.autoWrapText)!==null&&A!==void 0?A:n.internalProps.autoWrapText,It=St.lineClamp,Ot=Oo(o,s,p,n);let qt;if(b&&(qt=n.scenegraph.getCell(o,s,!0),qt&&qt.role==="cell"&&qt.setAttributes({x:i,y:r,width:l,height:u,lineWidth:(S=(T=p==null?void 0:p.group)===null||T===void 0?void 0:T.lineWidth)!==null&&S!==void 0?S:void 0,fill:(E=(x=p==null?void 0:p.group)===null||x===void 0?void 0:x.fill)!==null&&E!==void 0?E:void 0,stroke:(L=(M=p==null?void 0:p.group)===null||M===void 0?void 0:M.stroke)!==null&&L!==void 0?L:void 0,strokeArrayWidth:Ot??void 0,strokeArrayColor:(D=(I=p==null?void 0:p.group)===null||I===void 0?void 0:I.strokeArrayColor)!==null&&D!==void 0?D:void 0,cursor:(O=(H=p==null?void 0:p.group)===null||H===void 0?void 0:H.cursor)!==null&&O!==void 0?O:void 0,lineDash:(U=(N=p==null?void 0:p.group)===null||N===void 0?void 0:N.lineDash)!==null&&U!==void 0?U:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius})),qt&&qt.role==="cell"||(qt=new de({x:i,y:r,width:l,height:u,lineWidth:(j=(W=p==null?void 0:p.group)===null||W===void 0?void 0:W.lineWidth)!==null&&j!==void 0?j:void 0,fill:(Z=(Y=p==null?void 0:p.group)===null||Y===void 0?void 0:Y.fill)!==null&&Z!==void 0?Z:void 0,stroke:(J=(rt=p==null?void 0:p.group)===null||rt===void 0?void 0:rt.stroke)!==null&&J!==void 0?J:void 0,strokeArrayWidth:Ot??void 0,strokeArrayColor:(ht=(st=p==null?void 0:p.group)===null||st===void 0?void 0:st.strokeArrayColor)!==null&&ht!==void 0?ht:void 0,cursor:(lt=(at=p==null?void 0:p.group)===null||at===void 0?void 0:at.cursor)!==null&&lt!==void 0?lt:void 0,lineDash:(vt=(_t=p==null?void 0:p.group)===null||_t===void 0?void 0:_t.lineDash)!==null&&vt!==void 0?vt:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius}),qt.role="cell",qt.col=o,qt.row=s,e==null||e.addCellGroup(qt)),g&&qt.appendChild(g),m){const gt=t;let Ht;if(f){let bt=o,Fe=s;v&&(bt=v.start.col,Fe=v.start.row),Ht=n.getCellIcons(bt,Fe)}cJ(qt,Ht,gt,h,Pt,At,Bt,typeof It=="number"?It:void 0,qt.attribute.width,qt.attribute.height,d,c,n,p,v),!((yt=p==null?void 0:p._vtable)===null||yt===void 0)&&yt.marked&&dst((mt=p==null?void 0:p._vtable)===null||mt===void 0?void 0:mt.marked,qt)}return g&&qt.setAttributes({width:Math.max(qt.attribute.width,(ft=g.attribute.width)!==null&&ft!==void 0?ft:0),height:Math.max(qt.attribute.height,(Ft=g.attribute.height)!==null&&Ft!==void 0?Ft:0)}),qt}function fst(n,t,e,i,r,o,s,a,l,u){var h,d,c,f,g;if(n.dependField){const vt=Me(n.dependField,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0});r=(d=(h=l.getCellOriginRecord(o,s))===null||h===void 0?void 0:h[vt])!==null&&d!==void 0?d:r}const m=(c=Me(n.barType,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0}))!==null&&c!==void 0?c:"default",p=(f=Me(n.min,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0}))!==null&&f!==void 0?f:0,v=(g=Me(n.max,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0}))!==null&&g!==void 0?g:p+100;let b=0;b=u?l.getRowsHeight(u.start.row,u.end.row):l.getRowHeight(s);let C=e,y=b,w=0;wt(l.theme._contentOffset)&&(w=l.theme._contentOffset);const _=new de({x:-w,y:-w,width:C,height:y});_.name="progress-bar";const{showBar:A,barColor:T,barBgColor:S,barPositiveColor:x,barNegativeColor:E,barAxisColor:M,barRightToLeft:L,showBarMark:I,barMarkPositiveColor:D,barMarkNegativeColor:H,barMarkWidth:O,barMarkPosition:N,barMarkInBar:U}=t;let{barHeight:W,barBottom:j,barPadding:Y}=t;Y.length===1?Y=[Y[0],Y[0],Y[0],Y[0]]:Y.length===2?Y=[Y[0],Y[1],Y[0],Y[1]]:Y.length===3&&(Y=[Y[0],Y[1],Y[2],Y[1]]),Y=Y.map((vt,yt)=>{if(typeof vt=="string"&&lf.endsWith(vt,"%")){const mt=Number(vt.substr(0,vt.length-1));return yt===0||yt===2?b*mt/100:e*mt/100}return Number(vt)});const Z=me(pt("borderLineWidth",t,o,s,l)),rt=Math.max(Y[0],Math.ceil(Z[0]/2));let J=Math.max(Y[1],Math.floor(Z[1]/2));const st=Math.max(Y[2],Math.floor(Z[2]/2));let ht=Math.max(Y[3],Math.ceil(Z[3]/2));I&&O>0&&N==="right"&&U===!1&&(J+=O,ht+=O),C-=J+ht,y-=st+rt,s===l.rowCount-1&&[0,"0"].includes(j)&&(y-=1);const at=rt,lt=ht,_t=C;if(typeof W=="string"&&lf.endsWith(W,"%")?(W=Number(W.substr(0,W.length-1)),W=y*W/100):W=Number(W),typeof j=="string"&&lf.endsWith(j,"%")?(j=Number(j.substr(0,j.length-1)),j=y*j/100):j=Number(j),Me(A,{col:o,row:s,table:l,context:null,value:i,dataValue:r})){let vt=`${r}`;lf.endsWith(vt,"%")&&(vt=vt.substr(0,vt.length-1));const yt=Number(vt);if(isNaN(yt))return _;if((m??"default")==="default"){const mt=yt<p?0:yt>v?1:(yt-p)/(v-p),ft=C,Ft=at+y-W-j;let St=Math.min(ft*mt,ft);const Kt=L?lt+_t-St:lt;o!==l.colCount-1||mt!==1||L||(St-=1);const At=Me(S,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:mt});if(At){const It=Ge({x:Kt,y:Ft,width:ft,height:W,fill:At});_.addChild(It)}const Pt=Me(T,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:mt})||"#20a8d8",Bt=Ge({x:Kt,y:Ft,width:St,height:W,fill:Pt});_.addChild(Bt)}else if(m==="negative"){const mt=p<0?-p:0,ft=v>0?v:0,Ft=mt/(mt+ft),St=1-Ft,Kt=yt>0?yt/ft:0,At=yt<0?-yt/mt:0,Pt=C,Bt=at+y-W-j,It=lt,Ot=Me(S,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:Kt});if(Ot){const yi=Ge({x:It,y:Bt,width:Pt,height:W,fill:Ot});_.addChild(yi)}const qt=L?St*Pt:Ft*Pt,gt=Math.min(Pt*Ft*At,Pt),Ht=L?{left:It+qt,top:Bt,width:gt,height:W}:{left:It+qt-gt,top:Bt,width:gt,height:W},bt=Me(E,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:At})||"#20a8d8",Fe=Ge({x:Ht.left,y:Ht.top,width:Ht.width,height:Ht.height,fill:bt});_.addChild(Fe);let hi=Math.min(Pt*St*Kt,Pt);o!==l.colCount-1||Kt!==1||L||(hi-=1);const le=L?{left:It+qt-hi,top:Bt,width:hi,height:W}:{left:It+qt,top:Bt,width:hi,height:W},Ci=Me(x,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:Kt})||"#20a8d8",se=Ge({x:le.left,y:le.top,width:le.width,height:le.height,fill:Ci});_.addChild(se);const vr=L?Ht.left:le.left,Re=Me(M,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:Kt}),Ke=ln({x:0,y:0,stroke:Re,lineWidth:1,lineDash:[2,2],points:[{x:vr,y:0},{x:vr,y:b}]});if(_.addChild(Ke),I&&(Kt||At)){const yi=O,wi=[];let zi;if(Kt>0)if(zi=Me(D,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:Kt})||"#20a8d8",N==="right"){const ur=L?le.left+O/2:le.left+le.width+(U?-O/2:O/2);wi.push({x:ur,y:le.top}),wi.push({x:ur,y:le.top+le.height})}else N==="bottom"&&(wi.push({x:le.left,y:le.top+le.height-O/2}),wi.push({x:le.left+le.width,y:le.top+le.height-O/2}));else if(At>0)if(zi=Me(H,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:At})||"#20a8d8",N==="right"){const ur=L?Ht.left+Ht.width-O/2:Ht.left+O/2;wi.push({x:ur,y:Ht.top}),wi.push({x:ur,y:Ht.top+Ht.height})}else N==="bottom"&&(wi.push({x:Ht.left,y:Ht.top+Ht.height-O/2}),wi.push({x:Ht.left+Ht.width,y:Ht.top+Ht.height-O/2}));const br=ln({x:0,y:0,stroke:zi,lineWidth:yi,points:wi});_.addChild(br)}}else if(m==="negative_no_axis"){const mt=p<0?-p:0,ft=v>0?v:0,Ft=Math.max(mt,ft),St=Ft===0?0:Math.abs(yt)/Ft,Kt=C;let At=Math.min(Kt*St,Kt);o!==l.colCount-1||St!==1||L||(At-=1);const Pt=at+y-W-j,Bt=L?lt+_t-At:lt,It=Me(S,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:St});if(It){const Ht=Ge({x:Bt,y:Pt,width:Kt,height:W,fill:It});_.addChild(Ht)}const Ot={left:Bt,top:Pt,width:At,height:W};let qt;qt=yt>=0?Me(x,{col:o,row:s,table:l,context:null,value:i,percentile:St,dataValue:r})||"#20a8d8":Me(E,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:St})||"#20a8d8";const gt=Ge({x:Ot.left,y:Ot.top,width:Ot.width,height:Ot.height,fill:qt});if(_.addChild(gt),I&&yt){const Ht=O,bt=[];let Fe;if(Fe=yt>=0?Me(D,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:St})||"#20a8d8":Me(H,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:St})||"#20a8d8",N==="right"){const le=L?Ot.left+O/2:Ot.left+Ot.width-O/2;bt.push({x:le,y:Ot.top}),bt.push({x:le,y:Ot.top+Ot.height})}else N==="bottom"&&(bt.push({x:Ot.left,y:Ot.top+Ot.height-O/2}),bt.push({x:Ot.left+Ot.width,y:Ot.top+Ot.height-O/2}));const hi=ln({x:0,y:0,stroke:Fe,lineWidth:Ht,points:bt});_.addChild(hi)}}}return _}function gst(n,t,e,i,r,o){var s,a,l,u,h,d,c,f,g,m,p,v,b,C,y,w;if(e!=null&&e.zero&&(n=Math.min(n,0),t=Math.max(t,0)),e==null?void 0:e.expand){const T=n,S=t;et(e.expand.min)&&(n=T-(S-T)*e.expand.min),et(e.expand.max)&&(t=S+(S-T)*e.expand.max)}let _,A;if(wt(e==null?void 0:e.min)&&(n=e.min),wt(e==null?void 0:e.max)&&(t=e.max),(e==null?void 0:e.type)==="log"?(_=new ic,_.base((s=e==null?void 0:e.base)!==null&&s!==void 0?s:10)):(e==null?void 0:e.type)==="symlog"?(_=new rc,_.constant((a=e==null?void 0:e.constant)!==null&&a!==void 0?a:10)):_=new Xu,_.domain([n,t],!!(e!=null&&e.nice)),o)pst(_,o);else if(e!=null&&e.nice){let T=(d=(u=(l=e.tick)===null||l===void 0?void 0:l.forceTickCount)!==null&&u!==void 0?u:(h=e.tick)===null||h===void 0?void 0:h.tickCount)!==null&&d!==void 0?d:10;pn(T)&&(T=T({axisLength:r,labelStyle:(f=(c=e==null?void 0:e.label)===null||c===void 0?void 0:c.style)!==null&&f!==void 0?f:{fontSize:Dh.LABEL_FONT_SIZE}})),e.niceType==="accurateFirst"&&(T=Math.max(10,T)),xe(e.min)&&xe(e.max)?_.nice(T):et(e.min)&&xe(e.max)?_.niceMax(T):xe(e.min)&&et(e.max)&&_.niceMin(T)}return delete _._niceType,A=((m=(g=o==null?void 0:o.targetTicks)===null||g===void 0?void 0:g.length)!==null&&m!==void 0?m:!((p=e==null?void 0:e.tick)===null||p===void 0)&&p.forceTickCount)?_.forceTicks((b=(v=o==null?void 0:o.targetTicks)===null||v===void 0?void 0:v.length)!==null&&b!==void 0?b:(C=e==null?void 0:e.tick)===null||C===void 0?void 0:C.forceTickCount):_.ticks(wt((y=e==null?void 0:e.tick)===null||y===void 0?void 0:y.tickCount)?e.tick.tickCount:5,{noDecimals:(w=e==null?void 0:e.tick)===null||w===void 0?void 0:w.noDecimals}),{range:_.domain(),ticks:A}}function pst(n,t){n.niceMax(t.targetTicks.length)}function mst(n,t,e,i,r,o,s,a,l,u,h,d,c,f,g,m,p,v){var b,C,y,w,_,A,T,S,x,E,M,L,I,D,H,O,N,U,W,j,Y,Z,rt,J;if(!n){const _t=Oo(r,o,g,f);v&&(n=f.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:a,height:l,lineWidth:(C=(b=g==null?void 0:g.group)===null||b===void 0?void 0:b.lineWidth)!==null&&C!==void 0?C:void 0,fill:(w=(y=g==null?void 0:g.group)===null||y===void 0?void 0:y.fill)!==null&&w!==void 0?w:void 0,stroke:(A=(_=g==null?void 0:g.group)===null||_===void 0?void 0:_.stroke)!==null&&A!==void 0?A:void 0,strokeArrayWidth:_t,strokeArrayColor:(S=(T=g==null?void 0:g.group)===null||T===void 0?void 0:T.strokeArrayColor)!==null&&S!==void 0?S:void 0,cursor:(E=(x=g==null?void 0:g.group)===null||x===void 0?void 0:x.cursor)!==null&&E!==void 0?E:void 0,lineDash:(L=(M=g==null?void 0:g.group)===null||M===void 0?void 0:M.lineDash)!==null&&L!==void 0?L:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),n&&n.role==="cell"||((n=new de({x:e,y:i,width:a,height:l,lineWidth:(D=(I=g==null?void 0:g.group)===null||I===void 0?void 0:I.lineWidth)!==null&&D!==void 0?D:void 0,fill:(O=(H=g==null?void 0:g.group)===null||H===void 0?void 0:H.fill)!==null&&O!==void 0?O:void 0,stroke:(U=(N=g==null?void 0:g.group)===null||N===void 0?void 0:N.stroke)!==null&&U!==void 0?U:void 0,strokeArrayWidth:_t,strokeArrayColor:(j=(W=g==null?void 0:g.group)===null||W===void 0?void 0:W.strokeArrayColor)!==null&&j!==void 0?j:void 0,cursor:(Z=(Y=g==null?void 0:g.group)===null||Y===void 0?void 0:Y.cursor)!==null&&Z!==void 0?Z:void 0,lineDash:(J=(rt=g==null?void 0:g.group)===null||rt===void 0?void 0:rt.lineDash)!==null&&J!==void 0?J:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",n.col=r,n.row=o,t==null||t.addCellGroup(n))}let st;if(c){let _t=r,vt=o;p&&(_t=p.start.col,vt=p.start.row),st=f.getCellIcons(_t,vt)}let ht=0,at=0;if(Array.isArray(st)&&st.length!==0){const{leftIconWidth:_t,rightIconWidth:vt,absoluteRightIconWidth:yt}=ju(st,n,p,f);ht=_t+vt,at=_t,n.forEachChildren(mt=>{mt.role==="icon-left"?mt.setAttribute("x",mt.attribute.x+u[3]):mt.role==="icon-right"?mt.setAttribute("x",mt.attribute.x+a-vt-u[1]):mt.role==="icon-absolute-right"&&mt.setAttribute("x",mt.attribute.x+a-yt-u[1])}),n.forEachChildren(mt=>{d==="middle"?mt.setAttribute("y",(l-mt.AABBBounds.height())/2):d==="bottom"?mt.setAttribute("y",l-mt.AABBBounds.height()-u[2]):mt.setAttribute("y",u[0])})}const lt=vst(r,o,s-ht,a,l,u,g,m,f);return lt&&n.appendChild(lt),a-=u[1]+u[3]+ht,l-=u[0]+u[2],h==="center"?lt.setAttribute("x",u[3]+at+(a-lt.AABBBounds.width())/2):h==="right"?lt.setAttribute("x",u[3]+at+a-lt.AABBBounds.width()):lt.setAttribute("x",u[3]+at),d==="middle"?lt.setAttribute("y",u[0]+(l-lt.AABBBounds.height())/2):d==="bottom"?lt.setAttribute("y",u[0]+l-lt.AABBBounds.height()):lt.setAttribute("y",u[0]),n}function vst(n,t,e,i,r,o,s,a,l){var u,h;const d=l._getCellStyle(n,t),c=pt("buttonColor",d,n,t,l),f=pt("buttonBorderColor",d,n,t,l),g=pt("buttonLineWidth",d,n,t,l),m=pt("buttonBorderRadius",d,n,t,l),p=pt("buttonHoverColor",d,n,t,l),v=pt("buttonHoverBorderColor",d,n,t,l),b=pt("buttonPadding",d,n,t,l),C=pt("buttonTextHoverColor",d,n,t,l),y=pt("buttonDisableColor",d,n,t,l),w=pt("buttonDisableBorderColor",d,n,t,l),_=pt("buttonTextDisableColor",d,n,t,l),A=l.getCellValue(n,t),T=l.getCellOriginValue(n,t),S=dn(n,t,l),x=l._getCellStyle(n,t),E=(u=x.autoWrapText)!==null&&u!==void 0?u:l.internalProps.autoWrapText,{lineClamp:M}=x,L=e==="auto",I=l.isAutoRowHeight(t),{disable:D,text:H}=a,O=Me(D,{col:n,row:t,table:l,context:null,value:A,dataValue:T}),N=Me(H,{col:n,row:t,table:l,context:null,value:A,dataValue:T}),U=(h=N??A)!==null&&h!==void 0?h:"",W={maxLineWidth:L?1/0:i-(o[1]+o[3]+S),textAlign:"left",textBaseline:"top",autoWrapText:E,lineClamp:M,wordBreak:"break-word",heightLimit:I?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:S,whiteSpace:U.length!==1||E?"normal":"no-wrap"},j=s.text?Object.assign({},s.text,W):W,Y={x:0,y:0,cursor:O?"not-allowed":"pointer",disable:O,childrenPickable:!1,text:U.length===1?U[0]:U,textStyle:j,padding:b,panel:{visible:!0,fill:O?y:c,stroke:O?w:f,lineWidth:g,cornerRadius:m},state:{text:{hover:{}},panel:{hover:{fill:p,stroke:v}}}};_&&(Y.state.text.fill=_),C&&(Y.state.text.hover.fill=C);const Z=new Gs(Y);return Z.name="button",O||(Z.addEventListener("mouseenter",()=>{Z.addState("hover",!0,!1),Z.stage.renderNextFrame()}),Z.addEventListener("mouseleave",()=>{Z.removeState("hover",!1),Z.stage.renderNextFrame()})),Z}const bst=()=>{Gt.registerFunction("createChartCellGroup",Qot),Gt.registerFunction("getAxisDomainRangeAndLabels",gst)},_st=()=>{Gt.registerFunction("createCheckboxCellGroup",tst)},Cst=()=>{Gt.registerFunction("createImageCellGroup",pJ)},yst=()=>{Gt.registerFunction("createProgressBarCell",fst)},wst=()=>{Gt.registerFunction("createRadioCellGroup",ist)},Sst=()=>{Gt.registerFunction("createSwitchCellGroup",sst)},xst=()=>{Gt.registerFunction("createButtonCellGroup",mst)},Tst=()=>{Gt.registerFunction("createSparkLineCellGroup",lst)},Ast=()=>{Gt.registerFunction("createTextCellGroup",cst)},Rst=()=>{Gt.registerFunction("createVideoCellGroup",hst)};Wot(),Uot(),Vot(),jot(),Got(),$ot(),Zot(),Rrt(),qot(),bst(),_st(),Cst(),yst(),wst(),Sst(),xst(),Tst(),Ast(),Rst();class Est extends Dnt{}const Mst={key:0,id:"tableContainer",class:"table-wrapper"},Bst={__name:"VideoTab",props:{summary:{type:Array,default:()=>[]},videoId:String,videoTitle:String},emits:["summary-tab-click"],setup(n,{emit:t}){const e=UO(),i=fa(!1),r=n,o=t,s=()=>{o("summary-tab-click"),i.value=!0,console.log("已点击按钮，通知父组件加载数据")},a=()=>{e.push(`/video/exercises/${r.videoId}`)},l=()=>{e.push(`/video/notes/${r.videoId}`)};return NO(i,async u=>{if(!u||!r.videoId)return;await VO();const h=document.getElementById("tableContainer");if(h)try{const d=await YO(r.videoId);if(d.code===200){const c=d.chartOption;new Est(h,{...c,widthMode:"adaptive",heightMode:"adaptive",animationAppear:{duration:300,delay:50,type:"one-by-one",direction:"row"},theme:"default"})}}catch(d){console.error("加载表格失败:",d)}}),(u,h)=>{const d=XO;return So(),rs(td,null,[zs(d,{class:"sum-btn",onClick:s,type:"primary",round:""},{default:Ma(()=>h[0]||(h[0]=[v0("视频总结")])),_:1,__:[0]}),zs(d,{class:"sum-btn",onClick:l,type:"primary",round:""},{default:Ma(()=>h[1]||(h[1]=[v0("课堂笔记")])),_:1,__:[1]}),zs(d,{class:"sum-btn",onClick:a,type:"primary",round:""},{default:Ma(()=>h[2]||(h[2]=[v0("课后练习")])),_:1,__:[2]}),h[3]||(h[3]=jn("hr",null,null,-1)),(So(!0),rs(td,null,fy(n.summary,(c,f)=>(So(),rs("div",{key:f},[jn("h3",null,ed(c.chapterTitle),1),jn("p",null,ed(c.summary),1)]))),128)),i.value?(So(),rs("div",Mst)):WO("",!0)],64)}}},Pst=JO(Bst,[["__scopeId","data-v-285f4f3e"]]),kst="播放",Lst="暂停",Dst="时长",Ist="直播",Fst="加载完成",Ost="进度",Hst="全屏",zst="静音",Nst="开启音效",Wst="字幕",Ust="内嵌字幕",Vst="节目段落",jst="描述",Gst="关闭",$st="重新播放",qst="文字",Xst="白",Yst="黑",Kst="红",Zst="绿",Qst="蓝",Jst="黄",tat="紫红",eat="青",iat="背景",rat="窗口",nat="透明",oat="不透明",sat="无",aat="浮雕",lat="压低",uat="均匀",hat="下阴影",dat="舒适",cat="手写体",fat="重置",gat="完成",pat={Play:kst,Pause:Lst,"Current Time":"当前时间",Duration:Dst,"Remaining Time":"剩余时间","Stream Type":"媒体流类型",LIVE:Ist,Loaded:Fst,Progress:Ost,Fullscreen:Hst,"Non-Fullscreen":"退出全屏","Picture-in-Picture":"画中画","Exit Picture-in-Picture":"退出画中画",Mute:zst,Unmute:Nst,"Playback Rate":"播放速度",Subtitles:Wst,"subtitles off":"关闭字幕",Captions:Ust,"captions off":"关闭内嵌字幕",Chapters:Vst,"Close Modal Dialog":"关闭弹窗",Descriptions:jst,"descriptions off":"关闭描述","Audio Track":"音轨","You aborted the media playback":"视频播放被终止","A network error caused the media download to fail part-way.":"网络错误导致视频下载中途失败。","The media could not be loaded, either because the server or network failed or because the format is not supported.":"视频因格式不支持或者服务器或网络的问题无法加载。","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"由于视频文件损坏或是该视频使用了你的浏览器不支持的功能，播放终止。","No compatible source was found for this media.":"无法找到此视频兼容的源。","The media is encrypted and we do not have the keys to decrypt it.":"视频已加密，无法解密。","Play Video":"播放视频",Close:Gst,"Modal Window":"弹窗","This is a modal window":"这是一个弹窗","This modal can be closed by pressing the Escape key or activating the close button.":"可以按ESC按键或启用关闭按钮来关闭此弹窗。",", opens captions settings dialog":", 开启标题设置弹窗",", opens subtitles settings dialog":", 开启字幕设置弹窗",", opens descriptions settings dialog":", 开启描述设置弹窗",", selected":", 选择","captions settings":"字幕设定","Audio Player":"音频播放器","Video Player":"视频播放器",Replay:$st,"Progress Bar":"进度条","Volume Level":"音量","subtitles settings":"字幕设定","descriptions settings":"描述设定",Text:qst,White:Xst,Black:Yst,Red:Kst,Green:Zst,Blue:Qst,Yellow:Jst,Magenta:tat,Cyan:eat,Background:iat,Window:rat,Transparent:nat,"Semi-Transparent":"半透明",Opaque:oat,"Font Size":"字体尺寸","Text Edge Style":"字体边缘样式",None:sat,Raised:aat,Depressed:lat,Uniform:uat,Dropshadow:hat,"Font Family":"字体库","Proportional Sans-Serif":"比例无细体","Monospace Sans-Serif":"单间隔无细体","Proportional Serif":"比例细体","Monospace Serif":"单间隔细体",Casual:dat,Script:cat,"Small Caps":"小型大写字体",Reset:fat,"restore all settings to the default values":"恢复全部设定至预设值",Done:gat,"Caption Settings Dialog":"字幕设定窗口","Beginning of dialog window. Escape will cancel and close the window.":"打开对话窗口。Escape键将取消并关闭对话窗口","End of dialog window.":"结束对话窗口","Seek to live, currently behind live":"尝试直播，当前为延时播放","Seek to live, currently playing live":"尝试直播，当前为实时播放","progress bar timing: currentTime={1} duration={2}":"{1}/{2}","{1} is loading.":"正在加载 {1}。","No content":"无内容"},mat={class:"video-box"},vat={class:"video-container"},bat=["src","srclang","label","default"],_at={class:"right-panel"},Uat={__name:"VideoDetails",setup(n){ot.addLanguage("zh-CN",pat);const e=jO().params.videoId,i=fa(null),r=fa([]);let o=null,s=null;const a=fa(!1),l=fa(""),u=fa([]),h=fa(!1),d=`video-${e}-last-time`;console.log("🚀 路由参数:",e),GO(async()=>{const m=await KO(e);l.value=m.video.title,o=ot(i.value,{language:"zh-CN"},()=>{o.src({type:"video/mp4",src:m.video.filePath});const p=localStorage.getItem(d);p&&o.currentTime(parseFloat(p)),s=o.addTextTrack("subtitles","中文（自动）","zh"),s?(s.mode="hidden",m.subtitles.forEach(C=>{const y=new VTTCue(C.startTime,C.endTime,C.content);s.addCue(y)})):console.warn("字幕轨创建失败");const v=ot.getComponent("Button"),b=ot.extend(v,{constructor:function(C,y){v.apply(this,arguments),this.controlText("切换字幕")},handleClick:function(){s&&(s.mode=s.mode==="showing"?"hidden":"showing",this.controlText(s.mode==="showing"?"隐藏字幕":"显示字幕"))}});ot.registerComponent("SubtitleToggleButton",b),o.getChild("controlBar").addChild("SubtitleToggleButton",{},o.controlBar.children().length-1),o.on("timeupdate",()=>{const C=o.currentTime();localStorage.setItem(d,C)})})}),$O(()=>{o&&o.dispose()});const c=async()=>{if(!a.value){h.value=!0;try{const m=await ZO(e);m.code===200&&(r.value=m.chapters,a.value=!0)}finally{h.value=!1}}},f=m=>{console.log("跳转时间：",m),o&&(o.currentTime(m),o.play())},g=async()=>{if(console.log("还没发总结请求"),!(u.value.length>0)){console.log("summaryData.value.length:",u.value.length);try{const m=await QO(e);console.log("已经发了总结请求,并且拿到数据：",m),m.code===200&&(u.value=m.summary||[],console.log("处理后的数组数据:",u.value))}catch(m){console.error("请求失败:",m),u.value=[]}}};return(m,p)=>(So(),rs(td,null,[jn("div",null,[jn("h2",null,ed(l.value),1)]),jn("div",mat,[jn("div",vat,[jn("video",{ref_key:"videoRef",ref:i,class:"video-js vjs-default-skin",controls:"",preload:"auto",width:"854",height:"480"},[(So(!0),rs(td,null,fy(m.tracks,(v,b)=>(So(),rs("track",{key:b,kind:"subtitles",src:v.src,srclang:v.lang,label:v.label,default:v.default||!1},null,8,bat))),128))],512)]),jn("div",_at,[zs(f4,{chapters:r.value,loading:h.value,onJump:f,onExpand:c},null,8,["chapters","loading"])])]),zs(Pst,{videoId:qO(e),loading:m.loading,summary:u.value,onSummaryTabClick:g},null,8,["videoId","loading","summary"])],64))}};export{Uat as default};
