import{m as ot,n as St,aa as Ct,ab as _t,E as je}from"./_plugin-vue_export-helper-DnkLqMvT.js";import{e as Nt,f as kt,E as Lt,h as Tt}from"./video-B2wRqW2q.js";import{r as O,M as it,an as At,p as B,m as $,o as I,P as V,l as ne,C as $e,D as Z,a8 as Mt,F as me,a9 as Oe,W as Dt,v as Pe,x as jt,s as He,a7 as $t}from"./index-Q3dqO0M-.js";import{E as Be}from"./index-Du0b-sqy.js";import"./index-CgUo9-lj.js";import"./request-B6ihF906.js";var Ot=Object.defineProperty,Pt=(e,t,n)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oe=(e,t,n)=>(Pt(e,typeof t!="symbol"?t+"":t,n),n);const xe={name:"Latte",type:"light",palette:["#dd7878","#ea76cb","#8839ef","#e64553","#fe640b","#df8e1d","#40a02b","#209fb5","#1e66f5","#7287fd"],cssVar:{"--node-gap-x":"30px","--node-gap-y":"10px","--main-gap-x":"65px","--main-gap-y":"45px","--root-radius":"30px","--main-radius":"20px","--root-color":"#ffffff","--root-bgcolor":"#4c4f69","--root-border-color":"rgba(0, 0, 0, 0)","--main-color":"#444446","--main-bgcolor":"#ffffff","--topic-padding":"3px","--color":"#777777","--bgcolor":"#f6f6f6","--selected":"#4dc4ff","--panel-color":"#444446","--panel-bgcolor":"#ffffff","--panel-border-color":"#eaeaea","--map-padding":"50px"}},Ee={name:"Dark",type:"dark",palette:["#848FA0","#748BE9","#D2F9FE","#4145A5","#789AFA","#706CF4","#EF987F","#775DD5","#FCEECF","#DA7FBC"],cssVar:{"--node-gap-x":"30px","--node-gap-y":"10px","--main-gap-x":"65px","--main-gap-y":"45px","--root-radius":"30px","--main-radius":"20px","--root-color":"#ffffff","--root-bgcolor":"#2d3748","--root-border-color":"rgba(255, 255, 255, 0.1)","--main-color":"#ffffff","--main-bgcolor":"#4c4f69","--topic-padding":"3px","--color":"#cccccc","--bgcolor":"#252526","--selected":"#4dc4ff","--panel-color":"#ffffff","--panel-bgcolor":"#2d3748","--panel-border-color":"#696969","--map-padding":"50px 80px"}};function ae(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}const ce=function(e,t){if(t.id===e)return t;if(t.children&&t.children.length){for(let n=0;n<t.children.length;n++){const o=ce(e,t.children[n]);if(o)return o}return null}else return null},W=(e,t)=>{if(e.parent=t,e.children)for(let n=0;n<e.children.length;n++)W(e.children[n],e)};function Se(e){if(e.id=q(),e.children)for(let t=0;t<e.children.length;t++)Se(e.children[t])}function de(e,t,n,o){const i=o-t,r=e-n;let s=Math.atan(Math.abs(i)/Math.abs(r))/3.14*180;if(isNaN(s))return;r<0&&i>0&&(s=180-s),r<0&&i<0&&(s=180+s),r>0&&i<0&&(s=360-s);const l=12,c=30,h=s+c,d=s-c;return{x1:n+Math.cos(Math.PI*h/180)*l,y1:o-Math.sin(Math.PI*h/180)*l,x2:n+Math.cos(Math.PI*d/180)*l,y2:o-Math.sin(Math.PI*d/180)*l}}function q(){return(new Date().getTime().toString(16)+Math.random().toString(16).substr(2)).substr(2,16)}const Ht=function(){const e=q();return{topic:this.newTopicName,id:e}};function Ce(e){return JSON.parse(JSON.stringify(e,(t,n)=>{if(t!=="parent")return n}))}const R=(e,t)=>{let n=0,o=0;for(;t&&t!==e;)n+=t.offsetLeft,o+=t.offsetTop,t=t.offsetParent;return{offsetLeft:n,offsetTop:o}},_=(e,t)=>{for(const n in t)e.setAttribute(n,t[n])},ve=e=>e?e.tagName==="ME-TPC":!1,fe=e=>e.filter(t=>t.nodeObj.parent).filter((t,n,o)=>{for(let i=0;i<o.length;i++){if(t===o[i])continue;const{parent:r}=t.nodeObj;if(r===o[i].nodeObj)return!1}return!0}),rt=e=>{const t=/translate\(([^,]+),\s*([^)]+)\)/,n=e.match(t);return n?{x:parseFloat(n[1]),y:parseFloat(n[2])}:{x:0,y:0}},_e=function(e){for(let t=0;t<e.length;t++){const{dom:n,evt:o,func:i}=e[t];n.addEventListener(o,i)}return function(){for(let t=0;t<e.length;t++){const{dom:n,evt:o,func:i}=e[t];n.removeEventListener(o,i)}}};var D=(e=>(e.LHS="lhs",e.RHS="rhs",e))(D||{});const Bt=e=>{const t=e.map.querySelectorAll(".lhs>me-wrapper>me-parent>me-tpc");e.selectNode(t[Math.ceil(t.length/2)-1])},It=e=>{const t=e.map.querySelectorAll(".rhs>me-wrapper>me-parent>me-tpc");e.selectNode(t[Math.ceil(t.length/2)-1])},Wt=e=>{e.selectNode(e.map.querySelector("me-root>me-tpc"))},Rt=function(e,t){const n=t.parentElement.parentElement.parentElement.previousSibling;if(n){const o=n.firstChild;e.selectNode(o)}},Ft=function(e,t){const n=t.parentElement.nextSibling;if(n&&n.firstChild){const o=n.firstChild.firstChild.firstChild;e.selectNode(o)}},Ie=function(e,t){var n,o;const i=e.currentNode||((n=e.currentNodes)==null?void 0:n[0]);if(!i)return;const r=i.nodeObj,s=i.offsetParent.offsetParent.parentElement;r.parent?s.className===t?Ft(e,i):(o=r.parent)!=null&&o.parent?Rt(e,i):Wt(e):t===D.LHS?Bt(e):It(e)},We=function(e,t){const n=e.currentNode;if(!n||!n.nodeObj.parent)return;const o=t+"Sibling",i=n.parentElement.parentElement[o];i?e.selectNode(i.firstChild.firstChild):e.selectNode(n)},he=function(e,t,n){const{scaleVal:o,scaleSensitivity:i}=e;switch(t){case"in":if(o>1.6)return;e.scale(o+i,n);break;case"out":if(o<.6)return;e.scale(o-i,n)}};function Vt(e,t){t=t===!0?{}:t;const n=()=>{e.currentArrow?e.removeArrow():e.currentSummary?e.removeSummary(e.currentSummary.summaryObj.id):e.currentNodes&&e.removeNodes(e.currentNodes)},o={Enter:i=>{i.shiftKey?e.insertSibling("before"):i.ctrlKey?e.insertParent():e.insertSibling("after")},Tab:()=>{e.addChild()},F1:()=>{e.toCenter()},F2:()=>{e.beginEdit()},ArrowUp:i=>{if(i.altKey)e.moveUpNode();else{if(i.metaKey||i.ctrlKey)return e.initSide();We(e,"previous")}},ArrowDown:i=>{i.altKey?e.moveDownNode():We(e,"next")},ArrowLeft:i=>{if(i.metaKey||i.ctrlKey)return e.initLeft();Ie(e,D.LHS)},ArrowRight:i=>{if(i.metaKey||i.ctrlKey)return e.initRight();Ie(e,D.RHS)},PageUp:()=>e.moveUpNode(),PageDown:()=>{e.moveDownNode()},c:i=>{(i.metaKey||i.ctrlKey)&&(e.waitCopy=e.currentNodes)},x:i=>{(i.metaKey||i.ctrlKey)&&(e.waitCopy=e.currentNodes,n())},v:i=>{!e.waitCopy||!e.currentNode||(i.metaKey||i.ctrlKey)&&(e.waitCopy.length===1?e.copyNode(e.waitCopy[0],e.currentNode):e.copyNodes(e.waitCopy,e.currentNode))},"=":i=>{(i.metaKey||i.ctrlKey)&&he(e,"in")},"-":i=>{(i.metaKey||i.ctrlKey)&&he(e,"out")},0:i=>{(i.metaKey||i.ctrlKey)&&e.scale(1)},Delete:n,Backspace:n,...t};e.container.onkeydown=i=>{if(i.preventDefault(),!e.editable||i.target!==i.currentTarget)return;const r=o[i.key];r&&r(i)}}function Kt(e){const{dragMoveHelper:t}=e,n=u=>{var f,a,m;if(u.button!==0)return;if((f=e.helper1)!=null&&f.moved){e.helper1.clear();return}if((a=e.helper2)!=null&&a.moved){e.helper2.clear();return}if(t.moved){t.clear();return}const v=u.target;if(v.tagName==="ME-EPD")u.ctrlKey||u.metaKey?e.expandNodeAll(v.previousSibling):e.expandNode(v.previousSibling);else if(v.tagName==="ME-TPC"&&e.currentNodes.length>1)e.selectNode(v);else if(!e.editable)return;const g=(m=v.parentElement)==null?void 0:m.parentElement;g.getAttribute("class")==="topiclinks"?e.selectArrow(v.parentElement):g.getAttribute("class")==="summary"&&e.selectSummary(v.parentElement)},o=u=>{var f;if(!e.editable)return;const a=u.target;ve(a)&&e.beginEdit(a);const m=(f=a.parentElement)==null?void 0:f.parentElement;m.getAttribute("class")==="topiclinks"?e.editArrowLabel(a.parentElement):m.getAttribute("class")==="summary"&&e.editSummary(a.parentElement)};let i=0;const r=u=>{if(u.pointerType==="mouse")return;const f=new Date().getTime(),a=f-i;a<300&&a>0&&o(u),i=f},s=u=>{t.moved=!1;const f=e.mouseSelectionButton===0?2:0;if(u.button!==f&&u.pointerType==="mouse")return;t.x=u.clientX,t.y=u.clientY;const a=u.target;a.className!=="circle"&&a.contentEditable!=="plaintext-only"&&(t.mousedown=!0,e.map.style.transition="none",a.setPointerCapture(u.pointerId))},l=u=>{if(u.target.contentEditable!=="plaintext-only"){const f=u.clientX-t.x,a=u.clientY-t.y;t.onMove(f,a)}t.x=u.clientX,t.y=u.clientY},c=u=>{const f=e.mouseSelectionButton===0?2:0;if(u.button!==f&&u.pointerType==="mouse")return;const a=u.target;a.hasPointerCapture&&a.hasPointerCapture(u.pointerId)&&a.releasePointerCapture(u.pointerId),t.clear()},h=u=>{if(u.preventDefault(),u.button!==2||!e.editable)return;const f=u.target;ve(f)&&!f.classList.contains("selected")&&e.selectNode(f),setTimeout(()=>{e.dragMoveHelper.moved||e.bus.fire("showContextMenu",u)},200)},d=u=>{u.stopPropagation(),u.preventDefault(),u.ctrlKey||u.metaKey?u.deltaY<0?he(e,"in",e.dragMoveHelper):e.scaleVal-e.scaleSensitivity>0&&he(e,"out",e.dragMoveHelper):u.shiftKey?e.move(-u.deltaY,0):(e.map.style.transition="none",e.move(-u.deltaX,-u.deltaY),e.map.style.transition="transform 0.3s")},{container:p}=e;return _e([{dom:p,evt:"pointerdown",func:s},{dom:p,evt:"pointermove",func:l},{dom:p,evt:"pointerup",func:c},{dom:p,evt:"pointerup",func:r},{dom:p,evt:"click",func:n},{dom:p,evt:"dblclick",func:o},{dom:p,evt:"contextmenu",func:h},{dom:p,evt:"wheel",func:d}])}function zt(){return{handlers:{},addListener:function(e,t){this.handlers[e]===void 0&&(this.handlers[e]=[]),this.handlers[e].push(t)},fire:function(e,...t){if(this.handlers[e]instanceof Array){const n=this.handlers[e];for(let o=0;o<n.length;o++)n[o](...t)}},removeListener:function(e,t){if(!this.handlers[e])return;const n=this.handlers[e];if(!t)n.length=0;else if(n.length)for(let o=0;o<n.length;o++)n[o]===t&&this.handlers[e].splice(o,1)}}}const ue=document,Yt=function(){this.nodes.innerHTML="";const e=this.createTopic(this.nodeData);Ne(e,this.nodeData),e.draggable=!1;const t=ue.createElement("me-root");t.appendChild(e);const n=this.nodeData.children||[];if(this.direction===2){let o=0,i=0;n.map(r=>{r.direction===0?o+=1:r.direction===1?i+=1:o<=i?(r.direction=0,o+=1):(r.direction=1,i+=1)})}qt(this,n,t)},qt=function(e,t,n){const o=ue.createElement("me-main");o.className=D.LHS;const i=ue.createElement("me-main");i.className=D.RHS;for(let r=0;r<t.length;r++){const s=t[r],{grp:l}=e.createWrapper(s);e.direction===2?s.direction===0?o.appendChild(l):i.appendChild(l):e.direction===0?o.appendChild(l):i.appendChild(l)}e.nodes.appendChild(o),e.nodes.appendChild(n),e.nodes.appendChild(i),e.nodes.appendChild(e.lines)},Ut=function(e,t){const n=ue.createElement("me-children");for(let o=0;o<t.length;o++){const i=t[o],{grp:r}=e.createWrapper(i);n.appendChild(r)}return n},T=document,st=function(e,t){const n=(this!=null&&this.el?this.el:t||document).querySelector(`[data-nodeid=me${e}]`);if(!n)throw new Error(`FindEle: Node ${e} not found, maybe it's collapsed.`);return n},Ne=function(e,t){if(e.innerHTML="",t.style){const n=t.style;for(const o in n)e.style[o]=n[o]}if(t.dangerouslySetInnerHTML){e.innerHTML=t.dangerouslySetInnerHTML;return}if(t.image){const n=t.image;if(n.url&&n.width&&n.height){const o=T.createElement("img");o.src=n.url,o.style.width=n.width+"px",o.style.height=n.height+"px",n.fit&&(o.style.objectFit=n.fit),e.appendChild(o),e.image=o}}else e.image&&(e.image=void 0);{const n=T.createElement("span");n.className="text",n.textContent=t.topic,e.appendChild(n),e.text=n}if(t.hyperLink){const n=T.createElement("a");n.className="hyper-link",n.target="_blank",n.innerText="🔗",n.href=t.hyperLink,e.appendChild(n),e.link=n}else e.link&&(e.link=void 0);if(t.icons&&t.icons.length){const n=T.createElement("span");n.className="icons",n.innerHTML=t.icons.map(o=>`<span>${ae(o)}</span>`).join(""),e.appendChild(n),e.icons=n}else e.icons&&(e.icons=void 0);if(t.tags&&t.tags.length){const n=T.createElement("div");n.className="tags",n.innerHTML=t.tags.map(o=>`<span>${ae(o)}</span>`).join(""),e.appendChild(n),e.tags=n}else e.tags&&(e.tags=void 0)},Gt=function(e,t){const n=T.createElement("me-wrapper"),{p:o,tpc:i}=this.createParent(e);if(n.appendChild(o),!t&&e.children&&e.children.length>0){const r=ke(e.expanded);if(o.appendChild(r),e.expanded!==!1){const s=Ut(this,e.children);n.appendChild(s)}}return{grp:n,top:o,tpc:i}},Xt=function(e){const t=T.createElement("me-parent"),n=this.createTopic(e);return Ne(n,e),t.appendChild(n),{p:t,tpc:n}},Jt=function(e){const t=T.createElement("me-children");return t.append(...e),t},Zt=function(e){const t=T.createElement("me-tpc");return t.nodeObj=e,t.dataset.nodeid="me"+e.id,t.draggable=this.draggable,t};function lt(e){const t=T.createRange();t.selectNodeContents(e);const n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))}const Qt=function(e){if(!e)return;const t=T.createElement("div"),n=e.text.textContent;e.appendChild(t),t.id="input-box",t.textContent=n,t.contentEditable="plaintext-only",t.spellcheck=!1;const o=getComputedStyle(e);t.style.cssText=`min-width:${e.offsetWidth-8}px;
  color:${o.color};
  padding:${o.padding};
  margin:${o.margin};
  font:${o.font};
  background-color:${o.backgroundColor!=="rgba(0, 0, 0, 0)"&&o.backgroundColor};
  border-radius:${o.borderRadius};`,this.direction===0&&(t.style.right="0"),lt(t),this.bus.fire("operation",{name:"beginEdit",obj:e.nodeObj}),t.addEventListener("keydown",i=>{i.stopPropagation();const r=i.key;if(r==="Enter"||r==="Tab"){if(i.shiftKey)return;i.preventDefault(),t.blur(),this.container.focus()}}),t.addEventListener("blur",()=>{var i;if(!t)return;const r=e.nodeObj,s=((i=t.textContent)==null?void 0:i.trim())||"";s===""?r.topic=n:r.topic=s,t.remove(),s!==n&&(e.text.textContent=r.topic,this.linkDiv(),this.bus.fire("operation",{name:"finishEdit",obj:r,origin:n}))})},ke=function(e){const t=T.createElement("me-epd");return t.expanded=e!==!1,t.className=e!==!1?"minus":"",t},Y=document,k="http://www.w3.org/2000/svg",at=function(e,t,n){const o=Y.createElementNS(k,"path");return _(o,{d:e,stroke:t||"#666",fill:"none","stroke-width":n}),o},ee=function(e){const t=Y.createElementNS(k,"svg");return t.setAttribute("class",e),t.setAttribute("overflow","visible"),t},Re=function(){const e=Y.createElementNS(k,"line");return e.setAttribute("stroke","#4dc4ff"),e.setAttribute("fill","none"),e.setAttribute("stroke-width","2"),e.setAttribute("opacity","0.45"),e},en=function(e,t,n,o){const i=Y.createElementNS(k,"g");return[{name:"line",d:e},{name:"arrow1",d:t},{name:"arrow2",d:n}].forEach((r,s)=>{const l=r.d,c=Y.createElementNS(k,"path"),h={d:l,stroke:(o==null?void 0:o.stroke)||"rgb(235, 95, 82)",fill:"none","stroke-linecap":(o==null?void 0:o.strokeLinecap)||"cap","stroke-width":String((o==null?void 0:o.strokeWidth)||"2")};(o==null?void 0:o.opacity)!==void 0&&(h.opacity=String(o.opacity)),_(c,h),s===0&&c.setAttribute("stroke-dasharray",(o==null?void 0:o.strokeDasharray)||"8,2");const d=Y.createElementNS(k,"path");_(d,{d:l,stroke:"transparent",fill:"none","stroke-width":"15"}),i.appendChild(d),i.appendChild(c),i[r.name]=c}),i},ct=function(e,t,n){if(!t)return;const o=Y.createElement("div");e.nodes.appendChild(o);const i=t.innerHTML;o.id="input-box",o.textContent=i,o.contentEditable="plaintext-only",o.spellcheck=!1;const r=t.getBBox();o.style.cssText=`
    min-width:${Math.max(88,r.width)}px;
    position:absolute;
    left:${r.x}px;
    top:${r.y}px;
    padding: 2px 4px;
    margin: -2px -4px; 
  `,lt(o),e.scrollIntoView(o),o.addEventListener("keydown",s=>{s.stopPropagation();const l=s.key;if(l==="Enter"||l==="Tab"){if(s.shiftKey)return;s.preventDefault(),o.blur(),e.container.focus()}}),o.addEventListener("blur",()=>{var s;if(!o)return;const l=((s=o.textContent)==null?void 0:s.trim())||"";l===""?n.label=i:n.label=l,o.remove(),l!==i&&(t.innerHTML=n.label,e.linkDiv(),"parent"in n?e.bus.fire("operation",{name:"finishEditSummary",obj:n}):e.bus.fire("operation",{name:"finishEditArrowLabel",obj:n}))})},tn=function(e){const t=this.map.querySelector("me-root"),n=t.offsetTop,o=t.offsetLeft,i=t.offsetWidth,r=t.offsetHeight,s=this.map.querySelectorAll("me-main > me-wrapper");this.lines.innerHTML="";for(let l=0;l<s.length;l++){const c=s[l],h=c.querySelector("me-tpc"),{offsetLeft:d,offsetTop:p}=R(this.nodes,h),u=h.offsetWidth,f=h.offsetHeight,a=c.parentNode.className,m=this.generateMainBranch({pT:n,pL:o,pW:i,pH:r,cT:p,cL:d,cW:u,cH:f,direction:a,containerHeight:this.nodes.offsetHeight}),v=this.theme.palette,g=h.nodeObj.branchColor||v[l%v.length];if(h.style.borderColor=g,this.lines.appendChild(at(m,g,"3")),e&&e!==c)continue;const y=ee("subLines"),b=c.lastChild;b.tagName==="svg"&&b.remove(),c.appendChild(y),dt(this,y,g,c,a,!0)}this.renderArrow(),this.renderSummary(),this.bus.fire("linkDiv")},dt=function(e,t,n,o,i,r){const s=o.firstChild,l=o.children[1].children;if(l.length===0)return;const c=s.offsetTop,h=s.offsetLeft,d=s.offsetWidth,p=s.offsetHeight;for(let u=0;u<l.length;u++){const f=l[u],a=f.firstChild,m=a.offsetTop,v=a.offsetLeft,g=a.offsetWidth,y=a.offsetHeight,b=a.firstChild.nodeObj.branchColor||n,S=e.generateSubBranch({pT:c,pL:h,pW:d,pH:p,cT:m,cL:v,cW:g,cH:y,direction:i,isFirst:r});t.appendChild(at(S,b,"2"));const w=a.children[1];if(w){if(!w.expanded)continue}else continue;dt(e,t,b,f,i)}},Fe={addChild:"插入子节点",addParent:"插入父节点",addSibling:"插入同级节点",removeNode:"删除节点",focus:"专注",cancelFocus:"取消专注",moveUp:"上移",moveDown:"下移",link:"连接",clickTips:"请点击目标节点",summary:"摘要"},Ve={cn:Fe,zh_CN:Fe,zh_TW:{addChild:"插入子節點",addParent:"插入父節點",addSibling:"插入同級節點",removeNode:"刪除節點",focus:"專注",cancelFocus:"取消專注",moveUp:"上移",moveDown:"下移",link:"連接",clickTips:"請點擊目標節點",summary:"摘要"},en:{addChild:"Add child",addParent:"Add parent",addSibling:"Add sibling",removeNode:"Remove node",focus:"Focus Mode",cancelFocus:"Cancel Focus Mode",moveUp:"Move up",moveDown:"Move down",link:"Link",clickTips:"Please click the target node",summary:"Summary"},ru:{addChild:"Добавить дочерний элемент",addParent:"Добавить родительский элемент",addSibling:"Добавить на этом уровне",removeNode:"Удалить узел",focus:"Режим фокусировки",cancelFocus:"Отменить режим фокусировки",moveUp:"Поднять выше",moveDown:"Опустить ниже",link:"Ссылка",clickTips:"Пожалуйста, нажмите на целевой узел",summary:"Описание"},ja:{addChild:"子ノードを追加する",addParent:"親ノードを追加します",addSibling:"兄弟ノードを追加する",removeNode:"ノードを削除",focus:"集中",cancelFocus:"集中解除",moveUp:"上へ移動",moveDown:"下へ移動",link:"コネクト",clickTips:"ターゲットノードをクリックしてください",summary:"概要"},pt:{addChild:"Adicionar item filho",addParent:"Adicionar item pai",addSibling:"Adicionar item irmao",removeNode:"Remover item",focus:"Modo Foco",cancelFocus:"Cancelar Modo Foco",moveUp:"Mover para cima",moveDown:"Mover para baixo",link:"Link",clickTips:"Favor clicar no item alvo",summary:"Resumo"},it:{addChild:"Aggiungi figlio",addParent:"Aggiungi genitore",addSibling:"Aggiungi fratello",removeNode:"Rimuovi nodo",focus:"Modalità Focus",cancelFocus:"Annulla Modalità Focus",moveUp:"Sposta su",moveDown:"Sposta giù",link:"Collega",clickTips:"Si prega di fare clic sul nodo di destinazione",summary:"Unisci nodi"},es:{addChild:"Agregar hijo",addParent:"Agregar padre",addSibling:"Agregar hermano",removeNode:"Eliminar nodo",focus:"Modo Enfoque",cancelFocus:"Cancelar Modo Enfoque",moveUp:"Mover hacia arriba",moveDown:"Mover hacia abajo",link:"Enlace",clickTips:"Por favor haga clic en el nodo de destino",summary:"Resumen"},fr:{addChild:"Ajout enfant",addParent:"Ajout parent",addSibling:"Ajout voisin",removeNode:"Supprimer",focus:"Cibler",cancelFocus:"Retour",moveUp:"Monter",moveDown:"Descendre",link:"Lier",clickTips:"Cliquer sur le noeud cible",summary:"Annoter"},ko:{addChild:"자식 추가",addParent:"부모 추가",addSibling:"형제 추가",removeNode:"노드 삭제",focus:"포커스 모드",cancelFocus:"포커스 모드 취소",moveUp:"위로 이동",moveDown:"아래로 이동",link:"연결",clickTips:"대상 노드를 클릭하십시오",summary:"요약"}};function nn(e,t){t=t===!0?{focus:!0,link:!0}:t;const n=x=>{const E=document.createElement("div");return E.innerText=x,E.className="tips",E},o=(x,E,C)=>{const N=document.createElement("li");return N.id=x,N.innerHTML=`<span>${ae(E)}</span><span ${C?'class="key"':""}>${ae(C)}</span>`,N},i=Ve[e.locale]?e.locale:"en",r=Ve[i],s=o("cm-add_child",r.addChild,"Tab"),l=o("cm-add_parent",r.addParent,"Ctrl + Enter"),c=o("cm-add_sibling",r.addSibling,"Enter"),h=o("cm-remove_child",r.removeNode,"Delete"),d=o("cm-fucus",r.focus,""),p=o("cm-unfucus",r.cancelFocus,""),u=o("cm-up",r.moveUp,"PgUp"),f=o("cm-down",r.moveDown,"Pgdn"),a=o("cm-link",r.link,""),m=o("cm-link-bidirectional","Bidirectional Link",""),v=o("cm-summary",r.summary,""),g=document.createElement("ul");if(g.className="menu-list",g.appendChild(s),g.appendChild(l),g.appendChild(c),g.appendChild(h),t.focus&&(g.appendChild(d),g.appendChild(p)),g.appendChild(u),g.appendChild(f),g.appendChild(v),t.link&&(g.appendChild(a),g.appendChild(m)),t&&t.extend)for(let x=0;x<t.extend.length;x++){const E=t.extend[x],C=o(E.name,E.name,E.key||"");g.appendChild(C),C.onclick=N=>{E.onclick(N)}}const y=document.createElement("div");y.className="context-menu",y.appendChild(g),y.hidden=!0,e.container.append(y);let b=!0;const S=x=>{const E=x.target;if(ve(E)){E.parentElement.tagName==="ME-ROOT"?b=!0:b=!1,b?(d.className="disabled",u.className="disabled",f.className="disabled",l.className="disabled",c.className="disabled",h.className="disabled"):(d.className="",u.className="",f.className="",l.className="",c.className="",h.className=""),y.hidden=!1,g.style.top="",g.style.bottom="",g.style.left="",g.style.right="";const C=g.getBoundingClientRect(),N=g.offsetHeight,j=g.offsetWidth,F=x.clientY-C.top,J=x.clientX-C.left;N+F>window.innerHeight?(g.style.top="",g.style.bottom="0px"):(g.style.bottom="",g.style.top=F+15+"px"),j+J>window.innerWidth?(g.style.left="",g.style.right="0px"):(g.style.right="",g.style.left=J+10+"px")}};e.bus.addListener("showContextMenu",S),y.onclick=x=>{x.target===y&&(y.hidden=!0)},s.onclick=()=>{e.addChild(),y.hidden=!0},l.onclick=()=>{e.insertParent(),y.hidden=!0},c.onclick=()=>{b||(e.insertSibling("after"),y.hidden=!0)},h.onclick=()=>{b||(e.removeNodes(e.currentNodes||[]),y.hidden=!0)},d.onclick=()=>{b||(e.focusNode(e.currentNode),y.hidden=!0)},p.onclick=()=>{e.cancelFocus(),y.hidden=!0},u.onclick=()=>{b||(e.moveUpNode(),y.hidden=!0)},f.onclick=()=>{b||(e.moveDownNode(),y.hidden=!0)};const w=x=>{y.hidden=!0;const E=e.currentNode,C=n(r.clickTips);e.container.appendChild(C),e.map.addEventListener("click",N=>{N.preventDefault(),C.remove();const j=N.target;(j.parentElement.tagName==="ME-PARENT"||j.parentElement.tagName==="ME-ROOT")&&e.createArrow(E,j,x)},{once:!0})};return a.onclick=()=>w(),m.onclick=()=>w({bidirectional:!0}),v.onclick=()=>{y.hidden=!0,e.createSummary(),e.unselectNodes(e.currentNodes)},()=>{s.onclick=null,l.onclick=null,c.onclick=null,h.onclick=null,d.onclick=null,p.onclick=null,u.onclick=null,f.onclick=null,a.onclick=null,v.onclick=null,y.onclick=null,e.container.oncontextmenu=null}}const ye=document,on=function(e,t){if(!t)return be(e),e;let n=e.querySelector(".insert-preview");const o=`insert-preview ${t} show`;return n||(n=ye.createElement("div"),e.appendChild(n)),n.className=o,e},be=function(e){if(!e)return;const t=e.querySelectorAll(".insert-preview");for(const n of t||[])n.remove()},Ke=function(e,t){for(const n of t){const o=n.parentElement.parentElement.contains(e);if(!(e&&e.tagName==="ME-TPC"&&e!==n&&!o&&e.nodeObj.parent))return!1}return!0},rn=function(e){const t=document.createElement("div");return t.className="mind-elixir-ghost",e.container.appendChild(t),t};class sn{constructor(t){oe(this,"mind"),oe(this,"isMoving",!1),oe(this,"interval",null),oe(this,"speed",20),this.mind=t}move(t,n){this.isMoving||(this.isMoving=!0,this.interval=setInterval(()=>{this.mind.move(t*this.speed*this.mind.scaleVal,n*this.speed*this.mind.scaleVal)},100))}stop(){this.isMoving=!1,clearInterval(this.interval)}}function ln(e){let t=null,n=null;const o=rn(e),i=new sn(e),r=c=>{e.selection.cancel();const h=c.target;if((h==null?void 0:h.tagName)!=="ME-TPC"){c.preventDefault();return}let d=e.currentNodes;d!=null&&d.includes(h)||(e.selectNode(h),d=e.currentNodes),e.dragged=d,d.length>1?o.innerHTML=d.length+"":o.innerHTML=h.innerHTML;for(const p of d)p.parentElement.parentElement.style.opacity="0.5";c.dataTransfer.setDragImage(o,0,0),c.dataTransfer.dropEffect="move",e.dragMoveHelper.clear()},s=c=>{const{dragged:h}=e;if(!h)return;i.stop();for(const p of h)p.parentElement.parentElement.style.opacity="1";const d=c.target;d.style.opacity="",n&&(be(n),t==="before"?e.moveNodeBefore(h,n):t==="after"?e.moveNodeAfter(h,n):t==="in"&&e.moveNodeIn(h,n),e.dragged=null)},l=c=>{c.preventDefault();const h=12*e.scaleVal,{dragged:d}=e;if(!d)return;const p=e.container.getBoundingClientRect();c.clientX<p.x+50?i.move(1,0):c.clientX>p.x+p.width-50?i.move(-1,0):c.clientY<p.y+50?i.move(0,1):c.clientY>p.y+p.height-50?i.move(0,-1):i.stop(),be(n);const u=ye.elementFromPoint(c.clientX,c.clientY-h);if(Ke(u,d)){n=u;const f=u.getBoundingClientRect(),a=f.y;c.clientY>a+f.height?t="after":t="in"}else{const f=ye.elementFromPoint(c.clientX,c.clientY+h),a=f.getBoundingClientRect();if(Ke(f,d)){n=f;const m=a.y;c.clientY<m?t="before":t="in"}else t=n=null}n&&on(n,t)};return _e([{dom:e.map,evt:"dragstart",func:r},{dom:e.map,evt:"dragend",func:s},{dom:e.map,evt:"dragover",func:l}])}const an=function(e){return["createSummary","removeSummary","finishEditSummary"].includes(e.name)?{type:"summary",value:e.obj.id}:["createArrow","removeArrow","finishEditArrowLabel"].includes(e.name)?{type:"arrow",value:e.obj.id}:["removeNodes","copyNodes","moveNodeBefore","moveNodeAfter","moveNodeIn"].includes(e.name)?{type:"nodes",value:e.objs.map(t=>t.id)}:{type:"node",value:e.obj.id}};function cn(e){let t=[],n=-1,o=e.getData();e.undo=function(){if(n>-1){const s=t[n];o=s.prev,e.refresh(s.prev);try{s.currentObject.type==="node"?e.selectNode(this.findEle(s.currentObject.value)):s.currentObject.type==="nodes"&&e.selectNodes(s.currentObject.value.map(l=>this.findEle(l)))}catch{}finally{n--}}},e.redo=function(){if(n<t.length-1){n++;const s=t[n];o=s.next,e.refresh(s.next),s.currentObject.type==="node"?e.selectNode(this.findEle(s.currentObject.value)):s.currentObject.type==="nodes"&&(e.unselectNodes(this.currentNodes),e.selectNodes(s.currentObject.value.map(l=>this.findEle(l))))}};const i=function(s){if(s.name==="beginEdit")return;t=t.slice(0,n+1);const l=e.getData();t.push({prev:o,currentObject:an(s),next:l}),o=l,n=t.length-1},r=function(s){(s.metaKey||s.ctrlKey)&&(s.shiftKey&&s.key==="Z"||s.key==="y")?e.redo():(s.metaKey||s.ctrlKey)&&s.key==="z"&&e.undo()};return e.bus.addListener("operation",i),e.map.addEventListener("keydown",r),()=>{e.bus.removeListener("operation",i),e.map.removeEventListener("keydown",r)}}const dn='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169394918" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2021" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M851.91168 328.45312c-59.97056 0-108.6208 48.47104-108.91264 108.36992l-137.92768 38.4a109.14304 109.14304 0 0 0-63.46752-46.58688l1.39264-137.11872c47.29344-11.86816 82.31936-54.66624 82.31936-105.64096 0-60.15488-48.76288-108.91776-108.91776-108.91776s-108.91776 48.76288-108.91776 108.91776c0 49.18784 32.60928 90.75712 77.38368 104.27392l-1.41312 138.87488a109.19936 109.19936 0 0 0-63.50336 48.55808l-138.93632-39.48544 0.01024-0.72704c0-60.15488-48.76288-108.91776-108.91776-108.91776s-108.91776 48.75776-108.91776 108.91776c0 60.15488 48.76288 108.91264 108.91776 108.91264 39.3984 0 73.91232-20.92032 93.03552-52.2496l139.19232 39.552-0.00512 0.2304c0 25.8304 9.00096 49.5616 24.02816 68.23424l-90.14272 132.63872a108.7488 108.7488 0 0 0-34.2528-5.504c-60.15488 0-108.91776 48.768-108.91776 108.91776 0 60.16 48.76288 108.91776 108.91776 108.91776 60.16 0 108.92288-48.75776 108.92288-108.91776 0-27.14624-9.9328-51.968-26.36288-71.04l89.04704-131.03104a108.544 108.544 0 0 0 37.6832 6.70208 108.672 108.672 0 0 0 36.48512-6.272l93.13792 132.57216a108.48256 108.48256 0 0 0-24.69888 69.0688c0 60.16 48.768 108.92288 108.91776 108.92288 60.16 0 108.91776-48.76288 108.91776-108.92288 0-60.14976-48.75776-108.91776-108.91776-108.91776a108.80512 108.80512 0 0 0-36.69504 6.3488l-93.07136-132.48a108.48768 108.48768 0 0 0 24.79616-72.22784l136.09984-37.888c18.99008 31.93856 53.84192 53.3504 93.69088 53.3504 60.16 0 108.92288-48.75776 108.92288-108.91264-0.00512-60.15488-48.77312-108.92288-108.92288-108.92288z" p-id="2022"></path></svg>',hn='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169375313" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1775" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M639 463.30000001L639 285.1c0-36.90000001-26.4-68.5-61.3-68.5l-150.2 0c-1.5 0-3 0.1-4.5 0.3-10.2-38.7-45.5-67.3-87.5-67.3-50 0-90.5 40.5-90.5 90.5s40.5 90.5 90.5 90.5c42 0 77.3-28.6 87.5-67.39999999 1.4 0.3 2.9 0.4 4.5 0.39999999L577.7 263.6c6.8 0 14.3 8.9 14.3 21.49999999l0 427.00000001c0 12.7-7.40000001 21.5-14.30000001 21.5l-150.19999999 0c-1.5 0-3 0.2-4.5 0.4-10.2-38.8-45.5-67.3-87.5-67.3-50 0-90.5 40.5-90.5 90.4 0 49.9 40.5 90.6 90.5 90.59999999 42 0 77.3-28.6 87.5-67.39999999 1.4 0.2 2.9 0.4 4.49999999 0.4L577.7 780.7c34.80000001 0 61.3-31.6 61.3-68.50000001L639 510.3l79.1 0c10.4 38.5 45.49999999 67 87.4 67 50 0 90.5-40.5 90.5-90.5s-40.5-90.5-90.5-90.5c-41.79999999 0-77.00000001 28.4-87.4 67L639 463.30000001z" fill="currentColor" p-id="1776"></path></svg>',un='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169667709" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3037" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M385 560.69999999L385 738.9c0 36.90000001 26.4 68.5 61.3 68.5l150.2 0c1.5 0 3-0.1 4.5-0.3 10.2 38.7 45.5 67.3 87.5 67.3 50 0 90.5-40.5 90.5-90.5s-40.5-90.5-90.5-90.5c-42 0-77.3 28.6-87.5 67.39999999-1.4-0.3-2.9-0.4-4.5-0.39999999L446.3 760.4c-6.8 0-14.3-8.9-14.3-21.49999999l0-427.00000001c0-12.7 7.40000001-21.5 14.30000001-21.5l150.19999999 0c1.5 0 3-0.2 4.5-0.4 10.2 38.8 45.5 67.3 87.5 67.3 50 0 90.5-40.5 90.5-90.4 0-49.9-40.5-90.6-90.5-90.59999999-42 0-77.3 28.6-87.5 67.39999999-1.4-0.2-2.9-0.4-4.49999999-0.4L446.3 243.3c-34.80000001 0-61.3 31.6-61.3 68.50000001L385 513.7l-79.1 0c-10.4-38.5-45.49999999-67-87.4-67-50 0-90.5 40.5-90.5 90.5s40.5 90.5 90.5 90.5c41.79999999 0 77.00000001-28.4 87.4-67L385 560.69999999z" fill="currentColor" p-id="3038"></path></svg>',pn='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169402629" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2170" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M639.328 416c8.032 0 16.096-3.008 22.304-9.056l202.624-197.184-0.8 143.808c-0.096 17.696 14.144 32.096 31.808 32.192 0.064 0 0.128 0 0.192 0 17.6 0 31.904-14.208 32-31.808l1.248-222.208c0-0.672-0.352-1.248-0.384-1.92 0.032-0.512 0.288-0.896 0.288-1.408 0.032-17.664-14.272-32-31.968-32.032L671.552 96l-0.032 0c-17.664 0-31.968 14.304-32 31.968C639.488 145.632 653.824 160 671.488 160l151.872 0.224-206.368 200.8c-12.672 12.32-12.928 32.608-0.64 45.248C622.656 412.736 630.976 416 639.328 416z" p-id="2171"></path><path d="M896.032 639.552 896.032 639.552c-17.696 0-32 14.304-32.032 31.968l-0.224 151.872-200.832-206.4c-12.32-12.64-32.576-12.96-45.248-0.64-12.672 12.352-12.928 32.608-0.64 45.248l197.184 202.624-143.808-0.8c-0.064 0-0.128 0-0.192 0-17.6 0-31.904 14.208-32 31.808-0.096 17.696 14.144 32.096 31.808 32.192l222.24 1.248c0.064 0 0.128 0 0.192 0 0.64 0 1.12-0.32 1.76-0.352 0.512 0.032 0.896 0.288 1.408 0.288l0.032 0c17.664 0 31.968-14.304 32-31.968L928 671.584C928.032 653.952 913.728 639.584 896.032 639.552z" p-id="2172"></path><path d="M209.76 159.744l143.808 0.8c0.064 0 0.128 0 0.192 0 17.6 0 31.904-14.208 32-31.808 0.096-17.696-14.144-32.096-31.808-32.192L131.68 95.328c-0.064 0-0.128 0-0.192 0-0.672 0-1.248 0.352-1.888 0.384-0.448 0-0.8-0.256-1.248-0.256 0 0-0.032 0-0.032 0-17.664 0-31.968 14.304-32 31.968L96 352.448c-0.032 17.664 14.272 32 31.968 32.032 0 0 0.032 0 0.032 0 17.664 0 31.968-14.304 32-31.968l0.224-151.936 200.832 206.4c6.272 6.464 14.624 9.696 22.944 9.696 8.032 0 16.096-3.008 22.304-9.056 12.672-12.32 12.96-32.608 0.64-45.248L209.76 159.744z" p-id="2173"></path><path d="M362.368 617.056l-202.624 197.184 0.8-143.808c0.096-17.696-14.144-32.096-31.808-32.192-0.064 0-0.128 0-0.192 0-17.6 0-31.904 14.208-32 31.808l-1.248 222.24c0 0.704 0.352 1.312 0.384 2.016 0 0.448-0.256 0.832-0.256 1.312-0.032 17.664 14.272 32 31.968 32.032L352.448 928c0 0 0.032 0 0.032 0 17.664 0 31.968-14.304 32-31.968s-14.272-32-31.968-32.032l-151.936-0.224 206.4-200.832c12.672-12.352 12.96-32.608 0.64-45.248S375.008 604.704 362.368 617.056z" p-id="2174"></path></svg>',fn='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169573443" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2883" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M514.133333 488.533333m-106.666666 0a106.666667 106.666667 0 1 0 213.333333 0 106.666667 106.666667 0 1 0-213.333333 0Z" fill="currentColor" p-id="2884"></path><path d="M512 64C264.533333 64 64 264.533333 64 512c0 236.8 183.466667 428.8 416 445.866667v-134.4c-53.333333-59.733333-200.533333-230.4-200.533333-334.933334 0-130.133333 104.533333-234.666667 234.666666-234.666666s234.666667 104.533333 234.666667 234.666666c0 61.866667-49.066667 153.6-145.066667 270.933334l-59.733333 68.266666V960C776.533333 942.933333 960 748.8 960 512c0-247.466667-200.533333-448-448-448z" fill="currentColor" p-id="2885"></path></svg>',mn='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169419447" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2480" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M863.328 482.56l-317.344-1.12L545.984 162.816c0-17.664-14.336-32-32-32s-32 14.336-32 32l0 318.4L159.616 480.064c-0.032 0-0.064 0-0.096 0-17.632 0-31.936 14.24-32 31.904C127.424 529.632 141.728 544 159.392 544.064l322.592 1.152 0 319.168c0 17.696 14.336 32 32 32s32-14.304 32-32l0-318.944 317.088 1.12c0.064 0 0.096 0 0.128 0 17.632 0 31.936-14.24 32-31.904C895.264 496.992 880.96 482.624 863.328 482.56z" p-id="2481"></path></svg>',gn='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1750169426515" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2730" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M863.744 544 163.424 544c-17.664 0-32-14.336-32-32s14.336-32 32-32l700.32 0c17.696 0 32 14.336 32 32S881.44 544 863.744 544z" p-id="2731"></path></svg>',vn={side:dn,left:hn,right:un,full:pn,living:fn,zoomin:mn,zoomout:gn},z=(e,t)=>{const n=document.createElement("span");return n.id=e,n.innerHTML=vn[t],n};function yn(e){const t=document.createElement("div"),n=z("fullscreen","full"),o=z("toCenter","living"),i=z("zoomout","zoomout"),r=z("zoomin","zoomin"),s=document.createElement("span");return s.innerText="100%",t.appendChild(n),t.appendChild(o),t.appendChild(i),t.appendChild(r),t.className="mind-elixir-toolbar rb",n.onclick=()=>{document.fullscreenElement===e.el?document.exitFullscreen():e.el.requestFullscreen()},o.onclick=()=>{e.toCenter()},i.onclick=()=>{e.scaleVal<.6||e.scale(e.scaleVal-e.scaleSensitivity)},r.onclick=()=>{e.scaleVal>1.6||e.scale(e.scaleVal+e.scaleSensitivity)},t}function bn(e){const t=document.createElement("div"),n=z("tbltl","left"),o=z("tbltr","right"),i=z("tblts","side");return t.appendChild(n),t.appendChild(o),t.appendChild(i),t.className="mind-elixir-toolbar lt",n.onclick=()=>{e.initLeft()},o.onclick=()=>{e.initRight()},i.onclick=()=>{e.initSide()},t}function wn(e){e.container.append(yn(e)),e.container.append(bn(e))}/*! @viselect/vanilla v3.9.0 MIT | https://github.com/Simonwep/selection/tree/master/packages/vanilla */class xn{constructor(){this._listeners=new Map,this.on=this.addEventListener,this.off=this.removeEventListener,this.emit=this.dispatchEvent}addEventListener(t,n){const o=this._listeners.get(t)??new Set;return this._listeners.set(t,o),o.add(n),this}removeEventListener(t,n){var o;return(o=this._listeners.get(t))==null||o.delete(n),this}dispatchEvent(t,...n){let o=!0;for(const i of this._listeners.get(t)??[])o=i(...n)!==!1&&o;return o}unbindAllListeners(){this._listeners.clear()}}const ze=(e,t="px")=>typeof e=="number"?e+t:e,P=({style:e},t,n)=>{if(typeof t=="object")for(const[o,i]of Object.entries(t))i!==void 0&&(e[o]=ze(i));else n!==void 0&&(e[t]=ze(n))},Ye=(e=0,t=0,n=0,o=0)=>{const i={x:e,y:t,width:n,height:o,top:t,left:e,right:e+n,bottom:t+o};return{...i,toJSON:()=>JSON.stringify(i)}},En=e=>{let t,n=-1,o=!1;return{next:(...i)=>{t=i,o||(o=!0,n=requestAnimationFrame(()=>{e(...t),o=!1}))},cancel:()=>{cancelAnimationFrame(n),o=!1}}},qe=(e,t,n="touch")=>{switch(n){case"center":{const o=t.left+t.width/2,i=t.top+t.height/2;return o>=e.left&&o<=e.right&&i>=e.top&&i<=e.bottom}case"cover":return t.left>=e.left&&t.top>=e.top&&t.right<=e.right&&t.bottom<=e.bottom;case"touch":return e.right>=t.left&&e.left<=t.right&&e.bottom>=t.top&&e.top<=t.bottom}},Sn=()=>matchMedia("(hover: none), (pointer: coarse)").matches,Cn=()=>"safari"in window,we=e=>Array.isArray(e)?e:[e],ht=e=>(t,n,o,i={})=>{(t instanceof HTMLCollection||t instanceof NodeList)&&(t=Array.from(t)),n=we(n),t=we(t);for(const r of t)if(r)for(const s of n)r[e](s,o,{capture:!1,...i})},H=ht("addEventListener"),M=ht("removeEventListener"),ie=e=>{var t;const{clientX:n,clientY:o,target:i}=((t=e.touches)==null?void 0:t[0])??e;return{x:n,y:o,target:i}},U=(e,t=document)=>we(e).map(n=>typeof n=="string"?Array.from(t.querySelectorAll(n)):n instanceof Element?n:null).flat().filter(Boolean),_n=(e,t)=>t.some(n=>typeof n=="number"?e.button===n:typeof n=="object"?n.button!==e.button?!1:n.modifiers.every(o=>{switch(o){case"alt":return e.altKey;case"ctrl":return e.ctrlKey||e.metaKey;case"shift":return e.shiftKey}}):!1),{abs:K,max:Ue,min:Ge,ceil:Xe}=Math,Je=(e=[])=>({stored:e,selected:[],touched:[],changed:{added:[],removed:[]}}),ut=class extends xn{constructor(e){var t,n,o,i,r;super(),this._selection=Je(),this._targetBoundaryScrolled=!0,this._selectables=[],this._areaLocation={y1:0,x2:0,y2:0,x1:0},this._areaRect=Ye(),this._singleClick=!0,this._scrollAvailable=!0,this._scrollingActive=!1,this._scrollSpeed={x:0,y:0},this._scrollDelta={x:0,y:0},this._lastMousePosition={x:0,y:0},this.enable=this._toggleStartEvents,this.disable=this._toggleStartEvents.bind(this,!1),this._options={selectionAreaClass:"selection-area",selectionContainerClass:void 0,selectables:[],document:window.document,startAreas:["html"],boundaries:["html"],container:"body",...e,behaviour:{overlap:"invert",intersect:"touch",triggers:[0],...e.behaviour,startThreshold:(t=e.behaviour)!=null&&t.startThreshold?typeof e.behaviour.startThreshold=="number"?e.behaviour.startThreshold:{x:10,y:10,...e.behaviour.startThreshold}:{x:10,y:10},scrolling:{speedDivider:10,manualSpeed:750,...(n=e.behaviour)==null?void 0:n.scrolling,startScrollMargins:{x:0,y:0,...(i=(o=e.behaviour)==null?void 0:o.scrolling)==null?void 0:i.startScrollMargins}}},features:{range:!0,touch:!0,deselectOnBlur:!1,...e.features,singleTap:{allow:!0,intersect:"native",...(r=e.features)==null?void 0:r.singleTap}}};for(const h of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))typeof this[h]=="function"&&(this[h]=this[h].bind(this));const{document:s,selectionAreaClass:l,selectionContainerClass:c}=this._options;this._area=s.createElement("div"),this._clippingElement=s.createElement("div"),this._clippingElement.appendChild(this._area),this._area.classList.add(l),c&&this._clippingElement.classList.add(c),P(this._area,{willChange:"top, left, bottom, right, width, height",top:0,left:0,position:"fixed"}),P(this._clippingElement,{overflow:"hidden",position:"fixed",transform:"translate3d(0, 0, 0)",pointerEvents:"none",zIndex:"1"}),this._frame=En(h=>{this._recalculateSelectionAreaRect(),this._updateElementSelection(),this._emitEvent("move",h),this._redrawSelectionArea()}),this.enable()}_toggleStartEvents(e=!0){const{document:t,features:n}=this._options,o=e?H:M;o(t,"mousedown",this._onTapStart),n.touch&&o(t,"touchstart",this._onTapStart,{passive:!1})}_onTapStart(e,t=!1){const{x:n,y:o,target:i}=ie(e),{document:r,startAreas:s,boundaries:l,features:c,behaviour:h}=this._options,d=i.getBoundingClientRect();if(e instanceof MouseEvent&&!_n(e,h.triggers))return;const p=U(s,r),u=U(l,r);this._targetElement=u.find(v=>qe(v.getBoundingClientRect(),d));const f=e.composedPath(),a=p.find(v=>f.includes(v));if(this._targetBoundary=u.find(v=>f.includes(v)),!this._targetElement||!a||!this._targetBoundary||!t&&this._emitEvent("beforestart",e)===!1)return;this._areaLocation={x1:n,y1:o,x2:0,y2:0};const m=r.scrollingElement??r.body;this._scrollDelta={x:m.scrollLeft,y:m.scrollTop},this._singleClick=!0,this.clearSelection(!1,!0),H(r,["touchmove","mousemove"],this._delayedTapMove,{passive:!1}),H(r,["mouseup","touchcancel","touchend"],this._onTapStop),H(r,"scroll",this._onScroll),c.deselectOnBlur&&(this._targetBoundaryScrolled=!1,H(this._targetBoundary,"scroll",this._onStartAreaScroll))}_onSingleTap(e){const{singleTap:{intersect:t},range:n}=this._options.features,o=ie(e);let i;if(t==="native")i=o.target;else if(t==="touch"){this.resolveSelectables();const{x:s,y:l}=o;i=this._selectables.find(c=>{const{right:h,left:d,top:p,bottom:u}=c.getBoundingClientRect();return s<h&&s>d&&l<u&&l>p})}if(!i)return;for(this.resolveSelectables();!this._selectables.includes(i);)if(i.parentElement)i=i.parentElement;else{this._targetBoundaryScrolled||this.clearSelection();return}const{stored:r}=this._selection;if(this._emitEvent("start",e),e.shiftKey&&n&&this._latestElement){const s=this._latestElement,[l,c]=s.compareDocumentPosition(i)&4?[i,s]:[s,i],h=[...this._selectables.filter(d=>d.compareDocumentPosition(l)&4&&d.compareDocumentPosition(c)&2),l,c];this.select(h),this._latestElement=s}else r.includes(i)&&(r.length===1||e.ctrlKey||r.every(s=>this._selection.stored.includes(s)))?this.deselect(i):(this.select(i),this._latestElement=i)}_delayedTapMove(e){const{container:t,document:n,behaviour:{startThreshold:o}}=this._options,{x1:i,y1:r}=this._areaLocation,{x:s,y:l}=ie(e);if(typeof o=="number"&&K(s+l-(i+r))>=o||typeof o=="object"&&K(s-i)>=o.x||K(l-r)>=o.y){if(M(n,["mousemove","touchmove"],this._delayedTapMove,{passive:!1}),this._emitEvent("beforedrag",e)===!1){M(n,["mouseup","touchcancel","touchend"],this._onTapStop);return}H(n,["mousemove","touchmove"],this._onTapMove,{passive:!1}),P(this._area,"display","block"),U(t,n)[0].appendChild(this._clippingElement),this.resolveSelectables(),this._singleClick=!1,this._targetRect=this._targetElement.getBoundingClientRect(),this._scrollAvailable=this._targetElement.scrollHeight!==this._targetElement.clientHeight||this._targetElement.scrollWidth!==this._targetElement.clientWidth,this._scrollAvailable&&(H(this._targetElement,"wheel",this._wheelScroll,{passive:!1}),H(this._options.document,"keydown",this._keyboardScroll,{passive:!1}),this._selectables=this._selectables.filter(c=>this._targetElement.contains(c))),this._setupSelectionArea(),this._emitEvent("start",e),this._onTapMove(e)}this._handleMoveEvent(e)}_setupSelectionArea(){const{_clippingElement:e,_targetElement:t,_area:n}=this,o=this._targetRect=t.getBoundingClientRect();this._scrollAvailable?(P(e,{top:o.top,left:o.left,width:o.width,height:o.height}),P(n,{marginTop:-o.top,marginLeft:-o.left})):(P(e,{top:0,left:0,width:"100%",height:"100%"}),P(n,{marginTop:0,marginLeft:0}))}_onTapMove(e){const{_scrollSpeed:t,_areaLocation:n,_options:o,_frame:i}=this,{speedDivider:r}=o.behaviour.scrolling,s=this._targetElement,{x:l,y:c}=ie(e);if(n.x2=l,n.y2=c,this._lastMousePosition.x=l,this._lastMousePosition.y=c,this._scrollAvailable&&!this._scrollingActive&&(t.y||t.x)){this._scrollingActive=!0;const h=()=>{if(!t.x&&!t.y){this._scrollingActive=!1;return}const{scrollTop:d,scrollLeft:p}=s;t.y&&(s.scrollTop+=Xe(t.y/r),n.y1-=s.scrollTop-d),t.x&&(s.scrollLeft+=Xe(t.x/r),n.x1-=s.scrollLeft-p),i.next(e),requestAnimationFrame(h)};requestAnimationFrame(h)}else i.next(e);this._handleMoveEvent(e)}_handleMoveEvent(e){const{features:t}=this._options;(t.touch&&Sn()||this._scrollAvailable&&Cn())&&e.preventDefault()}_onScroll(){const{_scrollDelta:e,_options:{document:t}}=this,{scrollTop:n,scrollLeft:o}=t.scrollingElement??t.body;this._areaLocation.x1+=e.x-o,this._areaLocation.y1+=e.y-n,e.x=o,e.y=n,this._setupSelectionArea(),this._frame.next(null)}_onStartAreaScroll(){this._targetBoundaryScrolled=!0,M(this._targetElement,"scroll",this._onStartAreaScroll)}_wheelScroll(e){const{manualSpeed:t}=this._options.behaviour.scrolling,n=e.deltaY?e.deltaY>0?1:-1:0,o=e.deltaX?e.deltaX>0?1:-1:0;this._scrollSpeed.y+=n*t,this._scrollSpeed.x+=o*t,this._onTapMove(e),e.preventDefault()}_keyboardScroll(e){const{manualSpeed:t}=this._options.behaviour.scrolling,n=e.key==="ArrowLeft"?-1:e.key==="ArrowRight"?1:0,o=e.key==="ArrowUp"?-1:e.key==="ArrowDown"?1:0;this._scrollSpeed.x+=Math.sign(n)*t,this._scrollSpeed.y+=Math.sign(o)*t,e.preventDefault(),this._onTapMove({clientX:this._lastMousePosition.x,clientY:this._lastMousePosition.y,preventDefault:()=>{}})}_recalculateSelectionAreaRect(){const{_scrollSpeed:e,_areaLocation:t,_targetElement:n,_options:o}=this,{scrollTop:i,scrollHeight:r,clientHeight:s,scrollLeft:l,scrollWidth:c,clientWidth:h}=n,d=this._targetRect,{x1:p,y1:u}=t;let{x2:f,y2:a}=t;const{behaviour:{scrolling:{startScrollMargins:m}}}=o;f<d.left+m.x?(e.x=l?-K(d.left-f+m.x):0,f=f<d.left?d.left:f):f>d.right-m.x?(e.x=c-l-h?K(d.left+d.width-f-m.x):0,f=f>d.right?d.right:f):e.x=0,a<d.top+m.y?(e.y=i?-K(d.top-a+m.y):0,a=a<d.top?d.top:a):a>d.bottom-m.y?(e.y=r-i-s?K(d.top+d.height-a-m.y):0,a=a>d.bottom?d.bottom:a):e.y=0;const v=Ge(p,f),g=Ge(u,a),y=Ue(p,f),b=Ue(u,a);this._areaRect=Ye(v,g,y-v,b-g)}_redrawSelectionArea(){const{x:e,y:t,width:n,height:o}=this._areaRect,{style:i}=this._area;i.left=`${e}px`,i.top=`${t}px`,i.width=`${n}px`,i.height=`${o}px`}_onTapStop(e,t){var n;const{document:o,features:i}=this._options,{_singleClick:r}=this;M(this._targetElement,"scroll",this._onStartAreaScroll),M(o,["mousemove","touchmove"],this._delayedTapMove),M(o,["touchmove","mousemove"],this._onTapMove),M(o,["mouseup","touchcancel","touchend"],this._onTapStop),M(o,"scroll",this._onScroll),this._keepSelection(),e&&r&&i.singleTap.allow?this._onSingleTap(e):!r&&!t&&(this._updateElementSelection(),this._emitEvent("stop",e)),this._scrollSpeed.x=0,this._scrollSpeed.y=0,M(this._targetElement,"wheel",this._wheelScroll,{passive:!0}),M(this._options.document,"keydown",this._keyboardScroll,{passive:!0}),this._clippingElement.remove(),(n=this._frame)==null||n.cancel(),P(this._area,"display","none")}_updateElementSelection(){const{_selectables:e,_options:t,_selection:n,_areaRect:o}=this,{stored:i,selected:r,touched:s}=n,{intersect:l,overlap:c}=t.behaviour,h=c==="invert",d=[],p=[],u=[];for(let a=0;a<e.length;a++){const m=e[a];if(qe(o,m.getBoundingClientRect(),l)){if(r.includes(m))i.includes(m)&&!s.includes(m)&&s.push(m);else if(h&&i.includes(m)){u.push(m);continue}else p.push(m);d.push(m)}}h&&p.push(...i.filter(a=>!r.includes(a)));const f=c==="keep";for(let a=0;a<r.length;a++){const m=r[a];!d.includes(m)&&!(f&&i.includes(m))&&u.push(m)}n.selected=d,n.changed={added:p,removed:u},this._latestElement=void 0}_emitEvent(e,t){return this.emit(e,{event:t,store:this._selection,selection:this})}_keepSelection(){const{_options:e,_selection:t}=this,{selected:n,changed:o,touched:i,stored:r}=t,s=n.filter(l=>!r.includes(l));switch(e.behaviour.overlap){case"drop":{t.stored=[...s,...r.filter(l=>!i.includes(l))];break}case"invert":{t.stored=[...s,...r.filter(l=>!o.removed.includes(l))];break}case"keep":{t.stored=[...r,...n.filter(l=>!r.includes(l))];break}}}trigger(e,t=!0){this._onTapStart(e,t)}resolveSelectables(){this._selectables=U(this._options.selectables,this._options.document)}clearSelection(e=!0,t=!1){const{selected:n,stored:o,changed:i}=this._selection;i.added=[],i.removed.push(...n,...e?o:[]),t||(this._emitEvent("move",null),this._emitEvent("stop",null)),this._selection=Je(e?[]:o)}getSelection(){return this._selection.stored}getSelectionArea(){return this._area}getSelectables(){return this._selectables}setAreaLocation(e){Object.assign(this._areaLocation,e),this._redrawSelectionArea()}getAreaLocation(){return this._areaLocation}cancel(e=!1){this._onTapStop(null,!e)}destroy(){this.cancel(),this.disable(),this._clippingElement.remove(),super.unbindAllListeners()}select(e,t=!1){const{changed:n,selected:o,stored:i}=this._selection,r=U(e,this._options.document).filter(s=>!o.includes(s)&&!i.includes(s));return i.push(...r),o.push(...r),n.added.push(...r),n.removed=[],this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null)),r}deselect(e,t=!1){const{selected:n,stored:o,changed:i}=this._selection,r=U(e,this._options.document).filter(s=>n.includes(s)||o.includes(s));this._selection.stored=o.filter(s=>!r.includes(s)),this._selection.selected=n.filter(s=>!r.includes(s)),this._selection.changed.added=[],this._selection.changed.removed.push(...r.filter(s=>!i.removed.includes(s))),this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null))}};ut.version="3.9.0";let Nn=ut;function kn(e){const t=e.mouseSelectionButton===2?[2]:[0],n=new Nn({selectables:[".map-container me-tpc"],boundaries:[e.container],container:e.selectionContainer,features:{touch:!1},behaviour:{triggers:t,scrolling:{speedDivider:10,manualSpeed:750,startScrollMargins:{x:10,y:10}}}}).on("beforestart",({event:o})=>{var i;const r=o.target;if(r.id==="input-box"||r.className==="circle"||(i=e.container.querySelector(".context-menu"))!=null&&i.contains(r))return!1;if(!o.ctrlKey&&!o.metaKey){if(r.tagName==="ME-TPC"&&r.classList.contains("selected"))return!1;e.clearSelection()}const s=n.getSelectionArea();return s.style.background="#4f90f22d",s.style.border="1px solid #4f90f2",s.parentElement&&(s.parentElement.style.zIndex="9999"),!0}).on("move",({store:{changed:{added:o,removed:i}}})=>{if(o.length>0||i.length>0,o.length>0){for(const r of o)r.className="selected";e.currentNodes=[...e.currentNodes,...o],e.bus.fire("selectNodes",o.map(r=>r.nodeObj))}if(i.length>0){for(const r of i)r.classList.remove("selected");e.currentNodes=e.currentNodes.filter(r=>!(i!=null&&i.includes(r))),e.bus.fire("unselectNodes",i.map(r=>r.nodeObj))}});e.selection=n}const Ln=function(e,t=!0){this.theme=e;const n={...(e.type==="dark"?Ee:xe).cssVar,...e.cssVar},o=Object.keys(n);for(let i=0;i<o.length;i++){const r=o[i];this.container.style.setProperty(r,n[r])}t&&this.refresh()},X=e=>{var t;const n=(t=e.parent)==null?void 0:t.children,o=(n==null?void 0:n.indexOf(e))??0;return{siblings:n,index:o}};function Tn(e){const{siblings:t,index:n}=X(e);if(t===void 0)return;const o=t[n];n===0?(t[n]=t[t.length-1],t[t.length-1]=o):(t[n]=t[n-1],t[n-1]=o)}function An(e){const{siblings:t,index:n}=X(e);if(t===void 0)return;const o=t[n];n===t.length-1?(t[n]=t[0],t[0]=o):(t[n]=t[n+1],t[n+1]=o)}function pt(e){const{siblings:t,index:n}=X(e);return t===void 0?0:(t.splice(n,1),t.length)}function Mn(e,t,n){const{siblings:o,index:i}=X(n);o!==void 0&&(t==="before"?o.splice(i,0,e):o.splice(i+1,0,e))}function Dn(e,t){const{siblings:n,index:o}=X(e);n!==void 0&&(n[o]=t,t.children=[e])}function ft(e,t,n){var o;if(pt(t),(o=n.parent)!=null&&o.parent||(t.direction=n.direction),e==="in")n.children?n.children.push(t):n.children=[t];else{t.direction!==void 0&&(t.direction=n.direction);const{siblings:i,index:r}=X(n);if(i===void 0)return;e==="before"?i.splice(r,0,t):i.splice(r+1,0,t)}}const jn=function({map:e,direction:t},n){var o,i;if(t===0)return 0;if(t===1)return 1;if(t===2){const r=((o=e.querySelector(".lhs"))==null?void 0:o.childElementCount)||0,s=((i=e.querySelector(".rhs"))==null?void 0:i.childElementCount)||0;return r<=s?(n.direction=0,0):(n.direction=1,1)}},mt=function(e,t,n){var o,i;const r=n.children[0].children[0],s=t.parentElement;if(s.tagName==="ME-PARENT"){if(te(r),s.children[1])s.nextSibling.appendChild(n);else{const l=e.createChildren([n]);s.appendChild(ke(!0)),s.insertAdjacentElement("afterend",l)}e.linkDiv(n.offsetParent)}else s.tagName==="ME-ROOT"&&(jn(e,r.nodeObj)===0?(o=e.container.querySelector(".lhs"))==null||o.appendChild(n):(i=e.container.querySelector(".rhs"))==null||i.appendChild(n),e.linkDiv())},$n=function(e,t){const n=e.parentNode;if(t===0){const o=n.parentNode.parentNode;o.tagName!=="ME-MAIN"&&(o.previousSibling.children[1].remove(),o.remove())}n.parentNode.remove()},gt={before:"beforebegin",after:"afterend"},te=function(e){const t=e.parentElement.parentElement.lastElementChild;(t==null?void 0:t.tagName)==="svg"&&(t==null||t.remove())},On=function(e,t){const n=e.nodeObj,o=Ce(n);o.style&&t.style&&(t.style=Object.assign(o.style,t.style));const i=Object.assign(n,t);Ne(e,i),this.linkDiv(),this.bus.fire("operation",{name:"reshapeNode",obj:i,origin:o})},Le=function(e,t,n){if(!t)return null;const o=t.nodeObj;o.expanded===!1&&(e.expandNode(t,!0),t=e.findEle(o.id));const i=n||e.generateNewObj();o.children?o.children.push(i):o.children=[i],W(e.nodeData);const{grp:r,top:s}=e.createWrapper(i);return mt(e,t,r),{newTop:s,newNodeObj:i}},Pn=function(e,t,n){var o,i,r,s;const l=t||this.currentNode;if(!l)return;const c=l.nodeObj;if(c.parent){if(!((o=c.parent)!=null&&o.parent)&&((r=(i=c.parent)==null?void 0:i.children)==null?void 0:r.length)===1&&this.direction===2){this.addChild(this.findEle(c.parent.id),n);return}}else{this.addChild();return}const h=n||this.generateNewObj();if(!((s=c.parent)!=null&&s.parent)){const f=l.closest("me-main").className===D.LHS?0:1;h.direction=f}Mn(h,e,c),W(this.nodeData);const d=l.parentElement,{grp:p,top:u}=this.createWrapper(h);d.parentElement.insertAdjacentElement(gt[e],p),this.linkDiv(p.offsetParent),n||this.editTopic(u.firstChild),this.selectNode(u.firstChild,!0),this.bus.fire("operation",{name:"insertSibling",type:e,obj:h})},Hn=function(e,t){const n=e||this.currentNode;if(!n)return;te(n);const o=n.nodeObj;if(!o.parent)return;const i=t||this.generateNewObj();Dn(o,i),W(this.nodeData);const r=n.parentElement.parentElement,{grp:s,top:l}=this.createWrapper(i,!0);l.appendChild(ke(!0)),r.insertAdjacentElement("afterend",s);const c=this.createChildren([r]);l.insertAdjacentElement("afterend",c),this.linkDiv(),t||this.editTopic(l.firstChild),this.selectNode(l.firstChild,!0),this.bus.fire("operation",{name:"insertParent",obj:i})},Bn=function(e,t){const n=e||this.currentNode;if(!n)return;const o=Le(this,n,t);if(!o)return;const{newTop:i,newNodeObj:r}=o;this.bus.fire("operation",{name:"addChild",obj:r}),t||this.editTopic(i.firstChild),this.selectNode(i.firstChild,!0)},In=function(e,t){const n=Ce(e.nodeObj);Se(n);const o=Le(this,t,n);if(!o)return;const{newNodeObj:i}=o;this.selectNode(this.findEle(i.id)),this.bus.fire("operation",{name:"copyNode",obj:i})},Wn=function(e,t){e=fe(e);const n=[];for(let o=0;o<e.length;o++){const i=e[o],r=Ce(i.nodeObj);Se(r);const s=Le(this,t,r);if(!s)return;const{newNodeObj:l}=s;n.push(l)}this.unselectNodes(this.currentNodes),this.selectNodes(n.map(o=>this.findEle(o.id))),this.bus.fire("operation",{name:"copyNodes",objs:n})},Rn=function(e){const t=e||this.currentNode;if(!t)return;const n=t.nodeObj;Tn(n);const o=t.parentNode.parentNode;o.parentNode.insertBefore(o,o.previousSibling),this.linkDiv(),this.bus.fire("operation",{name:"moveUpNode",obj:n})},Fn=function(e){const t=e||this.currentNode;if(!t)return;const n=t.nodeObj;An(n);const o=t.parentNode.parentNode;o.nextSibling?o.nextSibling.insertAdjacentElement("afterend",o):o.parentNode.prepend(o),this.linkDiv(),this.bus.fire("operation",{name:"moveDownNode",obj:n})},Vn=function(e){if(e.length===0)return;e=fe(e);for(const n of e){const o=n.nodeObj,i=pt(o);$n(n,i)}const t=e[e.length-1];this.selectNode(this.findEle(t.nodeObj.parent.id)),this.linkDiv(),this.bus.fire("operation",{name:"removeNodes",objs:e.map(n=>n.nodeObj)})},Kn=function(e,t){e=fe(e);const n=t.nodeObj;n.expanded===!1&&(this.expandNode(t,!0),t=this.findEle(n.id));for(const o of e){const i=o.nodeObj;ft("in",i,n),W(this.nodeData);const r=o.parentElement;mt(this,t,r.parentElement)}this.linkDiv(),this.bus.fire("operation",{name:"moveNodeIn",objs:e.map(o=>o.nodeObj),toObj:n})},vt=(e,t,n,o)=>{e=fe(e),t==="after"&&(e=e.reverse());const i=n.nodeObj,r=[];for(const s of e){const l=s.nodeObj;ft(t,l,i),W(o.nodeData),te(s);const c=s.parentElement.parentNode;r.includes(c.parentElement)||r.push(c.parentElement),n.parentElement.parentNode.insertAdjacentElement(gt[t],c)}for(const s of r)s.childElementCount===0&&s.tagName!=="ME-MAIN"&&(s.previousSibling.children[1].remove(),s.remove());o.linkDiv(),o.bus.fire("operation",{name:t==="before"?"moveNodeBefore":"moveNodeAfter",objs:e.map(s=>s.nodeObj),toObj:i})},zn=function(e,t){vt(e,"before",t,this)},Yn=function(e,t){vt(e,"after",t,this)},qn=function(e){const t=e||this.currentNode;t&&(t.nodeObj.dangerouslySetInnerHTML||this.editTopic(t))},Un=function(e,t){e.text.textContent=t,e.nodeObj.topic=t,this.linkDiv()},yt=Object.freeze(Object.defineProperty({__proto__:null,addChild:Bn,beginEdit:qn,copyNode:In,copyNodes:Wn,insertParent:Hn,insertSibling:Pn,moveDownNode:Fn,moveNodeAfter:Yn,moveNodeBefore:zn,moveNodeIn:Kn,moveUpNode:Rn,removeNodes:Vn,reshapeNode:On,rmSubline:te,setNodeTopic:Un},Symbol.toStringTag,{value:"Module"}));function Gn(e){return{nodeData:e.isFocusMode?e.nodeDataBackup:e.nodeData,arrows:e.arrows,summaries:e.summaries,direction:e.direction,theme:e.theme}}const Xn=function(e){const t=this.container,n=e.getBoundingClientRect(),o=t.getBoundingClientRect();if(n.top>o.bottom||n.bottom<o.top||n.left>o.right||n.right<o.left){const i=n.left+n.width/2,r=n.top+n.height/2,s=o.left+o.width/2,l=o.top+o.height/2,c=i-s,h=r-l;this.move(-c,-h)}},Jn=function(e,t,n){this.clearSelection(),this.scrollIntoView(e),this.selection.select(e),t&&this.bus.fire("selectNewNode",e.nodeObj)},Zn=function(e){this.selection.select(e)},Qn=function(e){this.selection.deselect(e)},eo=function(){this.unselectNodes(this.currentNodes),this.unselectSummary(),this.unselectArrow()},to=function(){const e=Gn(this);return JSON.stringify(e,(t,n)=>{if(!(t==="parent"&&typeof n!="string"))return n})},no=function(){return JSON.parse(this.getDataString())},oo=function(){this.editable=!0},io=function(){this.editable=!1},ro=function(e,t={x:0,y:0}){const n=this.container.getBoundingClientRect(),o=t.x?t.x-n.left-n.width/2:0,i=t.y?t.y-n.top-n.height/2:0,{dx:r,dy:s}=bt(this),l=this.map.style.transform,{x:c,y:h}=rt(l),d=c-r,p=h-s,u=this.scaleVal,f=(-o+d)*(1-e/u),a=(-i+p)*(1-e/u);this.map.style.transform=`translate(${c-f}px, ${h-a}px) scale(${e})`,this.scaleVal=e,this.bus.fire("scale",e)},so=function(){const e=this.nodes.offsetHeight/this.container.offsetHeight,t=this.nodes.offsetWidth/this.container.offsetWidth,n=1/Math.max(1,Math.max(e,t));this.scaleVal=n,this.map.style.transform="scale("+n+")",this.bus.fire("scale",n)},lo=function(e,t){const{map:n,scaleVal:o,bus:i}=this,r=n.style.transform;let{x:s,y:l}=rt(r);s+=e,l+=t,n.style.transform=`translate(${s}px, ${l}px) scale(${o})`,i.fire("move",{dx:e,dy:t})},bt=e=>{const{container:t,map:n,nodes:o}=e,i=n.querySelector("me-root"),r=i.offsetTop,s=i.offsetLeft,l=i.offsetWidth,c=i.offsetHeight;let h,d;return e.alignment==="root"?(h=t.offsetWidth/2-s-l/2,d=t.offsetHeight/2-r-c/2,n.style.transformOrigin=`${s+l/2}px 50%`):(h=(t.offsetWidth-o.offsetWidth)/2,d=(t.offsetHeight-o.offsetHeight)/2,n.style.transformOrigin="50% 50%"),{dx:h,dy:d}},ao=function(){const{map:e}=this,{dx:t,dy:n}=bt(this);e.style.transform=`translate(${t}px, ${n}px) scale(${this.scaleVal})`},co=function(e){e(this)},ho=function(e){e.nodeObj.parent&&(this.clearSelection(),this.tempDirection===null&&(this.tempDirection=this.direction),this.isFocusMode||(this.nodeDataBackup=this.nodeData,this.isFocusMode=!0),this.nodeData=e.nodeObj,this.initRight(),this.toCenter())},uo=function(){this.isFocusMode=!1,this.tempDirection!==null&&(this.nodeData=this.nodeDataBackup,this.direction=this.tempDirection,this.tempDirection=null,this.refresh(),this.toCenter())},po=function(){this.direction=0,this.refresh(),this.toCenter()},fo=function(){this.direction=1,this.refresh(),this.toCenter()},mo=function(){this.direction=2,this.refresh(),this.toCenter()},go=function(e){this.locale=e,this.refresh()},vo=function(e,t){const n=e.nodeObj;typeof t=="boolean"?n.expanded=t:n.expanded!==!1?n.expanded=!1:n.expanded=!0;const o=e.parentNode,i=o.children[1];if(i.expanded=n.expanded,i.className=n.expanded?"minus":"",te(e),n.expanded){const l=this.createChildren(n.children.map(c=>this.createWrapper(c).grp));o.parentNode.appendChild(l)}else o.parentNode.children[1].remove();this.linkDiv(e.closest("me-main > me-wrapper"));const r=e.getBoundingClientRect(),s=this.container.getBoundingClientRect();(r.bottom>s.bottom||r.top<s.top||r.right>s.right||r.left<s.left)&&this.scrollIntoView(e),this.bus.fire("expandNode",n)},yo=function(e,t){const n=e.nodeObj,o=(i,r)=>{i.expanded=r,i.children&&i.children.forEach(s=>{o(s,r)})};typeof t=="boolean"?o(n,t):n.expanded!==!1?o(n,!1):o(n,!0),this.refresh()},bo=function(e){e&&(e=JSON.parse(JSON.stringify(e)),this.nodeData=e.nodeData,this.arrows=e.arrows||[],this.summaries=e.summaries||[]),W(this.nodeData),this.layout(),this.linkDiv()},wo=Object.freeze(Object.defineProperty({__proto__:null,cancelFocus:uo,clearSelection:eo,disableEdit:io,enableEdit:oo,expandNode:vo,expandNodeAll:yo,focusNode:ho,getData:no,getDataString:to,initLeft:po,initRight:fo,initSide:mo,install:co,move:lo,refresh:bo,scale:ro,scaleFit:so,scrollIntoView:Xn,selectNode:Jn,selectNodes:Zn,setLocale:go,toCenter:ao,unselectNodes:Qn},Symbol.toStringTag,{value:"Module"})),xo=function(e){return{dom:e,moved:!1,pointerdown:!1,lastX:0,lastY:0,handlePointerMove(t){if(this.pointerdown){this.moved=!0;const n=t.clientX-this.lastX,o=t.clientY-this.lastY;this.lastX=t.clientX,this.lastY=t.clientY,this.cb&&this.cb(n,o)}},handlePointerDown(t){t.button===0&&(this.pointerdown=!0,this.lastX=t.clientX,this.lastY=t.clientY,this.dom.setPointerCapture(t.pointerId))},handleClear(t){this.pointerdown=!1,t.pointerId!==void 0&&this.dom.releasePointerCapture(t.pointerId)},cb:null,init(t,n){this.cb=n,this.handleClear=this.handleClear.bind(this),this.handlePointerMove=this.handlePointerMove.bind(this),this.handlePointerDown=this.handlePointerDown.bind(this),this.destroy=_e([{dom:t,evt:"pointermove",func:this.handlePointerMove},{dom:t,evt:"pointerleave",func:this.handleClear},{dom:t,evt:"pointerup",func:this.handleClear},{dom:this.dom,evt:"pointerdown",func:this.handlePointerDown}])},destroy:null,clear(){this.moved=!1,this.pointerdown=!1}}},Ze={create:xo},Eo="#4dc4ff";function wt(e,t,n,o,i,r,s,l){return{x:e/8+n*3/8+i*3/8+s/8,y:t/8+o*3/8+r*3/8+l/8}}function So(e,t,n){_(e,{x:t+"",y:n+""})}function re(e,t,n,o,i){_(e,{x1:t+"",y1:n+"",x2:o+"",y2:i+""})}function Qe(e,t,n,o,i,r,s,l,c,h){var d;if(e.line.setAttribute("d",`M ${t} ${n} C ${o} ${i} ${r} ${s} ${l} ${c}`),h.style){const a=h.style;a.stroke&&e.line.setAttribute("stroke",a.stroke),a.strokeWidth&&e.line.setAttribute("stroke-width",String(a.strokeWidth)),a.strokeDasharray&&e.line.setAttribute("stroke-dasharray",a.strokeDasharray),a.strokeLinecap&&e.line.setAttribute("stroke-linecap",a.strokeLinecap),a.opacity!==void 0&&e.line.setAttribute("opacity",String(a.opacity))}const p=de(r,s,l,c);if(p&&(e.arrow1.setAttribute("d",`M ${p.x1} ${p.y1} L ${l} ${c} L ${p.x2} ${p.y2}`),h.style)){const a=h.style;a.stroke&&e.arrow1.setAttribute("stroke",a.stroke),a.strokeWidth&&e.arrow1.setAttribute("stroke-width",String(a.strokeWidth)),a.strokeLinecap&&e.arrow1.setAttribute("stroke-linecap",a.strokeLinecap),a.opacity!==void 0&&e.arrow1.setAttribute("opacity",String(a.opacity))}if(h.bidirectional){const a=de(o,i,t,n);if(a&&(e.arrow2.setAttribute("d",`M ${a.x1} ${a.y1} L ${t} ${n} L ${a.x2} ${a.y2}`),h.style)){const m=h.style;m.stroke&&e.arrow2.setAttribute("stroke",m.stroke),m.strokeWidth&&e.arrow2.setAttribute("stroke-width",String(m.strokeWidth)),m.strokeLinecap&&e.arrow2.setAttribute("stroke-linecap",m.strokeLinecap),m.opacity!==void 0&&e.arrow2.setAttribute("opacity",String(m.opacity))}}const{x:u,y:f}=wt(t,n,o,i,r,s,l,c);So(e.label,u,f),(d=h.style)!=null&&d.labelColor&&e.label.setAttribute("fill",h.style.labelColor),Do(e)}function pe(e,t,n){const{offsetLeft:o,offsetTop:i}=R(e.nodes,t),r=t.offsetWidth,s=t.offsetHeight,l=o+r/2,c=i+s/2,h=l+n.x,d=c+n.y;return{w:r,h:s,cx:l,cy:c,ctrlX:h,ctrlY:d}}function G(e){let t,n;const o=(e.cy-e.ctrlY)/(e.ctrlX-e.cx);return o>e.h/e.w||o<-e.h/e.w?e.cy-e.ctrlY<0?(t=e.cx-e.h/2/o,n=e.cy+e.h/2):(t=e.cx+e.h/2/o,n=e.cy-e.h/2):e.cx-e.ctrlX<0?(t=e.cx+e.w/2,n=e.cy-e.w*o/2):(t=e.cx-e.w/2,n=e.cy+e.w*o/2),{x:t,y:n}}const Co=function(e,t,n,o){const i=document.createElementNS(k,"text");return _(i,{"text-anchor":"middle",x:t+"",y:n+"",fill:o||"rgb(235, 95, 82)"}),i.dataset.type="custom-link",i.innerHTML=e,i},Te=function(e,t,n,o,i){var r;if(!t||!n)return;const s=pe(e,t,o.delta1),l=pe(e,n,o.delta2),{x:c,y:h}=G(s),{ctrlX:d,ctrlY:p}=s,{ctrlX:u,ctrlY:f}=l,{x:a,y:m}=G(l),v=de(u,f,a,m);if(!v)return;const g=`M ${v.x1} ${v.y1} L ${a} ${m} L ${v.x2} ${v.y2}`;let y="";if(o.bidirectional){const C=de(d,p,c,h);if(!C)return;y=`M ${C.x1} ${C.y1} L ${c} ${h} L ${C.x2} ${C.y2}`}const b=en(`M ${c} ${h} C ${d} ${p} ${u} ${f} ${a} ${m}`,g,y,o.style),{x:S,y:w}=wt(c,h,d,p,u,f,a,m),x=(r=o.style)==null?void 0:r.labelColor,E=Co(o.label,S,w,x);b.appendChild(E),b.label=E,b.arrowObj=o,b.dataset.linkid=o.id,e.linkSvgGroup.appendChild(b),i||(e.arrows.push(o),e.currentArrow=b,xt(e,o,s,l))},_o=function(e,t,n={}){const o={id:q(),label:"Custom Link",from:e.nodeObj.id,to:t.nodeObj.id,delta1:{x:e.offsetWidth/2+100,y:0},delta2:{x:t.offsetWidth/2+100,y:0},...n};Te(this,e,t,o),this.bus.fire("operation",{name:"createArrow",obj:o})},No=function(e){const t={...e,id:q()};Te(this,this.findEle(t.from),this.findEle(t.to),t),this.bus.fire("operation",{name:"createArrow",obj:t})},ko=function(e){let t;if(e?t=e:t=this.currentArrow,!t)return;Ae(this);const n=t.arrowObj.id;this.arrows=this.arrows.filter(o=>o.id!==n),t.remove(),this.bus.fire("operation",{name:"removeArrow",obj:{id:n}})},Lo=function(e){this.currentArrow=e;const t=e.arrowObj,n=this.findEle(t.from),o=this.findEle(t.to),i=pe(this,n,t.delta1),r=pe(this,o,t.delta2);xt(this,t,i,r)},To=function(){Ae(this),this.currentArrow=null},ge=function(e,t){const n=document.createElementNS(k,"path");return _(n,{d:e,stroke:t,fill:"none","stroke-width":"6","stroke-linecap":"round","stroke-linejoin":"round"}),n},Ao=function(e,t){const n=document.createElementNS(k,"g");n.setAttribute("class","arrow-highlight"),n.setAttribute("opacity","0.45");const o=ge(e.line.getAttribute("d"),t);n.appendChild(o);const i=ge(e.arrow1.getAttribute("d"),t);if(n.appendChild(i),e.arrow2.getAttribute("d")){const r=ge(e.arrow2.getAttribute("d"),t);n.appendChild(r)}e.insertBefore(n,e.firstChild)},Mo=function(e){const t=e.querySelector(".arrow-highlight");t&&t.remove()},Do=function(e){const t=e.querySelector(".arrow-highlight");if(!t)return;const n=t.querySelectorAll("path");n.length>=1&&n[0].setAttribute("d",e.line.getAttribute("d")),n.length>=2&&n[1].setAttribute("d",e.arrow1.getAttribute("d")),n.length>=3&&e.arrow2.getAttribute("d")&&n[2].setAttribute("d",e.arrow2.getAttribute("d"))},Ae=function(e){var t,n;(t=e.helper1)==null||t.destroy(),(n=e.helper2)==null||n.destroy(),e.linkController.style.display="none",e.P2.style.display="none",e.P3.style.display="none",e.currentArrow&&Mo(e.currentArrow)},xt=function(e,t,n,o){const{linkController:i,P2:r,P3:s,line1:l,line2:c,nodes:h,map:d,currentArrow:p,bus:u}=e;if(!p)return;i.style.display="initial",r.style.display="initial",s.style.display="initial",h.appendChild(i),h.appendChild(r),h.appendChild(s),Ao(p,Eo);let{x:f,y:a}=G(n),{ctrlX:m,ctrlY:v}=n,{ctrlX:g,ctrlY:y}=o,{x:b,y:S}=G(o);r.style.cssText=`top:${v}px;left:${m}px;`,s.style.cssText=`top:${y}px;left:${g}px;`,re(l,f,a,m,v),re(c,g,y,b,S),e.helper1=Ze.create(r),e.helper2=Ze.create(s),e.helper1.init(d,(w,x)=>{m=m+w/e.scaleVal,v=v+x/e.scaleVal;const E=G({...n,ctrlX:m,ctrlY:v});f=E.x,a=E.y,r.style.top=v+"px",r.style.left=m+"px",Qe(p,f,a,m,v,g,y,b,S,t),re(l,f,a,m,v),t.delta1.x=m-n.cx,t.delta1.y=v-n.cy,u.fire("updateArrowDelta",t)}),e.helper2.init(d,(w,x)=>{g=g+w/e.scaleVal,y=y+x/e.scaleVal;const E=G({...o,ctrlX:g,ctrlY:y});b=E.x,S=E.y,s.style.top=y+"px",s.style.left=g+"px",Qe(p,f,a,m,v,g,y,b,S,t),re(c,g,y,b,S),t.delta2.x=g-o.cx,t.delta2.y=y-o.cy,u.fire("updateArrowDelta",t)})};function jo(){this.linkSvgGroup.innerHTML="";for(let e=0;e<this.arrows.length;e++){const t=this.arrows[e];try{Te(this,this.findEle(t.from),this.findEle(t.to),t,!0)}catch{}}this.nodes.appendChild(this.linkSvgGroup)}function $o(e){if(Ae(this),!e)return;const t=e.label;ct(this,t,e.arrowObj)}function Oo(){this.arrows=this.arrows.filter(e=>ce(e.from,this.nodeData)&&ce(e.to,this.nodeData))}const Po=Object.freeze(Object.defineProperty({__proto__:null,createArrow:_o,createArrowFrom:No,editArrowLabel:$o,removeArrow:ko,renderArrow:jo,selectArrow:Lo,tidyArrow:Oo,unselectArrow:To},Symbol.toStringTag,{value:"Module"})),Ho=function(e){var t,n;if(e.length===0)throw new Error("No selected node.");if(e.length===1){const d=e[0].nodeObj,p=e[0].nodeObj.parent;if(!p)throw new Error("Can not select root node.");const u=p.children.findIndex(f=>d===f);return{parent:p.id,start:u,end:u}}let o=0;const i=e.map(d=>{let p=d.nodeObj;const u=[];for(;p.parent;){const f=p.parent,a=f.children,m=a==null?void 0:a.indexOf(p);p=f,u.unshift({node:p,index:m})}return u.length>o&&(o=u.length),u});let r=0;e:for(;r<o;r++){const d=(t=i[0][r])==null?void 0:t.node;for(let p=1;p<i.length;p++)if(((n=i[p][r])==null?void 0:n.node)!==d)break e}if(!r)throw new Error("Can not select root node.");const s=i.map(d=>d[r-1].index).sort(),l=s[0]||0,c=s[s.length-1]||0,h=i[0][r-1].node;if(!h.parent)throw new Error("Please select nodes in the same main topic.");return{parent:h.id,start:l,end:c}},Bo=function(e){const t=document.createElementNS(k,"g");return t.setAttribute("id",e),t},et=function(e,t){const n=document.createElementNS(k,"path");return _(n,{d:e,stroke:t||"#666",fill:"none","stroke-linecap":"round","stroke-width":"2"}),n},tt=function(e,t,n,o,i){const r=document.createElementNS(k,"text");return _(r,{"text-anchor":o,x:t+"",y:n+"",fill:i||"#666"}),r.innerHTML=e,r},Io=e=>e.parentElement.parentElement,Wo=function(e,{parent:t,start:n}){const o=e.findEle(t),i=o.nodeObj;let r;return i.parent?r=o.closest("me-main").className:r=e.findEle(i.children[n].id).closest("me-main").className,r},Me=function(e,t){var n;const{id:o,label:i,parent:r,start:s,end:l}=t,{nodes:c,theme:h,summarySvg:d}=e,p=e.findEle(r).nodeObj,u=Wo(e,t);let f=1/0,a=0,m=0,v=0;for(let C=s;C<=l;C++){const N=(n=p.children)==null?void 0:n[C];if(!N)return e.removeSummary(o),null;const j=Io(e.findEle(N.id)),{offsetLeft:F,offsetTop:J}=R(c,j),De=s===l?10:20;C===s&&(m=J+De),C===l&&(v=J+j.offsetHeight-De),F<f&&(f=F),j.offsetWidth+F>a&&(a=j.offsetWidth+F)}let g,y;const b=m+10,S=v+10,w=(b+S)/2,x=h.cssVar["--color"];u===D.LHS?(g=et(`M ${f+10} ${b} c -5 0 -10 5 -10 10 L ${f} ${S-10} c 0 5 5 10 10 10 M ${f} ${w} h -10`,x),y=tt(i,f-20,w+6,"end",x)):(g=et(`M ${a-10} ${b} c 5 0 10 5 10 10 L ${a} ${S-10} c 0 5 -5 10 -10 10 M ${a} ${w} h 10`,x),y=tt(i,a+20,w+6,"start",x));const E=Bo("s-"+o);return E.appendChild(g),E.appendChild(y),E.summaryObj=t,d.appendChild(E),E},Ro=function(){if(!this.currentNodes)return;const{currentNodes:e,summaries:t,bus:n}=this,{parent:o,start:i,end:r}=Ho(e),s={id:q(),parent:o,start:i,end:r,label:"summary"},l=Me(this,s);t.push(s),this.editSummary(l),n.fire("operation",{name:"createSummary",obj:s})},Fo=function(e){const t=q(),n={...e,id:t};Me(this,n),this.summaries.push(n),this.bus.fire("operation",{name:"createSummary",obj:n})},Vo=function(e){var t;const n=this.summaries.findIndex(o=>o.id===e);n>-1&&(this.summaries.splice(n,1),(t=document.querySelector("#s-"+e))==null||t.remove()),this.bus.fire("operation",{name:"removeSummary",obj:{id:e}})},Ko=function(e){const t=e.children[1].getBBox(),n=6,o=3,i=document.createElementNS(k,"rect");_(i,{x:t.x-n+"",y:t.y-n+"",width:t.width+n*2+"",height:t.height+n*2+"",rx:o+"",stroke:this.theme.cssVar["--selected"]||"#4dc4ff","stroke-width":"2",fill:"none"}),e.appendChild(i),this.currentSummary=e},zo=function(){var e,t;(t=(e=this.currentSummary)==null?void 0:e.querySelector("rect"))==null||t.remove(),this.currentSummary=null},Yo=function(){this.summarySvg.innerHTML="",this.summaries.forEach(e=>{try{Me(this,e)}catch{}}),this.nodes.insertAdjacentElement("beforeend",this.summarySvg)},qo=function(e){if(!e)return;const t=e.childNodes[1];ct(this,t,e.summaryObj)},Uo=Object.freeze(Object.defineProperty({__proto__:null,createSummary:Ro,createSummaryFrom:Fo,editSummary:qo,removeSummary:Vo,renderSummary:Yo,selectSummary:Ko,unselectSummary:zo},Symbol.toStringTag,{value:"Module"})),L="http://www.w3.org/2000/svg";function Go(e,t){const n=document.createElementNS(L,"svg");return _(n,{version:"1.1",xmlns:L,height:e,width:t}),n}function Xo(e,t){return(parseInt(e)-parseInt(t))/2}function Jo(e,t,n,o){const i=document.createElementNS(L,"g");let r="";return e.text?r=e.text.textContent:r=e.childNodes[0].textContent,r.split(`
`).forEach((s,l)=>{const c=document.createElementNS(L,"text");_(c,{x:n+parseInt(t.paddingLeft)+"",y:o+parseInt(t.paddingTop)+Xo(t.lineHeight,t.fontSize)*(l+1)+parseFloat(t.fontSize)*(l+1)+"","text-anchor":"start","font-family":t.fontFamily,"font-size":`${t.fontSize}`,"font-weight":`${t.fontWeight}`,fill:`${t.color}`}),c.innerHTML=s,i.appendChild(c)}),i}function Zo(e,t,n,o){var i;let r="";(i=e.nodeObj)!=null&&i.dangerouslySetInnerHTML?r=e.nodeObj.dangerouslySetInnerHTML:e.text?r=e.text.textContent:r=e.childNodes[0].textContent;const s=document.createElementNS(L,"foreignObject");_(s,{x:n+parseInt(t.paddingLeft)+"",y:o+parseInt(t.paddingTop)+"",width:t.width,height:t.height});const l=document.createElement("div");return _(l,{xmlns:"http://www.w3.org/1999/xhtml",style:`font-family: ${t.fontFamily}; font-size: ${t.fontSize}; font-weight: ${t.fontWeight}; color: ${t.color}; white-space: pre-wrap;`}),l.innerHTML=r,s.appendChild(l),s}function Qo(e,t){const n=getComputedStyle(t),{offsetLeft:o,offsetTop:i}=R(e.nodes,t),r=document.createElementNS(L,"rect");return _(r,{x:o+"",y:i+"",rx:n.borderRadius,ry:n.borderRadius,width:n.width,height:n.height,fill:n.backgroundColor,stroke:n.borderColor,"stroke-width":n.borderWidth}),r}function se(e,t,n=!1){const o=getComputedStyle(t),{offsetLeft:i,offsetTop:r}=R(e.nodes,t),s=document.createElementNS(L,"rect");_(s,{x:i+"",y:r+"",rx:o.borderRadius,ry:o.borderRadius,width:o.width,height:o.height,fill:o.backgroundColor,stroke:o.borderColor,"stroke-width":o.borderWidth});const l=document.createElementNS(L,"g");l.appendChild(s);let c;return n?c=Zo(t,o,i,r):c=Jo(t,o,i,r),l.appendChild(c),l}function ei(e,t){const n=getComputedStyle(t),{offsetLeft:o,offsetTop:i}=R(e.nodes,t),r=document.createElementNS(L,"a"),s=document.createElementNS(L,"text");return _(s,{x:o+"",y:i+parseInt(n.fontSize)+"","text-anchor":"start","font-family":n.fontFamily,"font-size":`${n.fontSize}`,"font-weight":`${n.fontWeight}`,fill:`${n.color}`}),s.innerHTML=t.textContent,r.appendChild(s),r.setAttribute("href",t.href),r}function ti(e,t){const n=getComputedStyle(t),{offsetLeft:o,offsetTop:i}=R(e.nodes,t),r=document.createElementNS(L,"image");return _(r,{x:o+"",y:i+"",width:n.width+"",height:n.height+"",href:t.src}),r}const le=100,ni='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',oi=(e,t=!1)=>{var n,o,i;const r=e.nodes,s=r.offsetHeight+le*2,l=r.offsetWidth+le*2,c=Go(s+"px",l+"px"),h=document.createElementNS(L,"svg"),d=document.createElementNS(L,"rect");_(d,{x:"0",y:"0",width:`${l}`,height:`${s}`,fill:e.theme.cssVar["--bgcolor"]}),c.appendChild(d),r.querySelectorAll(".subLines").forEach(a=>{const m=a.cloneNode(!0),{offsetLeft:v,offsetTop:g}=R(r,a.parentElement);m.setAttribute("x",`${v}`),m.setAttribute("y",`${g}`),h.appendChild(m)});const p=(n=r.querySelector(".lines"))==null?void 0:n.cloneNode(!0);p&&h.appendChild(p);const u=(o=r.querySelector(".topiclinks"))==null?void 0:o.cloneNode(!0);u&&h.appendChild(u);const f=(i=r.querySelector(".summary"))==null?void 0:i.cloneNode(!0);return f&&h.appendChild(f),r.querySelectorAll("me-tpc").forEach(a=>{a.nodeObj.dangerouslySetInnerHTML?h.appendChild(se(e,a,!t)):(h.appendChild(Qo(e,a)),h.appendChild(se(e,a.text,!t)))}),r.querySelectorAll(".tags > span").forEach(a=>{h.appendChild(se(e,a))}),r.querySelectorAll(".icons > span").forEach(a=>{h.appendChild(se(e,a))}),r.querySelectorAll(".hyper-link").forEach(a=>{h.appendChild(ei(e,a))}),r.querySelectorAll("img").forEach(a=>{h.appendChild(ti(e,a))}),_(h,{x:le+"",y:le+"",overflow:"visible"}),c.appendChild(h),c},ii=(e,t)=>(t&&e.insertAdjacentHTML("afterbegin","<style>"+t+"</style>"),ni+e.outerHTML);function ri(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=i=>{t(i.target.result)},o.onerror=i=>{n(i)},o.readAsDataURL(e)})}const si=function(e=!1,t){const n=oi(this,e),o=ii(n,t);return new Blob([o],{type:"image/svg+xml"})},li=async function(e=!1,t){const n=this.exportSvg(e,t),o=await ri(n);return new Promise((i,r)=>{const s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=()=>{const l=document.createElement("canvas");l.width=s.width,l.height=s.height,l.getContext("2d").drawImage(s,0,0),l.toBlob(i,"image/png",1)},s.src=o,s.onerror=r})},ai=Object.freeze(Object.defineProperty({__proto__:null,exportPng:li,exportSvg:si},Symbol.toStringTag,{value:"Module"}));function ci(e,t){return async function(...n){const o=this.before[t];o&&!await o.apply(this,n)||e.apply(this,n)}}const nt=Object.keys(yt),Et={};for(let e=0;e<nt.length;e++){const t=nt[e];Et[t]=ci(yt[t],t)}const di={getObjById:ce,generateNewObj:Ht,layout:Yt,linkDiv:tn,editTopic:Qt,createWrapper:Gt,createParent:Xt,createChildren:Jt,createTopic:Zt,findEle:st,changeTheme:Ln,...wo,...Et,...Po,...Uo,...ai,init(e){if(e=JSON.parse(JSON.stringify(e)),!e||!e.nodeData)return new Error("MindElixir: `data` is required");e.direction!==void 0&&(this.direction=e.direction),this.changeTheme(e.theme||this.theme,!1),this.nodeData=e.nodeData,W(this.nodeData),this.arrows=e.arrows||[],this.summaries=e.summaries||[],this.tidyArrow(),this.toolBar&&wn(this),this.keypress&&Vt(this,this.keypress),this.editable&&kn(this),this.contextMenu&&this.disposable.push(nn(this,this.contextMenu)),this.draggable&&this.disposable.push(ln(this)),this.allowUndo&&this.disposable.push(cn(this)),this.layout(),this.linkDiv(),this.toCenter()},destroy(){var e;this.disposable.forEach(t=>t()),this.el&&(this.el.innerHTML=""),this.el=void 0,this.nodeData=void 0,this.arrows=void 0,this.summaries=void 0,this.currentArrow=void 0,this.currentNodes=void 0,this.currentSummary=void 0,this.waitCopy=void 0,this.theme=void 0,this.direction=void 0,this.bus=void 0,this.container=void 0,this.map=void 0,this.lines=void 0,this.linkController=void 0,this.linkSvgGroup=void 0,this.P2=void 0,this.P3=void 0,this.line1=void 0,this.line2=void 0,this.nodes=void 0,(e=this.selection)==null||e.destroy(),this.selection=void 0}};function hi({pT:e,pL:t,pW:n,pH:o,cT:i,cL:r,cW:s,cH:l,direction:c,containerHeight:h}){let d=t+n/2;const p=e+o/2;let u;c===D.LHS?u=r+s:u=r;const f=i+l/2,a=(1-Math.abs(f-p)/h)*.25*(n/2);return c===D.LHS?d=d-n/10-a:d=d+n/10+a,`M ${d} ${p} Q ${d} ${f} ${u} ${f}`}function ui({pT:e,pL:t,pW:n,pH:o,cT:i,cL:r,cW:s,cH:l,direction:c,isFirst:h}){const d=parseInt(this.container.style.getPropertyValue("--node-gap-x"));let p=0,u=0;h?p=e+o/2:p=e+o;const f=i+l;let a=0,m=0,v=0;const g=Math.abs(p-f)/300*d;return c===D.LHS?(v=t,a=v+d,m=v-d,u=r+d,`M ${a} ${p} C ${v} ${p} ${v+g} ${f} ${m} ${f} H ${u}`):(v=t+n,a=v-d,m=v+d,u=r+s-d,`M ${a} ${p} C ${v} ${p} ${v-g} ${f} ${m} ${f} H ${u}`)}const pi="5.0.1";function fi(e){return{x:0,y:0,moved:!1,mousedown:!1,onMove(t,n){this.mousedown&&(this.moved=!0,e.move(t,n))},clear(){this.mousedown=!1,e.map.style.transition="transform 0.3s"}}}const Q=document;function A({el:e,direction:t,locale:n,draggable:o,editable:i,contextMenu:r,toolBar:s,keypress:l,mouseSelectionButton:c,selectionContainer:h,before:d,newTopicName:p,allowUndo:u,generateMainBranch:f,generateSubBranch:a,overflowHidden:m,theme:v,alignment:g,scaleSensitivity:y}){let b=null;const S=Object.prototype.toString.call(e);if(S==="[object HTMLDivElement]"?b=e:S==="[object String]"&&(b=document.querySelector(e)),!b)throw new Error("MindElixir: el is not a valid element");b.style.position="relative",b.innerHTML="",this.el=b,this.disposable=[],this.before=d||{},this.locale=n||"en",this.contextMenu=r===void 0?!0:r,this.toolBar=s===void 0?!0:s,this.keypress=l===void 0?!0:l,this.mouseSelectionButton=c||0,this.direction=typeof t=="number"?t:1,this.draggable=o===void 0?!0:o,this.newTopicName=p||"new node",this.editable=i===void 0?!0:i,this.allowUndo=u===void 0?!1:u,this.scaleSensitivity=typeof y=="number"?y:.2,this.currentNodes=[],this.currentArrow=null,this.scaleVal=1,this.tempDirection=null,this.generateMainBranch=f||hi,this.generateSubBranch=a||ui,this.overflowHidden=m||!1,this.dragMoveHelper=fi(this),this.bus=zt(),this.container=Q.createElement("div"),this.selectionContainer=h||this.container,this.container.className="map-container";const w=window.matchMedia("(prefers-color-scheme: dark)");this.theme=v||(w.matches?Ee:xe);const x=Q.createElement("div");x.className="map-canvas",setTimeout(()=>{x.style.transition="all 0.3s"},300),this.map=x,this.container.setAttribute("tabindex","0"),this.container.appendChild(this.map),this.el.appendChild(this.container),this.nodes=Q.createElement("me-nodes"),this.lines=ee("lines"),this.summarySvg=ee("summary"),this.linkController=ee("linkcontroller"),this.P2=Q.createElement("div"),this.P3=Q.createElement("div"),this.P2.className=this.P3.className="circle",this.P2.style.display=this.P3.style.display="none",this.line1=Re(),this.line2=Re(),this.linkController.appendChild(this.line1),this.linkController.appendChild(this.line2),this.linkSvgGroup=ee("topiclinks"),this.alignment=g??"root",this.map.appendChild(this.nodes),this.overflowHidden?this.container.style.overflow="hidden":this.disposable.push(Kt(this))}A.prototype=di;Object.defineProperty(A.prototype,"currentNode",{get(){return this.currentNodes[this.currentNodes.length-1]},enumerable:!0});A.LEFT=0;A.RIGHT=1;A.SIDE=2;A.THEME=xe;A.DARK_THEME=Ee;A.version=pi;A.E=st;A.new=e=>({nodeData:{id:q(),topic:e||"new topic",children:[]}});const mi={class:"mindmap-container"},gi={__name:"NoteChart",props:{videoId:String},emits:["loaded"],setup(e,{emit:t}){const n=t,o=e,i=O(null),r=O(!0),s=O(null);it(async()=>{try{const d=await Nt(o.videoId);if(console.log("拿到的知识树的数据:",d),!d||d.code!==200||!d.nodeData)throw new Error("获取知识树数据失败");const p=new A({el:"#map",direction:A.LEFT,draggable:!0,contextMenu:!0,toolBar:!0,nodeMenu:!0,keypress:!0,initScale:.5,nodeStyle:{icon:{margin:"0 4px"}}});i.value=p,p.init({nodeData:d.nodeData,linkData:{}}),p.bus.addListener("layout",()=>{l()}),window.addEventListener("resize",h),n("loaded")}catch(d){console.error("初始化思维导图失败:",d),s.value=d.message}finally{r.value=!1}});const l=()=>{if(i.value)try{i.value.fit(),i.value.scale(.7);const d=document.getElementById("map");if(d){const p=d.clientHeight,u=i.value.viewBox.height*.7,f=Math.max(20,(p-u)/2);i.value.relocate(20,f)}}catch(d){console.error("调整思维导图时出错:",d)}};let c=null;const h=()=>{clearTimeout(c),c=setTimeout(()=>{l()},200)};return At(()=>{window.removeEventListener("resize",h),c&&clearTimeout(c)}),(d,p)=>(I(),B("div",mi,p[0]||(p[0]=[$("div",{id:"map"},null,-1)])))}},vi=ot(gi,[["__scopeId","data-v-e9f12a38"]]),yi={class:"note-layout"},bi={class:"notes-container"},wi={id:"directory"},xi={class:"directory-list"},Ei=["onClick"],Si={id:"notes"},Ci=["id"],_i={key:0},Ni={key:1},ki={class:"export-container"},Li={__name:"LectureNotes",props:{videoId:String},setup(e){const t=e,n=O([]),o=O([]),i=O(!1),r=O(!0),s=O(!1),l=O(!1),c=Dt();let h=null;const d=()=>{c.back()};it(async()=>{h=Be.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{console.log("笔记中拿到的videoId:",t.videoId);const g=await kt(t.videoId);console.log("拿到的接口的数据:",g),g.code===200?(n.value=g.notes,o.value=g.directory,m()):console.error("请求返回失败",g.message)}catch(g){console.error("生成笔记错误",g)}});const p=async()=>{let g=null;try{g=Be.service({lock:!0,text:"正在生成Word文档...",background:"rgba(0, 0, 0, 0.7)"});const y=await Tt(t.videoId),b=y instanceof Blob?y:new Blob([y],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),S=window.URL.createObjectURL(b),w=document.createElement("a");w.href=S,w.download=`视频${t.videoId}笔记.docx`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(S),document.body.removeChild(w),je.success("导出Word文档成功")}catch(y){console.error("导出失败:",y),je.error("导出Word文档失败: "+(y.message||"未知错误"))}finally{g&&g.close()}},u=(g,y=null)=>{const b=`note-${g}${y?`-${y}`:""}`,S=document.getElementById(b);S&&S.scrollIntoView({behavior:"smooth",block:"start"})},f=g=>g.subIndex!==void 0&&g.subIndex!==null,a=()=>{s.value=!0,v()},m=()=>{l.value=!0,v()},v=()=>{s.value&&l.value&&(r.value=!1,h&&(h.close(),h=null))};return(g,y)=>{const b=St,S=Lt;return I(),B(me,null,[V(b,{onClick:d,size:"24px",class:"back-button"},{default:ne(()=>[V(Pe(Ct))]),_:1}),$("div",yi,[V(vi,{videoId:e.videoId,class:"note-chart",onLoaded:a},null,8,["videoId"]),$("div",bi,[$("div",wi,[$("div",{class:"directory-toggle",onClick:y[0]||(y[0]=w=>i.value=!i.value)},[y[1]||(y[1]=$e(" 📂 目录 ")),$("span",null,Z(i.value?"▲":"▼"),1)]),V(Mt,{name:"fade-slide"},{default:ne(()=>[jt($("div",xi,[(I(!0),B(me,null,Oe(o.value,w=>(I(),B("div",{key:w.label,class:He(["dir-item",{"sub-item":w.subIndex!==void 0}]),onClick:x=>u(w.noteIndex,w.subIndex)},Z(w.label),11,Ei))),128))],512),[[$t,i.value]])]),_:1})]),$("div",Si,[(I(!0),B(me,null,Oe(n.value,w=>(I(),B("div",{key:`${w.noteIndex}-${w.subIndex||0}`,id:`note-${w.noteIndex}${w.subIndex?`-${w.subIndex}`:""}`,class:He(["note-block",{"sub-note":f(w)}])},[f(w)?(I(),B("h3",_i,Z(w.title),1)):(I(),B("h2",Ni,Z(w.title),1)),$("p",null,Z(w.content),1)],10,Ci))),128)),$("div",ki,[V(S,{type:"primary",onClick:p,class:"export-btn"},{default:ne(()=>[V(b,null,{default:ne(()=>[V(Pe(_t))]),_:1}),y[2]||(y[2]=$e(" 导出Word文档 "))]),_:1,__:[2]})])])])])],64)}}},Oi=ot(Li,[["__scopeId","data-v-5df7f474"]]);export{Oi as default};
