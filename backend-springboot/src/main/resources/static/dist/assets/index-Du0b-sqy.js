import{r as I,K as V,ao as O,j,J as z,a4 as b,l as R,x as K,P as M,a7 as q,a8 as D,n as $,a as N,f as S,z as F,ap as G}from"./index-Q3dqO0M-.js";import{ac as H,N as L,s as J,t as x,M as h}from"./_plugin-vue_export-helper-DnkLqMvT.js";function Y(e,t){let n;const l=I(!1),o=V({...e,originalPosition:"",originalOverflow:"",visible:!1});function r(s){o.text=s}function c(){const s=o.parent,u=v.ns;if(!s.vLoadingAddClassList){let i=s.getAttribute("loading-number");i=Number.parseInt(i)-1,i?s.setAttribute("loading-number",i.toString()):(L(s,u.bm("parent","relative")),s.removeAttribute("loading-number")),L(s,u.bm("parent","hidden"))}d(),f.unmount()}function d(){var s,u;(u=(s=v.$el)==null?void 0:s.parentNode)==null||u.removeChild(v.$el)}function A(){var s;e.beforeClose&&!e.beforeClose()||(l.value=!0,clearTimeout(n),n=setTimeout(a,400),o.visible=!1,(s=e.closed)==null||s.call(e))}function a(){if(!l.value)return;const s=o.parent;l.value=!1,s.vLoadingAddClassList=void 0,c()}const C=j({name:"ElLoading",setup(s,{expose:u}){const{ns:i,zIndex:E}=H("loading");return u({ns:i,zIndex:E}),()=>{const k=o.spinner||o.svg,T=b("svg",{class:"circular",viewBox:o.svgViewBox?o.svgViewBox:"0 0 50 50",...k?{innerHTML:k}:{}},[b("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),P=o.text?b("p",{class:i.b("text")},[o.text]):void 0;return b(D,{name:i.b("fade"),onAfterLeave:a},{default:R(()=>[K(M("div",{style:{backgroundColor:o.background||""},class:[i.b("mask"),o.customClass,o.fullscreen?"is-fullscreen":""]},[b("div",{class:i.b("spinner")},[T,P])]),[[q,o.visible]])])})}}}),f=O(C);Object.assign(f._context,t??{});const v=f.mount(document.createElement("div"));return{...z(o),setText:r,removeElLoadingChild:d,close:A,handleAfterLeave:a,vm:v,get $el(){return v.$el}}}let _;const m=function(e={}){if(!J)return;const t=Z(e);if(t.fullscreen&&_)return _;const n=Y({...t,closed:()=>{var o;(o=t.closed)==null||o.call(t),t.fullscreen&&(_=void 0)}},m._context);Q(t,t.parent,n),w(t,t.parent,n),t.parent.vLoadingAddClassList=()=>w(t,t.parent,n);let l=t.parent.getAttribute("loading-number");return l?l=`${Number.parseInt(l)+1}`:l="1",t.parent.setAttribute("loading-number",l),t.parent.appendChild(n.$el),$(()=>n.visible.value=t.visible),t.fullscreen&&(_=n),n},Z=e=>{var t,n,l,o;let r;return N(e.target)?r=(t=document.querySelector(e.target))!=null?t:document.body:r=e.target||document.body,{parent:r===document.body||e.body?document.body:r,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:r===document.body&&((n=e.fullscreen)!=null?n:!0),lock:(l=e.lock)!=null?l:!1,customClass:e.customClass||"",visible:(o=e.visible)!=null?o:!0,beforeClose:e.beforeClose,closed:e.closed,target:r}},Q=async(e,t,n)=>{const{nextZIndex:l}=n.vm.zIndex||n.vm._.exposed.zIndex,o={};if(e.fullscreen)n.originalPosition.value=x(document.body,"position"),n.originalOverflow.value=x(document.body,"overflow"),o.zIndex=l();else if(e.parent===document.body){n.originalPosition.value=x(document.body,"position"),await $();for(const r of["top","left"]){const c=r==="top"?"scrollTop":"scrollLeft";o[r]=`${e.target.getBoundingClientRect()[r]+document.body[c]+document.documentElement[c]-Number.parseInt(x(document.body,`margin-${r}`),10)}px`}for(const r of["height","width"])o[r]=`${e.target.getBoundingClientRect()[r]}px`}else n.originalPosition.value=x(t,"position");for(const[r,c]of Object.entries(o))n.$el.style[r]=c},w=(e,t,n)=>{const l=n.vm.ns||n.vm._.exposed.ns;["absolute","fixed","sticky"].includes(n.originalPosition.value)?L(t,l.bm("parent","relative")):h(t,l.bm("parent","relative")),e.fullscreen&&e.lock?h(t,l.bm("parent","hidden")):L(t,l.bm("parent","hidden"))};m._context=null;const p=Symbol("ElLoading"),g=e=>`element-loading-${G(e)}`,B=(e,t)=>{var n,l,o,r;const c=t.instance,d=s=>S(t.value)?t.value[s]:void 0,A=s=>{const u=N(s)&&(c==null?void 0:c[s])||s;return I(u)},a=s=>A(d(s)||e.getAttribute(g(s))),C=(n=d("fullscreen"))!=null?n:t.modifiers.fullscreen,f={text:a("text"),svg:a("svg"),svgViewBox:a("svgViewBox"),spinner:a("spinner"),background:a("background"),customClass:a("customClass"),fullscreen:C,target:(l=d("target"))!=null?l:C?void 0:e,body:(o=d("body"))!=null?o:t.modifiers.body,lock:(r=d("lock"))!=null?r:t.modifiers.lock},v=m(f);v._context=y._context,e[p]={options:f,instance:v}},U=(e,t)=>{for(const n of Object.keys(e))F(e[n])&&(e[n].value=t[n])},y={mounted(e,t){t.value&&B(e,t)},updated(e,t){const n=e[p];if(!t.value){n==null||n.instance.close(),e[p]=null;return}n?U(n.options,S(t.value)?t.value:{text:e.getAttribute(g("text")),svg:e.getAttribute(g("svg")),svgViewBox:e.getAttribute(g("svgViewBox")),spinner:e.getAttribute(g("spinner")),background:e.getAttribute(g("background")),customClass:e.getAttribute(g("customClass"))}):B(e,t)},unmounted(e){var t;(t=e[p])==null||t.instance.close(),e[p]=null}};y._context=null;const ee={install(e){m._context=e._context,y._context=e._context,e.directive("loading",y),e.config.globalProperties.$loading=m},directive:y,service:m};export{ee as E};
